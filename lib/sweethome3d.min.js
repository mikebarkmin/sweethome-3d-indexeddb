/*
 * sweethome3d.min.js  version 7.2
 *
 * Sweet Home 3D, Copyright (c) 2022 Emmanuel PUYBARET / eTeks <info@eteks.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
var __extends=(this&&this.__extends)||(function(){var a=function(e,c){a=Object.setPrototypeOf||({__proto__:[]} instanceof Array&&function(g,f){g.__proto__=f})||function(h,f){for(var g in f){if(f.hasOwnProperty(g)){h[g]=f[g]}}};return a(e,c)};return function(f,c){a(f,c);function e(){this.constructor=f}f.prototype=c===null?Object.create(c):(e.prototype=c.prototype,new e())}})();var ObjectXMLExporter=(function(){function a(){}a.prototype.writeElement=function(c,b){c.writeStartElement(this.getTag(b));this.writeAttributes(c,b);this.writeChildren(c,b);c.writeEndElement()};a.prototype.getTag=function(b){var c=(function(d){return typeof d==="string"?d.substring(d.lastIndexOf(".")+1):d.__class?d.__class.substring(d.__class.lastIndexOf(".")+1):d.name.substring(d.name.lastIndexOf(".")+1)})(b.constructor);if((function(f,e,d){if(d===void 0){d=0}return f.substr(d,e.length)===e})(c,"Home")&&!(c===("Home"))){c=c.substring(4)}return c.charAt(0).toLowerCase()+c.substring(1)};a.prototype.writeAttributes=function(c,b){};a.prototype.writeChildren=function(c,b){};return a}());ObjectXMLExporter.__class="com.eteks.sweethome3d.io.ObjectXMLExporter";var XMLWriter=(function(){function a(b){this.elements=([]);if(this.emptyElement===undefined){this.emptyElement=false}if(this.elementWithText===undefined){this.elementWithText=false}this.out=b;this.out.write("<?xml version='1.0'?>\n")}a.prototype.writeStartElement=function(b){if(this.elements.length>0){if(this.emptyElement){this.out.write(">")}this.writeIndentation()}this.out.write("<"+b);(this.elements.push(b)>0);this.emptyElement=true;this.elementWithText=false};a.prototype.writeEndElement=function(){var b=this.elements.pop();if(this.emptyElement){this.out.write("/>")}else{if(!this.elementWithText){this.writeIndentation()}this.out.write("</"+b+">")}this.emptyElement=false;this.elementWithText=false};a.prototype.writeIndentation=function(){this.out.write("\n");for(var b=0;b<this.elements.length;b++){this.out.write("  ")}};a.prototype.writeAttribute$java_lang_String$java_lang_String=function(b,c){this.out.write(" "+b+"='"+a.replaceByEntities(c)+"'")};a.prototype.writeAttribute$java_lang_String$java_lang_String$java_lang_String=function(c,d,b){if((d!=null||d!==b)&&!(d===b)){this.writeAttribute$java_lang_String$java_lang_String(c,d)}};a.prototype.writeAttribute=function(c,d,b){if(((typeof c==="string")||c===null)&&((typeof d==="string")||d===null)&&((typeof b==="string")||b===null)){return this.writeAttribute$java_lang_String$java_lang_String$java_lang_String(c,d,b)}else{if(((typeof c==="string")||c===null)&&((typeof d==="string")||d===null)&&b===undefined){return this.writeAttribute$java_lang_String$java_lang_String(c,d)}else{throw new Error("invalid overload")}}};a.prototype.writeIntegerAttribute$java_lang_String$int=function(b,c){this.writeAttribute$java_lang_String$java_lang_String(b,String(c).toString())};a.prototype.writeIntegerAttribute$java_lang_String$int$int=function(c,d,b){if(d!==b){this.writeAttribute$java_lang_String$java_lang_String(c,String(d).toString())}};a.prototype.writeIntegerAttribute=function(c,d,b){if(((typeof c==="string")||c===null)&&((typeof d==="number")||d===null)&&((typeof b==="number")||b===null)){return this.writeIntegerAttribute$java_lang_String$int$int(c,d,b)}else{if(((typeof c==="string")||c===null)&&((typeof d==="number")||d===null)&&b===undefined){return this.writeIntegerAttribute$java_lang_String$int(c,d)}else{throw new Error("invalid overload")}}};a.prototype.writeLongAttribute$java_lang_String$long=function(b,c){this.writeAttribute$java_lang_String$java_lang_String(b,String(c).toString())};a.prototype.writeLongAttribute$java_lang_String$java_lang_Long=function(b,c){if(c!=null){this.writeAttribute$java_lang_String$java_lang_String(b,c.toString())}};a.prototype.writeLongAttribute=function(b,c){if(((typeof b==="string")||b===null)&&((typeof c==="number")||c===null)){return this.writeLongAttribute$java_lang_String$java_lang_Long(b,c)}else{if(((typeof b==="string")||b===null)&&((typeof c==="number")||c===null)){return this.writeLongAttribute$java_lang_String$long(b,c)}else{throw new Error("invalid overload")}}};a.prototype.writeFloatAttribute$java_lang_String$float=function(b,c){this.writeAttribute$java_lang_String$java_lang_String(b,String(c).toString())};a.prototype.writeFloatAttribute$java_lang_String$float$float=function(c,d,b){if(d!==b){this.writeFloatAttribute$java_lang_String$float(c,d)}};a.prototype.writeFloatAttribute=function(c,d,b){if(((typeof c==="string")||c===null)&&((typeof d==="number")||d===null)&&((typeof b==="number")||b===null)){return this.writeFloatAttribute$java_lang_String$float$float(c,d,b)}else{if(((typeof c==="string")||c===null)&&((typeof d==="number")||d===null)&&b===undefined){return this.writeFloatAttribute$java_lang_String$java_lang_Float(c,d)}else{if(((typeof c==="string")||c===null)&&((typeof d==="number")||d===null)&&b===undefined){return this.writeFloatAttribute$java_lang_String$float(c,d)}else{throw new Error("invalid overload")}}}};a.prototype.writeFloatAttribute$java_lang_String$java_lang_Float=function(b,c){if(c!=null){this.writeAttribute$java_lang_String$java_lang_String(b,c.toString())}};a.prototype.writeBigDecimalAttribute=function(b,c){if(c!=null){this.writeAttribute$java_lang_String$java_lang_String(b,String(c).toString())}};a.prototype.writeBooleanAttribute=function(c,d,b){if(d!==b){this.writeAttribute$java_lang_String$java_lang_String(c,String(d).toString())}};a.prototype.writeColorAttribute=function(c,b){if(b!=null){this.writeAttribute$java_lang_String$java_lang_String(c,CoreTools.format("%08X",b))}};a.prototype.writeText=function(b){if(this.emptyElement){this.out.write(">");this.emptyElement=false;this.elementWithText=true}this.out.write(a.replaceByEntities(b))};a.replaceByEntities=function(b){return b.split("&").join("&amp;").split("<").join("&lt;").split("'").join("&apos;").split('"').join("&quot;").split("\n").join("&#10;")};a.prototype.write$int=function(b){this.writeText(String(String.fromCharCode(b)).toString())};a.prototype.write$char_A$int$int=function(b,d,c){this.writeText(b.join("").substr(d,c))};a.prototype.write=function(b,d,c){if(((b!=null&&b instanceof Array&&(b.length==0||b[0]==null||(typeof b[0]==="string")))||b===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return this.write$char_A$int$int(b,d,c)}else{if(((typeof b==="string")||b===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return this.write$java_lang_String$int$int(b,d,c)}else{if(((typeof b==="number")||b===null)&&d===undefined&&c===undefined){return this.write$int(b)}else{throw new Error("invalid overload")}}}};a.prototype.write$java_lang_String$int$int=function(d,c,b){this.writeText(d.substring(c,c+b))};return a}());XMLWriter.__class="com.eteks.sweethome3d.io.XMLWriter";var HomeXMLHandler=(function(b){__extends(a,b);function a(c){var g=this;if(((c!=null&&c instanceof UserPreferences)||c===null)){var f=arguments;g=b.call(this)||this;if(g.preferences===undefined){g.preferences=null}if(g.home===undefined){g.home=null}if(g.homeElementName===undefined){g.homeElementName=null}if(g.labelText===undefined){g.labelText=null}if(g.leftSideBaseboard===undefined){g.leftSideBaseboard=null}if(g.rightSideBaseboard===undefined){g.rightSideBaseboard=null}if(g.homeBackgroundImage===undefined){g.homeBackgroundImage=null}if(g.backgroundImage===undefined){g.backgroundImage=null}if(g.materialTexture===undefined){g.materialTexture=null}g.buffer={str:"",toString:function(){return this.str}};g.elements=([]);g.attributes=([]);g.groupsFurniture=([]);g.properties=([]);g.textStyles=([]);g.levels=({});g.joinedWalls=({});g.textures=({});g.materials=([]);g.transformations=([]);g.sashes=([]);g.lightSources=([]);g.lightSourceMaterialNames=([]);g.shelfBoxes=([]);g.shelfElevations=([]);g.points=([]);g.furnitureVisiblePropertyNames=([]);g.printedLevelIds=([]);g.preferences=c!=null?c:new DefaultUserPreferences(false,null)}else{if(c===undefined){var f=arguments;var d=arguments;var e=null;g=b.call(this)||this;if(g.preferences===undefined){g.preferences=null}if(g.home===undefined){g.home=null}if(g.homeElementName===undefined){g.homeElementName=null}if(g.labelText===undefined){g.labelText=null}if(g.leftSideBaseboard===undefined){g.leftSideBaseboard=null}if(g.rightSideBaseboard===undefined){g.rightSideBaseboard=null}if(g.homeBackgroundImage===undefined){g.homeBackgroundImage=null}if(g.backgroundImage===undefined){g.backgroundImage=null}if(g.materialTexture===undefined){g.materialTexture=null}g.buffer={str:"",toString:function(){return this.str}};g.elements=([]);g.attributes=([]);g.groupsFurniture=([]);g.properties=([]);g.textStyles=([]);g.levels=({});g.joinedWalls=({});g.textures=({});g.materials=([]);g.transformations=([]);g.sashes=([]);g.lightSources=([]);g.lightSourceMaterialNames=([]);g.shelfBoxes=([]);g.shelfElevations=([]);g.points=([]);g.furnitureVisiblePropertyNames=([]);g.printedLevelIds=([]);g.preferences=e!=null?e:new DefaultUserPreferences(false,null);if(g.preferences===undefined){g.preferences=null}if(g.home===undefined){g.home=null}if(g.homeElementName===undefined){g.homeElementName=null}if(g.labelText===undefined){g.labelText=null}if(g.leftSideBaseboard===undefined){g.leftSideBaseboard=null}if(g.rightSideBaseboard===undefined){g.rightSideBaseboard=null}if(g.homeBackgroundImage===undefined){g.homeBackgroundImage=null}if(g.backgroundImage===undefined){g.backgroundImage=null}if(g.materialTexture===undefined){g.materialTexture=null}g.buffer={str:"",toString:function(){return this.str}};g.elements=([]);g.attributes=([]);g.groupsFurniture=([]);g.properties=([]);g.textStyles=([]);g.levels=({});g.joinedWalls=({});g.textures=({});g.materials=([]);g.transformations=([]);g.sashes=([]);g.lightSources=([]);g.lightSourceMaterialNames=([]);g.shelfBoxes=([]);g.shelfElevations=([]);g.points=([]);g.furnitureVisiblePropertyNames=([]);g.printedLevelIds=([])}else{throw new Error("invalid overload")}}return g}a.prototype.startDocument=function(){this.home=null;(this.elements.length=0);(this.attributes.length=0);(this.groupsFurniture.length=0);(function(c){for(var d in c){delete c[d]}})(this.levels);(function(c){for(var d in c){delete c[d]}})(this.joinedWalls)};a.prototype.startElement=function(h,d,f,c){var j=this;(function(l,k){return l.str=l.str.substring(0,k)})(this.buffer,0);(this.elements.push(f)>0);var e=({});for(var g=0;g<c.getLength();g++){(e[c.getQName(g)]=c.getValue(g).replace("&quot;",'"').replace("&lt;","<").replace("&gt;",">").replace("&amp;","&"))}(this.attributes.push(e)>0);if(!("property"===f)&&!("furnitureVisibleProperty"===f)&&!("textStyle"===f)){(this.properties.push({})>0);(this.textStyles.push({})>0)}if("home"===f){this.setHome(this.createHome(f,e));(this.furnitureVisiblePropertyNames.length=0);this.homeBackgroundImage=null}else{if("environment"===f){(function(k){for(var l in k){delete k[l]}})(this.textures)}else{if("level"===f){this.backgroundImage=null}else{if(("pieceOfFurniture"===f)||("doorOrWindow"===f)||("light"===f)||("shelfUnit"===f)||("furnitureGroup"===f)){(function(k){for(var l in k){delete k[l]}})(this.textures);(this.materials.length=0);(this.transformations.length=0);(this.sashes.length=0);(this.lightSources.length=0);(this.lightSourceMaterialNames.length=0);(this.shelfBoxes.length=0);(this.shelfElevations.length=0);if("furnitureGroup"===f){(this.groupsFurniture.push([])>0)}}else{if("room"===f){(function(k){for(var l in k){delete k[l]}})(this.textures);(this.points.length=0)}else{if("polyline"===f){(this.points.length=0)}else{if("label"===f){this.labelText=null}else{if("wall"===f){(function(k){for(var l in k){delete k[l]}})(this.textures);this.leftSideBaseboard=null;this.rightSideBaseboard=null}else{if("baseboard"===f){(function(l){var k=j.textures[a.UNIQUE_ATTRIBUTE];delete j.textures[a.UNIQUE_ATTRIBUTE];return k})(this.textures)}else{if("material"===f){this.materialTexture=null}}}}}}}}}}};a.prototype.characters=function(c,e,d){(function(f){f.str+=c.substr(e,d);return f})(this.buffer)};a.prototype.endElement=function(n,j,E){this.elements.pop();var q=(this.elements.length==0)?null:(function(F){return F.length==0?null:F[F.length-1]})(this.elements);var y=this.attributes.pop();if(this.homeElementName!=null&&(this.homeElementName===E)){this.setHomeAttributes(this.home,E,y)}else{if("furnitureVisibleProperty"===E){if((function(F,G){return F[G]===undefined?null:F[G]})(y,"name")==null){throw new SAXException("Missing name attribute")}(this.furnitureVisiblePropertyNames.push((function(F,G){return F[G]===undefined?null:F[G]})(y,"name"))>0)}else{if("environment"===E){this.setEnvironmentAttributes(this.home.getEnvironment(),E,y)}else{if("compass"===E){this.setCompassAttributes(this.home.getCompass(),E,y)}else{if("print"===E){this.home.setPrint(this.createPrint(y))}else{if(("printedLevel"===E)&&("print"===q)){if((function(F,G){return F[G]===undefined?null:F[G]})(y,"level")==null){throw new SAXException("Missing level attribute")}(this.printedLevelIds.push((function(F,G){return F[G]===undefined?null:F[G]})(y,"level"))>0)}else{if("level"===E){var c=this.createLevel(E,y);this.setLevelAttributes(c,E,y);(this.levels[(function(F,G){return F[G]===undefined?null:F[G]})(y,"id")]=c);this.home.addLevel(c)}else{if(("camera"===E)||("observerCamera"===E)){var z=this.createCamera(E,y);this.setCameraAttributes(z,E,y);var s=(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute");if("cameraPath"===s){var x=(this.home.getEnvironment().getVideoCameraPath().slice(0));(x.push(z)>0);this.home.getEnvironment().setVideoCameraPath(x)}else{if("topCamera"===s){var k=this.home.getTopCamera();k.setCamera(z);k.setTime(z.getTime());k.setLens(z.getLens())}else{if("observerCamera"===s){var D=this.home.getObserverCamera();D.setCamera(z);D.setTime(z.getTime());D.setLens(z.getLens());D.setFixedSize(z.isFixedSize())}else{if("storedCamera"===s){var u=(this.home.getStoredCameras().slice(0));(u.push(z)>0);this.home.setStoredCameras(u)}}}}}else{if(("pieceOfFurniture"===E)||("doorOrWindow"===E)||("light"===E)||("shelfUnit"===E)||("furnitureGroup"===E)){var g="furnitureGroup"===E?this.createFurnitureGroup(E,y,this.groupsFurniture.pop()):this.createPieceOfFurniture(E,y);this.setPieceOfFurnitureAttributes(g,E,y);if(this.homeElementName!=null&&(this.homeElementName===q)){this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(g);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){g.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("furnitureGroup"===q){((function(F){return F.length==0?null:F[F.length-1]})(this.groupsFurniture).push(g)>0)}}}else{if("wall"===E){var B=this.createWall(E,y);(this.joinedWalls[(function(F,G){return F[G]===undefined?null:F[G]})(y,"id")]=new a.JoinedWall(B,(function(F,G){return F[G]===undefined?null:F[G]})(y,"wallAtStart"),(function(F,G){return F[G]===undefined?null:F[G]})(y,"wallAtEnd")));this.setWallAttributes(B,E,y);this.home.addWall(B);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){B.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("baseboard"===E){var o=this.createBaseboard(E,y);if("leftSideBaseboard"===(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute")){this.leftSideBaseboard=o}else{this.rightSideBaseboard=o}}else{if("room"===E){var C=this.createRoom(E,y,this.points.slice(0));this.setRoomAttributes(C,E,y);this.home.addRoom$com_eteks_sweethome3d_model_Room(C);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){C.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("polyline"===E){var t=this.createPolyline(E,y,this.points.slice(0));this.setPolylineAttributes(t,E,y);this.home.addPolyline$com_eteks_sweethome3d_model_Polyline(t);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){t.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("dimensionLine"===E){var m=this.createDimensionLine(E,y);this.setDimensionLineAttributes(m,E,y);this.home.addDimensionLine(m);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){m.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("label"===E){var p=this.createLabel(E,y,this.labelText);this.setLabelAttributes(p,E,y);this.home.addLabel(p);var h=(function(F,G){return F[G]===undefined?null:F[G]})(y,"level");if(h!=null){p.setLevel((function(F,G){return F[G]===undefined?null:F[G]})(this.levels,h))}}else{if("text"===E){this.labelText=this.getCharacters()}else{if("textStyle"===E){var s=(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute");((function(F){return F.length==0?null:F[F.length-1]})(this.textStyles)[s!=null?s:a.UNIQUE_ATTRIBUTE]=this.createTextStyle(E,y))}else{if("texture"===E){if("material"===q){this.materialTexture=this.createTexture(E,y)}else{var s=(function(F,G){return F[G]===undefined?null:F[G]})(y,"attribute");(this.textures[s!=null?s:a.UNIQUE_ATTRIBUTE]=this.createTexture(E,y))}}else{if("material"===E){(this.materials.push(this.createMaterial(E,y))>0)}else{if("transformation"===E){var f=(function(F,G){return F[G]===undefined?null:F[G]})(y,"matrix");if(f==null){throw new SAXException("Missing attribute matrix")}else{var e=f.split(/ /);if(e.length<12){throw new SAXException("Missing values for attribute matrix")}try{var w=[[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])],[parseFloat(e[4]),parseFloat(e[5]),parseFloat(e[6]),parseFloat(e[7])],[parseFloat(e[8]),parseFloat(e[9]),parseFloat(e[10]),parseFloat(e[11])]];var r=new Transformation((function(F,G){return F[G]===undefined?null:F[G]})(y,"name"),w);(this.transformations.push(this.resolveObject(r,E,y))>0)}catch(A){throw new SAXException("Invalid value for attribute matrix",A)}}}else{if("point"===E){(this.points.push([this.parseFloat(y,"x"),this.parseFloat(y,"y")])>0)}else{if("sash"===E){var v=new Sash(this.parseFloat(y,"xAxis"),this.parseFloat(y,"yAxis"),this.parseFloat(y,"width"),this.parseFloat(y,"startAngle"),this.parseFloat(y,"endAngle"));(this.sashes.push(this.resolveObject(v,E,y))>0)}else{if("lightSource"===E){var l=new LightSource(this.parseFloat(y,"x"),this.parseFloat(y,"y"),this.parseFloat(y,"z"),this.parseOptionalColor(y,"color"),this.parseOptionalFloat(y,"diameter"));(this.lightSources.push(this.resolveObject(l,E,y))>0)}else{if("lightSourceMaterial"===E){(this.lightSourceMaterialNames.push((function(F,G){return F[G]===undefined?null:F[G]})(y,"name"))>0)}else{if("shelf"===E){if((function(F,G){return F[G]===undefined?null:F[G]})(y,"xLower")!=null){(this.shelfBoxes.push(new BoxBounds(this.parseFloat(y,"xLower"),this.parseFloat(y,"yLower"),this.parseFloat(y,"zLower"),this.parseFloat(y,"xUpper"),this.parseFloat(y,"yUpper"),this.parseFloat(y,"zUpper")))>0)}else{(this.shelfElevations.push(this.parseFloat(y,"elevation"))>0)}}else{if("backgroundImage"===E){var d=new BackgroundImage(this.parseContent(E,y,"image"),this.parseFloat(y,"scaleDistance"),this.parseFloat(y,"scaleDistanceXStart"),this.parseFloat(y,"scaleDistanceYStart"),this.parseFloat(y,"scaleDistanceXEnd"),this.parseFloat(y,"scaleDistanceYEnd"),(function(F,G){return F[G]===undefined?null:F[G]})(y,"xOrigin")!=null?this.parseFloat(y,"xOrigin"):0,(function(F,G){return F[G]===undefined?null:F[G]})(y,"yOrigin")!=null?this.parseFloat(y,"yOrigin"):0,!("false"===(function(F,G){return F[G]===undefined?null:F[G]})(y,"visible")));d=this.resolveObject(d,E,y);if(this.homeElementName!=null&&(this.homeElementName===q)){this.homeBackgroundImage=d}else{this.backgroundImage=d}}else{if("property"===E){if(this.homeElementName!=null){if(ObjectProperty.Type[ObjectProperty.Type.CONTENT]===(function(F,G){return F[G]===undefined?null:F[G]})(y,"type")){((function(F){return F.length==0?null:F[F.length-1]})(this.properties)[(function(F,G){return F[G]===undefined?null:F[G]})(y,"name")]=this.parseContent(E,y,"value"))}else{((function(F){return F.length==0?null:F[F.length-1]})(this.properties)[(function(F,G){return F[G]===undefined?null:F[G]})(y,"name")]=(function(F,G){return F[G]===undefined?null:F[G]})(y,"value"))}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(!("property"===E)&&!("furnitureVisibleProperty"===E)&&!("textStyle"===E)){this.properties.pop();this.textStyles.pop()}};a.prototype.getCharacters=function(){return this.buffer.str.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};a.prototype.endDocument=function(){var j=([]);for(var f=0;f<this.printedLevelIds.length;f++){var n=this.printedLevelIds[f];var g=this.home.getLevels();for(var h=0;h<g.length;h++){var d=g[h];if(n===d.getId()){(j.push(d)>0);break}}}var c=this.home.getPrint();if(c!=null&&!(j.length==0)&&c.constructor===HomePrint){this.home.setPrint(new HomePrint(c.getPaperOrientation(),c.getPaperWidth(),c.getPaperHeight(),c.getPaperTopMargin(),c.getPaperLeftMargin(),c.getPaperBottomMargin(),c.getPaperRightMargin(),c.isFurniturePrinted(),c.isPlanPrinted(),j,c.isView3DPrinted(),c.getPlanScale(),c.getHeaderFormat(),c.getFooterFormat()))}var g=(function(o){return Object.keys(o).map(function(p){return o[p]})})(this.joinedWalls);for(var f=0;f<g.length;f++){var k=g[f];var l=k.getWall();if(k.getWallAtStartId()!=null&&!(k.getWallAtStartId()===l.getId())){var e=(function(o,p){return o[p]===undefined?null:o[p]})(this.joinedWalls,k.getWallAtStartId());if(e!=null){l.setWallAtStart(e.getWall())}}if(k.getWallAtEndId()!=null&&!(k.getWallAtEndId()===l.getId())){var m=(function(o,p){return o[p]===undefined?null:o[p]})(this.joinedWalls,k.getWallAtEndId());if(m!=null){l.setWallAtEnd(m.getWall())}}}};a.prototype.resolveObject=function(e,c,d){return e};a.prototype.createHome=function(c,e){var g;if((function(h,j){return h[j]===undefined?null:h[j]})(e,"wallHeight")!=null){g=new Home(this.parseFloat(e,"wallHeight"))}else{g=new Home()}var d=(function(h,j){return h[j]===undefined?null:h[j]})(e,"version");if(d!=null){try{g.setVersion(parseInt(d))}catch(f){throw new SAXException("Invalid value for integer attribute version",f)}}return this.resolveObject(g,c,e)};a.prototype.setHomeAttributes=function(g,l,c){var e=(function(p){var m=[];for(var n in p){m.push({k:n,v:p[n],getKey:function(){return this.k},getValue:function(){return this.v}})}return m})((function(m){return m.length==0?null:m[m.length-1]})(this.properties));for(var d=0;d<e.length;d++){var j=e[d];if(typeof j.getValue()==="string"){g.setProperty(j.getKey(),j.getValue())}}if(this.furnitureVisiblePropertyNames.length>0){this.home.setFurnitureVisiblePropertyNames(this.furnitureVisiblePropertyNames)}this.home.setBackgroundImage(this.homeBackgroundImage);g.setName((function(n,o){return n[o]===undefined?null:n[o]})(c,"name"));var h=(function(n,o){return n[o]===undefined?null:n[o]})(c,"selectedLevel");if(h!=null){this.home.setSelectedLevel((function(n,o){return n[o]===undefined?null:n[o]})(this.levels,h))}if("observerCamera"===(function(n,o){return n[o]===undefined?null:n[o]})(c,"camera")){this.home.setCamera(this.home.getObserverCamera())}g.setBasePlanLocked("true"===(function(n,o){return n[o]===undefined?null:n[o]})(c,"basePlanLocked"));var k=(function(n,o){return n[o]===undefined?null:n[o]})(c,"furnitureSortedProperty");if(k!=null){try{g.setFurnitureSortedPropertyName(k)}catch(f){}}g.setFurnitureDescendingSorted("true"===(function(n,o){return n[o]===undefined?null:n[o]})(c,"furnitureDescendingSorted"));if(c.structure){g.structure=this.parseContent(this.homeElementName,c,"structure")}};a.prototype.setEnvironmentAttributes=function(u,l,j){this.setProperties(u,l,j);var v=this.parseOptionalColor(j,"groundColor");if(v!=null){u.setGroundColor(v)}u.setGroundTexture((function(x,y){return x[y]===undefined?null:x[y]})(this.textures,"groundTexture"));u.setBackgroundImageVisibleOnGround3D("true"===(function(x,y){return x[y]===undefined?null:x[y]})(j,"backgroundImageVisibleOnGround3D"));var s=this.parseOptionalColor(j,"skyColor");if(s!=null){u.setSkyColor(s)}u.setSkyTexture((function(x,y){return x[y]===undefined?null:x[y]})(this.textures,"skyTexture"));var n=this.parseOptionalColor(j,"lightColor");if(n!=null){u.setLightColor(n)}var k=this.parseOptionalFloat(j,"wallsAlpha");if(k!=null){u.setWallsAlpha(k)}u.setAllLevelsVisible("true"===(function(x,y){return x[y]===undefined?null:x[y]})(j,"allLevelsVisible"));u.setObserverCameraElevationAdjusted(!("false"===(function(x,y){return x[y]===undefined?null:x[y]})(j,"observerCameraElevationAdjusted")));var d=this.parseOptionalColor(j,"ceillingLightColor");if(d!=null){u.setCeillingLightColor(d)}var c=(function(x,y){return x[y]===undefined?null:x[y]})(j,"drawingMode");if(c!=null){try{u.setDrawingMode(HomeEnvironment.DrawingMode[c])}catch(q){}}var h=this.parseOptionalFloat(j,"subpartSizeUnderLight");if(h!=null){u.setSubpartSizeUnderLight(h)}var p=this.parseOptionalInteger(j,"photoWidth");if(p!=null){u.setPhotoWidth(p)}var o=this.parseOptionalInteger(j,"photoHeight");if(o!=null){u.setPhotoHeight(o)}var r=(function(x,y){return x[y]===undefined?null:x[y]})(j,"photoAspectRatio");if(r!=null){try{u.setPhotoAspectRatio(AspectRatio[r])}catch(q){}}var w=this.parseOptionalInteger(j,"photoQuality");if(w!=null){u.setPhotoQuality(w)}var f=this.parseOptionalInteger(j,"videoWidth");if(f!=null){u.setVideoWidth(f)}var e=(function(x,y){return x[y]===undefined?null:x[y]})(j,"videoAspectRatio");if(e!=null){try{u.setVideoAspectRatio(AspectRatio[e])}catch(q){}}var t=this.parseOptionalInteger(j,"videoQuality");if(t!=null){u.setVideoQuality(t)}var g=this.parseOptionalFloat(j,"videoSpeed");if(g!=null){u.setVideoSpeed(g)}var m=this.parseOptionalInteger(j,"videoFrameRate");if(m!=null){u.setVideoFrameRate(m)}};a.prototype.createPrint=function(c){var f=HomePrint.PaperOrientation.PORTRAIT;try{if((function(g,h){return g[h]===undefined?null:g[h]})(c,"paperOrientation")==null){throw new SAXException("Missing paperOrientation attribute")}f=HomePrint.PaperOrientation[(function(g,h){return g[h]===undefined?null:g[h]})(c,"paperOrientation")]}catch(e){}var d=new HomePrint(f,this.parseFloat(c,"paperWidth"),this.parseFloat(c,"paperHeight"),this.parseFloat(c,"paperTopMargin"),this.parseFloat(c,"paperLeftMargin"),this.parseFloat(c,"paperBottomMargin"),this.parseFloat(c,"paperRightMargin"),!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(c,"furniturePrinted")),!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(c,"planPrinted")),!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(c,"view3DPrinted")),this.parseOptionalFloat(c,"planScale"),(function(g,h){return g[h]===undefined?null:g[h]})(c,"headerFormat"),(function(g,h){return g[h]===undefined?null:g[h]})(c,"footerFormat"));return this.resolveObject(d,"print",c)};a.prototype.setCompassAttributes=function(g,c,d){this.setProperties(g,c,d);g.setX(this.parseOptionalFloat(d,"x"));g.setY(this.parseOptionalFloat(d,"y"));g.setDiameter(this.parseOptionalFloat(d,"diameter"));var f=this.parseOptionalFloat(d,"northDirection");if(f!=null){g.setNorthDirection(f)}var h=this.parseOptionalFloat(d,"longitude");if(h!=null){g.setLongitude(h)}var j=this.parseOptionalFloat(d,"latitude");if(j!=null){g.setLatitude(j)}var e=(function(l,n){return l[n]===undefined?null:l[n]})(d,"timeZone");if(e!=null){g.setTimeZone(e)}g.setVisible(!("false"===(function(l,n){return l[n]===undefined?null:l[n]})(d,"visible")))};a.prototype.createCamera=function(m,f){var c=(function(n,o){return n[o]===undefined?null:n[o]})(f,"id");var l=this.parseFloat(f,"x");var k=this.parseFloat(f,"y");var j=this.parseFloat(f,"z");var e=this.parseFloat(f,"yaw");var d=this.parseFloat(f,"pitch");var g=this.parseFloat(f,"fieldOfView");var h;if("observerCamera"===m){h=c!=null?new ObserverCamera(c,l,k,j,e,d,g):new ObserverCamera(l,k,j,e,d,g)}else{h=c!=null?new Camera(c,l,k,j,e,d,g):new Camera(l,k,j,e,d,g)}return this.resolveObject(h,m,f)};a.prototype.setCameraAttributes=function(g,c,d){this.setProperties(g,c,d);if(g!=null&&g instanceof ObserverCamera){g.setFixedSize("true"===(function(j,l){return j[l]===undefined?null:j[l]})(d,"fixedSize"))}var e=(function(j,l){return j[l]===undefined?null:j[l]})(d,"lens");if(e!=null){try{g.setLens(Camera.Lens[e])}catch(f){}}var h=(function(j,l){return j[l]===undefined?null:j[l]})(d,"time");if(h!=null){try{g.setTime(parseInt(h))}catch(f){throw new SAXException("Invalid value for long attribute time",f)}}g.setName((function(j,l){return j[l]===undefined?null:j[l]})(d,"name"));g.setRenderer((function(j,l){return j[l]===undefined?null:j[l]})(d,"renderer"))};a.prototype.createLevel=function(d,e){var k=(function(l,n){return l[n]===undefined?null:l[n]})(e,"id");var f=(function(l,n){return l[n]===undefined?null:l[n]})(e,"name");var g=this.parseFloat(e,"elevation");var h=this.parseFloat(e,"floorThickness");var c=this.parseFloat(e,"height");var j=k!=null?new Level(k,f,g,h,c):new Level(f,g,h,c);return this.resolveObject(j,d,e)};a.prototype.setLevelAttributes=function(f,c,e){this.setProperties(f,c,e);f.setBackgroundImage(this.backgroundImage);var d=this.parseOptionalInteger(e,"elevationIndex");if(d!=null){f.setElevationIndex(d)}f.setVisible(!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(e,"visible")));f.setViewable(!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(e,"viewable")))};a.prototype.createPieceOfFurniture=function(B,K){var E=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"id");var t=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"catalogId");var C=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"tags")!=null?(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"tags").split(/ /):null;var l=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"elevation")!=null?this.parseFloat(K,"elevation"):0;var f=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"dropOnTopElevation")!=null?this.parseFloat(K,"dropOnTopElevation"):1;var S=null;if((function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"modelRotation")!=null){var U=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"modelRotation").split(/ /);if(U.length<9){throw new SAXException("Missing values for attribute modelRotation")}try{S=[[parseFloat(U[0]),parseFloat(U[1]),parseFloat(U[2])],[parseFloat(U[3]),parseFloat(U[4]),parseFloat(U[5])],[parseFloat(U[6]),parseFloat(U[7]),parseFloat(U[8])]]}catch(L){throw new SAXException("Invalid value for attribute modelRotation",L)}}var r=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"name");var s=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"description");var R=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"information");var A=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"license");var G=this.parseOptionalLong(K,"creationDate");var F=this.parseOptionalFloat(K,"grade");var p=this.parseContent(B,K,"icon");var h=this.parseContent(B,K,"planIcon");var e=this.parseContent(B,K,"model");var c=this.parseFloat(K,"width");var m=this.parseFloat(K,"depth");var d=this.parseFloat(K,"height");var z=!("false"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"movable"));var P=this.parseOptionalInteger(K,"modelFlags");if(P==null){P="true"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"backFaceShown")?PieceOfFurniture.SHOW_BACK_FACE:0}var W=this.parseOptionalLong(K,"modelSize");var x=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"creator");var H=!("false"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"resizable"));var o=!("false"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"deformable"));var k=!("false"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"texturable"));var D=this.parseOptionalDecimal(K,"price");var g=this.parseOptionalDecimal(K,"valueAddedTaxPercentage");var O=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"currency");var v;if(("doorOrWindow"===B)||("true"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"doorOrWindow"))){var V=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"wallThickness")!=null?this.parseFloat(K,"wallThickness"):1;var N=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"wallDistance")!=null?this.parseFloat(K,"wallDistance"):0;var y=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"cutOutShape");if(y==null&&!("doorOrWindow"===B)){y=PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE}var w="true"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"wallCutOutOnBothSides");var M=!("false"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"widthDepthDeformable"));var T=new CatalogDoorOrWindow(t,r,s,R,A,C,G,F,p,h,e,c,m,d,l,f,z,y,V,N,w,M,this.sashes.slice(0),S,P,W,x,H,o,k,D,g,O,null,null);v=E!=null?new HomeDoorOrWindow(E,T):new HomeDoorOrWindow(T)}else{var J=(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"staircaseCutOutShape");var q=!("false"===(function(X,Y){return X[Y]===undefined?null:X[Y]})(K,"horizontallyRotatable"));if("light"===B){var n=new CatalogLight(t,r,s,R,A,C,G,F,p,h,e,c,m,d,l,f,z,this.lightSources.slice(0),this.lightSourceMaterialNames.slice(0),J,S,P,W,x,H,o,k,q,D,g,O,null,null);v=E!=null?new HomeLight(E,n):new HomeLight(n)}else{if("shelfUnit"===B){var I=(function(Y){var X=[];while(Y-->0){X.push(0)}return X})(this.shelfElevations.length);for(var Q=0;Q<I.length;Q++){I[Q]=this.shelfElevations[Q]}var u=new CatalogShelfUnit(t,r,s,R,A,C,G,F,p,h,e,c,m,d,l,f,I,this.shelfBoxes.slice(0),z,J,S,P,W,x,H,o,k,q,D,g,O,null,null);v=E!=null?new HomeShelfUnit(E,u):new HomeShelfUnit(u)}else{var j=new CatalogPieceOfFurniture(t,r,s,R,A,C,G,F,p,h,e,c,m,d,l,f,z,J,S,P,W,x,H,o,k,q,D,g,O,null,null);v=E!=null?new HomePieceOfFurniture(E,j):new HomePieceOfFurniture(j)}}}return this.resolveObject(v,B,K)};a.prototype.createFurnitureGroup=function(c,e,h){var k=(function(l,n){return l[n]===undefined?null:l[n]})(e,"id");var j=(function(l,n){return l[n]===undefined?null:l[n]})(e,"angle")!=null?this.parseFloat(e,"angle"):0;var d="true"===(function(l,n){return l[n]===undefined?null:l[n]})(e,"modelMirrored");var f=(function(l,n){return l[n]===undefined?null:l[n]})(e,"name");var g=k!=null?new HomeFurnitureGroup(k,h,j,d,f):new HomeFurnitureGroup(h,j,d,f);return this.resolveObject(g,c,e)};a.prototype.setPieceOfFurnitureAttributes=function(e,m,k){this.setProperties(e,m,k);e.setNameStyle((function(x,y){return x[y]===undefined?null:x[y]})((function(x){return x.length==0?null:x[x.length-1]})(this.textStyles),"nameStyle"));e.setNameVisible("true"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"nameVisible"));var v=this.parseOptionalFloat(k,"nameAngle");if(v!=null){e.setNameAngle(v)}var t=this.parseOptionalFloat(k,"nameXOffset");if(t!=null){e.setNameXOffset(t)}var d=this.parseOptionalFloat(k,"nameYOffset");if(d!=null){e.setNameYOffset(d)}e.setVisible(!("false"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"visible")));if(!(e!=null&&e instanceof HomeFurnitureGroup)){var o=this.parseOptionalFloat(k,"x");if(o!=null){e.setX(o)}var n=this.parseOptionalFloat(k,"y");if(n!=null){e.setY(n)}var w=this.parseOptionalFloat(k,"angle");if(w!=null){e.setAngle(w)}if(e.isHorizontallyRotatable()){var l=this.parseOptionalFloat(k,"pitch");if(l!=null){e.setPitch(l)}var A=this.parseOptionalFloat(k,"roll");if(A!=null){e.setRoll(A)}}var c=this.parseOptionalFloat(k,"widthInPlan");if(c!=null){e.setWidthInPlan(c)}var f=this.parseOptionalFloat(k,"depthInPlan");if(f!=null){e.setDepthInPlan(f)}var h=this.parseOptionalFloat(k,"heightInPlan");if(h!=null){e.setHeightInPlan(h)}if(this.home.getVersion()<5500||("false"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"modelCenteredAtOrigin"))){e.setModelCenteredAtOrigin((function(x,y){return x[y]===undefined?null:x[y]})(k,"modelRotation")==null)}if(e.isResizable()){e.setModelMirrored("true"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"modelMirrored"))}if(e.isTexturable()){if(this.materials.length>0){e.setModelMaterials(this.materials.slice(0))}var u=this.parseOptionalColor(k,"color");if(u!=null){e.setColor(u)}var q=(function(x,y){return x[y]===undefined?null:x[y]})(this.textures,a.UNIQUE_ATTRIBUTE);if(q!=null){e.setTexture(q)}var s=this.parseOptionalFloat(k,"shininess");if(s!=null){e.setShininess(s)}}if(e.isDeformable()){if(this.transformations.length>0){e.setModelTransformations(this.transformations.slice(0))}}if((e!=null&&e instanceof HomeLight)&&(function(x,y){return x[y]===undefined?null:x[y]})(k,"power")!=null){e.setPower(this.parseFloat(k,"power"))}else{if((e!=null&&e instanceof HomeDoorOrWindow)&&("doorOrWindow"===m)){var r=e;r.setBoundToWall(!("false"===(function(x,y){return x[y]===undefined?null:x[y]})(k,"boundToWall")));var j=this.parseOptionalFloat(k,"wallWidth");if(j!=null){r.setWallWidth(j)}var p=this.parseOptionalFloat(k,"wallLeft");if(p!=null){r.setWallLeft(p)}var z=this.parseOptionalFloat(k,"wallHeight");if(z!=null){r.setWallHeight(z)}var g=this.parseOptionalFloat(k,"wallTop");if(g!=null){r.setWallTop(g)}}}}else{e.setCatalogId((function(x,y){return x[y]===undefined?null:x[y]})(k,"catalogId"));e.setDescription((function(x,y){return x[y]===undefined?null:x[y]})(k,"description"));e.setInformation((function(x,y){return x[y]===undefined?null:x[y]})(k,"information"));e.setLicense((function(x,y){return x[y]===undefined?null:x[y]})(k,"license"));e.setCreator((function(x,y){return x[y]===undefined?null:x[y]})(k,"creator"))}};a.prototype.createWall=function(l,e){var d=(function(n,o){return n[o]===undefined?null:n[o]})(e,"id");var f=this.parseFloat(e,"xStart");var k=this.parseFloat(e,"yStart");var c=this.parseFloat(e,"xEnd");var j=this.parseFloat(e,"yEnd");var h=this.parseFloat(e,"thickness");var g=d!=null?new Wall(d,f,k,c,j,h,0):new Wall(f,k,c,j,h,0);return this.resolveObject(g,l,e)};a.prototype.setWallAttributes=function(d,c,f){this.setProperties(d,c,f);d.setLeftSideBaseboard(this.leftSideBaseboard);d.setRightSideBaseboard(this.rightSideBaseboard);d.setHeight(this.parseOptionalFloat(f,"height"));d.setHeightAtEnd(this.parseOptionalFloat(f,"heightAtEnd"));d.setArcExtent(this.parseOptionalFloat(f,"arcExtent"));d.setTopColor(this.parseOptionalColor(f,"topColor"));d.setLeftSideColor(this.parseOptionalColor(f,"leftSideColor"));d.setLeftSideTexture((function(l,n){return l[n]===undefined?null:l[n]})(this.textures,"leftSideTexture"));var e=this.parseOptionalFloat(f,"leftSideShininess");if(e!=null){d.setLeftSideShininess(e)}d.setRightSideColor(this.parseOptionalColor(f,"rightSideColor"));d.setRightSideTexture((function(l,n){return l[n]===undefined?null:l[n]})(this.textures,"rightSideTexture"));var j=this.parseOptionalFloat(f,"rightSideShininess");if(j!=null){d.setRightSideShininess(j)}var h=(function(l,n){return l[n]===undefined?null:l[n]})(f,"pattern");if(h!=null){try{d.setPattern(this.preferences.getPatternsCatalog().getPattern$java_lang_String(h))}catch(g){}}};a.prototype.createRoom=function(c,d,e){var g=(function(h,j){return h[j]===undefined?null:h[j]})(d,"id");var f=g!=null?new Room(g,e):new Room(e);return this.resolveObject(f,c,d)};a.prototype.setRoomAttributes=function(c,n,f){this.setProperties(c,n,f);c.setNameStyle((function(o,p){return o[p]===undefined?null:o[p]})((function(o){return o.length==0?null:o[o.length-1]})(this.textStyles),"nameStyle"));c.setAreaStyle((function(o,p){return o[p]===undefined?null:o[p]})((function(o){return o.length==0?null:o[o.length-1]})(this.textStyles),"areaStyle"));c.setName((function(o,p){return o[p]===undefined?null:o[p]})(f,"name"));var e=this.parseOptionalFloat(f,"nameAngle");if(e!=null){c.setNameAngle(e)}var d=this.parseOptionalFloat(f,"nameXOffset");if(d!=null){c.setNameXOffset(d)}var k=this.parseOptionalFloat(f,"nameYOffset");if(k!=null){c.setNameYOffset(k)}c.setAreaVisible("true"===(function(o,p){return o[p]===undefined?null:o[p]})(f,"areaVisible"));var l=this.parseOptionalFloat(f,"areaAngle");if(l!=null){c.setAreaAngle(l)}var m=this.parseOptionalFloat(f,"areaXOffset");if(m!=null){c.setAreaXOffset(m)}var g=this.parseOptionalFloat(f,"areaYOffset");if(g!=null){c.setAreaYOffset(g)}c.setFloorVisible(!("false"===(function(o,p){return o[p]===undefined?null:o[p]})(f,"floorVisible")));c.setFloorColor(this.parseOptionalColor(f,"floorColor"));c.setFloorTexture((function(o,p){return o[p]===undefined?null:o[p]})(this.textures,"floorTexture"));var h=this.parseOptionalFloat(f,"floorShininess");if(h!=null){c.setFloorShininess(h)}c.setCeilingVisible(!("false"===(function(o,p){return o[p]===undefined?null:o[p]})(f,"ceilingVisible")));c.setCeilingColor(this.parseOptionalColor(f,"ceilingColor"));c.setCeilingTexture((function(o,p){return o[p]===undefined?null:o[p]})(this.textures,"ceilingTexture"));var j=this.parseOptionalFloat(f,"ceilingShininess");if(j!=null){c.setCeilingShininess(j)}c.setCeilingFlat("true"===(function(o,p){return o[p]===undefined?null:o[p]})(f,"ceilingFlat"))};a.prototype.createPolyline=function(c,e,f){var g=(function(h,j){return h[j]===undefined?null:h[j]})(e,"id");var d=g!=null?new Polyline(g,f):new Polyline(f);return this.resolveObject(d,c,e)};a.prototype.setPolylineAttributes=function(o,t,g){this.setProperties(o,t,g);var n=this.parseOptionalFloat(g,"thickness");if(n!=null){o.setThickness(n)}var r=(function(u,v){return u[v]===undefined?null:u[v]})(g,"capStyle");if(r!=null){try{o.setCapStyle(Polyline.CapStyle[r])}catch(m){}}var j=(function(u,v){return u[v]===undefined?null:u[v]})(g,"joinStyle");if(j!=null){try{o.setJoinStyle(Polyline.JoinStyle[j])}catch(m){}}var s=(function(u,v){return u[v]===undefined?null:u[v]})(g,"dashStyle");if(s!=null){try{o.setDashStyle(Polyline.DashStyle[s])}catch(m){}}var c=(function(u,v){return u[v]===undefined?null:u[v]})(g,"dashPattern");if(c!=null){try{var p=c.split(/ /);var l=(function(v){var u=[];while(v-->0){u.push(0)}return u})(p.length);for(var h=0;h<p.length;h++){l[h]=parseFloat(p[h])}o.setDashPattern(l)}catch(m){throw new SAXException("Invalid value for dash pattern",m)}}var f=this.parseOptionalFloat(g,"dashOffset");if(f!=null){o.setDashOffset(f)}var k=(function(u,v){return u[v]===undefined?null:u[v]})(g,"startArrowStyle");if(k!=null){try{o.setStartArrowStyle(Polyline.ArrowStyle[k])}catch(m){}}var d=(function(u,v){return u[v]===undefined?null:u[v]})(g,"endArrowStyle");if(d!=null){try{o.setEndArrowStyle(Polyline.ArrowStyle[d])}catch(m){}}var q=this.parseOptionalFloat(g,"elevation");if(q!=null){o.setVisibleIn3D(true);o.setElevation(q)}var e=this.parseOptionalColor(g,"color");if(e!=null){o.setColor(e)}o.setClosedPath("true"===(function(u,v){return u[v]===undefined?null:u[v]})(g,"closedPath"))};a.prototype.createDimensionLine=function(p,h){var d=(function(q,r){return q[r]===undefined?null:q[r]})(h,"id");var k=this.parseFloat(h,"xStart");var o=this.parseFloat(h,"yStart");var l=this.parseOptionalFloat(h,"elevationStart");var e=l!=null?l:0;var c=this.parseFloat(h,"xEnd");var n=this.parseFloat(h,"yEnd");l=this.parseOptionalFloat(h,"elevationEnd");var j=l!=null?l:0;var g=this.parseFloat(h,"offset");var m=d!=null?new DimensionLine(d,k,o,e,c,n,j,g):new DimensionLine(k,o,e,c,n,j,g);l=this.parseOptionalFloat(h,"endMarkSize");if(l!=null){m.setEndMarkSize(l)}l=this.parseOptionalFloat(h,"pitch");if(l!=null){m.setPitch(l)}var f=this.parseOptionalColor(h,"color");if(f!=null){m.setColor(f)}m.setVisibleIn3D("true"===(function(q,r){return q[r]===undefined?null:q[r]})(h,"visibleIn3D"));return this.resolveObject(m,p,h)};a.prototype.setDimensionLineAttributes=function(d,c,e){this.setProperties(d,c,e);d.setLengthStyle((function(f,g){return f[g]===undefined?null:f[g]})((function(f){return f.length==0?null:f[f.length-1]})(this.textStyles),"lengthStyle"))};a.prototype.createLabel=function(d,e,g){var j=(function(l,n){return l[n]===undefined?null:l[n]})(e,"id");var c=this.parseFloat(e,"x");var h=this.parseFloat(e,"y");var f=j!=null?new Label(j,g,c,h):new Label(g,c,h);return this.resolveObject(f,d,e)};a.prototype.setLabelAttributes=function(e,c,d){this.setProperties(e,c,d);e.setStyle((function(j,l){return j[l]===undefined?null:j[l]})((function(j){return j.length==0?null:j[j.length-1]})(this.textStyles),a.UNIQUE_ATTRIBUTE));var h=this.parseOptionalFloat(d,"angle");if(h!=null){e.setAngle(h)}var f=this.parseOptionalFloat(d,"elevation");if(f!=null){e.setElevation(f)}var g=this.parseOptionalFloat(d,"pitch");if(g!=null){e.setPitch(g)}e.setColor(this.parseOptionalColor(d,"color"));e.setOutlineColor(this.parseOptionalColor(d,"outlineColor"))};a.prototype.createBaseboard=function(c,d){var e=Baseboard.getInstance(this.parseFloat(d,"thickness"),this.parseFloat(d,"height"),this.parseOptionalColor(d,"color"),(function(f,g){return f[g]===undefined?null:f[g]})(this.textures,a.UNIQUE_ATTRIBUTE));return this.resolveObject(e,c,d)};a.prototype.createTextStyle=function(c,d){var h=TextStyle.Alignment.CENTER;var f=(function(j,l){return j[l]===undefined?null:j[l]})(d,"alignment");if(f!=null){try{h=TextStyle.Alignment[f]}catch(e){}}var g=new TextStyle((function(j,l){return j[l]===undefined?null:j[l]})(d,"fontName"),this.parseFloat(d,"fontSize"),"true"===(function(j,l){return j[l]===undefined?null:j[l]})(d,"bold"),"true"===(function(j,l){return j[l]===undefined?null:j[l]})(d,"italic"),h);return this.resolveObject(g,c,d)};a.prototype.createTexture=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(d,"catalogId");var e=new HomeTexture(new CatalogTexture(f,(function(g,h){return g[h]===undefined?null:g[h]})(d,"name"),this.parseContent(c,d,"image"),this.parseFloat(d,"width"),this.parseFloat(d,"height"),(function(g,h){return g[h]===undefined?null:g[h]})(d,"creator")),(function(g,h){return g[h]===undefined?null:g[h]})(d,"xOffset")!=null?this.parseFloat(d,"xOffset"):0,(function(g,h){return g[h]===undefined?null:g[h]})(d,"yOffset")!=null?this.parseFloat(d,"yOffset"):0,(function(g,h){return g[h]===undefined?null:g[h]})(d,"angle")!=null?this.parseFloat(d,"angle"):0,(function(g,h){return g[h]===undefined?null:g[h]})(d,"scale")!=null?this.parseFloat(d,"scale"):1,"true"===(function(g,h){return g[h]===undefined?null:g[h]})(d,"fittingArea"),!("false"===(function(g,h){return g[h]===undefined?null:g[h]})(d,"leftToRightOriented")));return this.resolveObject(e,c,d)};a.prototype.createMaterial=function(c,d){var e=new HomeMaterial((function(f,g){return f[g]===undefined?null:f[g]})(d,"name"),(function(f,g){return f[g]===undefined?null:f[g]})(d,"key"),this.parseOptionalColor(d,"color"),this.materialTexture,this.parseOptionalFloat(d,"shininess"));return this.resolveObject(e,c,d)};a.prototype.setProperties=function(f,c,d){var h=(function(l){var j=[];for(var k in l){j.push({k:k,v:l[k],getKey:function(){return this.k},getValue:function(){return this.v}})}return j})((function(j){return j.length==0?null:j[j.length-1]})(this.properties));for(var e=0;e<h.length;e++){var g=h[e];f.setProperty$java_lang_String$java_lang_Object(g.getKey(),g.getValue())}};a.prototype.parseOptionalColor=function(d,e){var c=(function(g,h){return g[h]===undefined?null:g[h]})(d,e);if(c!=null){try{return(parseInt(c,16)|0)}catch(f){throw new SAXException("Invalid value for color attribute "+e,f)}}else{return null}};a.prototype.parseOptionalInteger=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseInt(f)}catch(e){throw new SAXException("Invalid value for integer attribute "+d,e)}}else{return null}};a.prototype.parseOptionalLong=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseInt(f)}catch(e){throw new SAXException("Invalid value for long attribute "+d,e)}}else{return null}};a.prototype.parseOptionalDecimal=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return new Big(f)}catch(e){throw new SAXException("Invalid value for decimal attribute "+d,e)}}else{return null}};a.prototype.parseOptionalFloat=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseFloat(f)}catch(e){throw new SAXException("Invalid value for float attribute "+d,e)}}else{return null}};a.prototype.parseFloat=function(c,d){var f=(function(g,h){return g[h]===undefined?null:g[h]})(c,d);if(f!=null){try{return parseFloat(f)}catch(e){throw new SAXException("Invalid value for float attribute "+d,e)}}else{throw new SAXException("Missing float attribute "+d)}};a.prototype.parseContent=function(c,d,e){var f=d[e];if(f===undefined){return null}else{if(f.indexOf("://")>=0){return URLContent.fromURL(f)}else{return new HomeURLContent("jar:"+this["homeUrl"]+"!/"+f)}}};a.prototype.setHome=function(c){this.home=c;this.homeElementName=(function(d){return d.length==0?null:d[d.length-1]})(this.elements)};a.prototype.getHome=function(){return this.home};a.UNIQUE_ATTRIBUTE="@&unique&@";return a}(DefaultHandler));HomeXMLHandler.__class="com.eteks.sweethome3d.io.HomeXMLHandler";HomeXMLHandler.__interfaces=["org.xml.sax.ErrorHandler","org.xml.sax.DTDHandler","org.xml.sax.ContentHandler","org.xml.sax.EntityResolver"];(function(b){var a=(function(){function c(d,f,e){if(this.wall===undefined){this.wall=null}if(this.wallAtStartId===undefined){this.wallAtStartId=null}if(this.wallAtEndId===undefined){this.wallAtEndId=null}this.wall=d;this.wallAtStartId=f;this.wallAtEndId=e}c.prototype.getWall=function(){return this.wall};c.prototype.getWallAtStartId=function(){return this.wallAtStartId};c.prototype.getWallAtEndId=function(){return this.wallAtEndId};return c}());b.JoinedWall=a;a.__class="com.eteks.sweethome3d.io.HomeXMLHandler.JoinedWall"})(HomeXMLHandler||(HomeXMLHandler={}));var BoxBounds=(function(){function a(d,b,g,f,e,c){if(this.xLower===undefined){this.xLower=0}if(this.yLower===undefined){this.yLower=0}if(this.zLower===undefined){this.zLower=0}if(this.xUpper===undefined){this.xUpper=0}if(this.yUpper===undefined){this.yUpper=0}if(this.zUpper===undefined){this.zUpper=0}this.xLower=d;this.yLower=b;this.zLower=g;this.xUpper=f;this.yUpper=e;this.zUpper=c}a.prototype.getXLower=function(){return this.xLower};a.prototype.getYLower=function(){return this.yLower};a.prototype.getZLower=function(){return this.zLower};a.prototype.getXUpper=function(){return this.xUpper};a.prototype.getYUpper=function(){return this.yUpper};a.prototype.getZUpper=function(){return this.zUpper};a.prototype.equals=function(b){if(b!=null&&b instanceof a){var c=b;return c.xLower===this.xLower&&c.yLower===this.yLower&&c.zLower===this.zLower&&c.xUpper===this.xUpper&&c.yUpper===this.yUpper&&c.zUpper===this.zUpper}return false};a.prototype.hashCode=function(){var b=(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.xLower)+(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.yLower)+(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.zLower);b+=31*((function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.xUpper)+(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.yUpper)+(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.zUpper));return b};return a}());BoxBounds.__class="com.eteks.sweethome3d.model.BoxBounds";var PatternsCatalog=(function(){function a(b){if(this.patterns===undefined){this.patterns=null}this.patterns=(b.slice(0))}a.prototype.getPatterns=function(){return this.patterns.slice(0)};a.prototype.getPatternsCount=function(){return this.patterns.length};a.prototype.getPattern$int=function(b){return this.patterns[b]};a.prototype.getPattern$java_lang_String=function(c){for(var b=0;b<this.patterns.length;b++){var d=this.patterns[b];if(c===d.getName()){return d}}throw new IllegalArgumentException("No pattern with name "+c)};a.prototype.getPattern=function(b){if(((typeof b==="string")||b===null)){return this.getPattern$java_lang_String(b)}else{if(((typeof b==="number")||b===null)){return this.getPattern$int(b)}else{throw new Error("invalid overload")}}};return a}());PatternsCatalog.__class="com.eteks.sweethome3d.model.PatternsCatalog";var HomePrint=(function(){function a(w,r,b,t,j,d,m,k,p,o,l,s,v,h){if(((typeof w==="number")||w===null)&&((typeof r==="number")||r===null)&&((typeof b==="number")||b===null)&&((typeof t==="number")||t===null)&&((typeof j==="number")||j===null)&&((typeof d==="number")||d===null)&&((typeof m==="number")||m===null)&&((typeof k==="boolean")||k===null)&&((typeof p==="boolean")||p===null)&&((o!=null&&(o instanceof Array))||o===null)&&((typeof l==="boolean")||l===null)&&((typeof s==="number")||s===null)&&((typeof v==="string")||v===null)&&((typeof h==="string")||h===null)){var g=arguments;if(this.paperOrientation===undefined){this.paperOrientation=null}if(this.paperWidth===undefined){this.paperWidth=0}if(this.paperHeight===undefined){this.paperHeight=0}if(this.paperTopMargin===undefined){this.paperTopMargin=0}if(this.paperLeftMargin===undefined){this.paperLeftMargin=0}if(this.paperBottomMargin===undefined){this.paperBottomMargin=0}if(this.paperRightMargin===undefined){this.paperRightMargin=0}if(this.furniturePrinted===undefined){this.furniturePrinted=false}if(this.planPrinted===undefined){this.planPrinted=false}if(this.printedLevels===undefined){this.printedLevels=null}if(this.view3DPrinted===undefined){this.view3DPrinted=false}if(this.planScale===undefined){this.planScale=null}if(this.headerFormat===undefined){this.headerFormat=null}if(this.footerFormat===undefined){this.footerFormat=null}this.paperOrientation=w;this.paperWidth=r;this.paperHeight=b;this.paperTopMargin=t;this.paperLeftMargin=j;this.paperBottomMargin=d;this.paperRightMargin=m;this.furniturePrinted=k;this.planPrinted=p;this.printedLevels=o!=null?o.slice(0):null;this.view3DPrinted=l;this.planScale=s;this.headerFormat=v;this.footerFormat=h}else{if(((typeof w==="number")||w===null)&&((typeof r==="number")||r===null)&&((typeof b==="number")||b===null)&&((typeof t==="number")||t===null)&&((typeof j==="number")||j===null)&&((typeof d==="number")||d===null)&&((typeof m==="number")||m===null)&&((typeof k==="boolean")||k===null)&&((typeof p==="boolean")||p===null)&&((typeof o==="boolean")||o===null)&&((typeof l==="number")||l===null)&&((typeof s==="string")||s===null)&&((typeof v==="string")||v===null)&&h===undefined){var g=arguments;var u=g[9];var n=g[10];var f=g[11];var q=g[12];var e=arguments;var c=null;if(this.paperOrientation===undefined){this.paperOrientation=null}if(this.paperWidth===undefined){this.paperWidth=0}if(this.paperHeight===undefined){this.paperHeight=0}if(this.paperTopMargin===undefined){this.paperTopMargin=0}if(this.paperLeftMargin===undefined){this.paperLeftMargin=0}if(this.paperBottomMargin===undefined){this.paperBottomMargin=0}if(this.paperRightMargin===undefined){this.paperRightMargin=0}if(this.furniturePrinted===undefined){this.furniturePrinted=false}if(this.planPrinted===undefined){this.planPrinted=false}if(this.printedLevels===undefined){this.printedLevels=null}if(this.view3DPrinted===undefined){this.view3DPrinted=false}if(this.planScale===undefined){this.planScale=null}if(this.headerFormat===undefined){this.headerFormat=null}if(this.footerFormat===undefined){this.footerFormat=null}this.paperOrientation=w;this.paperWidth=r;this.paperHeight=b;this.paperTopMargin=t;this.paperLeftMargin=j;this.paperBottomMargin=d;this.paperRightMargin=m;this.furniturePrinted=k;this.planPrinted=p;this.printedLevels=c!=null?c.slice(0):null;this.view3DPrinted=u;this.planScale=n;this.headerFormat=f;this.footerFormat=q;if(this.paperOrientation===undefined){this.paperOrientation=null}if(this.paperWidth===undefined){this.paperWidth=0}if(this.paperHeight===undefined){this.paperHeight=0}if(this.paperTopMargin===undefined){this.paperTopMargin=0}if(this.paperLeftMargin===undefined){this.paperLeftMargin=0}if(this.paperBottomMargin===undefined){this.paperBottomMargin=0}if(this.paperRightMargin===undefined){this.paperRightMargin=0}if(this.furniturePrinted===undefined){this.furniturePrinted=false}if(this.planPrinted===undefined){this.planPrinted=false}if(this.printedLevels===undefined){this.printedLevels=null}if(this.view3DPrinted===undefined){this.view3DPrinted=false}if(this.planScale===undefined){this.planScale=null}if(this.headerFormat===undefined){this.headerFormat=null}if(this.footerFormat===undefined){this.footerFormat=null}}else{throw new Error("invalid overload")}}}a.prototype.getPaperOrientation=function(){return this.paperOrientation};a.prototype.getPaperBottomMargin=function(){return this.paperBottomMargin};a.prototype.getPaperHeight=function(){return this.paperHeight};a.prototype.getPaperLeftMargin=function(){return this.paperLeftMargin};a.prototype.getPaperRightMargin=function(){return this.paperRightMargin};a.prototype.getPaperTopMargin=function(){return this.paperTopMargin};a.prototype.getPaperWidth=function(){return this.paperWidth};a.prototype.isFurniturePrinted=function(){return this.furniturePrinted};a.prototype.isPlanPrinted=function(){return this.planPrinted};a.prototype.getPrintedLevels=function(){return this.printedLevels};a.prototype.isView3DPrinted=function(){return this.view3DPrinted};a.prototype.getPlanScale=function(){return this.planScale};a.prototype.getHeaderFormat=function(){return this.headerFormat};a.prototype.getFooterFormat=function(){return this.footerFormat};return a}());HomePrint.__class="com.eteks.sweethome3d.model.HomePrint";(function(a){var b;(function(c){c[c.PORTRAIT=0]="PORTRAIT";c[c.LANDSCAPE=1]="LANDSCAPE";c[c.REVERSE_LANDSCAPE=2]="REVERSE_LANDSCAPE"})(b=a.PaperOrientation||(a.PaperOrientation={}))})(HomePrint||(HomePrint={}));var TexturesCategory=(function(){function a(b){if(this.name===undefined){this.name=null}if(this.textures===undefined){this.textures=null}this.name=b;this.textures=([])}a.COMPARATOR_$LI$=function(){if(a.COMPARATOR==null){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}}}return a.COMPARATOR};a.prototype.getName=function(){return this.name};a.prototype.getTextures=function(){return this.textures.slice(0)};a.prototype.getTexturesCount=function(){return this.textures.length};a.prototype.getTexture=function(b){return this.textures[b]};a.prototype.getIndexOfTexture=function(b){return this.textures.indexOf(b)};a.prototype.add=function(c){c.setCategory(this);var b=(function(e,h){var f=function(n,l){if(n.compareTo){return n.compareTo(l)}else{return n.localeCompare(l)}};var d=0;var k=e.length-1;while(d<=k){var g=(d+k)>>>1;var m=e[g];var j=f(m,h);if(j<0){d=g+1}else{if(j>0){k=g-1}else{return g}}}return -(d+1)})(this.textures,c);if(b<0){b=-b-1}this.textures.splice(b,0,c)};a.prototype["delete"]=function(b){var c=this.textures.indexOf(b);if(c===-1){throw new IllegalArgumentException(this.name+" doesn't contain texture "+b.getName())}this.textures=(this.textures.slice(0));this.textures.splice(c,1)[0]};a.prototype.equals=function(b){return(b!=null&&b instanceof a)&&a.COMPARATOR_$LI$().equals(this.name,b.name)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name)};a.prototype.compareTo=function(b){return a.COMPARATOR_$LI$().compare(this.name,b.name)};return a}());TexturesCategory.__class="com.eteks.sweethome3d.model.TexturesCategory";var HomeRecorder;(function(b){var a;(function(c){c[c.DEFAULT=0]="DEFAULT";c[c.COMPRESSED=1]="COMPRESSED"})(a=b.Type||(b.Type={}))})(HomeRecorder||(HomeRecorder={}));var CatalogTexture=(function(){function a(u,C,s,w,r,l,x){if(((typeof u==="string")||u===null)&&((typeof C==="string")||C===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||s===null)&&((typeof w==="number")||w===null)&&((typeof r==="number")||r===null)&&((typeof l==="string")||l===null)&&((typeof x==="boolean")||x===null)){var k=arguments;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=u;this.name=C;this.image=s;this.width=w;this.height=r;this.creator=l;this.modifiable=x}else{if(((typeof u==="string")||u===null)&&((typeof C==="string")||C===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||s===null)&&((typeof w==="number")||w===null)&&((typeof r==="number")||r===null)&&((typeof l==="string")||l===null)&&x===undefined){var k=arguments;var e=arguments;var v=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=u;this.name=C;this.image=s;this.width=w;this.height=r;this.creator=l;this.modifiable=v;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof u==="string")||u===null)&&((C!=null&&(C.constructor!=null&&C.constructor.__interfaces!=null&&C.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||C===null)&&((typeof s==="number")||s===null)&&((typeof w==="number")||w===null)&&((typeof r==="boolean")||r===null)&&l===undefined&&x===undefined){var k=arguments;var z=k[0];var o=k[1];var p=k[2];var B=k[3];var t=k[4];var d=arguments;var g=null;var j=null;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=g;this.name=z;this.image=o;this.width=p;this.height=B;this.creator=j;this.modifiable=t;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof u==="string")||u===null)&&((C!=null&&(C.constructor!=null&&C.constructor.__interfaces!=null&&C.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||C===null)&&((typeof s==="number")||s===null)&&((typeof w==="number")||w===null)&&r===undefined&&l===undefined&&x===undefined){var k=arguments;var y=k[0];var m=k[1];var n=k[2];var A=k[3];var c=arguments;var f=null;var h=null;var b=arguments;var q=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=f;this.name=y;this.image=m;this.width=n;this.height=A;this.creator=h;this.modifiable=q;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.creator===undefined){this.creator=null}if(this.modifiable===undefined){this.modifiable=false}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{throw new Error("invalid overload")}}}}}a.__static_initialize=function(){if(!a.__static_initialized){a.__static_initialized=true;a.__static_initializer_0()}};a.EMPTY_CRITERIA_$LI$=function(){a.__static_initialize();if(a.EMPTY_CRITERIA==null){a.EMPTY_CRITERIA=[]}return a.EMPTY_CRITERIA};a.COMPARATOR_$LI$=function(){a.__static_initialize();return a.COMPARATOR};a.recentFilters_$LI$=function(){a.__static_initialize();return a.recentFilters};a.__static_initializer_0=function(){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}};a.COMPARATOR_$LI$();a.recentFilters={}};a.prototype.getId=function(){return this.id};a.prototype.getName=function(){return this.name};a.prototype.getImage=function(){return this.image};a.prototype.getIcon=function(){return this.getImage()};a.prototype.getWidth=function(){return this.width};a.prototype.getHeight=function(){return this.height};a.prototype.getCreator=function(){return this.creator};a.prototype.isModifiable=function(){return this.modifiable};a.prototype.getCategory=function(){return this.category};a.prototype.setCategory=function(b){this.category=b};a.prototype.equals=function(b){return(function(d,c){return d&&d.equals?d.equals(c):d===c})(this,b)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this)};a.prototype.compareTo=function(c){var b=a.COMPARATOR_$LI$().compare(this.name,c.name);if(b!==0){return b}else{return this.modifiable===c.modifiable?0:(this.modifiable?1:-1)}};a.prototype.matchesFilter=function(d){var e=this.getFilterCollationKeys(d);var f=0;if(e.length>0){var b=this.getTextureCollationKey();for(var c=0;c<e.length;c++){if(this.isSubCollationKey(b,e[c],0)){f++}else{break}}}return f===e.length};a.prototype.getFilterCollationKeys=function(d){if(d.length===0){return a.EMPTY_CRITERIA_$LI$()}var c=(function(h,j){return h[j]===undefined?null:h[j]})(a.recentFilters_$LI$(),d);if(c==null){var g=d.split(/\s|\p{Punct}|\\|/);var f=([]);for(var b=0;b<g.length;b++){var e=g[b];if(e.length>0){(f.push(a.COMPARATOR_$LI$().getCollationKey(e).toByteArray())>0)}}if(f.length===0){c=a.EMPTY_CRITERIA_$LI$()}else{c=f.slice(0)}(a.recentFilters_$LI$()[d]=c)}return c};a.prototype.getTextureCollationKey=function(){var c=this;if(this.filterCollationKey==null){var b={str:"",toString:function(){return this.str}};(function(d){d.str+=c.getName();return d})(b);(function(d){d.str+="|";return d})(b);if(this.getCategory()!=null){(function(d){d.str+=c.getCategory().getName();return d})(b);(function(d){d.str+="|";return d})(b)}if(this.getCreator()!=null){(function(d){d.str+=c.getCreator();return d})(b);(function(d){d.str+="|";return d})(b)}this.filterCollationKey=a.COMPARATOR_$LI$().getCollationKey(b.str).toByteArray()}return this.filterCollationKey};a.prototype.isSubCollationKey=function(e,h,g){for(var d=g,f=e.length-4,b=h.length-4;d<f&&d<f-b+1;d++){if(e[d]===h[0]){for(var c=1;c<b;c++){if(e[d+c]!==h[c]){return this.isSubCollationKey(e,h,d+1)}}return true}}return false};a.__static_initialized=false;return a}());CatalogTexture.__class="com.eteks.sweethome3d.model.CatalogTexture";CatalogTexture.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.TextureImage"];var Transformation=(function(){function a(c,b){if(this.name===undefined){this.name=null}if(this.matrix===undefined){this.matrix=null}this.name=c;this.matrix=b}a.prototype.getName=function(){return this.name};a.prototype.getMatrix=function(){return[[this.matrix[0][0],this.matrix[0][1],this.matrix[0][2],this.matrix[0][3]],[this.matrix[1][0],this.matrix[1][1],this.matrix[1][2],this.matrix[1][3]],[this.matrix[2][0],this.matrix[2][1],this.matrix[2][2],this.matrix[2][3]]]};a.prototype.equals=function(c){if(c!=null&&c instanceof a){var e=c;if(e.name===this.name){for(var d=0;d<this.matrix.length;d++){for(var b=0;b<this.matrix[d].length;b++){if(e.matrix[d][b]!==this.matrix[d][b]){return false}}}return true}}return false};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name)+(function(c){function b(g){if(g==null){return 0}var d=1;for(var e=0;e<g.length;e++){var f=1;if(Array.isArray(g[e])){f=b(g[e])}else{if(typeof g[e]=="number"){f=(g[e]*1000)|0}}d=31*d+f}return d}return b})(this.matrix)};return a}());Transformation.__class="com.eteks.sweethome3d.model.Transformation";var LightSource=(function(){function a(b,j,g,c,d){if(((typeof b==="number")||b===null)&&((typeof j==="number")||j===null)&&((typeof g==="number")||g===null)&&((typeof c==="number")||c===null)&&((typeof d==="number")||d===null)){var f=arguments;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.z===undefined){this.z=0}if(this.color===undefined){this.color=0}if(this.diameter===undefined){this.diameter=null}this.x=b;this.y=j;this.z=g;this.color=c;this.diameter=d}else{if(((typeof b==="number")||b===null)&&((typeof j==="number")||j===null)&&((typeof g==="number")||g===null)&&((typeof c==="number")||c===null)&&d===undefined){var f=arguments;var h=arguments;var e=null;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.z===undefined){this.z=0}if(this.color===undefined){this.color=0}if(this.diameter===undefined){this.diameter=null}this.x=b;this.y=j;this.z=g;this.color=c;this.diameter=e;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.z===undefined){this.z=0}if(this.color===undefined){this.color=0}if(this.diameter===undefined){this.diameter=null}}else{throw new Error("invalid overload")}}}a.prototype.getX=function(){return this.x};a.prototype.getY=function(){return this.y};a.prototype.getZ=function(){return this.z};a.prototype.getColor=function(){return this.color};a.prototype.getDiameter=function(){return this.diameter};return a}());LightSource.__class="com.eteks.sweethome3d.model.LightSource";var TextStyle=(function(){function a(y,j,C,q,v,w){if(((typeof y==="string")||y===null)&&((typeof j==="number")||j===null)&&((typeof C==="boolean")||C===null)&&((typeof q==="boolean")||q===null)&&((typeof v==="number")||v===null)&&((typeof w==="boolean")||w===null)){var u=arguments;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=y;this.fontSize=j;this.bold=C;this.italic=q;this.alignment=v;if(w){(a.textStylesCache_$LI$().push(this)>0)}}else{if(((typeof y==="string")||y===null)&&((typeof j==="number")||j===null)&&((typeof C==="boolean")||C===null)&&((typeof q==="boolean")||q===null)&&((typeof v==="number")||v===null)&&w===undefined){var u=arguments;var d=arguments;var B=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=y;this.fontSize=j;this.bold=C;this.italic=q;this.alignment=v;if(B){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{if(((typeof y==="string")||y===null)&&((typeof j==="number")||j===null)&&((typeof C==="boolean")||C===null)&&((typeof q==="boolean")||q===null)&&v===undefined&&w===undefined){var u=arguments;var b=arguments;var H=a.Alignment.CENTER;var t=arguments;var A=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=y;this.fontSize=j;this.bold=C;this.italic=q;this.alignment=H;if(A){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{if(((typeof y==="number")||y===null)&&((typeof j==="boolean")||j===null)&&((typeof C==="boolean")||C===null)&&q===undefined&&v===undefined&&w===undefined){var u=arguments;var r=u[0];var k=u[1];var g=u[2];var s=arguments;var G=null;var p=arguments;var F=a.Alignment.CENTER;var n=arguments;var z=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=G;this.fontSize=r;this.bold=k;this.italic=g;this.alignment=F;if(z){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{if(((typeof y==="number")||y===null)&&j===undefined&&C===undefined&&q===undefined&&v===undefined&&w===undefined){var u=arguments;var o=u[0];var m=arguments;var f=false;var c=false;var l=arguments;var E=null;var h=arguments;var D=a.Alignment.CENTER;var e=arguments;var x=true;if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}this.fontName=E;this.fontSize=o;this.bold=f;this.italic=c;this.alignment=D;if(x){(a.textStylesCache_$LI$().push(this)>0)}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontSize===undefined){this.fontSize=0}if(this.bold===undefined){this.bold=false}if(this.italic===undefined){this.italic=false}if(this.alignment===undefined){this.alignment=null}}else{throw new Error("invalid overload")}}}}}}a.textStylesCache_$LI$=function(){if(a.textStylesCache==null){a.textStylesCache=[]}return a.textStylesCache};a.prototype.getInstance=function(e,f,d,b,j){var h=new a(e,f,d,b,j,false);for(var c=a.textStylesCache_$LI$().length-1;c>=0;c--){var g=a.textStylesCache_$LI$()[c];if(g==null){a.textStylesCache_$LI$().splice(c,1)[0]}else{if(g.equals(h)){return h}}}(a.textStylesCache_$LI$().push(h)>0);return h};a.prototype.getFontName=function(){return this.fontName};a.prototype.getFontSize=function(){return this.fontSize};a.prototype.isBold=function(){return this.bold};a.prototype.isItalic=function(){return this.italic};a.prototype.getAlignment=function(){return this.alignment};a.prototype.deriveStyle$java_lang_String=function(b){if(this.getFontName()===b||(b!=null&&(b===this.getFontName()))){return this}else{return this.getInstance(b,this.getFontSize(),this.isBold(),this.isItalic(),this.getAlignment())}};a.prototype.deriveStyle=function(b){if(((typeof b==="string")||b===null)){return this.deriveStyle$java_lang_String(b)}else{if(((typeof b==="number")||b===null)){return this.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(b)}else{if(((typeof b==="number")||b===null)){return this.deriveStyle$float(b)}else{throw new Error("invalid overload")}}}};a.prototype.deriveStyle$float=function(b){if(this.getFontSize()===b){return this}else{return this.getInstance(this.getFontName(),b,this.isBold(),this.isItalic(),this.getAlignment())}};a.prototype.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment=function(b){if(this.getAlignment()===b){return this}else{return this.getInstance(this.getFontName(),this.getFontSize(),this.isBold(),this.isItalic(),b)}};a.prototype.deriveBoldStyle=function(b){if(this.isBold()===b){return this}else{return this.getInstance(this.getFontName(),this.getFontSize(),b,this.isItalic(),this.getAlignment())}};a.prototype.deriveItalicStyle=function(b){if(this.isItalic()===b){return this}else{return this.getInstance(this.getFontName(),this.getFontSize(),this.isBold(),b,this.getAlignment())}};a.prototype.equals=function(b){if(b!=null&&b instanceof a){var c=b;return(c.fontName===this.fontName||(c.fontName!=null&&(c.fontName===this.fontName)))&&c.fontSize===this.fontSize&&c.bold===this.bold&&c.italic===this.italic&&c.alignment===this.alignment}return false};a.prototype.hashCode=function(){var b=(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.fontSize);if(this.fontName!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.fontName)}if(this.bold){b++}if(this.italic){b++}b+=0;return b};return a}());TextStyle.__class="com.eteks.sweethome3d.model.TextStyle";(function(a){var b;(function(c){c[c.LEFT=0]="LEFT";c[c.CENTER=1]="CENTER";c[c.RIGHT=2]="RIGHT"})(b=a.Alignment||(a.Alignment={}))})(TextStyle||(TextStyle={}));var HomeTexture=(function(){function a(x,F,H,w,J,o,G){if(((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||x===null)&&((typeof F==="number")||F===null)&&((typeof H==="number")||H===null)&&((typeof w==="number")||w===null)&&((typeof J==="number")||J===null)&&((typeof o==="boolean")||o===null)&&((typeof G==="boolean")||G===null)){var O=arguments;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=x.getName();this.creator=x.getCreator();this.image=x.getImage();this.width=x.getWidth();this.height=x.getHeight();this.xOffset=F;this.yOffset=H;this.angle=w;this.scale=J;this.fittingArea=o;this.leftToRightOriented=G;if(x!=null&&x instanceof a){this.catalogId=x.getCatalogId()}else{if(x!=null&&x instanceof CatalogTexture){this.catalogId=x.getId()}else{this.catalogId=null}}}else{if(((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||x===null)&&((typeof F==="number")||F===null)&&((typeof H==="number")||H===null)&&((typeof w==="number")||w===null)&&((typeof J==="number")||J===null)&&((typeof o==="boolean")||o===null)&&G===undefined){var O=arguments;var t=O[5];var z=arguments;var E=false;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=x.getName();this.creator=x.getCreator();this.image=x.getImage();this.width=x.getWidth();this.height=x.getHeight();this.xOffset=F;this.yOffset=H;this.angle=w;this.scale=J;this.fittingArea=E;this.leftToRightOriented=t;if(x!=null&&x instanceof a){this.catalogId=x.getCatalogId()}else{if(x!=null&&x instanceof CatalogTexture){this.catalogId=x.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{if(((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||x===null)&&((typeof F==="number")||F===null)&&((typeof H==="number")||H===null)&&((typeof w==="boolean")||w===null)&&J===undefined&&o===undefined&&G===undefined){var O=arguments;var Y=O[1];var X=O[2];var r=O[3];var y=arguments;var v=0;var M=0;var l=arguments;var D=false;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=x.getName();this.creator=x.getCreator();this.image=x.getImage();this.width=x.getWidth();this.height=x.getHeight();this.xOffset=v;this.yOffset=M;this.angle=Y;this.scale=X;this.fittingArea=D;this.leftToRightOriented=r;if(x!=null&&x instanceof a){this.catalogId=x.getCatalogId()}else{if(x!=null&&x instanceof CatalogTexture){this.catalogId=x.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{if(((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||x===null)&&((typeof F==="number")||F===null)&&((typeof H==="boolean")||H===null)&&w===undefined&&J===undefined&&o===undefined&&G===undefined){var O=arguments;var W=O[1];var q=O[2];var k=arguments;var V=1;var j=arguments;var u=0;var L=0;var h=arguments;var C=false;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=x.getName();this.creator=x.getCreator();this.image=x.getImage();this.width=x.getWidth();this.height=x.getHeight();this.xOffset=u;this.yOffset=L;this.angle=W;this.scale=V;this.fittingArea=C;this.leftToRightOriented=q;if(x!=null&&x instanceof a){this.catalogId=x.getCatalogId()}else{if(x!=null&&x instanceof CatalogTexture){this.catalogId=x.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{if(((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||x===null)&&((typeof F==="number")||F===null)&&H===undefined&&w===undefined&&J===undefined&&o===undefined&&G===undefined){var O=arguments;var T=O[1];var g=arguments;var n=true;var f=arguments;var U=1;var e=arguments;var s=0;var K=0;var d=arguments;var B=false;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=x.getName();this.creator=x.getCreator();this.image=x.getImage();this.width=x.getWidth();this.height=x.getHeight();this.xOffset=s;this.yOffset=K;this.angle=T;this.scale=U;this.fittingArea=B;this.leftToRightOriented=n;if(x!=null&&x instanceof a){this.catalogId=x.getCatalogId()}else{if(x!=null&&x instanceof CatalogTexture){this.catalogId=x.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{if(((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||x===null)&&F===undefined&&H===undefined&&w===undefined&&J===undefined&&o===undefined&&G===undefined){var O=arguments;var c=arguments;var S=0;var b=arguments;var m=true;var Q=arguments;var R=1;var P=arguments;var p=0;var I=0;var N=arguments;var A=false;if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}this.name=x.getName();this.creator=x.getCreator();this.image=x.getImage();this.width=x.getWidth();this.height=x.getHeight();this.xOffset=p;this.yOffset=I;this.angle=S;this.scale=R;this.fittingArea=A;this.leftToRightOriented=m;if(x!=null&&x instanceof a){this.catalogId=x.getCatalogId()}else{if(x!=null&&x instanceof CatalogTexture){this.catalogId=x.getId()}else{this.catalogId=null}}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}if(this.catalogId===undefined){this.catalogId=null}if(this.name===undefined){this.name=null}if(this.creator===undefined){this.creator=null}if(this.image===undefined){this.image=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.xOffset===undefined){this.xOffset=0}if(this.yOffset===undefined){this.yOffset=0}if(this.angle===undefined){this.angle=0}if(this.scale===undefined){this.scale=0}if(this.fittingArea===undefined){this.fittingArea=false}if(this.leftToRightOriented===undefined){this.leftToRightOriented=false}}else{throw new Error("invalid overload")}}}}}}}a.prototype.getCatalogId=function(){return this.catalogId};a.prototype.getName=function(){return this.name};a.prototype.getCreator=function(){return this.creator};a.prototype.getImage=function(){return this.image};a.prototype.getWidth=function(){return this.width};a.prototype.getHeight=function(){return this.height};a.prototype.getXOffset=function(){return this.xOffset};a.prototype.getYOffset=function(){return this.yOffset};a.prototype.getAngle=function(){return this.angle};a.prototype.getScale=function(){return this.scale};a.prototype.isFittingArea=function(){return this.fittingArea};a.prototype.setFittingArea=function(b){this.fittingArea=b};a.prototype.isLeftToRightOriented=function(){return this.leftToRightOriented};a.prototype.equals=function(c){if(c===this){return true}else{if(c!=null&&c instanceof a){var b=c;return(b.name===this.name||b.name!=null&&(b.name===this.name))&&(b.image===this.image||b.image!=null&&(function(e,d){if(e&&e.equals){return e.equals(d)}else{return e===d}})(b.image,this.image))&&b.width===this.width&&b.height===this.height&&b.xOffset===this.xOffset&&b.yOffset===this.yOffset&&b.fittingArea===this.fittingArea&&b.leftToRightOriented===this.leftToRightOriented&&b.angle===this.angle&&b.scale===this.scale}else{return false}}};a.prototype.hashCode=function(){return(this.name!=null?(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name):0)+(this.image!=null?(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.image):0)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.width)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.height)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.xOffset)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.yOffset)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.angle)+(function(c){var b=new ArrayBuffer(4);(new Float32Array(b))[0]=c;return(new Uint32Array(b))[0]})(this.scale)};return a}());HomeTexture.__class="com.eteks.sweethome3d.model.HomeTexture";HomeTexture.__interfaces=["com.eteks.sweethome3d.model.TextureImage"];var IllegalHomonymException=(function(){function a(b){if(((typeof b==="string")||b===null)){var c=arguments}else{if(b===undefined){var c=arguments}else{throw new Error("invalid overload")}}}return a}());IllegalHomonymException.__class="com.eteks.sweethome3d.model.IllegalHomonymException";var AspectRatio;(function(a){a[a.FREE_RATIO=0]="FREE_RATIO";a[a.VIEW_3D_RATIO=1]="VIEW_3D_RATIO";a[a.RATIO_4_3=2]="RATIO_4_3";a[a.RATIO_3_2=3]="RATIO_3_2";a[a.RATIO_16_9=4]="RATIO_16_9";a[a.RATIO_2_1=5]="RATIO_2_1";a[a.RATIO_24_10=6]="RATIO_24_10";a[a.SQUARE_RATIO=7]="SQUARE_RATIO"})(AspectRatio||(AspectRatio={}));var AspectRatio_$WRAPPER=(function(){function a(d,b,c){this._$ordinal=d;this._$name=b;if(this.value===undefined){this.value=null}this.value=c}a.prototype.getValue=function(){return this.value};a.prototype.name=function(){return this._$name};a.prototype.ordinal=function(){return this._$ordinal};a.prototype.compareTo=function(b){return this._$ordinal-(isNaN(b)?b._$ordinal:b)};return a}());AspectRatio.__class="com.eteks.sweethome3d.model.AspectRatio";AspectRatio["_$wrappers"]={0:new AspectRatio_$WRAPPER(0,"FREE_RATIO",null),1:new AspectRatio_$WRAPPER(1,"VIEW_3D_RATIO",null),2:new AspectRatio_$WRAPPER(2,"RATIO_4_3",4/3),3:new AspectRatio_$WRAPPER(3,"RATIO_3_2",1.5),4:new AspectRatio_$WRAPPER(4,"RATIO_16_9",16/9),5:new AspectRatio_$WRAPPER(5,"RATIO_2_1",2/1),6:new AspectRatio_$WRAPPER(6,"RATIO_24_10",2.4),7:new AspectRatio_$WRAPPER(7,"SQUARE_RATIO",1)};var Baseboard=(function(){function a(j,k,f,h,d){if(((typeof j==="number")||j===null)&&((typeof k==="number")||k===null)&&((typeof f==="number")||f===null)&&((h!=null&&h instanceof HomeTexture)||h===null)&&((typeof d==="boolean")||d===null)){var g=arguments;if(this.thickness===undefined){this.thickness=0}if(this.height===undefined){this.height=0}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}this.height=k;this.thickness=j;this.color=f;this.texture=h;if(d){(a.baseboardsCache_$LI$().push(this)>0)}}else{if(((typeof j==="number")||j===null)&&((typeof k==="number")||k===null)&&((typeof f==="number")||f===null)&&((h!=null&&h instanceof HomeTexture)||h===null)&&d===undefined){var g=arguments;var e=arguments;var l=e[1];var c=e[0];var b=true;if(this.thickness===undefined){this.thickness=0}if(this.height===undefined){this.height=0}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}this.height=c;this.thickness=l;this.color=f;this.texture=h;if(b){(a.baseboardsCache_$LI$().push(this)>0)}if(this.thickness===undefined){this.thickness=0}if(this.height===undefined){this.height=0}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}}else{throw new Error("invalid overload")}}}a.baseboardsCache_$LI$=function(){if(a.baseboardsCache==null){a.baseboardsCache=[]}return a.baseboardsCache};a.getInstance=function(e,b,c,g){var h=new a(e,b,c,g,false);for(var d=a.baseboardsCache_$LI$().length-1;d>=0;d--){var f=a.baseboardsCache_$LI$()[d];if(f==null){a.baseboardsCache_$LI$().splice(d,1)[0]}else{if(f.equals(h)){return h}}}(a.baseboardsCache_$LI$().push(h)>0);return h};a.prototype.getThickness=function(){return this.thickness};a.prototype.getHeight=function(){return this.height};a.prototype.getColor=function(){return this.color};a.prototype.getTexture=function(){return this.texture};a.prototype.equals=function(b){if(b!=null&&b instanceof a){var c=b;return c.thickness===this.thickness&&c.height===this.height&&(c.color===this.color||c.color!=null&&(c.color===this.color))&&(c.texture===this.texture||c.texture!=null&&c.texture.equals(this.texture))}return false};a.prototype.hashCode=function(){var b=(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.thickness)+(function(d){var c=new ArrayBuffer(4);(new Float32Array(c))[0]=d;return(new Uint32Array(c))[0]})(this.height);if(this.color!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.color)}if(this.texture!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.texture)}return b};return a}());Baseboard.__class="com.eteks.sweethome3d.model.Baseboard";var FurnitureCatalog=(function(){function a(){this.categories=([]);this.furnitureChangeSupport=(new CollectionChangeSupport(this))}a.prototype.getCategories=function(){return this.categories.slice(0)};a.prototype.getCategoriesCount=function(){return this.categories.length};a.prototype.getCategory=function(b){return this.categories[b]};a.prototype.addFurnitureListener=function(b){this.furnitureChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeFurnitureListener=function(b){this.furnitureChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.add=function(d,c){var b=(function(f,j){var g=function(o,l){if(o.compareTo){return o.compareTo(l)}else{return o.localeCompare(l)}};var e=0;var m=f.length-1;while(e<=m){var h=(e+m)>>>1;var n=f[h];var k=g(n,j);if(k<0){e=h+1}else{if(k>0){m=h-1}else{return h}}}return -(e+1)})(this.categories,d);if(b<0){d=new FurnitureCategory(d.getName());this.categories.splice(-b-1,0,d)}else{d=this.categories[b]}d.add(c);this.furnitureChangeSupport.fireCollectionChanged(c,d.getIndexOfPieceOfFurniture(c),CollectionEvent.Type.ADD)};a.prototype["delete"]=function(b){var d=b.getCategory();if(d!=null){var c=d.getIndexOfPieceOfFurniture(b);if(c>=0){d["delete"](b);if(d.getFurnitureCount()===0){this.categories=(this.categories.slice(0));(function(e){var f=e.indexOf(d);if(f>=0){e.splice(f,1);return true}else{return false}})(this.categories)}this.furnitureChangeSupport.fireCollectionChanged(b,c,CollectionEvent.Type.DELETE);return}}throw new IllegalArgumentException("catalog doesn't contain piece "+b.getName())};a.prototype.getPieceOfFurnitureWithId=function(g){for(var b=0;b<this.categories.length;b++){var d=this.categories[b];var f=d.getFurniture();for(var e=0;e<f.length;e++){var c=f[e];if(g===c.getId()){return c}}}return null};return a}());FurnitureCatalog.__class="com.eteks.sweethome3d.model.FurnitureCatalog";var HomeDescriptor=(function(){function a(b,d,c){if(this.name===undefined){this.name=null}if(this.content===undefined){this.content=null}if(this.icon===undefined){this.icon=null}this.name=b;this.content=d;this.icon=c}a.prototype.getName=function(){return this.name};a.prototype.getContent=function(){return this.content};a.prototype.getIcon=function(){return this.icon};return a}());HomeDescriptor.__class="com.eteks.sweethome3d.model.HomeDescriptor";var HomeApplication=(function(){function a(){this.homes=([]);this.homesChangeSupport=(new CollectionChangeSupport(this))}a.prototype.addHomesListener=function(b){this.homesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeHomesListener=function(b){this.homesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.createHome=function(){return new Home(this.getUserPreferences().getNewWallHeight())};a.prototype.getHomes=function(){return this.homes.slice(0)};a.prototype.addHome=function(b){this.homes=(this.homes.slice(0));(this.homes.push(b)>0);this.homesChangeSupport.fireCollectionChanged(b,this.homes.length-1,CollectionEvent.Type.ADD)};a.prototype.deleteHome=function(c){var b=this.homes.indexOf(c);if(b!==-1){this.homes=(this.homes.slice(0));this.homes.splice(b,1)[0];this.homesChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.DELETE)}};a.prototype.getHomeRecorder$=function(){throw new Error("cannot invoke abstract overloaded method... check your argument(s) type(s)")};a.prototype.getHomeRecorder$com_eteks_sweethome3d_model_HomeRecorder_Type=function(b){return this.getHomeRecorder$()};a.prototype.getHomeRecorder=function(b){if(((typeof b==="number")||b===null)){return this.getHomeRecorder$com_eteks_sweethome3d_model_HomeRecorder_Type(b)}else{if(b===undefined){return this.getHomeRecorder$()}else{throw new Error("invalid overload")}}};a.prototype.getName=function(){return"Sweet Home 3D"};a.prototype.getVersion=function(){return""};a.prototype.getId=function(){return null};return a}());HomeApplication.__class="com.eteks.sweethome3d.model.HomeApplication";var BackgroundImage=(function(){function a(g,n,m,c,h,d,b,k,f){if(((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||g===null)&&((typeof n==="number")||n===null)&&((typeof m==="number")||m===null)&&((typeof c==="number")||c===null)&&((typeof h==="number")||h===null)&&((typeof d==="number")||d===null)&&((typeof b==="number")||b===null)&&((typeof k==="number")||k===null)&&((typeof f==="boolean")||f===null)){var j=arguments;if(this.image===undefined){this.image=null}if(this.scaleDistance===undefined){this.scaleDistance=0}if(this.scaleDistanceXStart===undefined){this.scaleDistanceXStart=0}if(this.scaleDistanceYStart===undefined){this.scaleDistanceYStart=0}if(this.scaleDistanceXEnd===undefined){this.scaleDistanceXEnd=0}if(this.scaleDistanceYEnd===undefined){this.scaleDistanceYEnd=0}if(this.xOrigin===undefined){this.xOrigin=0}if(this.yOrigin===undefined){this.yOrigin=0}if(this.invisible===undefined){this.invisible=false}this.image=g;this.scaleDistance=n;this.scaleDistanceXStart=m;this.scaleDistanceYStart=c;this.scaleDistanceXEnd=h;this.scaleDistanceYEnd=d;this.xOrigin=b;this.yOrigin=k;this.invisible=!f}else{if(((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||g===null)&&((typeof n==="number")||n===null)&&((typeof m==="number")||m===null)&&((typeof c==="number")||c===null)&&((typeof h==="number")||h===null)&&((typeof d==="number")||d===null)&&((typeof b==="number")||b===null)&&((typeof k==="number")||k===null)&&f===undefined){var j=arguments;var e=arguments;var l=true;if(this.image===undefined){this.image=null}if(this.scaleDistance===undefined){this.scaleDistance=0}if(this.scaleDistanceXStart===undefined){this.scaleDistanceXStart=0}if(this.scaleDistanceYStart===undefined){this.scaleDistanceYStart=0}if(this.scaleDistanceXEnd===undefined){this.scaleDistanceXEnd=0}if(this.scaleDistanceYEnd===undefined){this.scaleDistanceYEnd=0}if(this.xOrigin===undefined){this.xOrigin=0}if(this.yOrigin===undefined){this.yOrigin=0}if(this.invisible===undefined){this.invisible=false}this.image=g;this.scaleDistance=n;this.scaleDistanceXStart=m;this.scaleDistanceYStart=c;this.scaleDistanceXEnd=h;this.scaleDistanceYEnd=d;this.xOrigin=b;this.yOrigin=k;this.invisible=!l;if(this.image===undefined){this.image=null}if(this.scaleDistance===undefined){this.scaleDistance=0}if(this.scaleDistanceXStart===undefined){this.scaleDistanceXStart=0}if(this.scaleDistanceYStart===undefined){this.scaleDistanceYStart=0}if(this.scaleDistanceXEnd===undefined){this.scaleDistanceXEnd=0}if(this.scaleDistanceYEnd===undefined){this.scaleDistanceYEnd=0}if(this.xOrigin===undefined){this.xOrigin=0}if(this.yOrigin===undefined){this.yOrigin=0}if(this.invisible===undefined){this.invisible=false}}else{throw new Error("invalid overload")}}}a.prototype.getImage=function(){return this.image};a.prototype.getScaleDistance=function(){return this.scaleDistance};a.prototype.getScaleDistanceXStart=function(){return this.scaleDistanceXStart};a.prototype.getScaleDistanceYStart=function(){return this.scaleDistanceYStart};a.prototype.getScaleDistanceXEnd=function(){return this.scaleDistanceXEnd};a.prototype.getScaleDistanceYEnd=function(){return this.scaleDistanceYEnd};a.prototype.getScale=function(){return a.getScale(this.scaleDistance,this.scaleDistanceXStart,this.scaleDistanceYStart,this.scaleDistanceXEnd,this.scaleDistanceYEnd)};a.getScale=function(e,b,f,d,c){return(e/java.awt.geom.Point2D.distance(b,f,d,c))};a.prototype.getXOrigin=function(){return this.xOrigin};a.prototype.getYOrigin=function(){return this.yOrigin};a.prototype.isVisible=function(){return !this.invisible};return a}());BackgroundImage.__class="com.eteks.sweethome3d.model.BackgroundImage";var RecorderException=(function(b){__extends(a,b);function a(c,e){var f=this;if(((typeof c==="string")||c===null)&&((e!=null&&(e.__classes&&e.__classes.indexOf("java.lang.Throwable")>=0)||e!=null&&e instanceof Error)||e===null)){var d=arguments;f=b.call(this,c)||this;f.message=c}else{if(((typeof c==="string")||c===null)&&e===undefined){var d=arguments;f=b.call(this,c)||this;f.message=c}else{if(c===undefined&&e===undefined){var d=arguments;f=b.call(this)||this}else{throw new Error("invalid overload")}}}return f}return a}(Error));RecorderException.__class="com.eteks.sweethome3d.model.RecorderException";var HomeObject=(function(){function a(e){if(((typeof e==="string")||e===null)){var d=arguments;if(this.id===undefined){this.id=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(e==null){throw new IllegalArgumentException("ID must exist")}this.id=e}else{if(e===undefined){var d=arguments;var b=arguments;var c=a.createId(a.ID_DEFAULT_PREFIX);if(this.id===undefined){this.id=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(c==null){throw new IllegalArgumentException("ID must exist")}this.id=c;if(this.id===undefined){this.id=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}}else{throw new Error("invalid overload")}}}a.createId=function(b){return b+"-"+UUID.randomUUID()};a.prototype.addPropertyChangeListener=function(b,c){if(this.propertyChangeSupport==null){this.propertyChangeSupport=new PropertyChangeSupport(this)}if(c===undefined){this.propertyChangeSupport.addPropertyChangeListener(b)}else{this.propertyChangeSupport.addPropertyChangeListener(b,c)}};a.prototype.removePropertyChangeListener=function(b,c){if(this.propertyChangeSupport!=null){if(c===undefined){this.propertyChangeSupport.removePropertyChangeListener(b)}else{this.propertyChangeSupport.removePropertyChangeListener(b,c)}if(this.propertyChangeSupport.getPropertyChangeListeners().length===0){this.propertyChangeSupport=null}}};a.prototype.firePropertyChange=function(b,c,d){if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange(b,c,d)}};a.prototype.getId=function(){return this.id};a.prototype.getProperty=function(c){if(this.properties!=null){var b=(function(d,e){return d[e]===undefined?null:d[e]})(this.properties,c);if(typeof b==="string"){return b}}return null};a.prototype.getContentProperty=function(c){if(this.properties!=null){var b=(function(d,e){return d[e]===undefined?null:d[e]})(this.properties,c);if(b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0)){return b}}return null};a.prototype.isContentProperty=function(b){return this.properties!=null&&((function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b)!=null&&((function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b).constructor!=null&&(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b).constructor.__interfaces!=null&&(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b).constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))};a.prototype.setProperty$java_lang_String$java_lang_String=function(b,c){this.setProperty$java_lang_String$java_lang_Object(b,c)};a.prototype.setProperty=function(b,c){if(((typeof b==="string")||b===null)&&((typeof c==="string")||c===null)){return this.setProperty$java_lang_String$java_lang_String(b,c)}else{if(((typeof b==="string")||b===null)&&((c!=null)||c===null)){return this.setProperty$java_lang_String$java_lang_Object(b,c)}else{throw new Error("invalid overload")}}};a.prototype.setProperty$java_lang_String$java_lang_Object=function(c,e){var f=this;if(e!=null&&!((typeof e==="string")||(e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0)))){throw new IllegalArgumentException("Property value can be only a string or a content, not an instance of "+e.constructor)}var b=this.properties!=null?(function(g,h){return g[h]===undefined?null:g[h]})(this.properties,c):null;if(e==null){if(this.properties!=null&&b!=null){try{(function(h){var g=f.properties[c];delete f.properties[c];return g})(this.properties);if(Object.keys(this.properties).length===0){this.properties=null}}catch(d){this.properties=null}this.firePropertyChange(c,b,null)}}else{if(this.properties==null||(Object.keys(this.properties).length===1&&b!=null)){this.properties=(function(g){var h={};h[g]=e;return h})(c)}else{if(Object.keys(this.properties).length===1){this.properties=((function(j){var g={};for(var h in j){g[h]=j[h]}return g})(this.properties))}(this.properties[c]=e)}this.firePropertyChange(c,b,e)}};a.prototype.getPropertyNames=function(){if(this.properties!=null){return Object.keys(this.properties)}else{return[]}};a.prototype.duplicate=function(){var f=(function(g){if(g.clone!=undefined){return g.clone()}else{var h=Object.create(g);for(var c in g){if(g.hasOwnProperty(c)){h[c]=g[c]}}return h}})(this);var b=0;var e;while((b<this.id.length&&(function(g){return g.charCodeAt==null?g:g.charCodeAt(0)})((e=this.id.charAt(b).toLowerCase()))>="a".charCodeAt(0)&&(function(g){return g.charCodeAt==null?g:g.charCodeAt(0)})(e)<="z".charCodeAt(0))){b++}var d=b>=0?this.id.substring(0,b):a.ID_DEFAULT_PREFIX;f.id=a.createId(d);return f};a.prototype.clone=function(){var d=this;try{var c=(function(f){var g=Object.create(f);for(var e in f){if(f.hasOwnProperty(e)){g[e]=f[e]}}return g})(this);if(this.properties!=null){c.properties=Object.keys(c.properties).length===1?(function(e){var f={};f[e]=(function(g){var h=0;return{next:function(){return h<g.length?g[h++]:null},hasNext:function(){return h<g.length}}})((function(g){return Object.keys(g).map(function(h){return g[h]})})(d.properties)).next();return f})((function(e){var f=0;return{next:function(){return f<e.length?e[f++]:null},hasNext:function(){return f<e.length}}})(Object.keys(this.properties)).next()):((function(g){var e={};for(var f in g){e[f]=g[f]}return e})(this.properties))}c.propertyChangeSupport=null;return c}catch(b){throw new IllegalStateException("Super class isn't cloneable")}};a.ID_DEFAULT_PREFIX="object";return a}());HomeObject.__class="com.eteks.sweethome3d.model.HomeObject";HomeObject.__transients=["propertyChangeSupport"];var ObjectProperty=(function(){function a(E,D,d,h,s,b){if(((typeof E==="string")||E===null)&&((typeof D==="string")||D===null)&&((typeof d==="number")||d===null)&&((typeof h==="boolean")||h===null)&&((typeof s==="boolean")||s===null)&&((typeof b==="boolean")||b===null)){var j=arguments;if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}this.name=E;this.displayedName=D;this.type=d;this.typeName=d!=null?a.Type[d]:null;this.displayable=h;this.modifiable=s;this.exportable=b}else{if(((typeof E==="string")||E===null)&&((typeof D==="number")||D===null)&&((typeof d==="boolean")||d===null)&&((typeof h==="boolean")||h===null)&&((typeof s==="boolean")||s===null)&&b===undefined){var j=arguments;var w=j[1];var g=j[2];var r=j[3];var p=j[4];var z=arguments;var C=null;var f=true;var q=true;var n=true;if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}this.name=E;this.displayedName=C;this.type=w;this.typeName=w!=null?a.Type[w]:null;this.displayable=f;this.modifiable=q;this.exportable=n;if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}}else{if(((typeof E==="string")||E===null)&&((typeof D==="number")||D===null)&&d===undefined&&h===undefined&&s===undefined&&b===undefined){var j=arguments;var u=j[1];var y=arguments;var B=null;var e=true;var o=true;var l=true;if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}this.name=E;this.displayedName=B;this.type=u;this.typeName=u!=null?a.Type[u]:null;this.displayable=e;this.modifiable=o;this.exportable=l;if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}}else{if(((typeof E==="string")||E===null)&&D===undefined&&d===undefined&&h===undefined&&s===undefined&&b===undefined){var j=arguments;var x=arguments;var t=null;var v=arguments;var A=null;var c=true;var m=true;var k=true;if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}this.name=E;this.displayedName=A;this.type=t;this.typeName=t!=null?a.Type[t]:null;this.displayable=c;this.modifiable=m;this.exportable=k;if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}if(this.name===undefined){this.name=null}if(this.displayedName===undefined){this.displayedName=null}if(this.type===undefined){this.type=null}if(this.typeName===undefined){this.typeName=null}if(this.displayable===undefined){this.displayable=false}if(this.modifiable===undefined){this.modifiable=false}if(this.exportable===undefined){this.exportable=false}}else{throw new Error("invalid overload")}}}}}a.fromDescription=function(k){if(k.length===0){throw new IllegalArgumentException("Description empty")}var g=k.indexOf(":");var e=k.substring(0,g>0?g:k.length).trim();var h=null;var c=true;var l=true;var f=true;var j=null;if(g>0){var b=k.substring(g+1).trim().split(/ /);if(b.length>0){h=a.Type[b[0]];for(var d=1;d<b.length;d++){if((function(o,n,m){if(m===void 0){m=0}return o.substr(m,n.length)===n})(b[d],"displayable=")){c=(function(n,m){return n.toUpperCase()===(m===null?m:m.toUpperCase())})("true",b[d].substring("displayable=".length+1))}else{if((function(o,n,m){if(m===void 0){m=0}return o.substr(m,n.length)===n})(b[d],"modifiable=")){l=(function(n,m){return n.toUpperCase()===(m===null?m:m.toUpperCase())})("true",b[d].substring("modifiable=".length+1))}else{if((function(o,n,m){if(m===void 0){m=0}return o.substr(m,n.length)===n})(b[d],"exportable=")){f=(function(n,m){return n.toUpperCase()===(m===null?m:m.toUpperCase())})("true",b[d].substring("exportable=".length+1))}else{if((function(o,n,m){if(m===void 0){m=0}return o.substr(m,n.length)===n})(b[d],"displayedName=")){j=k.substring(k.indexOf("displayedName=")+"displayedName=".length)}}}}}}}return new a(e,j,h,c,l,f)};a.prototype.getName=function(){return this.name};a.prototype.getType=function(){return this.type};a.prototype.isDisplayable=function(){return this.displayable};a.prototype.isModifiable=function(){return this.modifiable};a.prototype.isExportable=function(){return this.exportable};a.prototype.getDisplayedName=function(){if(this.displayedName!=null){return this.displayedName}else{var b=this.name.split("_").join(" ").toLowerCase();return b.charAt(0).toUpperCase()+(b.length>1?b.substring(1):"")}};a.prototype.hashCode=function(){return this.name==null?0:(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name)};a.prototype.equals=function(b){if(this===b){return true}else{if(b!=null&&b instanceof a){return this.name===b.name}}return false};return a}());ObjectProperty.__class="com.eteks.sweethome3d.model.ObjectProperty";(function(b){var a;(function(c){c[c.ANY=0]="ANY";c[c.STRING=1]="STRING";c[c.BOOLEAN=2]="BOOLEAN";c[c.INTEGER=3]="INTEGER";c[c.NUMBER=4]="NUMBER";c[c.PRICE=5]="PRICE";c[c.LENGTH=6]="LENGTH";c[c.PERCENTAGE=7]="PERCENTAGE";c[c.DATE=8]="DATE";c[c.CONTENT=9]="CONTENT"})(a=b.Type||(b.Type={}))})(ObjectProperty||(ObjectProperty={}));ObjectProperty.__transients=["type"];var TexturesCatalog=(function(){function a(){this.categories=([]);this.texturesChangeSupport=(new CollectionChangeSupport(this))}a.prototype.getCategories=function(){return this.categories.slice(0)};a.prototype.getCategoriesCount=function(){return this.categories.length};a.prototype.getCategory=function(b){return this.categories[b]};a.prototype.addTexturesListener=function(b){this.texturesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeTexturesListener=function(b){this.texturesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.add=function(d,c){var b=(function(f,j){var g=function(o,l){if(o.compareTo){return o.compareTo(l)}else{return o.localeCompare(l)}};var e=0;var m=f.length-1;while(e<=m){var h=(e+m)>>>1;var n=f[h];var k=g(n,j);if(k<0){e=h+1}else{if(k>0){m=h-1}else{return h}}}return -(e+1)})(this.categories,d);if(b<0){d=new TexturesCategory(d.getName());this.categories.splice(-b-1,0,d)}else{d=this.categories[b]}d.add(c);this.texturesChangeSupport.fireCollectionChanged(c,d.getIndexOfTexture(c),CollectionEvent.Type.ADD)};a.prototype["delete"]=function(c){var b=c.getCategory();if(b!=null){var d=b.getIndexOfTexture(c);if(d>=0){b["delete"](c);if(b.getTexturesCount()===0){this.categories=(this.categories.slice(0));(function(e){var f=e.indexOf(b);if(f>=0){e.splice(f,1);return true}else{return false}})(this.categories)}this.texturesChangeSupport.fireCollectionChanged(c,d,CollectionEvent.Type.DELETE);return}}throw new IllegalArgumentException("catalog doesn't contain texture "+c.getName())};return a}());TexturesCatalog.__class="com.eteks.sweethome3d.model.TexturesCatalog";var CatalogPieceOfFurniture=(function(){function a(cX,b9,d,a2,du,cT,ez,a1,f,cW,cU,bo,b,dx,c,ca,ed,cS,eL,dQ,a3,bK,X,dw,eK,ax,H,bV,de,d0,dv,q,G,d1,dr,n,dL,cV){if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((typeof a2==="string")||a2===null)&&((typeof du==="string")||du===null)&&((cT!=null&&cT instanceof Array&&(cT.length==0||cT[0]==null||(typeof cT[0]==="string")))||cT===null)&&((typeof ez==="number")||ez===null)&&((typeof a1==="number")||a1===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((cW!=null&&(cW.constructor!=null&&cW.constructor.__interfaces!=null&&cW.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cW===null)&&((cU!=null&&(cU.constructor!=null&&cU.constructor.__interfaces!=null&&cU.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cU===null)&&((typeof bo==="number")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="number")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="number")||ca===null)&&((typeof ed==="boolean")||ed===null)&&((typeof cS==="boolean")||cS===null)&&((typeof eL==="string")||eL===null)&&((typeof dQ==="number")||dQ===null)&&((a3!=null&&a3 instanceof Array&&(a3.length==0||a3[0]==null||a3[0] instanceof Array))||a3===null)&&((typeof bK==="number")||bK===null)&&((typeof X==="number")||X===null)&&((typeof dw==="string")||dw===null)&&((typeof eK==="boolean")||eK===null)&&((typeof ax==="boolean")||ax===null)&&((typeof H==="boolean")||H===null)&&((typeof bV==="boolean")||bV===null)&&((de!=null&&de instanceof Big)||de===null)&&((d0!=null&&d0 instanceof Big)||d0===null)&&((typeof dv==="string")||dv===null)&&((q!=null&&(q instanceof Object))||q===null)&&((G!=null&&(G instanceof Object))||G===null)&&((typeof d1==="number")||d1===null)&&((typeof dr==="number")||dr===null)&&((typeof n==="number")||n===null)&&((typeof dL==="boolean")||dL===null)&&((typeof cV==="boolean")||cV===null)){var cB=arguments;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=cX;this.name=b9;this.description=d;this.information=a2;this.license=du;this.tags=cT;this.creationDate=ez;this.grade=a1;this.icon=f;this.planIcon=cW;this.model=cU;this.width=bo;this.depth=b;this.height=dx;this.elevation=c;this.dropOnTopElevation=ca;this.movable=ed;this.doorOrWindow=cS;this.color=dQ;this.staircaseCutOutShape=eL;this.creator=dw;this.horizontallyRotatable=bV;this.price=de;this.valueAddedTaxPercentage=d0;this.currency=dv;if(q==null||Object.keys(q).length===0){if(G==null||Object.keys(G).length===0){this.properties={}}else{if(Object.keys(G).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(G)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(G)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(G))}}}else{if(Object.keys(q).length===1&&(G==null||Object.keys(G).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(q)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(q)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(q));if(G!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,G)}}}if(a3==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(a3)}this.modelFlags=bK;this.modelSize=X;this.resizable=eK;this.deformable=ax;this.texturable=H;this.iconYaw=d1;this.iconPitch=dr;this.iconScale=n;this.proportional=dL;this.modifiable=cV}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((typeof a2==="string")||a2===null)&&((typeof du==="string")||du===null)&&((cT!=null&&cT instanceof Array&&(cT.length==0||cT[0]==null||(typeof cT[0]==="string")))||cT===null)&&((typeof ez==="number")||ez===null)&&((typeof a1==="number")||a1===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((cW!=null&&(cW.constructor!=null&&cW.constructor.__interfaces!=null&&cW.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cW===null)&&((cU!=null&&(cU.constructor!=null&&cU.constructor.__interfaces!=null&&cU.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cU===null)&&((typeof bo==="number")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="number")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="number")||ca===null)&&((typeof ed==="boolean")||ed===null)&&((typeof cS==="string")||cS===null)&&((eL!=null&&eL instanceof Array&&(eL.length==0||eL[0]==null||eL[0] instanceof Array))||eL===null)&&((typeof dQ==="number")||dQ===null)&&((typeof a3==="number")||a3===null)&&((typeof bK==="string")||bK===null)&&((typeof X==="boolean")||X===null)&&((typeof dw==="boolean")||dw===null)&&((typeof eK==="boolean")||eK===null)&&((typeof ax==="boolean")||ax===null)&&((H!=null&&H instanceof Big)||H===null)&&((bV!=null&&bV instanceof Big)||bV===null)&&((typeof de==="string")||de===null)&&((d0!=null&&(d0 instanceof Object))||d0===null)&&((dv!=null&&(dv instanceof Object))||dv===null)&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var ep=cB[17];var cR=cB[18];var p=cB[19];var bP=cB[20];var br=cB[21];var ag=cB[22];var b1=cB[23];var ea=cB[24];var cN=cB[25];var c6=cB[26];var eG=cB[27];var dd=cB[28];var W=cB[29];var b8=cB[30];var bR=arguments;var U=false;var aE=null;var bi=Math.PI/8;var cs=0;var ek=1;var dE=true;var g=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=cX;this.name=b9;this.description=d;this.information=a2;this.license=du;this.tags=cT;this.creationDate=ez;this.grade=a1;this.icon=f;this.planIcon=cW;this.model=cU;this.width=bo;this.depth=b;this.height=dx;this.elevation=c;this.dropOnTopElevation=ca;this.movable=ed;this.doorOrWindow=U;this.color=aE;this.staircaseCutOutShape=ep;this.creator=br;this.horizontallyRotatable=cN;this.price=c6;this.valueAddedTaxPercentage=eG;this.currency=dd;if(W==null||Object.keys(W).length===0){if(b8==null||Object.keys(b8).length===0){this.properties={}}else{if(Object.keys(b8).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(b8)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(b8)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(b8))}}}else{if(Object.keys(W).length===1&&(b8==null||Object.keys(b8).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(W)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(W)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(W));if(b8!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,b8)}}}if(cR==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(cR)}this.modelFlags=p;this.modelSize=bP;this.resizable=ag;this.deformable=b1;this.texturable=ea;this.iconYaw=bi;this.iconPitch=cs;this.iconScale=ek;this.proportional=dE;this.modifiable=g;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((typeof a2==="string")||a2===null)&&((du!=null&&du instanceof Array&&(du.length==0||du[0]==null||(typeof du[0]==="string")))||du===null)&&((typeof cT==="number")||cT===null)&&((typeof ez==="number")||ez===null)&&((a1!=null&&(a1.constructor!=null&&a1.constructor.__interfaces!=null&&a1.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||a1===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((cW!=null&&(cW.constructor!=null&&cW.constructor.__interfaces!=null&&cW.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cW===null)&&((typeof cU==="number")||cU===null)&&((typeof bo==="number")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="number")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="boolean")||ca===null)&&((typeof ed==="string")||ed===null)&&((cS!=null&&cS instanceof Array&&(cS.length==0||cS[0]==null||cS[0] instanceof Array))||cS===null)&&((typeof eL==="boolean")||eL===null)&&((typeof dQ==="number")||dQ===null)&&((typeof a3==="string")||a3===null)&&((typeof bK==="boolean")||bK===null)&&((typeof X==="boolean")||X===null)&&((typeof dw==="boolean")||dw===null)&&((typeof eK==="boolean")||eK===null)&&((ax!=null&&ax instanceof Big)||ax===null)&&((H!=null&&H instanceof Big)||H===null)&&((typeof bV==="string")||bV===null)&&((de!=null&&(de instanceof Object))||de===null)&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var cA=cB[4];var dl=cB[5];var F=cB[6];var cl=cB[7];var dP=cB[8];var dZ=cB[9];var aQ=cB[10];var a0=cB[11];var ew=cB[12];var aw=cB[13];var am=cB[14];var bD=cB[15];var eo=cB[16];var cQ=cB[17];var eq=cB[18];var bN=cB[19];var bp=cB[20];var af=cB[21];var b0=cB[22];var d9=cB[23];var cL=cB[24];var c5=cB[25];var eF=cB[26];var dc=cB[27];var V=cB[28];var bQ=arguments;var o=eq?PieceOfFurniture.SHOW_BACK_FACE:0;var bO=arguments;var w=null;var b7=null;var bM=arguments;var S=false;var aD=null;var bh=Math.PI/8;var cr=0;var ei=1;var dD=true;var e=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=cX;this.name=b9;this.description=d;this.information=a2;this.license=w;this.tags=cA;this.creationDate=dl;this.grade=F;this.icon=cl;this.planIcon=dP;this.model=dZ;this.width=aQ;this.depth=a0;this.height=ew;this.elevation=aw;this.dropOnTopElevation=am;this.movable=bD;this.doorOrWindow=S;this.color=aD;this.staircaseCutOutShape=eo;this.creator=bp;this.horizontallyRotatable=cL;this.price=c5;this.valueAddedTaxPercentage=eF;this.currency=dc;if(V==null||Object.keys(V).length===0){if(b7==null||Object.keys(b7).length===0){this.properties={}}else{if(Object.keys(b7).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(b7)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(b7)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(b7))}}}else{if(Object.keys(V).length===1&&(b7==null||Object.keys(b7).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(V)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(V)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(V));if(b7!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,b7)}}}if(cQ==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(cQ)}this.modelFlags=o;this.modelSize=bN;this.resizable=af;this.deformable=b0;this.texturable=d9;this.iconYaw=bh;this.iconPitch=cr;this.iconScale=ei;this.proportional=dD;this.modifiable=e;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((typeof a2==="string")||a2===null)&&((du!=null&&du instanceof Array&&(du.length==0||du[0]==null||(typeof du[0]==="string")))||du===null)&&((typeof cT==="number")||cT===null)&&((typeof ez==="number")||ez===null)&&((a1!=null&&(a1.constructor!=null&&a1.constructor.__interfaces!=null&&a1.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||a1===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((cW!=null&&(cW.constructor!=null&&cW.constructor.__interfaces!=null&&cW.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cW===null)&&((typeof cU==="number")||cU===null)&&((typeof bo==="number")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="number")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="boolean")||ca===null)&&((typeof ed==="string")||ed===null)&&((cS!=null&&cS instanceof Array&&(cS.length==0||cS[0]==null||cS[0] instanceof Array))||cS===null)&&((typeof eL==="number")||eL===null)&&((typeof dQ==="number")||dQ===null)&&((typeof a3==="string")||a3===null)&&((typeof bK==="boolean")||bK===null)&&((typeof X==="boolean")||X===null)&&((typeof dw==="boolean")||dw===null)&&((typeof eK==="boolean")||eK===null)&&((ax!=null&&ax instanceof Big)||ax===null)&&((H!=null&&H instanceof Big)||H===null)&&((typeof bV==="string")||bV===null)&&((de!=null&&(de instanceof Object))||de===null)&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var cz=cB[4];var dj=cB[5];var E=cB[6];var ck=cB[7];var dO=cB[8];var dY=cB[9];var aO=cB[10];var aZ=cB[11];var ev=cB[12];var av=cB[13];var al=cB[14];var bA=cB[15];var en=cB[16];var cP=cB[17];var m=cB[18];var bL=cB[19];var bn=cB[20];var ae=cB[21];var bZ=cB[22];var d8=cB[23];var cJ=cB[24];var c4=cB[25];var eE=cB[26];var db=cB[27];var T=cB[28];var bJ=arguments;var v=null;var b6=null;var bH=arguments;var Q=false;var aC=null;var bg=Math.PI/8;var cq=0;var eg=1;var dC=true;var aR=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=cX;this.name=b9;this.description=d;this.information=a2;this.license=v;this.tags=cz;this.creationDate=dj;this.grade=E;this.icon=ck;this.planIcon=dO;this.model=dY;this.width=aO;this.depth=aZ;this.height=ev;this.elevation=av;this.dropOnTopElevation=al;this.movable=bA;this.doorOrWindow=Q;this.color=aC;this.staircaseCutOutShape=en;this.creator=bn;this.horizontallyRotatable=cJ;this.price=c4;this.valueAddedTaxPercentage=eE;this.currency=db;if(T==null||Object.keys(T).length===0){if(b6==null||Object.keys(b6).length===0){this.properties={}}else{if(Object.keys(b6).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(b6)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(b6)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(b6))}}}else{if(Object.keys(T).length===1&&(b6==null||Object.keys(b6).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(T)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(T)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(T));if(b6!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,b6)}}}if(cP==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(cP)}this.modelFlags=m;this.modelSize=bL;this.resizable=ae;this.deformable=bZ;this.texturable=d8;this.iconYaw=bg;this.iconPitch=cq;this.iconScale=eg;this.proportional=dC;this.modifiable=aR;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((typeof a2==="string")||a2===null)&&((du!=null&&du instanceof Array&&(du.length==0||du[0]==null||(typeof du[0]==="string")))||du===null)&&((typeof cT==="number")||cT===null)&&((typeof ez==="number")||ez===null)&&((a1!=null&&(a1.constructor!=null&&a1.constructor.__interfaces!=null&&a1.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||a1===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((cW!=null&&(cW.constructor!=null&&cW.constructor.__interfaces!=null&&cW.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cW===null)&&((typeof cU==="number")||cU===null)&&((typeof bo==="number")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="number")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="boolean")||ca===null)&&((typeof ed==="string")||ed===null)&&((cS!=null&&cS instanceof Array&&(cS.length==0||cS[0]==null||cS[0] instanceof Array))||cS===null)&&((typeof eL==="boolean")||eL===null)&&((typeof dQ==="number")||dQ===null)&&((typeof a3==="string")||a3===null)&&((typeof bK==="boolean")||bK===null)&&((typeof X==="boolean")||X===null)&&((typeof dw==="boolean")||dw===null)&&((typeof eK==="boolean")||eK===null)&&((ax!=null&&ax instanceof Big)||ax===null)&&((H!=null&&H instanceof Big)||H===null)&&((typeof bV==="string")||bV===null)&&de===undefined&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var cy=cB[4];var di=cB[5];var D=cB[6];var cj=cB[7];var dN=cB[8];var dX=cB[9];var aM=cB[10];var aY=cB[11];var eu=cB[12];var au=cB[13];var ak=cB[14];var by=cB[15];var em=cB[16];var cO=cB[17];var eq=cB[18];var bI=cB[19];var bm=cB[20];var ad=cB[21];var bY=cB[22];var d7=cB[23];var cH=cB[24];var c3=cB[25];var eD=cB[26];var da=cB[27];var bF=arguments;var R=null;var bC=arguments;var l=eq?PieceOfFurniture.SHOW_BACK_FACE:0;var bz=arguments;var u=null;var b5=null;var bx=arguments;var O=false;var aB=null;var bf=Math.PI/8;var cp=0;var ef=1;var dB=true;var aP=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=cX;this.name=b9;this.description=d;this.information=a2;this.license=u;this.tags=cy;this.creationDate=di;this.grade=D;this.icon=cj;this.planIcon=dN;this.model=dX;this.width=aM;this.depth=aY;this.height=eu;this.elevation=au;this.dropOnTopElevation=ak;this.movable=by;this.doorOrWindow=O;this.color=aB;this.staircaseCutOutShape=em;this.creator=bm;this.horizontallyRotatable=cH;this.price=c3;this.valueAddedTaxPercentage=eD;this.currency=da;if(R==null||Object.keys(R).length===0){if(b5==null||Object.keys(b5).length===0){this.properties={}}else{if(Object.keys(b5).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(b5)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(b5)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(b5))}}}else{if(Object.keys(R).length===1&&(b5==null||Object.keys(b5).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(R)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(R)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(R));if(b5!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,b5)}}}if(cO==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(cO)}this.modelFlags=l;this.modelSize=bI;this.resizable=ad;this.deformable=bY;this.texturable=d7;this.iconYaw=bf;this.iconPitch=cp;this.iconScale=ef;this.proportional=dB;this.modifiable=aP;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((typeof a2==="string")||a2===null)&&((du!=null&&du instanceof Array&&(du.length==0||du[0]==null||(typeof du[0]==="string")))||du===null)&&((typeof cT==="number")||cT===null)&&((typeof ez==="number")||ez===null)&&((a1!=null&&(a1.constructor!=null&&a1.constructor.__interfaces!=null&&a1.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||a1===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||f===null)&&((cW!=null&&(cW.constructor!=null&&cW.constructor.__interfaces!=null&&cW.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cW===null)&&((typeof cU==="number")||cU===null)&&((typeof bo==="number")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="number")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="boolean")||ca===null)&&((typeof ed==="string")||ed===null)&&((cS!=null&&cS instanceof Array&&(cS.length==0||cS[0]==null||cS[0] instanceof Array))||cS===null)&&((typeof eL==="boolean")||eL===null)&&((typeof dQ==="string")||dQ===null)&&((typeof a3==="boolean")||a3===null)&&((typeof bK==="boolean")||bK===null)&&((typeof X==="boolean")||X===null)&&((dw!=null&&dw instanceof Big)||dw===null)&&((eK!=null&&eK instanceof Big)||eK===null)&&((typeof ax==="string")||ax===null)&&H===undefined&&bV===undefined&&de===undefined&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var cx=cB[4];var dh=cB[5];var C=cB[6];var ci=cB[7];var dM=cB[8];var dW=cB[9];var aK=cB[10];var aX=cB[11];var et=cB[12];var at=cB[13];var aj=cB[14];var bw=cB[15];var el=cB[16];var cM=cB[17];var eq=cB[18];var bl=cB[19];var ac=cB[20];var bX=cB[21];var d6=cB[22];var c2=cB[23];var eC=cB[24];var c9=cB[25];var bd=arguments;var bG=null;var cF=true;var bb=arguments;var P=null;var a9=arguments;var k=eq?PieceOfFurniture.SHOW_BACK_FACE:0;var a8=arguments;var t=null;var b4=null;var a7=arguments;var M=false;var aA=null;var be=Math.PI/8;var co=0;var ee=1;var dA=true;var aN=false;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=cX;this.name=b9;this.description=d;this.information=a2;this.license=t;this.tags=cx;this.creationDate=dh;this.grade=C;this.icon=ci;this.planIcon=dM;this.model=dW;this.width=aK;this.depth=aX;this.height=et;this.elevation=at;this.dropOnTopElevation=aj;this.movable=bw;this.doorOrWindow=M;this.color=aA;this.staircaseCutOutShape=el;this.creator=bl;this.horizontallyRotatable=cF;this.price=c2;this.valueAddedTaxPercentage=eC;this.currency=c9;if(P==null||Object.keys(P).length===0){if(b4==null||Object.keys(b4).length===0){this.properties={}}else{if(Object.keys(b4).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(b4)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(b4)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(b4))}}}else{if(Object.keys(P).length===1&&(b4==null||Object.keys(b4).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(P)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(P)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(P));if(b4!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,b4)}}}if(cM==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(cM)}this.modelFlags=k;this.modelSize=bG;this.resizable=ac;this.deformable=bX;this.texturable=d6;this.iconYaw=be;this.iconPitch=co;this.iconScale=ee;this.proportional=dA;this.modifiable=aN;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((b9!=null&&(b9.constructor!=null&&b9.constructor.__interfaces!=null&&b9.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||b9===null)&&((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||d===null)&&((typeof a2==="number")||a2===null)&&((typeof du==="number")||du===null)&&((typeof cT==="number")||cT===null)&&((typeof ez==="number")||ez===null)&&((typeof a1==="boolean")||a1===null)&&((typeof f==="string")||f===null)&&((typeof cW==="number")||cW===null)&&((cU!=null&&cU instanceof Array&&(cU.length==0||cU[0]==null||cU[0] instanceof Array))||cU===null)&&((typeof bo==="number")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="string")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="number")||ca===null)&&((typeof ed==="number")||ed===null)&&((typeof cS==="boolean")||cS===null)&&eL===undefined&&dQ===undefined&&a3===undefined&&bK===undefined&&X===undefined&&dw===undefined&&eK===undefined&&ax===undefined&&H===undefined&&bV===undefined&&de===undefined&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var dJ=cB[0];var ch=cB[1];var dV=cB[2];var aJ=cB[3];var aW=cB[4];var es=cB[5];var ar=cB[6];var bv=cB[7];var ej=cB[8];var az=cB[9];var cK=cB[10];var j=cB[11];var bE=cB[12];var bk=cB[13];var bc=cB[14];var cn=cB[15];var ec=cB[16];var dz=cB[17];var a6=arguments;var cv=null;var dt=null;var eJ=null;var s=null;var cw=[];var dg=Date.now();var B=null;var dK=null;var ai=1;var K=false;var ab=true;var bW=true;var d5=true;var cE=true;var c1=null;var eB=null;var c8=null;var N=null;var b3=null;var aL=true;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=cv;this.name=dJ;this.description=dt;this.information=eJ;this.license=s;this.tags=cw;this.creationDate=dg;this.grade=B;this.icon=ch;this.planIcon=dK;this.model=dV;this.width=aJ;this.depth=aW;this.height=es;this.elevation=ar;this.dropOnTopElevation=ai;this.movable=bv;this.doorOrWindow=K;this.color=az;this.staircaseCutOutShape=ej;this.creator=bk;this.horizontallyRotatable=cE;this.price=c1;this.valueAddedTaxPercentage=eB;this.currency=c8;if(N==null||Object.keys(N).length===0){if(b3==null||Object.keys(b3).length===0){this.properties={}}else{if(Object.keys(b3).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(b3)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(b3)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(b3))}}}else{if(Object.keys(N).length===1&&(b3==null||Object.keys(b3).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(N)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(N)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(N));if(b3!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,b3)}}}if(cK==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(cK)}this.modelFlags=j;this.modelSize=bE;this.resizable=ab;this.deformable=bW;this.texturable=d5;this.iconYaw=bc;this.iconPitch=cn;this.iconScale=ec;this.proportional=dz;this.modifiable=aL;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((a2!=null&&(a2.constructor!=null&&a2.constructor.__interfaces!=null&&a2.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||a2===null)&&((du!=null&&(du.constructor!=null&&du.constructor.__interfaces!=null&&du.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||du===null)&&((cT!=null&&(cT.constructor!=null&&cT.constructor.__interfaces!=null&&cT.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cT===null)&&((typeof ez==="number")||ez===null)&&((typeof a1==="number")||a1===null)&&((typeof f==="number")||f===null)&&((typeof cW==="number")||cW===null)&&((typeof cU==="boolean")||cU===null)&&((bo!=null&&bo instanceof Array&&(bo.length==0||bo[0]==null||bo[0] instanceof Array))||bo===null)&&((typeof b==="string")||b===null)&&((typeof dx==="boolean")||dx===null)&&((typeof c==="boolean")||c===null)&&((typeof ca==="boolean")||ca===null)&&((ed!=null&&ed instanceof Big)||ed===null)&&((cS!=null&&cS instanceof Big)||cS===null)&&eL===undefined&&dQ===undefined&&a3===undefined&&bK===undefined&&X===undefined&&dw===undefined&&eK===undefined&&ax===undefined&&H===undefined&&bV===undefined&&de===undefined&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var cg=cB[3];var dI=cB[4];var dU=cB[5];var aH=cB[6];var aV=cB[7];var er=cB[8];var aq=cB[9];var bu=cB[10];var cI=cB[11];var bj=cB[12];var aa=cB[13];var bU=cB[14];var d4=cB[15];var c0=cB[16];var eA=cB[17];if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((b9!=null&&(b9.constructor!=null&&b9.constructor.__interfaces!=null&&b9.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||b9===null)&&((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||d===null)&&((typeof a2==="number")||a2===null)&&((typeof du==="number")||du===null)&&((typeof cT==="number")||cT===null)&&((typeof ez==="number")||ez===null)&&((typeof a1==="boolean")||a1===null)&&((typeof f==="string")||f===null)&&((typeof cW==="number")||cW===null)&&((cU!=null&&cU instanceof Array&&(cU.length==0||cU[0]==null||cU[0] instanceof Array))||cU===null)&&((typeof bo==="boolean")||bo===null)&&((typeof b==="number")||b===null)&&((typeof dx==="string")||dx===null)&&((typeof c==="number")||c===null)&&((typeof ca==="boolean")||ca===null)&&ed===undefined&&cS===undefined&&eL===undefined&&dQ===undefined&&a3===undefined&&bK===undefined&&X===undefined&&dw===undefined&&eK===undefined&&ax===undefined&&H===undefined&&bV===undefined&&de===undefined&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var dH=cB[0];var cf=cB[1];var dT=cB[2];var aG=cB[3];var aU=cB[4];var z=cB[5];var ap=cB[6];var bt=cB[7];var eh=cB[8];var ay=cB[9];var cG=cB[10];var eq=cB[11];var bB=cB[12];var dn=cB[13];var ba=cB[14];var dy=cB[15];var a5=arguments;var ct=null;var ds=null;var eI=null;var r=null;var cu=[];var df=Date.now();var A=null;var dG=null;var ah=1;var J=false;var h=eq?PieceOfFurniture.SHOW_BACK_FACE:0;var Z=true;var bT=true;var d3=true;var cC=true;var cZ=null;var ey=null;var c7=null;var L=null;var b2=null;var cm=(-Math.PI/16);var eb=1;var aI=true;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}this.id=ct;this.name=dH;this.description=ds;this.information=eI;this.license=r;this.tags=cu;this.creationDate=df;this.grade=A;this.icon=cf;this.planIcon=dG;this.model=dT;this.width=aG;this.depth=aU;this.height=z;this.elevation=ap;this.dropOnTopElevation=ah;this.movable=bt;this.doorOrWindow=J;this.color=ay;this.staircaseCutOutShape=eh;this.creator=dn;this.horizontallyRotatable=cC;this.price=cZ;this.valueAddedTaxPercentage=ey;this.currency=c7;if(L==null||Object.keys(L).length===0){if(b2==null||Object.keys(b2).length===0){this.properties={}}else{if(Object.keys(b2).length===1){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(b2)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(b2)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(b2))}}}else{if(Object.keys(L).length===1&&(b2==null||Object.keys(b2).length===0)){this.properties=(function(eM){var eN={};eN[eM]=(function(eO){var eP=0;return{next:function(){return eP<eO.length?eO[eP++]:null},hasNext:function(){return eP<eO.length}}})((function(eO){return Object.keys(eO).map(function(eP){return eO[eP]})})(L)).next();return eN})((function(eM){var eN=0;return{next:function(){return eN<eM.length?eM[eN++]:null},hasNext:function(){return eN<eM.length}}})(Object.keys(L)).next())}else{this.properties=((function(eO){var eM={};for(var eN in eO){eM[eN]=eO[eN]}return eM})(L));if(b2!=null){(function(eM,eO){for(var eN in eO){eM[eN]=eO[eN]}})(this.properties,b2)}}}if(cG==null){this.modelRotation=PieceOfFurniture.IDENTITY_ROTATION_$LI$()}else{this.modelRotation=a.deepClone(cG)}this.modelFlags=h;this.modelSize=bB;this.resizable=Z;this.deformable=bT;this.texturable=d3;this.iconYaw=ba;this.iconPitch=cm;this.iconScale=eb;this.proportional=dy;this.modifiable=aI;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((a2!=null&&(a2.constructor!=null&&a2.constructor.__interfaces!=null&&a2.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||a2===null)&&((du!=null&&(du.constructor!=null&&du.constructor.__interfaces!=null&&du.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||du===null)&&((cT!=null&&(cT.constructor!=null&&cT.constructor.__interfaces!=null&&cT.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||cT===null)&&((typeof ez==="number")||ez===null)&&((typeof a1==="number")||a1===null)&&((typeof f==="number")||f===null)&&((typeof cW==="number")||cW===null)&&((typeof cU==="boolean")||cU===null)&&((bo!=null&&bo instanceof Array&&(bo.length==0||bo[0]==null||bo[0] instanceof Array))||bo===null)&&((typeof b==="string")||b===null)&&((typeof dx==="boolean")||dx===null)&&((c!=null&&c instanceof Big)||c===null)&&((ca!=null&&ca instanceof Big)||ca===null)&&ed===undefined&&cS===undefined&&eL===undefined&&dQ===undefined&&a3===undefined&&bK===undefined&&X===undefined&&dw===undefined&&eK===undefined&&ax===undefined&&H===undefined&&bV===undefined&&de===undefined&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var ce=cB[3];var dF=cB[4];var dS=cB[5];var cc=cB[6];var aT=cB[7];var y=cB[8];var ao=cB[9];var bs=cB[10];var cD=cB[11];var dm=cB[12];var Y=cB[13];var cY=cB[14];var ex=cB[15];var a4=arguments;var bS=true;var d2=true;if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{if(((typeof cX==="string")||cX===null)&&((typeof b9==="string")||b9===null)&&((typeof d==="string")||d===null)&&((a2!=null&&(a2.constructor!=null&&a2.constructor.__interfaces!=null&&a2.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||a2===null)&&((du!=null&&(du.constructor!=null&&du.constructor.__interfaces!=null&&du.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||du===null)&&((typeof cT==="number")||cT===null)&&((typeof ez==="number")||ez===null)&&((typeof a1==="number")||a1===null)&&((typeof f==="number")||f===null)&&((typeof cW==="boolean")||cW===null)&&((typeof cU==="boolean")||cU===null)&&((bo!=null&&bo instanceof Array&&(bo.length==0||bo[0]==null||bo[0] instanceof Array))||bo===null)&&((typeof b==="string")||b===null)&&((typeof dx==="boolean")||dx===null)&&((c!=null&&c instanceof Big)||c===null)&&((ca!=null&&ca instanceof Big)||ca===null)&&ed===undefined&&cS===undefined&&eL===undefined&&dQ===undefined&&a3===undefined&&bK===undefined&&X===undefined&&dw===undefined&&eK===undefined&&ax===undefined&&H===undefined&&bV===undefined&&de===undefined&&d0===undefined&&dv===undefined&&q===undefined&&G===undefined&&d1===undefined&&dr===undefined&&n===undefined&&dL===undefined&&cV===undefined){var cB=arguments;var cd=cB[3];var dR=cB[4];var cb=cB[5];var aS=cB[6];var x=cB[7];var an=cB[8];var bq=cB[9];var I=cB[10];var eH=cB[11];var dk=cB[12];var dp=cB[13];var dq=cB[14];var aF=cB[15];if(this.id===undefined){this.id=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.information===undefined){this.information=null}if(this.license===undefined){this.license=null}if(this.tags===undefined){this.tags=null}if(this.creationDate===undefined){this.creationDate=null}if(this.grade===undefined){this.grade=null}if(this.icon===undefined){this.icon=null}if(this.planIcon===undefined){this.planIcon=null}if(this.model===undefined){this.model=null}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.proportional===undefined){this.proportional=false}if(this.elevation===undefined){this.elevation=0}if(this.dropOnTopElevation===undefined){this.dropOnTopElevation=0}if(this.movable===undefined){this.movable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.staircaseCutOutShape===undefined){this.staircaseCutOutShape=null}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.modelSize===undefined){this.modelSize=null}if(this.creator===undefined){this.creator=null}if(this.color===undefined){this.color=null}if(this.iconYaw===undefined){this.iconYaw=0}if(this.iconPitch===undefined){this.iconPitch=0}if(this.iconScale===undefined){this.iconScale=0}if(this.modifiable===undefined){this.modifiable=false}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.texturable===undefined){this.texturable=false}if(this.horizontallyRotatable===undefined){this.horizontallyRotatable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.properties===undefined){this.properties=null}if(this.category===undefined){this.category=null}if(this.filterCollationKey===undefined){this.filterCollationKey=null}}else{throw new Error("invalid overload")}}}}}}}}}}}}a.__static_initialize=function(){if(!a.__static_initialized){a.__static_initialized=true;a.__static_initializer_0()}};a.EMPTY_CRITERIA_$LI$=function(){a.__static_initialize();if(a.EMPTY_CRITERIA==null){a.EMPTY_CRITERIA=[]}return a.EMPTY_CRITERIA};a.COMPARATOR_$LI$=function(){a.__static_initialize();return a.COMPARATOR};a.recentFilters_$LI$=function(){a.__static_initialize();return a.recentFilters};a.__static_initializer_0=function(){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}};a.COMPARATOR_$LI$();a.recentFilters={}};a.prototype.getId=function(){return this.id};a.prototype.getName=function(){return this.name};a.prototype.getDescription=function(){return this.description};a.prototype.getInformation=function(){return this.information};a.prototype.getLicense=function(){return this.license};a.prototype.getTags=function(){return this.tags};a.prototype.getCreationDate=function(){return this.creationDate};a.prototype.getGrade=function(){return this.grade};a.prototype.getDepth=function(){return this.depth};a.prototype.getHeight=function(){return this.height};a.prototype.getWidth=function(){return this.width};a.prototype.getElevation=function(){return this.elevation};a.prototype.getDropOnTopElevation=function(){return this.dropOnTopElevation};a.prototype.isMovable=function(){return this.movable};a.prototype.isDoorOrWindow=function(){return this.doorOrWindow};a.prototype.getIcon=function(){return this.icon};a.prototype.getPlanIcon=function(){return this.planIcon};a.prototype.getModel=function(){return this.model};a.prototype.getModelFlags=function(){return this.modelFlags};a.prototype.getModelSize=function(){return this.modelSize};a.prototype.getModelRotation=function(){return a.deepClone(this.modelRotation)};a.deepClone=function(d){var c=(function(f){var e=[];while(f-->0){e.push(null)}return e})(d.length);for(var b=0;b<d.length;b++){c[b]=d[b].slice(0)}return c};a.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape};a.prototype.getCreator=function(){return this.creator};a.prototype.isBackFaceShown=function(){return(this.modelFlags&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE};a.prototype.getColor=function(){return this.color};a.prototype.getIconYaw=function(){return this.iconYaw};a.prototype.getIconPitch=function(){return this.iconPitch};a.prototype.getIconScale=function(){return this.iconScale};a.prototype.isProportional=function(){return this.proportional};a.prototype.isModifiable=function(){return this.modifiable};a.prototype.isResizable=function(){return this.resizable};a.prototype.isDeformable=function(){return this.deformable};a.prototype.isWidthDepthDeformable=function(){return this.isDeformable()};a.prototype.isTexturable=function(){return this.texturable};a.prototype.isHorizontallyRotatable=function(){return this.horizontallyRotatable};a.prototype.getPrice=function(){return this.price};a.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage};a.prototype.getCurrency=function(){return this.currency};a.prototype.getProperty=function(c){var b=(function(d,e){return d[e]===undefined?null:d[e]})(this.properties,c);if(typeof b==="string"){return b}else{return null}};a.prototype.getPropertyNames=function(){return Object.keys(this.properties)};a.prototype.getContentProperty=function(c){var b=(function(d,e){return d[e]===undefined?null:d[e]})(this.properties,c);if(b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0)){return b}else{return null}};a.prototype.isContentProperty=function(b){return((function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b)!=null&&((function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b).constructor!=null&&(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b).constructor.__interfaces!=null&&(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b).constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))};a.prototype.getCategory=function(){return this.category};a.prototype.setCategory=function(b){this.category=b};a.prototype.equals=function(b){return(function(d,c){return d&&d.equals?d.equals(c):d===c})(this,b)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this)};a.prototype.compareTo=function(c){var b=a.COMPARATOR_$LI$().compare(this.name,c.name);if(b!==0){return b}else{return this.modifiable===c.modifiable?0:(this.modifiable?1:-1)}};a.prototype.matchesFilter=function(d){var e=this.getFilterCollationKeys(d);var f=0;if(e.length>0){var b=this.getPieceOfFurnitureCollationKey();for(var c=0;c<e.length;c++){if(this.isSubCollationKey(b,e[c],0)){f++}else{break}}}return f===e.length};a.prototype.getFilterCollationKeys=function(d){if(d.length===0){return a.EMPTY_CRITERIA_$LI$()}var c=(function(h,j){return h[j]===undefined?null:h[j]})(a.recentFilters_$LI$(),d);if(c==null){var g=d.split(/\s|\p{Punct}|\\|/);var f=([]);for(var b=0;b<g.length;b++){var e=g[b];if(e.length>0){(f.push(a.COMPARATOR_$LI$().getCollationKey(e).toByteArray())>0)}}if(f.length===0){c=a.EMPTY_CRITERIA_$LI$()}else{c=f.slice(0)}(a.recentFilters_$LI$()[d]=c)}return c};a.prototype.getPieceOfFurnitureCollationKey=function(){if(this.filterCollationKey==null){var d={str:"",toString:function(){return this.str}};var e=this.getFilterCriteria();var b=function(f){var g=e[f];if(d.str.length!==0){(function(h){h.str+="|";return h})(d)}(function(h){h.str+=g;return h})(d)};for(var c=0;c<e.length;c++){b(c)}this.filterCollationKey=a.COMPARATOR_$LI$().getCollationKey(d.str).toByteArray()}return this.filterCollationKey};a.prototype.getFilterCriteria=function(){var e=([]);(e.push(this.getName())>0);if(this.getCategory()!=null){(e.push(this.getCategory().getName())>0)}if(this.getCreator()!=null){(e.push(this.getCreator())>0)}if(this.getDescription()!=null){(e.push(this.getDescription())>0)}if(this.getLicense()!=null){(e.push(this.getLicense())>0)}var d=this.getTags();for(var c=0;c<d.length;c++){var b=d[c];(e.push(b)>0)}return e.slice(0)};a.prototype.isSubCollationKey=function(e,h,g){for(var d=g,f=e.length-4,b=h.length-4;d<f&&d<f-b+1;d++){if(e[d]===h[0]){for(var c=1;c<b;c++){if(e[d+c]!==h[c]){return this.isSubCollationKey(e,h,d+1)}}return true}}return false};a.prototype.clone=function(){try{var c=(function(e){var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f})(this);c.category=null;return c}catch(b){throw new IllegalStateException("Super class isn't cloneable")}};a.__static_initialized=false;return a}());CatalogPieceOfFurniture.__class="com.eteks.sweethome3d.model.CatalogPieceOfFurniture";CatalogPieceOfFurniture.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture"];var CollectionChangeSupport=(function(){function a(b){if(this.source===undefined){this.source=null}if(this.collectionListeners===undefined){this.collectionListeners=null}this.source=b;this.collectionListeners=([])}a.prototype.addCollectionListener=function(b){(this.collectionListeners.push(b)>0)};a.prototype.removeCollectionListener=function(b){(function(c){var d=c.indexOf(b);if(d>=0){c.splice(d,1);return true}else{return false}})(this.collectionListeners)};a.prototype.fireCollectionChanged$java_lang_Object$com_eteks_sweethome3d_model_CollectionEvent_Type=function(c,b){this.fireCollectionChanged(c,-1,b)};a.prototype.fireCollectionChanged$java_lang_Object$int$com_eteks_sweethome3d_model_CollectionEvent_Type=function(f,c,d){if(!(this.collectionListeners.length==0)){var b=(new CollectionEvent(this.source,f,c,d));var e=this.collectionListeners.slice(0);for(var h=0;h<e.length;h++){var g=e[h];g(b)}}};a.prototype.fireCollectionChanged=function(d,b,c){if(((d!=null)||d===null)&&((typeof b==="number")||b===null)&&((typeof c==="number")||c===null)){return this.fireCollectionChanged$java_lang_Object$int$com_eteks_sweethome3d_model_CollectionEvent_Type(d,b,c)}else{if(((d!=null)||d===null)&&((typeof b==="number")||b===null)&&c===undefined){return this.fireCollectionChanged$java_lang_Object$com_eteks_sweethome3d_model_CollectionEvent_Type(d,b)}else{throw new Error("invalid overload")}}};return a}());CollectionChangeSupport.__class="com.eteks.sweethome3d.model.CollectionChangeSupport";var CollectionEvent=(function(a){__extends(b,a);function b(c,l,j,k){var g=this;if(((c!=null)||c===null)&&((l!=null)||l===null)&&((typeof j==="number")||j===null)&&((typeof k==="number")||k===null)){var h=arguments;g=a.call(this,c)||this;if(g.item===undefined){g.item=null}if(g.index===undefined){g.index=0}if(g.type===undefined){g.type=null}g.item=l;g.index=j;g.type=k}else{if(((c!=null)||c===null)&&((l!=null)||l===null)&&((typeof j==="number")||j===null)&&k===undefined){var h=arguments;var f=h[2];var d=arguments;var e=-1;g=a.call(this,c)||this;if(g.item===undefined){g.item=null}if(g.index===undefined){g.index=0}if(g.type===undefined){g.type=null}g.item=l;g.index=e;g.type=f;if(g.item===undefined){g.item=null}if(g.index===undefined){g.index=0}if(g.type===undefined){g.type=null}}else{throw new Error("invalid overload")}}return g}b.prototype.getItem=function(){return this.item};b.prototype.getIndex=function(){return this.index};b.prototype.getType=function(){return this.type};return b}(EventObject));CollectionEvent.__class="com.eteks.sweethome3d.model.CollectionEvent";(function(b){var a;(function(c){c[c.ADD=0]="ADD";c[c.DELETE=1]="DELETE"})(a=b.Type||(b.Type={}))})(CollectionEvent||(CollectionEvent={}));CollectionEvent.__transients=["source"];var SelectionEvent=(function(b){__extends(a,b);function a(g,h,k){var j=this;if(((g!=null)||g===null)&&((h!=null&&(h instanceof Array))||h===null)&&((k!=null&&(k instanceof Array))||k===null)){var f=arguments;j=b.call(this,g)||this;if(j.oldSelectedItems===undefined){j.oldSelectedItems=null}if(j.selectedItems===undefined){j.selectedItems=null}j.oldSelectedItems=h;j.selectedItems=k}else{if(((g!=null)||g===null)&&((h!=null&&(h instanceof Array))||h===null)&&k===undefined){var f=arguments;var e=f[1];var c=arguments;var d=null;j=b.call(this,g)||this;if(j.oldSelectedItems===undefined){j.oldSelectedItems=null}if(j.selectedItems===undefined){j.selectedItems=null}j.oldSelectedItems=d;j.selectedItems=e;if(j.oldSelectedItems===undefined){j.oldSelectedItems=null}if(j.selectedItems===undefined){j.selectedItems=null}}else{throw new Error("invalid overload")}}return j}a.prototype.getOldSelectedItems=function(){return this.oldSelectedItems};a.prototype.getSelectedItems=function(){return this.selectedItems};return a}(EventObject));SelectionEvent.__class="com.eteks.sweethome3d.model.SelectionEvent";SelectionEvent.__transients=["source"];var FurnitureCategory=(function(){function a(b){if(this.name===undefined){this.name=null}if(this.furniture===undefined){this.furniture=null}this.name=b;this.furniture=([])}a.COMPARATOR_$LI$=function(){if(a.COMPARATOR==null){a.COMPARATOR={compare:function(c,b){return c.toString().localeCompare(b.toString())},equals:function(c,b){return c.toString().localeCompare(b.toString())===0}}}return a.COMPARATOR};a.prototype.getName=function(){return this.name};a.prototype.getFurniture=function(){return this.furniture.slice(0)};a.prototype.getFurnitureCount=function(){return this.furniture.length};a.prototype.getPieceOfFurniture=function(b){return this.furniture[b]};a.prototype.getIndexOfPieceOfFurniture=function(b){return this.furniture.indexOf(b)};a.prototype.add=function(c){c.setCategory(this);var b=(function(e,h){var f=function(n,l){if(n.compareTo){return n.compareTo(l)}else{return n.localeCompare(l)}};var d=0;var k=e.length-1;while(d<=k){var g=(d+k)>>>1;var m=e[g];var j=f(m,h);if(j<0){d=g+1}else{if(j>0){k=g-1}else{return g}}}return -(d+1)})(this.furniture,c);if(b<0){b=-b-1}this.furniture.splice(b,0,c)};a.prototype["delete"]=function(b){var c=this.furniture.indexOf(b);if(c===-1){throw new IllegalArgumentException(this.name+" doesn't contain piece "+b.getName())}this.furniture=(this.furniture.slice(0));this.furniture.splice(c,1)[0]};a.prototype.equals=function(b){return(b!=null&&b instanceof a)&&a.COMPARATOR_$LI$().equals(this.name,b.name)};a.prototype.hashCode=function(){return(function(b){if(b.hashCode){return b.hashCode()}else{return b.toString().split("").reduce(function(c,d){return(((c<<5)-c)+d.charCodeAt(0))|0},0)}})(this.name)};a.prototype.compareTo=function(b){return a.COMPARATOR_$LI$().compare(this.name,b.name)};return a}());FurnitureCategory.__class="com.eteks.sweethome3d.model.FurnitureCategory";var HomeMaterial=(function(){function a(b,l,d,j,m){if(((typeof b==="string")||b===null)&&((typeof l==="string")||l===null)&&((typeof d==="number")||d===null)&&((j!=null&&j instanceof HomeTexture)||j===null)&&((typeof m==="number")||m===null)){var g=arguments;if(this.name===undefined){this.name=null}if(this.key===undefined){this.key=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.shininess===undefined){this.shininess=null}this.name=b;this.key=l;this.color=d;this.texture=j;this.shininess=m}else{if(((typeof b==="string")||b===null)&&((typeof l==="number")||l===null)&&((d!=null&&d instanceof HomeTexture)||d===null)&&((typeof j==="number")||j===null)&&m===undefined){var g=arguments;var k=g[1];var h=g[2];var c=g[3];var e=arguments;var f=null;if(this.name===undefined){this.name=null}if(this.key===undefined){this.key=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.shininess===undefined){this.shininess=null}this.name=b;this.key=f;this.color=k;this.texture=h;this.shininess=c;if(this.name===undefined){this.name=null}if(this.key===undefined){this.key=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.shininess===undefined){this.shininess=null}}else{throw new Error("invalid overload")}}}a.prototype.getName=function(){return this.name};a.prototype.getKey=function(){return this.key};a.prototype.getColor=function(){return this.color};a.prototype.getTexture=function(){return this.texture};a.prototype.getShininess=function(){return this.shininess};a.prototype.equals=function(b){if(b!=null&&b instanceof a){var c=b;return(c.name===this.name||(c.name!=null&&(c.name===this.name)))&&(c.key===this.key||(c.key!=null&&(c.key===this.name)))&&(c.color===this.color||(c.color!=null&&(c.color===this.color)))&&(c.texture===this.texture||(c.texture!=null&&c.texture.equals(this.texture)))&&(c.shininess===this.shininess||(c.shininess!=null&&(c.shininess===this.shininess)))}return false};a.prototype.hashCode=function(){var b=0;if(this.name!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.name)}if(this.key!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.key)}if(this.color!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.color)}if(this.texture!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.texture)}if(this.shininess!=null){b+=(function(c){if(c.hashCode){return c.hashCode()}else{return c.toString().split("").reduce(function(d,e){return(((d<<5)-d)+e.charCodeAt(0))|0},0)}})(this.shininess)}return b};return a}());HomeMaterial.__class="com.eteks.sweethome3d.model.HomeMaterial";var Sash=(function(){function a(f,c,e,d,b){if(this.xAxis===undefined){this.xAxis=0}if(this.yAxis===undefined){this.yAxis=0}if(this.width===undefined){this.width=0}if(this.startAngle===undefined){this.startAngle=0}if(this.endAngle===undefined){this.endAngle=0}this.xAxis=f;this.yAxis=c;this.width=e;this.startAngle=d;this.endAngle=b}a.prototype.getXAxis=function(){return this.xAxis};a.prototype.getYAxis=function(){return this.yAxis};a.prototype.getWidth=function(){return this.width};a.prototype.getStartAngle=function(){return this.startAngle};a.prototype.getEndAngle=function(){return this.endAngle};return a}());Sash.__class="com.eteks.sweethome3d.model.Sash";var PieceOfFurniture;(function(a){a.DEFAULT_CUT_OUT_SHAPE="M0,0 v1 h1 v-1 z";function b(){if(a.IDENTITY_ROTATION==null){a.IDENTITY_ROTATION=[[1,0,0],[0,1,0],[0,0,1]]}return a.IDENTITY_ROTATION}a.IDENTITY_ROTATION_$LI$=b;a.SHOW_BACK_FACE=1;a.HIDE_EDGE_COLOR_MATERIAL=2})(PieceOfFurniture||(PieceOfFurniture={}));var HomeController3D=(function(){function a(l,n,e,k,m,c){var g=this;if(((l!=null&&l instanceof Home)||l===null)&&((n!=null&&n instanceof PlanController)||n===null)&&((e!=null&&e instanceof UserPreferences)||e===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||k===null)&&((m!=null&&(m.constructor!=null&&m.constructor.__interfaces!=null&&m.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||m===null)&&((c!=null&&c instanceof javax.swing.undo.UndoableEditSupport)||c===null)){var h=arguments;var d=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.planController===undefined){this.planController=null}if(this.home3DView===undefined){this.home3DView=null}if(this.topCameraState===undefined){this.topCameraState=null}if(this.observerCameraState===undefined){this.observerCameraState=null}if(this.cameraState===undefined){this.cameraState=null}this.home=l;this.preferences=e;this.viewFactory=k;this.contentManager=m;this.undoSupport=c;this.topCameraState=new a.TopCameraState(this,e);this.observerCameraState=new a.ObserverCameraState(this);this.setCameraState(l.getCamera()===l.getTopCamera()?this.topCameraState:this.observerCameraState);this.addModelListeners(l);if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.planController===undefined){this.planController=null}if(this.home3DView===undefined){this.home3DView=null}if(this.topCameraState===undefined){this.topCameraState=null}if(this.observerCameraState===undefined){this.observerCameraState=null}if(this.cameraState===undefined){this.cameraState=null}(function(){g.planController=n})()}else{if(((l!=null&&l instanceof Home)||l===null)&&((n!=null&&n instanceof UserPreferences)||n===null)&&((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||e===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||k===null)&&((m!=null&&m instanceof javax.swing.undo.UndoableEditSupport)||m===null)&&c===undefined){var h=arguments;var f=h[1];var j=h[2];var o=h[3];var b=h[4];if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.planController===undefined){this.planController=null}if(this.home3DView===undefined){this.home3DView=null}if(this.topCameraState===undefined){this.topCameraState=null}if(this.observerCameraState===undefined){this.observerCameraState=null}if(this.cameraState===undefined){this.cameraState=null}this.home=l;this.preferences=f;this.viewFactory=j;this.contentManager=o;this.undoSupport=b;this.topCameraState=new a.TopCameraState(this,f);this.observerCameraState=new a.ObserverCameraState(this);this.setCameraState(l.getCamera()===l.getTopCamera()?this.topCameraState:this.observerCameraState);this.addModelListeners(l)}else{throw new Error("invalid overload")}}}a.prototype.addModelListeners=function(e){e.addPropertyChangeListener("CAMERA",new a.HomeController3D$0(this,e));var c=new a.HomeController3D$1(this,e);var d=e.getSelectedLevel();if(d!=null){d.addPropertyChangeListener(c)}e.addPropertyChangeListener("SELECTED_LEVEL",new a.HomeController3D$2(this,e,c));var b=new a.HomeController3D$3(this,e);e.addPropertyChangeListener("SELECTED_LEVEL",b);e.getEnvironment().addPropertyChangeListener("ALL_LEVELS_VISIBLE",b)};a.prototype.getObserverCameraMinimumElevation=function(d){var c=d.getLevels();var b=c.length===0?10:10+c[0].getElevation();return b};a.prototype.getView=function(){if(this.home3DView==null){this.home3DView=this.viewFactory.createView3D(this.home,this.preferences,this)}return this.home3DView};a.prototype.viewFromTop=function(){this.home.setCamera(this.home.getTopCamera())};a.prototype.viewFromObserver=function(){this.home.setCamera(this.home.getObserverCamera())};a.prototype.storeCamera=function(c){var f=this.home.getCamera().duplicate();f.setName(c);var e=this.home.getStoredCameras();var b=([]);(function(j,h){return j.push.apply(j,h)})(b,e);for(var d=b.length-1;d>=0;d--){var g=b[d];if((c===g.getName())||(f.getX()===g.getX()&&f.getY()===g.getY()&&f.getZ()===g.getZ()&&f.getPitch()===g.getPitch()&&f.getYaw()===g.getYaw()&&f.getFieldOfView()===g.getFieldOfView()&&f.getTime()===g.getTime()&&f.getLens()===g.getLens()&&(f.getRenderer()===g.getRenderer()||f.getRenderer()!=null&&(f.getRenderer()===g.getRenderer())))){b.splice(d,1)[0]}}b.splice(0,0,f);while((b.length>this.preferences.getStoredCamerasMaxCount())){b.splice(b.length-1,1)[0]}this.home.setStoredCameras(b)};a.prototype.goToCamera=function(c){if(c!=null&&c instanceof ObserverCamera){this.viewFromObserver()}else{this.viewFromTop()}this.cameraState.goToCamera(c);var b=(this.home.getStoredCameras().slice(0));(function(d){var e=d.indexOf(c);if(e>=0){d.splice(e,1);return true}else{return false}})(b);b.splice(0,0,c);this.home.setStoredCameras(b)};a.prototype.deleteCameras=function(e){var d=this.home.getStoredCameras();var c=([]);for(var b=0;b<d.length;b++){var f=d[b];if(!(e.indexOf((f))>=0)){(c.push(f)>0)}}this.home.setStoredCameras(c)};a.prototype.displayAllLevels=function(){this.home.getEnvironment().setAllLevelsVisible(true)};a.prototype.displaySelectedLevel=function(){this.home.getEnvironment().setAllLevelsVisible(false)};a.prototype.modifyAttributes=function(){new Home3DAttributesController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())};a.prototype.setCameraState=function(b){if(this.cameraState!=null){this.cameraState.exit()}this.cameraState=b;this.cameraState.enter()};a.prototype.moveCamera=function(b){this.cameraState.moveCamera(b)};a.prototype.moveCameraSideways=function(b){this.cameraState.moveCameraSideways(b)};a.prototype.elevateCamera=function(b){this.cameraState.elevateCamera(b)};a.prototype.rotateCameraYaw=function(b){this.cameraState.rotateCameraYaw(b)};a.prototype.rotateCameraPitch=function(b){this.cameraState.rotateCameraPitch(b)};a.prototype.modifyFieldOfView=function(b){this.cameraState.modifyFieldOfView(b)};a.prototype.pressMouse=function(d,j,c,f,g,h,e,b){this.cameraState.pressMouse(d,j,c,f,g,h,e,b)};a.prototype.releaseMouse=function(b,c){this.cameraState.releaseMouse(b,c)};a.prototype.moveMouse=function(b,c){this.cameraState.moveMouse(b,c)};a.prototype.isEditingState=function(){return this.cameraState.isEditingState()};a.prototype.escape=function(){this.cameraState.escape()};a.prototype.toggleMagnetism=function(b){this.cameraState.toggleMagnetism(b)};a.prototype.setAlignmentActivated=function(b){this.cameraState.setAlignmentActivated(b)};a.prototype.setDuplicationActivated=function(b){this.cameraState.setDuplicationActivated(b)};a.prototype.getObserverCameraState=function(){return this.observerCameraState};a.prototype.getTopCameraState=function(){return this.topCameraState};return a}());HomeController3D.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D";HomeController3D.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(g){var k=(function(){function l(){}l.prototype.enter=function(){};l.prototype.exit=function(){};l.prototype.moveCamera=function(m){};l.prototype.moveCameraSideways=function(m){};l.prototype.elevateCamera=function(m){};l.prototype.rotateCameraYaw=function(m){};l.prototype.rotateCameraPitch=function(m){};l.prototype.modifyFieldOfView=function(m){};l.prototype.goToCamera=function(m){};l.prototype.isEditingState=function(){return false};l.prototype.pressMouse=function(o,t,n,q,r,s,p,m){};l.prototype.releaseMouse=function(m,n){};l.prototype.moveMouse=function(m,n){};l.prototype.escape=function(){};l.prototype.toggleMagnetism=function(m){};l.prototype.setAlignmentActivated=function(m){};l.prototype.setDuplicationActivated=function(m){};l.prototype.setEditionActivated=function(m){};return l}());g.CameraControllerState=k;k.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.CameraControllerState";var j=(function(){function l(m){if(this.topCameraState===undefined){this.topCameraState=null}this.topCameraState=(m)}l.prototype.propertyChange=function(n){var o=this.topCameraState;var m=n.getSource();if(o==null){m.removePropertyChangeListener(n.getPropertyName(),this)}else{o.setAerialViewCenteredOnSelectionEnabled(m.isAerialViewCenteredOnSelectionEnabled())}};return l}());g.UserPreferencesChangeListener=j;j.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.UserPreferencesChangeListener";var h=(function(m){__extends(l,m);function l(n){var o=m.call(this)||this;o.__parent=n;if(o.cameraMoved===undefined){o.cameraMoved=false}if(o.mouseMoved===undefined){o.mouseMoved=false}if(o.elevationActivated===undefined){o.elevationActivated=false}if(o.rotationActivated===undefined){o.rotationActivated=false}if(o.lastMousePressedPoint3D===undefined){o.lastMousePressedPoint3D=null}if(o.distancesRatio===undefined){o.distancesRatio=0}if(o.yLastMousePress===undefined){o.yLastMousePress=0}if(o.angleMousePress===undefined){o.angleMousePress=null}if(o.alignmentActivated===undefined){o.alignmentActivated=false}if(o.duplicationActivated===undefined){o.duplicationActivated=false}if(o.magnetismToggled===undefined){o.magnetismToggled=false}if(o.pointerType===undefined){o.pointerType=null}if(o.movedItems===undefined){o.movedItems=null}if(o.closestMovedPiece===undefined){o.closestMovedPiece=null}if(o.movedItemsStartPoint===undefined){o.movedItemsStartPoint=null}if(o.movedItemsDeltaX===undefined){o.movedItemsDeltaX=null}if(o.movedItemsDeltaY===undefined){o.movedItemsDeltaY=null}return o}l.prototype.isEditingState=function(){return this.movedItems!=null};l.prototype.moveCamera=function(n){this.cameraMoved=true};l.prototype.moveCameraSideways=function(n){this.cameraMoved=true};l.prototype.elevateCamera=function(n){this.cameraMoved=true};l.prototype.rotateCameraYaw=function(n){this.cameraMoved=true};l.prototype.rotateCameraPitch=function(n){this.cameraMoved=true};l.prototype.modifyFieldOfView=function(n){this.cameraMoved=true};l.prototype.goToCamera=function(n){this.cameraMoved=true};l.prototype.pressMouse=function(B,A,t,u,p,w,q,n){if(this.__parent.planController!=null&&this.__parent.preferences.isEditingIn3DViewEnabled()&&(this.__parent.getView()!=null&&(this.__parent.getView().constructor!=null&&this.__parent.getView().constructor.__interfaces!=null&&this.__parent.getView().constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View3D")>=0))&&!this.__parent.planController.isModificationState()){if(t===1){var o=this.__parent.getView().getClosestSelectableItemAt(Math.round(B),Math.round(A));var s=([]);var r=this.__parent.home.getSelectedItems();for(var v=0;v<r.length;v++){var E=r[v];if(E!=null&&E instanceof HomeFurnitureGroup){(function(y,x){return y.push.apply(y,x)})(s,E.getAllFurniture())}else{(s.push(E)>0)}}if((s.indexOf((o))>=0)&&this.__parent.planController.isItemMovable(o)&&(o!=null&&o instanceof HomePieceOfFurniture)){this.movedItems=([]);for(var v=0;v<r.length;v++){var E=r[v];if(this.__parent.planController.isItemMovable(E)&&(E!=null&&E instanceof HomePieceOfFurniture)){(this.movedItems.push(E)>0)}}this.elevationActivated=!p&&w;this.rotationActivated=p&&w;if((this.elevationActivated||this.rotationActivated)&&(o!=null&&o instanceof HomePieceOfFurniture)){if(r.length>1){this.elevationActivated=false;this.rotationActivated=false}}if(this.movedItems!=null){this.closestMovedPiece=o;var D=this.closestMovedPiece.getGroundElevation()+this.closestMovedPiece.getHeightInPlan()/2*Math.cos(this.__parent.home.getCamera().getPitch());this.lastMousePressedPoint3D=this.__parent.getView().convertPixelLocationToVirtualWorld(Math.round(B),Math.round(A));var C=Math.sqrt((this.__parent.home.getCamera().getX()-this.closestMovedPiece.getX())*(this.__parent.home.getCamera().getX()-this.closestMovedPiece.getX())+(this.__parent.home.getCamera().getY()-this.closestMovedPiece.getY())*(this.__parent.home.getCamera().getY()-this.closestMovedPiece.getY())+(this.__parent.home.getCamera().getZ()-D)*(this.__parent.home.getCamera().getZ()-D));var z=Math.sqrt((this.__parent.home.getCamera().getX()-this.lastMousePressedPoint3D[0])*(this.__parent.home.getCamera().getX()-this.lastMousePressedPoint3D[0])+(this.__parent.home.getCamera().getY()-this.lastMousePressedPoint3D[1])*(this.__parent.home.getCamera().getY()-this.lastMousePressedPoint3D[1])+(this.__parent.home.getCamera().getZ()-this.lastMousePressedPoint3D[2])*(this.__parent.home.getCamera().getZ()-this.lastMousePressedPoint3D[2]));this.distancesRatio=C/z}this.movedItemsDeltaX=null;this.movedItemsDeltaY=null}}else{if(t===2&&!(this.__parent.home.getSelectedItems().length==0)){this.__parent.planController.modifySelectedItem()}}this.mouseMoved=false;this.cameraMoved=false;this.yLastMousePress=A;this.alignmentActivated=p;this.duplicationActivated=w;this.magnetismToggled=q;this.pointerType=n}};l.prototype.releaseMouse=function(n,q){if(this.__parent.planController!=null&&this.__parent.preferences.isEditingIn3DViewEnabled()&&(this.__parent.getView()!=null&&(this.__parent.getView().constructor!=null&&this.__parent.getView().constructor.__interfaces!=null&&this.__parent.getView().constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View3D")>=0))){if(this.movedItems!=null&&this.movedItemsDeltaY!=null){this.__parent.planController.releaseMouse(this.movedItemsStartPoint[0]+this.movedItemsDeltaX,this.movedItemsStartPoint[1]+this.movedItemsDeltaY);this.__parent.planController.setFeedbackDisplayed(true)}else{if(!this.__parent.planController.isModificationState()&&!this.mouseMoved&&!this.cameraMoved){var o=this.__parent.getView().getClosestSelectableItemAt(Math.round(n),Math.round(q));if(o!=null&&this.__parent.home.isBasePlanLocked()&&this.__parent.planController.isItemPartOfBasePlan(o)){o=null}if(this.alignmentActivated){if(o!=null){var p=(this.__parent.home.getSelectedItems().slice(0));if((p.indexOf((o))>=0)){this.__parent.home.deselectItem(o)}else{(p.push(o)>0);this.__parent.home.setSelectedItems(p)}}}else{if(o!=null){this.__parent.home.setSelectedItems([o])}else{var p=[];this.__parent.home.setSelectedItems(p)}}}}this.movedItems=null;this.closestMovedPiece=null;this.elevationActivated=false;this.rotationActivated=false}};l.prototype.moveMouse=function(p,r){if(this.__parent.planController!=null&&this.__parent.preferences.isEditingIn3DViewEnabled()&&this.movedItems!=null){if(this.movedItemsDeltaY==null){this.movedItemsStartPoint=this.rotationActivated?this.movedItems[0].getPoints()[0]:[this.closestMovedPiece.getX(),this.closestMovedPiece.getY()];this.angleMousePress=null;this.__parent.planController.setFeedbackDisplayed(false);this.__parent.planController.moveMouse(this.movedItemsStartPoint[0],this.movedItemsStartPoint[1]);this.__parent.planController.pressMouse$float$float$int$boolean$boolean$boolean$boolean(this.movedItemsStartPoint[0],this.movedItemsStartPoint[1],1,false,false,this.duplicationActivated,this.magnetismToggled);if(this.elevationActivated){this.__parent.planController.setState(this.__parent.planController.getPieceOfFurnitureElevationState())}else{if(this.rotationActivated){this.__parent.planController.setState(this.__parent.planController.getPieceOfFurnitureRotationState())}else{this.__parent.home.setSelectedItems(this.movedItems);this.__parent.planController.setState(this.__parent.planController.getSelectionMoveState());this.__parent.planController.setAlignmentActivated(this.alignmentActivated)}}}if(this.rotationActivated&&this.angleMousePress==null){this.angleMousePress=Math.atan2(this.movedItemsStartPoint[1]-this.movedItems[0].getY(),this.movedItemsStartPoint[0]-this.movedItems[0].getX());if(this.pointerType===View.PointerType.TOUCH){this.lastMousePressedPoint3D=this.__parent.getView().convertPixelLocationToVirtualWorld(Math.round(p),Math.round(r))}}var o=this.__parent.getView().convertPixelLocationToVirtualWorld(Math.round(p),Math.round(r));if(this.rotationActivated){var q=this.angleMousePress-(o[0]-this.lastMousePressedPoint3D[0])*this.distancesRatio/50;var n=java.awt.geom.Point2D.distance(this.movedItems[0].getX(),this.movedItems[0].getY(),this.movedItemsStartPoint[0],this.movedItemsStartPoint[1]);this.movedItemsDeltaX=this.movedItems[0].getX()+n*Math.cos(q)-this.movedItemsStartPoint[0];this.movedItemsDeltaY=this.movedItems[0].getY()+n*Math.sin(q)-this.movedItemsStartPoint[1]}else{if(this.elevationActivated){this.movedItemsDeltaX=0;this.movedItemsDeltaY=(this.lastMousePressedPoint3D[2]-o[2])*this.distancesRatio+(r-this.yLastMousePress)*(1-Math.cos(this.__parent.home.getCamera().getPitch()))}else{this.movedItemsDeltaX=(o[0]-this.lastMousePressedPoint3D[0])*this.distancesRatio;this.movedItemsDeltaY=(o[1]-this.lastMousePressedPoint3D[1])*this.distancesRatio}}this.__parent.planController.moveMouse(this.movedItemsStartPoint[0]+this.movedItemsDeltaX,this.movedItemsStartPoint[1]+this.movedItemsDeltaY)}this.mouseMoved=true};l.prototype.escape=function(){if(this.__parent.planController!=null&&this.__parent.preferences.isEditingIn3DViewEnabled()){this.movedItems=null;this.__parent.planController.escape()}};l.prototype.toggleMagnetism=function(n){if(this.__parent.planController!=null&&this.__parent.preferences.isEditingIn3DViewEnabled()){this.magnetismToggled=n;this.__parent.planController.toggleMagnetism(n)}};l.prototype.setAlignmentActivated=function(n){if(this.__parent.planController!=null&&this.__parent.preferences.isEditingIn3DViewEnabled()){if(this.pointerType===View.PointerType.TOUCH&&n&&this.__parent.home.getSelectedItems().length===1&&!this.mouseMoved){this.elevationActivated=true;this.rotationActivated=false}this.alignmentActivated=n;this.__parent.planController.setAlignmentActivated(n)}};l.prototype.setDuplicationActivated=function(n){if(this.__parent.planController!=null&&this.__parent.preferences.isEditingIn3DViewEnabled()){if(this.pointerType===View.PointerType.TOUCH&&n&&this.__parent.home.getSelectedItems().length===1){if(this.elevationActivated&&!this.mouseMoved){this.elevationActivated=false;this.rotationActivated=true}else{this.movedItemsStartPoint[0]+=this.movedItemsDeltaX;this.movedItemsStartPoint[1]+=this.movedItemsDeltaY;this.angleMousePress=null}}this.duplicationActivated=n;if(!this.elevationActivated){this.__parent.planController.setDuplicationActivated(n)}}};return l}(g.CameraControllerState));g.EditingCameraState=h;h.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.EditingCameraState";var f=(function(m){__extends(l,m);function l(o,n){var p=m.call(this,o)||this;p.__parent=o;p.MIN_WIDTH=100;p.MIN_DEPTH=p.MIN_WIDTH;p.MIN_HEIGHT=20;if(p.topCamera===undefined){p.topCamera=null}if(p.aerialViewBoundsLowerPoint===undefined){p.aerialViewBoundsLowerPoint=null}if(p.aerialViewBoundsUpperPoint===undefined){p.aerialViewBoundsUpperPoint=null}if(p.minDistanceToAerialViewCenter===undefined){p.minDistanceToAerialViewCenter=0}if(p.maxDistanceToAerialViewCenter===undefined){p.maxDistanceToAerialViewCenter=0}if(p.aerialViewCenteredOnSelectionEnabled===undefined){p.aerialViewCenteredOnSelectionEnabled=false}if(p.previousSelectionEmpty===undefined){p.previousSelectionEmpty=false}p.distanceToCenterWithSelection=-1;p.objectChangeListener=new l.TopCameraState$0(p);p.levelsListener=function(q){if(q.getType()===CollectionEvent.Type.ADD){q.getItem().addPropertyChangeListener(p.objectChangeListener)}else{if(q.getType()===CollectionEvent.Type.DELETE){q.getItem().removePropertyChangeListener(p.objectChangeListener)}}p.updateCameraFromHomeBounds(false,false)};p.wallsListener=function(q){if(q.getType()===CollectionEvent.Type.ADD){q.getItem().addPropertyChangeListener(p.objectChangeListener)}else{if(q.getType()===CollectionEvent.Type.DELETE){q.getItem().removePropertyChangeListener(p.objectChangeListener)}}p.updateCameraFromHomeBounds(false,false)};p.furnitureListener=function(q){if(q.getType()===CollectionEvent.Type.ADD){p.addPropertyChangeListener(q.getItem(),p.objectChangeListener);p.updateCameraFromHomeBounds(o.home.getFurniture().length===1&&(o.home.getWalls().length==0)&&(o.home.getRooms().length==0),false)}else{if(q.getType()===CollectionEvent.Type.DELETE){p.removePropertyChangeListener(q.getItem(),p.objectChangeListener);p.updateCameraFromHomeBounds(false,false)}}};p.roomsListener=function(q){if(q.getType()===CollectionEvent.Type.ADD){q.getItem().addPropertyChangeListener(p.objectChangeListener)}else{if(q.getType()===CollectionEvent.Type.DELETE){q.getItem().removePropertyChangeListener(p.objectChangeListener)}}p.updateCameraFromHomeBounds(false,false)};p.polylinesListener=function(q){if(q.getType()===CollectionEvent.Type.ADD){q.getItem().addPropertyChangeListener(p.objectChangeListener)}else{if(q.getType()===CollectionEvent.Type.DELETE){q.getItem().removePropertyChangeListener(p.objectChangeListener)}}p.updateCameraFromHomeBounds(false,false)};p.dimensionLinesListener=function(q){if(q.getType()===CollectionEvent.Type.ADD){q.getItem().addPropertyChangeListener(p.objectChangeListener)}else{if(q.getType()===CollectionEvent.Type.DELETE){q.getItem().removePropertyChangeListener(p.objectChangeListener)}}p.updateCameraFromHomeBounds(false,false)};p.labelsListener=function(q){if(q.getType()===CollectionEvent.Type.ADD){q.getItem().addPropertyChangeListener(p.objectChangeListener)}else{if(q.getType()===CollectionEvent.Type.DELETE){q.getItem().removePropertyChangeListener(p.objectChangeListener)}}p.updateCameraFromHomeBounds(false,false)};p.selectionListener=new l.TopCameraState$1(p);if(p.userPreferencesChangeListener===undefined){p.userPreferencesChangeListener=null}p.userPreferencesChangeListener=new g.UserPreferencesChangeListener(p);return p}l.prototype.addPropertyChangeListener=function(o,p){if(o!=null&&o instanceof HomeFurnitureGroup){var r=o.getFurniture();for(var n=0;n<r.length;n++){var q=r[n];this.addPropertyChangeListener(q,p)}}else{o.addPropertyChangeListener(p)}};l.prototype.removePropertyChangeListener=function(o,p){if(o!=null&&o instanceof HomeFurnitureGroup){var r=o.getFurniture();for(var n=0;n<r.length;n++){var q=r[n];this.removePropertyChangeListener(q,p)}}else{o.removePropertyChangeListener(p)}};l.prototype.enter=function(){this.topCamera=this.__parent.home.getCamera();this.previousSelectionEmpty=(this.__parent.home.getSelectedItems().length==0);this.aerialViewCenteredOnSelectionEnabled=this.__parent.preferences.isAerialViewCenteredOnSelectionEnabled();this.updateCameraFromHomeBounds(false,false);var q=this.__parent.home.getLevels();for(var p=0;p<q.length;p++){var o=q[p];o.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addLevelsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.levelsListener)));var q=this.__parent.home.getWalls();for(var p=0;p<q.length;p++){var t=q[p];t.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addWallsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.wallsListener)));var q=this.__parent.home.getFurniture();for(var p=0;p<q.length;p++){var v=q[p];this.addPropertyChangeListener(v,this.objectChangeListener)}this.__parent.home.addFurnitureListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.furnitureListener)));var q=this.__parent.home.getRooms();for(var p=0;p<q.length;p++){var n=q[p];n.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addRoomsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.roomsListener)));var q=this.__parent.home.getPolylines();for(var p=0;p<q.length;p++){var s=q[p];s.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addPolylinesListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.polylinesListener)));var q=this.__parent.home.getDimensionLines();for(var p=0;p<q.length;p++){var u=q[p];u.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addDimensionLinesListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.dimensionLinesListener)));var q=this.__parent.home.getLabels();for(var p=0;p<q.length;p++){var r=q[p];r.addPropertyChangeListener(this.objectChangeListener)}this.__parent.home.addLabelsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.labelsListener)));this.__parent.home.addSelectionListener(this.selectionListener);this.__parent.preferences.addPropertyChangeListener("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",this.userPreferencesChangeListener)};l.prototype.setAerialViewCenteredOnSelectionEnabled=function(n){this.aerialViewCenteredOnSelectionEnabled=n;this.updateCameraFromHomeBounds(false,false)};l.prototype.updateCameraFromHomeBounds=function(p,n){if(!this.isEditingState()){if(this.aerialViewBoundsLowerPoint==null){this.updateAerialViewBoundsFromHomeBounds(this.aerialViewCenteredOnSelectionEnabled)}var o=void 0;if(n&&this.__parent.preferences.isAerialViewCenteredOnSelectionEnabled()&&this.distanceToCenterWithSelection!==-1){o=this.distanceToCenterWithSelection}else{o=this.getCameraToAerialViewCenterDistance()}if(!(this.__parent.home.getSelectedItems().length==0)){this.distanceToCenterWithSelection=o}this.updateAerialViewBoundsFromHomeBounds(this.aerialViewCenteredOnSelectionEnabled);this.updateCameraIntervalToAerialViewCenter();this.placeCameraAt(o,p)}};l.prototype.getCameraToAerialViewCenterDistance=function(){return Math.sqrt(Math.pow((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2-this.topCamera.getX(),2)+Math.pow((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-this.topCamera.getY(),2)+Math.pow((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2-this.topCamera.getZ(),2))};l.prototype.updateAerialViewBoundsFromHomeBounds=function(w){this.aerialViewBoundsLowerPoint=this.aerialViewBoundsUpperPoint=null;var v=[];if(w){v=([]);var s=this.__parent.home.getSelectedItems();for(var r=0;r<s.length;r++){var H=s[r];if((H!=null&&(H.constructor!=null&&H.constructor.__interfaces!=null&&H.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))&&this.isItemAtVisibleLevel(H)&&(!(H!=null&&H instanceof HomePieceOfFurniture)||H.isVisible())&&(!(H!=null&&H instanceof Polyline)||H.isVisibleIn3D())&&(!(H!=null&&H instanceof DimensionLine)||H.isVisibleIn3D())&&(!(H!=null&&H instanceof Label)||H.getPitch()!=null)){(v.push(H)>0)}}}var u=v.length===0||!w;var y=false;var s=u?this.__parent.home.getWalls():Home.getWallsSubList(v);for(var r=0;r<s.length;r++){var F=s[r];if(this.isItemAtVisibleLevel(F)){y=true;var J=F.getLevel()!=null?F.getLevel().getElevation():0;var G=u?0:J;var x=F.getHeight();var D=void 0;if(x!=null){D=J+x}else{D=J+this.__parent.home.getWallHeight()}var A=F.getHeightAtEnd();if(A!=null){D=Math.max(D,J+A)}var I=F.getPoints$();for(var q=0;q<I.length;q++){var B=I[q];this.updateAerialViewBounds(B[0],B[1],G,D)}}}var s=u?this.__parent.home.getFurniture():Home.getFurnitureSubList(v);for(var r=0;r<s.length;r++){var n=s[r];if(n.isVisible()&&this.isItemAtVisibleLevel(n)){var G=void 0;var D=void 0;if(u){G=Math.max(0,n.getGroundElevation());D=Math.max(0,n.getGroundElevation()+n.getHeightInPlan())}else{G=n.getGroundElevation();D=n.getGroundElevation()+n.getHeightInPlan()}var I=n.getPoints();for(var q=0;q<I.length;q++){var B=I[q];this.updateAerialViewBounds(B[0],B[1],G,D)}}}var s=u?this.__parent.home.getRooms():Home.getRoomsSubList(v);for(var r=0;r<s.length;r++){var E=s[r];if(this.isItemAtVisibleLevel(E)){var G=0;var D=this.MIN_HEIGHT;var o=E.getLevel();if(o!=null){G=o.getElevation()-o.getFloorThickness();D=o.getElevation();if(u){G=Math.max(0,G);D=Math.max(this.MIN_HEIGHT,o.getElevation())}}var I=E.getPoints();for(var q=0;q<I.length;q++){var B=I[q];this.updateAerialViewBounds(B[0],B[1],G,D)}}}var s=u?this.__parent.home.getPolylines():Home.getPolylinesSubList(v);for(var r=0;r<s.length;r++){var z=s[r];if(z.isVisibleIn3D()&&this.isItemAtVisibleLevel(z)){var G=void 0;var D=void 0;if(u){G=Math.max(0,z.getGroundElevation());D=Math.max(this.MIN_HEIGHT,z.getGroundElevation())}else{G=D=z.getGroundElevation()}var I=z.getPoints();for(var q=0;q<I.length;q++){var B=I[q];this.updateAerialViewBounds(B[0],B[1],G,D)}}}var s=u?this.__parent.home.getDimensionLines():Home.getDimensionLinesSubList(v);for(var r=0;r<s.length;r++){var p=s[r];if(p.isVisibleIn3D()&&this.isItemAtVisibleLevel(p)){var C=p.getLevel()!=null?p.getLevel().getElevation():0;var G=void 0;var D=void 0;if(u){G=Math.max(0,C+p.getElevationStart());D=Math.max(this.MIN_HEIGHT,C+p.getElevationEnd())}else{G=C+p.getElevationStart();D=C+p.getElevationEnd()}var I=p.getPoints();for(var q=0;q<I.length;q++){var B=I[q];this.updateAerialViewBounds(B[0],B[1],G,D)}}}var s=u?this.__parent.home.getLabels():Home.getLabelsSubList(v);for(var r=0;r<s.length;r++){var t=s[r];if(t.getPitch()!=null&&this.isItemAtVisibleLevel(t)){var G=void 0;var D=void 0;if(u){G=Math.max(0,t.getGroundElevation());D=Math.max(this.MIN_HEIGHT,t.getGroundElevation())}else{G=D=t.getGroundElevation()}var I=t.getPoints();for(var q=0;q<I.length;q++){var B=I[q];this.updateAerialViewBounds(B[0],B[1],G,D)}}}if(this.aerialViewBoundsLowerPoint==null){this.aerialViewBoundsLowerPoint=[0,0,0];this.aerialViewBoundsUpperPoint=[this.MIN_WIDTH,this.MIN_DEPTH,this.MIN_HEIGHT]}else{if(y&&u){if(this.MIN_WIDTH>this.aerialViewBoundsUpperPoint[0]-this.aerialViewBoundsLowerPoint[0]){this.aerialViewBoundsLowerPoint[0]=(this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2-this.MIN_WIDTH/2;this.aerialViewBoundsUpperPoint[0]=this.aerialViewBoundsLowerPoint[0]+this.MIN_WIDTH}if(this.MIN_DEPTH>this.aerialViewBoundsUpperPoint[1]-this.aerialViewBoundsLowerPoint[1]){this.aerialViewBoundsLowerPoint[1]=(this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-this.MIN_DEPTH/2;this.aerialViewBoundsUpperPoint[1]=this.aerialViewBoundsLowerPoint[1]+this.MIN_DEPTH}if(this.MIN_HEIGHT>this.aerialViewBoundsUpperPoint[2]-this.aerialViewBoundsLowerPoint[2]){this.aerialViewBoundsLowerPoint[2]=(this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2-this.MIN_HEIGHT/2;this.aerialViewBoundsUpperPoint[2]=this.aerialViewBoundsLowerPoint[2]+this.MIN_HEIGHT}}}};l.prototype.updateAerialViewBounds=function(n,q,p,o){if(this.aerialViewBoundsLowerPoint==null){this.aerialViewBoundsLowerPoint=[n,q,p];this.aerialViewBoundsUpperPoint=[n,q,o]}else{this.aerialViewBoundsLowerPoint[0]=Math.min(this.aerialViewBoundsLowerPoint[0],n);this.aerialViewBoundsUpperPoint[0]=Math.max(this.aerialViewBoundsUpperPoint[0],n);this.aerialViewBoundsLowerPoint[1]=Math.min(this.aerialViewBoundsLowerPoint[1],q);this.aerialViewBoundsUpperPoint[1]=Math.max(this.aerialViewBoundsUpperPoint[1],q);this.aerialViewBoundsLowerPoint[2]=Math.min(this.aerialViewBoundsLowerPoint[2],p);this.aerialViewBoundsUpperPoint[2]=Math.max(this.aerialViewBoundsUpperPoint[2],o)}};l.prototype.isItemAtVisibleLevel=function(n){return n.getLevel()==null||n.getLevel().isViewableAndVisible()};l.prototype.updateCameraIntervalToAerialViewCenter=function(){var o=this.aerialViewBoundsUpperPoint[0]-this.aerialViewBoundsLowerPoint[0];var q=this.aerialViewBoundsUpperPoint[1]-this.aerialViewBoundsLowerPoint[1];var n=this.aerialViewBoundsUpperPoint[2]-this.aerialViewBoundsLowerPoint[2];var p=Math.sqrt(o*o+q*q+n*n)/2;this.minDistanceToAerialViewCenter=p*1.05;this.maxDistanceToAerialViewCenter=Math.max(5*this.minDistanceToAerialViewCenter,5000)};l.prototype.moveCamera=function(o){m.prototype.moveCamera.call(this,o);o*=5;var n=this.getCameraToAerialViewCenterDistance()-o;this.placeCameraAt(n,false)};l.prototype.placeCameraAt=function(n,p){n=Math.max(n,this.minDistanceToAerialViewCenter);n=Math.min(n,this.maxDistanceToAerialViewCenter);if(p){n=Math.min(n,3*this.minDistanceToAerialViewCenter)}var o=n*Math.cos(this.topCamera.getPitch());this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+(Math.sin(this.topCamera.getYaw())*o));this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-(Math.cos(this.topCamera.getYaw())*o));this.topCamera.setZ((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2+Math.sin(this.topCamera.getPitch())*n)};l.prototype.rotateCameraYaw=function(p){m.prototype.rotateCameraYaw.call(this,p);var n=this.topCamera.getYaw()+p;var o=this.getCameraToAerialViewCenterDistance()*Math.cos(this.topCamera.getPitch());this.topCamera.setYaw(n);this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+(Math.sin(n)*o));this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-(Math.cos(n)*o))};l.prototype.rotateCameraPitch=function(q){m.prototype.rotateCameraPitch.call(this,q);var p=this.topCamera.getPitch()+q;p=Math.max(p,0);p=Math.min(p,Math.PI/2);var n=this.getCameraToAerialViewCenterDistance();var o=n*Math.cos(p);this.topCamera.setPitch(p);this.topCamera.setX((this.aerialViewBoundsLowerPoint[0]+this.aerialViewBoundsUpperPoint[0])/2+(Math.sin(this.topCamera.getYaw())*o));this.topCamera.setY((this.aerialViewBoundsLowerPoint[1]+this.aerialViewBoundsUpperPoint[1])/2-(Math.cos(this.topCamera.getYaw())*o));this.topCamera.setZ((this.aerialViewBoundsLowerPoint[2]+this.aerialViewBoundsUpperPoint[2])/2+(n*Math.sin(p)))};l.prototype.goToCamera=function(n){m.prototype.goToCamera.call(this,n);this.topCamera.setCamera(n);this.topCamera.setTime(n.getTime());this.topCamera.setLens(n.getLens());this.topCamera.setRenderer(n.getRenderer());this.updateCameraFromHomeBounds(false,false)};l.prototype.releaseMouse=function(n,o){m.prototype.releaseMouse.call(this,n,o);this.updateCameraFromHomeBounds(false,false)};l.prototype.exit=function(){this.topCamera=null;var q=this.__parent.home.getWalls();for(var p=0;p<q.length;p++){var t=q[p];t.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeWallsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.wallsListener)));var q=this.__parent.home.getFurniture();for(var p=0;p<q.length;p++){var v=q[p];this.removePropertyChangeListener(v,this.objectChangeListener)}this.__parent.home.removeFurnitureListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.furnitureListener)));var q=this.__parent.home.getRooms();for(var p=0;p<q.length;p++){var n=q[p];n.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeRoomsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.roomsListener)));var q=this.__parent.home.getPolylines();for(var p=0;p<q.length;p++){var s=q[p];s.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removePolylinesListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.polylinesListener)));var q=this.__parent.home.getDimensionLines();for(var p=0;p<q.length;p++){var u=q[p];u.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeDimensionLinesListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.dimensionLinesListener)));var q=this.__parent.home.getLabels();for(var p=0;p<q.length;p++){var r=q[p];r.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeLabelsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.labelsListener)));var q=this.__parent.home.getLevels();for(var p=0;p<q.length;p++){var o=q[p];o.removePropertyChangeListener(this.objectChangeListener)}this.__parent.home.removeLevelsListener(((function(w){if(w==null||typeof w=="function"){return w}return function(x){return(w.collectionChanged?w.collectionChanged:w).call(w,x)}})(this.levelsListener)));this.__parent.home.removeSelectionListener(this.selectionListener);this.__parent.preferences.removePropertyChangeListener("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",this.userPreferencesChangeListener)};return l}(g.EditingCameraState));g.TopCameraState=f;f.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.TopCameraState";(function(l){var n=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){this.__parent.updateCameraFromHomeBounds(false,false)};return o}());l.TopCameraState$0=n;var m=(function(){function o(p){this.__parent=p}o.prototype.selectionChanged=function(q){var p=(q.getSelectedItems().length==0);this.__parent.updateCameraFromHomeBounds(false,this.__parent.previousSelectionEmpty&&!p);this.__parent.previousSelectionEmpty=p};return o}());l.TopCameraState$1=m;m.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"]})(f=g.TopCameraState||(g.TopCameraState={}));var e=(function(m){__extends(l,m);function l(n){var o=m.call(this,n)||this;o.__parent=n;if(o.observerCamera===undefined){o.observerCamera=null}o.levelElevationChangeListener=new l.ObserverCameraState$0(o);o.levelsListener=function(p){if(p.getType()===CollectionEvent.Type.ADD){p.getItem().addPropertyChangeListener(o.levelElevationChangeListener)}else{if(p.getType()===CollectionEvent.Type.DELETE){p.getItem().removePropertyChangeListener(o.levelElevationChangeListener)}}o.updateCameraMinimumElevation()};return o}l.prototype.enter=function(){this.observerCamera=this.__parent.home.getCamera();var p=this.__parent.home.getLevels();for(var n=0;n<p.length;n++){var o=p[n];o.addPropertyChangeListener(this.levelElevationChangeListener)}this.__parent.home.addLevelsListener(((function(q){if(q==null||typeof q=="function"){return q}return function(r){return(q.collectionChanged?q.collectionChanged:q).call(q,r)}})(this.levelsListener)));this.selectCamera()};l.prototype.selectCamera=function(){if(this.__parent.preferences.isObserverCameraSelectedAtChange()){var n=this.__parent.home.getSelectedItems();if(!this.__parent.preferences.isEditingIn3DViewEnabled()||(n.length==0)||n.length===1&&n[0]===this.observerCamera){this.__parent.home.setSelectedItems([this.observerCamera].slice(0))}}};l.prototype.moveCamera=function(n){m.prototype.moveCamera.call(this,n);this.observerCamera.setX(this.observerCamera.getX()-Math.sin(this.observerCamera.getYaw())*n);this.observerCamera.setY(this.observerCamera.getY()+Math.cos(this.observerCamera.getYaw())*n);this.selectCamera()};l.prototype.moveCameraSideways=function(n){m.prototype.moveCameraSideways.call(this,n);this.observerCamera.setX(this.observerCamera.getX()-Math.cos(this.observerCamera.getYaw())*n);this.observerCamera.setY(this.observerCamera.getY()-Math.sin(this.observerCamera.getYaw())*n);this.selectCamera()};l.prototype.elevateCamera=function(o){m.prototype.elevateCamera.call(this,o);var n=this.observerCamera.getZ()+o;n=Math.min(Math.max(n,this.getMinimumElevation()),this.__parent.preferences.getLengthUnit().getMaximumElevation());this.observerCamera.setZ(n);this.selectCamera()};l.prototype.updateCameraMinimumElevation=function(){this.observerCamera.setZ(Math.max(this.observerCamera.getZ(),this.getMinimumElevation()))};l.prototype.getMinimumElevation=function(){var n=this.__parent.home.getLevels();if(n.length>0){return 10+n[0].getElevation()}else{return 10}};l.prototype.rotateCameraYaw=function(n){m.prototype.rotateCameraYaw.call(this,n);this.observerCamera.setYaw(this.observerCamera.getYaw()+n);this.selectCamera()};l.prototype.rotateCameraPitch=function(o){m.prototype.rotateCameraPitch.call(this,o);var n=this.observerCamera.getPitch()+o;n=Math.min(Math.max(-Math.PI/2,n),Math.PI/2);this.observerCamera.setPitch(n);this.selectCamera()};l.prototype.modifyFieldOfView=function(o){m.prototype.modifyFieldOfView.call(this,o);var n=this.observerCamera.getFieldOfView()+o;n=Math.min(Math.max((function(p){return p*Math.PI/180})(2),n),(function(p){return p*Math.PI/180})(120));this.observerCamera.setFieldOfView(n);this.selectCamera()};l.prototype.goToCamera=function(n){m.prototype.goToCamera.call(this,n);this.observerCamera.setCamera(n);this.observerCamera.setTime(n.getTime());this.observerCamera.setLens(n.getLens());this.observerCamera.setRenderer(n.getRenderer())};l.prototype.exit=function(){var r=this;var q=this.__parent.home.getSelectedItems();if((q.indexOf((this.observerCamera))>=0)){q=(q.slice(0));(function(s){var t=s.indexOf(r.observerCamera);if(t>=0){s.splice(t,1);return true}else{return false}})(q);this.__parent.home.setSelectedItems(q)}var p=this.__parent.home.getLevels();for(var n=0;n<p.length;n++){var o=p[n];o.removePropertyChangeListener(this.levelElevationChangeListener)}this.__parent.home.removeLevelsListener(((function(s){if(s==null||typeof s=="function"){return s}return function(t){return(s.collectionChanged?s.collectionChanged:s).call(s,t)}})(this.levelsListener)));this.observerCamera=null};return l}(g.EditingCameraState));g.ObserverCameraState=e;e.__class="com.eteks.sweethome3d.viewcontroller.HomeController3D.ObserverCameraState";(function(l){var m=(function(){function n(o){this.__parent=o}n.prototype.propertyChange=function(o){if("ELEVATION"===o.getPropertyName()){this.__parent.updateCameraMinimumElevation()}};return n}());l.ObserverCameraState$0=m})(e=g.ObserverCameraState||(g.ObserverCameraState={}));var d=(function(){function l(m,n){this.home=n;this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setCameraState(this.home.getCamera()===this.home.getTopCamera()?this.__parent.topCameraState:this.__parent.observerCameraState)};return l}());g.HomeController3D$0=d;var c=(function(){function l(m,n){this.home=n;this.__parent=m}l.prototype.propertyChange=function(m){if(("ELEVATION"===m.getPropertyName())&&this.home.getEnvironment().isObserverCameraElevationAdjusted()){this.home.getObserverCamera().setZ(Math.max(this.__parent.getObserverCameraMinimumElevation(this.home),this.home.getObserverCamera().getZ()+m.getNewValue()-m.getOldValue()))}};return l}());g.HomeController3D$1=c;var b=(function(){function l(n,o,m){this.home=o;this.levelElevationChangeListener=m;this.__parent=n}l.prototype.propertyChange=function(n){var m=n.getOldValue();var o=this.home.getSelectedLevel();if(this.home.getEnvironment().isObserverCameraElevationAdjusted()){this.home.getObserverCamera().setZ(Math.max(this.__parent.getObserverCameraMinimumElevation(this.home),this.home.getObserverCamera().getZ()+(o==null?0:o.getElevation())-(m==null?0:m.getElevation())))}if(m!=null){m.removePropertyChangeListener(this.levelElevationChangeListener)}if(o!=null){o.addPropertyChangeListener(this.levelElevationChangeListener)}};return l}());g.HomeController3D$2=b;var a=(function(){function l(m,n){this.home=n;this.__parent=m}l.prototype.propertyChange=function(n){var p=this.home.getLevels();var o=this.home.getSelectedLevel();var q=true;for(var m=0;m<p.length;m++){p[m].setVisible(q);if(p[m]===o&&!this.home.getEnvironment().isAllLevelsVisible()){q=false}}};return l}());g.HomeController3D$3=a})(HomeController3D||(HomeController3D={}));var TransferableView;(function(a){var b=(function(){function c(d){if(this.__name===undefined){this.__name=null}this.__name=d}c.PLAN_IMAGE_$LI$=function(){if(c.PLAN_IMAGE==null){c.PLAN_IMAGE=new a.DataType("PLAN_IMAGE")}return c.PLAN_IMAGE};c.FURNITURE_LIST_$LI$=function(){if(c.FURNITURE_LIST==null){c.FURNITURE_LIST=new a.DataType("FURNITURE_LIST")}return c.FURNITURE_LIST};c.prototype.name=function(){return this.__name};c.prototype.toString=function(){return this.__name};return c}());a.DataType=b;b.__class="com.eteks.sweethome3d.viewcontroller.TransferableView.DataType"})(TransferableView||(TransferableView={}));var ModelMaterialsController=(function(){function a(e,c,b,d){if(this.title===undefined){this.title=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.materialsChoiceView===undefined){this.materialsChoiceView=null}if(this.textureController===undefined){this.textureController=null}if(this.model===undefined){this.model=null}if(this.modelCreator===undefined){this.modelCreator=null}if(this.modelWidth===undefined){this.modelWidth=0}if(this.modelDepth===undefined){this.modelDepth=0}if(this.modelHeight===undefined){this.modelHeight=0}if(this.modelRotation===undefined){this.modelRotation=null}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.modelFlags===undefined){this.modelFlags=0}if(this.materials===undefined){this.materials=null}this.title=e;this.preferences=c;this.viewFactory=b;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this)}a.prototype.getView=function(){if(this.materialsChoiceView==null){this.materialsChoiceView=this.viewFactory.createModelMaterialsView(this.preferences,this)}return this.materialsChoiceView};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setModel=function(b){if(this.model!==b){var c=this.model;this.model=b;this.propertyChangeSupport.firePropertyChange("MODEL",c,b)}};a.prototype.getModel=function(){return this.model};a.prototype.setModelCreator=function(b){this.modelCreator=b};a.prototype.getModelCreator=function(){return this.modelCreator};a.prototype.setModelRotation=function(b){this.modelRotation=b};a.prototype.getModelRotation=function(){return this.modelRotation};a.prototype.setModelTransformations=function(b){this.modelTransformations=b};a.prototype.getModelTransformations=function(){return this.modelTransformations};a.prototype.setModelSize=function(c,d,b){this.modelWidth=c;this.modelDepth=d;this.modelHeight=b};a.prototype.getModelWidth=function(){return this.modelWidth};a.prototype.getModelDepth=function(){return this.modelDepth};a.prototype.getModelHeight=function(){return this.modelHeight};a.prototype.setBackFaceShown=function(b){this.setModelFlags((this.getModelFlags()&~PieceOfFurniture.SHOW_BACK_FACE)|(b?PieceOfFurniture.SHOW_BACK_FACE:0))};a.prototype.isBackFaceShown=function(){return(this.modelFlags&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE};a.prototype.setModelFlags=function(b){this.modelFlags=b};a.prototype.getModelFlags=function(){return this.modelFlags};a.prototype.setMaterials=function(b){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(this.materials,b)){var c=this.materials;this.materials=b;this.propertyChangeSupport.firePropertyChange("MATERIALS",c,b)}};a.prototype.getMaterials=function(){return this.materials};a.prototype.getDialogTitle=function(){return this.title};a.prototype.getTextureController=function(){if(this.textureController==null){this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"textureTitle"),this.preferences,this.viewFactory,this.contentManager)}return this.textureController};return a}());ModelMaterialsController.__class="com.eteks.sweethome3d.viewcontroller.ModelMaterialsController";ModelMaterialsController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var WizardController=(function(){function a(c,b){if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.stepStatePropertyChangeListener===undefined){this.stepStatePropertyChangeListener=null}if(this.wizardView===undefined){this.wizardView=null}if(this.stepState===undefined){this.stepState=null}if(this.backStepEnabled===undefined){this.backStepEnabled=false}if(this.nextStepEnabled===undefined){this.nextStepEnabled=false}if(this.lastStep===undefined){this.lastStep=false}if(this.stepView===undefined){this.stepView=null}if(this.stepIcon===undefined){this.stepIcon=null}if(this.title===undefined){this.title=null}if(this.resizable===undefined){this.resizable=false}this.preferences=c;this.viewFactory=b;this.stepStatePropertyChangeListener=new a.WizardController$0(this);this.propertyChangeSupport=new PropertyChangeSupport(this)}a.prototype.getView=function(){if(this.wizardView==null){this.wizardView=this.viewFactory.createWizardView(this.preferences,this)}return this.wizardView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setBackStepEnabled=function(b){if(b!==this.backStepEnabled){this.backStepEnabled=b;this.propertyChangeSupport.firePropertyChange("BACK_STEP_ENABLED",!b,b)}};a.prototype.isBackStepEnabled=function(){return this.backStepEnabled};a.prototype.setNextStepEnabled=function(b){if(b!==this.nextStepEnabled){this.nextStepEnabled=b;this.propertyChangeSupport.firePropertyChange("NEXT_STEP_ENABLED",!b,b)}};a.prototype.isNextStepEnabled=function(){return this.nextStepEnabled};a.prototype.setLastStep=function(b){if(b!==this.lastStep){this.lastStep=b;this.propertyChangeSupport.firePropertyChange("LAST_STEP",!b,b)}};a.prototype.isLastStep=function(){return this.lastStep};a.prototype.setStepView=function(c){if(c!==this.stepView){var b=this.stepView;this.stepView=c;this.propertyChangeSupport.firePropertyChange("STEP_VIEW",b,c)}};a.prototype.getStepView=function(){return this.stepView};a.prototype.setStepIcon=function(b){if(b!==this.stepIcon){var c=this.stepIcon;this.stepIcon=b;this.propertyChangeSupport.firePropertyChange("STEP_ICON",c,b)}};a.prototype.getStepIcon=function(){return this.stepIcon};a.prototype.setTitle=function(c){if(c!==this.title){var b=this.title;this.title=c;this.propertyChangeSupport.firePropertyChange("TITLE",b,c)}};a.prototype.getTitle=function(){return this.title};a.prototype.setResizable=function(b){if(b!==this.resizable){this.resizable=b;this.propertyChangeSupport.firePropertyChange("RESIZABLE",!b,b)}};a.prototype.isResizable=function(){return this.resizable};a.prototype.setStepState=function(b){if(this.stepState!=null){this.stepState.exit();this.stepState.removePropertyChangeListener(this.stepStatePropertyChangeListener)}this.stepState=b;this.setBackStepEnabled(!b.isFirstStep());this.setNextStepEnabled(b.isNextStepEnabled());this.setStepView(b.getView());this.setStepIcon(b.getIcon());this.setLastStep(b.isLastStep());this.stepState.addPropertyChangeListener(this.stepStatePropertyChangeListener);this.stepState.enter()};a.prototype.getStepState=function(){return this.stepState};a.prototype.goToNextStep=function(){this.stepState.goToNextStep()};a.prototype.goBackToPreviousStep=function(){this.stepState.goBackToPreviousStep()};return a}());WizardController.__class="com.eteks.sweethome3d.viewcontroller.WizardController";WizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(c){var a=(function(){function d(){if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.firstStep===undefined){this.firstStep=false}if(this.lastStep===undefined){this.lastStep=false}if(this.nextStepEnabled===undefined){this.nextStepEnabled=false}this.propertyChangeSupport=new PropertyChangeSupport(this)}d.prototype.addPropertyChangeListener=function(e){this.propertyChangeSupport.addPropertyChangeListener(e)};d.prototype.removePropertyChangeListener=function(e){this.propertyChangeSupport.removePropertyChangeListener(e)};d.prototype.enter=function(){};d.prototype.exit=function(){};d.prototype.getIcon=function(){return null};d.prototype.goBackToPreviousStep=function(){};d.prototype.goToNextStep=function(){};d.prototype.isFirstStep=function(){return this.firstStep};d.prototype.setFirstStep=function(e){if(e!==this.firstStep){this.firstStep=e;this.propertyChangeSupport.firePropertyChange("FIRST_STEP",!e,e)}};d.prototype.isLastStep=function(){return this.lastStep};d.prototype.setLastStep=function(e){if(e!==this.lastStep){this.lastStep=e;this.propertyChangeSupport.firePropertyChange("LAST_STEP",!e,e)}};d.prototype.isNextStepEnabled=function(){return this.nextStepEnabled};d.prototype.setNextStepEnabled=function(e){if(e!==this.nextStepEnabled){this.nextStepEnabled=e;this.propertyChangeSupport.firePropertyChange("NEXT_STEP_ENABLED",!e,e)}};return d}());c.WizardControllerStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.WizardController.WizardControllerStepState";var b=(function(){function d(e){this.__parent=e}d.prototype.propertyChange=function(e){switch((e.getPropertyName())){case"FIRST_STEP":this.__parent.setBackStepEnabled(!this.__parent.stepState.isFirstStep());break;case"LAST_STEP":this.__parent.setLastStep(this.__parent.stepState.isLastStep());break;case"NEXT_STEP_ENABLED":this.__parent.setNextStepEnabled(this.__parent.stepState.isNextStepEnabled());break}};return d}());c.WizardController$0=b})(WizardController||(WizardController={}));var BaseboardChoiceController=(function(){function a(c,b,d){if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.textureController===undefined){this.textureController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.view===undefined){this.view=null}if(this.visible===undefined){this.visible=null}if(this.thickness===undefined){this.thickness=null}if(this.height===undefined){this.height=null}if(this.maxHeight===undefined){this.maxHeight=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}this.preferences=c;this.viewFactory=b;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this)}a.prototype.getTextureController=function(){if(this.textureController==null){this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"baseboardTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.textureController.addPropertyChangeListener("TEXTURE",new a.BaseboardChoiceController$0(this))}return this.textureController};a.prototype.getView=function(){if(this.view==null){this.view=this.viewFactory.createBaseboardChoiceView(this.preferences,this)}return this.view};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.getVisible=function(){return this.visible};a.prototype.setVisible=function(b){if(b!==this.visible){var c=this.visible;this.visible=b;this.propertyChangeSupport.firePropertyChange("VISIBLE",c,b)}};a.prototype.setThickness=function(c){if(c!==this.thickness){var b=this.thickness;this.thickness=c;this.propertyChangeSupport.firePropertyChange("THICKNESS",b,c)}};a.prototype.getThickness=function(){return this.thickness};a.prototype.setHeight=function(b){if(b!==this.height){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b)}};a.prototype.getHeight=function(){return this.height};a.prototype.setMaxHeight=function(c){if(this.maxHeight==null||c!==this.maxHeight){var b=this.maxHeight;this.maxHeight=c;this.propertyChangeSupport.firePropertyChange("MAX_HEIGHT",b,c)}};a.prototype.getMaxHeight=function(){return this.maxHeight};a.prototype.setColor=function(c){if(c!==this.color){var b=this.color;this.color=c;this.propertyChangeSupport.firePropertyChange("COLOR",b,c);this.setPaint(a.BaseboardPaint.COLORED)}};a.prototype.getColor=function(){return this.color};a.prototype.setPaint=function(c){if(c!==this.paint){var b=this.paint;this.paint=c;this.propertyChangeSupport.firePropertyChange("PAINT",b,c)}};a.prototype.getPaint=function(){return this.paint};a.prototype.setBaseboard=function(b){if(b==null){this.setVisible(false);this.setThickness(null);this.setHeight(null);this.setColor(null);this.getTextureController().setTexture(null);this.setPaint(null)}else{this.setVisible(true);this.setThickness(b.getThickness());this.setHeight(b.getHeight());if(b.getTexture()!=null){this.setColor(null);this.getTextureController().setTexture(b.getTexture());this.setPaint(a.BaseboardPaint.TEXTURED)}else{if(b.getColor()!=null){this.getTextureController().setTexture(null);this.setColor(b.getColor())}else{this.setColor(null);this.getTextureController().setTexture(null);this.setPaint(a.BaseboardPaint.DEFAULT)}}}};return a}());BaseboardChoiceController.__class="com.eteks.sweethome3d.viewcontroller.BaseboardChoiceController";BaseboardChoiceController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var c;(function(d){d[d.DEFAULT=0]="DEFAULT";d[d.COLORED=1]="COLORED";d[d.TEXTURED=2]="TEXTURED"})(c=a.BaseboardPaint||(a.BaseboardPaint={}));var b=(function(){function d(e){this.__parent=e}d.prototype.propertyChange=function(e){this.__parent.setPaint(a.BaseboardPaint.TEXTURED)};return d}());a.BaseboardChoiceController$0=b})(BaseboardChoiceController||(BaseboardChoiceController={}));var HomeView;(function(a){a.SORT_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX="SORT_HOME_FURNITURE_ADDITIONAL_PROPERTY_BY_";a.DISPLAY_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX="DISPLAY_HOME_FURNITURE_ADDITIONAL_PROPERTY_"})(HomeView||(HomeView={}));(function(a){var d;(function(e){e[e.NEW_HOME=0]="NEW_HOME";e[e.NEW_HOME_FROM_EXAMPLE=1]="NEW_HOME_FROM_EXAMPLE";e[e.CLOSE=2]="CLOSE";e[e.OPEN=3]="OPEN";e[e.DELETE_RECENT_HOMES=4]="DELETE_RECENT_HOMES";e[e.SAVE=5]="SAVE";e[e.SAVE_AS=6]="SAVE_AS";e[e.SAVE_AND_COMPRESS=7]="SAVE_AND_COMPRESS";e[e.PAGE_SETUP=8]="PAGE_SETUP";e[e.PRINT_PREVIEW=9]="PRINT_PREVIEW";e[e.PRINT=10]="PRINT";e[e.PRINT_TO_PDF=11]="PRINT_TO_PDF";e[e.PREFERENCES=12]="PREFERENCES";e[e.EXIT=13]="EXIT";e[e.UNDO=14]="UNDO";e[e.REDO=15]="REDO";e[e.CUT=16]="CUT";e[e.COPY=17]="COPY";e[e.PASTE=18]="PASTE";e[e.PASTE_TO_GROUP=19]="PASTE_TO_GROUP";e[e.PASTE_STYLE=20]="PASTE_STYLE";e[e.DELETE=21]="DELETE";e[e.SELECT_ALL=22]="SELECT_ALL";e[e.SELECT_ALL_AT_ALL_LEVELS=23]="SELECT_ALL_AT_ALL_LEVELS";e[e.ADD_HOME_FURNITURE=24]="ADD_HOME_FURNITURE";e[e.ADD_FURNITURE_TO_GROUP=25]="ADD_FURNITURE_TO_GROUP";e[e.DELETE_HOME_FURNITURE=26]="DELETE_HOME_FURNITURE";e[e.MODIFY_FURNITURE=27]="MODIFY_FURNITURE";e[e.IMPORT_FURNITURE=28]="IMPORT_FURNITURE";e[e.IMPORT_FURNITURE_LIBRARY=29]="IMPORT_FURNITURE_LIBRARY";e[e.IMPORT_TEXTURE=30]="IMPORT_TEXTURE";e[e.IMPORT_TEXTURES_LIBRARY=31]="IMPORT_TEXTURES_LIBRARY";e[e.SORT_HOME_FURNITURE_BY_CATALOG_ID=32]="SORT_HOME_FURNITURE_BY_CATALOG_ID";e[e.SORT_HOME_FURNITURE_BY_NAME=33]="SORT_HOME_FURNITURE_BY_NAME";e[e.SORT_HOME_FURNITURE_BY_DESCRIPTION=34]="SORT_HOME_FURNITURE_BY_DESCRIPTION";e[e.SORT_HOME_FURNITURE_BY_CREATOR=35]="SORT_HOME_FURNITURE_BY_CREATOR";e[e.SORT_HOME_FURNITURE_BY_LICENSE=36]="SORT_HOME_FURNITURE_BY_LICENSE";e[e.SORT_HOME_FURNITURE_BY_WIDTH=37]="SORT_HOME_FURNITURE_BY_WIDTH";e[e.SORT_HOME_FURNITURE_BY_DEPTH=38]="SORT_HOME_FURNITURE_BY_DEPTH";e[e.SORT_HOME_FURNITURE_BY_HEIGHT=39]="SORT_HOME_FURNITURE_BY_HEIGHT";e[e.SORT_HOME_FURNITURE_BY_X=40]="SORT_HOME_FURNITURE_BY_X";e[e.SORT_HOME_FURNITURE_BY_Y=41]="SORT_HOME_FURNITURE_BY_Y";e[e.SORT_HOME_FURNITURE_BY_ELEVATION=42]="SORT_HOME_FURNITURE_BY_ELEVATION";e[e.SORT_HOME_FURNITURE_BY_ANGLE=43]="SORT_HOME_FURNITURE_BY_ANGLE";e[e.SORT_HOME_FURNITURE_BY_LEVEL=44]="SORT_HOME_FURNITURE_BY_LEVEL";e[e.SORT_HOME_FURNITURE_BY_MODEL_SIZE=45]="SORT_HOME_FURNITURE_BY_MODEL_SIZE";e[e.SORT_HOME_FURNITURE_BY_COLOR=46]="SORT_HOME_FURNITURE_BY_COLOR";e[e.SORT_HOME_FURNITURE_BY_TEXTURE=47]="SORT_HOME_FURNITURE_BY_TEXTURE";e[e.SORT_HOME_FURNITURE_BY_MOVABILITY=48]="SORT_HOME_FURNITURE_BY_MOVABILITY";e[e.SORT_HOME_FURNITURE_BY_TYPE=49]="SORT_HOME_FURNITURE_BY_TYPE";e[e.SORT_HOME_FURNITURE_BY_VISIBILITY=50]="SORT_HOME_FURNITURE_BY_VISIBILITY";e[e.SORT_HOME_FURNITURE_BY_PRICE=51]="SORT_HOME_FURNITURE_BY_PRICE";e[e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE=52]="SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE";e[e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX=53]="SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX";e[e.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED=54]="SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED";e[e.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER=55]="SORT_HOME_FURNITURE_BY_DESCENDING_ORDER";e[e.DISPLAY_HOME_FURNITURE_CATALOG_ID=56]="DISPLAY_HOME_FURNITURE_CATALOG_ID";e[e.DISPLAY_HOME_FURNITURE_NAME=57]="DISPLAY_HOME_FURNITURE_NAME";e[e.DISPLAY_HOME_FURNITURE_DESCRIPTION=58]="DISPLAY_HOME_FURNITURE_DESCRIPTION";e[e.DISPLAY_HOME_FURNITURE_CREATOR=59]="DISPLAY_HOME_FURNITURE_CREATOR";e[e.DISPLAY_HOME_FURNITURE_LICENSE=60]="DISPLAY_HOME_FURNITURE_LICENSE";e[e.DISPLAY_HOME_FURNITURE_WIDTH=61]="DISPLAY_HOME_FURNITURE_WIDTH";e[e.DISPLAY_HOME_FURNITURE_DEPTH=62]="DISPLAY_HOME_FURNITURE_DEPTH";e[e.DISPLAY_HOME_FURNITURE_HEIGHT=63]="DISPLAY_HOME_FURNITURE_HEIGHT";e[e.DISPLAY_HOME_FURNITURE_X=64]="DISPLAY_HOME_FURNITURE_X";e[e.DISPLAY_HOME_FURNITURE_Y=65]="DISPLAY_HOME_FURNITURE_Y";e[e.DISPLAY_HOME_FURNITURE_ELEVATION=66]="DISPLAY_HOME_FURNITURE_ELEVATION";e[e.DISPLAY_HOME_FURNITURE_ANGLE=67]="DISPLAY_HOME_FURNITURE_ANGLE";e[e.DISPLAY_HOME_FURNITURE_LEVEL=68]="DISPLAY_HOME_FURNITURE_LEVEL";e[e.DISPLAY_HOME_FURNITURE_MODEL_SIZE=69]="DISPLAY_HOME_FURNITURE_MODEL_SIZE";e[e.DISPLAY_HOME_FURNITURE_COLOR=70]="DISPLAY_HOME_FURNITURE_COLOR";e[e.DISPLAY_HOME_FURNITURE_TEXTURE=71]="DISPLAY_HOME_FURNITURE_TEXTURE";e[e.DISPLAY_HOME_FURNITURE_MOVABLE=72]="DISPLAY_HOME_FURNITURE_MOVABLE";e[e.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW=73]="DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW";e[e.DISPLAY_HOME_FURNITURE_VISIBLE=74]="DISPLAY_HOME_FURNITURE_VISIBLE";e[e.DISPLAY_HOME_FURNITURE_PRICE=75]="DISPLAY_HOME_FURNITURE_PRICE";e[e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE=76]="DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE";e[e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX=77]="DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX";e[e.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED=78]="DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED";e[e.ALIGN_FURNITURE_ON_TOP=79]="ALIGN_FURNITURE_ON_TOP";e[e.ALIGN_FURNITURE_ON_BOTTOM=80]="ALIGN_FURNITURE_ON_BOTTOM";e[e.ALIGN_FURNITURE_ON_LEFT=81]="ALIGN_FURNITURE_ON_LEFT";e[e.ALIGN_FURNITURE_ON_RIGHT=82]="ALIGN_FURNITURE_ON_RIGHT";e[e.ALIGN_FURNITURE_ON_FRONT_SIDE=83]="ALIGN_FURNITURE_ON_FRONT_SIDE";e[e.ALIGN_FURNITURE_ON_BACK_SIDE=84]="ALIGN_FURNITURE_ON_BACK_SIDE";e[e.ALIGN_FURNITURE_ON_LEFT_SIDE=85]="ALIGN_FURNITURE_ON_LEFT_SIDE";e[e.ALIGN_FURNITURE_ON_RIGHT_SIDE=86]="ALIGN_FURNITURE_ON_RIGHT_SIDE";e[e.ALIGN_FURNITURE_SIDE_BY_SIDE=87]="ALIGN_FURNITURE_SIDE_BY_SIDE";e[e.DISTRIBUTE_FURNITURE_HORIZONTALLY=88]="DISTRIBUTE_FURNITURE_HORIZONTALLY";e[e.DISTRIBUTE_FURNITURE_VERTICALLY=89]="DISTRIBUTE_FURNITURE_VERTICALLY";e[e.RESET_FURNITURE_ELEVATION=90]="RESET_FURNITURE_ELEVATION";e[e.GROUP_FURNITURE=91]="GROUP_FURNITURE";e[e.UNGROUP_FURNITURE=92]="UNGROUP_FURNITURE";e[e.EXPORT_TO_CSV=93]="EXPORT_TO_CSV";e[e.SELECT=94]="SELECT";e[e.PAN=95]="PAN";e[e.CREATE_WALLS=96]="CREATE_WALLS";e[e.CREATE_ROOMS=97]="CREATE_ROOMS";e[e.CREATE_DIMENSION_LINES=98]="CREATE_DIMENSION_LINES";e[e.CREATE_POLYLINES=99]="CREATE_POLYLINES";e[e.CREATE_LABELS=100]="CREATE_LABELS";e[e.DELETE_SELECTION=101]="DELETE_SELECTION";e[e.LOCK_BASE_PLAN=102]="LOCK_BASE_PLAN";e[e.UNLOCK_BASE_PLAN=103]="UNLOCK_BASE_PLAN";e[e.ENABLE_MAGNETISM=104]="ENABLE_MAGNETISM";e[e.DISABLE_MAGNETISM=105]="DISABLE_MAGNETISM";e[e.FLIP_HORIZONTALLY=106]="FLIP_HORIZONTALLY";e[e.FLIP_VERTICALLY=107]="FLIP_VERTICALLY";e[e.MODIFY_COMPASS=108]="MODIFY_COMPASS";e[e.MODIFY_WALL=109]="MODIFY_WALL";e[e.JOIN_WALLS=110]="JOIN_WALLS";e[e.REVERSE_WALL_DIRECTION=111]="REVERSE_WALL_DIRECTION";e[e.SPLIT_WALL=112]="SPLIT_WALL";e[e.MODIFY_ROOM=113]="MODIFY_ROOM";e[e.RECOMPUTE_ROOM_POINTS=114]="RECOMPUTE_ROOM_POINTS";e[e.ADD_ROOM_POINT=115]="ADD_ROOM_POINT";e[e.DELETE_ROOM_POINT=116]="DELETE_ROOM_POINT";e[e.MODIFY_POLYLINE=117]="MODIFY_POLYLINE";e[e.MODIFY_DIMENSION_LINE=118]="MODIFY_DIMENSION_LINE";e[e.MODIFY_LABEL=119]="MODIFY_LABEL";e[e.INCREASE_TEXT_SIZE=120]="INCREASE_TEXT_SIZE";e[e.DECREASE_TEXT_SIZE=121]="DECREASE_TEXT_SIZE";e[e.TOGGLE_BOLD_STYLE=122]="TOGGLE_BOLD_STYLE";e[e.TOGGLE_ITALIC_STYLE=123]="TOGGLE_ITALIC_STYLE";e[e.IMPORT_BACKGROUND_IMAGE=124]="IMPORT_BACKGROUND_IMAGE";e[e.MODIFY_BACKGROUND_IMAGE=125]="MODIFY_BACKGROUND_IMAGE";e[e.HIDE_BACKGROUND_IMAGE=126]="HIDE_BACKGROUND_IMAGE";e[e.SHOW_BACKGROUND_IMAGE=127]="SHOW_BACKGROUND_IMAGE";e[e.DELETE_BACKGROUND_IMAGE=128]="DELETE_BACKGROUND_IMAGE";e[e.ADD_LEVEL=129]="ADD_LEVEL";e[e.ADD_LEVEL_AT_SAME_ELEVATION=130]="ADD_LEVEL_AT_SAME_ELEVATION";e[e.MAKE_LEVEL_VIEWABLE=131]="MAKE_LEVEL_VIEWABLE";e[e.MAKE_LEVEL_UNVIEWABLE=132]="MAKE_LEVEL_UNVIEWABLE";e[e.MAKE_LEVEL_ONLY_VIEWABLE_ONE=133]="MAKE_LEVEL_ONLY_VIEWABLE_ONE";e[e.MAKE_ALL_LEVELS_VIEWABLE=134]="MAKE_ALL_LEVELS_VIEWABLE";e[e.MODIFY_LEVEL=135]="MODIFY_LEVEL";e[e.DELETE_LEVEL=136]="DELETE_LEVEL";e[e.ZOOM_OUT=137]="ZOOM_OUT";e[e.ZOOM_IN=138]="ZOOM_IN";e[e.EXPORT_TO_SVG=139]="EXPORT_TO_SVG";e[e.SELECT_OBJECT=140]="SELECT_OBJECT";e[e.TOGGLE_SELECTION=141]="TOGGLE_SELECTION";e[e.VIEW_FROM_TOP=142]="VIEW_FROM_TOP";e[e.VIEW_FROM_OBSERVER=143]="VIEW_FROM_OBSERVER";e[e.MODIFY_OBSERVER=144]="MODIFY_OBSERVER";e[e.STORE_POINT_OF_VIEW=145]="STORE_POINT_OF_VIEW";e[e.DELETE_POINTS_OF_VIEW=146]="DELETE_POINTS_OF_VIEW";e[e.CREATE_PHOTOS_AT_POINTS_OF_VIEW=147]="CREATE_PHOTOS_AT_POINTS_OF_VIEW";e[e.DETACH_3D_VIEW=148]="DETACH_3D_VIEW";e[e.ATTACH_3D_VIEW=149]="ATTACH_3D_VIEW";e[e.DISPLAY_ALL_LEVELS=150]="DISPLAY_ALL_LEVELS";e[e.DISPLAY_SELECTED_LEVEL=151]="DISPLAY_SELECTED_LEVEL";e[e.MODIFY_3D_ATTRIBUTES=152]="MODIFY_3D_ATTRIBUTES";e[e.CREATE_PHOTO=153]="CREATE_PHOTO";e[e.CREATE_VIDEO=154]="CREATE_VIDEO";e[e.EXPORT_TO_OBJ=155]="EXPORT_TO_OBJ";e[e.HELP=156]="HELP";e[e.ABOUT=157]="ABOUT"})(d=a.ActionType||(a.ActionType={}));var c;(function(e){e[e.SAVE=0]="SAVE";e[e.CANCEL=1]="CANCEL";e[e.DO_NOT_SAVE=2]="DO_NOT_SAVE"})(c=a.SaveAnswer||(a.SaveAnswer={}));var b;(function(e){e[e.REMOVE_DAMAGED_ITEMS=0]="REMOVE_DAMAGED_ITEMS";e[e.REPLACE_DAMAGED_ITEMS=1]="REPLACE_DAMAGED_ITEMS";e[e.DO_NOT_OPEN_HOME=2]="DO_NOT_OPEN_HOME"})(b=a.OpenDamagedHomeAnswer||(a.OpenDamagedHomeAnswer={}))})(HomeView||(HomeView={}));var FurnitureCatalogController=(function(){function a(e,c,h,j){if(((e!=null&&e instanceof FurnitureCatalog)||e===null)&&((c!=null&&c instanceof UserPreferences)||c===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||j===null)){var f=arguments;if(this.catalog===undefined){this.catalog=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.selectedFurniture===undefined){this.selectedFurniture=null}if(this.catalogView===undefined){this.catalogView=null}this.catalog=e;this.preferences=c;this.viewFactory=h;this.contentManager=j;this.selectionListeners=([]);this.selectedFurniture=[];this.catalog.addFurnitureListener((function(l){if(l==null||typeof l=="function"){return l}return function(m){return(l.collectionChanged?l.collectionChanged:l).call(l,m)}})(new a.FurnitureCatalogChangeListener(this)));if(c!=null){c.addPropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",new a.FurnitureCatalogViewChangeListener(this))}}else{if(((e!=null&&e instanceof FurnitureCatalog)||e===null)&&((c!=null&&(c.constructor!=null&&c.constructor.__interfaces!=null&&c.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||c===null)&&h===undefined&&j===undefined){var f=arguments;var g=f[1];var b=arguments;var d=null;var k=null;if(this.catalog===undefined){this.catalog=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.selectedFurniture===undefined){this.selectedFurniture=null}if(this.catalogView===undefined){this.catalogView=null}this.catalog=e;this.preferences=d;this.viewFactory=g;this.contentManager=k;this.selectionListeners=([]);this.selectedFurniture=[];this.catalog.addFurnitureListener((function(l){if(l==null||typeof l=="function"){return l}return function(m){return(l.collectionChanged?l.collectionChanged:l).call(l,m)}})(new a.FurnitureCatalogChangeListener(this)));if(d!=null){d.addPropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",new a.FurnitureCatalogViewChangeListener(this))}if(this.catalog===undefined){this.catalog=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.selectedFurniture===undefined){this.selectedFurniture=null}if(this.catalogView===undefined){this.catalogView=null}}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.catalogView==null){this.catalogView=this.viewFactory.createFurnitureCatalogView(this.catalog,this.preferences,this)}return this.catalogView};a.prototype.addSelectionListener=function(b){(this.selectionListeners.push(b)>0)};a.prototype.removeSelectionListener=function(b){(function(c){var d=c.indexOf(b);if(d>=0){c.splice(d,1);return true}else{return false}})(this.selectionListeners)};a.prototype.getSelectedFurniture=function(){return this.selectedFurniture.slice(0)};a.prototype.setSelectedFurniture=function(c){this.selectedFurniture=(c.slice(0));if(!(this.selectionListeners.length==0)){var b=new SelectionEvent(this,this.getSelectedFurniture());var e=this.selectionListeners.slice(0);for(var d=0;d<e.length;d++){var f=e[d];f.selectionChanged(b)}}};a.prototype.deselectPieceOfFurniture=function(c){var b=this.selectedFurniture.indexOf(c);if(b!==-1){var d=(this.getSelectedFurniture().slice(0));d.splice(b,1)[0];this.setSelectedFurniture(d)}};a.prototype.modifySelectedFurniture=function(){if(this.preferences!=null){if(this.selectedFurniture.length>0){var b=this.selectedFurniture[0];if(b.isModifiable()){var c=new a.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(c)));new ImportedFurnitureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView());c.selectAddedFurniture();this.preferences.getFurnitureCatalog().removeFurnitureListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(c)))}}}};a.prototype.importFurniture$=function(){if(this.preferences!=null){var b=new a.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)));new ImportedFurnitureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView());b.selectAddedFurniture();this.preferences.getFurnitureCatalog().removeFurnitureListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))}};a.prototype.importFurniture$java_lang_String=function(b){if(this.preferences!=null){new ImportedFurnitureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())}};a.prototype.importFurniture=function(b){if(((typeof b==="string")||b===null)){return this.importFurniture$java_lang_String(b)}else{if(b===undefined){return this.importFurniture$()}else{throw new Error("invalid overload")}}};a.prototype.deleteSelection=function(){for(var b=0;b<this.selectedFurniture.length;b++){var c=this.selectedFurniture[b];if(c.isModifiable()){this.catalog["delete"](c)}}};a.prototype.dropFiles=function(b){var e=new a.AddedFurnitureSelector(this);this.preferences.getFurnitureCatalog().addFurnitureListener(((function(f){if(f==null||typeof f=="function"){return f}return function(g){return(f.collectionChanged?f.collectionChanged:f).call(f,g)}})(e)));for(var d=0;d<b.length;d++){var c=b[d];this.importFurniture$java_lang_String(c)}e.selectAddedFurniture();this.preferences.getFurnitureCatalog().removeFurnitureListener(((function(f){if(f==null||typeof f=="function"){return f}return function(g){return(f.collectionChanged?f.collectionChanged:f).call(f,g)}})(e)))};return a}());FurnitureCatalogController.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController";FurnitureCatalogController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var b=(function(){function e(f){if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}this.furnitureCatalogController=(f)}e.prototype.collectionChanged=function(g){var f=this.furnitureCatalogController;if(f==null){g.getSource().removeFurnitureListener(((function(h){if(h==null||typeof h=="function"){return h}return function(j){return(h.collectionChanged?h.collectionChanged:h).call(h,j)}})(this)))}else{if(g.getType()===CollectionEvent.Type.DELETE){f.deselectPieceOfFurniture(g.getItem())}}};return e}());d.FurnitureCatalogChangeListener=b;b.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.FurnitureCatalogChangeListener";b.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var a=(function(){function e(f){if(this.controller===undefined){this.controller=null}this.controller=(f)}e.prototype.propertyChange=function(g){var f=this.controller;if(f==null){(g.getSource()).removePropertyChangeListener("FURNITURE_CATALOG_VIEWED_IN_TREE",this)}else{f.catalogView=null}};return e}());d.FurnitureCatalogViewChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.FurnitureCatalogViewChangeListener";var c=(function(){function e(f){this.__parent=f;this.addedFurniture=([])}e.prototype.collectionChanged=function(f){if(f.getType()===CollectionEvent.Type.ADD){(this.addedFurniture.push(f.getItem())>0)}};e.prototype.selectAddedFurniture=function(){if(this.addedFurniture.length>0){this.__parent.setSelectedFurniture(this.addedFurniture)}};return e}());d.AddedFurnitureSelector=c;c.__class="com.eteks.sweethome3d.viewcontroller.FurnitureCatalogController.AddedFurnitureSelector";c.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"]})(FurnitureCatalogController||(FurnitureCatalogController={}));var ObserverCameraController=(function(){function a(d,c,b){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.observerCameraView===undefined){this.observerCameraView=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.elevation===undefined){this.elevation=0}if(this.minimumElevation===undefined){this.minimumElevation=0}if(this.yawInDegrees===undefined){this.yawInDegrees=0}if(this.yaw===undefined){this.yaw=0}if(this.pitchInDegrees===undefined){this.pitchInDegrees=0}if(this.pitch===undefined){this.pitch=0}if(this.fieldOfViewInDegrees===undefined){this.fieldOfViewInDegrees=0}if(this.fieldOfView===undefined){this.fieldOfView=0}if(this.elevationAdjusted===undefined){this.elevationAdjusted=false}this.home=d;this.preferences=c;this.viewFactory=b;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.observerCameraView==null){this.observerCameraView=this.viewFactory.createObserverCameraView(this.preferences,this)}return this.observerCameraView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var c=this.home.getObserverCamera();this.setX(c.getX());this.setY(c.getY());var d=this.home.getLevels();this.setMinimumElevation(d.length===0?10:10+d[0].getElevation());this.setElevation(c.getZ());this.setYaw(c.getYaw());this.setPitch(c.getPitch());this.setFieldOfView(c.getFieldOfView());var b=this.home.getEnvironment();this.setElevationAdjusted(b.isObserverCameraElevationAdjusted())};a.prototype.setX=function(b){if(b!==this.x){var c=this.x;this.x=b;this.propertyChangeSupport.firePropertyChange("X",c,b)}};a.prototype.getX=function(){return this.x};a.prototype.setY=function(c){if(c!==this.y){var b=this.y;this.y=c;this.propertyChangeSupport.firePropertyChange("Y",b,c)}};a.prototype.getY=function(){return this.y};a.prototype.setElevation=function(b){if(b!==this.elevation){var c=this.elevation;this.elevation=b;this.propertyChangeSupport.firePropertyChange("ELEVATION",c,b)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.setMinimumElevation=function(c){if(c!==this.minimumElevation){var b=this.minimumElevation;this.minimumElevation=c;this.propertyChangeSupport.firePropertyChange("MINIMUM_ELEVATION",b,c)}};a.prototype.getMinimumElevation=function(){return this.minimumElevation};a.prototype.isElevationAdjusted=function(){return this.elevationAdjusted};a.prototype.setElevationAdjusted=function(c){if(this.elevationAdjusted!==c){this.elevationAdjusted=c;this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_ELEVATION_ADJUSTED",!c,c);var b=this.home.getSelectedLevel();if(b!=null){if(c){this.setElevation(this.getElevation()-b.getElevation())}else{this.setElevation(this.getElevation()+b.getElevation())}}}};a.prototype.isObserverCameraElevationAdjustedEditable=function(){return this.home.getLevels().length>1};a.prototype.setYawInDegrees=function(d,c){if(c===void 0){c=true}if(d!==this.yawInDegrees){var b=this.yawInDegrees;this.yawInDegrees=d;this.propertyChangeSupport.firePropertyChange("YAW_IN_DEGREES",b,d);if(c){this.setYaw((function(e){return e*Math.PI/180})(d),false)}}};a.prototype.getYawInDegrees=function(){return this.yawInDegrees};a.prototype.setYaw=function(d,c){if(c===void 0){c=true}if(d!==this.yaw){var b=this.yaw;this.yaw=d;this.propertyChangeSupport.firePropertyChange("YAW",b,d);if(c){this.setYawInDegrees((Math.round((function(e){return e*180/Math.PI})(d))|0),false)}}};a.prototype.getYaw=function(){return this.yaw};a.prototype.setPitchInDegrees=function(d,b){if(b===void 0){b=true}if(d!==this.pitchInDegrees){var c=this.pitchInDegrees;this.pitchInDegrees=d;this.propertyChangeSupport.firePropertyChange("PITCH_IN_DEGREES",c,d);if(b){this.setPitch((function(e){return e*Math.PI/180})(d),false)}}};a.prototype.getPitchInDegrees=function(){return this.pitchInDegrees};a.prototype.setPitch=function(d,c){if(c===void 0){c=true}if(d!==this.pitch){var b=this.pitch;this.pitch=d;this.propertyChangeSupport.firePropertyChange("PITCH",b,d);if(c){this.setPitchInDegrees(((Math.round((function(e){return e*180/Math.PI})(d)))|0),false)}}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setFieldOfViewInDegrees=function(c,d){if(d===void 0){d=true}if(c!==this.fieldOfViewInDegrees){var b=this.fieldOfViewInDegrees;this.fieldOfViewInDegrees=c;this.propertyChangeSupport.firePropertyChange("FIELD_OF_VIEW_IN_DEGREES",b,c);if(d){this.setFieldOfView((function(e){return e*Math.PI/180})(c),false)}}};a.prototype.getFieldOfViewInDegrees=function(){return this.fieldOfViewInDegrees};a.prototype.setFieldOfView=function(c,b){if(b===void 0){b=true}if(c!==this.fieldOfView){var d=this.fieldOfView;this.fieldOfView=c;this.propertyChangeSupport.firePropertyChange("FIELD_OF_VIEW",d,c);if(b){this.setFieldOfViewInDegrees(((Math.round((function(e){return e*180/Math.PI})(c)))|0),false)}}};a.prototype.getFieldOfView=function(){return this.fieldOfView};a.prototype.modifyObserverCamera=function(){var k=this.getX();var j=this.getY();var h=this.getElevation();var b=this.isElevationAdjusted();var l=this.home.getSelectedLevel();if(b&&l!=null){h+=l.getElevation();var m=this.home.getLevels();h=Math.max(h,m.length===0?10:10+m[0].getElevation())}var e=this.getYaw();var c=this.getPitch();var f=this.getFieldOfView();var d=this.home.getObserverCamera();d.setX(k);d.setY(j);d.setZ(h);d.setYaw(e);d.setPitch(c);d.setFieldOfView(f);var g=this.home.getEnvironment();g.setObserverCameraElevationAdjusted(b)};return a}());ObserverCameraController.__class="com.eteks.sweethome3d.viewcontroller.ObserverCameraController";ObserverCameraController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var View;(function(b){var a;(function(c){c[c.MOUSE=0]="MOUSE";c[c.TOUCH=1]="TOUCH"})(a=b.PointerType||(b.PointerType={}))})(View||(View={}));var UserPreferencesController=(function(){function a(d,b,g,e){if(((d!=null&&d instanceof UserPreferences)||d===null)&&((b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||b===null)&&((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||g===null)&&((e!=null&&e instanceof HomeController)||e===null)){var f=arguments;if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.homeController===undefined){this.homeController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.userPreferencesView===undefined){this.userPreferencesView=null}if(this.language===undefined){this.language=null}if(this.unit===undefined){this.unit=null}if(this.currency===undefined){this.currency=null}if(this.valueAddedTaxEnabled===undefined){this.valueAddedTaxEnabled=false}if(this.furnitureCatalogViewedInTree===undefined){this.furnitureCatalogViewedInTree=false}if(this.navigationPanelVisible===undefined){this.navigationPanelVisible=false}if(this.editingIn3DViewEnabled===undefined){this.editingIn3DViewEnabled=false}if(this.aerialViewCenteredOnSelectionEnabled===undefined){this.aerialViewCenteredOnSelectionEnabled=false}if(this.observerCameraSelectedAtChange===undefined){this.observerCameraSelectedAtChange=false}if(this.magnetismEnabled===undefined){this.magnetismEnabled=false}if(this.rulersVisible===undefined){this.rulersVisible=false}if(this.gridVisible===undefined){this.gridVisible=false}if(this.defaultFontName===undefined){this.defaultFontName=null}if(this.furnitureViewedFromTop===undefined){this.furnitureViewedFromTop=false}if(this.furnitureModelIconSize===undefined){this.furnitureModelIconSize=0}if(this.roomFloorColoredOrTextured===undefined){this.roomFloorColoredOrTextured=false}if(this.wallPattern===undefined){this.wallPattern=null}if(this.newWallPattern===undefined){this.newWallPattern=null}if(this.newWallThickness===undefined){this.newWallThickness=0}if(this.newWallHeight===undefined){this.newWallHeight=0}if(this.newFloorThickness===undefined){this.newFloorThickness=0}if(this.checkUpdatesEnabled===undefined){this.checkUpdatesEnabled=false}if(this.autoSaveDelayForRecovery===undefined){this.autoSaveDelayForRecovery=0}if(this.autoSaveForRecoveryEnabled===undefined){this.autoSaveForRecoveryEnabled=false}this.preferences=d;this.viewFactory=b;this.homeController=e;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{if(((d!=null&&d instanceof UserPreferences)||d===null)&&((b!=null&&(b.constructor!=null&&b.constructor.__interfaces!=null&&b.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||b===null)&&((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||g===null)&&e===undefined){var f=arguments;var h=arguments;var c=null;if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.homeController===undefined){this.homeController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.userPreferencesView===undefined){this.userPreferencesView=null}if(this.language===undefined){this.language=null}if(this.unit===undefined){this.unit=null}if(this.currency===undefined){this.currency=null}if(this.valueAddedTaxEnabled===undefined){this.valueAddedTaxEnabled=false}if(this.furnitureCatalogViewedInTree===undefined){this.furnitureCatalogViewedInTree=false}if(this.navigationPanelVisible===undefined){this.navigationPanelVisible=false}if(this.editingIn3DViewEnabled===undefined){this.editingIn3DViewEnabled=false}if(this.aerialViewCenteredOnSelectionEnabled===undefined){this.aerialViewCenteredOnSelectionEnabled=false}if(this.observerCameraSelectedAtChange===undefined){this.observerCameraSelectedAtChange=false}if(this.magnetismEnabled===undefined){this.magnetismEnabled=false}if(this.rulersVisible===undefined){this.rulersVisible=false}if(this.gridVisible===undefined){this.gridVisible=false}if(this.defaultFontName===undefined){this.defaultFontName=null}if(this.furnitureViewedFromTop===undefined){this.furnitureViewedFromTop=false}if(this.furnitureModelIconSize===undefined){this.furnitureModelIconSize=0}if(this.roomFloorColoredOrTextured===undefined){this.roomFloorColoredOrTextured=false}if(this.wallPattern===undefined){this.wallPattern=null}if(this.newWallPattern===undefined){this.newWallPattern=null}if(this.newWallThickness===undefined){this.newWallThickness=0}if(this.newWallHeight===undefined){this.newWallHeight=0}if(this.newFloorThickness===undefined){this.newFloorThickness=0}if(this.checkUpdatesEnabled===undefined){this.checkUpdatesEnabled=false}if(this.autoSaveDelayForRecovery===undefined){this.autoSaveDelayForRecovery=0}if(this.autoSaveForRecoveryEnabled===undefined){this.autoSaveForRecoveryEnabled=false}this.preferences=d;this.viewFactory=b;this.homeController=c;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties();this.preferences=d;this.viewFactory=b;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.userPreferencesView==null){this.userPreferencesView=this.viewFactory.createUserPreferencesView(this.preferences,this)}return this.userPreferencesView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){this.setLanguage(this.preferences.getLanguage());this.setUnit(this.preferences.getLengthUnit());this.setCurrency(this.preferences.getCurrency());this.setValueAddedTaxEnabled(this.preferences.isValueAddedTaxEnabled());this.setFurnitureCatalogViewedInTree(this.preferences.isFurnitureCatalogViewedInTree());this.setNavigationPanelVisible(this.preferences.isNavigationPanelVisible());this.setEditingIn3DViewEnabled(this.preferences.isEditingIn3DViewEnabled());this.setAerialViewCenteredOnSelectionEnabled(this.preferences.isAerialViewCenteredOnSelectionEnabled());this.setObserverCameraSelectedAtChange(this.preferences.isObserverCameraSelectedAtChange());this.setMagnetismEnabled(this.preferences.isMagnetismEnabled());this.setRulersVisible(this.preferences.isRulersVisible());this.setGridVisible(this.preferences.isGridVisible());this.setDefaultFontName(this.preferences.getDefaultFontName());this.setFurnitureViewedFromTop(this.preferences.isFurnitureViewedFromTop());this.setFurnitureModelIconSize(this.preferences.getFurnitureModelIconSize());this.setRoomFloorColoredOrTextured(this.preferences.isRoomFloorColoredOrTextured());this.setWallPattern(this.preferences.getWallPattern());this.setNewWallPattern(this.preferences.getNewWallPattern());var c=this.getUnit().getMinimumLength();var b=this.getUnit().getMaximumLength();this.setNewWallThickness(Math.min(Math.max(c,this.preferences.getNewWallThickness()),b/10));this.setNewWallHeight(Math.min(Math.max(c,this.preferences.getNewWallHeight()),b));this.setNewFloorThickness(Math.min(Math.max(c,this.preferences.getNewFloorThickness()),b/10));this.setCheckUpdatesEnabled(this.preferences.isCheckUpdatesEnabled());this.setAutoSaveDelayForRecovery(this.preferences.getAutoSaveDelayForRecovery());this.setAutoSaveForRecoveryEnabled(this.preferences.getAutoSaveDelayForRecovery()>0)};a.prototype.isPropertyEditable=function(b){switch((b)){case"LANGUAGE":return this.preferences.isLanguageEditable();default:return true}};a.prototype.setLanguage=function(c){if(c!==this.language){var b=this.language;this.language=c;this.propertyChangeSupport.firePropertyChange("LANGUAGE",b,c)}};a.prototype.getLanguage=function(){return this.language};a.prototype.setUnit=function(b){if(b!==this.unit){var c=this.unit;this.unit=b;this.propertyChangeSupport.firePropertyChange("UNIT",c,b)}};a.prototype.getUnit=function(){return this.unit};a.prototype.setCurrency=function(b){if(b!==this.currency){var c=this.currency;this.currency=b;this.propertyChangeSupport.firePropertyChange("CURRENCY",c,b);if(b==null){this.setValueAddedTaxEnabled(false)}}};a.prototype.getCurrency=function(){return this.currency};a.prototype.setValueAddedTaxEnabled=function(b){if(this.valueAddedTaxEnabled!==b){this.valueAddedTaxEnabled=b;this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_ENABLED",!b,b)}};a.prototype.isValueAddedTaxEnabled=function(){return this.valueAddedTaxEnabled};a.prototype.setFurnitureCatalogViewedInTree=function(b){if(this.furnitureCatalogViewedInTree!==b){this.furnitureCatalogViewedInTree=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_CATALOG_VIEWED_IN_TREE",!b,b)}};a.prototype.isFurnitureCatalogViewedInTree=function(){return this.furnitureCatalogViewedInTree};a.prototype.setNavigationPanelVisible=function(b){if(this.navigationPanelVisible!==b){this.navigationPanelVisible=b;this.propertyChangeSupport.firePropertyChange("NAVIGATION_PANEL_VISIBLE",!b,b)}};a.prototype.isNavigationPanelVisible=function(){return this.navigationPanelVisible};a.prototype.setEditingIn3DViewEnabled=function(b){if(b!==this.editingIn3DViewEnabled){this.editingIn3DViewEnabled=b;this.propertyChangeSupport.firePropertyChange("EDITING_IN_3D_VIEW_ENABLED",!b,b)}};a.prototype.isEditingIn3DViewEnabled=function(){return this.editingIn3DViewEnabled};a.prototype.setAerialViewCenteredOnSelectionEnabled=function(b){if(b!==this.aerialViewCenteredOnSelectionEnabled){this.aerialViewCenteredOnSelectionEnabled=b;this.propertyChangeSupport.firePropertyChange("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",!b,b)}};a.prototype.isAerialViewCenteredOnSelectionEnabled=function(){return this.aerialViewCenteredOnSelectionEnabled};a.prototype.setObserverCameraSelectedAtChange=function(b){if(b!==this.observerCameraSelectedAtChange){this.observerCameraSelectedAtChange=b;this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_SELECTED_AT_CHANGE",!b,b)}};a.prototype.isObserverCameraSelectedAtChange=function(){return this.observerCameraSelectedAtChange};a.prototype.setMagnetismEnabled=function(b){if(b!==this.magnetismEnabled){this.magnetismEnabled=b;this.propertyChangeSupport.firePropertyChange("MAGNETISM_ENABLED",!b,b)}};a.prototype.isMagnetismEnabled=function(){return this.magnetismEnabled};a.prototype.setRulersVisible=function(b){if(b!==this.rulersVisible){this.rulersVisible=b;this.propertyChangeSupport.firePropertyChange("RULERS_VISIBLE",!b,b)}};a.prototype.isRulersVisible=function(){return this.rulersVisible};a.prototype.setGridVisible=function(b){if(b!==this.gridVisible){this.gridVisible=b;this.propertyChangeSupport.firePropertyChange("GRID_VISIBLE",!b,b)}};a.prototype.isGridVisible=function(){return this.gridVisible};a.prototype.setDefaultFontName=function(c){if(c!==this.defaultFontName&&(c==null||!(c===this.defaultFontName))){var b=this.defaultFontName;this.defaultFontName=c;this.propertyChangeSupport.firePropertyChange("DEFAULT_FONT_NAME",b,c)}};a.prototype.getDefaultFontName=function(){return this.defaultFontName};a.prototype.setFurnitureViewedFromTop=function(b){if(this.furnitureViewedFromTop!==b){this.furnitureViewedFromTop=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_VIEWED_FROM_TOP",!b,b)}};a.prototype.isFurnitureViewedFromTop=function(){return this.furnitureViewedFromTop};a.prototype.setFurnitureModelIconSize=function(b){if(b!==this.furnitureModelIconSize){var c=this.furnitureModelIconSize;this.furnitureModelIconSize=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_MODEL_ICON_SIZE",c,b)}};a.prototype.getFurnitureModelIconSize=function(){return this.furnitureModelIconSize};a.prototype.setRoomFloorColoredOrTextured=function(b){if(this.roomFloorColoredOrTextured!==b){this.roomFloorColoredOrTextured=b;this.propertyChangeSupport.firePropertyChange("ROOM_FLOOR_COLORED_OR_TEXTURED",!b,b)}};a.prototype.isRoomFloorColoredOrTextured=function(){return this.roomFloorColoredOrTextured};a.prototype.setWallPattern=function(b){if(this.wallPattern!==b){var c=this.wallPattern;this.wallPattern=b;this.propertyChangeSupport.firePropertyChange("WALL_PATTERN",c,b)}};a.prototype.getWallPattern=function(){return this.wallPattern};a.prototype.setNewWallPattern=function(b){if(this.newWallPattern!==b){var c=this.newWallPattern;this.newWallPattern=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_PATTERN",c,b)}};a.prototype.getNewWallPattern=function(){return this.newWallPattern};a.prototype.setNewWallThickness=function(b){if(b!==this.newWallThickness){var c=this.newWallThickness;this.newWallThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_THICKNESS",c,b)}};a.prototype.getNewWallThickness=function(){return this.newWallThickness};a.prototype.setNewWallHeight=function(c){if(c!==this.newWallHeight){var b=this.newWallHeight;this.newWallHeight=c;this.propertyChangeSupport.firePropertyChange("NEW_WALL_HEIGHT",b,c)}};a.prototype.getNewWallHeight=function(){return this.newWallHeight};a.prototype.setNewFloorThickness=function(b){if(b!==this.newFloorThickness){var c=this.newFloorThickness;this.newFloorThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_FLOOR_THICKNESS",c,b)}};a.prototype.getNewFloorThickness=function(){return this.newFloorThickness};a.prototype.setCheckUpdatesEnabled=function(b){if(b!==this.checkUpdatesEnabled){this.checkUpdatesEnabled=b;this.propertyChangeSupport.firePropertyChange("CHECK_UPDATES_ENABLED",!b,b)}};a.prototype.isCheckUpdatesEnabled=function(){return this.checkUpdatesEnabled};a.prototype.setAutoSaveDelayForRecovery=function(c){if(c!==this.autoSaveDelayForRecovery){var b=this.autoSaveDelayForRecovery;this.autoSaveDelayForRecovery=c;this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_DELAY_FOR_RECOVERY",b,c)}};a.prototype.getAutoSaveDelayForRecovery=function(){return this.autoSaveDelayForRecovery};a.prototype.setAutoSaveForRecoveryEnabled=function(b){if(b!==this.autoSaveForRecoveryEnabled){this.autoSaveForRecoveryEnabled=b;this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_FOR_RECOVERY_ENABLED",!b,b)}};a.prototype.isAutoSaveForRecoveryEnabled=function(){return this.autoSaveForRecoveryEnabled};a.prototype.resetDisplayedActionTips=function(){this.preferences.resetIgnoredActionTips()};a.prototype.modifyUserPreferences=function(){this.preferences.setLanguage(this.getLanguage());this.preferences.setUnit(this.getUnit());this.preferences.setCurrency(this.getCurrency());this.preferences.setValueAddedTaxEnabled(this.isValueAddedTaxEnabled());this.preferences.setFurnitureCatalogViewedInTree(this.isFurnitureCatalogViewedInTree());this.preferences.setNavigationPanelVisible(this.isNavigationPanelVisible());this.preferences.setEditingIn3DViewEnabled(this.isEditingIn3DViewEnabled());this.preferences.setAerialViewCenteredOnSelectionEnabled(this.isAerialViewCenteredOnSelectionEnabled());this.preferences.setObserverCameraSelectedAtChange(this.isObserverCameraSelectedAtChange());this.preferences.setMagnetismEnabled(this.isMagnetismEnabled());this.preferences.setRulersVisible(this.isRulersVisible());this.preferences.setGridVisible(this.isGridVisible());this.preferences.setDefaultFontName(this.getDefaultFontName());this.preferences.setFurnitureViewedFromTop(this.isFurnitureViewedFromTop());this.preferences.setFurnitureModelIconSize(this.getFurnitureModelIconSize());this.preferences.setFloorColoredOrTextured(this.isRoomFloorColoredOrTextured());this.preferences.setWallPattern(this.getWallPattern());this.preferences.setNewWallPattern(this.getNewWallPattern());this.preferences.setNewWallThickness(this.getNewWallThickness());this.preferences.setNewWallHeight(this.getNewWallHeight());this.preferences.setNewFloorThickness(this.getNewFloorThickness());this.preferences.setCheckUpdatesEnabled(this.isCheckUpdatesEnabled());this.preferences.setAutoSaveDelayForRecovery(this.isAutoSaveForRecoveryEnabled()?this.getAutoSaveDelayForRecovery():0)};return a}());UserPreferencesController.__class="com.eteks.sweethome3d.viewcontroller.UserPreferencesController";UserPreferencesController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var VideoController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.videoView===undefined){this.videoView=null}if(this.aspectRatio===undefined){this.aspectRatio=null}if(this.frameRate===undefined){this.frameRate=0}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.quality===undefined){this.quality=0}if(this.speed===undefined){this.speed=0}if(this.cameraPath===undefined){this.cameraPath=null}if(this.time===undefined){this.time=0}if(this.renderer===undefined){this.renderer=null}if(this.ceilingLightColor===undefined){this.ceilingLightColor=0}this.home=e;this.preferences=c;this.viewFactory=b;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties();e.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",new a.HomeEnvironmentChangeListener(this))}a.prototype.getView=function(){if(this.videoView==null){this.videoView=this.viewFactory.createVideoView(this.home,this.preferences,this)}return this.videoView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getEnvironment();this.setFrameRate(b.getVideoFrameRate());this.setWidth(b.getVideoWidth(),false);this.setHeight(b.getVideoHeight(),false);this.setAspectRatio(b.getVideoAspectRatio());this.setQuality(b.getVideoQuality());this.setSpeed(b.getVideoSpeed());var d=b.getVideoCameraPath();this.setCameraPath(d);this.setTime((d.length==0)?this.home.getCamera().getTime():d[0].getTime());var c=this.home.getCamera().getRenderer();if(c==null){c=this.preferences.getPhotoRenderer()}this.setRenderer(c,false);this.setCeilingLightColor(b.getCeillingLightColor())};a.prototype.setAspectRatio=function(b){if(this.aspectRatio!==b){var c=this.aspectRatio;this.aspectRatio=b;this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",c,b);this.home.getEnvironment().setVideoAspectRatio(this.aspectRatio);this.setHeight(Math.round(this.width/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}};a.prototype.getAspectRatio=function(){return this.aspectRatio};a.prototype.setFrameRate=function(b){if(this.frameRate!==b){var c=this.frameRate;this.frameRate=b;this.propertyChangeSupport.firePropertyChange("QUALITY",c,b);this.home.getEnvironment().setVideoFrameRate(this.frameRate)}};a.prototype.getFrameRate=function(){return this.frameRate};a.prototype.setWidth=function(c,d){if(d===void 0){d=true}if(this.width!==c){var b=this.width;this.width=c;this.propertyChangeSupport.firePropertyChange("WIDTH",b,c);if(d){this.setHeight(Math.round(c/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}this.home.getEnvironment().setVideoWidth(this.width)}};a.prototype.getWidth=function(){return this.width};a.prototype.setHeight=function(b,d){if(d===void 0){d=true}if(this.height!==b){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b);if(d){this.setWidth(Math.round(b*{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}};a.prototype.getHeight=function(){return this.height};a.prototype.setQuality=function(c){if(this.quality!==c){var b=this.quality;this.quality=Math.min(c,this.getQualityLevelCount()-1);this.propertyChangeSupport.firePropertyChange("QUALITY",b,c);this.home.getEnvironment().setVideoQuality(this.quality)}};a.prototype.getQuality=function(){return this.quality};a.prototype.setSpeed=function(c){if(this.speed!==c){var b=this.speed;this.speed=c;this.propertyChangeSupport.firePropertyChange("SPEED",b,c);this.home.getEnvironment().setVideoSpeed(this.speed)}};a.prototype.getSpeed=function(){return this.speed};a.prototype.getQualityLevelCount=function(){return 4};a.prototype.getCameraPath=function(){return this.cameraPath};a.prototype.setCameraPath=function(b){if(this.cameraPath!==b){var c=this.cameraPath;this.cameraPath=b;this.propertyChangeSupport.firePropertyChange("CAMERA_PATH",c,b);this.home.getEnvironment().setVideoCameraPath(this.cameraPath)}};a.prototype.setTime=function(b){if(this.time!==b){var c=this.time;this.time=b;this.propertyChangeSupport.firePropertyChange("TIME",c,b);this.home.getCamera().setTime(b)}};a.prototype.getTime=function(){return this.time};a.prototype.setRenderer=function(d,b){if(b===void 0){b=true}if(this.renderer!==d){var c=this.renderer;this.renderer=d;this.propertyChangeSupport.firePropertyChange("RENDERER",c,d);var e=this.home.getEnvironment().getVideoCameraPath();if(!(e.length==0)){e=(e.slice(0));e[0].setRenderer(d);this.setCameraPath(e)}if(b){this.preferences.setPhotoRenderer(d)}}};a.prototype.getRenderer=function(){return this.renderer};a.prototype.setCeilingLightColor=function(b){if(this.ceilingLightColor!==b){var c=this.ceilingLightColor;this.ceilingLightColor=b;this.propertyChangeSupport.firePropertyChange("CEILING_LIGHT_COLOR",c,b);this.home.getEnvironment().setCeillingLightColor(b)}};a.prototype.getCeilingLightColor=function(){return this.ceilingLightColor};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};return a}());VideoController.__class="com.eteks.sweethome3d.viewcontroller.VideoController";VideoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(){function c(d){if(this.videoController===undefined){this.videoController=null}this.videoController=(d)}c.prototype.propertyChange=function(e){var d=this.videoController;if(d==null){e.getSource().removePropertyChangeListener("CEILING_LIGHT_COLOR",this)}else{d.updateProperties()}};return c}());b.HomeEnvironmentChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.VideoController.HomeEnvironmentChangeListener"})(VideoController||(VideoController={}));var LocalizedUndoableEdit=(function(a){__extends(b,a);function b(d,e,c){var f=a.call(this)||this;if(f.preferences===undefined){f.preferences=null}if(f.controllerClass===undefined){f.controllerClass=null}if(f.presentationNameKey===undefined){f.presentationNameKey=null}f.preferences=d;f.controllerClass=e;f.presentationNameKey=c;return f}b.prototype.getPresentationName=function(){return this.preferences.getLocalizedString(this.controllerClass,this.presentationNameKey)};return b}(javax.swing.undo.AbstractUndoableEdit));LocalizedUndoableEdit.__class="com.eteks.sweethome3d.viewcontroller.LocalizedUndoableEdit";LocalizedUndoableEdit.__interfaces=["javax.swing.undo.UndoableEdit"];var ContentManager;(function(a){var b;(function(c){c[c.SWEET_HOME_3D=0]="SWEET_HOME_3D";c[c.MODEL=1]="MODEL";c[c.IMAGE=2]="IMAGE";c[c.CSV=3]="CSV";c[c.SVG=4]="SVG";c[c.OBJ=5]="OBJ";c[c.PNG=6]="PNG";c[c.JPEG=7]="JPEG";c[c.MOV=8]="MOV";c[c.PDF=9]="PDF";c[c.LANGUAGE_LIBRARY=10]="LANGUAGE_LIBRARY";c[c.TEXTURES_LIBRARY=11]="TEXTURES_LIBRARY";c[c.FURNITURE_LIBRARY=12]="FURNITURE_LIBRARY";c[c.PLUGIN=13]="PLUGIN";c[c.PHOTOS_DIRECTORY=14]="PHOTOS_DIRECTORY";c[c.USER_DEFINED=15]="USER_DEFINED"})(b=a.ContentType||(a.ContentType={}))})(ContentManager||(ContentManager={}));var PlanView;(function(a){var b;(function(c){c[c.SELECTION=0]="SELECTION";c[c.PANNING=1]="PANNING";c[c.DRAW=2]="DRAW";c[c.ROTATION=3]="ROTATION";c[c.ELEVATION=4]="ELEVATION";c[c.HEIGHT=5]="HEIGHT";c[c.POWER=6]="POWER";c[c.RESIZE=7]="RESIZE";c[c.DUPLICATION=8]="DUPLICATION";c[c.MOVE=9]="MOVE"})(b=a.CursorType||(a.CursorType={}))})(PlanView||(PlanView={}));var TextureChoiceController=(function(){function a(v,k,j,l,s,q){if(((typeof v==="string")||v===null)&&((typeof k==="string")||k===null)&&((typeof j==="boolean")||j===null)&&((l!=null&&l instanceof UserPreferences)||l===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||s===null)&&((q!=null&&(q.constructor!=null&&q.constructor.__interfaces!=null&&q.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||q===null)){var h=arguments;if(this.title===undefined){this.title=null}if(this.fitAreaText===undefined){this.fitAreaText=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}this.title=v;this.fitAreaText=k;this.rotationSupported=j;this.preferences=l;this.viewFactory=s;this.contentManager=q;this.propertyChangeSupport=new PropertyChangeSupport(this)}else{if(((typeof v==="string")||v===null)&&((typeof k==="boolean")||k===null)&&((j!=null&&j instanceof UserPreferences)||j===null)&&((l!=null&&(l.constructor!=null&&l.constructor.__interfaces!=null&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||l===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||s===null)&&q===undefined){var h=arguments;var p=h[1];var c=h[2];var e=h[3];var n=h[4];var u=arguments;var g=null;if(this.title===undefined){this.title=null}if(this.fitAreaText===undefined){this.fitAreaText=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}this.title=v;this.fitAreaText=g;this.rotationSupported=p;this.preferences=c;this.viewFactory=e;this.contentManager=n;this.propertyChangeSupport=new PropertyChangeSupport(this);if(this.title===undefined){this.title=null}if(this.fitAreaText===undefined){this.fitAreaText=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}}else{if(((typeof v==="string")||v===null)&&((k!=null&&k instanceof UserPreferences)||k===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||j===null)&&((l!=null&&(l.constructor!=null&&l.constructor.__interfaces!=null&&l.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||l===null)&&s===undefined&&q===undefined){var h=arguments;var b=h[1];var d=h[2];var m=h[3];var t=arguments;var o=true;var r=arguments;var f=null;if(this.title===undefined){this.title=null}if(this.fitAreaText===undefined){this.fitAreaText=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}this.title=v;this.fitAreaText=f;this.rotationSupported=o;this.preferences=b;this.viewFactory=d;this.contentManager=m;this.propertyChangeSupport=new PropertyChangeSupport(this);if(this.title===undefined){this.title=null}if(this.fitAreaText===undefined){this.fitAreaText=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}if(this.title===undefined){this.title=null}if(this.fitAreaText===undefined){this.fitAreaText=null}if(this.rotationSupported===undefined){this.rotationSupported=false}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureChoiceView===undefined){this.textureChoiceView=null}if(this.texture===undefined){this.texture=null}}else{throw new Error("invalid overload")}}}}a.prototype.getView=function(){if(this.textureChoiceView==null){this.textureChoiceView=this.viewFactory.createTextureChoiceView(this.preferences,this)}return this.textureChoiceView};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setTexture=function(c){if(this.texture!==c&&(c==null||!c.equals(this.texture))){var b=this.texture;this.texture=c;this.propertyChangeSupport.firePropertyChange("TEXTURE",b,c)}};a.prototype.getTexture=function(){return this.texture};a.prototype.getDialogTitle=function(){return this.title};a.prototype.getFitAreaText=function(){return this.fitAreaText};a.prototype.isRotationSupported=function(){return this.rotationSupported};a.prototype.importTexture$=function(){new ImportedTextureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.importTexture$java_lang_String=function(b){new ImportedTextureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.importTexture=function(b){if(((typeof b==="string")||b===null)){return this.importTexture$java_lang_String(b)}else{if(b===undefined){return this.importTexture$()}else{throw new Error("invalid overload")}}};a.prototype.modifyTexture=function(b){new ImportedTextureWizardController(b,this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.deleteTexture=function(b){if(this.getView().confirmDeleteSelectedCatalogTexture()){this.preferences.getTexturesCatalog()["delete"](b)}};a.prototype.addRecentTexture=function(e){var d=(this.preferences.getRecentTextures().slice(0));for(var b=0;b<d.length;b++){var c=d[b];if((function(g,f){if(g&&g.equals){return g.equals(f)}else{return g===f}})(c.getImage(),e.getImage())){if(b===0){return}else{d.splice(b,1)[0];break}}}d.splice(0,0,e);while((d.length>a.MAX_RECENT_TEXTURES)){d.splice(d.length-1,1)[0]}this.preferences.setRecentTextures(d)};a.MAX_RECENT_TEXTURES=15;return a}());TextureChoiceController.__class="com.eteks.sweethome3d.viewcontroller.TextureChoiceController";TextureChoiceController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];var ExportableView;(function(b){var a=(function(){function c(d){if(this.__name===undefined){this.__name=null}this.__name=d}c.SVG_$LI$=function(){if(c.SVG==null){c.SVG=new b.FormatType("SVG")}return c.SVG};c.CSV_$LI$=function(){if(c.CSV==null){c.CSV=new b.FormatType("CSV")}return c.CSV};c.prototype.name=function(){return this.__name};c.prototype.toString=function(){return this.__name};return c}());b.FormatType=a;a.__class="com.eteks.sweethome3d.viewcontroller.ExportableView.FormatType"})(ExportableView||(ExportableView={}));var AbstractPhotoController=(function(){function a(e,b,f,d){if(this.home===undefined){this.home=null}if(this.view3D===undefined){this.view3D=null}if(this.contentManager===undefined){this.contentManager=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.aspectRatio===undefined){this.aspectRatio=null}if(this.width===undefined){this.width=0}if(this.height===undefined){this.height=0}if(this.quality===undefined){this.quality=0}if(this.view3DAspectRatio===undefined){this.view3DAspectRatio=0}if(this.ceilingLightColor===undefined){this.ceilingLightColor=0}this.home=e;this.view3D=f;this.contentManager=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.view3DAspectRatio=1;var c=new a.EnvironmentChangeListener(this);e.getEnvironment().addPropertyChangeListener("PHOTO_WIDTH",c);e.getEnvironment().addPropertyChangeListener("PHOTO_HEIGHT",c);e.getEnvironment().addPropertyChangeListener("PHOTO_ASPECT_RATIO",c);e.getEnvironment().addPropertyChangeListener("PHOTO_QUALITY",c);e.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",c);this.updateProperties()}a.prototype.getContentManager=function(){return this.contentManager};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getEnvironment();this.setAspectRatio(b.getPhotoAspectRatio());this.setWidth(b.getPhotoWidth(),false);this.setHeight(b.getPhotoHeight(),false);this.setQuality(b.getPhotoQuality());this.setCeilingLightColor(b.getCeillingLightColor())};a.prototype.setAspectRatio=function(b){if(this.aspectRatio!==b){var c=this.aspectRatio;this.aspectRatio=b;this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",c,b);this.home.getEnvironment().setPhotoAspectRatio(this.aspectRatio);if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO){if(this.view3DAspectRatio!==Infinity){this.setHeight(Math.round(this.width/this.view3DAspectRatio),false)}}else{if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]!=null){this.setHeight(Math.round(this.width/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}}};a.prototype.getAspectRatio=function(){return this.aspectRatio};a.prototype.setWidth=function(c,d){if(d===void 0){d=true}if(this.width!==c){var b=this.width;this.width=c;this.propertyChangeSupport.firePropertyChange("WIDTH",b,c);if(d){if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO){if(this.view3DAspectRatio!==Infinity){this.setHeight(Math.round(c/this.view3DAspectRatio),false)}}else{if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]!=null){this.setHeight(Math.round(c/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}}this.home.getEnvironment().setPhotoWidth(this.width)}};a.prototype.getWidth=function(){return this.width};a.prototype.setHeight=function(b,d){if(d===void 0){d=true}if(this.height!==b){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b);if(d){if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO){if(this.view3DAspectRatio!==Infinity){this.setWidth(Math.round(b*this.view3DAspectRatio),false)}}else{if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]!=null){this.setWidth(Math.round(b*{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.aspectRatio]),false)}}}this.home.getEnvironment().setPhotoHeight(this.height)}};a.prototype.getHeight=function(){return this.height};a.prototype.setQuality=function(c){if(this.quality!==c){var b=this.quality;this.quality=Math.min(c,this.getQualityLevelCount()-1);this.propertyChangeSupport.firePropertyChange("QUALITY",b,c);this.home.getEnvironment().setPhotoQuality(this.quality)}};a.prototype.getQuality=function(){return this.quality};a.prototype.getQualityLevelCount=function(){return 4};a.prototype.setCeilingLightColor=function(b){if(this.ceilingLightColor!==b){var c=this.ceilingLightColor;this.ceilingLightColor=b;this.propertyChangeSupport.firePropertyChange("CEILING_LIGHT_COLOR",c,b);this.home.getEnvironment().setCeillingLightColor(b)}};a.prototype.getCeilingLightColor=function(){return this.ceilingLightColor};a.prototype.set3DViewAspectRatio=function(c){if(this.view3DAspectRatio!==c){var b=this.view3DAspectRatio;this.view3DAspectRatio=c;this.propertyChangeSupport.firePropertyChange("ASPECT_RATIO",b,c);if(this.aspectRatio===AspectRatio.VIEW_3D_RATIO&&this.view3DAspectRatio!==Infinity){this.setHeight(Math.round(this.width/this.view3DAspectRatio),false)}}};a.prototype.get3DViewAspectRatio=function(){return this.view3DAspectRatio};a.prototype.get3DView=function(){return this.view3D};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};return a}());AbstractPhotoController.__class="com.eteks.sweethome3d.viewcontroller.AbstractPhotoController";AbstractPhotoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(){function c(d){if(this.photoController===undefined){this.photoController=null}this.photoController=(d)}c.prototype.propertyChange=function(e){var d=this.photoController;if(d==null){e.getSource().removePropertyChangeListener("PHOTO_WIDTH",this);e.getSource().removePropertyChangeListener("PHOTO_HEIGHT",this);e.getSource().removePropertyChangeListener("PHOTO_ASPECT_RATIO",this);e.getSource().removePropertyChangeListener("PHOTO_QUALITY",this);e.getSource().removePropertyChangeListener("CEILING_LIGHT_COLOR",this)}else{if("PHOTO_WIDTH"===e.getPropertyName()){d.setWidth(e.getNewValue(),false)}else{if("PHOTO_HEIGHT"===e.getPropertyName()){d.setHeight(e.getNewValue(),false)}else{if("PHOTO_ASPECT_RATIO"===e.getPropertyName()){d.setAspectRatio(e.getNewValue())}else{if("PHOTO_QUALITY"===e.getPropertyName()){d.setQuality(e.getNewValue())}else{if("CEILING_LIGHT_COLOR"===e.getPropertyName()){d.setCeilingLightColor(e.getNewValue())}}}}}}};return c}());b.EnvironmentChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.AbstractPhotoController.EnvironmentChangeListener"})(AbstractPhotoController||(AbstractPhotoController={}));var HomeXMLExporter=(function(b){__extends(a,b);function a(){var c=b.call(this)||this;if(c.savedContentNames===undefined){c.savedContentNames=null}c.levelIds=({});c.wallIds=({});return c}a.prototype.setSavedContentNames=function(c){this.savedContentNames=c};a.prototype.getId=function(c){if(c==null){return null}else{if(c!=null&&c instanceof Level){return(function(d,e){if(d.entries==null){d.entries=[]}for(var f=0;f<d.entries.length;f++){if(d.entries[f].key==null&&e==null||d.entries[f].key.equals!=null&&d.entries[f].key.equals(e)||d.entries[f].key===e){return d.entries[f].value}}return null})(this.levelIds,c)}else{if(c!=null&&c instanceof Wall){return(function(d,e){if(d.entries==null){d.entries=[]}for(var f=0;f<d.entries.length;f++){if(d.entries[f].key==null&&e==null||d.entries[f].key.equals!=null&&d.entries[f].key.equals(e)||d.entries[f].key===e){return d.entries[f].value}}return null})(this.wallIds,c)}else{throw new IllegalArgumentException("No Id provided for object of class "+(function(d){return typeof d==="string"?d:d.__class?d.__class:d.name})(c.constructor))}}}};a.prototype.writeElement$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home=function(e,f){var h=f.getLevels();for(var d=0;d<h.length;d++){var g=h[d];(function(j,n,l){if(j.entries==null){j.entries=[]}for(var o=0;o<j.entries.length;o++){if(j.entries[o].key==null&&n==null||j.entries[o].key.equals!=null&&j.entries[o].key.equals(n)||j.entries[o].key===n){j.entries[o].value=l;return}}j.entries.push({key:n,value:l,getKey:function(){return this.key},getValue:function(){return this.value}})})(this.levelIds,g,g.getId())}var h=f.getWalls();for(var d=0;d<h.length;d++){var c=h[d];(function(j,n,l){if(j.entries==null){j.entries=[]}for(var o=0;o<j.entries.length;o++){if(j.entries[o].key==null&&n==null||j.entries[o].key.equals!=null&&j.entries[o].key.equals(n)||j.entries[o].key===n){j.entries[o].value=l;return}}j.entries.push({key:n,value:l,getKey:function(){return this.key},getValue:function(){return this.value}})})(this.wallIds,c,c.getId())}b.prototype.writeElement.call(this,e,f)};a.prototype.writeElement=function(c,d){if(((c!=null&&c instanceof XMLWriter)||c===null)&&((d!=null&&d instanceof Home)||d===null)){return this.writeElement$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home(c,d)}else{if(((c!=null&&c instanceof XMLWriter)||c===null)&&((d!=null)||d===null)){b.prototype.writeElement.call(this,c,d)}else{throw new Error("invalid overload")}}};a.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home=function(c,d){d.setVersion(Home.CURRENT_VERSION);c.writeAttribute$java_lang_String$java_lang_String("version",String(d.getVersion()).toString());c.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",d.getName(),null);c.writeAttribute$java_lang_String$java_lang_String("camera",d.getCamera()===d.getObserverCamera()?"observerCamera":"topCamera");c.writeAttribute$java_lang_String$java_lang_String$java_lang_String("selectedLevel",this.getId(d.getSelectedLevel()),null);c.writeFloatAttribute$java_lang_String$float("wallHeight",d.getWallHeight());c.writeBooleanAttribute("basePlanLocked",d.isBasePlanLocked(),false);if(d.getFurnitureSortedPropertyName()!=null){c.writeAttribute$java_lang_String$java_lang_String("furnitureSortedProperty",d.getFurnitureSortedPropertyName())}c.writeBooleanAttribute("furnitureDescendingSorted",d.isFurnitureDescendingSorted(),false)};a.prototype.writeAttributes=function(c,d){if(((c!=null&&c instanceof XMLWriter)||c===null)&&((d!=null&&d instanceof Home)||d===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home(c,d)}else{if(((c!=null&&c instanceof XMLWriter)||c===null)&&((d!=null)||d===null)){b.prototype.writeAttributes.call(this,c,d)}else{throw new Error("invalid overload")}}};a.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home=function(e,k){var p=(k.getPropertyNames().slice(0));p.sort();for(var f=0;f<p.length;f++){var g=p[f];this.writeProperty(e,k,g,k.getProperty(g),false)}var h=k.getFurnitureVisiblePropertyNames();for(var f=0;f<h.length;f++){var q=h[f];e.writeStartElement("furnitureVisibleProperty");e.writeAttribute$java_lang_String$java_lang_String("name",q);e.writeEndElement()}this.writeEnvironment(e,k.getEnvironment());this.writeBackgroundImage(e,k.getBackgroundImage());this.writePrint(e,k.getPrint());this.writeCompass(e,k.getCompass());this.writeCamera(e,k.getObserverCamera(),"observerCamera");this.writeCamera(e,k.getTopCamera(),"topCamera");var h=k.getStoredCameras();for(var f=0;f<h.length;f++){var j=h[f];this.writeCamera(e,j,"storedCamera")}var h=k.getLevels();for(var f=0;f<h.length;f++){var d=h[f];this.writeLevel(e,d)}var h=k.getFurniture();for(var f=0;f<h.length;f++){var r=h[f];this.writePieceOfFurniture(e,r)}var h=k.getWalls();for(var f=0;f<h.length;f++){var n=h[f];this.writeWall(e,n)}var h=k.getRooms();for(var f=0;f<h.length;f++){var c=h[f];this.writeRoom(e,c)}var h=k.getPolylines();for(var f=0;f<h.length;f++){var m=h[f];this.writePolyline(e,m)}var h=k.getDimensionLines();for(var f=0;f<h.length;f++){var o=h[f];this.writeDimensionLine(e,o)}var h=k.getLabels();for(var f=0;f<h.length;f++){var l=h[f];this.writeLabel(e,l)}};a.prototype.writeChildren=function(c,d){if(((c!=null&&c instanceof XMLWriter)||c===null)&&((d!=null&&d instanceof Home)||d===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Home(c,d)}else{if(((c!=null&&c instanceof XMLWriter)||c===null)&&((d!=null)||d===null)){b.prototype.writeChildren.call(this,c,d)}else{throw new Error("invalid overload")}}};a.prototype.writeEnvironment=function(d,c){new a.HomeXMLExporter$0(this).writeElement(d,c)};a.prototype.writeBackgroundImage=function(c,d){if(d!=null){new a.HomeXMLExporter$1(this).writeElement(c,d)}};a.prototype.writePrint=function(d,c){if(c!=null){new a.HomeXMLExporter$2(this).writeElement(d,c)}};a.prototype.writeCompass=function(d,c){new a.HomeXMLExporter$3(this).writeElement(d,c)};a.prototype.writeCamera=function(e,d,c){if(d!=null){new a.HomeXMLExporter$4(this,c).writeElement(e,d)}};a.prototype.writeLevel=function(c,d){new a.HomeXMLExporter$5(this).writeElement(c,d)};a.prototype.writePieceOfFurniture=function(d,c){new a.PieceOfFurnitureExporter(this).writeElement(d,c)};a.prototype.writeMaterial=function(e,d,c){if(d!=null){new a.HomeXMLExporter$6(this).writeElement(e,d)}};a.prototype.writeWall=function(d,c){new a.HomeXMLExporter$7(this).writeElement(d,c)};a.prototype.writeRoom=function(c,d){new a.HomeXMLExporter$8(this).writeElement(c,d)};a.prototype.writePolyline=function(d,c){new a.HomeXMLExporter$9(this).writeElement(d,c)};a.prototype.writeDimensionLine=function(d,c){new a.HomeXMLExporter$10(this).writeElement(d,c)};a.prototype.writeLabel=function(d,c){new a.HomeXMLExporter$11(this).writeElement(d,c)};a.prototype.writeTextStyle=function(d,e,c){if(e!=null){new a.HomeXMLExporter$12(this,c).writeElement(d,e)}};a.prototype.writeBaseboard=function(e,d,c){if(d!=null){new a.HomeXMLExporter$13(this,c).writeElement(e,d)}};a.prototype.writeTexture=function(e,d,c){if(d!=null){new a.HomeXMLExporter$14(this,c).writeElement(e,d)}};a.prototype.writeProperties=function(h,e){var g=(e.getPropertyNames().slice(0));g.sort();for(var d=0;d<g.length;d++){var c=g[d];var f=e.isContentProperty(c);this.writeProperty(h,e,c,f?e.getContentProperty(c):e.getProperty(c),f)}};a.prototype.writeProperty=function(g,e,d,c,f){if(c!=null){g.writeStartElement("property");g.writeAttribute$java_lang_String$java_lang_String("name",d);g.writeAttribute$java_lang_String$java_lang_String("value",f?this.getExportedContentName(e,c):c.toString());if(f){g.writeAttribute$java_lang_String$java_lang_String("type",ObjectProperty.Type[ObjectProperty.Type.CONTENT])}g.writeEndElement()}};a.floatToString=function(c){if(Math.abs(c)<0.000001){return"0"}else{if(Math.abs(c-1)<0.000001){return"1"}else{if(Math.abs(c+1)<0.000001){return"-1"}else{return String(c).toString()}}}};a.prototype.getExportedContentName=function(c,d){if(d==null){return null}else{if(this.savedContentNames!=null){var e=this.savedContentNames[d.getURL()];if(e!=null){return e}}}return d.getURL()};return a}(ObjectXMLExporter));HomeXMLExporter.__class="com.eteks.sweethome3d.io.HomeXMLExporter";(function(k){var h=(function(t){__extends(s,t);function s(u){var v=t.call(this)||this;v.__parent=u;return v}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(w,C){w.writeAttribute$java_lang_String$java_lang_String("id",C.getId());if(C.getLevel()!=null){w.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(C.getLevel()))}w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("catalogId",C.getCatalogId(),null);w.writeAttribute$java_lang_String$java_lang_String("name",C.getName());w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("creator",C.getCreator(),null);w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("model",this.__parent.getExportedContentName(C,C.getModel()),null);w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("icon",this.__parent.getExportedContentName(C,C.getIcon()),null);w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("planIcon",this.__parent.getExportedContentName(C,C.getPlanIcon()),null);w.writeFloatAttribute$java_lang_String$float("x",C.getX());w.writeFloatAttribute$java_lang_String$float("y",C.getY());w.writeFloatAttribute$java_lang_String$float$float("elevation",C.getElevation(),0);w.writeFloatAttribute$java_lang_String$float$float("angle",C.getAngle(),0);w.writeFloatAttribute$java_lang_String$float$float("pitch",C.getPitch(),0);w.writeFloatAttribute$java_lang_String$float$float("roll",C.getRoll(),0);w.writeFloatAttribute$java_lang_String$float("width",C.getWidth());w.writeFloatAttribute$java_lang_String$float$float("widthInPlan",C.getWidthInPlan(),C.getWidth());w.writeFloatAttribute$java_lang_String$float("depth",C.getDepth());w.writeFloatAttribute$java_lang_String$float$float("depthInPlan",C.getDepthInPlan(),C.getDepth());w.writeFloatAttribute$java_lang_String$float("height",C.getHeight());w.writeFloatAttribute$java_lang_String$float$float("heightInPlan",C.getHeightInPlan(),C.getHeight());w.writeIntegerAttribute$java_lang_String$int$int("modelFlags",C.getModelFlags(),0);w.writeBooleanAttribute("modelMirrored",C.isModelMirrored(),false);w.writeBooleanAttribute("visible",C.isVisible(),true);w.writeColorAttribute("color",C.getColor());if(C.getShininess()!=null){w.writeFloatAttribute$java_lang_String$java_lang_Float("shininess",C.getShininess())}var u=C.getModelRotation();var A=k.floatToString(u[0][0])+" "+k.floatToString(u[0][1])+" "+k.floatToString(u[0][2])+" "+k.floatToString(u[1][0])+" "+k.floatToString(u[1][1])+" "+k.floatToString(u[1][2])+" "+k.floatToString(u[2][0])+" "+k.floatToString(u[2][1])+" "+k.floatToString(u[2][2]);w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("modelRotation",A,"1 0 0 0 1 0 0 0 1");w.writeBooleanAttribute("modelCenteredAtOrigin",C.isModelCenteredAtOrigin(),true);w.writeLongAttribute$java_lang_String$java_lang_Long("modelSize",C.getModelSize());w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("description",C.getDescription(),null);w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("information",C.getInformation(),null);w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("license",C.getLicense(),null);w.writeBooleanAttribute("movable",C.isMovable(),true);if(!(C!=null&&C instanceof HomeFurnitureGroup)){if(!(C!=null&&C instanceof HomeDoorOrWindow)){w.writeBooleanAttribute("doorOrWindow",C.isDoorOrWindow(),false);w.writeBooleanAttribute("horizontallyRotatable",C.isHorizontallyRotatable(),true)}w.writeBooleanAttribute("resizable",C.isResizable(),true);w.writeBooleanAttribute("deformable",C.isDeformable(),true);w.writeBooleanAttribute("texturable",C.isTexturable(),true)}if(C!=null&&C instanceof HomeFurnitureGroup){var x=C.getPrice();var z=C.getFurniture();for(var y=0;y<z.length;y++){var v=z[y];if(v.getPrice()!=null){x=null;break}}w.writeBigDecimalAttribute("price",x)}else{w.writeBigDecimalAttribute("price",C.getPrice());w.writeBigDecimalAttribute("valueAddedTaxPercentage",C.getValueAddedTaxPercentage());w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("currency",C.getCurrency(),null)}w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("staircaseCutOutShape",C.getStaircaseCutOutShape(),null);w.writeFloatAttribute$java_lang_String$float$float("dropOnTopElevation",C.getDropOnTopElevation(),1);w.writeBooleanAttribute("nameVisible",C.isNameVisible(),false);w.writeFloatAttribute$java_lang_String$float$float("nameAngle",C.getNameAngle(),0);w.writeFloatAttribute$java_lang_String$float$float("nameXOffset",C.getNameXOffset(),0);w.writeFloatAttribute$java_lang_String$float$float("nameYOffset",C.getNameYOffset(),0);if(C!=null&&C instanceof HomeDoorOrWindow){var B=C;w.writeFloatAttribute$java_lang_String$float$float("wallThickness",B.getWallThickness(),1);w.writeFloatAttribute$java_lang_String$float$float("wallDistance",B.getWallDistance(),0);w.writeFloatAttribute$java_lang_String$float$float("wallWidth",B.getWallWidth(),1);w.writeFloatAttribute$java_lang_String$float$float("wallLeft",B.getWallLeft(),0);w.writeFloatAttribute$java_lang_String$float$float("wallHeight",B.getWallHeight(),1);w.writeFloatAttribute$java_lang_String$float$float("wallTop",B.getWallTop(),0);w.writeAttribute$java_lang_String$java_lang_String$java_lang_String("cutOutShape",B.getCutOutShape(),null);w.writeBooleanAttribute("wallCutOutOnBothSides",B.isWallCutOutOnBothSides(),false);w.writeBooleanAttribute("widthDepthDeformable",B.isWidthDepthDeformable(),true);w.writeBooleanAttribute("boundToWall",B.isBoundToWall(),true)}else{if(C!=null&&C instanceof HomeLight){w.writeFloatAttribute$java_lang_String$float("power",C.getPower())}}};s.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomePieceOfFurniture)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};s.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,J){if(J!=null&&J instanceof HomeFurnitureGroup){var C=J.getFurniture();for(var A=0;A<C.length;A++){var w=C[A];this.__parent.writePieceOfFurniture(x,w)}}else{if(J!=null&&J instanceof HomeLight){var C=J.getLightSources();for(var A=0;A<C.length;A++){var H=C[A];x.writeStartElement("lightSource");x.writeFloatAttribute$java_lang_String$float("x",H.getX());x.writeFloatAttribute$java_lang_String$float("y",H.getY());x.writeFloatAttribute$java_lang_String$float("z",H.getZ());x.writeColorAttribute("color",H.getColor());x.writeFloatAttribute$java_lang_String$java_lang_Float("diameter",H.getDiameter());x.writeEndElement()}var C=J.getLightSourceMaterialNames();for(var A=0;A<C.length;A++){var u=C[A];x.writeStartElement("lightSourceMaterial");x.writeAttribute$java_lang_String$java_lang_String("name",u);x.writeEndElement()}}else{if(J!=null&&J instanceof HomeDoorOrWindow){var C=J.getSashes();for(var A=0;A<C.length;A++){var z=C[A];x.writeStartElement("sash");x.writeFloatAttribute$java_lang_String$float("xAxis",z.getXAxis());x.writeFloatAttribute$java_lang_String$float("yAxis",z.getYAxis());x.writeFloatAttribute$java_lang_String$float("width",z.getWidth());x.writeFloatAttribute$java_lang_String$float("startAngle",z.getStartAngle());x.writeFloatAttribute$java_lang_String$float("endAngle",z.getEndAngle());x.writeEndElement()}}else{if(J!=null&&J instanceof HomeShelfUnit){var G=J;var F=G.getShelfElevations();if(F!=null){for(var y=0;y<F.length;y++){x.writeStartElement("shelf");x.writeFloatAttribute$java_lang_String$float("elevation",F[y]);x.writeEndElement()}}var v=G.getShelfBoxes();if(v!=null){for(var y=0;y<v.length;y++){x.writeStartElement("shelf");x.writeFloatAttribute$java_lang_String$float("xLower",v[y].getXLower());x.writeFloatAttribute$java_lang_String$float("yLower",v[y].getYLower());x.writeFloatAttribute$java_lang_String$float("zLower",v[y].getZLower());x.writeFloatAttribute$java_lang_String$float("xUpper",v[y].getXUpper());x.writeFloatAttribute$java_lang_String$float("yUpper",v[y].getYUpper());x.writeFloatAttribute$java_lang_String$float("zUpper",v[y].getZUpper());x.writeEndElement()}}}}}}this.__parent.writeProperties(x,J);this.__parent.writeTextStyle(x,J.getNameStyle(),"nameStyle");this.__parent.writeTexture(x,J.getTexture(),null);if(J.getModelMaterials()!=null){var C=J.getModelMaterials();for(var A=0;A<C.length;A++){var B=C[A];this.__parent.writeMaterial(x,B,J.getModel())}}if(J.getModelTransformations()!=null){var C=J.getModelTransformations();for(var A=0;A<C.length;A++){var D=C[A];x.writeStartElement("transformation");x.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",D.getName(),null);var E=D.getMatrix();var I=k.floatToString(E[0][0])+" "+k.floatToString(E[0][1])+" "+k.floatToString(E[0][2])+" "+k.floatToString(E[0][3])+" "+k.floatToString(E[1][0])+" "+k.floatToString(E[1][1])+" "+k.floatToString(E[1][2])+" "+k.floatToString(E[1][3])+" "+k.floatToString(E[2][0])+" "+k.floatToString(E[2][1])+" "+k.floatToString(E[2][2])+" "+k.floatToString(E[2][3]);x.writeAttribute$java_lang_String$java_lang_String("matrix",I);x.writeEndElement()}}};s.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomePieceOfFurniture)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePieceOfFurniture(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.PieceOfFurnitureExporter=h;h.__class="com.eteks.sweethome3d.io.HomeXMLExporter.PieceOfFurnitureExporter";var g=(function(s){__extends(t,s);function t(u){var v=s.call(this)||this;v.__parent=u;return v}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment=function(v,u){v.writeColorAttribute("groundColor",u.getGroundColor());v.writeBooleanAttribute("backgroundImageVisibleOnGround3D",u.isBackgroundImageVisibleOnGround3D(),false);v.writeColorAttribute("skyColor",u.getSkyColor());v.writeColorAttribute("lightColor",u.getLightColor());v.writeFloatAttribute$java_lang_String$float$float("wallsAlpha",u.getWallsAlpha(),0);v.writeBooleanAttribute("allLevelsVisible",u.isAllLevelsVisible(),false);v.writeBooleanAttribute("observerCameraElevationAdjusted",u.isObserverCameraElevationAdjusted(),true);v.writeColorAttribute("ceillingLightColor",u.getCeillingLightColor());v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("drawingMode",HomeEnvironment.DrawingMode[u.getDrawingMode()],HomeEnvironment.DrawingMode[HomeEnvironment.DrawingMode.FILL]);v.writeFloatAttribute$java_lang_String$float$float("subpartSizeUnderLight",u.getSubpartSizeUnderLight(),0);v.writeIntegerAttribute$java_lang_String$int("photoWidth",u.getPhotoWidth());v.writeIntegerAttribute$java_lang_String$int("photoHeight",u.getPhotoHeight());v.writeAttribute$java_lang_String$java_lang_String("photoAspectRatio",AspectRatio[u.getPhotoAspectRatio()]);v.writeIntegerAttribute$java_lang_String$int("photoQuality",u.getPhotoQuality());v.writeIntegerAttribute$java_lang_String$int("videoWidth",u.getVideoWidth());v.writeAttribute$java_lang_String$java_lang_String("videoAspectRatio",AspectRatio[u.getVideoAspectRatio()]);v.writeIntegerAttribute$java_lang_String$int("videoQuality",u.getVideoQuality());v.writeFloatAttribute$java_lang_String$float$float("videoSpeed",u.getVideoSpeed(),2400/3600);v.writeIntegerAttribute$java_lang_String$int("videoFrameRate",u.getVideoFrameRate())};t.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomeEnvironment)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment=function(x,u){this.__parent.writeProperties(x,u);if(!(u.getVideoCameraPath().length==0)){var y=u.getVideoCameraPath();for(var v=0;v<y.length;v++){var w=y[v];this.__parent.writeCamera(x,w,"cameraPath")}}this.__parent.writeTexture(x,u.getGroundTexture(),"groundTexture");this.__parent.writeTexture(x,u.getSkyTexture(),"skyTexture")};t.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomeEnvironment)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeEnvironment(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$0=g;var f=(function(s){__extends(t,s);function t(u){var v=s.call(this)||this;v.__parent=u;return v}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_BackgroundImage=function(u,v){u.writeAttribute$java_lang_String$java_lang_String$java_lang_String("image",this.__parent.getExportedContentName(v,v.getImage()),null);u.writeFloatAttribute$java_lang_String$float("scaleDistance",v.getScaleDistance());u.writeFloatAttribute$java_lang_String$float("scaleDistanceXStart",v.getScaleDistanceXStart());u.writeFloatAttribute$java_lang_String$float("scaleDistanceYStart",v.getScaleDistanceYStart());u.writeFloatAttribute$java_lang_String$float("scaleDistanceXEnd",v.getScaleDistanceXEnd());u.writeFloatAttribute$java_lang_String$float("scaleDistanceYEnd",v.getScaleDistanceYEnd());u.writeFloatAttribute$java_lang_String$float$float("xOrigin",v.getXOrigin(),0);u.writeFloatAttribute$java_lang_String$float$float("yOrigin",v.getYOrigin(),0);u.writeBooleanAttribute("visible",v.isVisible(),true)};t.prototype.writeAttributes=function(u,v){if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null&&v instanceof BackgroundImage)||v===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_BackgroundImage(u,v)}else{if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null)||v===null)){s.prototype.writeAttributes.call(this,u,v)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$1=f;var e=(function(s){__extends(t,s);function t(u){var v=s.call(this)||this;v.__parent=u;return v}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint=function(v,u){v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("headerFormat",u.getHeaderFormat(),null);v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("footerFormat",u.getFooterFormat(),null);v.writeBooleanAttribute("furniturePrinted",u.isFurniturePrinted(),true);v.writeBooleanAttribute("planPrinted",u.isPlanPrinted(),true);v.writeBooleanAttribute("view3DPrinted",u.isView3DPrinted(),true);v.writeFloatAttribute$java_lang_String$java_lang_Float("planScale",u.getPlanScale());v.writeFloatAttribute$java_lang_String$float("paperWidth",u.getPaperWidth());v.writeFloatAttribute$java_lang_String$float("paperHeight",u.getPaperHeight());v.writeFloatAttribute$java_lang_String$float("paperTopMargin",u.getPaperTopMargin());v.writeFloatAttribute$java_lang_String$float("paperLeftMargin",u.getPaperLeftMargin());v.writeFloatAttribute$java_lang_String$float("paperBottomMargin",u.getPaperBottomMargin());v.writeFloatAttribute$java_lang_String$float("paperRightMargin",u.getPaperRightMargin());v.writeAttribute$java_lang_String$java_lang_String("paperOrientation",HomePrint.PaperOrientation[u.getPaperOrientation()])};t.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomePrint)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint=function(x,u){var w=u.getPrintedLevels();if(w!=null){for(var v=0;v<w.length;v++){var y=w[v];x.writeStartElement("printedLevel");x.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(y));x.writeEndElement()}}};t.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomePrint)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomePrint(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$2=e;var d=(function(s){__extends(t,s);function t(u){var v=s.call(this)||this;v.__parent=u;return v}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass=function(v,u){v.writeFloatAttribute$java_lang_String$float("x",u.getX());v.writeFloatAttribute$java_lang_String$float("y",u.getY());v.writeFloatAttribute$java_lang_String$float("diameter",u.getDiameter());v.writeFloatAttribute$java_lang_String$float("northDirection",u.getNorthDirection());v.writeFloatAttribute$java_lang_String$float("longitude",u.getLongitude());v.writeFloatAttribute$java_lang_String$float("latitude",u.getLatitude());v.writeAttribute$java_lang_String$java_lang_String("timeZone",u.getTimeZone());v.writeBooleanAttribute("visible",u.isVisible(),true)};t.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Compass)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass=function(v,u){this.__parent.writeProperties(v,u)};t.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Compass)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Compass(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$3=d;var c=(function(t){__extends(s,t);function s(v,u){var w=t.call(this)||this;w.attributeName=u;w.__parent=v;return w}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera=function(v,u){v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null);if(!("observerCamera"===this.attributeName)&&!("topCamera"===this.attributeName)){v.writeAttribute$java_lang_String$java_lang_String("id",u.getId())}v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",u.getName(),null);v.writeAttribute$java_lang_String$java_lang_String("lens",Camera.Lens[u.getLens()]);v.writeFloatAttribute$java_lang_String$float("x",u.getX());v.writeFloatAttribute$java_lang_String$float("y",u.getY());v.writeFloatAttribute$java_lang_String$float("z",u.getZ());v.writeFloatAttribute$java_lang_String$float("yaw",u.getYaw());v.writeFloatAttribute$java_lang_String$float("pitch",u.getPitch());v.writeFloatAttribute$java_lang_String$float("fieldOfView",u.getFieldOfView());v.writeLongAttribute$java_lang_String$long("time",u.getTime());if(u!=null&&u instanceof ObserverCamera){v.writeBooleanAttribute("fixedSize",u.isFixedSize(),false)}v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("renderer",u.getRenderer(),null)};s.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Camera)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};s.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera=function(v,u){this.__parent.writeProperties(v,u)};s.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Camera)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Camera(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.HomeXMLExporter$4=c;var b=(function(t){__extends(s,t);function s(u){var v=t.call(this)||this;v.__parent=u;return v}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level=function(u,v){u.writeAttribute$java_lang_String$java_lang_String("id",v.getId());u.writeAttribute$java_lang_String$java_lang_String("name",v.getName());u.writeFloatAttribute$java_lang_String$float("elevation",v.getElevation());u.writeFloatAttribute$java_lang_String$float("floorThickness",v.getFloorThickness());u.writeFloatAttribute$java_lang_String$float("height",v.getHeight());u.writeIntegerAttribute$java_lang_String$int("elevationIndex",v.getElevationIndex());u.writeBooleanAttribute("visible",v.isVisible(),true);u.writeBooleanAttribute("viewable",v.isViewable(),true)};s.prototype.writeAttributes=function(u,v){if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null&&v instanceof Level)||v===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level(u,v)}else{if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null)||v===null)){t.prototype.writeAttributes.call(this,u,v)}else{throw new Error("invalid overload")}}};s.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level=function(u,v){this.__parent.writeProperties(u,v);this.__parent.writeBackgroundImage(u,v.getBackgroundImage())};s.prototype.writeChildren=function(u,v){if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null&&v instanceof Level)||v===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Level(u,v)}else{if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null)||v===null)){t.prototype.writeChildren.call(this,u,v)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.HomeXMLExporter$5=b;var a=(function(t){__extends(s,t);function s(u){var v=t.call(this)||this;v.__parent=u;return v}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial=function(v,u){v.writeAttribute$java_lang_String$java_lang_String("name",u.getName());v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("key",u.getKey(),null);v.writeColorAttribute("color",u.getColor());if(u.getShininess()!=null){v.writeFloatAttribute$java_lang_String$java_lang_Float("shininess",u.getShininess())}};s.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomeMaterial)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};s.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial=function(v,u){this.__parent.writeTexture(v,u.getTexture(),null)};s.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomeMaterial)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeMaterial(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.HomeXMLExporter$6=a;var r=(function(t){__extends(s,t);function s(u){var v=t.call(this)||this;v.__parent=u;return v}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall=function(v,u){v.writeAttribute$java_lang_String$java_lang_String("id",u.getId());if(u.getLevel()!=null){v.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(u.getLevel()))}if(u.getWallAtStart()!=null){var w=this.__parent.getId(u.getWallAtStart());if(w!=null){v.writeAttribute$java_lang_String$java_lang_String("wallAtStart",w)}}if(u.getWallAtEnd()!=null){var w=this.__parent.getId(u.getWallAtEnd());if(w!=null){v.writeAttribute$java_lang_String$java_lang_String("wallAtEnd",w)}}v.writeFloatAttribute$java_lang_String$float("xStart",u.getXStart());v.writeFloatAttribute$java_lang_String$float("yStart",u.getYStart());v.writeFloatAttribute$java_lang_String$float("xEnd",u.getXEnd());v.writeFloatAttribute$java_lang_String$float("yEnd",u.getYEnd());v.writeFloatAttribute$java_lang_String$java_lang_Float("height",u.getHeight());v.writeFloatAttribute$java_lang_String$java_lang_Float("heightAtEnd",u.getHeightAtEnd());v.writeFloatAttribute$java_lang_String$float("thickness",u.getThickness());v.writeFloatAttribute$java_lang_String$java_lang_Float("arcExtent",u.getArcExtent());if(u.getPattern()!=null){v.writeAttribute$java_lang_String$java_lang_String("pattern",u.getPattern().getName())}v.writeColorAttribute("topColor",u.getTopColor());v.writeColorAttribute("leftSideColor",u.getLeftSideColor());v.writeFloatAttribute$java_lang_String$float$float("leftSideShininess",u.getLeftSideShininess(),0);v.writeColorAttribute("rightSideColor",u.getRightSideColor());v.writeFloatAttribute$java_lang_String$float$float("rightSideShininess",u.getRightSideShininess(),0)};s.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Wall)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};s.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall=function(v,u){this.__parent.writeProperties(v,u);this.__parent.writeTexture(v,u.getLeftSideTexture(),"leftSideTexture");this.__parent.writeTexture(v,u.getRightSideTexture(),"rightSideTexture");this.__parent.writeBaseboard(v,u.getLeftSideBaseboard(),"leftSideBaseboard");this.__parent.writeBaseboard(v,u.getRightSideBaseboard(),"rightSideBaseboard")};s.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Wall)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Wall(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.HomeXMLExporter$7=r;var p=(function(t){__extends(s,t);function s(u){var v=t.call(this)||this;v.__parent=u;return v}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room=function(u,v){u.writeAttribute$java_lang_String$java_lang_String("id",v.getId());if(v.getLevel()!=null){u.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(v.getLevel()))}u.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",v.getName(),null);u.writeFloatAttribute$java_lang_String$float$float("nameAngle",v.getNameAngle(),0);u.writeFloatAttribute$java_lang_String$float$float("nameXOffset",v.getNameXOffset(),0);u.writeFloatAttribute$java_lang_String$float$float("nameYOffset",v.getNameYOffset(),-40);u.writeBooleanAttribute("areaVisible",v.isAreaVisible(),false);u.writeFloatAttribute$java_lang_String$float$float("areaAngle",v.getAreaAngle(),0);u.writeFloatAttribute$java_lang_String$float$float("areaXOffset",v.getAreaXOffset(),0);u.writeFloatAttribute$java_lang_String$float$float("areaYOffset",v.getAreaYOffset(),0);u.writeBooleanAttribute("floorVisible",v.isFloorVisible(),true);u.writeColorAttribute("floorColor",v.getFloorColor());u.writeFloatAttribute$java_lang_String$float$float("floorShininess",v.getFloorShininess(),0);u.writeBooleanAttribute("ceilingVisible",v.isCeilingVisible(),true);u.writeColorAttribute("ceilingColor",v.getCeilingColor());u.writeFloatAttribute$java_lang_String$float$float("ceilingShininess",v.getCeilingShininess(),0);u.writeBooleanAttribute("ceilingFlat",v.isCeilingFlat(),false)};s.prototype.writeAttributes=function(u,v){if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null&&v instanceof Room)||v===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room(u,v)}else{if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null)||v===null)){t.prototype.writeAttributes.call(this,u,v)}else{throw new Error("invalid overload")}}};s.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room=function(w,x){this.__parent.writeProperties(w,x);this.__parent.writeTextStyle(w,x.getNameStyle(),"nameStyle");this.__parent.writeTextStyle(w,x.getAreaStyle(),"areaStyle");this.__parent.writeTexture(w,x.getFloorTexture(),"floorTexture");this.__parent.writeTexture(w,x.getCeilingTexture(),"ceilingTexture");var y=x.getPoints();for(var v=0;v<y.length;v++){var u=y[v];w.writeStartElement("point");w.writeFloatAttribute$java_lang_String$float("x",u[0]);w.writeFloatAttribute$java_lang_String$float("y",u[1]);w.writeEndElement()}};s.prototype.writeChildren=function(u,v){if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null&&v instanceof Room)||v===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Room(u,v)}else{if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null)||v===null)){t.prototype.writeChildren.call(this,u,v)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.HomeXMLExporter$8=p;var n=(function(t){__extends(s,t);function s(u){var v=t.call(this)||this;v.__parent=u;return v}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline=function(x,v){x.writeAttribute$java_lang_String$java_lang_String("id",v.getId());if(v.getLevel()!=null){x.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(v.getLevel()))}x.writeFloatAttribute$java_lang_String$float$float("thickness",v.getThickness(),1);x.writeAttribute$java_lang_String$java_lang_String$java_lang_String("capStyle",Polyline.CapStyle[v.getCapStyle()],Polyline.CapStyle[Polyline.CapStyle.BUTT]);x.writeAttribute$java_lang_String$java_lang_String$java_lang_String("joinStyle",Polyline.JoinStyle[v.getJoinStyle()],Polyline.JoinStyle[Polyline.JoinStyle.MITER]);x.writeAttribute$java_lang_String$java_lang_String$java_lang_String("dashStyle",Polyline.DashStyle[v.getDashStyle()],Polyline.DashStyle[Polyline.DashStyle.SOLID]);if(v.getDashStyle()===Polyline.DashStyle.CUSTOMIZED){var u={str:"",toString:function(){return this.str}};var z=v.getDashPattern();var y=function(A){var B=z[A];(function(C){C.str+=k.floatToString(B);return C})(u);(function(C){C.str+=" ";return C})(u)};for(var w=0;w<z.length;w++){y(w)}(function(B,A){return B.str=B.str.substring(0,A)})(u,u.str.length-1);x.writeAttribute$java_lang_String$java_lang_String("dashPattern",u.str)}x.writeFloatAttribute$java_lang_String$float$float("dashOffset",v.getDashOffset(),0);x.writeAttribute$java_lang_String$java_lang_String$java_lang_String("startArrowStyle",Polyline.ArrowStyle[v.getStartArrowStyle()],Polyline.ArrowStyle[Polyline.ArrowStyle.NONE]);x.writeAttribute$java_lang_String$java_lang_String$java_lang_String("endArrowStyle",Polyline.ArrowStyle[v.getEndArrowStyle()],Polyline.ArrowStyle[Polyline.ArrowStyle.NONE]);if(v.isVisibleIn3D()){x.writeFloatAttribute$java_lang_String$float("elevation",v.getElevation())}x.writeColorAttribute("color",v.getColor());x.writeBooleanAttribute("closedPath",v.isClosedPath(),false)};s.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Polyline)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};s.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline=function(x,v){this.__parent.writeProperties(x,v);var y=v.getPoints();for(var w=0;w<y.length;w++){var u=y[w];x.writeStartElement("point");x.writeFloatAttribute$java_lang_String$float("x",u[0]);x.writeFloatAttribute$java_lang_String$float("y",u[1]);x.writeEndElement()}};s.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Polyline)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Polyline(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.HomeXMLExporter$9=n;var q=(function(s){__extends(t,s);function t(u){var v=s.call(this)||this;v.__parent=u;return v}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine=function(v,u){v.writeAttribute$java_lang_String$java_lang_String("id",u.getId());if(u.getLevel()!=null){v.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(u.getLevel()))}v.writeFloatAttribute$java_lang_String$float("xStart",u.getXStart());v.writeFloatAttribute$java_lang_String$float("yStart",u.getYStart());v.writeFloatAttribute$java_lang_String$float$float("elevationStart",u.getElevationStart(),0);v.writeFloatAttribute$java_lang_String$float("xEnd",u.getXEnd());v.writeFloatAttribute$java_lang_String$float("yEnd",u.getYEnd());v.writeFloatAttribute$java_lang_String$float$float("elevationEnd",u.getElevationEnd(),0);v.writeFloatAttribute$java_lang_String$float("offset",u.getOffset());v.writeFloatAttribute$java_lang_String$float$float("endMarkSize",u.getEndMarkSize(),10);v.writeFloatAttribute$java_lang_String$float$float("pitch",u.getPitch(),0);v.writeColorAttribute("color",u.getColor());v.writeBooleanAttribute("visibleIn3D",u.isVisibleIn3D(),false)};t.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof DimensionLine)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine=function(v,u){this.__parent.writeProperties(v,u);this.__parent.writeTextStyle(v,u.getLengthStyle(),"lengthStyle")};t.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof DimensionLine)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_DimensionLine(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$10=q;var o=(function(s){__extends(t,s);function t(u){var v=s.call(this)||this;v.__parent=u;return v}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label=function(v,u){v.writeAttribute$java_lang_String$java_lang_String("id",u.getId());if(u.getLevel()!=null){v.writeAttribute$java_lang_String$java_lang_String("level",this.__parent.getId(u.getLevel()))}v.writeFloatAttribute$java_lang_String$float("x",u.getX());v.writeFloatAttribute$java_lang_String$float("y",u.getY());v.writeFloatAttribute$java_lang_String$float$float("angle",u.getAngle(),0);v.writeFloatAttribute$java_lang_String$float$float("elevation",u.getElevation(),0);v.writeFloatAttribute$java_lang_String$java_lang_Float("pitch",u.getPitch());v.writeColorAttribute("color",u.getColor());v.writeColorAttribute("outlineColor",u.getOutlineColor())};t.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Label)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label=function(v,u){this.__parent.writeProperties(v,u);this.__parent.writeTextStyle(v,u.getStyle(),null);v.writeStartElement("text");v.writeText(u.getText());v.writeEndElement()};t.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Label)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Label(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$11=o;var m=(function(s){__extends(t,s);function t(v,u){var w=s.call(this)||this;w.attributeName=u;w.__parent=v;return w}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_TextStyle=function(u,v){u.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null);u.writeAttribute$java_lang_String$java_lang_String$java_lang_String("fontName",v.getFontName(),null);u.writeFloatAttribute$java_lang_String$float("fontSize",v.getFontSize());u.writeBooleanAttribute("bold",v.isBold(),false);u.writeBooleanAttribute("italic",v.isItalic(),false);u.writeAttribute$java_lang_String$java_lang_String$java_lang_String("alignment",TextStyle.Alignment[v.getAlignment()],TextStyle.Alignment[TextStyle.Alignment.CENTER])};t.prototype.writeAttributes=function(u,v){if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null&&v instanceof TextStyle)||v===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_TextStyle(u,v)}else{if(((u!=null&&u instanceof XMLWriter)||u===null)&&((v!=null)||v===null)){s.prototype.writeAttributes.call(this,u,v)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$12=m;var l=(function(s){__extends(t,s);function t(v,u){var w=s.call(this)||this;w.attributeName=u;w.__parent=v;return w}t.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard=function(v,u){v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null);v.writeFloatAttribute$java_lang_String$float("thickness",u.getThickness());v.writeFloatAttribute$java_lang_String$float("height",u.getHeight());v.writeColorAttribute("color",u.getColor())};t.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Baseboard)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};t.prototype.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard=function(v,u){this.__parent.writeTexture(v,u.getTexture(),null)};t.prototype.writeChildren=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof Baseboard)||u===null)){return this.writeChildren$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_Baseboard(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){s.prototype.writeChildren.call(this,v,u)}else{throw new Error("invalid overload")}}};return t}(ObjectXMLExporter));k.HomeXMLExporter$13=l;var j=(function(t){__extends(s,t);function s(v,u){var w=t.call(this)||this;w.attributeName=u;w.__parent=v;return w}s.prototype.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeTexture=function(v,u){v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("attribute",this.attributeName,null);v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("name",u.getName(),null);v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("creator",u.getCreator(),null);v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("catalogId",u.getCatalogId(),null);v.writeFloatAttribute$java_lang_String$float("width",u.getWidth());v.writeFloatAttribute$java_lang_String$float("height",u.getHeight());v.writeFloatAttribute$java_lang_String$float$float("xOffset",u.getXOffset(),0);v.writeFloatAttribute$java_lang_String$float$float("yOffset",u.getYOffset(),0);v.writeFloatAttribute$java_lang_String$float$float("angle",u.getAngle(),0);v.writeFloatAttribute$java_lang_String$float$float("scale",u.getScale(),1);v.writeBooleanAttribute("fittingArea",u.isFittingArea(),false);v.writeBooleanAttribute("leftToRightOriented",u.isLeftToRightOriented(),true);v.writeAttribute$java_lang_String$java_lang_String$java_lang_String("image",this.__parent.getExportedContentName(u,u.getImage()),null)};s.prototype.writeAttributes=function(v,u){if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null&&u instanceof HomeTexture)||u===null)){return this.writeAttributes$com_eteks_sweethome3d_io_XMLWriter$com_eteks_sweethome3d_model_HomeTexture(v,u)}else{if(((v!=null&&v instanceof XMLWriter)||v===null)&&((u!=null)||u===null)){t.prototype.writeAttributes.call(this,v,u)}else{throw new Error("invalid overload")}}};return s}(ObjectXMLExporter));k.HomeXMLExporter$14=j})(HomeXMLExporter||(HomeXMLExporter={}));var InterruptedRecorderException=(function(a){__extends(b,a);function b(c){var e=this;if(((typeof c==="string")||c===null)){var d=arguments;e=a.call(this,c)||this}else{if(c===undefined){var d=arguments;e=a.call(this)||this}else{throw new Error("invalid overload")}}return e}return b}(RecorderException));InterruptedRecorderException.__class="com.eteks.sweethome3d.model.InterruptedRecorderException";var NotEnoughSpaceRecorderException=(function(b){__extends(a,b);function a(c,d){var e=b.call(this,c)||this;Object.setPrototypeOf(e,a.prototype);if(e.missingSpace===undefined){e.missingSpace=0}e.missingSpace=d;return e}a.prototype.getMissingSpace=function(){return this.missingSpace};return a}(RecorderException));NotEnoughSpaceRecorderException.__class="com.eteks.sweethome3d.model.NotEnoughSpaceRecorderException";var DamagedHomeRecorderException=(function(b){__extends(a,b);function a(g,e,c){var f=this;if(((g!=null&&g instanceof Home)||g===null)&&((e!=null&&(e instanceof Array))||e===null)&&((typeof c==="string")||c===null)){var d=arguments;f=b.call(this,c)||this;if(f.damagedHome===undefined){f.damagedHome=null}if(f.invalidContent===undefined){f.invalidContent=null}f.damagedHome=g;f.invalidContent=e}else{if(((g!=null&&g instanceof Home)||g===null)&&((e!=null&&(e instanceof Array))||e===null)&&c===undefined){var d=arguments;f=b.call(this)||this;if(f.damagedHome===undefined){f.damagedHome=null}if(f.invalidContent===undefined){f.invalidContent=null}f.damagedHome=g;f.invalidContent=e}else{throw new Error("invalid overload")}}return f}a.prototype.getDamagedHome=function(){return this.damagedHome};a.prototype.getInvalidContent=function(){return this.invalidContent};return a}(RecorderException));DamagedHomeRecorderException.__class="com.eteks.sweethome3d.model.DamagedHomeRecorderException";var Room=(function(b){__extends(a,b);function a(j,d){var h=this;if(((typeof j==="string")||j===null)&&((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||d[0] instanceof Array))||d===null)){var g=arguments;h=b.call(this,j)||this;if(h.name===undefined){h.name=null}if(h.nameXOffset===undefined){h.nameXOffset=0}if(h.nameYOffset===undefined){h.nameYOffset=0}if(h.nameStyle===undefined){h.nameStyle=null}if(h.nameAngle===undefined){h.nameAngle=0}if(h.points===undefined){h.points=null}if(h.areaVisible===undefined){h.areaVisible=false}if(h.areaXOffset===undefined){h.areaXOffset=0}if(h.areaYOffset===undefined){h.areaYOffset=0}if(h.areaStyle===undefined){h.areaStyle=null}if(h.areaAngle===undefined){h.areaAngle=0}if(h.floorVisible===undefined){h.floorVisible=false}if(h.floorColor===undefined){h.floorColor=null}if(h.floorTexture===undefined){h.floorTexture=null}if(h.floorShininess===undefined){h.floorShininess=0}if(h.ceilingVisible===undefined){h.ceilingVisible=false}if(h.ceilingColor===undefined){h.ceilingColor=null}if(h.ceilingTexture===undefined){h.ceilingTexture=null}if(h.ceilingShininess===undefined){h.ceilingShininess=0}if(h.ceilingFlat===undefined){h.ceilingFlat=false}if(h.level===undefined){h.level=null}if(h.shapeCache===undefined){h.shapeCache=null}if(h.boundsCache===undefined){h.boundsCache=null}if(h.areaCache===undefined){h.areaCache=null}if(d.length<=1){throw new IllegalStateException("Room points must containt at least two points")}h.points=h.deepCopy(d);h.areaVisible=true;h.nameYOffset=-40;h.floorVisible=true;h.ceilingVisible=true;h.ceilingFlat=true}else{if(((j!=null&&j instanceof Array&&(j.length==0||j[0]==null||j[0] instanceof Array))||j===null)&&d===undefined){var g=arguments;var f=g[0];var e=arguments;var c=HomeObject.createId("room");h=b.call(this,c)||this;if(h.name===undefined){h.name=null}if(h.nameXOffset===undefined){h.nameXOffset=0}if(h.nameYOffset===undefined){h.nameYOffset=0}if(h.nameStyle===undefined){h.nameStyle=null}if(h.nameAngle===undefined){h.nameAngle=0}if(h.points===undefined){h.points=null}if(h.areaVisible===undefined){h.areaVisible=false}if(h.areaXOffset===undefined){h.areaXOffset=0}if(h.areaYOffset===undefined){h.areaYOffset=0}if(h.areaStyle===undefined){h.areaStyle=null}if(h.areaAngle===undefined){h.areaAngle=0}if(h.floorVisible===undefined){h.floorVisible=false}if(h.floorColor===undefined){h.floorColor=null}if(h.floorTexture===undefined){h.floorTexture=null}if(h.floorShininess===undefined){h.floorShininess=0}if(h.ceilingVisible===undefined){h.ceilingVisible=false}if(h.ceilingColor===undefined){h.ceilingColor=null}if(h.ceilingTexture===undefined){h.ceilingTexture=null}if(h.ceilingShininess===undefined){h.ceilingShininess=0}if(h.ceilingFlat===undefined){h.ceilingFlat=false}if(h.level===undefined){h.level=null}if(h.shapeCache===undefined){h.shapeCache=null}if(h.boundsCache===undefined){h.boundsCache=null}if(h.areaCache===undefined){h.areaCache=null}if(f.length<=1){throw new IllegalStateException("Room points must containt at least two points")}h.points=h.deepCopy(f);h.areaVisible=true;h.nameYOffset=-40;h.floorVisible=true;h.ceilingVisible=true;h.ceilingFlat=true;if(h.name===undefined){h.name=null}if(h.nameXOffset===undefined){h.nameXOffset=0}if(h.nameYOffset===undefined){h.nameYOffset=0}if(h.nameStyle===undefined){h.nameStyle=null}if(h.nameAngle===undefined){h.nameAngle=0}if(h.points===undefined){h.points=null}if(h.areaVisible===undefined){h.areaVisible=false}if(h.areaXOffset===undefined){h.areaXOffset=0}if(h.areaYOffset===undefined){h.areaYOffset=0}if(h.areaStyle===undefined){h.areaStyle=null}if(h.areaAngle===undefined){h.areaAngle=0}if(h.floorVisible===undefined){h.floorVisible=false}if(h.floorColor===undefined){h.floorColor=null}if(h.floorTexture===undefined){h.floorTexture=null}if(h.floorShininess===undefined){h.floorShininess=0}if(h.ceilingVisible===undefined){h.ceilingVisible=false}if(h.ceilingColor===undefined){h.ceilingColor=null}if(h.ceilingTexture===undefined){h.ceilingTexture=null}if(h.ceilingShininess===undefined){h.ceilingShininess=0}if(h.ceilingFlat===undefined){h.ceilingFlat=false}if(h.level===undefined){h.level=null}if(h.shapeCache===undefined){h.shapeCache=null}if(h.boundsCache===undefined){h.boundsCache=null}if(h.areaCache===undefined){h.areaCache=null}}else{throw new Error("invalid overload")}}return h}a.TWICE_PI_$LI$=function(){if(a.TWICE_PI==null){a.TWICE_PI=2*Math.PI}return a.TWICE_PI};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.getNameXOffset=function(){return this.nameXOffset};a.prototype.setNameXOffset=function(c){if(c!==this.nameXOffset){var d=this.nameXOffset;this.nameXOffset=c;this.firePropertyChange("NAME_X_OFFSET",d,c)}};a.prototype.getNameYOffset=function(){return this.nameYOffset};a.prototype.setNameYOffset=function(c){if(c!==this.nameYOffset){var d=this.nameYOffset;this.nameYOffset=c;this.firePropertyChange("NAME_Y_OFFSET",d,c)}};a.prototype.getNameStyle=function(){return this.nameStyle};a.prototype.setNameStyle=function(d){if(d!==this.nameStyle){var c=this.nameStyle;this.nameStyle=d;this.firePropertyChange("NAME_STYLE",c,d)}};a.prototype.getNameAngle=function(){return this.nameAngle};a.prototype.setNameAngle=function(c){c=((c%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(c!==this.nameAngle){var d=this.nameAngle;this.nameAngle=c;this.firePropertyChange("NAME_ANGLE",d,c)}};a.prototype.getPoints=function(){return this.deepCopy(this.points)};a.prototype.getPointCount=function(){return this.points.length};a.prototype.deepCopy=function(e){var c=(function(g){var f=[];while(g-->0){f.push(null)}return f})(e.length);for(var d=0;d<e.length;d++){c[d]=e[d].slice(0)}return c};a.prototype.setPoints=function(c){if(!(JSON.stringify(this.points)===JSON.stringify(c))){this.updatePoints(c)}};a.prototype.updatePoints=function(d){var c=this.points;this.points=this.deepCopy(d);this.shapeCache=null;this.boundsCache=null;this.areaCache=null;this.firePropertyChange("POINTS",c,d)};a.prototype.addPoint$float$float=function(c,d){this.addPoint$float$float$int(c,d,this.points.length)};a.prototype.addPoint$float$float$int=function(c,g,d){if(d<0||d>this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}var f=(function(j){var h=[];while(j-->0){h.push(null)}return h})(this.points.length+1);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,0,f,0,d);f[d]=[c,g];(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,d,f,d+1,this.points.length-d);var e=this.points;this.points=f;this.shapeCache=null;this.boundsCache=null;this.areaCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))};a.prototype.addPoint=function(c,e,d){if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&((typeof d==="number")||d===null)){return this.addPoint$float$float$int(c,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.addPoint$float$float(c,e)}else{throw new Error("invalid overload")}}};a.prototype.setPoint=function(c,f,d){if(d<0||d>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}if(this.points[d][0]!==c||this.points[d][1]!==f){var e=this.points;this.points=this.deepCopy(this.points);this.points[d][0]=c;this.points[d][1]=f;this.shapeCache=null;this.boundsCache=null;this.areaCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))}};a.prototype.removePoint=function(c){if(c<0||c>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+c),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}else{if(this.points.length<=1){throw new IllegalStateException("Room points must containt at least one point")}}var e=(function(g){var f=[];while(g-->0){f.push(null)}return f})(this.points.length-1);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,0,e,0,c);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,c+1,e,c,this.points.length-c-1);var d=this.points;this.points=e;this.shapeCache=null;this.boundsCache=null;this.areaCache=null;this.firePropertyChange("POINTS",d,this.deepCopy(this.points))};a.prototype.getBoundsMinimumCoordinates=function(){if(this.boundsCache==null){this.boundsCache=this.getShape().getBounds2D()}return[this.boundsCache.getMinX(),this.boundsCache.getMinY()]};a.prototype.getBoundsMaximumCoordinates=function(){if(this.boundsCache==null){this.boundsCache=this.getShape().getBounds2D()}return[this.boundsCache.getMaxX(),this.boundsCache.getMaxY()]};a.prototype.isAreaVisible=function(){return this.areaVisible};a.prototype.setAreaVisible=function(c){if(c!==this.areaVisible){this.areaVisible=c;this.firePropertyChange("AREA_VISIBLE",!c,c)}};a.prototype.getAreaXOffset=function(){return this.areaXOffset};a.prototype.setAreaXOffset=function(c){if(c!==this.areaXOffset){var d=this.areaXOffset;this.areaXOffset=c;this.firePropertyChange("AREA_X_OFFSET",d,c)}};a.prototype.getAreaYOffset=function(){return this.areaYOffset};a.prototype.setAreaYOffset=function(c){if(c!==this.areaYOffset){var d=this.areaYOffset;this.areaYOffset=c;this.firePropertyChange("AREA_Y_OFFSET",d,c)}};a.prototype.getAreaStyle=function(){return this.areaStyle};a.prototype.setAreaStyle=function(d){if(d!==this.areaStyle){var c=this.areaStyle;this.areaStyle=d;this.firePropertyChange("AREA_STYLE",c,d)}};a.prototype.getAreaAngle=function(){return this.areaAngle};a.prototype.setAreaAngle=function(d){d=((d%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(d!==this.areaAngle){var c=this.areaAngle;this.areaAngle=d;this.firePropertyChange("AREA_ANGLE",c,d)}};a.prototype.getXCenter=function(){var c=this.points[0][0];var e=this.points[0][0];for(var d=1;d<this.points.length;d++){c=Math.min(c,this.points[d][0]);e=Math.max(e,this.points[d][0])}return(c+e)/2};a.prototype.getYCenter=function(){var c=this.points[0][1];var e=this.points[0][1];for(var d=1;d<this.points.length;d++){c=Math.min(c,this.points[d][1]);e=Math.max(e,this.points[d][1])}return(c+e)/2};a.prototype.getFloorColor=function(){return this.floorColor};a.prototype.setFloorColor=function(c){if(c!==this.floorColor&&(c==null||!(c===this.floorColor))){var d=this.floorColor;this.floorColor=c;this.firePropertyChange("FLOOR_COLOR",d,c)}};a.prototype.getFloorTexture=function(){return this.floorTexture};a.prototype.setFloorTexture=function(c){if(c!==this.floorTexture&&(c==null||!c.equals(this.floorTexture))){var d=this.floorTexture;this.floorTexture=c;this.firePropertyChange("FLOOR_TEXTURE",d,c)}};a.prototype.isFloorVisible=function(){return this.floorVisible};a.prototype.setFloorVisible=function(c){if(c!==this.floorVisible){this.floorVisible=c;this.firePropertyChange("FLOOR_VISIBLE",!c,c)}};a.prototype.getFloorShininess=function(){return this.floorShininess};a.prototype.setFloorShininess=function(d){if(d!==this.floorShininess){var c=this.floorShininess;this.floorShininess=d;this.firePropertyChange("FLOOR_SHININESS",c,d)}};a.prototype.getCeilingColor=function(){return this.ceilingColor};a.prototype.setCeilingColor=function(c){if(c!==this.ceilingColor&&(c==null||!(c===this.ceilingColor))){var d=this.ceilingColor;this.ceilingColor=c;this.firePropertyChange("CEILING_COLOR",d,c)}};a.prototype.getCeilingTexture=function(){return this.ceilingTexture};a.prototype.setCeilingTexture=function(c){if(c!==this.ceilingTexture&&(c==null||!c.equals(this.ceilingTexture))){var d=this.ceilingTexture;this.ceilingTexture=c;this.firePropertyChange("CEILING_TEXTURE",d,c)}};a.prototype.isCeilingVisible=function(){return this.ceilingVisible};a.prototype.setCeilingVisible=function(c){if(c!==this.ceilingVisible){this.ceilingVisible=c;this.firePropertyChange("CEILING_VISIBLE",!c,c)}};a.prototype.getCeilingShininess=function(){return this.ceilingShininess};a.prototype.setCeilingShininess=function(d){if(d!==this.ceilingShininess){var c=this.ceilingShininess;this.ceilingShininess=d;this.firePropertyChange("CEILING_SHININESS",c,d)}};a.prototype.isCeilingFlat=function(){return this.ceilingFlat};a.prototype.setCeilingFlat=function(c){if(c!==this.ceilingFlat){this.ceilingFlat=c;this.firePropertyChange("CEILING_FLAT",!c,c)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(c){return this.level===c||this.level!=null&&c!=null&&this.level.getElevation()===c.getElevation()&&this.level.getElevationIndex()<c.getElevationIndex()};a.prototype.getArea=function(){if(this.areaCache==null){var d=new java.awt.geom.Area(this.getShape());if(d.isSingular()){this.areaCache=Math.abs(this.getSignedArea(this.getPoints()))}else{var h=0;var g=([]);for(var f=d.getPathIterator(null);!f.isDone();){var e=[0,0];switch((f.currentSegment(e))){case java.awt.geom.PathIterator.SEG_MOVETO:(g.push(e)>0);break;case java.awt.geom.PathIterator.SEG_LINETO:(g.push(e)>0);break;case java.awt.geom.PathIterator.SEG_CLOSE:var c=g.slice(0);h+=this.getSignedArea(c);(g.length=0);break}f.next()}this.areaCache=h}}return this.areaCache};a.prototype.getSignedArea=function(e){var d=0;for(var c=1;c<e.length;c++){d+=e[c][0]*e[c-1][1];d-=e[c][1]*e[c-1][0]}d+=e[0][0]*e[e.length-1][1];d-=e[0][1]*e[e.length-1][0];return d/2};a.prototype.isClockwise=function(){return this.getSignedArea(this.getPoints())<0};a.prototype.isSingular=function(){return new java.awt.geom.Area(this.getShape()).isSingular()};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){return this.containsShapeAtWithMargin(this.getShape(),c,e,d)};a.prototype.getPointIndexAt=function(c,f,e){for(var d=0;d<this.points.length;d++){if(Math.abs(c-this.points[d][0])<=e&&Math.abs(f-this.points[d][1])<=e){return d}}return -1};a.prototype.isNameCenterPointAt=function(c,e,d){return Math.abs(c-this.getXCenter()-this.getNameXOffset())<=d&&Math.abs(e-this.getYCenter()-this.getNameYOffset())<=d};a.prototype.isAreaCenterPointAt=function(c,e,d){return Math.abs(c-this.getXCenter()-this.getAreaXOffset())<=d&&Math.abs(e-this.getYCenter()-this.getAreaYOffset())<=d};a.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.getShape=function(){if(this.shapeCache==null){var d=new java.awt.geom.GeneralPath();d.moveTo(this.points[0][0],this.points[0][1]);for(var c=1;c<this.points.length;c++){d.lineTo(this.points[c][0],this.points[c][1])}d.closePath();this.shapeCache=d}return this.shapeCache};a.prototype.move=function(d,c){if(d!==0||c!==0){var f=this.getPoints();for(var e=0;e<f.length;e++){f[e][0]+=d;f[e][1]+=c}this.updatePoints(f)}};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var e=Object.create(g);for(var f in g){if(g.hasOwnProperty(f)){e[f]=g[f]}}return e}})(this);c.level=null;return c};return a}(HomeObject));Room.__class="com.eteks.sweethome3d.model.Room";Room.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];Room.__transients=["shapeCache","boundsCache","areaCache","propertyChangeSupport"];var Label=(function(a){__extends(b,a);function b(e,m,k,j){var g=this;if(((typeof e==="string")||e===null)&&((typeof m==="string")||m===null)&&((typeof k==="number")||k===null)&&((typeof j==="number")||j===null)){var h=arguments;g=a.call(this,e)||this;if(g.text===undefined){g.text=null}if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.style===undefined){g.style=null}if(g.color===undefined){g.color=null}if(g.outlineColor===undefined){g.outlineColor=null}if(g.angle===undefined){g.angle=0}if(g.pitch===undefined){g.pitch=null}if(g.elevation===undefined){g.elevation=0}if(g.level===undefined){g.level=null}g.text=m;g.x=k;g.y=j}else{if(((typeof e==="string")||e===null)&&((typeof m==="number")||m===null)&&((typeof k==="number")||k===null)&&j===undefined){var h=arguments;var f=h[0];var n=h[1];var d=h[2];var c=arguments;var l=HomeObject.createId("label");g=a.call(this,l)||this;if(g.text===undefined){g.text=null}if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.style===undefined){g.style=null}if(g.color===undefined){g.color=null}if(g.outlineColor===undefined){g.outlineColor=null}if(g.angle===undefined){g.angle=0}if(g.pitch===undefined){g.pitch=null}if(g.elevation===undefined){g.elevation=0}if(g.level===undefined){g.level=null}g.text=f;g.x=n;g.y=d;if(g.text===undefined){g.text=null}if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.style===undefined){g.style=null}if(g.color===undefined){g.color=null}if(g.outlineColor===undefined){g.outlineColor=null}if(g.angle===undefined){g.angle=0}if(g.pitch===undefined){g.pitch=null}if(g.elevation===undefined){g.elevation=0}if(g.level===undefined){g.level=null}}else{throw new Error("invalid overload")}}return g}b.TWICE_PI_$LI$=function(){if(b.TWICE_PI==null){b.TWICE_PI=2*Math.PI}return b.TWICE_PI};b.prototype.getText=function(){return this.text};b.prototype.setText=function(d){if(d!==this.text&&(d==null||!(d===this.text))){var c=this.text;this.text=d;this.firePropertyChange("TEXT",c,d)}};b.prototype.getX=function(){return this.x};b.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.firePropertyChange("X",d,c)}};b.prototype.getY=function(){return this.y};b.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.firePropertyChange("Y",c,d)}};b.prototype.getGroundElevation=function(){if(this.level!=null){return this.elevation+this.level.getElevation()}else{return this.elevation}};b.prototype.getElevation=function(){return this.elevation};b.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};b.prototype.getStyle=function(){return this.style};b.prototype.setStyle=function(d){if(d!==this.style){var c=this.style;this.style=d;this.firePropertyChange("STYLE",c,d)}};b.prototype.getColor=function(){return this.color};b.prototype.setColor=function(c){if(c!==this.color){var d=this.color;this.color=c;this.firePropertyChange("COLOR",d,c)}};b.prototype.getOutlineColor=function(){return this.outlineColor};b.prototype.setOutlineColor=function(c){if(c!==this.outlineColor){var d=this.outlineColor;this.outlineColor=c;this.firePropertyChange("OUTLINE_COLOR",d,c)}};b.prototype.getAngle=function(){return this.angle};b.prototype.setAngle=function(d){d=((d%b.TWICE_PI_$LI$()+b.TWICE_PI_$LI$())%b.TWICE_PI_$LI$());if(d!==this.angle){var c=this.angle;this.angle=d;this.firePropertyChange("ANGLE",c,d)}};b.prototype.getPitch=function(){return this.pitch};b.prototype.setPitch=function(d){if(d!=null){d=((d%b.TWICE_PI_$LI$()+b.TWICE_PI_$LI$())%b.TWICE_PI_$LI$())}if(d!==this.pitch&&(d==null||!(d===this.pitch))){var c=this.pitch;this.pitch=d;this.firePropertyChange("PITCH",c,d)}};b.prototype.getLevel=function(){return this.level};b.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};b.prototype.isAtLevel=function(e){if(this.level===e){return true}else{if(this.level!=null&&e!=null){var c=this.level.getElevation();var d=e.getElevation();return c===d&&this.level.getElevationIndex()<e.getElevationIndex()||c<d&&c+this.elevation>d}else{return false}}};b.prototype.getPoints=function(){return[[this.x,this.y]]};b.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return d.contains(this.x,this.y)};b.prototype.containsPoint=function(c,e,d){return Math.abs(c-this.x)<=d&&Math.abs(e-this.y)<=d};b.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};b.prototype.clone=function(){var d=this;var c=(function(g){if(a.prototype.clone!=undefined){return a.prototype.clone.call(d)}else{var e=Object.create(g);for(var f in g){if(g.hasOwnProperty(f)){e[f]=g[f]}}return e}})(this);c.level=null;return c};return b}(HomeObject));Label.__class="com.eteks.sweethome3d.model.Label";Label.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];Label.__transients=["propertyChangeSupport"];var HomeEnvironment=(function(a){__extends(b,a);function b(I,s,t,c,q,E,J){var h=this;if(((typeof I==="string")||I===null)&&((typeof s==="number")||s===null)&&((t!=null&&t instanceof HomeTexture)||t===null)&&((typeof c==="number")||c===null)&&((q!=null&&q instanceof HomeTexture)||q===null)&&((typeof E==="number")||E===null)&&((typeof J==="number")||J===null)){var Q=arguments;h=a.call(this,I)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=s;h.groundTexture=t;h.skyColor=c;h.skyTexture=q;h.lightColor=E;h.ceilingLightColor=13684944;h.wallsAlpha=J;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[]}else{if(((typeof I==="number")||I===null)&&((s!=null&&s instanceof HomeTexture)||s===null)&&((typeof t==="number")||t===null)&&((c!=null&&c instanceof HomeTexture)||c===null)&&((typeof q==="number")||q===null)&&((typeof E==="number")||E===null)&&J===undefined){var Q=arguments;var O=Q[0];var o=Q[1];var H=Q[2];var r=Q[3];var C=Q[4];var g=Q[5];var L=arguments;var S=HomeObject.createId("environment");h=a.call(this,S)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=O;h.groundTexture=o;h.skyColor=H;h.skyTexture=r;h.lightColor=C;h.ceilingLightColor=13684944;h.wallsAlpha=g;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{if(((typeof I==="number")||I===null)&&((s!=null&&s instanceof HomeTexture)||s===null)&&((typeof t==="number")||t===null)&&((typeof c==="number")||c===null)&&((typeof q==="number")||q===null)&&E===undefined&&J===undefined){var Q=arguments;var N=Q[0];var m=Q[1];var G=Q[2];var B=Q[3];var f=Q[4];var z=arguments;var p=null;var x=arguments;var R=HomeObject.createId("environment");h=a.call(this,R)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=N;h.groundTexture=m;h.skyColor=G;h.skyTexture=p;h.lightColor=B;h.ceilingLightColor=13684944;h.wallsAlpha=f;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{if(((typeof I==="string")||I===null)&&s===undefined&&t===undefined&&c===undefined&&q===undefined&&E===undefined&&J===undefined){var Q=arguments;var w=arguments;var M=11053224;var l=null;var F=13427964;var n=null;var A=13684944;var e=0;h=a.call(this,I)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=M;h.groundTexture=l;h.skyColor=F;h.skyTexture=n;h.lightColor=A;h.ceilingLightColor=13684944;h.wallsAlpha=e;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{if(I===undefined&&s===undefined&&t===undefined&&c===undefined&&q===undefined&&E===undefined&&J===undefined){var Q=arguments;var v=arguments;var P=HomeObject.createId("environment");var u=arguments;var K=11053224;var j=null;var D=13427964;var k=null;var y=13684944;var d=0;h=a.call(this,P)||this;if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}h.observerCameraElevationAdjusted=true;h.groundColor=K;h.groundTexture=j;h.skyColor=D;h.skyTexture=k;h.lightColor=y;h.ceilingLightColor=13684944;h.wallsAlpha=d;h.drawingMode=b.DrawingMode.FILL;h.photoWidth=400;h.photoHeight=300;h.photoAspectRatio=AspectRatio.VIEW_3D_RATIO;h.videoWidth=320;h.videoAspectRatio=AspectRatio.RATIO_4_3;h.videoSpeed=2400/3600;h.videoFrameRate=25;h.cameraPath=[];if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}if(h.observerCameraElevationAdjusted===undefined){h.observerCameraElevationAdjusted=false}if(h.groundColor===undefined){h.groundColor=0}if(h.groundTexture===undefined){h.groundTexture=null}if(h.backgroundImageVisibleOnGround3D===undefined){h.backgroundImageVisibleOnGround3D=false}if(h.skyColor===undefined){h.skyColor=0}if(h.skyTexture===undefined){h.skyTexture=null}if(h.lightColor===undefined){h.lightColor=0}if(h.ceilingLightColor===undefined){h.ceilingLightColor=0}if(h.wallsAlpha===undefined){h.wallsAlpha=0}if(h.drawingMode===undefined){h.drawingMode=null}if(h.subpartSizeUnderLight===undefined){h.subpartSizeUnderLight=0}if(h.allLevelsVisible===undefined){h.allLevelsVisible=false}if(h.photoWidth===undefined){h.photoWidth=0}if(h.photoHeight===undefined){h.photoHeight=0}if(h.photoAspectRatio===undefined){h.photoAspectRatio=null}if(h.photoAspectRatioName===undefined){h.photoAspectRatioName=null}if(h.photoQuality===undefined){h.photoQuality=0}if(h.videoWidth===undefined){h.videoWidth=0}if(h.videoAspectRatio===undefined){h.videoAspectRatio=null}if(h.videoAspectRatioName===undefined){h.videoAspectRatioName=null}if(h.videoQuality===undefined){h.videoQuality=0}if(h.videoSpeed===undefined){h.videoSpeed=0}if(h.videoFrameRate===undefined){h.videoFrameRate=0}if(h.cameraPath===undefined){h.cameraPath=null}}else{throw new Error("invalid overload")}}}}}return h}b.prototype.isObserverCameraElevationAdjusted=function(){return this.observerCameraElevationAdjusted};b.prototype.setObserverCameraElevationAdjusted=function(c){if(this.observerCameraElevationAdjusted!==c){this.observerCameraElevationAdjusted=c;this.firePropertyChange("OBSERVER_CAMERA_ELEVATION_ADJUSTED",!c,c)}};b.prototype.getGroundColor=function(){return this.groundColor};b.prototype.setGroundColor=function(c){if(c!==this.groundColor){var d=this.groundColor;this.groundColor=c;this.firePropertyChange("GROUND_COLOR",d,c)}};b.prototype.getGroundTexture=function(){return this.groundTexture};b.prototype.setGroundTexture=function(d){if(d!==this.groundTexture){var c=this.groundTexture;this.groundTexture=d;this.firePropertyChange("GROUND_TEXTURE",c,d)}};b.prototype.isBackgroundImageVisibleOnGround3D=function(){return this.backgroundImageVisibleOnGround3D};b.prototype.setBackgroundImageVisibleOnGround3D=function(c){if(this.backgroundImageVisibleOnGround3D!==c){this.backgroundImageVisibleOnGround3D=c;this.firePropertyChange("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",!c,c)}};b.prototype.getSkyColor=function(){return this.skyColor};b.prototype.setSkyColor=function(d){if(d!==this.skyColor){var c=this.skyColor;this.skyColor=d;this.firePropertyChange("SKY_COLOR",c,d)}};b.prototype.getSkyTexture=function(){return this.skyTexture};b.prototype.setSkyTexture=function(c){if(c!==this.skyTexture){var d=this.skyTexture;this.skyTexture=c;this.firePropertyChange("SKY_TEXTURE",d,c)}};b.prototype.getLightColor=function(){return this.lightColor};b.prototype.setLightColor=function(c){if(c!==this.lightColor){var d=this.lightColor;this.lightColor=c;this.firePropertyChange("LIGHT_COLOR",d,c)}};b.prototype.getCeillingLightColor=function(){return this.ceilingLightColor};b.prototype.setCeillingLightColor=function(c){if(c!==this.ceilingLightColor){var d=this.ceilingLightColor;this.ceilingLightColor=c;this.firePropertyChange("CEILING_LIGHT_COLOR",d,c)}};b.prototype.getWallsAlpha=function(){return this.wallsAlpha};b.prototype.setWallsAlpha=function(d){if(d!==this.wallsAlpha){var c=this.wallsAlpha;this.wallsAlpha=d;this.firePropertyChange("WALLS_ALPHA",c,d)}};b.prototype.getDrawingMode=function(){return this.drawingMode};b.prototype.setDrawingMode=function(c){if(c!==this.drawingMode){var d=this.drawingMode;this.drawingMode=c;this.firePropertyChange("DRAWING_MODE",d,c)}};b.prototype.getSubpartSizeUnderLight=function(){return this.subpartSizeUnderLight};b.prototype.setSubpartSizeUnderLight=function(c){if(c!==this.subpartSizeUnderLight){var d=this.subpartSizeUnderLight;this.subpartSizeUnderLight=c;this.firePropertyChange("SUBPART_SIZE_UNDER_LIGHT",d,c)}};b.prototype.isAllLevelsVisible=function(){return this.allLevelsVisible};b.prototype.setAllLevelsVisible=function(c){if(c!==this.allLevelsVisible){this.allLevelsVisible=c;this.firePropertyChange("ALL_LEVELS_VISIBLE",!c,c)}};b.prototype.getPhotoWidth=function(){return this.photoWidth};b.prototype.setPhotoWidth=function(d){if(this.photoWidth!==d){var c=this.photoWidth;this.photoWidth=d;this.firePropertyChange("PHOTO_WIDTH",c,d)}};b.prototype.getPhotoHeight=function(){return this.photoHeight};b.prototype.setPhotoHeight=function(c){if(this.photoHeight!==c){var d=this.photoHeight;this.photoHeight=c;this.firePropertyChange("PHOTO_HEIGHT",d,c)}};b.prototype.getPhotoAspectRatio=function(){return this.photoAspectRatio};b.prototype.setPhotoAspectRatio=function(c){if(this.photoAspectRatio!==c){var d=this.photoAspectRatio;this.photoAspectRatio=c;this.photoAspectRatioName=AspectRatio[this.photoAspectRatio];this.firePropertyChange("PHOTO_ASPECT_RATIO",d,c)}};b.prototype.getPhotoQuality=function(){return this.photoQuality};b.prototype.setPhotoQuality=function(c){if(this.photoQuality!==c){var d=this.photoQuality;this.photoQuality=c;this.firePropertyChange("PHOTO_QUALITY",d,c)}};b.prototype.getVideoWidth=function(){return this.videoWidth};b.prototype.setVideoWidth=function(d){if(this.videoWidth!==d){var c=this.videoWidth;this.videoWidth=d;this.firePropertyChange("VIDEO_WIDTH",c,d)}};b.prototype.getVideoHeight=function(){return Math.round(this.getVideoWidth()/{FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[this.getVideoAspectRatio()])};b.prototype.getVideoAspectRatio=function(){return this.videoAspectRatio};b.prototype.setVideoAspectRatio=function(d){if(this.videoAspectRatio!==d){if({FREE_RATIO:null,VIEW_3D_RATIO:null,RATIO_4_3:4/3,RATIO_3_2:1.5,RATIO_16_9:16/9,RATIO_2_1:2/1,SQUARE_RATIO:1}[d]==null){throw new IllegalArgumentException("Unsupported aspect ratio "+d)}var c=this.videoAspectRatio;this.videoAspectRatio=d;this.videoAspectRatioName=AspectRatio[this.videoAspectRatio];this.firePropertyChange("VIDEO_ASPECT_RATIO",c,d)}};b.prototype.getVideoQuality=function(){return this.videoQuality};b.prototype.setVideoQuality=function(c){if(this.videoQuality!==c){var d=this.videoQuality;this.videoQuality=c;this.firePropertyChange("VIDEO_QUALITY",d,c)}};b.prototype.getVideoSpeed=function(){return this.videoSpeed};b.prototype.setVideoSpeed=function(c){if(this.videoSpeed!==c){var d=this.videoSpeed;this.videoSpeed=c;this.firePropertyChange("VIDEO_SPEED",d,c)}};b.prototype.getVideoFrameRate=function(){return this.videoFrameRate};b.prototype.setVideoFrameRate=function(d){if(this.videoFrameRate!==d){var c=this.videoFrameRate;this.videoFrameRate=d;this.firePropertyChange("VIDEO_FRAME_RATE",c,d)}};b.prototype.getVideoCameraPath=function(){return this.cameraPath.slice(0)};b.prototype.setVideoCameraPath=function(c){if(this.cameraPath!==c){var d=this.cameraPath;if(c!=null){this.cameraPath=(c.slice(0))}else{this.cameraPath=[]}this.firePropertyChange("VIDEO_CAMERA_PATH",d,c)}};b.prototype.clone=function(){var f=this;var e=(function(j){if(a.prototype.clone!=undefined){return a.prototype.clone.call(f)}else{var g=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){g[h]=j[h]}}return g}})(this);e.cameraPath=([]);for(var c=0;c<this.cameraPath.length;c++){var d=this.cameraPath[c];(e.cameraPath.push((function(j){if(j.clone!=undefined){return j.clone()}else{var g=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){g[h]=j[h]}}return g}})(d))>0)}return e};return b}(HomeObject));HomeEnvironment.__class="com.eteks.sweethome3d.model.HomeEnvironment";(function(a){var b;(function(c){c[c.FILL=0]="FILL";c[c.OUTLINE=1]="OUTLINE";c[c.FILL_AND_OUTLINE=2]="FILL_AND_OUTLINE"})(b=a.DrawingMode||(a.DrawingMode={}))})(HomeEnvironment||(HomeEnvironment={}));HomeEnvironment.__transients=["photoAspectRatio","videoAspectRatio","propertyChangeSupport"];var HomePieceOfFurniture=(function(b){__extends(a,b);function a(p,e,o){var s=this;if(((typeof p==="string")||p===null)&&((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0))||e===null)&&((o!=null&&o instanceof Array&&(o.length==0||o[0]==null||(typeof o[0]==="string")))||o===null)){var m=arguments;s=b.call(this,p)||this;if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}s.name=e.getName();s.description=e.getDescription();s.information=e.getInformation();s.creator=e.getCreator();s.license=e.getLicense();s.icon=e.getIcon();s.planIcon=e.getPlanIcon();s.model=e.getModel();s.modelSize=e.getModelSize();s.width=e.getWidth();s.depth=e.getDepth();s.height=e.getHeight();s.elevation=e.getElevation();s.dropOnTopElevation=e.getDropOnTopElevation();s.movable=e.isMovable();s.doorOrWindow=e.isDoorOrWindow();s.color=e.getColor();s.modelRotation=e.getModelRotation();s.staircaseCutOutShape=e.getStaircaseCutOutShape();s.modelFlags=e.getModelFlags();s.resizable=e.isResizable();s.deformable=e.isDeformable();s.texturable=e.isTexturable();s.horizontallyRotatable=e.isHorizontallyRotatable();s.price=e.getPrice();s.valueAddedTaxPercentage=e.getValueAddedTaxPercentage();s.currency=e.getCurrency();if(e!=null&&e instanceof a){var h=e;s.catalogId=h.getCatalogId();s.nameVisible=h.isNameVisible();s.nameXOffset=h.getNameXOffset();s.nameYOffset=h.getNameYOffset();s.nameAngle=h.getNameAngle();s.nameStyle=h.getNameStyle();s.visible=h.isVisible();s.widthInPlan=h.getWidthInPlan();s.depthInPlan=h.getDepthInPlan();s.heightInPlan=h.getHeightInPlan();s.modelCenteredAtOrigin=h.isModelCenteredAtOrigin();s.modelTransformations=h.getModelTransformations();s.angle=h.getAngle();s.pitch=h.getPitch();s.roll=h.getRoll();s.x=h.getX();s.y=h.getY();s.modelMirrored=h.isModelMirrored();s.texture=h.getTexture();s.shininess=h.getShininess();s.modelMaterials=h.getModelMaterials();var n=o!=null?o.slice(0):h.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=h.isContentProperty(k)?h.getContentProperty(k):h.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}else{if(e!=null&&e instanceof CatalogPieceOfFurniture){var f=e;s.catalogId=f.getId();var n=o!=null?o.slice(0):f.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=f.isContentProperty(k)?f.getContentProperty(k):f.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}s.visible=true;s.widthInPlan=s.width;s.depthInPlan=s.depth;s.heightInPlan=s.height;s.modelCenteredAtOrigin=true;s.x=s.width/2;s.y=s.depth/2}}else{if(((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0))||p===null)&&((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||(typeof e[0]==="string")))||e===null)&&o===undefined){var m=arguments;var y=m[0];var u=m[1];var j=arguments;var x=HomeObject.createId("pieceOfFurniture");s=b.call(this,x)||this;if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}s.name=y.getName();s.description=y.getDescription();s.information=y.getInformation();s.creator=y.getCreator();s.license=y.getLicense();s.icon=y.getIcon();s.planIcon=y.getPlanIcon();s.model=y.getModel();s.modelSize=y.getModelSize();s.width=y.getWidth();s.depth=y.getDepth();s.height=y.getHeight();s.elevation=y.getElevation();s.dropOnTopElevation=y.getDropOnTopElevation();s.movable=y.isMovable();s.doorOrWindow=y.isDoorOrWindow();s.color=y.getColor();s.modelRotation=y.getModelRotation();s.staircaseCutOutShape=y.getStaircaseCutOutShape();s.modelFlags=y.getModelFlags();s.resizable=y.isResizable();s.deformable=y.isDeformable();s.texturable=y.isTexturable();s.horizontallyRotatable=y.isHorizontallyRotatable();s.price=y.getPrice();s.valueAddedTaxPercentage=y.getValueAddedTaxPercentage();s.currency=y.getCurrency();if(y!=null&&y instanceof a){var h=y;s.catalogId=h.getCatalogId();s.nameVisible=h.isNameVisible();s.nameXOffset=h.getNameXOffset();s.nameYOffset=h.getNameYOffset();s.nameAngle=h.getNameAngle();s.nameStyle=h.getNameStyle();s.visible=h.isVisible();s.widthInPlan=h.getWidthInPlan();s.depthInPlan=h.getDepthInPlan();s.heightInPlan=h.getHeightInPlan();s.modelCenteredAtOrigin=h.isModelCenteredAtOrigin();s.modelTransformations=h.getModelTransformations();s.angle=h.getAngle();s.pitch=h.getPitch();s.roll=h.getRoll();s.x=h.getX();s.y=h.getY();s.modelMirrored=h.isModelMirrored();s.texture=h.getTexture();s.shininess=h.getShininess();s.modelMaterials=h.getModelMaterials();var n=u!=null?u.slice(0):h.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=h.isContentProperty(k)?h.getContentProperty(k):h.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}else{if(y!=null&&y instanceof CatalogPieceOfFurniture){var f=y;s.catalogId=f.getId();var n=u!=null?u.slice(0):f.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=f.isContentProperty(k)?f.getContentProperty(k):f.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}s.visible=true;s.widthInPlan=s.width;s.depthInPlan=s.depth;s.heightInPlan=s.height;s.modelCenteredAtOrigin=true;s.x=s.width/2;s.y=s.depth/2}if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}}else{if(((typeof p==="string")||p===null)&&((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0))||e===null)&&o===undefined){var m=arguments;var g=arguments;var t=a.EMPTY_PROPERTY_ARRAY_$LI$();s=b.call(this,p)||this;if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}s.name=e.getName();s.description=e.getDescription();s.information=e.getInformation();s.creator=e.getCreator();s.license=e.getLicense();s.icon=e.getIcon();s.planIcon=e.getPlanIcon();s.model=e.getModel();s.modelSize=e.getModelSize();s.width=e.getWidth();s.depth=e.getDepth();s.height=e.getHeight();s.elevation=e.getElevation();s.dropOnTopElevation=e.getDropOnTopElevation();s.movable=e.isMovable();s.doorOrWindow=e.isDoorOrWindow();s.color=e.getColor();s.modelRotation=e.getModelRotation();s.staircaseCutOutShape=e.getStaircaseCutOutShape();s.modelFlags=e.getModelFlags();s.resizable=e.isResizable();s.deformable=e.isDeformable();s.texturable=e.isTexturable();s.horizontallyRotatable=e.isHorizontallyRotatable();s.price=e.getPrice();s.valueAddedTaxPercentage=e.getValueAddedTaxPercentage();s.currency=e.getCurrency();if(e!=null&&e instanceof a){var h=e;s.catalogId=h.getCatalogId();s.nameVisible=h.isNameVisible();s.nameXOffset=h.getNameXOffset();s.nameYOffset=h.getNameYOffset();s.nameAngle=h.getNameAngle();s.nameStyle=h.getNameStyle();s.visible=h.isVisible();s.widthInPlan=h.getWidthInPlan();s.depthInPlan=h.getDepthInPlan();s.heightInPlan=h.getHeightInPlan();s.modelCenteredAtOrigin=h.isModelCenteredAtOrigin();s.modelTransformations=h.getModelTransformations();s.angle=h.getAngle();s.pitch=h.getPitch();s.roll=h.getRoll();s.x=h.getX();s.y=h.getY();s.modelMirrored=h.isModelMirrored();s.texture=h.getTexture();s.shininess=h.getShininess();s.modelMaterials=h.getModelMaterials();var n=t!=null?t.slice(0):h.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=h.isContentProperty(k)?h.getContentProperty(k):h.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}else{if(e!=null&&e instanceof CatalogPieceOfFurniture){var f=e;s.catalogId=f.getId();var n=t!=null?t.slice(0):f.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=f.isContentProperty(k)?f.getContentProperty(k):f.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}s.visible=true;s.widthInPlan=s.width;s.depthInPlan=s.depth;s.heightInPlan=s.height;s.modelCenteredAtOrigin=true;s.x=s.width/2;s.y=s.depth/2}if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}}else{if(((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.PieceOfFurniture")>=0))||p===null)&&e===undefined&&o===undefined){var m=arguments;var w=m[0];var d=arguments;var r=a.EMPTY_PROPERTY_ARRAY_$LI$();var c=arguments;var v=HomeObject.createId("pieceOfFurniture");s=b.call(this,v)||this;if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}s.name=w.getName();s.description=w.getDescription();s.information=w.getInformation();s.creator=w.getCreator();s.license=w.getLicense();s.icon=w.getIcon();s.planIcon=w.getPlanIcon();s.model=w.getModel();s.modelSize=w.getModelSize();s.width=w.getWidth();s.depth=w.getDepth();s.height=w.getHeight();s.elevation=w.getElevation();s.dropOnTopElevation=w.getDropOnTopElevation();s.movable=w.isMovable();s.doorOrWindow=w.isDoorOrWindow();s.color=w.getColor();s.modelRotation=w.getModelRotation();s.staircaseCutOutShape=w.getStaircaseCutOutShape();s.modelFlags=w.getModelFlags();s.resizable=w.isResizable();s.deformable=w.isDeformable();s.texturable=w.isTexturable();s.horizontallyRotatable=w.isHorizontallyRotatable();s.price=w.getPrice();s.valueAddedTaxPercentage=w.getValueAddedTaxPercentage();s.currency=w.getCurrency();if(w!=null&&w instanceof a){var h=w;s.catalogId=h.getCatalogId();s.nameVisible=h.isNameVisible();s.nameXOffset=h.getNameXOffset();s.nameYOffset=h.getNameYOffset();s.nameAngle=h.getNameAngle();s.nameStyle=h.getNameStyle();s.visible=h.isVisible();s.widthInPlan=h.getWidthInPlan();s.depthInPlan=h.getDepthInPlan();s.heightInPlan=h.getHeightInPlan();s.modelCenteredAtOrigin=h.isModelCenteredAtOrigin();s.modelTransformations=h.getModelTransformations();s.angle=h.getAngle();s.pitch=h.getPitch();s.roll=h.getRoll();s.x=h.getX();s.y=h.getY();s.modelMirrored=h.isModelMirrored();s.texture=h.getTexture();s.shininess=h.getShininess();s.modelMaterials=h.getModelMaterials();var n=r!=null?r.slice(0):h.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=h.isContentProperty(k)?h.getContentProperty(k):h.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}else{if(w!=null&&w instanceof CatalogPieceOfFurniture){var f=w;s.catalogId=f.getId();var n=r!=null?r.slice(0):f.getPropertyNames();for(var l=0;l<n.length;l++){var k=n[l];var q=f.isContentProperty(k)?f.getContentProperty(k):f.getProperty(k);if(q!=null){s.setProperty$java_lang_String$java_lang_Object(k,q)}}}s.visible=true;s.widthInPlan=s.width;s.depthInPlan=s.depth;s.heightInPlan=s.height;s.modelCenteredAtOrigin=true;s.x=s.width/2;s.y=s.depth/2}if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}if(s.catalogId===undefined){s.catalogId=null}if(s.name===undefined){s.name=null}if(s.nameVisible===undefined){s.nameVisible=false}if(s.nameXOffset===undefined){s.nameXOffset=0}if(s.nameYOffset===undefined){s.nameYOffset=0}if(s.nameStyle===undefined){s.nameStyle=null}if(s.nameAngle===undefined){s.nameAngle=0}if(s.description===undefined){s.description=null}if(s.information===undefined){s.information=null}if(s.creator===undefined){s.creator=null}if(s.license===undefined){s.license=null}if(s.icon===undefined){s.icon=null}if(s.planIcon===undefined){s.planIcon=null}if(s.model===undefined){s.model=null}if(s.modelSize===undefined){s.modelSize=null}if(s.width===undefined){s.width=0}if(s.widthInPlan===undefined){s.widthInPlan=0}if(s.depth===undefined){s.depth=0}if(s.depthInPlan===undefined){s.depthInPlan=0}if(s.height===undefined){s.height=0}if(s.heightInPlan===undefined){s.heightInPlan=0}if(s.elevation===undefined){s.elevation=0}if(s.dropOnTopElevation===undefined){s.dropOnTopElevation=0}if(s.movable===undefined){s.movable=false}if(s.doorOrWindow===undefined){s.doorOrWindow=false}if(s.modelMaterials===undefined){s.modelMaterials=null}if(s.color===undefined){s.color=null}if(s.texture===undefined){s.texture=null}if(s.shininess===undefined){s.shininess=null}if(s.modelRotation===undefined){s.modelRotation=null}if(s.modelFlags===undefined){s.modelFlags=0}if(s.modelCenteredAtOrigin===undefined){s.modelCenteredAtOrigin=false}if(s.modelTransformations===undefined){s.modelTransformations=null}if(s.staircaseCutOutShape===undefined){s.staircaseCutOutShape=null}if(s.backFaceShown===undefined){s.backFaceShown=false}if(s.resizable===undefined){s.resizable=false}if(s.deformable===undefined){s.deformable=false}if(s.texturable===undefined){s.texturable=false}if(s.horizontallyRotatable===undefined){s.horizontallyRotatable=false}if(s.price===undefined){s.price=null}if(s.valueAddedTaxPercentage===undefined){s.valueAddedTaxPercentage=null}if(s.currency===undefined){s.currency=null}if(s.visible===undefined){s.visible=false}if(s.x===undefined){s.x=0}if(s.y===undefined){s.y=0}if(s.angle===undefined){s.angle=0}if(s.pitch===undefined){s.pitch=0}if(s.roll===undefined){s.roll=0}if(s.modelMirrored===undefined){s.modelMirrored=false}if(s.level===undefined){s.level=null}if(s.shapeCache===undefined){s.shapeCache=null}}else{throw new Error("invalid overload")}}}}return s}a.__static_initialize=function(){if(!a.__static_initialized){a.__static_initialized=true;a.__static_initializer_0()}};a.TWICE_PI_$LI$=function(){a.__static_initialize();if(a.TWICE_PI==null){a.TWICE_PI=2*Math.PI}return a.TWICE_PI};a.STRAIGHT_WALL_ANGLE_MARGIN_$LI$=function(){a.__static_initialize();if(a.STRAIGHT_WALL_ANGLE_MARGIN==null){a.STRAIGHT_WALL_ANGLE_MARGIN=(function(c){return c*Math.PI/180})(1)}return a.STRAIGHT_WALL_ANGLE_MARGIN};a.ROUND_WALL_ANGLE_MARGIN_$LI$=function(){a.__static_initialize();if(a.ROUND_WALL_ANGLE_MARGIN==null){a.ROUND_WALL_ANGLE_MARGIN=(function(c){return c*Math.PI/180})(10)}return a.ROUND_WALL_ANGLE_MARGIN};a.EMPTY_PROPERTY_ARRAY_$LI$=function(){a.__static_initialize();if(a.EMPTY_PROPERTY_ARRAY==null){a.EMPTY_PROPERTY_ARRAY=[]}return a.EMPTY_PROPERTY_ARRAY};a.SORTABLE_PROPERTY_COMPARATORS_$LI$=function(){a.__static_initialize();return a.SORTABLE_PROPERTY_COMPARATORS};a.__static_initializer_0=function(){var c={compare:function(e,d){return e.toString().localeCompare(d.toString())},equals:function(e,d){return e.toString().localeCompare(d.toString())===0}};a.SORTABLE_PROPERTY_COMPARATORS=({});(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"CATALOG_ID",new a.HomePieceOfFurniture$0(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"NAME",new a.HomePieceOfFurniture$1(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DESCRIPTION",new a.HomePieceOfFurniture$2(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"CREATOR",new a.HomePieceOfFurniture$3(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"LICENSE",new a.HomePieceOfFurniture$4(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"WIDTH",new a.HomePieceOfFurniture$5());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"HEIGHT",new a.HomePieceOfFurniture$6());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DEPTH",new a.HomePieceOfFurniture$7());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"MOVABLE",new a.HomePieceOfFurniture$8());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"DOOR_OR_WINDOW",new a.HomePieceOfFurniture$9());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"COLOR",new a.HomePieceOfFurniture$10());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"TEXTURE",new a.HomePieceOfFurniture$11(c));(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VISIBLE",new a.HomePieceOfFurniture$12());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"X",new a.HomePieceOfFurniture$13());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"Y",new a.HomePieceOfFurniture$14());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"ELEVATION",new a.HomePieceOfFurniture$15());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"ANGLE",new a.HomePieceOfFurniture$16());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"MODEL_SIZE",new a.HomePieceOfFurniture$17());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"LEVEL",new a.HomePieceOfFurniture$18());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"PRICE",new a.HomePieceOfFurniture$19());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VALUE_ADDED_TAX_PERCENTAGE",new a.HomePieceOfFurniture$20());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"VALUE_ADDED_TAX",new a.HomePieceOfFurniture$21());(function(d,f,e){if(d.entries==null){d.entries=[]}for(var g=0;g<d.entries.length;g++){if(d.entries[g].key==null&&f==null||d.entries[g].key.equals!=null&&d.entries[g].key.equals(f)||d.entries[g].key===f){d.entries[g].value=e;return}}d.entries.push({key:f,value:e,getKey:function(){return this.key},getValue:function(){return this.value}})})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),"PRICE_VALUE_ADDED_TAX_INCLUDED",new a.HomePieceOfFurniture$22())};a.compare$float$float=function(d,c){return(d-c)};a.compare$boolean$boolean=function(d,c){return d===c?0:(d?-1:1)};a.compare$java_math_BigDecimal$java_math_BigDecimal=function(d,c){if(d===c){return 0}else{if(d==null){return -1}else{if(c==null){return 1}else{return d.cmp(c)}}}};a.compare=function(d,c){if(((d!=null&&d instanceof Big)||d===null)&&((c!=null&&c instanceof Big)||c===null)){return a.compare$java_math_BigDecimal$java_math_BigDecimal(d,c)}else{if(((d!=null&&d instanceof Level)||d===null)&&((c!=null&&c instanceof Level)||c===null)){return a.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level(d,c)}else{if(((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return a.compare$float$float(d,c)}else{if(((typeof d==="boolean")||d===null)&&((typeof c==="boolean")||c===null)){return a.compare$boolean$boolean(d,c)}else{throw new Error("invalid overload")}}}}};a.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level=function(d,c){if(d===c){return 0}else{if(d==null){return -1}else{if(c==null){return 1}else{return(d.getElevation()-c.getElevation())}}}};a.getComparableModelSize=function(g){if(g!=null&&g instanceof HomeFurnitureGroup){var f=null;var h=g.getFurniture();for(var e=0;e<h.length;e++){var c=h[e];var d=a.getComparableModelSize(c);if(d!=null&&(f==null||f<d)){f=d}}return f}else{return g.modelSize}};a.prototype.getCatalogId=function(){return this.catalogId};a.prototype.setCatalogId=function(d){if(d!==this.catalogId&&(d==null||!(d===this.catalogId))){var c=this.catalogId;this.catalogId=d;this.firePropertyChange("CATALOG_ID",c,d)}};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.isNameVisible=function(){return this.nameVisible};a.prototype.setNameVisible=function(c){if(c!==this.nameVisible){this.nameVisible=c;this.firePropertyChange("NAME_VISIBLE",!c,c)}};a.prototype.getNameXOffset=function(){return this.nameXOffset};a.prototype.setNameXOffset=function(c){if(c!==this.nameXOffset){var d=this.nameXOffset;this.nameXOffset=c;this.firePropertyChange("NAME_X_OFFSET",d,c)}};a.prototype.getNameYOffset=function(){return this.nameYOffset};a.prototype.setNameYOffset=function(c){if(c!==this.nameYOffset){var d=this.nameYOffset;this.nameYOffset=c;this.firePropertyChange("NAME_Y_OFFSET",d,c)}};a.prototype.getNameStyle=function(){return this.nameStyle};a.prototype.setNameStyle=function(d){if(d!==this.nameStyle){var c=this.nameStyle;this.nameStyle=d;this.firePropertyChange("NAME_STYLE",c,d)}};a.prototype.getNameAngle=function(){return this.nameAngle};a.prototype.setNameAngle=function(c){c=((c%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(c!==this.nameAngle){var d=this.nameAngle;this.nameAngle=c;this.firePropertyChange("NAME_ANGLE",d,c)}};a.prototype.getDescription=function(){return this.description};a.prototype.setDescription=function(c){if(c!==this.description&&(c==null||!(c===this.description))){var d=this.description;this.description=c;this.firePropertyChange("DESCRIPTION",d,c)}};a.prototype.getInformation=function(){return this.information};a.prototype.setInformation=function(c){if(c!==this.information&&(c==null||!(c===this.information))){var d=this.information;this.information=c;this.firePropertyChange("INFORMATION",d,c)}};a.prototype.getCreator=function(){return this.creator};a.prototype.setCreator=function(d){if(d!==this.creator&&(d==null||!(d===this.creator))){var c=this.creator;this.creator=d;this.firePropertyChange("CREATOR",c,d)}};a.prototype.getLicense=function(){return this.license};a.prototype.setLicense=function(d){if(d!==this.license&&(d==null||!(d===this.license))){var c=this.license;this.license=d;this.firePropertyChange("LICENSE",c,d)}};a.prototype.getDepth=function(){return this.depth};a.prototype.setDepth=function(d){if(this.isResizable()){if(d!==this.depth){var c=this.depth;this.depth=d;this.shapeCache=null;this.firePropertyChange("DEPTH",c,d)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.getDepthInPlan=function(){return this.depthInPlan};a.prototype.setDepthInPlan=function(c){if(c!==this.depthInPlan){var d=this.depthInPlan;this.depthInPlan=c;this.shapeCache=null;this.firePropertyChange("DEPTH_IN_PLAN",d,c)}};a.prototype.getHeight=function(){return this.height};a.prototype.setHeight=function(c){if(this.isResizable()){if(c!==this.height){var d=this.height;this.height=c;this.firePropertyChange("HEIGHT",d,c)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.getHeightInPlan=function(){return this.heightInPlan};a.prototype.setHeightInPlan=function(c){if(c!==this.heightInPlan){var d=this.heightInPlan;this.heightInPlan=c;this.firePropertyChange("HEIGHT_IN_PLAN",d,c)}};a.prototype.getWidth=function(){return this.width};a.prototype.setWidth=function(d){if(this.isResizable()){if(d!==this.width){var c=this.width;this.width=d;this.shapeCache=null;this.firePropertyChange("WIDTH",c,d)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.getWidthInPlan=function(){return this.widthInPlan};a.prototype.setWidthInPlan=function(d){if(d!==this.widthInPlan){var c=this.widthInPlan;this.widthInPlan=d;this.shapeCache=null;this.firePropertyChange("WIDTH_IN_PLAN",c,d)}};a.prototype.scale=function(c){this.setWidth(this.getWidth()*c);this.setDepth(this.getDepth()*c);this.setHeight(this.getHeight()*c)};a.prototype.getElevation=function(){return this.elevation};a.prototype.getDropOnTopElevation=function(){return this.dropOnTopElevation};a.prototype.getGroundElevation=function(){if(this.level!=null){return this.elevation+this.level.getElevation()}else{return this.elevation}};a.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};a.prototype.isMovable=function(){return this.movable};a.prototype.setMovable=function(c){if(c!==this.movable){this.movable=c;this.firePropertyChange("MOVABLE",!c,c)}};a.prototype.isDoorOrWindow=function(){return this.doorOrWindow};a.prototype.getIcon=function(){return this.icon};a.prototype.setIcon=function(c){if(c!==this.icon&&(c==null||!(function(f,e){if(f&&f.equals){return f.equals(e)}else{return f===e}})(c,this.icon))){var d=this.icon;this.icon=c;this.firePropertyChange("ICON",d,c)}};a.prototype.getPlanIcon=function(){return this.planIcon};a.prototype.setPlanIcon=function(c){if(c!==this.planIcon&&(c==null||!(function(f,e){if(f&&f.equals){return f.equals(e)}else{return f===e}})(c,this.planIcon))){var d=this.planIcon;this.planIcon=c;this.firePropertyChange("PLAN_ICON",d,c)}};a.prototype.getModel=function(){return this.model};a.prototype.setModel=function(c){if(c!==this.model&&(c==null||!(function(f,e){if(f&&f.equals){return f.equals(e)}else{return f===e}})(c,this.model))){var d=this.model;this.model=c;this.firePropertyChange("MODEL",d,c)}};a.prototype.getModelSize=function(){return this.modelSize};a.prototype.setModelSize=function(c){this.modelSize=c};a.prototype.getModelMaterials=function(){if(this.modelMaterials!=null){return this.modelMaterials.slice(0)}else{return null}};a.prototype.setModelMaterials=function(d){if(this.isTexturable()){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.modelMaterials)){var c=this.modelMaterials;this.modelMaterials=d!=null?d.slice(0):null;this.firePropertyChange("MODEL_MATERIALS",c,d)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.getColor=function(){return this.color};a.prototype.setColor=function(c){if(this.isTexturable()){if(c!==this.color&&(c==null||!(c===this.color))){var d=this.color;this.color=c;this.firePropertyChange("COLOR",d,c)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.getTexture=function(){return this.texture};a.prototype.setTexture=function(d){if(this.isTexturable()){if(d!==this.texture&&(d==null||!d.equals(this.texture))){var c=this.texture;this.texture=d;this.firePropertyChange("TEXTURE",c,d)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.getShininess=function(){return this.shininess};a.prototype.setShininess=function(d){if(this.isTexturable()){if(d!==this.shininess&&(d==null||!(d===this.shininess))){var c=this.shininess;this.shininess=d;this.firePropertyChange("SHININESS",c,d)}}else{throw new IllegalStateException("Piece isn't texturable")}};a.prototype.isResizable=function(){return this.resizable};a.prototype.isDeformable=function(){return this.deformable};a.prototype.isWidthDepthDeformable=function(){return this.isDeformable()};a.prototype.isTexturable=function(){return this.texturable};a.prototype.isHorizontallyRotatable=function(){return this.horizontallyRotatable};a.prototype.getPrice=function(){return this.price};a.prototype.setPrice=function(d){if(d!==this.price&&(d==null||!((this.price)!=null?d.eq(this.price):(d===(this.price))))){var c=this.price;this.price=d;this.firePropertyChange("PRICE",c,d)}};a.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage};a.prototype.setValueAddedTaxPercentage=function(d){if(d!==this.valueAddedTaxPercentage&&(d==null||!((this.valueAddedTaxPercentage)!=null?d.eq(this.valueAddedTaxPercentage):(d===(this.valueAddedTaxPercentage))))){var c=this.valueAddedTaxPercentage;this.valueAddedTaxPercentage=d;this.firePropertyChange("VALUE_ADDED_TAX_PERCENTAGE",c,d)}};a.prototype.getValueAddedTax=function(){if(this.price!=null&&this.valueAddedTaxPercentage!=null){return this.price.times(this.valueAddedTaxPercentage).round(2)}else{return null}};a.prototype.getPriceValueAddedTaxIncluded=function(){if(this.price!=null&&this.valueAddedTaxPercentage!=null){return this.price.plus(this.getValueAddedTax())}else{return this.price}};a.prototype.getCurrency=function(){return this.currency};a.prototype.setCurrency=function(c){if(c!==this.currency&&(c==null||!(c===this.currency))){var d=this.currency;this.currency=c;this.firePropertyChange("CURRENCY",d,c)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(c){if(c!==this.visible){this.visible=c;this.firePropertyChange("VISIBLE",!c,c)}};a.prototype.getX=function(){return this.x};a.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.shapeCache=null;this.firePropertyChange("X",d,c)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.shapeCache=null;this.firePropertyChange("Y",c,d)}};a.prototype.getAngle=function(){return this.angle};a.prototype.setAngle=function(d){d=((d%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(d!==this.angle){var c=this.angle;this.angle=d;this.shapeCache=null;this.firePropertyChange("ANGLE",c,d)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setPitch=function(d){if(this.isHorizontallyRotatable()){d=((d%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(d!==this.pitch){var c=this.pitch;this.pitch=d;this.shapeCache=null;this.firePropertyChange("PITCH",c,d)}}else{throw new IllegalStateException("Piece can't be rotated around an horizontal axis")}};a.prototype.getRoll=function(){return this.roll};a.prototype.setRoll=function(c){if(this.isHorizontallyRotatable()){c=((c%a.TWICE_PI_$LI$()+a.TWICE_PI_$LI$())%a.TWICE_PI_$LI$());if(c!==this.roll){var d=this.roll;this.roll=c;this.shapeCache=null;this.firePropertyChange("ROLL",d,c)}}else{throw new IllegalStateException("Piece can't be rotated around an horizontal axis")}};a.prototype.isHorizontallyRotated=function(){return this.roll!==0||this.pitch!==0};a.prototype.getModelRotation=function(){return CatalogPieceOfFurniture.deepClone(this.modelRotation)};a.prototype.setModelRotation=function(c){if(!(JSON.stringify(c)===JSON.stringify(this.modelRotation))){var d=CatalogPieceOfFurniture.deepClone(this.modelRotation);this.modelRotation=CatalogPieceOfFurniture.deepClone(c);this.firePropertyChange("MODEL_ROTATION",d,c)}};a.prototype.isModelMirrored=function(){return this.modelMirrored};a.prototype.setModelMirrored=function(c){if(this.isResizable()){if(c!==this.modelMirrored){this.modelMirrored=c;this.firePropertyChange("MODEL_MIRRORED",!c,c)}}else{throw new IllegalStateException("Piece isn't resizable")}};a.prototype.isModelCenteredAtOrigin=function(){return this.modelCenteredAtOrigin};a.prototype.setModelCenteredAtOrigin=function(c){this.modelCenteredAtOrigin=c};a.prototype.isBackFaceShown=function(){return(this.modelFlags&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE};a.prototype.setBackFaceShown=function(c){this.setModelFlags((this.getModelFlags()&~PieceOfFurniture.SHOW_BACK_FACE)|(c?PieceOfFurniture.SHOW_BACK_FACE:0))};a.prototype.getModelFlags=function(){return this.modelFlags};a.prototype.setModelFlags=function(c){if(c!==this.modelFlags){var d=this.modelFlags;this.modelFlags=c;this.backFaceShown=(c&PieceOfFurniture.SHOW_BACK_FACE)===PieceOfFurniture.SHOW_BACK_FACE;this.firePropertyChange("MODEL_FLAGS",d,c)}};a.prototype.getModelTransformations=function(){if(this.modelTransformations!=null){return this.modelTransformations.slice(0)}else{return null}};a.prototype.setModelTransformations=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.modelTransformations)){var c=this.modelTransformations;this.modelTransformations=d!=null&&d.length>0?d.slice(0):null;this.firePropertyChange("MODEL_MATERIALS",c,d)}};a.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape};a.prototype.setStaircaseCutOutShape=function(d){if(d!==this.staircaseCutOutShape&&(d==null||!(d===this.staircaseCutOutShape))){var c=this.staircaseCutOutShape;this.staircaseCutOutShape=d;this.firePropertyChange("STAIRCASE_CUT_OUT_SHAPE",c,d)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(e){if(this.level===e){return true}else{if(this.level!=null&&e!=null){var c=this.level.getElevation();var d=e.getElevation();return c===d&&this.level.getElevationIndex()<e.getElevationIndex()||c<d&&this.isTopAtLevel(e)}else{return false}}};a.prototype.isTopAtLevel=function(d){var c=this.level.getElevation()+this.elevation+this.heightInPlan;if(this.staircaseCutOutShape!=null){return c>=d.getElevation()}else{return c>d.getElevation()}};a.prototype.getPoints=function(){var c=(function(g){var f=function(j){if(j.length===0){return 0}else{var k=[];for(var h=0;h<j[0];h++){k.push(f(j.slice(1)))}return k}};return f(g)})([4,2]);var e=this.getShape().getPathIterator(null);for(var d=0;d<c.length;d++){e.currentSegment(c[d]);e.next()}return c};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){if(d===0){return this.getShape().contains(c,e)}else{return this.getShape().intersects(c-d,e-d,2*d,2*d)}};a.prototype.isPointAt=function(d,h,f){var g=this.getPoints();for(var e=0;e<g.length;e++){var c=g[e];if(Math.abs(d-c[0])<=f&&Math.abs(h-c[1])<=f){return true}}return false};a.prototype.isTopLeftPointAt=function(d,g,f){var e=this.getPoints();var c=java.awt.geom.Point2D.distanceSq(d,g,e[0][0],e[0][1]);return c<=f*f&&c<java.awt.geom.Point2D.distanceSq(d,g,e[1][0],e[1][1])&&c<java.awt.geom.Point2D.distanceSq(d,g,e[3][0],e[3][1])};a.prototype.isTopRightPointAt=function(c,g,f){var d=this.getPoints();var e=java.awt.geom.Point2D.distanceSq(c,g,d[1][0],d[1][1]);return e<=f*f&&e<java.awt.geom.Point2D.distanceSq(c,g,d[0][0],d[0][1])&&e<java.awt.geom.Point2D.distanceSq(c,g,d[2][0],d[2][1])};a.prototype.isBottomLeftPointAt=function(c,g,f){var e=this.getPoints();var d=java.awt.geom.Point2D.distanceSq(c,g,e[3][0],e[3][1]);return d<=f*f&&d<java.awt.geom.Point2D.distanceSq(c,g,e[0][0],e[0][1])&&d<java.awt.geom.Point2D.distanceSq(c,g,e[2][0],e[2][1])};a.prototype.isBottomRightPointAt=function(c,g,f){var d=this.getPoints();var e=java.awt.geom.Point2D.distanceSq(c,g,d[2][0],d[2][1]);return e<=f*f&&e<java.awt.geom.Point2D.distanceSq(c,g,d[1][0],d[1][1])&&e<java.awt.geom.Point2D.distanceSq(c,g,d[3][0],d[3][1])};a.prototype.isNameCenterPointAt=function(c,e,d){return Math.abs(c-this.getX()-this.getNameXOffset())<=d&&Math.abs(e-this.getY()-this.getNameYOffset())<=d};a.prototype.isParallelToWall=function(d){if(d.getArcExtent()==null){var c=d.getYEnd()-d.getYStart();var e=d.getXEnd()-d.getXStart();if(e===0&&c===0){return false}else{var h=Math.atan2(c,e);var f=Math.abs(h-this.getAngle())%Math.PI;return f<=a.STRAIGHT_WALL_ANGLE_MARGIN_$LI$()||(Math.PI-f)<=a.STRAIGHT_WALL_ANGLE_MARGIN_$LI$()}}else{var g=Math.PI/2+Math.atan2(d.getYArcCircleCenter()-this.getY(),d.getXArcCircleCenter()-this.getX());var f=Math.abs(g-this.getAngle())%Math.PI;return f<=a.ROUND_WALL_ANGLE_MARGIN_$LI$()||(Math.PI-f)<=a.ROUND_WALL_ANGLE_MARGIN_$LI$()}};a.prototype.getShape=function(){if(this.shapeCache==null){var c=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getWidthInPlan()/2,this.getY()-this.getDepthInPlan()/2,this.getWidthInPlan(),this.getDepthInPlan());var d=java.awt.geom.AffineTransform.getRotateInstance(this.getAngle(),this.getX(),this.getY());var f=c.getPathIterator(d);var e=new java.awt.geom.GeneralPath();e.append(f,false);this.shapeCache=e}return this.shapeCache};a.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var e=Object.create(g);for(var f in g){if(g.hasOwnProperty(f)){e[f]=g[f]}}return e}})(this);c.level=null;return c};a.getFurnitureComparator=function(c){return((function(d){if(d==null||typeof d=="function"){return d}return function(f,e){return(d.compare?d.compare:d).call(d,f,e)}})((function(d,e){if(d.entries==null){d.entries=[]}for(var f=0;f<d.entries.length;f++){if(d.entries[f].key==null&&e==null||d.entries[f].key.equals!=null&&d.entries[f].key.equals(e)||d.entries[f].key===e){return d.entries[f].value}}return null})(a.SORTABLE_PROPERTY_COMPARATORS_$LI$(),c)))};a.__static_initialized=false;return a}(HomeObject));HomePieceOfFurniture.__class="com.eteks.sweethome3d.model.HomePieceOfFurniture";HomePieceOfFurniture.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"];(function(n){var m=(function(){function z(A){this.collator=A}z.prototype.compare=function(B,A){if(B.catalogId===A.catalogId){return 0}else{if(B.catalogId==null){return -1}else{if(A.catalogId==null){return 1}else{return this.collator.compare(B.catalogId,A.catalogId)}}}};return z}());n.HomePieceOfFurniture$0=m;var l=(function(){function z(A){this.collator=A}z.prototype.compare=function(B,A){if(B.name===A.name){return 0}else{if(B.name==null){return -1}else{if(A.name==null){return 1}else{return this.collator.compare(B.name,A.name)}}}};return z}());n.HomePieceOfFurniture$1=l;var k=(function(){function z(A){this.collator=A}z.prototype.compare=function(B,A){if(B.description===A.description){return 0}else{if(B.description==null){return -1}else{if(A.description==null){return 1}else{return this.collator.compare(B.description,A.description)}}}};return z}());n.HomePieceOfFurniture$2=k;var j=(function(){function z(A){this.collator=A}z.prototype.compare=function(B,A){if(B.creator===A.creator){return 0}else{if(B.creator==null){return -1}else{if(A.creator==null){return 1}else{return this.collator.compare(B.creator,A.creator)}}}};return z}());n.HomePieceOfFurniture$3=j;var h=(function(){function z(A){this.collator=A}z.prototype.compare=function(B,A){if(B.license===A.license){return 0}else{if(B.license==null){return -1}else{if(A.license==null){return 1}else{return this.collator.compare(B.license,A.license)}}}};return z}());n.HomePieceOfFurniture$4=h;var g=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$float$float(B.width,A.width)};return z}());n.HomePieceOfFurniture$5=g;var f=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$float$float(B.height,A.height)};return z}());n.HomePieceOfFurniture$6=f;var e=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$float$float(B.depth,A.depth)};return z}());n.HomePieceOfFurniture$7=e;var c=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$boolean$boolean(B.movable,A.movable)};return z}());n.HomePieceOfFurniture$8=c;var a=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$boolean$boolean(B.doorOrWindow,A.doorOrWindow)};return z}());n.HomePieceOfFurniture$9=a;var d=(function(){function z(){}z.prototype.compare=function(B,A){if(B.color===A.color){return 0}else{if(B.color==null){return -1}else{if(A.color==null){return 1}else{return B.color-A.color}}}};return z}());n.HomePieceOfFurniture$10=d;var b=(function(){function z(A){this.collator=A}z.prototype.compare=function(B,A){if(B.texture===A.texture){return 0}else{if(B.texture==null){return -1}else{if(A.texture==null){return 1}else{return this.collator.compare(B.texture.getName(),A.texture.getName())}}}};return z}());n.HomePieceOfFurniture$11=b;var y=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$boolean$boolean(B.visible,A.visible)};return z}());n.HomePieceOfFurniture$12=y;var x=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$float$float(B.x,A.x)};return z}());n.HomePieceOfFurniture$13=x;var w=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$float$float(B.y,A.y)};return z}());n.HomePieceOfFurniture$14=w;var v=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$float$float(B.elevation,A.elevation)};return z}());n.HomePieceOfFurniture$15=v;var u=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$float$float(B.angle,A.angle)};return z}());n.HomePieceOfFurniture$16=u;var t=(function(){function z(){}z.prototype.compare=function(D,C){var B=n.getComparableModelSize(D);var A=n.getComparableModelSize(C);if(B===A){return 0}else{if(B==null){return -1}else{if(A==null){return 1}else{return B<A?-1:(B===A?0:1)}}}};return z}());n.HomePieceOfFurniture$17=t;var s=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$com_eteks_sweethome3d_model_Level$com_eteks_sweethome3d_model_Level(B.getLevel(),A.getLevel())};return z}());n.HomePieceOfFurniture$18=s;var r=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$java_math_BigDecimal$java_math_BigDecimal(B.price,A.price)};return z}());n.HomePieceOfFurniture$19=r;var q=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$java_math_BigDecimal$java_math_BigDecimal(B.valueAddedTaxPercentage,A.valueAddedTaxPercentage)};return z}());n.HomePieceOfFurniture$20=q;var p=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$java_math_BigDecimal$java_math_BigDecimal(B.getValueAddedTax(),A.getValueAddedTax())};return z}());n.HomePieceOfFurniture$21=p;var o=(function(){function z(){}z.prototype.compare=function(B,A){return n.compare$java_math_BigDecimal$java_math_BigDecimal(B.getPriceValueAddedTaxIncluded(),A.getPriceValueAddedTaxIncluded())};return z}());n.HomePieceOfFurniture$22=o})(HomePieceOfFurniture||(HomePieceOfFurniture={}));HomePieceOfFurniture.__transients=["shapeCache","propertyChangeSupport"];var Compass=(function(b){__extends(a,b);function a(d,l,k,n){var g=this;if(((typeof d==="string")||d===null)&&((typeof l==="number")||l===null)&&((typeof k==="number")||k===null)&&((typeof n==="number")||n===null)){var h=arguments;g=b.call(this,d)||this;if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.diameter===undefined){g.diameter=0}if(g.visible===undefined){g.visible=false}if(g.northDirection===undefined){g.northDirection=0}if(g.latitude===undefined){g.latitude=0}if(g.longitude===undefined){g.longitude=0}if(g.timeZone===undefined){g.timeZone=null}if(g.pointsCache===undefined){g.pointsCache=null}if(g.dateCache===undefined){g.dateCache=null}if(g.sunElevationCache===undefined){g.sunElevationCache=0}if(g.sunAzimuthCache===undefined){g.sunAzimuthCache=0}g.x=l;g.y=k;g.diameter=n;g.visible=true;g.timeZone="UTC";g.initGeographicPoint()}else{if(((typeof d==="number")||d===null)&&((typeof l==="number")||l===null)&&((typeof k==="number")||k===null)&&n===undefined){var h=arguments;var m=h[0];var c=h[1];var f=h[2];var j=arguments;var e=HomeObject.createId("compass");g=b.call(this,e)||this;if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.diameter===undefined){g.diameter=0}if(g.visible===undefined){g.visible=false}if(g.northDirection===undefined){g.northDirection=0}if(g.latitude===undefined){g.latitude=0}if(g.longitude===undefined){g.longitude=0}if(g.timeZone===undefined){g.timeZone=null}if(g.pointsCache===undefined){g.pointsCache=null}if(g.dateCache===undefined){g.dateCache=null}if(g.sunElevationCache===undefined){g.sunElevationCache=0}if(g.sunAzimuthCache===undefined){g.sunAzimuthCache=0}g.x=m;g.y=c;g.diameter=f;g.visible=true;g.timeZone="UTC";g.initGeographicPoint();if(g.x===undefined){g.x=0}if(g.y===undefined){g.y=0}if(g.diameter===undefined){g.diameter=0}if(g.visible===undefined){g.visible=false}if(g.northDirection===undefined){g.northDirection=0}if(g.latitude===undefined){g.latitude=0}if(g.longitude===undefined){g.longitude=0}if(g.timeZone===undefined){g.timeZone=null}if(g.pointsCache===undefined){g.pointsCache=null}if(g.dateCache===undefined){g.dateCache=null}if(g.sunElevationCache===undefined){g.sunElevationCache=0}if(g.sunAzimuthCache===undefined){g.sunAzimuthCache=0}}else{throw new Error("invalid overload")}}return g}a.prototype.getX=function(){return this.x};a.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.pointsCache=null;this.firePropertyChange("X",d,c)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.pointsCache=null;this.firePropertyChange("Y",c,d)}};a.prototype.getDiameter=function(){return this.diameter};a.prototype.setDiameter=function(c){if(c!==this.diameter){var d=this.diameter;this.diameter=c;this.pointsCache=null;this.firePropertyChange("DIAMETER",d,c)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(c){if(c!==this.visible){this.visible=c;this.firePropertyChange("VISIBLE",!c,c)}};a.prototype.getNorthDirection=function(){return this.northDirection};a.prototype.setNorthDirection=function(d){if(d!==this.northDirection){var c=this.northDirection;this.northDirection=d;this.pointsCache=null;this.firePropertyChange("NORTH_DIRECTION",c,d)}};a.prototype.getLatitude=function(){return this.latitude};a.prototype.setLatitude=function(d){if(d!==this.latitude){var c=this.latitude;this.latitude=d;this.dateCache=null;this.firePropertyChange("LATITUDE",c,d)}};a.prototype.getLongitude=function(){return this.longitude};a.prototype.setLongitude=function(d){if(d!==this.longitude){var c=this.longitude;this.longitude=d;this.dateCache=null;this.firePropertyChange("LONGITUDE",c,d)}};a.prototype.getTimeZone=function(){return this.timeZone};a.prototype.setTimeZone=function(c){if(!(this.timeZone===c)){if(c==null){throw new IllegalArgumentException("Time zone ID can't be null")}var d=this.timeZone;this.timeZone=c;this.dateCache=null;this.firePropertyChange("TIME_ZONE",d,c)}};a.prototype.getPoints=function(){if(this.pointsCache==null){var c=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter());var e=java.awt.geom.AffineTransform.getRotateInstance(this.getNorthDirection(),this.getX(),this.getY());this.pointsCache=(function(h){var g=function(k){if(k.length===0){return 0}else{var l=[];for(var j=0;j<k[0];j++){l.push(g(k.slice(1)))}return l}};return g(h)})([4,2]);var f=c.getPathIterator(e);for(var d=0;d<this.pointsCache.length;d++){f.currentSegment(this.pointsCache[d]);f.next()}}return[this.pointsCache[0].slice(0),this.pointsCache[1].slice(0),this.pointsCache[2].slice(0),this.pointsCache[3].slice(0)]};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return new java.awt.geom.Ellipse2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter()).intersects(d)};a.prototype.containsPoint=function(c,f,e){var d=new java.awt.geom.Ellipse2D.Float(this.getX()-this.getDiameter()/2,this.getY()-this.getDiameter()/2,this.getDiameter(),this.getDiameter());if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};a.prototype.computeJulianDay=function(j,h,l,f,e,c,n,g){var o=l+f/24+e/1440+c/86400;if(h===1||h===2){j-=1;h+=12}var m=(j/100|0);var k=2-m+(m/4|0);var d=((365.25*(j+4716))|0)+(((30.6001*(h+1)))|0)+o+k-1524.5;d-=(n+g)/24;d-=2451545;return d};a.prototype.toSiderealTime=function(c){var d=c/36525;var e=(24110.54841+(8640184.812866*d)+(0.093104*Math.pow(d,2))-(0.0000062*Math.pow(d,3)))/3600;return((e/24)-((e/24)|0))*24};a.prototype.initGeographicPoint=function(){var z;if(a.timeZoneGeographicPointsReference!=null){z=a.timeZoneGeographicPointsReference}else{z=null}if(z==null){z=({});var g=new a.GeographicPoint(-13.833333,-171.73334);(z["Etc/GMT+11"]=g);(z["Pacific/Apia"]=g);(z["Pacific/Midway"]=new a.GeographicPoint(28.2,-177.35));(z["Pacific/Niue"]=new a.GeographicPoint(-19.055,-169.92));(z["Pacific/Pago_Pago"]=new a.GeographicPoint(-14.278055,-170.7025));(z["Pacific/Samoa"]=g);(z["US/Samoa"]=g);(z["America/Adak"]=new a.GeographicPoint(51.88,-176.65805));(z["America/Atka"]=new a.GeographicPoint(52.19611,-174.20056));var B=new a.GeographicPoint(21.306944,-157.85834);(z["Etc/GMT+10"]=B);(z["Pacific/Fakaofo"]=new a.GeographicPoint(-9.3653,-171.215));(z["Pacific/Honolulu"]=B);(z["Pacific/Johnston"]=new a.GeographicPoint(16.75,-169.517));(z["Pacific/Rarotonga"]=new a.GeographicPoint(-21.233,-159.783));(z["Pacific/Tahiti"]=new a.GeographicPoint(-17.533333,-149.56667));(z["SystemV/HST10"]=B);(z["US/Aleutian"]=new a.GeographicPoint(54.817,164.033));(z["US/Hawaii"]=B);(z["Pacific/Marquesas"]=new a.GeographicPoint(-9.45,-139.38));var s=new a.GeographicPoint(61.218056,-149.90028);(z["America/Anchorage"]=s);(z["America/Juneau"]=new a.GeographicPoint(58.301945,-134.41972));(z["America/Nome"]=new a.GeographicPoint(64.501114,-165.40639));(z["America/Yakutat"]=new a.GeographicPoint(59.546944,-139.72722));(z["Etc/GMT+9"]=s);(z["Pacific/Gambier"]=new a.GeographicPoint(-23.1178,-134.97));(z["SystemV/YST9"]=s);(z["SystemV/YST9YDT"]=s);(z["US/Alaska"]=s);(z["America/Dawson"]=new a.GeographicPoint(64.066666,-139.41667));(z["America/Ensenada"]=new a.GeographicPoint(31.866667,-116.61667));var f=new a.GeographicPoint(34.052223,-118.242775);(z["America/Los_Angeles"]=f);(z["America/Santa_Isabel"]=new a.GeographicPoint(28.383333,-113.35));(z["America/Tijuana"]=new a.GeographicPoint(32.533333,-117.01667));(z["America/Vancouver"]=new a.GeographicPoint(49.25,-123.13333));(z["America/Whitehorse"]=new a.GeographicPoint(60.716667,-135.05));(z["Canada/Pacific"]=new a.GeographicPoint(49.25,-123.13333));(z["Canada/Yukon"]=new a.GeographicPoint(60.716667,-135.05));(z["Etc/GMT+8"]=f);(z["Mexico/BajaNorte"]=new a.GeographicPoint(32.533333,-117.01667));(z["Pacific/Pitcairn"]=new a.GeographicPoint(-25.0667,-130.1));(z["SystemV/PST8"]=f);(z["SystemV/PST8PDT"]=f);(z["US/Pacific"]=f);(z["US/Pacific-New"]=f);(z["America/Boise"]=new a.GeographicPoint(43.61361,-116.2025));(z["America/Cambridge_Bay"]=new a.GeographicPoint(69.11667,-105.03333));(z["America/Chihuahua"]=new a.GeographicPoint(28.633333,-106.083336));(z["America/Dawson_Creek"]=new a.GeographicPoint(55.766666,-120.23333));var l=new a.GeographicPoint(39.739166,-104.98417);(z["America/Denver"]=l);(z["America/Edmonton"]=new a.GeographicPoint(53.55,-113.5));(z["America/Hermosillo"]=new a.GeographicPoint(29.066668,-110.96667));(z["America/Inuvik"]=new a.GeographicPoint(68.35,-133.7));(z["America/Mazatlan"]=new a.GeographicPoint(23.216667,-106.416664));(z["America/Ojinaga"]=new a.GeographicPoint(29.566668,-104.416664));(z["America/Phoenix"]=new a.GeographicPoint(33.448334,-112.07333));(z["America/Shiprock"]=new a.GeographicPoint(36.785557,-108.686386));(z["America/Yellowknife"]=new a.GeographicPoint(62.45,-114.35));(z["Canada/Mountain"]=new a.GeographicPoint(53.55,-113.5));(z["Etc/GMT+7"]=l);(z["Mexico/BajaSur"]=new a.GeographicPoint(32.567,-116.633));(z["SystemV/MST7"]=l);(z["SystemV/MST7MDT"]=l);(z["US/Arizona"]=new a.GeographicPoint(33.448334,-112.07333));(z["US/Mountain"]=l);(z["America/Belize"]=new a.GeographicPoint(17.483334,-88.183334));(z["America/Cancun"]=new a.GeographicPoint(21.166668,-86.833336));var x=new a.GeographicPoint(41.85,-87.65);(z["America/Chicago"]=x);(z["America/Costa_Rica"]=new a.GeographicPoint(9.933333,-84.083336));(z["America/El_Salvador"]=new a.GeographicPoint(13.7086115,-89.20306));(z["America/Guatemala"]=new a.GeographicPoint(14.621111,-90.52695));(z["America/Knox_IN"]=new a.GeographicPoint(41.295834,-86.625));(z["America/Managua"]=new a.GeographicPoint(12.150833,-86.26833));(z["America/Matamoros"]=new a.GeographicPoint(25.883333,-97.5));(z["America/Menominee"]=new a.GeographicPoint(45.107777,-87.61417));(z["America/Merida"]=new a.GeographicPoint(20.966667,-89.61667));(z["America/Mexico_City"]=new a.GeographicPoint(19.434168,-99.13861));(z["America/Monterrey"]=new a.GeographicPoint(25.666668,-100.316666));(z["America/Rainy_River"]=new a.GeographicPoint(48.716667,-94.566666));(z["America/Rankin_Inlet"]=new a.GeographicPoint(62.816666,-92.083336));(z["America/Regina"]=new a.GeographicPoint(50.45,-104.61667));(z["America/Swift_Current"]=new a.GeographicPoint(50.283333,-107.76667));(z["America/Tegucigalpa"]=new a.GeographicPoint(14.1,-87.21667));(z["America/Winnipeg"]=new a.GeographicPoint(49.88333,-97.166664));(z["Canada/Central"]=new a.GeographicPoint(50.45,-104.61667));(z["Canada/East-Saskatchewan"]=new a.GeographicPoint(51.216667,-102.46667));(z["Canada/Saskatchewan"]=new a.GeographicPoint(50.45,-104.61667));(z["Chile/EasterIsland"]=new a.GeographicPoint(-27.15,-109.425));(z["Etc/GMT+6"]=x);(z["Mexico/General"]=new a.GeographicPoint(19.434168,-99.13861));(z["Pacific/Easter"]=new a.GeographicPoint(-27.15,-109.425));(z["Pacific/Galapagos"]=new a.GeographicPoint(-0.667,-90.55));(z["SystemV/CST6"]=x);(z["SystemV/CST6CDT"]=x);(z["US/Central"]=x);(z["US/Indiana-Starke"]=new a.GeographicPoint(41.295834,-86.625));(z["America/Atikokan"]=new a.GeographicPoint(48.75,-91.61667));(z["America/Bogota"]=new a.GeographicPoint(4.6,-74.083336));(z["America/Cayman"]=new a.GeographicPoint(19.3,-81.38333));(z["America/Coral_Harbour"]=new a.GeographicPoint(64.13333,-83.166664));(z["America/Detroit"]=new a.GeographicPoint(42.33139,-83.04583));(z["America/Fort_Wayne"]=new a.GeographicPoint(41.130554,-85.12889));(z["America/Grand_Turk"]=new a.GeographicPoint(21.466667,-71.13333));(z["America/Guayaquil"]=new a.GeographicPoint(-2.1666667,-79.9));(z["America/Havana"]=new a.GeographicPoint(23.131945,-82.36417));(z["America/Indianapolis"]=new a.GeographicPoint(39.768333,-86.15806));(z["America/Iqaluit"]=new a.GeographicPoint(63.733334,-68.5));(z["America/Jamaica"]=new a.GeographicPoint(18,-76.8));(z["America/Lima"]=new a.GeographicPoint(-12.05,-77.05));(z["America/Louisville"]=new a.GeographicPoint(38.254166,-85.759445));(z["America/Montreal"]=new a.GeographicPoint(45.5,-73.583336));(z["America/Nassau"]=new a.GeographicPoint(25.083334,-77.35));var p=new a.GeographicPoint(40.71417,-74.006386);(z["America/New_York"]=p);(z["America/Nipigon"]=new a.GeographicPoint(49.016666,-88.25));(z["America/Panama"]=new a.GeographicPoint(8.966667,-79.53333));(z["America/Pangnirtung"]=new a.GeographicPoint(66.13333,-65.75));(z["America/Port-au-Prince"]=new a.GeographicPoint(18.539167,-72.335));(z["America/Resolute"]=new a.GeographicPoint(74.683334,-94.9));(z["America/Thunder_Bay"]=new a.GeographicPoint(48.4,-89.23333));(z["America/Toronto"]=new a.GeographicPoint(43.666668,-79.416664));(z["Canada/Eastern"]=new a.GeographicPoint(43.666668,-79.416664));(z["Etc/GMT+5"]=p);(z["SystemV/EST5"]=p);(z["SystemV/EST5EDT"]=p);(z["US/East-Indiana"]=new a.GeographicPoint(36.8381,-84.85));(z["US/Eastern"]=p);(z["US/Michigan"]=new a.GeographicPoint(42.33139,-83.04583));(z["America/Caracas"]=new a.GeographicPoint(10.5,-66.916664));(z["America/Anguilla"]=new a.GeographicPoint(18.216667,-63.05));(z["America/Antigua"]=new a.GeographicPoint(17.116667,-61.85));(z["America/Aruba"]=new a.GeographicPoint(10.541111,-72.9175));(z["America/Asuncion"]=new a.GeographicPoint(-25.266666,-57.666668));(z["America/Barbados"]=new a.GeographicPoint(13.1,-59.616665));(z["America/Blanc-Sablon"]=new a.GeographicPoint(51.433334,-57.11667));(z["America/Boa_Vista"]=new a.GeographicPoint(2.8166666,-60.666668));(z["America/Campo_Grande"]=new a.GeographicPoint(-20.45,-54.616665));(z["America/Cuiaba"]=new a.GeographicPoint(-15.583333,-56.083332));(z["America/Curacao"]=new a.GeographicPoint(12.1167,-68.933));(z["America/Dominica"]=new a.GeographicPoint(15.3,-61.4));(z["America/Eirunepe"]=new a.GeographicPoint(-6.6666665,-69.86667));(z["America/Glace_Bay"]=new a.GeographicPoint(46.2,-59.966667));(z["America/Goose_Bay"]=new a.GeographicPoint(53.333332,-60.416668));(z["America/Grenada"]=new a.GeographicPoint(12.05,-61.75));(z["America/Guadeloupe"]=new a.GeographicPoint(16.233334,-61.516666));(z["America/Guyana"]=new a.GeographicPoint(6.8,-58.166668));(z["America/Halifax"]=new a.GeographicPoint(44.65,-63.6));(z["America/La_Paz"]=new a.GeographicPoint(-16.5,-68.15));(z["America/Manaus"]=new a.GeographicPoint(-3.1133332,-60.025276));(z["America/Marigot"]=new a.GeographicPoint(18.073,63.0844));(z["America/Martinique"]=new a.GeographicPoint(14.6,-61.083332));(z["America/Moncton"]=new a.GeographicPoint(46.083332,-64.76667));(z["America/Montserrat"]=new a.GeographicPoint(16.7,-62.216667));(z["America/Port_of_Spain"]=new a.GeographicPoint(10.65,-61.516666));(z["America/Porto_Acre"]=new a.GeographicPoint(-9.587778,-67.53555));(z["America/Porto_Velho"]=new a.GeographicPoint(-8.766666,-63.9));(z["America/Puerto_Rico"]=new a.GeographicPoint(18.467,66.117));(z["America/Rio_Branco"]=new a.GeographicPoint(-9.966667,-67.8));var m=new a.GeographicPoint(-33.45,-70.666664);(z["America/Santiago"]=m);(z["America/Santo_Domingo"]=new a.GeographicPoint(18.466667,-69.9));(z["America/St_Barthelemy"]=new a.GeographicPoint(17.8978,-62.851));(z["America/St_Kitts"]=new a.GeographicPoint(17.3,-62.733));(z["America/St_Lucia"]=new a.GeographicPoint(14.0167,-60.9833));(z["America/St_Thomas"]=new a.GeographicPoint(18.3333,-64.9167));(z["America/St_Vincent"]=new a.GeographicPoint(13.1667,-61.2333));(z["America/Thule"]=new a.GeographicPoint(-54.27667,-36.511665));(z["America/Tortola"]=new a.GeographicPoint(18.416666,-64.61667));(z["America/Virgin"]=new a.GeographicPoint(18.34389,-64.931114));(z["Antarctica/Palmer"]=new a.GeographicPoint(-64.25,-62.833));(z["Atlantic/Bermuda"]=new a.GeographicPoint(32.294167,-64.78389));(z["Atlantic/Stanley"]=new a.GeographicPoint(-51.7,-57.85));(z["Brazil/Acre"]=new a.GeographicPoint(-10.883333,-45.083332));(z["Brazil/West"]=new a.GeographicPoint(-10.883333,-45.083332));(z["Canada/Atlantic"]=new a.GeographicPoint(44.65,-63.6));(z["Chile/Continental"]=m);(z["Etc/GMT+4"]=m);(z["SystemV/AST4"]=new a.GeographicPoint(44.65,-63.6));(z["SystemV/AST4ADT"]=new a.GeographicPoint(44.65,-63.6));(z["America/St_Johns"]=new a.GeographicPoint(47.5675,-52.7072));(z["Canada/Newfoundland"]=new a.GeographicPoint(47.5675,-52.7072));(z["America/Araguaina"]=new a.GeographicPoint(-7.16,-48.0575));(z["America/Bahia"]=new a.GeographicPoint(-12.983334,-38.516666));(z["America/Belem"]=new a.GeographicPoint(-1.45,-48.483334));(z["America/Buenos_Aires"]=new a.GeographicPoint(-34.5875,-58.6725));(z["America/Catamarca"]=new a.GeographicPoint(-28.466667,-65.78333));(z["America/Cayenne"]=new a.GeographicPoint(4.9333334,-52.333332));(z["America/Cordoba"]=new a.GeographicPoint(-31.4,-64.183334));(z["America/Fortaleza"]=new a.GeographicPoint(-3.7166667,-38.5));(z["America/Godthab"]=new a.GeographicPoint(64.183334,-51.75));(z["America/Jujuy"]=new a.GeographicPoint(-24.183332,-65.3));(z["America/Maceio"]=new a.GeographicPoint(-9.666667,-35.716667));(z["America/Mendoza"]=new a.GeographicPoint(-32.883335,-68.816666));(z["America/Miquelon"]=new a.GeographicPoint(47.0975,-56.38139));(z["America/Montevideo"]=new a.GeographicPoint(-34.858055,-56.170834));(z["America/Paramaribo"]=new a.GeographicPoint(5.8333335,-55.166668));(z["America/Recife"]=new a.GeographicPoint(-8.05,-34.9));(z["America/Rosario"]=new a.GeographicPoint(-32.95111,-60.66639));(z["America/Santarem"]=new a.GeographicPoint(-2.4333334,-54.7));var y=new a.GeographicPoint(-23.533333,-46.616665);(z["America/Sao_Paulo"]=y);(z["Antarctica/Rothera"]=new a.GeographicPoint(67.567,68.133));(z["Brazil/East"]=y);(z["Etc/GMT+3"]=y);(z["America/Noronha"]=new a.GeographicPoint(3.85,25.417));var D=new a.GeographicPoint(54.25,36.75);(z["Atlantic/South_Georgia"]=D);(z["Brazil/DeNoronha"]=new a.GeographicPoint(3.85,25.417));(z["Etc/GMT+2"]=D);(z["America/Scoresbysund"]=new a.GeographicPoint(70.48333,-21.966667));var v=new a.GeographicPoint(37.483334,-2.5666666);(z["Atlantic/Azores"]=v);(z["Atlantic/Cape_Verde"]=new a.GeographicPoint(14.916667,-23.516666));(z["Etc/GMT+1"]=v);(z["Africa/Abidjan"]=new a.GeographicPoint(5.341111,-4.028056));(z["Africa/Accra"]=new a.GeographicPoint(5.55,-0.2166667));(z["Africa/Bamako"]=new a.GeographicPoint(12.65,-8));(z["Africa/Banjul"]=new a.GeographicPoint(13.453055,-16.5775));(z["Africa/Bissau"]=new a.GeographicPoint(11.85,-15.583333));(z["Africa/Casablanca"]=new a.GeographicPoint(33.593056,-7.616389));(z["Africa/Conakry"]=new a.GeographicPoint(9.509167,-13.712222));(z["Africa/Dakar"]=new a.GeographicPoint(14.670834,-17.438055));(z["Africa/El_Aaiun"]=new a.GeographicPoint(27.15361,-13.203333));(z["Africa/Freetown"]=new a.GeographicPoint(8.49,-13.234167));(z["Africa/Lome"]=new a.GeographicPoint(6.131944,1.2227778));(z["Africa/Monrovia"]=new a.GeographicPoint(6.3105555,-10.804722));(z["Africa/Nouakchott"]=new a.GeographicPoint(18.08639,-15.975278));(z["Africa/Ouagadougou"]=new a.GeographicPoint(12.370277,-1.5247222));(z["Africa/Sao_Tome"]=new a.GeographicPoint(0.3333333,6.733333));(z["Africa/Timbuktu"]=new a.GeographicPoint(16.766666,-3.0166667));(z["America/Danmarkshavn"]=new a.GeographicPoint(76.767,18.667));(z["Atlantic/Canary"]=new a.GeographicPoint(28.45,-16.233334));(z["Atlantic/Faeroe"]=new a.GeographicPoint(62.016666,-6.766667));(z["Atlantic/Faroe"]=new a.GeographicPoint(62.016666,-6.766667));(z["Atlantic/Madeira"]=new a.GeographicPoint(32.633335,-16.9));(z["Atlantic/Reykjavik"]=new a.GeographicPoint(64.15,-21.95));(z["Atlantic/St_Helena"]=new a.GeographicPoint(-15.933333,-5.7166667));var r=new a.GeographicPoint(51.466667,0);(z["Etc/GMT"]=r);(z["Etc/GMT+0"]=r);(z["Etc/GMT-0"]=r);(z["Etc/GMT0"]=r);(z["Etc/Greenwich"]=r);(z["Etc/UCT"]=r);(z["Etc/UTC"]=r);(z["Etc/Universal"]=r);(z["Etc/Zulu"]=r);(z["Europe/Belfast"]=new a.GeographicPoint(54.583332,-5.933333));(z["Europe/Dublin"]=new a.GeographicPoint(53.333057,-6.248889));(z["Europe/Guernsey"]=new a.GeographicPoint(49.45,-2.533));(z["Europe/Isle_of_Man"]=new a.GeographicPoint(54.14521,-4.48172));(z["Europe/Jersey"]=new a.GeographicPoint(49.2,-2.117));(z["Europe/Lisbon"]=new a.GeographicPoint(38.716667,-9.133333));(z["Europe/London"]=new a.GeographicPoint(51.5,-0.116667));(z["Africa/Algiers"]=new a.GeographicPoint(36.763054,3.0505557));(z["Africa/Bangui"]=new a.GeographicPoint(4.366667,18.583334));(z["Africa/Brazzaville"]=new a.GeographicPoint(-4.2591667,15.284722));(z["Africa/Ceuta"]=new a.GeographicPoint(35.890278,-5.3075));(z["Africa/Douala"]=new a.GeographicPoint(4.0502777,9.7));(z["Africa/Kinshasa"]=new a.GeographicPoint(-4.3,15.3));(z["Africa/Lagos"]=new a.GeographicPoint(6.4530554,3.3958333));(z["Africa/Libreville"]=new a.GeographicPoint(0.3833333,9.45));(z["Africa/Luanda"]=new a.GeographicPoint(-8.838333,13.234445));(z["Africa/Malabo"]=new a.GeographicPoint(3.75,8.783333));(z["Africa/Ndjamena"]=new a.GeographicPoint(12.113055,15.049167));(z["Africa/Niamey"]=new a.GeographicPoint(13.516666,2.1166668));(z["Africa/Porto-Novo"]=new a.GeographicPoint(6.483333,2.6166668));(z["Africa/Tunis"]=new a.GeographicPoint(36.802776,10.179722));(z["Africa/Windhoek"]=new a.GeographicPoint(-22.57,17.08361));(z["Arctic/Longyearbyen"]=new a.GeographicPoint(78.21667,15.633333));(z["Atlantic/Jan_Mayen"]=new a.GeographicPoint(71,-8.333));var C=new a.GeographicPoint(48.86667,2.333333);(z["Etc/GMT-1"]=C);(z["Europe/Amsterdam"]=new a.GeographicPoint(52.35,4.9166665));(z["Europe/Andorra"]=new a.GeographicPoint(42.5,1.5166667));(z["Europe/Belgrade"]=new a.GeographicPoint(44.81861,20.468056));(z["Europe/Berlin"]=new a.GeographicPoint(52.516666,13.4));(z["Europe/Bratislava"]=new a.GeographicPoint(48.15,17.116667));(z["Europe/Brussels"]=new a.GeographicPoint(50.833332,4.333333));(z["Europe/Budapest"]=new a.GeographicPoint(47.5,19.083334));(z["Europe/Copenhagen"]=new a.GeographicPoint(55.666668,12.583333));(z["Europe/Gibraltar"]=new a.GeographicPoint(36.133335,-5.35));(z["Europe/Ljubljana"]=new a.GeographicPoint(46.05528,14.514444));(z["Europe/Luxembourg"]=new a.GeographicPoint(49.611668,6.13));(z["Europe/Madrid"]=new a.GeographicPoint(40.4,-3.6833334));(z["Europe/Malta"]=new a.GeographicPoint(35.899723,14.514722));(z["Europe/Monaco"]=new a.GeographicPoint(43.733334,7.4166665));(z["Europe/Oslo"]=new a.GeographicPoint(59.916668,10.75));(z["Europe/Paris"]=C);(z["Europe/Podgorica"]=new a.GeographicPoint(42.441113,19.26361));(z["Europe/Prague"]=new a.GeographicPoint(50.083332,14.466667));(z["Europe/Rome"]=new a.GeographicPoint(41.9,12.483334));(z["Europe/San_Marino"]=new a.GeographicPoint(43.933334,12.45));(z["Europe/Sarajevo"]=new a.GeographicPoint(43.85,18.383333));(z["Europe/Skopje"]=new a.GeographicPoint(42,21.433332));(z["Europe/Stockholm"]=new a.GeographicPoint(59.333332,18.05));(z["Europe/Tirane"]=new a.GeographicPoint(41.3275,19.81889));(z["Europe/Vaduz"]=new a.GeographicPoint(47.133335,9.516666));(z["Europe/Vatican"]=new a.GeographicPoint(41.9,12.45));(z["Europe/Vienna"]=new a.GeographicPoint(48.2,16.366667));(z["Europe/Warsaw"]=new a.GeographicPoint(52.25,21));(z["Europe/Zagreb"]=new a.GeographicPoint(45.8,16));(z["Europe/Zurich"]=new a.GeographicPoint(47.366665,8.55));(z["Africa/Blantyre"]=new a.GeographicPoint(-15.783333,35));(z["Africa/Bujumbura"]=new a.GeographicPoint(-3.376111,29.36));(z["Africa/Cairo"]=new a.GeographicPoint(30.05,31.25));(z["Africa/Gaborone"]=new a.GeographicPoint(-24.646389,25.911945));(z["Africa/Harare"]=new a.GeographicPoint(-17.817778,31.044722));(z["Africa/Johannesburg"]=new a.GeographicPoint(-26.2,28.083334));(z["Africa/Kigali"]=new a.GeographicPoint(-1.9536111,30.060556));(z["Africa/Lubumbashi"]=new a.GeographicPoint(-11.666667,27.466667));(z["Africa/Lusaka"]=new a.GeographicPoint(-15.416667,28.283333));(z["Africa/Maputo"]=new a.GeographicPoint(-25.965279,32.58917));(z["Africa/Maseru"]=new a.GeographicPoint(-29.316668,27.483334));(z["Africa/Mbabane"]=new a.GeographicPoint(-26.316668,31.133333));(z["Africa/Tripoli"]=new a.GeographicPoint(32.8925,13.18));(z["Asia/Amman"]=new a.GeographicPoint(31.95,35.933334));(z["Asia/Beirut"]=new a.GeographicPoint(33.871944,35.509724));(z["Asia/Damascus"]=new a.GeographicPoint(33.5,36.3));(z["Asia/Gaza"]=new a.GeographicPoint(31.5,34.466667));(z["Asia/Istanbul"]=new a.GeographicPoint(41.018612,28.964722));(z["Asia/Jerusalem"]=new a.GeographicPoint(31.78,35.23));(z["Asia/Nicosia"]=new a.GeographicPoint(35.166668,33.366665));(z["Asia/Tel_Aviv"]=new a.GeographicPoint(32.066666,34.766666));var A=new a.GeographicPoint(37.983334,23.733334);(z["Etc/GMT-2"]=A);(z["Europe/Athens"]=new a.GeographicPoint(37.983334,23.733334));(z["Europe/Bucharest"]=new a.GeographicPoint(44.433334,26.1));(z["Europe/Chisinau"]=new a.GeographicPoint(47.005554,28.8575));(z["Europe/Helsinki"]=new a.GeographicPoint(60.175556,24.934166));(z["Europe/Istanbul"]=new a.GeographicPoint(41.018612,28.964722));(z["Europe/Kaliningrad"]=new a.GeographicPoint(54.71,20.5));(z["Europe/Kiev"]=new a.GeographicPoint(50.433334,30.516666));(z["Europe/Mariehamn"]=new a.GeographicPoint(60.1,19.95));(z["Europe/Minsk"]=new a.GeographicPoint(53.9,27.566668));(z["Europe/Nicosia"]=new a.GeographicPoint(35.166668,33.366665));(z["Europe/Riga"]=new a.GeographicPoint(56.95,24.1));(z["Europe/Simferopol"]=new a.GeographicPoint(44.95,34.1));(z["Europe/Sofia"]=new a.GeographicPoint(42.683334,23.316668));(z["Europe/Tallinn"]=new a.GeographicPoint(59.433887,24.728056));(z["Europe/Tiraspol"]=new a.GeographicPoint(46.84028,29.643333));(z["Europe/Uzhgorod"]=new a.GeographicPoint(48.616665,22.3));(z["Europe/Vilnius"]=new a.GeographicPoint(54.683334,25.316668));(z["Europe/Zaporozhye"]=new a.GeographicPoint(47.833,35.1667));(z["Africa/Addis_Ababa"]=new a.GeographicPoint(9.033333,38.7));(z["Africa/Asmara"]=new a.GeographicPoint(15.333333,38.933334));(z["Africa/Asmera"]=new a.GeographicPoint(15.333333,38.933334));(z["Africa/Dar_es_Salaam"]=new a.GeographicPoint(-6.8,39.283333));(z["Africa/Djibouti"]=new a.GeographicPoint(11.595,43.148056));(z["Africa/Kampala"]=new a.GeographicPoint(0.3155556,32.565556));(z["Africa/Khartoum"]=new a.GeographicPoint(15.588056,32.53417));(z["Africa/Mogadishu"]=new a.GeographicPoint(2.0666666,45.366665));(z["Africa/Nairobi"]=new a.GeographicPoint(-1.2833333,36.816666));(z["Antarctica/Syowa"]=new a.GeographicPoint(-69,39.5833));(z["Asia/Aden"]=new a.GeographicPoint(12.779445,45.036667));(z["Asia/Baghdad"]=new a.GeographicPoint(33.33861,44.39389));(z["Asia/Bahrain"]=new a.GeographicPoint(26.23611,50.583057));(z["Asia/Kuwait"]=new a.GeographicPoint(29.369722,47.978333));(z["Asia/Qatar"]=new a.GeographicPoint(25.286667,51.533333));(z["Asia/Riyadh"]=new a.GeographicPoint(24.640833,46.772778));var E=new a.GeographicPoint(55.752224,37.615555);(z["Etc/GMT-3"]=E);(z["Europe/Moscow"]=E);(z["Europe/Volgograd"]=new a.GeographicPoint(48.80472,44.585835));(z["Indian/Antananarivo"]=new a.GeographicPoint(-18.916666,47.516666));(z["Indian/Comoro"]=new a.GeographicPoint(-11.704166,43.240276));(z["Indian/Mayotte"]=new a.GeographicPoint(-12.779445,45.227222));(z["Asia/Riyadh87"]=new a.GeographicPoint(24.640833,46.772778));(z["Asia/Riyadh88"]=new a.GeographicPoint(24.640833,46.772778));(z["Asia/Riyadh89"]=new a.GeographicPoint(24.640833,46.772778));(z["Mideast/Riyadh87"]=new a.GeographicPoint(24.640833,46.772778));(z["Mideast/Riyadh88"]=new a.GeographicPoint(24.640833,46.772778));(z["Mideast/Riyadh89"]=new a.GeographicPoint(24.640833,46.772778));(z["Asia/Tehran"]=new a.GeographicPoint(35.671944,51.424446));(z["Asia/Baku"]=new a.GeographicPoint(40.39528,49.88222));var k=new a.GeographicPoint(25.252222,55.28);(z["Asia/Dubai"]=k);(z["Asia/Muscat"]=new a.GeographicPoint(23.613333,58.593334));(z["Asia/Tbilisi"]=new a.GeographicPoint(41.725,44.790833));(z["Asia/Yerevan"]=new a.GeographicPoint(40.18111,44.51361));(z["Etc/GMT-4"]=k);(z["Europe/Samara"]=new a.GeographicPoint(53.2,50.15));(z["Indian/Mahe"]=new a.GeographicPoint(-4.616667,55.45));(z["Indian/Mauritius"]=new a.GeographicPoint(-20.161945,57.49889));(z["Indian/Reunion"]=new a.GeographicPoint(-20.866667,55.466667));(z["Asia/Kabul"]=new a.GeographicPoint(34.516666,69.183334));(z["Antarctica/Davis"]=new a.GeographicPoint(-68.5764,77.9689));(z["Antarctica/Mawson"]=new a.GeographicPoint(-53.104,73.514));(z["Asia/Aqtau"]=new a.GeographicPoint(43.65,51.2));(z["Asia/Aqtobe"]=new a.GeographicPoint(50.298054,57.18139));(z["Asia/Ashgabat"]=new a.GeographicPoint(37.95,58.383335));(z["Asia/Ashkhabad"]=new a.GeographicPoint(37.95,58.383335));(z["Asia/Dushanbe"]=new a.GeographicPoint(38.56,68.77389));(z["Asia/Karachi"]=new a.GeographicPoint(24.866667,67.05));(z["Asia/Oral"]=new a.GeographicPoint(51.233334,51.366665));(z["Asia/Samarkand"]=new a.GeographicPoint(39.654167,66.959724));(z["Asia/Tashkent"]=new a.GeographicPoint(41.316666,69.25));(z["Asia/Yekaterinburg"]=new a.GeographicPoint(56.85,60.6));var d=new a.GeographicPoint(22.569721,88.36972);(z["Etc/GMT-5"]=d);(z["Indian/Kerguelen"]=new a.GeographicPoint(-49.25,69.583));(z["Indian/Maldives"]=new a.GeographicPoint(4.1666665,73.5));(z["Asia/Calcutta"]=d);(z["Asia/Colombo"]=new a.GeographicPoint(6.9319444,79.84778));(z["Asia/Kolkata"]=d);(z["Asia/Kathmandu"]=new a.GeographicPoint(27.716667,85.316666));(z["Asia/Katmandu"]=new a.GeographicPoint(27.716667,85.316666));(z["Antarctica/Vostok"]=new a.GeographicPoint(-78.4644,106.8372));(z["Asia/Almaty"]=new a.GeographicPoint(43.25,76.95));(z["Asia/Bishkek"]=new a.GeographicPoint(42.873055,74.60028));var t=new a.GeographicPoint(23.723055,90.40861);(z["Asia/Dacca"]=t);(z["Asia/Dhaka"]=t);(z["Asia/Novokuznetsk"]=new a.GeographicPoint(53.75,87.1));(z["Asia/Novosibirsk"]=new a.GeographicPoint(55.04111,82.93444));(z["Asia/Omsk"]=new a.GeographicPoint(55,73.4));(z["Asia/Qyzylorda"]=new a.GeographicPoint(44.85278,65.50916));(z["Asia/Thimbu"]=new a.GeographicPoint(27.483334,89.6));(z["Asia/Thimphu"]=new a.GeographicPoint(27.483334,89.6));(z["Etc/GMT-6"]=t);(z["Indian/Chagos"]=new a.GeographicPoint(-6,71.5));(z["Asia/Rangoon"]=new a.GeographicPoint(16.783333,96.166664));(z["Indian/Cocos"]=new a.GeographicPoint(-12.1167,96.9));var q=new a.GeographicPoint(13.75,100.51667);(z["Asia/Bangkok"]=q);(z["Asia/Ho_Chi_Minh"]=new a.GeographicPoint(10.75,106.666664));(z["Asia/Hovd"]=new a.GeographicPoint(48.016666,91.63333));(z["Asia/Jakarta"]=new a.GeographicPoint(-6.174444,106.829445));(z["Asia/Krasnoyarsk"]=new a.GeographicPoint(56.009724,92.791664));(z["Asia/Phnom_Penh"]=new a.GeographicPoint(11.55,104.916664));(z["Asia/Pontianak"]=new a.GeographicPoint(-0.0333333,109.333336));(z["Asia/Saigon"]=new a.GeographicPoint(10.75,106.666664));(z["Asia/Vientiane"]=new a.GeographicPoint(17.966667,102.6));(z["Etc/GMT-7"]=q);(z["Indian/Christmas"]=new a.GeographicPoint(-10.416667,105.71667));(z["Asia/Brunei"]=new a.GeographicPoint(4.883333,114.933334));(z["Asia/Choibalsan"]=new a.GeographicPoint(48.066666,114.5));(z["Asia/Chongqing"]=new a.GeographicPoint(29.562778,106.55278));(z["Asia/Chungking"]=new a.GeographicPoint(29.562778,106.55278));(z["Asia/Harbin"]=new a.GeographicPoint(45.75,126.65));(z["Asia/Hong_Kong"]=new a.GeographicPoint(22.283333,114.15));(z["Asia/Irkutsk"]=new a.GeographicPoint(52.266666,104.333336));(z["Asia/Kashgar"]=new a.GeographicPoint(39.391388,76.04));(z["Asia/Kuala_Lumpur"]=new a.GeographicPoint(3.1666667,101.7));(z["Asia/Kuching"]=new a.GeographicPoint(1.55,110.333336));(z["Asia/Macao"]=new a.GeographicPoint(22.2,113.55));(z["Asia/Macau"]=new a.GeographicPoint(22.2,113.55));(z["Asia/Makassar"]=new a.GeographicPoint(2.45,99.78333));(z["Asia/Manila"]=new a.GeographicPoint(14.604167,120.98222));var u=new a.GeographicPoint(31.005,121.40861);(z["Asia/Shanghai"]=u);(z["Asia/Singapore"]=new a.GeographicPoint(1.2930557,103.855835));(z["Asia/Taipei"]=new a.GeographicPoint(25.039167,121.525));(z["Asia/Ujung_Pandang"]=new a.GeographicPoint(-5.1305556,119.406944));(z["Asia/Ulaanbaatar"]=new a.GeographicPoint(47.916668,106.916664));(z["Asia/Ulan_Bator"]=new a.GeographicPoint(47.916668,106.916664));(z["Asia/Urumqi"]=new a.GeographicPoint(43.8,87.583336));(z["Australia/Perth"]=new a.GeographicPoint(-31.933332,115.833336));(z["Australia/West"]=new a.GeographicPoint(-31.933332,115.833336));(z["Etc/GMT-8"]=u);(z["Australia/Eucla"]=new a.GeographicPoint(-31.716667,128.86667));(z["Asia/Dili"]=new a.GeographicPoint(-8.55,125.5833));(z["Asia/Jayapura"]=new a.GeographicPoint(-2.5333333,140.7));(z["Asia/Pyongyang"]=new a.GeographicPoint(39.019444,125.75472));(z["Asia/Seoul"]=new a.GeographicPoint(37.566387,126.999725));var j=new a.GeographicPoint(35.685,139.75139);(z["Asia/Tokyo"]=j);(z["Asia/Yakutsk"]=new a.GeographicPoint(62.03389,129.73306));(z["Etc/GMT-9"]=j);(z["Pacific/Palau"]=new a.GeographicPoint(7.5,134.6241));(z["Australia/Adelaide"]=new a.GeographicPoint(-34.933334,138.6));(z["Australia/Broken_Hill"]=new a.GeographicPoint(-31.95,141.43333));(z["Australia/Darwin"]=new a.GeographicPoint(-12.466667,130.83333));(z["Australia/North"]=new a.GeographicPoint(-12.466667,130.83333));(z["Australia/South"]=new a.GeographicPoint(-34.933334,138.6));(z["Australia/Yancowinna"]=new a.GeographicPoint(-31.7581,141.7178));(z["Antarctica/DumontDUrville"]=new a.GeographicPoint(-66.66277,140.0014));(z["Asia/Sakhalin"]=new a.GeographicPoint(51,143));(z["Asia/Vladivostok"]=new a.GeographicPoint(43.133335,131.9));(z["Australia/ACT"]=new a.GeographicPoint(-35.283333,149.21666));(z["Australia/Brisbane"]=new a.GeographicPoint(-27.5,153.01666));(z["Australia/Canberra"]=new a.GeographicPoint(-35.283333,149.21666));(z["Australia/Currie"]=new a.GeographicPoint(-39.933334,143.86667));(z["Australia/Hobart"]=new a.GeographicPoint(-42.916668,147.33333));(z["Australia/Lindeman"]=new a.GeographicPoint(-20.45,149.0333));(z["Australia/Melbourne"]=new a.GeographicPoint(-37.816666,144.96666));var o=new a.GeographicPoint(-33.88333,151.21666);(z["Australia/NSW"]=o);(z["Australia/Queensland"]=new a.GeographicPoint(-27.5,153.01666));(z["Australia/Sydney"]=o);(z["Australia/Tasmania"]=new a.GeographicPoint(-42.916668,147.33333));(z["Australia/Victoria"]=new a.GeographicPoint(-37.816666,144.96666));(z["Etc/GMT-10"]=o);(z["Pacific/Guam"]=new a.GeographicPoint(13.467,144.75));(z["Pacific/Port_Moresby"]=new a.GeographicPoint(-9.464723,147.1925));(z["Pacific/Saipan"]=new a.GeographicPoint(15.1833,145.75));(z["Pacific/Truk"]=new a.GeographicPoint(7.4167,151.7833));(z["Pacific/Yap"]=new a.GeographicPoint(9.514444,138.12917));(z["Australia/LHI"]=new a.GeographicPoint(-31.55,159.083));(z["Australia/Lord_Howe"]=new a.GeographicPoint(-31.55,159.083));(z["Antarctica/Casey"]=new a.GeographicPoint(-66.2833,110.5333));(z["Asia/Magadan"]=new a.GeographicPoint(59.566666,150.8));var c=new a.GeographicPoint(-22.266666,166.45);(z["Etc/GMT-11"]=c);(z["Pacific/Efate"]=new a.GeographicPoint(-17.667,168.417));(z["Pacific/Guadalcanal"]=new a.GeographicPoint(-9.617,160.183));(z["Pacific/Kosrae"]=new a.GeographicPoint(5.317,162.983));(z["Pacific/Noumea"]=c);(z["Pacific/Ponape"]=new a.GeographicPoint(6.963889,158.20833));(z["Pacific/Norfolk"]=new a.GeographicPoint(-29.05,167.95));(z["Antarctica/McMurdo"]=new a.GeographicPoint(-77.85,166.667));(z["Antarctica/South_Pole"]=new a.GeographicPoint(-90,0));(z["Asia/Anadyr"]=new a.GeographicPoint(64.75,177.48334));(z["Asia/Kamchatka"]=new a.GeographicPoint(57,160));var e=new a.GeographicPoint(-36.86667,174.76666);(z["Etc/GMT-12"]=e);(z["Pacific/Auckland"]=e);(z["Pacific/Fiji"]=new a.GeographicPoint(-18.133333,178.41667));(z["Pacific/Funafuti"]=new a.GeographicPoint(-8.516666,179.21666));(z["Pacific/Kwajalein"]=new a.GeographicPoint(9.1939,167.4597));(z["Pacific/Majuro"]=new a.GeographicPoint(7.1,171.38333));(z["Pacific/Nauru"]=new a.GeographicPoint(-0.5322,166.9328));(z["Pacific/Tarawa"]=new a.GeographicPoint(1.4167,173.0333));(z["Pacific/Wake"]=new a.GeographicPoint(19.2833,166.6));(z["Pacific/Wallis"]=new a.GeographicPoint(-13.273,-176.205));(z["Pacific/Chatham"]=new a.GeographicPoint(-43.883,-176.517));var n=new a.GeographicPoint(-3.133,-171.0833);(z["Etc/GMT-13"]=n);(z["Pacific/Enderbury"]=n);(z["Pacific/Tongatapu"]=new a.GeographicPoint(-21.2114,-175.153));var h=new a.GeographicPoint(1.883,-157.4);(z["Etc/GMT-14"]=h);(z["Pacific/Kiritimati"]=h);(z.MIT=g);(z.HST=B);(z.PST=f);(z.PST8PDT=f);(z.MST=l);(z.MST7MDT=l);(z.Navajo=new a.GeographicPoint(35.6728,-109.0622));(z.PNT=new a.GeographicPoint(33.448334,-112.07333));(z["America/Indiana/Knox"]=new a.GeographicPoint(41.295834,-86.625));(z["America/Indiana/Tell_City"]=new a.GeographicPoint(37.953,-86.7614));(z["America/North_Dakota/Center"]=new a.GeographicPoint(47.115,-101.3003));(z["America/North_Dakota/New_Salem"]=new a.GeographicPoint(46.843,101.4119));(z.CST=x);(z.CST6CDT=x);(z["America/Indiana/Indianapolis"]=new a.GeographicPoint(39.768333,-86.15806));(z["America/Indiana/Marengo"]=new a.GeographicPoint(36.3706,-86.3433));(z["America/Indiana/Petersburg"]=new a.GeographicPoint(38.4917,-87.2803));(z["America/Indiana/Vevay"]=new a.GeographicPoint(38.7458,-85.0711));(z["America/Indiana/Vincennes"]=new a.GeographicPoint(38.6783,-87.5164));(z["America/Indiana/Winamac"]=new a.GeographicPoint(41.0525,-86.6044));(z["America/Kentucky/Louisville"]=new a.GeographicPoint(38.2542,-85.7603));(z["America/Kentucky/Monticello"]=new a.GeographicPoint(36.8381,-84.85));(z.Cuba=new a.GeographicPoint(23.131945,-82.36417));(z.EST=p);(z.EST5EDT=p);(z.IET=p);(z.AST=new a.GeographicPoint(44.65,-63.6));(z.Jamaica=new a.GeographicPoint(18,-76.8));(z["America/Argentina/San_Luis"]=new a.GeographicPoint(-33.3,-66.333));(z.PRT=new a.GeographicPoint(18.467,66.117));(z.CNT=new a.GeographicPoint(47.5675,-52.7072));(z.AGT=new a.GeographicPoint(-34.5875,-58.6725));(z["America/Argentina/Buenos_Aires"]=new a.GeographicPoint(-34.5875,-58.6725));(z["America/Argentina/Catamarca"]=new a.GeographicPoint(-28.466667,-65.78333));(z["America/Argentina/ComodRivadavia"]=new a.GeographicPoint(-42.7578,-65.0297));(z["America/Argentina/Cordoba"]=new a.GeographicPoint(-31.4,-64.183334));(z["America/Argentina/Jujuy"]=new a.GeographicPoint(-24.183332,-65.3));(z["America/Argentina/La_Rioja"]=new a.GeographicPoint(-29.4144,-66.8552));(z["America/Argentina/Mendoza"]=new a.GeographicPoint(-32.883335,-68.816666));(z["America/Argentina/Rio_Gallegos"]=new a.GeographicPoint(-51.625,-69.2286));(z["America/Argentina/Salta"]=new a.GeographicPoint(-24.783333,-65.416664));(z["America/Argentina/San_Juan"]=new a.GeographicPoint(-31.5333,-68.5167));(z["America/Argentina/Tucuman"]=new a.GeographicPoint(-26.8167,65.2167));(z["America/Argentina/Ushuaia"]=new a.GeographicPoint(-54.6,-68.3));(z.BET=y);(z.Eire=new a.GeographicPoint(53.333057,-6.248889));(z.GB=r);(z["GB-Eire"]=new a.GeographicPoint(53.333057,-6.248889));(z.GMT=r);(z.GMT0=r);(z.Greenwich=r);(z.Iceland=new a.GeographicPoint(64.1333,-21.9333));(z.Portugal=new a.GeographicPoint(38.716667,-9.133333));(z.UCT=r);(z.UTC=r);(z.Universal=r);(z.WET=r);(z.Zulu=r);(z.CET=C);(z.ECT=C);(z.MET=new a.GeographicPoint(35.671944,51.424446));(z.Poland=new a.GeographicPoint(52.25,21));(z.ART=new a.GeographicPoint(-34.5875,-58.6725));(z.CAT=new a.GeographicPoint(-1.9536111,30.060556));(z.EET=new a.GeographicPoint(37.983334,23.733334));(z.Egypt=new a.GeographicPoint(30.05,31.25));(z.Israel=new a.GeographicPoint(32.066666,34.766666));(z.Libya=new a.GeographicPoint(32.8925,13.18));(z.Turkey=new a.GeographicPoint(41.018612,28.964722));(z.EAT=new a.GeographicPoint(-1.2833333,36.816666));(z["W-SU"]=E);(z.Iran=new a.GeographicPoint(35.671944,51.424446));(z.NET=new a.GeographicPoint(40.18111,44.51361));(z.PLT=new a.GeographicPoint(24.866667,67.05));(z.IST=d);(z.BST=t);(z.VST=q);(z.CTT=u);(z.Hongkong=new a.GeographicPoint(22.283333,114.15));(z.PRC=u);(z.Singapore=new a.GeographicPoint(1.2930557,103.855835));(z.JST=j);(z.Japan=j);(z.ROK=new a.GeographicPoint(37.566387,126.999725));(z.ACT=new a.GeographicPoint(-35.283333,149.21666));(z.AET=o);(z.SST=new a.GeographicPoint(-28.4667,159.8167));(z.Kwajalein=new a.GeographicPoint(9.1939,167.4597));(z.NST=e);(z.NZ=e);(z["NZ-CHAT"]=new a.GeographicPoint(-43.883,-176.517));a.timeZoneGeographicPointsReference=(z)}var w=(function(F,G){return F[G]===undefined?null:F[G]})(z,"UTC");if(w==null){w=(function(F,G){return F[G]===undefined?null:F[G]})(z,"Etc/GMT")}this.latitude=(function(F){return F*Math.PI/180})(w.getLatitudeInDegrees());this.longitude=(function(F){return F*Math.PI/180})(w.getLongitudeInDegrees())};a.timeZoneGeographicPointsReference=null;return a}(HomeObject));Compass.__class="com.eteks.sweethome3d.model.Compass";Compass.__interfaces=["com.eteks.sweethome3d.model.Selectable"];(function(a){var b=(function(){function c(d,e){if(this.latitudeInDegrees===undefined){this.latitudeInDegrees=0}if(this.longitudeInDegrees===undefined){this.longitudeInDegrees=0}this.latitudeInDegrees=d;this.longitudeInDegrees=e}c.prototype.getLatitudeInDegrees=function(){return this.latitudeInDegrees};c.prototype.getLongitudeInDegrees=function(){return this.longitudeInDegrees};return c}());a.GeographicPoint=b;b.__class="com.eteks.sweethome3d.model.Compass.GeographicPoint"})(Compass||(Compass={}));Compass.__transients=["pointsCache","dateCache","sunElevationCache","sunAzimuthCache","propertyChangeSupport"];var Wall=(function(a){__extends(b,a);function b(G,m,H,v,I,z,c,j){var f=this;if(((typeof G==="string")||G===null)&&((typeof m==="number")||m===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&((typeof c==="number")||c===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||j===null)){var P=arguments;f=a.call(this,G)||this;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;f.xStart=m;f.yStart=H;f.xEnd=v;f.yEnd=I;f.thickness=z;f.height=c;f.pattern=j}else{if(((typeof G==="string")||G===null)&&((typeof m==="number")||m===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&((typeof c==="number")||c===null)&&j===undefined){var P=arguments;var q=arguments;var y=null;f=a.call(this,G)||this;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;f.xStart=m;f.yStart=H;f.xEnd=v;f.yEnd=I;f.thickness=z;f.height=c;f.pattern=y;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true}else{if(((typeof G==="number")||G===null)&&((typeof m==="number")||m===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&((c!=null&&(c.constructor!=null&&c.constructor.__interfaces!=null&&c.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.TextureImage")>=0))||c===null)&&j===undefined){var P=arguments;var O=P[0];var S=P[1];var g=P[2];var F=P[3];var C=P[4];var t=P[5];var x=P[6];var p=arguments;var N=HomeObject.createId("wall");f=a.call(this,N)||this;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;f.xStart=O;f.yStart=S;f.xEnd=g;f.yEnd=F;f.thickness=C;f.height=t;f.pattern=x;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true}else{if(((typeof G==="number")||G===null)&&((typeof m==="number")||m===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&((typeof z==="number")||z===null)&&c===undefined&&j===undefined){var P=arguments;var M=P[0];var R=P[1];var e=P[2];var E=P[3];var B=P[4];var s=P[5];var o=arguments;var w=null;var n=arguments;var L=HomeObject.createId("wall");f=a.call(this,L)||this;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;f.xStart=M;f.yStart=R;f.xEnd=e;f.yEnd=E;f.thickness=B;f.height=s;f.pattern=w;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true}else{if(((typeof G==="number")||G===null)&&((typeof m==="number")||m===null)&&((typeof H==="number")||H===null)&&((typeof v==="number")||v===null)&&((typeof I==="number")||I===null)&&z===undefined&&c===undefined&&j===undefined){var P=arguments;var K=P[0];var Q=P[1];var d=P[2];var D=P[3];var A=P[4];var l=arguments;var r=0;var k=arguments;var u=null;var h=arguments;var J=HomeObject.createId("wall");f=a.call(this,J)||this;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;f.xStart=K;f.yStart=Q;f.xEnd=d;f.yEnd=D;f.thickness=A;f.height=r;f.pattern=u;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true;if(f.xStart===undefined){f.xStart=0}if(f.yStart===undefined){f.yStart=0}if(f.xEnd===undefined){f.xEnd=0}if(f.yEnd===undefined){f.yEnd=0}if(f.arcExtent===undefined){f.arcExtent=null}if(f.wallAtStart===undefined){f.wallAtStart=null}if(f.wallAtEnd===undefined){f.wallAtEnd=null}if(f.thickness===undefined){f.thickness=0}if(f.height===undefined){f.height=null}if(f.heightAtEnd===undefined){f.heightAtEnd=null}if(f.leftSideColor===undefined){f.leftSideColor=null}if(f.leftSideTexture===undefined){f.leftSideTexture=null}if(f.leftSideShininess===undefined){f.leftSideShininess=0}if(f.leftSideBaseboard===undefined){f.leftSideBaseboard=null}if(f.rightSideColor===undefined){f.rightSideColor=null}if(f.rightSideTexture===undefined){f.rightSideTexture=null}if(f.rightSideShininess===undefined){f.rightSideShininess=0}if(f.rightSideBaseboard===undefined){f.rightSideBaseboard=null}if(f.pattern===undefined){f.pattern=null}if(f.topColor===undefined){f.topColor=null}if(f.level===undefined){f.level=null}if(f.shapeCache===undefined){f.shapeCache=null}if(f.arcCircleCenterCache===undefined){f.arcCircleCenterCache=null}if(f.pointsCache===undefined){f.pointsCache=null}if(f.pointsIncludingBaseboardsCache===undefined){f.pointsIncludingBaseboardsCache=null}f.symmetric=true}else{throw new Error("invalid overload")}}}}}return f}b.prototype.getXStart=function(){return this.xStart};b.prototype.setXStart=function(d){if(d!==this.xStart){var c=this.xStart;this.xStart=d;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("X_START",c,d)}};b.prototype.getYStart=function(){return this.yStart};b.prototype.setYStart=function(d){if(d!==this.yStart){var c=this.yStart;this.yStart=d;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("Y_START",c,d)}};b.prototype.getXEnd=function(){return this.xEnd};b.prototype.setXEnd=function(c){if(c!==this.xEnd){var d=this.xEnd;this.xEnd=c;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("X_END",d,c)}};b.prototype.getYEnd=function(){return this.yEnd};b.prototype.setYEnd=function(c){if(c!==this.yEnd){var d=this.yEnd;this.yEnd=c;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("Y_END",d,c)}};b.prototype.getLength=function(){if(this.arcExtent==null||this.arcExtent===0){return java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)}else{var d=this.getArcCircleCenter();var c=java.awt.geom.Point2D.distance(this.xStart,this.yStart,d[0],d[1]);return Math.abs(this.arcExtent)*c}};b.prototype.getStartPointToEndPointDistance=function(){return java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)};b.prototype.setArcExtent=function(d){if(d!==this.arcExtent&&(d==null||!(d===this.arcExtent))){var c=this.arcExtent;this.arcExtent=d;this.clearPointsCache();this.arcCircleCenterCache=null;this.firePropertyChange("ARC_EXTENT",c,d)}};b.prototype.getArcExtent=function(){return this.arcExtent};b.prototype.getXArcCircleCenter=function(){if(this.arcExtent==null){return(this.xStart+this.xEnd)/2}else{return this.getArcCircleCenter()[0]}};b.prototype.getYArcCircleCenter=function(){if(this.arcExtent==null){return(this.yStart+this.yEnd)/2}else{return this.getArcCircleCenter()[1]}};b.prototype.getArcCircleCenter=function(){if(this.arcCircleCenterCache==null){var f=java.awt.geom.Point2D.distance(this.xStart,this.yStart,this.xEnd,this.yEnd);var e=Math.abs(this.arcExtent)>Math.PI?-(Math.PI+this.arcExtent)/2:(Math.PI-this.arcExtent)/2;var d=-(Math.tan(e)*f/2);var g=(this.xStart+this.xEnd)/2;var c=(this.yStart+this.yEnd)/2;var h=Math.atan2(this.xStart-this.xEnd,this.yEnd-this.yStart);this.arcCircleCenterCache=[(g+d*Math.cos(h)),(c+d*Math.sin(h))]}return this.arcCircleCenterCache};b.prototype.getWallAtStart=function(){return this.wallAtStart};b.prototype.setWallAtStart=function(d,c){if(c===void 0){c=true}if(d!==this.wallAtStart){var e=this.wallAtStart;this.wallAtStart=d;this.clearPointsCache();this.firePropertyChange("WALL_AT_START",e,d);if(c){this.detachJoinedWall(e)}}};b.prototype.getWallAtEnd=function(){return this.wallAtEnd};b.prototype.setWallAtEnd=function(e,d){if(d===void 0){d=true}if(e!==this.wallAtEnd){var c=this.wallAtEnd;this.wallAtEnd=e;this.clearPointsCache();this.firePropertyChange("WALL_AT_END",c,e);if(d){this.detachJoinedWall(c)}}};b.prototype.detachJoinedWall=function(c){if(c!=null){if(c.getWallAtStart()===this){c.setWallAtStart(null,false)}else{if(c.getWallAtEnd()===this){c.setWallAtEnd(null,false)}}}};b.prototype.getThickness=function(){return this.thickness};b.prototype.setThickness=function(d){if(d!==this.thickness){var c=this.thickness;this.thickness=d;this.clearPointsCache();this.firePropertyChange("THICKNESS",c,d)}};b.prototype.getHeight=function(){return this.height};b.prototype.setHeight=function(c){if(c!==this.height&&(c==null||!(c===this.height))){var d=this.height;this.height=c;this.firePropertyChange("HEIGHT",d,c)}};b.prototype.getHeightAtEnd=function(){return this.heightAtEnd};b.prototype.setHeightAtEnd=function(c){if(c!==this.heightAtEnd&&(c==null||!(c===this.heightAtEnd))){var d=this.heightAtEnd;this.heightAtEnd=c;this.firePropertyChange("HEIGHT_AT_END",d,c)}};b.prototype.isTrapezoidal=function(){return this.height!=null&&this.heightAtEnd!=null&&!(this.height===this.heightAtEnd)};b.prototype.getLeftSideColor=function(){return this.leftSideColor};b.prototype.setLeftSideColor=function(c){if(c!==this.leftSideColor&&(c==null||!(c===this.leftSideColor))){var d=this.leftSideColor;this.leftSideColor=c;this.firePropertyChange("LEFT_SIDE_COLOR",d,c)}};b.prototype.getRightSideColor=function(){return this.rightSideColor};b.prototype.setRightSideColor=function(c){if(c!==this.rightSideColor&&(c==null||!(c===this.rightSideColor))){var d=this.rightSideColor;this.rightSideColor=c;this.firePropertyChange("RIGHT_SIDE_COLOR",d,c)}};b.prototype.getLeftSideTexture=function(){return this.leftSideTexture};b.prototype.setLeftSideTexture=function(d){if(d!==this.leftSideTexture&&(d==null||!d.equals(this.leftSideTexture))){var c=this.leftSideTexture;this.leftSideTexture=d;this.firePropertyChange("LEFT_SIDE_TEXTURE",c,d)}};b.prototype.getRightSideTexture=function(){return this.rightSideTexture};b.prototype.setRightSideTexture=function(c){if(c!==this.rightSideTexture&&(c==null||!c.equals(this.rightSideTexture))){var d=this.rightSideTexture;this.rightSideTexture=c;this.firePropertyChange("RIGHT_SIDE_TEXTURE",d,c)}};b.prototype.getLeftSideShininess=function(){return this.leftSideShininess};b.prototype.setLeftSideShininess=function(c){if(c!==this.leftSideShininess){var d=this.leftSideShininess;this.leftSideShininess=c;this.firePropertyChange("LEFT_SIDE_SHININESS",d,c)}};b.prototype.getRightSideShininess=function(){return this.rightSideShininess};b.prototype.setRightSideShininess=function(d){if(d!==this.rightSideShininess){var c=this.rightSideShininess;this.rightSideShininess=d;this.firePropertyChange("RIGHT_SIDE_SHININESS",c,d)}};b.prototype.getLeftSideBaseboard=function(){return this.leftSideBaseboard};b.prototype.setLeftSideBaseboard=function(d){if(d!==this.leftSideBaseboard&&(d==null||!d.equals(this.leftSideBaseboard))){var c=this.leftSideBaseboard;this.leftSideBaseboard=d;this.clearPointsCache();this.firePropertyChange("LEFT_SIDE_BASEBOARD",c,d)}};b.prototype.getRightSideBaseboard=function(){return this.rightSideBaseboard};b.prototype.setRightSideBaseboard=function(c){if(c!==this.rightSideBaseboard&&(c==null||!c.equals(this.rightSideBaseboard))){var d=this.rightSideBaseboard;this.rightSideBaseboard=c;this.clearPointsCache();this.firePropertyChange("RIGHT_SIDE_BASEBOARD",d,c)}};b.prototype.getPattern=function(){return this.pattern};b.prototype.setPattern=function(d){if(this.pattern!==d){var c=this.pattern;this.pattern=d;this.firePropertyChange("PATTERN",c,d)}};b.prototype.getTopColor=function(){return this.topColor};b.prototype.setTopColor=function(c){if(this.topColor!==c&&(c==null||!(c===this.topColor))){var d=this.topColor;this.topColor=c;this.firePropertyChange("TOP_COLOR",d,c)}};b.prototype.getLevel=function(){return this.level};b.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};b.prototype.isAtLevel=function(e){if(this.level===e){return true}else{if(this.level!=null&&e!=null){var c=this.level.getElevation();var d=e.getElevation();return c===d&&this.level.getElevationIndex()<e.getElevationIndex()||c<d&&c+this.getWallMaximumHeight()>d}else{return false}}};b.prototype.getWallMaximumHeight=function(){if(this.height==null){return 0}else{if(this.isTrapezoidal()){return Math.max(this.height,this.heightAtEnd)}else{return this.height}}};b.prototype.clearPointsCache=function(){this.shapeCache=null;this.pointsCache=null;this.pointsIncludingBaseboardsCache=null;if(this.wallAtStart!=null){this.wallAtStart.pointsCache=null;this.wallAtStart.pointsIncludingBaseboardsCache=null}if(this.wallAtEnd!=null){this.wallAtEnd.pointsCache=null;this.wallAtEnd.pointsIncludingBaseboardsCache=null}};b.prototype.getPoints$=function(){return this.getPoints$boolean(false)};b.prototype.getPoints$boolean=function(c){if(c&&(this.leftSideBaseboard!=null||this.rightSideBaseboard!=null)){if(this.pointsIncludingBaseboardsCache==null){this.pointsIncludingBaseboardsCache=this.getShapePoints(true)}return this.clonePoints(this.pointsIncludingBaseboardsCache)}else{if(this.pointsCache==null){this.pointsCache=this.getShapePoints(false)}return this.clonePoints(this.pointsCache)}};b.prototype.getPoints=function(c){if(((typeof c==="boolean")||c===null)){return this.getPoints$boolean(c)}else{if(c===undefined){return this.getPoints$()}else{throw new Error("invalid overload")}}};b.prototype.clonePoints=function(d){var e=(function(g){var f=[];while(g-->0){f.push(null)}return f})(d.length);for(var c=0;c<d.length;c++){e[c]=d[c].slice(0)}return e};b.prototype.getShapePoints=function(n){var A=0.01;var c=this.getUnjoinedShapePoints(n);var x=0;var j=c.length-1;var u=(c.length/2|0)-1;var p=(c.length/2|0);if(this.wallAtStart!=null){var z=this.wallAtStart.getUnjoinedShapePoints(n);var w=0;var t=z.length-1;var g=(z.length/2|0)-1;var h=(z.length/2|0);var o=this.wallAtStart.getWallAtEnd()===this&&(this.wallAtStart.getWallAtStart()!==this||(this.wallAtStart.xEnd===this.xStart&&this.wallAtStart.yEnd===this.yStart));var y=this.wallAtStart.getWallAtStart()===this&&(this.wallAtStart.getWallAtEnd()!==this||(this.wallAtStart.xStart===this.xStart&&this.wallAtStart.yStart===this.yStart));var l=n?this.wallAtStart.pointsIncludingBaseboardsCache:this.wallAtStart.pointsCache;var v=2*Math.max(this.thickness,this.wallAtStart.getThickness());if(o){this.computeIntersection(c[x],c[x+1],z[g],z[g-1],v);this.computeIntersection(c[j],c[j-1],z[h],z[h+1],v);if(l!=null){if(Math.abs(c[x][0]-l[g][0])<A&&Math.abs(c[x][1]-l[g][1])<A){c[x]=l[g]}if(Math.abs(c[j][0]-l[h][0])<A&&Math.abs(c[j][1]-l[h][1])<A){c[j]=l[h]}}}else{if(y){this.computeIntersection(c[x],c[x+1],z[t],z[t-1],v);this.computeIntersection(c[j],c[j-1],z[w],z[w+1],v);if(l!=null){if(Math.abs(c[x][0]-l[t][0])<A&&Math.abs(c[x][1]-l[t][1])<A){c[x]=l[t]}if(l!=null&&Math.abs(c[j][0]-l[w][0])<A&&Math.abs(c[j][1]-l[w][1])<A){c[j]=l[w]}}}}}if(this.wallAtEnd!=null){var d=this.wallAtEnd.getUnjoinedShapePoints(n);var m=0;var r=d.length-1;var s=(d.length/2|0)-1;var k=(d.length/2|0);var q=this.wallAtEnd.getWallAtStart()===this&&(this.wallAtEnd.getWallAtEnd()!==this||(this.wallAtEnd.xStart===this.xEnd&&this.wallAtEnd.yStart===this.yEnd));var f=this.wallAtEnd.getWallAtEnd()===this&&(this.wallAtEnd.getWallAtStart()!==this||(this.wallAtEnd.xEnd===this.xEnd&&this.wallAtEnd.yEnd===this.yEnd));var e=n?this.wallAtEnd.pointsIncludingBaseboardsCache:this.wallAtEnd.pointsCache;var v=2*Math.max(this.thickness,this.wallAtEnd.getThickness());if(q){this.computeIntersection(c[u],c[u-1],d[m],d[m+1],v);this.computeIntersection(c[p],c[p+1],d[r],d[r-1],v);if(e!=null){if(Math.abs(c[u][0]-e[m][0])<A&&Math.abs(c[u][1]-e[m][1])<A){c[u]=e[m]}if(Math.abs(c[p][0]-e[r][0])<A&&Math.abs(c[p][1]-e[r][1])<A){c[p]=e[r]}}}else{if(f){this.computeIntersection(c[u],c[u-1],d[k],d[k+1],v);this.computeIntersection(c[p],c[p+1],d[s],d[s-1],v);if(e!=null){if(Math.abs(c[u][0]-e[k][0])<A&&Math.abs(c[u][1]-e[k][1])<A){c[u]=e[k]}if(Math.abs(c[p][0]-e[s][0])<A&&Math.abs(c[p][1]-e[s][1])<A){c[p]=e[s]}}}}}return c};b.prototype.getUnjoinedShapePoints=function(k){if(this.arcExtent!=null&&this.arcExtent!==0&&java.awt.geom.Point2D.distanceSq(this.xStart,this.yStart,this.xEnd,this.yEnd)>1e-10){var h=this.getArcCircleCenter();var u=Math.atan2(h[1]-this.yStart,h[0]-this.xStart);u+=2*Math.atan2(this.yStart-this.yEnd,this.xEnd-this.xStart);var t=java.awt.geom.Point2D.distance(h[0],h[1],this.xStart,this.yStart);var e=t+this.thickness/2;var p=Math.max(0,t-this.thickness/2);var s=e*Math.abs(this.arcExtent);var q=this.arcExtent/Math.sqrt(s);var g=((this.arcExtent/q)|0);if(k){if(q>0){if(this.leftSideBaseboard!=null){e+=this.leftSideBaseboard.getThickness()}if(this.rightSideBaseboard!=null){p-=this.rightSideBaseboard.getThickness()}}else{if(this.leftSideBaseboard!=null){p-=this.leftSideBaseboard.getThickness()}if(this.rightSideBaseboard!=null){e+=this.rightSideBaseboard.getThickness()}}}var c=([]);if(this.symmetric){if(Math.abs(this.arcExtent-g*q)>0.000001){q=this.arcExtent/++g}for(var v=0;v<=g;v++){this.computeRoundWallShapePoint(c,u+this.arcExtent-v*q,v,q,h,e,p)}}else{var v=0;for(var w=this.arcExtent;q>0?w>=q*0.1:w<=-q*0.1;w-=q,v++){this.computeRoundWallShapePoint(c,u+w,v,q,h,e,p)}this.computeRoundWallShapePoint(c,u,v,q,h,e,p)}return c.slice(0)}else{var w=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var d=Math.sin(w);var f=Math.cos(w);var n=this.thickness/2;if(k&&this.leftSideBaseboard!=null){n+=this.leftSideBaseboard.getThickness()}var l=d*n;var j=f*n;var r=this.thickness/2;if(k&&this.rightSideBaseboard!=null){r+=this.rightSideBaseboard.getThickness()}var o=d*r;var m=f*r;return[[this.xStart+l,this.yStart-j],[this.xEnd+l,this.yEnd-j],[this.xEnd-o,this.yEnd+m],[this.xStart-o,this.yStart+m]]}};b.prototype.computeRoundWallShapePoint=function(n,e,g,d,l,c,h){var m=Math.cos(e);var k=Math.sin(e);var f=[(l[0]+h*m),(l[1]-h*k)];var j=[(l[0]+c*m),(l[1]-c*k)];if(d>0){n.splice(g,0,f);n.splice(n.length-1-g,0,j)}else{n.splice(g,0,j);n.splice(n.length-1-g,0,f)}};b.prototype.computeIntersection=function(l,j,h,g,c){var o=(j[1]-l[1])/(j[0]-l[0]);var n=(g[1]-h[1])/(g[0]-h[0]);if(o!==n){var m=l[0];var k=l[1];if(Math.abs(o)>4000){if(Math.abs(n)<4000){m=l[0];var e=g[1]-n*g[0];k=n*m+e}}else{if(Math.abs(n)>4000){if(Math.abs(o)<4000){m=h[0];var f=j[1]-o*j[0];k=o*m+f}}else{var d=(function(p){if(p>0){return 1}else{if(p<0){return -1}else{return 0}}})(o)===(function(p){if(p>0){return 1}else{if(p<0){return -1}else{return 0}}})(n);if(Math.abs(o-n)>0.00001&&(!d||(Math.abs(o)>Math.abs(n)?o/n:n/o)>1.004)){var f=j[1]-o*j[0];var e=g[1]-n*g[0];m=(e-f)/(o-n);k=o*m+f}}}if(java.awt.geom.Point2D.distanceSq(m,k,l[0],l[1])<c*c){l[0]=m;l[1]=k}}};b.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape(false).intersects(d)};b.prototype.containsPoint$float$float$float=function(c,e,d){return this.containsPoint$float$float$boolean$float(c,e,false,d)};b.prototype.containsPoint$float$float$boolean$float=function(c,f,e,d){return this.containsShapeAtWithMargin(this.getShape(e),c,f,d)};b.prototype.containsPoint=function(c,f,e,d){if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&((typeof e==="boolean")||e===null)&&((typeof d==="number")||d===null)){return this.containsPoint$float$float$boolean$float(c,f,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.containsPoint$float$float$float(c,f,e)}else{throw new Error("invalid overload")}}};b.prototype.isMiddlePointAt=function(c,j,h){var g=this.getPoints$();var f=(g.length/4|0);var e=g.length-1-f;var d=g.length%4===0?new java.awt.geom.Line2D.Float((g[f-1][0]+g[f][0])/2,(g[f-1][1]+g[f][1])/2,(g[e][0]+g[e+1][0])/2,(g[e][1]+g[e+1][1])/2):new java.awt.geom.Line2D.Float(g[f][0],g[f][1],g[e][0],g[e][1]);return this.containsShapeAtWithMargin(d,c,j,h)};b.prototype.containsWallStartAt=function(c,g,e){var d=this.getPoints$();var f=new java.awt.geom.Line2D.Float(d[0][0],d[0][1],d[d.length-1][0],d[d.length-1][1]);return this.containsShapeAtWithMargin(f,c,g,e)};b.prototype.containsWallEndAt=function(c,g,f){var d=this.getPoints$();var e=new java.awt.geom.Line2D.Float(d[(d.length/2|0)-1][0],d[(d.length/2|0)-1][1],d[(d.length/2|0)][0],d[(d.length/2|0)][1]);return this.containsShapeAtWithMargin(e,c,g,f)};b.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};b.prototype.getShape=function(f){if(this.shapeCache==null){var c=this.getPoints$boolean(f);var e=new java.awt.geom.GeneralPath();e.moveTo(c[0][0],c[0][1]);for(var d=1;d<c.length;d++){e.lineTo(c[d][0],c[d][1])}e.closePath();this.shapeCache=e}return this.shapeCache};b.prototype.move=function(d,c){this.setXStart(this.getXStart()+d);this.setYStart(this.getYStart()+c);this.setXEnd(this.getXEnd()+d);this.setYEnd(this.getYEnd()+c)};b.duplicate=function(e){var f=([]);for(var d=0;d<e.length;d++){var c=e[d];(f.push(c.duplicate())>0)}b.updateBoundWalls(f,e);return f};b.clone=function(e){var f=([]);for(var d=0;d<e.length;d++){var c=e[d];(f.push((function(h){if(h.clone!=undefined){return h.clone()}else{var j=Object.create(h);for(var g in h){if(h.hasOwnProperty(g)){j[g]=h[g]}}return j}})(c))>0)}b.updateBoundWalls(f,e);return f};b.updateBoundWalls=function(g,d){for(var e=0;e<d.length;e++){var c=d[e];var f=d.indexOf(c.getWallAtStart());if(f!==-1){g[e].setWallAtStart(g[f])}var h=d.indexOf(c.getWallAtEnd());if(h!==-1){g[e].setWallAtEnd(g[h])}}};b.prototype.clone=function(){var d=this;var c=(function(f){if(a.prototype.clone!=undefined){return a.prototype.clone.call(d)}else{var g=Object.create(f);for(var e in f){if(f.hasOwnProperty(e)){g[e]=f[e]}}return g}})(this);c.wallAtStart=null;c.wallAtEnd=null;c.level=null;c.shapeCache=null;c.pointsCache=null;c.pointsIncludingBaseboardsCache=null;return c};return b}(HomeObject));Wall.__class="com.eteks.sweethome3d.model.Wall";Wall.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];Wall.__transients=["shapeCache","arcCircleCenterCache","pointsCache","pointsIncludingBaseboardsCache","propertyChangeSupport"];var DimensionLine=(function(b){__extends(a,b);function a(H,p,z,e,x,F,v,s){var J=this;if(((typeof H==="string")||H===null)&&((typeof p==="number")||p===null)&&((typeof z==="number")||z===null)&&((typeof e==="number")||e===null)&&((typeof x==="number")||x===null)&&((typeof F==="number")||F===null)&&((typeof v==="number")||v===null)&&((typeof s==="number")||s===null)){var u=arguments;J=b.call(this,H)||this;if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}J.xStart=p;J.yStart=z;J.elevationStart=e;J.xEnd=x;J.yEnd=F;J.elevationEnd=v;J.offset=s;J.endMarkSize=10}else{if(((typeof H==="number")||H===null)&&((typeof p==="number")||p===null)&&((typeof z==="number")||z===null)&&((typeof e==="number")||e===null)&&((typeof x==="number")||x===null)&&((typeof F==="number")||F===null)&&((typeof v==="number")||v===null)&&s===undefined){var u=arguments;var d=u[0];var G=u[1];var l=u[2];var r=u[3];var A=u[4];var h=u[5];var t=u[6];var E=arguments;var K=HomeObject.createId("dimensionLine");J=b.call(this,K)||this;if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}J.xStart=d;J.yStart=G;J.elevationStart=l;J.xEnd=r;J.yEnd=A;J.elevationEnd=h;J.offset=t;J.endMarkSize=10;if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}}else{if(((typeof H==="string")||H===null)&&((typeof p==="number")||p===null)&&((typeof z==="number")||z===null)&&((typeof e==="number")||e===null)&&((typeof x==="number")||x===null)&&((typeof F==="number")||F===null)&&v===undefined&&s===undefined){var u=arguments;var o=u[3];var y=u[4];var q=u[5];var C=arguments;var k=0;var g=0;J=b.call(this,H)||this;if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}J.xStart=p;J.yStart=z;J.elevationStart=k;J.xEnd=o;J.yEnd=y;J.elevationEnd=g;J.offset=q;J.endMarkSize=10;if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}}else{if(((typeof H==="number")||H===null)&&((typeof p==="number")||p===null)&&((typeof z==="number")||z===null)&&((typeof e==="number")||e===null)&&((typeof x==="number")||x===null)&&F===undefined&&v===undefined&&s===undefined){var u=arguments;var c=u[0];var D=u[1];var m=u[2];var w=u[3];var n=u[4];var B=arguments;var j=0;var f=0;var L=arguments;var I=HomeObject.createId("dimensionLine");J=b.call(this,I)||this;if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}J.xStart=c;J.yStart=D;J.elevationStart=j;J.xEnd=m;J.yEnd=w;J.elevationEnd=f;J.offset=n;J.endMarkSize=10;if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}if(J.xStart===undefined){J.xStart=0}if(J.yStart===undefined){J.yStart=0}if(J.elevationStart===undefined){J.elevationStart=0}if(J.xEnd===undefined){J.xEnd=0}if(J.yEnd===undefined){J.yEnd=0}if(J.elevationEnd===undefined){J.elevationEnd=0}if(J.offset===undefined){J.offset=0}if(J.endMarkSize===undefined){J.endMarkSize=0}if(J.pitch===undefined){J.pitch=0}if(J.lengthStyle===undefined){J.lengthStyle=null}if(J.color===undefined){J.color=null}if(J.visibleIn3D===undefined){J.visibleIn3D=false}if(J.level===undefined){J.level=null}if(J.shapeCache===undefined){J.shapeCache=null}}else{throw new Error("invalid overload")}}}}return J}a.prototype.getXStart=function(){return this.xStart};a.prototype.setXStart=function(d){if(d!==this.xStart){var c=this.xStart;this.xStart=d;this.shapeCache=null;this.firePropertyChange("X_START",c,d)}};a.prototype.getYStart=function(){return this.yStart};a.prototype.setYStart=function(d){if(d!==this.yStart){var c=this.yStart;this.yStart=d;this.shapeCache=null;this.firePropertyChange("Y_START",c,d)}};a.prototype.getElevationStart=function(){return this.elevationStart};a.prototype.setElevationStart=function(d){if(d!==this.elevationStart){var c=this.elevationStart;this.elevationStart=d;this.shapeCache=null;this.firePropertyChange("ELEVATION_START",c,d)}};a.prototype.getXEnd=function(){return this.xEnd};a.prototype.setXEnd=function(c){if(c!==this.xEnd){var d=this.xEnd;this.xEnd=c;this.shapeCache=null;this.firePropertyChange("X_END",d,c)}};a.prototype.getYEnd=function(){return this.yEnd};a.prototype.setYEnd=function(c){if(c!==this.yEnd){var d=this.yEnd;this.yEnd=c;this.shapeCache=null;this.firePropertyChange("Y_END",d,c)}};a.prototype.getElevationEnd=function(){return this.elevationEnd};a.prototype.setElevationEnd=function(c){if(c!==this.elevationEnd){var d=this.elevationEnd;this.elevationEnd=c;this.shapeCache=null;this.firePropertyChange("ELEVATION_END",d,c)}};a.prototype.isElevationDimensionLine=function(){return this.xStart===this.xEnd&&this.yStart===this.yEnd&&this.elevationStart!==this.elevationEnd};a.prototype.getOffset=function(){return this.offset};a.prototype.setOffset=function(d){if(d!==this.offset){var c=this.offset;this.offset=d;this.shapeCache=null;this.firePropertyChange("OFFSET",c,d)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setPitch=function(d){if(d!==this.pitch){var c=this.pitch;this.pitch=d;this.shapeCache=null;this.firePropertyChange("PITCH",c,d)}};a.prototype.getLength=function(){var d=this.xEnd-this.xStart;var c=this.yEnd-this.yStart;var e=this.elevationEnd-this.elevationStart;return Math.sqrt(d*d+c*c+e*e)};a.prototype.getLengthStyle=function(){return this.lengthStyle};a.prototype.setLengthStyle=function(c){if(c!==this.lengthStyle){var d=this.lengthStyle;this.lengthStyle=c;this.firePropertyChange("LENGTH_STYLE",d,c)}};a.prototype.getColor=function(){return this.color};a.prototype.setColor=function(c){if(c!==this.color){var d=this.color;this.color=c;this.firePropertyChange("COLOR",d,c)}};a.prototype.getEndMarkSize=function(){return this.endMarkSize};a.prototype.setEndMarkSize=function(c){if(c!==this.endMarkSize){var d=this.endMarkSize;this.endMarkSize=c;this.shapeCache=null;this.firePropertyChange("END_MARK_SIZE",d,c)}};a.prototype.isVisibleIn3D=function(){return this.visibleIn3D};a.prototype.setVisibleIn3D=function(c){if(c!==this.visibleIn3D){this.visibleIn3D=c;this.firePropertyChange("VISIBLE_IN_3D",!c,c)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(e){if(this.level===e){return true}else{if(this.level!=null&&e!=null){var c=this.level.getElevation();var d=e.getElevation();return c===d&&this.level.getElevationIndex()<e.getElevationIndex()||c<d&&c+Math.max(this.elevationStart,this.elevationEnd)>d}else{return false}}};a.prototype.getPoints=function(){var e=this.isElevationDimensionLine()?this.pitch:Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var d=-Math.sin(e)*this.offset;var c=Math.cos(e)*this.offset;return[[this.xStart,this.yStart],[this.xStart+d,this.yStart+c],[this.xEnd+d,this.yEnd+c],[this.xEnd,this.yEnd]]};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){return this.containsShapeAtWithMargin(this.getShape(),c,e,d)};a.prototype.isMiddlePointAt=function(c,k,g){if(this.elevationStart===this.elevationEnd){var h=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var e=-Math.sin(h)*this.offset;var d=Math.cos(h)*this.offset;var j=(this.xStart+this.xEnd)/2+e;var f=(this.yStart+this.yEnd)/2+d;return Math.abs(c-j)<=g&&Math.abs(k-f)<=g}else{return false}};a.prototype.containsStartExtensionLinetAt=function(c,g,e){if(this.elevationStart===this.elevationEnd){var f=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var d=new java.awt.geom.Line2D.Float(this.xStart,this.yStart,this.xStart+-Math.sin(f)*this.offset,this.yStart+Math.cos(f)*this.offset);return this.containsShapeAtWithMargin(d,c,g,e)}else{return false}};a.prototype.containsEndExtensionLineAt=function(d,g,e){if(this.elevationStart===this.elevationEnd){var f=Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart);var c=new java.awt.geom.Line2D.Float(this.xEnd,this.yEnd,this.xEnd+-Math.sin(f)*this.offset,this.yEnd+Math.cos(f)*this.offset);return this.containsShapeAtWithMargin(c,d,g,e)}else{return false}};a.prototype.isTopPointAt=function(c,j,f){if(this.elevationStart!==this.elevationEnd){var h=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch;var e=-Math.sin(h)*(this.offset-this.endMarkSize/2*((function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)===0?-1:(function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)));var d=Math.cos(h)*(this.offset-this.endMarkSize/2*((function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)===0?-1:(function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)));var g=java.awt.geom.Point2D.distanceSq(c,j,this.xStart+e,this.yStart+d);return g<=f*f}else{return false}};a.prototype.isRightPointAt=function(h,g,e){if(this.elevationStart!==this.elevationEnd){var d=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch;var f=Math.sin(d);var j=Math.cos(d);var l=-f*this.offset+j*this.endMarkSize/2;var k=j*this.offset+f*this.endMarkSize/2;var c=java.awt.geom.Point2D.distanceSq(h,g,this.xStart+l,this.yStart+k);return c<=e*e}else{return false}};a.prototype.isBottomPointAt=function(c,j,f){if(this.elevationStart!==this.elevationEnd){var h=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch;var e=-Math.sin(h)*(this.offset+this.endMarkSize/2*((function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)===0?-1:(function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)));var d=Math.cos(h)*(this.offset+this.endMarkSize/2*((function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)===0?-1:(function(k){if(k>0){return 1}else{if(k<0){return -1}else{return 0}}})(this.offset)));var g=java.awt.geom.Point2D.distanceSq(c,j,this.xStart+e,this.yStart+d);return g<=f*f}else{return false}};a.prototype.isLeftPointAt=function(h,g,e){if(this.elevationStart!==this.elevationEnd){var d=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch;var f=Math.sin(d);var j=Math.cos(d);var l=-f*this.offset-j*this.endMarkSize/2;var k=j*this.offset-f*this.endMarkSize/2;var c=java.awt.geom.Point2D.distanceSq(h,g,this.xStart+l,this.yStart+k);return c<=e*e}else{return false}};a.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.getShape=function(){if(this.shapeCache==null){var g=this.yEnd!==this.yStart||this.xEnd!==this.xStart?Math.atan2(this.yEnd-this.yStart,this.xEnd-this.xStart):this.pitch;var e=this.elevationStart===this.elevationEnd;var d=-Math.sin(g)*this.offset;var c=Math.cos(g)*this.offset;var f=new java.awt.geom.GeneralPath();if(e){f.append(new java.awt.geom.Line2D.Float(this.xStart+d,this.yStart+c,this.xEnd+d,this.yEnd+c),false);f.append(new java.awt.geom.Line2D.Float(this.xEnd,this.yEnd,this.xEnd+d,this.yEnd+c),false)}else{f.append(new java.awt.geom.Ellipse2D.Float(this.xStart+d-this.endMarkSize/2,this.yStart+c-this.endMarkSize/2,this.endMarkSize,this.endMarkSize),false)}f.append(new java.awt.geom.Line2D.Float(this.xStart,this.yStart,this.xStart+d,this.yStart+c),false);this.shapeCache=f}return this.shapeCache};a.prototype.move=function(d,c){this.setXStart(this.getXStart()+d);this.setYStart(this.getYStart()+c);this.setXEnd(this.getXEnd()+d);this.setYEnd(this.getYEnd()+c)};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var f=Object.create(g);for(var e in g){if(g.hasOwnProperty(e)){f[e]=g[e]}}return f}})(this);c.level=null;return c};return a}(HomeObject));DimensionLine.__class="com.eteks.sweethome3d.model.DimensionLine";DimensionLine.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];DimensionLine.__transients=["shapeCache","propertyChangeSupport"];var Camera=(function(b){__extends(a,b);function a(u,r,o,l,p,m,J,j,N){var B=this;if(((typeof u==="string")||u===null)&&((typeof r==="number")||r===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&((typeof p==="number")||p===null)&&((typeof m==="number")||m===null)&&((typeof J==="number")||J===null)&&((typeof j==="number")||j===null)&&((typeof N==="number")||N===null)){var h=arguments;B=b.call(this,u)||this;if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}B.x=r;B.y=o;B.z=l;B.yaw=p;B.pitch=m;B.fieldOfView=J;B.time=j;B.lens=N}else{if(((typeof u==="number")||u===null)&&((typeof r==="number")||r===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&((typeof p==="number")||p===null)&&((typeof m==="number")||m===null)&&((typeof J==="number")||J===null)&&((typeof j==="number")||j===null)&&N===undefined){var h=arguments;var v=h[0];var d=h[1];var F=h[2];var g=h[3];var E=h[4];var w=h[5];var q=h[6];var I=h[7];var O=arguments;var A=HomeObject.createId("camera");B=b.call(this,A)||this;if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}B.x=v;B.y=d;B.z=F;B.yaw=g;B.pitch=E;B.fieldOfView=w;B.time=q;B.lens=I;if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}}else{if(((typeof u==="string")||u===null)&&((typeof r==="number")||r===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&((typeof p==="number")||p===null)&&((typeof m==="number")||m===null)&&((typeof J==="number")||J===null)&&j===undefined&&N===undefined){var h=arguments;var M=arguments;var n=a.midday();var H=a.Lens.PINHOLE;B=b.call(this,u)||this;if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}B.x=r;B.y=o;B.z=l;B.yaw=p;B.pitch=m;B.fieldOfView=J;B.time=n;B.lens=H;if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}}else{if(((typeof u==="number")||u===null)&&((typeof r==="number")||r===null)&&((typeof o==="number")||o===null)&&((typeof l==="number")||l===null)&&((typeof p==="number")||p===null)&&((typeof m==="number")||m===null)&&J===undefined&&j===undefined&&N===undefined){var h=arguments;var t=h[0];var c=h[1];var D=h[2];var e=h[3];var C=h[4];var s=h[5];var L=arguments;var k=a.midday();var G=a.Lens.PINHOLE;var K=arguments;var f=HomeObject.createId("camera");B=b.call(this,f)||this;if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}B.x=t;B.y=c;B.z=D;B.yaw=e;B.pitch=C;B.fieldOfView=s;B.time=k;B.lens=G;if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}if(B.name===undefined){B.name=null}if(B.x===undefined){B.x=0}if(B.y===undefined){B.y=0}if(B.z===undefined){B.z=0}if(B.yaw===undefined){B.yaw=0}if(B.pitch===undefined){B.pitch=0}if(B.fieldOfView===undefined){B.fieldOfView=0}if(B.time===undefined){B.time=0}if(B.lens===undefined){B.lens=null}if(B.lensName===undefined){B.lensName=null}if(B.renderer===undefined){B.renderer=null}}else{throw new Error("invalid overload")}}}}return B}a.midday=function(){var c=new Date();(function(f,e){return f.UTC?f.setUTCHours(e):f.setHours(e)})(c,12);(function(f,e){return f.UTC?f.setUTCMinutes(e):f.setMinutes(e)})(c,0);(function(f,e){return f.UTC?f.setUTCSeconds(e):f.setSeconds(e)})(c,0);(function(f,e){return f.UTC?f.setUTCMilliseconds(e):f.setMilliseconds(e)})(c,0);return c.getTime()};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.getYaw=function(){return this.yaw};a.prototype.setYaw=function(d){if(d!==this.yaw){var c=this.yaw;this.yaw=d;this.firePropertyChange("YAW",c,d)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setPitch=function(d){if(d!==this.pitch){var c=this.pitch;this.pitch=d;this.firePropertyChange("PITCH",c,d)}};a.prototype.getFieldOfView=function(){return this.fieldOfView};a.prototype.setFieldOfView=function(c){if(c!==this.fieldOfView){var d=this.fieldOfView;this.fieldOfView=c;this.firePropertyChange("FIELD_OF_VIEW",d,c)}};a.prototype.getX=function(){return this.x};a.prototype.setX=function(c){if(c!==this.x){var d=this.x;this.x=c;this.firePropertyChange("X",d,c)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(d){if(d!==this.y){var c=this.y;this.y=d;this.firePropertyChange("Y",c,d)}};a.prototype.getZ=function(){return this.z};a.prototype.setZ=function(d){if(d!==this.z){var c=this.z;this.z=d;this.firePropertyChange("Z",c,d)}};a.prototype.getTime=function(){return this.time};a.prototype.setTime=function(c){if(this.time!==c){var d=this.time;this.time=c;this.firePropertyChange("TIME",d,c)}};a.convertTimeToTimeZone=function(d,e){var f=new Date();f.setTime(d);var c=new Date();(function(h,g){return h.UTC?h.setUTCFullYear(g):h.setFullYear(g)})(c,(function(g){return g.UTC?g.getUTCFullYear():g.getFullYear()})(f));(function(h,g){return h.UTC?h.setUTCMonth(g):h.setMonth(g)})(c,(function(g){return g.UTC?g.getUTCMonth():g.getMonth()})(f));(function(h,g){return h.UTC?h.setUTCDate(g):h.setDate(g)})(c,(function(g){return g.UTC?g.getUTCDate():g.getDate()})(f));(function(h,g){return h.UTC?h.setUTCHours(g):h.setHours(g)})(c,(function(g){return g.UTC?g.getUTCHours():g.getHours()})(f));(function(h,g){return h.UTC?h.setUTCMinutes(g):h.setMinutes(g)})(c,(function(g){return g.UTC?g.getUTCMinutes():g.getMinutes()})(f));(function(h,g){return h.UTC?h.setUTCSeconds(g):h.setSeconds(g)})(c,(function(g){return g.UTC?g.getUTCSeconds():g.getSeconds()})(f));(function(h,g){return h.UTC?h.setUTCMilliseconds(g):h.setMilliseconds(g)})(c,(function(g){return g.UTC?g.getUTCMilliseconds():g.getMilliseconds()})(f));return c.getTime()};a.prototype.getLens=function(){return this.lens};a.prototype.setLens=function(c){if(c!==this.lens){var d=this.lens;this.lens=c;this.lensName=a.Lens[this.lens];this.firePropertyChange("LENS",d,c)}};a.prototype.setRenderer=function(d){if(d!==this.renderer&&(d==null||!(d===this.renderer))){var c=this.renderer;this.renderer=d;this.firePropertyChange("RENDERER",c,d)}};a.prototype.getRenderer=function(){return this.renderer};a.prototype.setCamera=function(c){this.setX(c.getX());this.setY(c.getY());this.setZ(c.getZ());this.setYaw(c.getYaw());this.setPitch(c.getPitch());this.setFieldOfView(c.getFieldOfView())};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(HomeObject));Camera.__class="com.eteks.sweethome3d.model.Camera";(function(b){var a;(function(c){c[c.PINHOLE=0]="PINHOLE";c[c.NORMAL=1]="NORMAL";c[c.FISHEYE=2]="FISHEYE";c[c.SPHERICAL=3]="SPHERICAL"})(a=b.Lens||(b.Lens={}))})(Camera||(Camera={}));Camera.__transients=["lens","propertyChangeSupport"];var Level=(function(b){__extends(a,b);function a(e,c,n,g,o){var j=this;if(((typeof e==="string")||e===null)&&((typeof c==="string")||c===null)&&((typeof n==="number")||n===null)&&((typeof g==="number")||g===null)&&((typeof o==="number")||o===null)){var k=arguments;j=b.call(this,e)||this;if(j.name===undefined){j.name=null}if(j.elevation===undefined){j.elevation=0}if(j.floorThickness===undefined){j.floorThickness=0}if(j.height===undefined){j.height=0}if(j.backgroundImage===undefined){j.backgroundImage=null}if(j.visible===undefined){j.visible=false}if(j.viewable===undefined){j.viewable=false}if(j.elevationIndex===undefined){j.elevationIndex=0}j.name=c;j.elevation=n;j.floorThickness=g;j.height=o;j.visible=true;j.viewable=true;j.elevationIndex=-1}else{if(((typeof e==="string")||e===null)&&((typeof c==="number")||c===null)&&((typeof n==="number")||n===null)&&((typeof g==="number")||g===null)&&o===undefined){var k=arguments;var h=k[0];var l=k[1];var p=k[2];var f=k[3];var d=arguments;var m=HomeObject.createId("level");j=b.call(this,m)||this;if(j.name===undefined){j.name=null}if(j.elevation===undefined){j.elevation=0}if(j.floorThickness===undefined){j.floorThickness=0}if(j.height===undefined){j.height=0}if(j.backgroundImage===undefined){j.backgroundImage=null}if(j.visible===undefined){j.visible=false}if(j.viewable===undefined){j.viewable=false}if(j.elevationIndex===undefined){j.elevationIndex=0}j.name=h;j.elevation=l;j.floorThickness=p;j.height=f;j.visible=true;j.viewable=true;j.elevationIndex=-1;if(j.name===undefined){j.name=null}if(j.elevation===undefined){j.elevation=0}if(j.floorThickness===undefined){j.floorThickness=0}if(j.height===undefined){j.height=0}if(j.backgroundImage===undefined){j.backgroundImage=null}if(j.visible===undefined){j.visible=false}if(j.viewable===undefined){j.viewable=false}if(j.elevationIndex===undefined){j.elevationIndex=0}}else{throw new Error("invalid overload")}}return j}a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name&&(c==null||!(c===this.name))){var d=this.name;this.name=c;this.firePropertyChange("NAME",d,c)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};a.prototype.getFloorThickness=function(){return this.floorThickness};a.prototype.setFloorThickness=function(d){if(d!==this.floorThickness){var c=this.floorThickness;this.floorThickness=d;this.firePropertyChange("FLOOR_THICKNESS",c,d)}};a.prototype.getHeight=function(){return this.height};a.prototype.setHeight=function(c){if(c!==this.height){var d=this.height;this.height=c;this.firePropertyChange("HEIGHT",d,c)}};a.prototype.getBackgroundImage=function(){return this.backgroundImage};a.prototype.setBackgroundImage=function(d){if(d!==this.backgroundImage){var c=this.backgroundImage;this.backgroundImage=d;this.firePropertyChange("BACKGROUND_IMAGE",c,d)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(c){if(c!==this.visible){this.visible=c;this.firePropertyChange("VISIBLE",!c,c)}};a.prototype.isViewable=function(){return this.viewable};a.prototype.setViewable=function(c){if(c!==this.viewable){this.viewable=c;this.firePropertyChange("VIEWABLE",!c,c)}};a.prototype.isViewableAndVisible=function(){return this.viewable&&this.visible};a.prototype.getElevationIndex=function(){return this.elevationIndex};a.prototype.setElevationIndex=function(c){if(c!==this.elevationIndex){var d=this.elevationIndex;this.elevationIndex=c;this.firePropertyChange("ELEVATION_INDEX",d,c)}};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(HomeObject));Level.__class="com.eteks.sweethome3d.model.Level";Level.__transients=["propertyChangeSupport"];var Polyline=(function(b){__extends(a,b);function a(N,R,q,r,w,W,J,p,c,ak,I){var k=this;if(((typeof N==="string")||N===null)&&((R!=null&&R instanceof Array&&(R.length==0||R[0]==null||R[0] instanceof Array))||R===null)&&((typeof q==="number")||q===null)&&((typeof r==="number")||r===null)&&((typeof w==="number")||w===null)&&((typeof W==="number")||W===null)&&((typeof J==="number")||J===null)&&((typeof p==="number")||p===null)&&((typeof c==="number")||c===null)&&((typeof ak==="boolean")||ak===null)&&((typeof I==="number")||I===null)){var ad=arguments;k=b.call(this,N)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(R);k.thickness=q;k.capStyle=r;k.joinStyle=w;k.dashStyle=W;k.dashOffset=J;k.startArrowStyle=p;k.endArrowStyle=c;k.closedPath=ak;k.color=I}else{if(((N!=null&&N instanceof Array&&(N.length==0||N[0]==null||N[0] instanceof Array))||N===null)&&((typeof R==="number")||R===null)&&((typeof q==="number")||q===null)&&((typeof r==="number")||r===null)&&((typeof w==="number")||w===null)&&((typeof W==="number")||W===null)&&((typeof J==="number")||J===null)&&((typeof p==="number")||p===null)&&((typeof c==="boolean")||c===null)&&((typeof ak==="number")||ak===null)&&I===undefined){var ad=arguments;var aj=ad[0];var A=ad[1];var U=ad[2];var Y=ad[3];var e=ad[4];var H=ad[5];var j=ad[6];var o=ad[7];var E=ad[8];var X=ad[9];var ac=arguments;var y=HomeObject.createId("polyline");k=b.call(this,y)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(aj);k.thickness=A;k.capStyle=U;k.joinStyle=Y;k.dashStyle=e;k.dashOffset=H;k.startArrowStyle=j;k.endArrowStyle=o;k.closedPath=E;k.color=X;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{if(((N!=null&&N instanceof Array&&(N.length==0||N[0]==null||N[0] instanceof Array))||N===null)&&((typeof R==="number")||R===null)&&((typeof q==="number")||q===null)&&((typeof r==="number")||r===null)&&((typeof w==="number")||w===null)&&((typeof W==="number")||W===null)&&((typeof J==="number")||J===null)&&((typeof p==="boolean")||p===null)&&((typeof c==="number")||c===null)&&ak===undefined&&I===undefined){var ad=arguments;var ah=ad[0];var x=ad[1];var T=ad[2];var V=ad[3];var d=ad[4];var h=ad[5];var n=ad[6];var C=ad[7];var M=ad[8];var ab=arguments;var G=0;var aa=arguments;var v=HomeObject.createId("polyline");k=b.call(this,v)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(ah);k.thickness=x;k.capStyle=T;k.joinStyle=V;k.dashStyle=d;k.dashOffset=G;k.startArrowStyle=h;k.endArrowStyle=n;k.closedPath=C;k.color=M;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{if(((typeof N==="string")||N===null)&&((R!=null&&R instanceof Array&&(R.length==0||R[0]==null||R[0] instanceof Array))||R===null)&&q===undefined&&r===undefined&&w===undefined&&W===undefined&&J===undefined&&p===undefined&&c===undefined&&ak===undefined&&I===undefined){var ad=arguments;var Z=arguments;var u=1;var Q=a.CapStyle.BUTT;var S=a.JoinStyle.MITER;var am=a.DashStyle.SOLID;var F=0;var g=a.ArrowStyle.NONE;var m=a.ArrowStyle.NONE;var B=false;var L=-16777216;k=b.call(this,N)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(R);k.thickness=u;k.capStyle=Q;k.joinStyle=S;k.dashStyle=am;k.dashOffset=F;k.startArrowStyle=g;k.endArrowStyle=m;k.closedPath=B;k.color=L;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{if(((N!=null&&N instanceof Array&&(N.length==0||N[0]==null||N[0] instanceof Array))||N===null)&&R===undefined&&q===undefined&&r===undefined&&w===undefined&&W===undefined&&J===undefined&&p===undefined&&c===undefined&&ak===undefined&&I===undefined){var ad=arguments;var af=ad[0];var ai=arguments;var t=1;var O=a.CapStyle.BUTT;var P=a.JoinStyle.MITER;var al=a.DashStyle.SOLID;var f=a.ArrowStyle.NONE;var l=a.ArrowStyle.NONE;var z=false;var K=-16777216;var ag=arguments;var D=0;var ae=arguments;var s=HomeObject.createId("polyline");k=b.call(this,s)||this;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}k.points=k.deepCopy(af);k.thickness=t;k.capStyle=O;k.joinStyle=P;k.dashStyle=al;k.dashOffset=D;k.startArrowStyle=f;k.endArrowStyle=l;k.closedPath=z;k.color=K;if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}if(k.points===undefined){k.points=null}if(k.thickness===undefined){k.thickness=0}if(k.capStyle===undefined){k.capStyle=null}if(k.capStyleName===undefined){k.capStyleName=null}if(k.joinStyle===undefined){k.joinStyle=null}if(k.joinStyleName===undefined){k.joinStyleName=null}if(k.dashStyle===undefined){k.dashStyle=null}if(k.dashStyleName===undefined){k.dashStyleName=null}if(k.dashPattern===undefined){k.dashPattern=null}if(k.dashOffset===undefined){k.dashOffset=0}if(k.startArrowStyle===undefined){k.startArrowStyle=null}if(k.startArrowStyleName===undefined){k.startArrowStyleName=null}if(k.endArrowStyle===undefined){k.endArrowStyle=null}if(k.endArrowStyleName===undefined){k.endArrowStyleName=null}if(k.closedPath===undefined){k.closedPath=false}if(k.color===undefined){k.color=0}if(k.elevation===undefined){k.elevation=null}if(k.level===undefined){k.level=null}if(k.polylinePathCache===undefined){k.polylinePathCache=null}if(k.shapeCache===undefined){k.shapeCache=null}}else{throw new Error("invalid overload")}}}}}return k}a.prototype.getPoints=function(){return this.deepCopy(this.points)};a.prototype.getPointCount=function(){return this.points.length};a.prototype.deepCopy=function(e){var c=(function(g){var f=[];while(g-->0){f.push(null)}return f})(e.length);for(var d=0;d<e.length;d++){c[d]=e[d].slice(0)}return c};a.prototype.setPoints=function(c){if(!(JSON.stringify(this.points)===JSON.stringify(c))){this.updatePoints(c)}};a.prototype.updatePoints=function(d){var c=this.points;this.points=this.deepCopy(d);this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",c,d)};a.prototype.addPoint$float$float=function(c,d){this.addPoint$float$float$int(c,d,this.points.length)};a.prototype.addPoint$float$float$int=function(c,g,d){if(d<0||d>this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}var f=(function(j){var h=[];while(j-->0){h.push(null)}return h})(this.points.length+1);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,0,f,0,d);f[d]=[c,g];(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(this.points,d,f,d+1,this.points.length-d);var e=this.points;this.points=f;this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))};a.prototype.addPoint=function(c,e,d){if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&((typeof d==="number")||d===null)){return this.addPoint$float$float$int(c,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.addPoint$float$float(c,e)}else{throw new Error("invalid overload")}}};a.prototype.setPoint=function(c,f,d){if(d<0||d>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+d),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}if(this.points[d][0]!==c||this.points[d][1]!==f){var e=this.points;this.points=this.deepCopy(this.points);this.points[d][0]=c;this.points[d][1]=f;this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",e,this.deepCopy(this.points))}};a.prototype.removePoint=function(c){if(c<0||c>=this.points.length){throw Object.defineProperty(new Error("Invalid index "+c),"__classes",{configurable:true,value:["java.lang.Throwable","java.lang.IndexOutOfBoundsException","java.lang.Object","java.lang.RuntimeException","java.lang.Exception"]})}var e=(function(g){var f=[];while(g-->0){f.push(null)}return f})(this.points.length-1);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,0,e,0,c);(function(k,j,m,l,h){if(k!==m||l>=j+h){while(--h>=0){m[l++]=k[j++]}}else{var g=k.slice(j,j+h);for(var f=0;f<h;f++){m[l++]=g[f]}}})(this.points,c+1,e,c,this.points.length-c-1);var d=this.points;this.points=e;this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("POINTS",d,this.deepCopy(this.points))};a.prototype.getThickness=function(){return this.thickness};a.prototype.setThickness=function(d){if(d!==this.thickness){var c=this.thickness;this.thickness=d;this.firePropertyChange("THICKNESS",c,d)}};a.prototype.getCapStyle=function(){return this.capStyle};a.prototype.setCapStyle=function(d){if(d!==this.capStyle){var c=this.capStyle;this.capStyle=d;this.capStyleName=a.CapStyle[this.capStyle];this.firePropertyChange("CAP_STYLE",c,d)}};a.prototype.getJoinStyle=function(){return this.joinStyle};a.prototype.setJoinStyle=function(d){if(d!==this.joinStyle){var c=this.joinStyle;this.joinStyle=d;this.joinStyleName=a.JoinStyle[this.joinStyle];this.polylinePathCache=null;this.shapeCache=null;this.firePropertyChange("JOIN_STYLE",c,d)}};a.prototype.getDashStyle=function(){return this.dashStyle};a.prototype.setDashStyle=function(e){if(e!==this.dashStyle){var c=this.getDashPattern();var d=this.dashStyle;this.dashStyle=e;this.dashStyleName=a.DashStyle[this.dashStyle];if(e!==a.DashStyle.CUSTOMIZED){this.dashPattern=null}this.firePropertyChange("DASH_PATTERN",c,this.getDashPattern());this.firePropertyChange("DASH_STYLE",d,e)}};a.prototype.getDashPattern=function(){var c=null;if(this.dashStyle!==a.DashStyle.CUSTOMIZED){return a.DashStyle["_$wrappers"][this.dashStyle].getDashPattern()}else{if(this.dashPattern!=null){c=this.dashPattern.slice(0)}}return c};a.prototype.setDashPattern=function(c){var h=function(){var j=[];for(var k in a.DashStyle){if(!isNaN(k)){j.push(parseInt(k,10))}}return j}();for(var e=0;e<h.length;e++){var g=h[e];if(this.dashStyle!==a.DashStyle.CUSTOMIZED){if((function(k,j){if(k==null&&j==null){return true}if(k==null||j==null){return false}if(k.length!=j.length){return false}for(var l=0;l<k.length;l++){if(k[l]!=j[l]){return false}}return true})(c,a.DashStyle["_$wrappers"][g].getDashPattern())){this.setDashStyle(g);return}}}if(!(function(k,j){if(k==null&&j==null){return true}if(k==null||j==null){return false}if(k.length!=j.length){return false}for(var l=0;l<k.length;l++){if(k[l]!=j[l]){return false}}return true})(c,this.dashPattern)){var d=this.getDashPattern();this.dashPattern=c.slice(0);this.firePropertyChange("DASH_PATTERN",d,c);var f=this.dashStyle;this.dashStyle=a.DashStyle.CUSTOMIZED;this.dashStyleName=a.DashStyle[this.dashStyle];this.firePropertyChange("DASH_STYLE",f,a.DashStyle.CUSTOMIZED)}};a.prototype.getDashOffset=function(){return this.dashOffset};a.prototype.setDashOffset=function(d){if(d!==this.dashOffset){var c=this.dashOffset;this.dashOffset=d;this.firePropertyChange("DASH_OFFSET",c,d)}};a.prototype.getStartArrowStyle=function(){return this.startArrowStyle};a.prototype.setStartArrowStyle=function(d){if(d!==this.startArrowStyle){var c=this.startArrowStyle;this.startArrowStyle=d;this.startArrowStyleName=a.ArrowStyle[this.startArrowStyle];this.firePropertyChange("START_ARROW_STYLE",c,d)}};a.prototype.getEndArrowStyle=function(){return this.endArrowStyle};a.prototype.setEndArrowStyle=function(c){if(c!==this.endArrowStyle){var d=this.endArrowStyle;this.endArrowStyle=c;this.endArrowStyleName=a.ArrowStyle[this.endArrowStyle];this.firePropertyChange("END_ARROW_STYLE",d,c)}};a.prototype.isClosedPath=function(){return this.closedPath};a.prototype.setClosedPath=function(c){if(c!==this.closedPath){this.closedPath=c;this.firePropertyChange("CLOSED_PATH",!c,c)}};a.prototype.getColor=function(){return this.color};a.prototype.setColor=function(c){if(c!==this.color){var d=this.color;this.color=c;this.firePropertyChange("COLOR",d,c)}};a.prototype.getGroundElevation=function(){var c=this.getElevation();if(this.level!=null){return c+this.level.getElevation()}else{return c}};a.prototype.getElevation=function(){return this.elevation!=null?this.elevation:0};a.prototype.setElevation=function(d){if(this.elevation!=null&&d!==this.elevation){var c=this.elevation;this.elevation=d;this.firePropertyChange("ELEVATION",c,d)}};a.prototype.isVisibleIn3D=function(){return this.elevation!=null};a.prototype.setVisibleIn3D=function(c){if((c)!==((this.elevation!=null))){this.elevation=c?0:null;this.firePropertyChange("VISIBLE_IN_3D",!c,c)}};a.prototype.getLevel=function(){return this.level};a.prototype.setLevel=function(d){if(d!==this.level){var c=this.level;this.level=d;this.firePropertyChange("LEVEL",c,d)}};a.prototype.isAtLevel=function(c){return this.level===c||this.level!=null&&c!=null&&this.level.getElevation()===c.getElevation()&&this.level.getElevationIndex()<c.getElevationIndex()};a.prototype.getLength=function(){var g=[0,0];var e=[0,0];var c=[0,0];var f=0;for(var d=this.getPolylinePath().getPathIterator(null,0.1);!d.isDone();d.next()){switch((d.currentSegment(c))){case java.awt.geom.PathIterator.SEG_CLOSE:f+=java.awt.geom.Point2D.distance(g[0],g[1],e[0],e[1]);break;case java.awt.geom.PathIterator.SEG_MOVETO:(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(c,0,g,0,2);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(c,0,e,0,2);break;case java.awt.geom.PathIterator.SEG_LINETO:f+=java.awt.geom.Point2D.distance(e[0],e[1],c[0],c[1]);(function(m,l,o,n,k){if(m!==o||n>=l+k){while(--k>=0){o[n++]=m[l++]}}else{var j=m.slice(l,l+k);for(var h=0;h<k;h++){o[n++]=j[h]}}})(c,0,e,0,2);break}}return f};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){return this.containsShapeAtWithMargin(this.getShape(),c,e,d)};a.prototype.getPointIndexAt=function(c,f,e){for(var d=0;d<this.points.length;d++){if(Math.abs(c-this.points[d][0])<=e&&Math.abs(f-this.points[d][1])<=e){return d}}return -1};a.prototype.containsShapeAtWithMargin=function(d,c,f,e){if(e===0){return d.contains(c,f)}else{return d.intersects(c-e,f-e,2*e,2*e)}};a.prototype.getPolylinePath=function(){if(this.polylinePathCache==null){var j=new java.awt.geom.GeneralPath();if(this.joinStyle===a.JoinStyle.CURVED){for(var g=0,c=this.closedPath?this.points.length:this.points.length-1;g<c;g++){var h=new java.awt.geom.CubicCurve2D.Float();var e=this.points[g===0?this.points.length-1:g-1];var m=this.points[g];var k=this.points[g===this.points.length-1?0:g+1];var l=[k[0]-e[0],k[1]-e[1]];var d=this.points[(g+2)%this.points.length];var f=[m[0]-d[0],m[1]-d[1]];h.setCurve(m[0],m[1],m[0]+(g!==0||this.closedPath?l[0]/3.625:0),m[1]+(g!==0||this.closedPath?l[1]/3.625:0),k[0]+(g!==this.points.length-2||this.closedPath?f[0]/3.625:0),k[1]+(g!==this.points.length-2||this.closedPath?f[1]/3.625:0),k[0],k[1]);j.append(h,true)}}else{j.moveTo(this.points[0][0],this.points[0][1]);for(var g=1;g<this.points.length;g++){j.lineTo(this.points[g][0],this.points[g][1])}if(this.closedPath){j.closePath()}}this.polylinePathCache=j}return this.polylinePathCache};a.prototype.getShape=function(){if(this.shapeCache==null){this.shapeCache=new java.awt["BasicStroke"](this.thickness).createStrokedShape(this.getPolylinePath())}return this.shapeCache};a.prototype.move=function(d,c){if(d!==0||c!==0){var f=this.getPoints();for(var e=0;e<f.length;e++){f[e][0]+=d;f[e][1]+=c}this.updatePoints(f)}};a.prototype.clone=function(){var d=this;var c=(function(g){if(b.prototype.clone!=undefined){return b.prototype.clone.call(d)}else{var f=Object.create(g);for(var e in g){if(g.hasOwnProperty(e)){f[e]=g[e]}}return f}})(this);c.level=null;return c};return a}(HomeObject));Polyline.__class="com.eteks.sweethome3d.model.Polyline";Polyline.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.Elevatable"];(function(b){var c;(function(g){g[g.BUTT=0]="BUTT";g[g.SQUARE=1]="SQUARE";g[g.ROUND=2]="ROUND"})(c=b.CapStyle||(b.CapStyle={}));var e;(function(g){g[g.BEVEL=0]="BEVEL";g[g.MITER=1]="MITER";g[g.ROUND=2]="ROUND";g[g.CURVED=3]="CURVED"})(e=b.JoinStyle||(b.JoinStyle={}));var f;(function(g){g[g.NONE=0]="NONE";g[g.DELTA=1]="DELTA";g[g.OPEN=2]="OPEN";g[g.DISC=3]="DISC"})(f=b.ArrowStyle||(b.ArrowStyle={}));var d;(function(g){g[g.SOLID=0]="SOLID";g[g.DOT=1]="DOT";g[g.DASH=2]="DASH";g[g.DASH_DOT=3]="DASH_DOT";g[g.DASH_DOT_DOT=4]="DASH_DOT_DOT";g[g.CUSTOMIZED=5]="CUSTOMIZED"})(d=b.DashStyle||(b.DashStyle={}));var a=(function(){function g(j,h){this._$ordinal=j;this._$name=h}g.prototype.getDashPattern=function(){switch((this._$ordinal)){case b.DashStyle.SOLID:return[1,0];case b.DashStyle.DOT:return[1,1];case b.DashStyle.DASH:return[4,2];case b.DashStyle.DASH_DOT:return[8,2,2,2];case b.DashStyle.DASH_DOT_DOT:return[8,2,2,2,2,2];default:return null}};g.prototype.name=function(){return this._$name};g.prototype.ordinal=function(){return this._$ordinal};g.prototype.compareTo=function(h){return this._$ordinal-(isNaN(h)?h._$ordinal:h)};return g}());b.DashStyle_$WRAPPER=a;d.__class="com.eteks.sweethome3d.model.Polyline.DashStyle";d["_$wrappers"]={0:new a(0,"SOLID"),1:new a(1,"DOT"),2:new a(2,"DASH"),3:new a(3,"DASH_DOT"),4:new a(4,"DASH_DOT_DOT"),5:new a(5,"CUSTOMIZED")}})(Polyline||(Polyline={}));Polyline.__transients=["capStyle","joinStyle","dashStyle","startArrowStyle","endArrowStyle","polylinePathCache","shapeCache","propertyChangeSupport"];var CatalogDoorOrWindow=(function(b){__extends(a,b);function a(V,aq,al,ad,bY,F,a8,bV,v,az,bX,bm,e,bT,bl,bD,b5,aP,R,at,bf,aC,bP,an,am,ba,ao,bL,bJ,g,av,q,bS,M,G){var bh=this;if(((typeof V==="string")||V===null)&&((typeof aq==="string")||aq===null)&&((typeof al==="string")||al===null)&&((typeof ad==="string")||ad===null)&&((typeof bY==="string")||bY===null)&&((F!=null&&F instanceof Array&&(F.length==0||F[0]==null||(typeof F[0]==="string")))||F===null)&&((typeof a8==="number")||a8===null)&&((typeof bV==="number")||bV===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||v===null)&&((az!=null&&(az.constructor!=null&&az.constructor.__interfaces!=null&&az.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||az===null)&&((bX!=null&&(bX.constructor!=null&&bX.constructor.__interfaces!=null&&bX.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bX===null)&&((typeof bm==="number")||bm===null)&&((typeof e==="number")||e===null)&&((typeof bT==="number")||bT===null)&&((typeof bl==="number")||bl===null)&&((typeof bD==="number")||bD===null)&&((typeof b5==="boolean")||b5===null)&&((typeof aP==="string")||aP===null)&&((typeof R==="number")||R===null)&&((typeof at==="number")||at===null)&&((typeof bf==="boolean")||bf===null)&&((typeof aC==="boolean")||aC===null)&&((bP!=null&&bP instanceof Array&&(bP.length==0||bP[0]==null||(bP[0]!=null&&bP[0] instanceof Sash)))||bP===null)&&((an!=null&&an instanceof Array&&(an.length==0||an[0]==null||an[0] instanceof Array))||an===null)&&((typeof am==="number")||am===null)&&((typeof ba==="number")||ba===null)&&((typeof ao==="string")||ao===null)&&((typeof bL==="boolean")||bL===null)&&((typeof bJ==="boolean")||bJ===null)&&((typeof g==="boolean")||g===null)&&((av!=null&&av instanceof Big)||av===null)&&((q!=null&&q instanceof Big)||q===null)&&((typeof bS==="string")||bS===null)&&((M!=null&&(M instanceof Object))||M===null)&&((G!=null&&(G instanceof Object))||G===null)){var l=arguments;bh=b.call(this,V,aq,al,ad,bY,F,a8,bV,v,az,bX,bm,e,bT,bl,bD,b5,null,an,am,ba,ao,bL,bJ,g,false,av,q,bS,M,G)||this;if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}bh.cutOutShape=aP;bh.wallThickness=R;bh.wallDistance=at;bh.wallCutOutOnBothSides=bf;bh.widthDepthDeformable=aC;bh.sashes=bP}else{if(((typeof V==="string")||V===null)&&((typeof aq==="string")||aq===null)&&((typeof al==="string")||al===null)&&((typeof ad==="string")||ad===null)&&((bY!=null&&bY instanceof Array&&(bY.length==0||bY[0]==null||(typeof bY[0]==="string")))||bY===null)&&((typeof F==="number")||F===null)&&((typeof a8==="number")||a8===null)&&((bV!=null&&(bV.constructor!=null&&bV.constructor.__interfaces!=null&&bV.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bV===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||v===null)&&((az!=null&&(az.constructor!=null&&az.constructor.__interfaces!=null&&az.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||az===null)&&((typeof bX==="number")||bX===null)&&((typeof bm==="number")||bm===null)&&((typeof e==="number")||e===null)&&((typeof bT==="number")||bT===null)&&((typeof bl==="number")||bl===null)&&((typeof bD==="boolean")||bD===null)&&((typeof b5==="string")||b5===null)&&((typeof aP==="number")||aP===null)&&((typeof R==="number")||R===null)&&((typeof at==="boolean")||at===null)&&((typeof bf==="boolean")||bf===null)&&((aC!=null&&aC instanceof Array&&(aC.length==0||aC[0]==null||(aC[0]!=null&&aC[0] instanceof Sash)))||aC===null)&&((bP!=null&&bP instanceof Array&&(bP.length==0||bP[0]==null||bP[0] instanceof Array))||bP===null)&&((typeof an==="boolean")||an===null)&&((typeof am==="number")||am===null)&&((typeof ba==="string")||ba===null)&&((typeof ao==="boolean")||ao===null)&&((typeof bL==="boolean")||bL===null)&&((typeof bJ==="boolean")||bJ===null)&&((g!=null&&g instanceof Big)||g===null)&&((av!=null&&av instanceof Big)||av===null)&&((typeof q==="string")||q===null)&&((bS!=null&&(bS instanceof Object))||bS===null)&&M===undefined&&G===undefined){var l=arguments;var aO=l[4];var a7=l[5];var A=l[6];var Y=l[7];var y=l[8];var aX=l[9];var a4=l[10];var p=l[11];var bO=l[12];var be=l[13];var E=l[14];var a2=l[15];var b3=l[16];var ak=l[17];var z=l[18];var J=l[19];var bk=l[20];var aj=l[21];var aL=l[22];var C=l[23];var bW=l[24];var c=l[25];var aK=l[26];var aB=l[27];var bq=l[28];var bw=l[29];var bA=l[30];var bC=l[31];var au=l[32];var bK=arguments;var f=C?PieceOfFurniture.SHOW_BACK_FACE:0;var bI=arguments;var Q=null;var L=null;bh=b.call(this,V,aq,al,ad,Q,aO,a7,A,Y,y,aX,a4,p,bO,be,E,a2,null,aL,f,bW,c,aK,aB,bq,false,bw,bA,bC,au,L)||this;if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}bh.cutOutShape=b3;bh.wallThickness=ak;bh.wallDistance=z;bh.wallCutOutOnBothSides=J;bh.widthDepthDeformable=bk;bh.sashes=aj;if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}}else{if(((typeof V==="string")||V===null)&&((typeof aq==="string")||aq===null)&&((typeof al==="string")||al===null)&&((typeof ad==="string")||ad===null)&&((bY!=null&&bY instanceof Array&&(bY.length==0||bY[0]==null||(typeof bY[0]==="string")))||bY===null)&&((typeof F==="number")||F===null)&&((typeof a8==="number")||a8===null)&&((bV!=null&&(bV.constructor!=null&&bV.constructor.__interfaces!=null&&bV.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bV===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||v===null)&&((az!=null&&(az.constructor!=null&&az.constructor.__interfaces!=null&&az.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||az===null)&&((typeof bX==="number")||bX===null)&&((typeof bm==="number")||bm===null)&&((typeof e==="number")||e===null)&&((typeof bT==="number")||bT===null)&&((typeof bl==="number")||bl===null)&&((typeof bD==="boolean")||bD===null)&&((typeof b5==="string")||b5===null)&&((typeof aP==="number")||aP===null)&&((typeof R==="number")||R===null)&&((typeof at==="boolean")||at===null)&&((typeof bf==="boolean")||bf===null)&&((aC!=null&&aC instanceof Array&&(aC.length==0||aC[0]==null||(aC[0]!=null&&aC[0] instanceof Sash)))||aC===null)&&((bP!=null&&bP instanceof Array&&(bP.length==0||bP[0]==null||bP[0] instanceof Array))||bP===null)&&((typeof an==="number")||an===null)&&((typeof am==="number")||am===null)&&((typeof ba==="string")||ba===null)&&((typeof ao==="boolean")||ao===null)&&((typeof bL==="boolean")||bL===null)&&((typeof bJ==="boolean")||bJ===null)&&((g!=null&&g instanceof Big)||g===null)&&((av!=null&&av instanceof Big)||av===null)&&((typeof q==="string")||q===null)&&((bS!=null&&(bS instanceof Object))||bS===null)&&M===undefined&&G===undefined){var l=arguments;var aN=l[4];var a6=l[5];var x=l[6];var X=l[7];var o=l[8];var aU=l[9];var a3=l[10];var n=l[11];var bN=l[12];var bd=l[13];var D=l[14];var a0=l[15];var b2=l[16];var ai=l[17];var w=l[18];var I=l[19];var bj=l[20];var ah=l[21];var aJ=l[22];var d=l[23];var bU=l[24];var b6=l[25];var aI=l[26];var ay=l[27];var bp=l[28];var bu=l[29];var bx=l[30];var bz=l[31];var ar=l[32];var bH=arguments;var P=null;var K=null;bh=b.call(this,V,aq,al,ad,P,aN,a6,x,X,o,aU,a3,n,bN,bd,D,a0,null,aJ,d,bU,b6,aI,ay,bp,false,bu,bx,bz,ar,K)||this;if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}bh.cutOutShape=b2;bh.wallThickness=ai;bh.wallDistance=w;bh.wallCutOutOnBothSides=I;bh.widthDepthDeformable=bj;bh.sashes=ah;if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}}else{if(((typeof V==="string")||V===null)&&((typeof aq==="string")||aq===null)&&((typeof al==="string")||al===null)&&((typeof ad==="string")||ad===null)&&((bY!=null&&bY instanceof Array&&(bY.length==0||bY[0]==null||(typeof bY[0]==="string")))||bY===null)&&((typeof F==="number")||F===null)&&((typeof a8==="number")||a8===null)&&((bV!=null&&(bV.constructor!=null&&bV.constructor.__interfaces!=null&&bV.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bV===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||v===null)&&((az!=null&&(az.constructor!=null&&az.constructor.__interfaces!=null&&az.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||az===null)&&((typeof bX==="number")||bX===null)&&((typeof bm==="number")||bm===null)&&((typeof e==="number")||e===null)&&((typeof bT==="number")||bT===null)&&((typeof bl==="number")||bl===null)&&((typeof bD==="boolean")||bD===null)&&((typeof b5==="string")||b5===null)&&((typeof aP==="number")||aP===null)&&((typeof R==="number")||R===null)&&((typeof at==="boolean")||at===null)&&((typeof bf==="boolean")||bf===null)&&((aC!=null&&aC instanceof Array&&(aC.length==0||aC[0]==null||(aC[0]!=null&&aC[0] instanceof Sash)))||aC===null)&&((bP!=null&&bP instanceof Array&&(bP.length==0||bP[0]==null||bP[0] instanceof Array))||bP===null)&&((typeof an==="boolean")||an===null)&&((typeof am==="number")||am===null)&&((typeof ba==="string")||ba===null)&&((typeof ao==="boolean")||ao===null)&&((typeof bL==="boolean")||bL===null)&&((typeof bJ==="boolean")||bJ===null)&&((g!=null&&g instanceof Big)||g===null)&&((av!=null&&av instanceof Big)||av===null)&&((typeof q==="string")||q===null)&&bS===undefined&&M===undefined&&G===undefined){var l=arguments;var aM=l[4];var a5=l[5];var u=l[6];var W=l[7];var m=l[8];var aS=l[9];var a1=l[10];var k=l[11];var bM=l[12];var bc=l[13];var B=l[14];var aY=l[15];var b0=l[16];var ag=l[17];var t=l[18];var H=l[19];var bi=l[20];var af=l[21];var aH=l[22];var C=l[23];var aA=l[24];var b4=l[25];var aG=l[26];var ax=l[27];var bo=l[28];var bt=l[29];var bv=l[30];var bg=l[31];var bG=arguments;var bn=null;var bF=arguments;var N=C?PieceOfFurniture.SHOW_BACK_FACE:0;var bE=arguments;var O=null;var Z=null;bh=b.call(this,V,aq,al,ad,O,aM,a5,u,W,m,aS,a1,k,bM,bc,B,aY,null,aH,N,aA,b4,aG,ax,bo,false,bt,bv,bg,bn,Z)||this;if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}bh.cutOutShape=b0;bh.wallThickness=ag;bh.wallDistance=t;bh.wallCutOutOnBothSides=H;bh.widthDepthDeformable=bi;bh.sashes=af;if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}}else{if(((typeof V==="string")||V===null)&&((aq!=null&&(aq.constructor!=null&&aq.constructor.__interfaces!=null&&aq.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aq===null)&&((al!=null&&(al.constructor!=null&&al.constructor.__interfaces!=null&&al.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||al===null)&&((typeof ad==="number")||ad===null)&&((typeof bY==="number")||bY===null)&&((typeof F==="number")||F===null)&&((typeof a8==="number")||a8===null)&&((typeof bV==="boolean")||bV===null)&&((typeof v==="number")||v===null)&&((typeof az==="number")||az===null)&&((bX!=null&&bX instanceof Array&&(bX.length==0||bX[0]==null||(bX[0]!=null&&bX[0] instanceof Sash)))||bX===null)&&((typeof bm==="number")||bm===null)&&((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||e[0] instanceof Array))||e===null)&&((typeof bT==="boolean")||bT===null)&&((typeof bl==="number")||bl===null)&&((typeof bD==="string")||bD===null)&&((typeof b5==="number")||b5===null)&&((typeof aP==="boolean")||aP===null)&&R===undefined&&at===undefined&&bf===undefined&&aC===undefined&&bP===undefined&&an===undefined&&am===undefined&&ba===undefined&&ao===undefined&&bL===undefined&&bJ===undefined&&g===undefined&&av===undefined&&q===undefined&&bS===undefined&&M===undefined&&G===undefined){var l=arguments;var ap=l[0];var U=l[1];var aR=l[2];var aZ=l[3];var j=l[4];var bB=l[5];var bb=l[6];var aW=l[7];var ae=l[8];var s=l[9];var ac=l[10];var bR=l[11];var aF=l[12];var C=l[13];var aw=l[14];var b1=l[15];var S=l[16];var bQ=l[17];if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}}else{if(((typeof V==="string")||V===null)&&((typeof aq==="string")||aq===null)&&((typeof al==="string")||al===null)&&((ad!=null&&(ad.constructor!=null&&ad.constructor.__interfaces!=null&&ad.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||ad===null)&&((bY!=null&&(bY.constructor!=null&&bY.constructor.__interfaces!=null&&bY.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||bY===null)&&((typeof F==="number")||F===null)&&((typeof a8==="number")||a8===null)&&((typeof bV==="number")||bV===null)&&((typeof v==="number")||v===null)&&((typeof az==="boolean")||az===null)&&((typeof bX==="number")||bX===null)&&((typeof bm==="number")||bm===null)&&((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||(e[0]!=null&&e[0] instanceof Sash)))||e===null)&&((bT!=null&&bT instanceof Array&&(bT.length==0||bT[0]==null||bT[0] instanceof Array))||bT===null)&&((typeof bl==="string")||bl===null)&&((typeof bD==="boolean")||bD===null)&&((b5!=null&&b5 instanceof Big)||b5===null)&&((aP!=null&&aP instanceof Big)||aP===null)&&R===undefined&&at===undefined&&bf===undefined&&aC===undefined&&bP===undefined&&an===undefined&&am===undefined&&ba===undefined&&ao===undefined&&bL===undefined&&bJ===undefined&&g===undefined&&av===undefined&&q===undefined&&bS===undefined&&M===undefined&&G===undefined){var l=arguments;var T=l[3];var aQ=l[4];var aV=l[5];var h=l[6];var by=l[7];var a9=l[8];var aT=l[9];var ab=l[10];var r=l[11];var aa=l[12];var aE=l[13];var bZ=l[14];var aD=l[15];var br=l[16];var bs=l[17];if(bh.wallThickness===undefined){bh.wallThickness=0}if(bh.wallDistance===undefined){bh.wallDistance=0}if(bh.wallCutOutOnBothSides===undefined){bh.wallCutOutOnBothSides=false}if(bh.widthDepthDeformable===undefined){bh.widthDepthDeformable=false}if(bh.sashes===undefined){bh.sashes=null}if(bh.cutOutShape===undefined){bh.cutOutShape=null}}else{throw new Error("invalid overload")}}}}}}return bh}a.prototype.getWallThickness=function(){return this.wallThickness};a.prototype.getWallDistance=function(){return this.wallDistance};a.prototype.isWallCutOutOnBothSides=function(){return this.wallCutOutOnBothSides};a.prototype.isWidthDepthDeformable=function(){return this.widthDepthDeformable};a.prototype.getSashes=function(){if(this.sashes.length===0){return this.sashes}else{return this.sashes.slice(0)}};a.prototype.getCutOutShape=function(){return this.cutOutShape};a.prototype.isDoorOrWindow=function(){return true};a.prototype.isHorizontallyRotatable=function(){return false};return a}(CatalogPieceOfFurniture));CatalogDoorOrWindow.__class="com.eteks.sweethome3d.model.CatalogDoorOrWindow";CatalogDoorOrWindow.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.DoorOrWindow","com.eteks.sweethome3d.model.PieceOfFurniture"];var CatalogShelfUnit=(function(a){__extends(b,a);function b(w,K,B,H,p,u,e,c,G,n,j,x,J,v,y,C,r,d,g,t,f,k,h,q,m,D,I,F,A,s,l,o,E){var z=a.call(this,w,K,B,H,p,u,e,c,G,n,j,x,J,v,y,C,g,t,f,k,h,q,m,D,I,F,A,s,l,o,E)||this;if(z.shelfElevations===undefined){z.shelfElevations=null}if(z.shelfBoxes===undefined){z.shelfBoxes=null}z.shelfElevations=r!=null&&r.length>0?r.slice(0):b.EMPTY_SHELF_ELEVATIONS_$LI$();z.shelfBoxes=d!=null&&d.length>0?d.slice(0):b.EMPTY_SHELF_BOXES_$LI$();return z}b.EMPTY_SHELF_ELEVATIONS_$LI$=function(){if(b.EMPTY_SHELF_ELEVATIONS==null){b.EMPTY_SHELF_ELEVATIONS=[]}return b.EMPTY_SHELF_ELEVATIONS};b.EMPTY_SHELF_BOXES_$LI$=function(){if(b.EMPTY_SHELF_BOXES==null){b.EMPTY_SHELF_BOXES=[]}return b.EMPTY_SHELF_BOXES};b.prototype.getShelfElevations=function(){return this.shelfElevations!=null?this.shelfElevations.slice(0):null};b.prototype.getShelfBoxes=function(){return this.shelfBoxes.slice(0)};return b}(CatalogPieceOfFurniture));CatalogShelfUnit.__class="com.eteks.sweethome3d.model.CatalogShelfUnit";CatalogShelfUnit.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.ShelfUnit"];var CatalogLight=(function(b){__extends(a,b);function a(ab,aB,l,aZ,T,aO,bj,aV,n,aL,M,aY,bh,F,m,bg,k,br,aK,ar,aD,ah,bi,S,bd,ay,y,a5,bp,e,u,aj,ae){var G=this;if(((typeof ab==="string")||ab===null)&&((typeof aB==="string")||aB===null)&&((typeof l==="string")||l===null)&&((typeof aZ==="string")||aZ===null)&&((typeof T==="string")||T===null)&&((aO!=null&&aO instanceof Array&&(aO.length==0||aO[0]==null||(typeof aO[0]==="string")))||aO===null)&&((typeof bj==="number")||bj===null)&&((typeof aV==="number")||aV===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||n===null)&&((aL!=null&&(aL.constructor!=null&&aL.constructor.__interfaces!=null&&aL.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aL===null)&&((M!=null&&(M.constructor!=null&&M.constructor.__interfaces!=null&&M.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||M===null)&&((typeof aY==="number")||aY===null)&&((typeof bh==="number")||bh===null)&&((typeof F==="number")||F===null)&&((typeof m==="number")||m===null)&&((typeof bg==="number")||bg===null)&&((typeof k==="boolean")||k===null)&&((br!=null&&br instanceof Array&&(br.length==0||br[0]==null||(br[0]!=null&&br[0] instanceof LightSource)))||br===null)&&((aK!=null&&aK instanceof Array&&(aK.length==0||aK[0]==null||(typeof aK[0]==="string")))||aK===null)&&((typeof ar==="string")||ar===null)&&((aD!=null&&aD instanceof Array&&(aD.length==0||aD[0]==null||aD[0] instanceof Array))||aD===null)&&((typeof ah==="number")||ah===null)&&((typeof bi==="number")||bi===null)&&((typeof S==="string")||S===null)&&((typeof bd==="boolean")||bd===null)&&((typeof ay==="boolean")||ay===null)&&((typeof y==="boolean")||y===null)&&((typeof a5==="boolean")||a5===null)&&((bp!=null&&bp instanceof Big)||bp===null)&&((e!=null&&e instanceof Big)||e===null)&&((typeof u==="string")||u===null)&&((aj!=null&&(aj instanceof Object))||aj===null)&&((ae!=null&&(ae instanceof Object))||ae===null)){var an=arguments;G=b.call(this,ab,aB,l,aZ,T,aO,bj,aV,n,aL,M,aY,bh,F,m,bg,k,ar,aD,ah,bi,S,bd,ay,y,a5,bp,e,u,aj,ae)||this;if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}G.lightSources=br!=null&&br.length>0?br.slice(0):a.EMPTY_LIGHT_SOURCES_$LI$();G.lightSourceMaterialNames=aK!=null&&aK.length>0?aK.slice(0):a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$()}else{if(((typeof ab==="string")||ab===null)&&((typeof aB==="string")||aB===null)&&((typeof l==="string")||l===null)&&((typeof aZ==="string")||aZ===null)&&((T!=null&&T instanceof Array&&(T.length==0||T[0]==null||(typeof T[0]==="string")))||T===null)&&((typeof aO==="number")||aO===null)&&((typeof bj==="number")||bj===null)&&((aV!=null&&(aV.constructor!=null&&aV.constructor.__interfaces!=null&&aV.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aV===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||n===null)&&((aL!=null&&(aL.constructor!=null&&aL.constructor.__interfaces!=null&&aL.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aL===null)&&((typeof M==="number")||M===null)&&((typeof aY==="number")||aY===null)&&((typeof bh==="number")||bh===null)&&((typeof F==="number")||F===null)&&((typeof m==="number")||m===null)&&((typeof bg==="boolean")||bg===null)&&((k!=null&&k instanceof Array&&(k.length==0||k[0]==null||(k[0]!=null&&k[0] instanceof LightSource)))||k===null)&&((br!=null&&br instanceof Array&&(br.length==0||br[0]==null||(typeof br[0]==="string")))||br===null)&&((typeof aK==="string")||aK===null)&&((ar!=null&&ar instanceof Array&&(ar.length==0||ar[0]==null||ar[0] instanceof Array))||ar===null)&&((typeof aD==="number")||aD===null)&&((typeof ah==="number")||ah===null)&&((typeof bi==="string")||bi===null)&&((typeof S==="boolean")||S===null)&&((typeof bd==="boolean")||bd===null)&&((typeof ay==="boolean")||ay===null)&&((typeof y==="boolean")||y===null)&&((a5!=null&&a5 instanceof Big)||a5===null)&&((bp!=null&&bp instanceof Big)||bp===null)&&((typeof e==="string")||e===null)&&((u!=null&&(u instanceof Object))||u===null)&&aj===undefined&&ae===undefined){var an=arguments;var a2=an[4];var aE=an[5];var X=an[6];var ag=an[7];var Q=an[8];var N=an[9];var h=an[10];var aU=an[11];var K=an[12];var B=an[13];var am=an[14];var a9=an[15];var aR=an[16];var bn=an[17];var aN=an[18];var aJ=an[19];var x=an[20];var au=an[21];var ap=an[22];var E=an[23];var bf=an[24];var bs=an[25];var a1=an[26];var t=an[27];var s=an[28];var j=an[29];var aH=an[30];var bm=arguments;var Z=null;var az=null;G=b.call(this,ab,aB,l,aZ,Z,a2,aE,X,ag,Q,N,h,aU,K,B,am,a9,aN,aJ,x,au,ap,E,bf,bs,a1,t,s,j,aH,az)||this;if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}G.lightSources=aR!=null&&aR.length>0?aR.slice(0):a.EMPTY_LIGHT_SOURCES_$LI$();G.lightSourceMaterialNames=bn!=null&&bn.length>0?bn.slice(0):a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$();if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}}else{if(((typeof ab==="string")||ab===null)&&((typeof aB==="string")||aB===null)&&((typeof l==="string")||l===null)&&((typeof aZ==="string")||aZ===null)&&((T!=null&&T instanceof Array&&(T.length==0||T[0]==null||(typeof T[0]==="string")))||T===null)&&((typeof aO==="number")||aO===null)&&((typeof bj==="number")||bj===null)&&((aV!=null&&(aV.constructor!=null&&aV.constructor.__interfaces!=null&&aV.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aV===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||n===null)&&((aL!=null&&(aL.constructor!=null&&aL.constructor.__interfaces!=null&&aL.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aL===null)&&((typeof M==="number")||M===null)&&((typeof aY==="number")||aY===null)&&((typeof bh==="number")||bh===null)&&((typeof F==="number")||F===null)&&((typeof m==="number")||m===null)&&((typeof bg==="boolean")||bg===null)&&((k!=null&&k instanceof Array&&(k.length==0||k[0]==null||(k[0]!=null&&k[0] instanceof LightSource)))||k===null)&&((typeof br==="string")||br===null)&&((aK!=null&&aK instanceof Array&&(aK.length==0||aK[0]==null||aK[0] instanceof Array))||aK===null)&&((typeof ar==="boolean")||ar===null)&&((typeof aD==="number")||aD===null)&&((typeof ah==="string")||ah===null)&&((typeof bi==="boolean")||bi===null)&&((typeof S==="boolean")||S===null)&&((typeof bd==="boolean")||bd===null)&&((typeof ay==="boolean")||ay===null)&&((y!=null&&y instanceof Big)||y===null)&&((a5!=null&&a5 instanceof Big)||a5===null)&&((typeof bp==="string")||bp===null)&&((e!=null&&(e instanceof Object))||e===null)&&u===undefined&&aj===undefined&&ae===undefined){var an=arguments;var a0=an[4];var aA=an[5];var V=an[6];var af=an[7];var P=an[8];var L=an[9];var g=an[10];var aT=an[11];var I=an[12];var A=an[13];var al=an[14];var a7=an[15];var aQ=an[16];var aM=an[17];var aI=an[18];var R=an[19];var at=an[20];var ao=an[21];var D=an[22];var be=an[23];var bq=an[24];var aX=an[25];var r=an[26];var q=an[27];var f=an[28];var aF=an[29];var bb=arguments;var bl=null;var w=R?PieceOfFurniture.SHOW_BACK_FACE:0;var ba=arguments;var Y=null;var aw=null;G=b.call(this,ab,aB,l,aZ,Y,a0,aA,V,af,P,L,g,aT,I,A,al,a7,aM,aI,w,at,ao,D,be,bq,aX,r,q,f,aF,aw)||this;if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}G.lightSources=aQ!=null&&aQ.length>0?aQ.slice(0):a.EMPTY_LIGHT_SOURCES_$LI$();G.lightSourceMaterialNames=bl!=null&&bl.length>0?bl.slice(0):a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$();if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}}else{if(((typeof ab==="string")||ab===null)&&((typeof aB==="string")||aB===null)&&((typeof l==="string")||l===null)&&((typeof aZ==="string")||aZ===null)&&((T!=null&&T instanceof Array&&(T.length==0||T[0]==null||(typeof T[0]==="string")))||T===null)&&((typeof aO==="number")||aO===null)&&((typeof bj==="number")||bj===null)&&((aV!=null&&(aV.constructor!=null&&aV.constructor.__interfaces!=null&&aV.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aV===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||n===null)&&((aL!=null&&(aL.constructor!=null&&aL.constructor.__interfaces!=null&&aL.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Content")>=0))||aL===null)&&((typeof M==="number")||M===null)&&((typeof aY==="number")||aY===null)&&((typeof bh==="number")||bh===null)&&((typeof F==="number")||F===null)&&((typeof m==="number")||m===null)&&((typeof bg==="boolean")||bg===null)&&((k!=null&&k instanceof Array&&(k.length==0||k[0]==null||(k[0]!=null&&k[0] instanceof LightSource)))||k===null)&&((typeof br==="string")||br===null)&&((aK!=null&&aK instanceof Array&&(aK.length==0||aK[0]==null||aK[0] instanceof Array))||aK===null)&&((typeof ar==="boolean")||ar===null)&&((typeof aD==="number")||aD===null)&&((typeof ah==="string")||ah===null)&&((typeof bi==="boolean")||bi===null)&&((typeof S==="boolean")||S===null)&&((typeof bd==="boolean")||bd===null)&&((typeof ay==="boolean")||ay===null)&&((y!=null&&y instanceof Big)||y===null)&&((a5!=null&&a5 instanceof Big)||a5===null)&&((typeof bp==="string")||bp===null)&&e===undefined&&u===undefined&&aj===undefined&&ae===undefined){var an=arguments;var aW=an[4];var ax=an[5];var U=an[6];var ad=an[7];var O=an[8];var J=an[9];var d=an[10];var aS=an[11];var H=an[12];var z=an[13];var ak=an[14];var a4=an[15];var aP=an[16];var ai=an[17];var aG=an[18];var R=an[19];var aq=an[20];var aa=an[21];var C=an[22];var bc=an[23];var bo=an[24];var ac=an[25];var p=an[26];var o=an[27];var c=an[28];var a8=arguments;var aC=null;var a6=arguments;var bk=null;var v=R?PieceOfFurniture.SHOW_BACK_FACE:0;var a3=arguments;var W=null;var av=null;G=b.call(this,ab,aB,l,aZ,W,aW,ax,U,ad,O,J,d,aS,H,z,ak,a4,ai,aG,v,aq,aa,C,bc,bo,ac,p,o,c,aC,av)||this;if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}G.lightSources=aP!=null&&aP.length>0?aP.slice(0):a.EMPTY_LIGHT_SOURCES_$LI$();G.lightSourceMaterialNames=bk!=null&&bk.length>0?bk.slice(0):a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$();if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}if(G.lightSources===undefined){G.lightSources=null}if(G.lightSourceMaterialNames===undefined){G.lightSourceMaterialNames=null}}else{throw new Error("invalid overload")}}}}return G}a.EMPTY_LIGHT_SOURCES_$LI$=function(){if(a.EMPTY_LIGHT_SOURCES==null){a.EMPTY_LIGHT_SOURCES=[]}return a.EMPTY_LIGHT_SOURCES};a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$=function(){if(a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES==null){a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES=[]}return a.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES};a.prototype.getLightSources=function(){if(this.lightSources.length===0){return this.lightSources}else{return this.lightSources.slice(0)}};a.prototype.getLightSourceMaterialNames=function(){if(this.lightSourceMaterialNames.length===0){return this.lightSourceMaterialNames}else{return this.lightSourceMaterialNames.slice(0)}};return a}(CatalogPieceOfFurniture));CatalogLight.__class="com.eteks.sweethome3d.model.CatalogLight";CatalogLight.__interfaces=["com.eteks.sweethome3d.model.CatalogItem","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Light"];var ImportedTextureWizardController=(function(b){__extends(a,b);function a(t,v,r,y,x){var w=this;if(((t!=null&&t instanceof CatalogTexture)||t===null)&&((typeof v==="string")||v===null)&&((r!=null&&r instanceof UserPreferences)||r===null)&&((y!=null&&(y.constructor!=null&&y.constructor.__interfaces!=null&&y.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||y===null)&&((x!=null&&(x.constructor!=null&&x.constructor.__interfaces!=null&&x.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||x===null)){var k=arguments;w=b.call(this,r,y)||this;if(w.texture===undefined){w.texture=null}if(w.textureName===undefined){w.textureName=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(w.contentManager===undefined){w.contentManager=null}if(w.textureImageStepState===undefined){w.textureImageStepState=null}if(w.textureAttributesStepState===undefined){w.textureAttributesStepState=null}if(w.stepsView===undefined){w.stepsView=null}if(w.step===undefined){w.step=null}if(w.image===undefined){w.image=null}if(w.name===undefined){w.name=null}if(w.category===undefined){w.category=null}if(w.creator===undefined){w.creator=null}if(w.width===undefined){w.width=0}if(w.height===undefined){w.height=0}w.texture=t;w.textureName=v;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=r;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=y;w.contentManager=x;w.setTitle(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,t==null?"importTextureWizard.title":"modifyTextureWizard.title"));w.textureImageStepState=new a.TextureImageStepState(w);w.textureAttributesStepState=new a.TextureAttributesStepState(w);w.setStepState(w.textureImageStepState)}else{if(((typeof t==="string")||t===null)&&((v!=null&&v instanceof UserPreferences)||v===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||r===null)&&((y!=null&&(y.constructor!=null&&y.constructor.__interfaces!=null&&y.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||y===null)&&x===undefined){var k=arguments;var h=k[0];var c=k[1];var j=k[2];var s=k[3];var o=arguments;var u=null;w=b.call(this,c,j)||this;if(w.texture===undefined){w.texture=null}if(w.textureName===undefined){w.textureName=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(w.contentManager===undefined){w.contentManager=null}if(w.textureImageStepState===undefined){w.textureImageStepState=null}if(w.textureAttributesStepState===undefined){w.textureAttributesStepState=null}if(w.stepsView===undefined){w.stepsView=null}if(w.step===undefined){w.step=null}if(w.image===undefined){w.image=null}if(w.name===undefined){w.name=null}if(w.category===undefined){w.category=null}if(w.creator===undefined){w.creator=null}if(w.width===undefined){w.width=0}if(w.height===undefined){w.height=0}w.texture=u;w.textureName=h;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=c;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=j;w.contentManager=s;w.setTitle(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,u==null?"importTextureWizard.title":"modifyTextureWizard.title"));w.textureImageStepState=new a.TextureImageStepState(w);w.textureAttributesStepState=new a.TextureAttributesStepState(w);w.setStepState(w.textureImageStepState);if(w.texture===undefined){w.texture=null}if(w.textureName===undefined){w.textureName=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(w.contentManager===undefined){w.contentManager=null}if(w.textureImageStepState===undefined){w.textureImageStepState=null}if(w.textureAttributesStepState===undefined){w.textureAttributesStepState=null}if(w.stepsView===undefined){w.stepsView=null}if(w.step===undefined){w.step=null}if(w.image===undefined){w.image=null}if(w.name===undefined){w.name=null}if(w.category===undefined){w.category=null}if(w.creator===undefined){w.creator=null}if(w.width===undefined){w.width=0}if(w.height===undefined){w.height=0}}else{if(((t!=null&&t instanceof CatalogTexture)||t===null)&&((v!=null&&v instanceof UserPreferences)||v===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||r===null)&&((y!=null&&(y.constructor!=null&&y.constructor.__interfaces!=null&&y.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||y===null)&&x===undefined){var k=arguments;var A=k[1];var g=k[2];var q=k[3];var m=arguments;var f=null;w=b.call(this,A,g)||this;if(w.texture===undefined){w.texture=null}if(w.textureName===undefined){w.textureName=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(w.contentManager===undefined){w.contentManager=null}if(w.textureImageStepState===undefined){w.textureImageStepState=null}if(w.textureAttributesStepState===undefined){w.textureAttributesStepState=null}if(w.stepsView===undefined){w.stepsView=null}if(w.step===undefined){w.step=null}if(w.image===undefined){w.image=null}if(w.name===undefined){w.name=null}if(w.category===undefined){w.category=null}if(w.creator===undefined){w.creator=null}if(w.width===undefined){w.width=0}if(w.height===undefined){w.height=0}w.texture=t;w.textureName=f;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=A;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=g;w.contentManager=q;w.setTitle(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,t==null?"importTextureWizard.title":"modifyTextureWizard.title"));w.textureImageStepState=new a.TextureImageStepState(w);w.textureAttributesStepState=new a.TextureAttributesStepState(w);w.setStepState(w.textureImageStepState);if(w.texture===undefined){w.texture=null}if(w.textureName===undefined){w.textureName=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(w.contentManager===undefined){w.contentManager=null}if(w.textureImageStepState===undefined){w.textureImageStepState=null}if(w.textureAttributesStepState===undefined){w.textureAttributesStepState=null}if(w.stepsView===undefined){w.stepsView=null}if(w.step===undefined){w.step=null}if(w.image===undefined){w.image=null}if(w.name===undefined){w.name=null}if(w.category===undefined){w.category=null}if(w.creator===undefined){w.creator=null}if(w.width===undefined){w.width=0}if(w.height===undefined){w.height=0}}else{if(((t!=null&&t instanceof UserPreferences)||t===null)&&((v!=null&&(v.constructor!=null&&v.constructor.__interfaces!=null&&v.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||v===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||r===null)&&y===undefined&&x===undefined){var k=arguments;var z=k[0];var e=k[1];var n=k[2];var l=arguments;var p=null;var d=null;w=b.call(this,z,e)||this;if(w.texture===undefined){w.texture=null}if(w.textureName===undefined){w.textureName=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(w.contentManager===undefined){w.contentManager=null}if(w.textureImageStepState===undefined){w.textureImageStepState=null}if(w.textureAttributesStepState===undefined){w.textureAttributesStepState=null}if(w.stepsView===undefined){w.stepsView=null}if(w.step===undefined){w.step=null}if(w.image===undefined){w.image=null}if(w.name===undefined){w.name=null}if(w.category===undefined){w.category=null}if(w.creator===undefined){w.creator=null}if(w.width===undefined){w.width=0}if(w.height===undefined){w.height=0}w.texture=p;w.textureName=d;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=z;w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=e;w.contentManager=n;w.setTitle(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getLocalizedString(a,p==null?"importTextureWizard.title":"modifyTextureWizard.title"));w.textureImageStepState=new a.TextureImageStepState(w);w.textureAttributesStepState=new a.TextureAttributesStepState(w);w.setStepState(w.textureImageStepState);if(w.texture===undefined){w.texture=null}if(w.textureName===undefined){w.textureName=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences=null}if(w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory===undefined){w.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory=null}if(w.contentManager===undefined){w.contentManager=null}if(w.textureImageStepState===undefined){w.textureImageStepState=null}if(w.textureAttributesStepState===undefined){w.textureAttributesStepState=null}if(w.stepsView===undefined){w.stepsView=null}if(w.step===undefined){w.step=null}if(w.image===undefined){w.image=null}if(w.name===undefined){w.name=null}if(w.category===undefined){w.category=null}if(w.creator===undefined){w.creator=null}if(w.width===undefined){w.width=0}if(w.height===undefined){w.height=0}}else{throw new Error("invalid overload")}}}}return w}a.prototype.finish=function(){var d=new CatalogTexture(null,this.getName(),this.getImage(),this.getWidth(),this.getHeight(),this.getCreator(),true);var c=this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences.getTexturesCatalog();if(this.texture!=null){c["delete"](this.texture)}c.add(this.category,d)};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.getStepState=function(){return b.prototype.getStepState.call(this)};a.prototype.getTextureImageStepState=function(){return this.textureImageStepState};a.prototype.getTextureAttributesStepState=function(){return this.textureAttributesStepState};a.prototype.getStepsView=function(){if(this.stepsView==null){this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_viewFactory.createImportedTextureWizardStepsView(this.texture,this.textureName,this.__com_eteks_sweethome3d_viewcontroller_ImportedTextureWizardController_preferences,this)}return this.stepsView};a.prototype.setStep=function(c){if(c!==this.step){var d=this.step;this.step=c;this.propertyChangeSupport.firePropertyChange("STEP",d,c)}};a.prototype.getStep=function(){return this.step};a.prototype.setImage=function(d){if(d!==this.image){var c=this.image;this.image=d;this.propertyChangeSupport.firePropertyChange("IMAGE",c,d)}};a.prototype.getImage=function(){return this.image};a.prototype.getName=function(){return this.name};a.prototype.setName=function(c){if(c!==this.name){var d=this.name;this.name=c;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("NAME",d,c)}}};a.prototype.getCategory=function(){return this.category};a.prototype.setCategory=function(d){if(d!==this.category){var c=this.category;this.category=d;this.propertyChangeSupport.firePropertyChange("CATEGORY",c,d)}};a.prototype.getCreator=function(){return this.creator};a.prototype.setCreator=function(d){if(d!==this.creator){var c=this.creator;this.creator=d;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("CREATOR",c,d)}}};a.prototype.getWidth=function(){return this.width};a.prototype.setWidth=function(d){if(d!==this.width){var c=this.width;this.width=d;this.propertyChangeSupport.firePropertyChange("WIDTH",c,d)}};a.prototype.getHeight=function(){return this.height};a.prototype.setHeight=function(c){if(c!==this.height){var d=this.height;this.height=c;this.propertyChangeSupport.firePropertyChange("HEIGHT",d,c)}};a.prototype.isTextureNameValid=function(){return this.name!=null&&this.name.length>0&&this.category!=null};return a}(WizardController));ImportedTextureWizardController.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController";ImportedTextureWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var b;(function(f){f[f.IMAGE=0]="IMAGE";f[f.ATTRIBUTES=1]="ATTRIBUTES"})(b=d.Step||(d.Step={}));var e=(function(f){__extends(g,f);function g(h){var j=f.call(this)||this;j.__parent=h;j.icon="resources/importedTextureWizard.png";return j}g.prototype.enter=function(){this.__parent.setStep(this.getStep())};g.prototype.getView=function(){return this.__parent.getStepsView()};g.prototype.getIcon=function(){return this.icon};return g}(WizardController.WizardControllerStepState));d.ImportedTextureWizardStepState=e;e.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.ImportedTextureWizardStepState";var a=(function(g){__extends(f,g);function f(h){var j=g.call(this,h)||this;j.__parent=h;h.addPropertyChangeListener("IMAGE",new f.TextureImageStepState$0(j));return j}f.prototype.enter=function(){g.prototype.enter.call(this);this.setFirstStep(true);this.setNextStepEnabled(this.__parent.getImage()!=null)};f.prototype.getStep=function(){return d.Step.IMAGE};f.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getTextureAttributesStepState())};return f}(d.ImportedTextureWizardStepState));d.TextureImageStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.TextureImageStepState";(function(g){var f=(function(){function h(j){this.__parent=j}h.prototype.propertyChange=function(j){this.__parent.setNextStepEnabled(this.__parent.__parent.getImage()!=null)};return h}());g.TextureImageStepState$0=f})(a=d.TextureImageStepState||(d.TextureImageStepState={}));var c=(function(g){__extends(f,g);function f(h){var j=g.call(this,h)||this;j.__parent=h;if(j.widthChangeListener===undefined){j.widthChangeListener=null}if(j.heightChangeListener===undefined){j.heightChangeListener=null}if(j.nameAndCategoryChangeListener===undefined){j.nameAndCategoryChangeListener=null}j.widthChangeListener=new f.TextureAttributesStepState$0(j);j.heightChangeListener=new f.TextureAttributesStepState$1(j);j.nameAndCategoryChangeListener=new f.TextureAttributesStepState$2(j);return j}f.prototype.enter=function(){g.prototype.enter.call(this);this.setLastStep(true);this.__parent.addPropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.addPropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.addPropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.addPropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener);this.setNextStepEnabled(this.__parent.isTextureNameValid())};f.prototype.getStep=function(){return d.Step.ATTRIBUTES};f.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getTextureImageStepState())};f.prototype.exit=function(){this.__parent.removePropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.removePropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.removePropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.removePropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener)};return f}(d.ImportedTextureWizardStepState));d.TextureAttributesStepState=c;c.__class="com.eteks.sweethome3d.viewcontroller.ImportedTextureWizardController.TextureAttributesStepState";(function(f){var j=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(m){this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var l=m.getNewValue()/m.getOldValue();this.__parent.__parent.setHeight(this.__parent.__parent.getHeight()*l);this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)};return k}());f.TextureAttributesStepState$0=j;var h=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(m){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener);var l=m.getNewValue()/m.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.getWidth()*l);this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener)};return k}());f.TextureAttributesStepState$1=h;var g=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(l){this.__parent.setNextStepEnabled(this.__parent.__parent.isTextureNameValid())};return k}());f.TextureAttributesStepState$2=g})(c=d.TextureAttributesStepState||(d.TextureAttributesStepState={}))})(ImportedTextureWizardController||(ImportedTextureWizardController={}));var DimensionLineController=(function(){function a(j,l,k,f,h,c){if(((j!=null&&j instanceof Home)||j===null)&&((typeof l==="number")||l===null)&&((typeof k==="number")||k===null)&&((f!=null&&f instanceof UserPreferences)||f===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((c!=null&&c instanceof javax.swing.undo.UndoableEditSupport)||c===null)){var g=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.dimensionLineView===undefined){this.dimensionLineView=null}if(this.dimensionLineModification===undefined){this.dimensionLineModification=false}if(this.editableDistance===undefined){this.editableDistance=false}if(this.xStart===undefined){this.xStart=null}if(this.yStart===undefined){this.yStart=null}if(this.elevationStart===undefined){this.elevationStart=null}if(this.xEnd===undefined){this.xEnd=null}if(this.yEnd===undefined){this.yEnd=null}if(this.elevationEnd===undefined){this.elevationEnd=null}if(this.distanceToEndPoint===undefined){this.distanceToEndPoint=null}if(this.orientation===undefined){this.orientation=null}if(this.offset===undefined){this.offset=null}if(this.lengthFontSize===undefined){this.lengthFontSize=null}if(this.color===undefined){this.color=null}if(this.visibleIn3D===undefined){this.visibleIn3D=null}if(this.pitch===undefined){this.pitch=null}this.home=j;this.preferences=f;this.viewFactory=h;this.undoSupport=c;this.propertyChangeSupport=new PropertyChangeSupport(this);this.dimensionLineModification=false;this.xStart=this.xEnd=l;this.yStart=this.yEnd=k;this.editableDistance=true;this.elevationStart=0;this.elevationEnd=this.distanceToEndPoint=j.getWallHeight();this.offset=20;this.orientation=a.DimensionLineOrientation.ELEVATION;this.lengthFontSize=f.getDefaultTextStyle(DimensionLine).getFontSize();this.visibleIn3D=true;this.pitch=(-Math.PI/2)}else{if(((j!=null&&j instanceof Home)||j===null)&&((l!=null&&l instanceof UserPreferences)||l===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||k===null)&&((f!=null&&f instanceof javax.swing.undo.UndoableEditSupport)||f===null)&&h===undefined&&c===undefined){var g=arguments;var d=g[1];var e=g[2];var b=g[3];if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.dimensionLineView===undefined){this.dimensionLineView=null}if(this.dimensionLineModification===undefined){this.dimensionLineModification=false}if(this.editableDistance===undefined){this.editableDistance=false}if(this.xStart===undefined){this.xStart=null}if(this.yStart===undefined){this.yStart=null}if(this.elevationStart===undefined){this.elevationStart=null}if(this.xEnd===undefined){this.xEnd=null}if(this.yEnd===undefined){this.yEnd=null}if(this.elevationEnd===undefined){this.elevationEnd=null}if(this.distanceToEndPoint===undefined){this.distanceToEndPoint=null}if(this.orientation===undefined){this.orientation=null}if(this.offset===undefined){this.offset=null}if(this.lengthFontSize===undefined){this.lengthFontSize=null}if(this.color===undefined){this.color=null}if(this.visibleIn3D===undefined){this.visibleIn3D=null}if(this.pitch===undefined){this.pitch=null}this.home=j;this.preferences=d;this.viewFactory=e;this.undoSupport=b;this.propertyChangeSupport=new PropertyChangeSupport(this);this.dimensionLineModification=true;this.updateProperties()}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.dimensionLineView==null){this.dimensionLineView=this.viewFactory.createDimensionLineView(this.dimensionLineModification,this.preferences,this)}return this.dimensionLineView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var p=Home.getDimensionLinesSubList(this.home.getSelectedItems());if((p.length==0)){this.setXStart(null);this.setYStart(null);this.setElevationStart(null);this.setXEnd(null);this.setYEnd(null);this.setElevationEnd(null);this.setEditableDistance(false);this.setOrientation(null);this.setOffset(null);this.setLengthFontSize(null);this.setColor(null);this.setVisibleIn3D(null);this.setPitch(null)}else{var s=p[0];var e=s.getXStart();for(var t=1;t<p.length;t++){if(!(e===p[t].getXStart())){e=null;break}}this.setXStart(e);var l=s.getYStart();for(var t=1;t<p.length;t++){if(!(l===p[t].getYStart())){l=null;break}}this.setYStart(l);var b=s.getElevationStart();for(var t=1;t<p.length;t++){if(!(b===p[t].getElevationStart())){b=null;break}}this.setElevationStart(b);var k=s.getXEnd();for(var t=1;t<p.length;t++){if(!(k===p[t].getXEnd())){k=null;break}}this.setXEnd(k);var n=s.getYEnd();for(var t=1;t<p.length;t++){if(!(n===p[t].getYEnd())){n=null;break}}this.setYEnd(n);var h=s.getElevationEnd();var o=s.isElevationDimensionLine();for(var t=1;t<p.length;t++){if(!(h===p[t].getElevationEnd())||o!==p[t].isElevationDimensionLine()){h=null;break}}this.setElevationEnd(h);this.setEditableDistance(this.getXStart()!=null&&this.getYStart()!=null&&this.getElevationStart()!=null&&this.getXEnd()!=null&&this.getYEnd()!=null&&this.getElevationEnd()!=null);var c=null;if(s.isElevationDimensionLine()){c=a.DimensionLineOrientation.ELEVATION}else{if(s.getElevationStart()===s.getElevationEnd()){c=a.DimensionLineOrientation.PLAN}}for(var t=1;t<p.length;t++){var g=p[t];if(g.isElevationDimensionLine()&&c!==a.DimensionLineOrientation.ELEVATION||g.getElevationStart()===g.getElevationEnd()&&c!==a.DimensionLineOrientation.PLAN){c=null;break}}this.setOrientation(c,false);var f=s.getOffset();for(var t=1;t<p.length;t++){if(!(f===p[t].getOffset())){f=null;break}}this.setOffset(f);var j=this.preferences.getDefaultTextStyle(DimensionLine).getFontSize();var d=s.getLengthStyle()!=null?s.getLengthStyle().getFontSize():j;for(var t=1;t<p.length;t++){var g=p[t];if(!(d===(g.getLengthStyle()!=null?g.getLengthStyle().getFontSize():j))){d=null;break}}this.setLengthFontSize(d);var r=s.getColor();if(r!=null){for(var t=1;t<p.length;t++){if(!(r===p[t].getColor())){r=null;break}}}this.setColor(r);var q=s.isVisibleIn3D();for(var t=1;t<p.length;t++){if(!(q===p[t].isVisibleIn3D())){q=null;break}}this.setVisibleIn3D(q);var m=s.getPitch();for(var t=1;t<p.length;t++){if(!(m===p[t].getPitch())){m=null;break}}this.setPitch(m)}};a.prototype.setXStart=function(d,c){if(c===void 0){c=true}if(d!==this.xStart){var b=this.xStart;this.xStart=d;this.propertyChangeSupport.firePropertyChange("X_START",b,d);if(c&&this.orientation===a.DimensionLineOrientation.ELEVATION){this.setXEnd(d,false)}else{this.updateDistanceToEndPoint()}}};a.prototype.getXStart=function(){return this.xStart};a.prototype.setYStart=function(d,b){if(b===void 0){b=true}if(d!==this.yStart){var c=this.yStart;this.yStart=d;this.propertyChangeSupport.firePropertyChange("Y_START",c,d);if(b&&this.orientation===a.DimensionLineOrientation.ELEVATION){this.setYEnd(d,false)}else{this.updateDistanceToEndPoint()}}};a.prototype.getYStart=function(){return this.yStart};a.prototype.setElevationStart=function(d,c){if(c===void 0){c=true}if(d!==this.elevationStart){var b=this.elevationStart;this.elevationStart=d;this.propertyChangeSupport.firePropertyChange("ELEVATION_START",b,d);if(c&&this.orientation===a.DimensionLineOrientation.PLAN){this.setElevationEnd(d,false)}else{this.updateDistanceToEndPoint()}}};a.prototype.getElevationStart=function(){return this.elevationStart};a.prototype.setXEnd=function(b,d){if(d===void 0){d=true}if(b!==this.xEnd){var c=this.xEnd;this.xEnd=b;this.propertyChangeSupport.firePropertyChange("X_END",c,b);if(d&&this.orientation===a.DimensionLineOrientation.ELEVATION){this.setXStart(b,false)}else{this.updateDistanceToEndPoint()}}};a.prototype.getXEnd=function(){return this.xEnd};a.prototype.setYEnd=function(c,b){if(b===void 0){b=true}if(c!==this.yEnd){var d=this.yEnd;this.yEnd=c;this.propertyChangeSupport.firePropertyChange("Y_END",d,c);if(b&&this.orientation===a.DimensionLineOrientation.ELEVATION){this.setYStart(c,false)}else{this.updateDistanceToEndPoint()}}};a.prototype.getYEnd=function(){return this.yEnd};a.prototype.setElevationEnd=function(b,d){if(d===void 0){d=true}if(b!==this.elevationEnd){var c=this.elevationEnd;this.elevationEnd=b;this.propertyChangeSupport.firePropertyChange("ELEVATION_END",c,b);if(d&&this.orientation===a.DimensionLineOrientation.PLAN){this.setElevationStart(b,false)}else{this.updateDistanceToEndPoint()}}};a.prototype.getElevationEnd=function(){return this.elevationEnd};a.prototype.updateDistanceToEndPoint=function(){var h=this.getXStart();var e=this.getYStart();var g=this.getElevationStart();var c=this.getXEnd();var f=this.getYEnd();var d=this.getElevationEnd();if(h!=null&&e!=null&&g!=null&&c!=null&&f!=null&&d!=null){var b=new DimensionLine(h,e,g,c,f,d,0);this.setDistanceToEndPoint(b.getLength(),false)}else{this.setDistanceToEndPoint(null,false)}};a.prototype.setDistanceToEndPoint=function(l,b){if(b===void 0){b=true}if(l!==this.distanceToEndPoint){var e=this.distanceToEndPoint;this.distanceToEndPoint=l;this.propertyChangeSupport.firePropertyChange("DISTANCE_TO_END_POINT",e,l);if(b){var h=this.getXStart();var m=this.getYStart();var d=this.getElevationStart();var c=this.getXEnd();var k=this.getYEnd();var f=this.getElevationEnd();if(h!=null&&m!=null&&d!=null&&c!=null&&k!=null&&f!=null&&l!=null){var g=Math.atan2(m-k,c-h);var j=Math.atan2(f-d,c-h);this.setXEnd((h+l*Math.cos(g)*Math.cos(j)));this.setYEnd((m-l*Math.sin(g)*Math.cos(j)));this.setElevationEnd((d+l*Math.sin(j)))}else{this.setXEnd(null);this.setYEnd(null);this.setElevationEnd(null)}}}};a.prototype.getDistanceToEndPoint=function(){return this.distanceToEndPoint};a.prototype.setOrientation=function(b,h){if(h===void 0){h=true}if(b!==this.orientation){var c=this.orientation;this.orientation=b;this.propertyChangeSupport.firePropertyChange("ORIENTATION",c,b);if(h){if(b===a.DimensionLineOrientation.PLAN&&this.pitch!==0&&this.pitch!==(Math.PI/2)){this.setPitch(0)}if(this.distanceToEndPoint!=null){var d=this.distanceToEndPoint;var g=this.getXStart();var e=this.getYStart();var f=this.getElevationStart();if(b===a.DimensionLineOrientation.PLAN){this.setElevationEnd(f,false);this.setYEnd(e,false);this.setXEnd(g+d,false)}else{if(b===a.DimensionLineOrientation.ELEVATION){this.setXEnd(g,false);this.setYEnd(e,false);this.setElevationEnd(f+d,false)}}}}}};a.prototype.getOrientation=function(){return this.orientation};a.prototype.setEditableDistance=function(b){if(b!==this.editableDistance){this.editableDistance=b;this.propertyChangeSupport.firePropertyChange("EDITABLE_DISTANCE",!b,b)}};a.prototype.isEditableDistance=function(){return this.editableDistance};a.prototype.setOffset=function(c){if(c!==this.offset){var b=this.offset;this.offset=c;this.propertyChangeSupport.firePropertyChange("OFFSET",b,c)}};a.prototype.getOffset=function(){return this.offset};a.prototype.setLengthFontSize=function(c){if(c!==this.lengthFontSize){var b=this.lengthFontSize;this.lengthFontSize=c;this.propertyChangeSupport.firePropertyChange("LENGTH_FONT_SIZE",b,c)}};a.prototype.getLengthFontSize=function(){return this.lengthFontSize};a.prototype.setColor=function(b){if(b!==this.color){var c=this.color;this.color=b;this.propertyChangeSupport.firePropertyChange("COLOR",c,b)}};a.prototype.getColor=function(){return this.color};a.prototype.setVisibleIn3D=function(c){if(c!==this.visibleIn3D){var b=this.visibleIn3D;this.visibleIn3D=c;this.propertyChangeSupport.firePropertyChange("VISIBLE_IN_3D",b,c)}};a.prototype.isVisibleIn3D=function(){return this.visibleIn3D};a.prototype.setPitch=function(c){if(c!==this.pitch){var b=this.pitch;this.pitch=c;this.propertyChangeSupport.firePropertyChange("PITCH",b,c)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.createDimensionLine$float$float$float$float$float$float$float=function(h,e,g,c,f,d,j){var b=new DimensionLine(this.getXStart(),this.getYStart(),this.getElevationStart(),this.getXEnd(),this.getYEnd(),this.getElevationEnd(),this.getOffset());this.home.addDimensionLine(b);return b};a.prototype.createDimensionLine=function(g,d,f,b,e,c,h){if(((typeof g==="number")||g===null)&&((typeof d==="number")||d===null)&&((typeof f==="number")||f===null)&&((typeof b==="number")||b===null)&&((typeof e==="number")||e===null)&&((typeof c==="number")||c===null)&&((typeof h==="number")||h===null)){return this.createDimensionLine$float$float$float$float$float$float$float(g,d,f,b,e,c,h)}else{if(g===undefined&&d===undefined&&f===undefined&&b===undefined&&e===undefined&&c===undefined&&h===undefined){return this.createDimensionLine$()}else{throw new Error("invalid overload")}}};a.prototype.createDimensionLine$=function(){var d=this.home.getSelectedItems();var c=this.home.isBasePlanLocked();var f=this.home.isAllLevelsSelection();var b=this.createDimensionLine$float$float$float$float$float$float$float(this.getXStart(),this.getYStart(),this.getElevationStart(),this.getXEnd(),this.getYEnd(),this.getElevationEnd(),this.getOffset());var h=this.getLengthFontSize();if(h!=null){var g=this.preferences.getDefaultTextStyle(DimensionLine).deriveStyle$float(h);b.setLengthStyle(g)}b.setColor(this.getColor());b.setVisibleIn3D(this.isVisibleIn3D());b.setPitch(this.getPitch());a.doAddAndSelectDimensionLine(this.home,b,false);if(this.undoSupport!=null){var e=new a.DimensionLineCreationUndoableEdit(this.home,this.preferences,d.slice(0),c,f,b);this.undoSupport.postEdit(e)}};a.doAddAndSelectDimensionLine=function(c,b,d){if(d){c.addDimensionLine(b)}c.setBasePlanLocked(false);c.setSelectedItems([b].slice(0));c.setAllLevelsSelection(false)};a.doDeleteDimensionLine=function(d,c,b){d.deleteDimensionLine(c);d.setBasePlanLocked(b)};a.prototype.modifyDimensionLines=function(){var b=this.home.getSelectedItems();var c=Home.getDimensionLinesSubList(b);if(!(c.length==0)){var o=this.getXStart();var s=this.getYStart();var g=this.getElevationStart();var e=this.getXEnd();var p=this.getYEnd();var n=this.getElevationEnd();var l=this.getOffset();var k=this.getLengthFontSize();var j=this.getColor();var r=this.isVisibleIn3D();var f=this.getPitch();var d=(function(u){var t=[];while(u-->0){t.push(null)}return t})(c.length);for(var m=0;m<d.length;m++){d[m]=new a.ModifiedDimensionLine(c[m])}var q=this.preferences.getDefaultTextStyle(DimensionLine);a.doModifyDimensionLines(d,o,s,g,e,p,n,l,k,q,j,r,f);if(this.undoSupport!=null){var h=new a.DimensionLinesModificationUndoableEdit(this.home,this.preferences,b.slice(0),d,o,s,g,e,p,n,l,k,q,j,r,f);this.undoSupport.postEdit(h)}}};a.doModifyDimensionLines=function(c,m,r,f,d,o,k,j,h,q,g,p,e){for(var l=0;l<c.length;l++){var b=c[l];var n=b.getDimensionLine();if(m!=null){n.setXStart(m)}if(r!=null){n.setYStart(r)}if(f!=null){if(k==null){if(n.isElevationDimensionLine()){n.setElevationEnd(f+n.getElevationEnd()-n.getElevationStart())}else{n.setElevationEnd(f)}}n.setElevationStart(f)}if(d!=null){n.setXEnd(d)}if(o!=null){n.setYEnd(o)}if(k!=null){n.setElevationEnd(k)}if(j!=null){n.setOffset(j)}if(h!=null){n.setLengthStyle(n.getLengthStyle()!=null?n.getLengthStyle().deriveStyle$float(h):q.deriveStyle$float(h))}if(g!=null){n.setColor(g)}if(p!=null){n.setVisibleIn3D(p)}if(e!=null){n.setPitch(e)}}};a.undoModifyDimensionLines=function(b){for(var d=0;d<b.length;d++){var c=b[d];c.reset()}};return a}());DimensionLineController.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController";DimensionLineController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(c){var e;(function(f){f[f.PLAN=0]="PLAN";f[f.ELEVATION=1]="ELEVATION";f[f.DIAGONAL=2]="DIAGONAL"})(e=c.DimensionLineOrientation||(c.DimensionLineOrientation={}));var d=(function(g){__extends(f,g);function f(n,k,j,l,m,h){var o=g.call(this,k,c,"undoCreateDimensionLineName")||this;if(o.home===undefined){o.home=null}if(o.oldSelection===undefined){o.oldSelection=null}if(o.oldBasePlanLocked===undefined){o.oldBasePlanLocked=false}if(o.oldAllLevelsSelection===undefined){o.oldAllLevelsSelection=false}if(o.dimensionLine===undefined){o.dimensionLine=null}o.home=n;o.oldSelection=j;o.oldBasePlanLocked=l;o.oldAllLevelsSelection=m;o.dimensionLine=h;return o}f.prototype.undo=function(){g.prototype.undo.call(this);c.doDeleteDimensionLine(this.home,this.dimensionLine,this.oldBasePlanLocked);this.home.setSelectedItems(this.oldSelection.slice(0));this.home.setAllLevelsSelection(this.oldAllLevelsSelection)};f.prototype.redo=function(){g.prototype.redo.call(this);c.doAddAndSelectDimensionLine(this.home,this.dimensionLine,true)};return f}(LocalizedUndoableEdit));c.DimensionLineCreationUndoableEdit=d;d.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController.DimensionLineCreationUndoableEdit";d.__interfaces=["javax.swing.undo.UndoableEdit"];var a=(function(g){__extends(f,g);function f(t,q,h,j,u,y,m,k,v,r,p,o,x,n,w,l){var s=g.call(this,q,c,"undoModifyDimensionLinesName")||this;if(s.home===undefined){s.home=null}if(s.oldSelection===undefined){s.oldSelection=null}if(s.modifiedDimensionLines===undefined){s.modifiedDimensionLines=null}if(s.xStart===undefined){s.xStart=null}if(s.yStart===undefined){s.yStart=null}if(s.elevationStart===undefined){s.elevationStart=null}if(s.xEnd===undefined){s.xEnd=null}if(s.yEnd===undefined){s.yEnd=null}if(s.elevationEnd===undefined){s.elevationEnd=null}if(s.offset===undefined){s.offset=null}if(s.lengthFontSize===undefined){s.lengthFontSize=null}if(s.defaultStyle===undefined){s.defaultStyle=null}if(s.color===undefined){s.color=null}if(s.visibleIn3D===undefined){s.visibleIn3D=null}if(s.pitch===undefined){s.pitch=null}s.home=t;s.oldSelection=h;s.modifiedDimensionLines=j;s.xStart=u;s.yStart=y;s.elevationStart=m;s.xEnd=k;s.yEnd=v;s.elevationEnd=r;s.offset=p;s.lengthFontSize=o;s.defaultStyle=x;s.color=n;s.visibleIn3D=w;s.pitch=l;return s}f.prototype.undo=function(){g.prototype.undo.call(this);c.undoModifyDimensionLines(this.modifiedDimensionLines);this.home.setSelectedItems(this.oldSelection.slice(0))};f.prototype.redo=function(){g.prototype.redo.call(this);c.doModifyDimensionLines(this.modifiedDimensionLines,this.xStart,this.yStart,this.elevationStart,this.xEnd,this.yEnd,this.elevationEnd,this.offset,this.lengthFontSize,this.defaultStyle,this.color,this.visibleIn3D,this.pitch);this.home.setSelectedItems(this.oldSelection.slice(0))};return f}(LocalizedUndoableEdit));c.DimensionLinesModificationUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController.DimensionLinesModificationUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var b=(function(){function f(g){if(this.dimensionLine===undefined){this.dimensionLine=null}if(this.xStart===undefined){this.xStart=0}if(this.yStart===undefined){this.yStart=0}if(this.elevationStart===undefined){this.elevationStart=0}if(this.xEnd===undefined){this.xEnd=0}if(this.yEnd===undefined){this.yEnd=0}if(this.elevationEnd===undefined){this.elevationEnd=0}if(this.offset===undefined){this.offset=0}if(this.lengthStyle===undefined){this.lengthStyle=null}if(this.color===undefined){this.color=null}if(this.visibleIn3D===undefined){this.visibleIn3D=false}if(this.pitch===undefined){this.pitch=0}this.dimensionLine=g;this.xStart=g.getXStart();this.yStart=g.getYStart();this.elevationStart=g.getElevationStart();this.xEnd=g.getXEnd();this.yEnd=g.getYEnd();this.elevationEnd=g.getElevationEnd();this.offset=g.getOffset();this.lengthStyle=g.getLengthStyle();this.color=g.getColor();this.visibleIn3D=g.isVisibleIn3D();this.pitch=g.getPitch()}f.prototype.getDimensionLine=function(){return this.dimensionLine};f.prototype.reset=function(){this.dimensionLine.setXStart(this.xStart);this.dimensionLine.setYStart(this.yStart);this.dimensionLine.setElevationStart(this.elevationStart);this.dimensionLine.setXEnd(this.xEnd);this.dimensionLine.setYEnd(this.yEnd);this.dimensionLine.setElevationEnd(this.elevationEnd);this.dimensionLine.setOffset(this.offset);this.dimensionLine.setLengthStyle(this.lengthStyle);this.dimensionLine.setColor(this.color);this.dimensionLine.setVisibleIn3D(this.visibleIn3D);this.dimensionLine.setPitch(this.pitch)};return f}());c.ModifiedDimensionLine=b;b.__class="com.eteks.sweethome3d.viewcontroller.DimensionLineController.ModifiedDimensionLine"})(DimensionLineController||(DimensionLineController={}));var BackgroundImageWizardController=(function(b){__extends(a,b);function a(j,f,h,k,c){var g=b.call(this,f,h)||this;if(g.home===undefined){g.home=null}if(g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences===undefined){g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences=null}if(g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory===undefined){g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory=null}if(g.contentManager===undefined){g.contentManager=null}if(g.undoSupport===undefined){g.undoSupport=null}if(g.imageChoiceStepState===undefined){g.imageChoiceStepState=null}if(g.imageScaleStepState===undefined){g.imageScaleStepState=null}if(g.imageOriginStepState===undefined){g.imageOriginStepState=null}if(g.stepsView===undefined){g.stepsView=null}if(g.step===undefined){g.step=null}if(g.referenceBackgroundImage===undefined){g.referenceBackgroundImage=null}if(g.image===undefined){g.image=null}if(g.scaleDistance===undefined){g.scaleDistance=null}if(g.scaleDistanceXStart===undefined){g.scaleDistanceXStart=0}if(g.scaleDistanceYStart===undefined){g.scaleDistanceYStart=0}if(g.scaleDistanceXEnd===undefined){g.scaleDistanceXEnd=0}if(g.scaleDistanceYEnd===undefined){g.scaleDistanceYEnd=0}if(g.xOrigin===undefined){g.xOrigin=0}if(g.yOrigin===undefined){g.yOrigin=0}g.home=j;g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences=f;g.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory=h;g.contentManager=k;g.undoSupport=c;g.setTitle(f.getLocalizedString(a,"wizard.title"));g.setResizable(true);g.imageChoiceStepState=new a.ImageChoiceStepState(g);g.imageScaleStepState=new a.ImageScaleStepState(g);g.imageOriginStepState=new a.ImageOriginStepState(g);g.setStepState(g.imageChoiceStepState);var l=g.home.getSelectedLevel();if(l!=null){var m=g.home.getLevels();var d=m.indexOf(l);for(var e=d-1;e>=0&&g.referenceBackgroundImage==null;e--){g.referenceBackgroundImage=m[e].getBackgroundImage()}for(var e=d+1;e<m.length&&g.referenceBackgroundImage==null;e++){g.referenceBackgroundImage=m[e].getBackgroundImage()}}return g}a.prototype.finish=function(){var e=this.home.getSelectedLevel();var d=e!=null?e.getBackgroundImage():this.home.getBackgroundImage();var g=this.getScaleDistancePoints();var f=new BackgroundImage(this.getImage(),this.getScaleDistance(),g[0][0],g[0][1],g[1][0],g[1][1],this.getXOrigin(),this.getYOrigin());if(e!=null){e.setBackgroundImage(f)}else{this.home.setBackgroundImage(f)}var c=d==null;this.undoSupport.postEdit(new a.BackgroundImageUndoableEdit(this.home,this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences,e,d,f,c))};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.getStepState=function(){return b.prototype.getStepState.call(this)};a.prototype.getImageChoiceStepState=function(){return this.imageChoiceStepState};a.prototype.getImageOriginStepState=function(){return this.imageOriginStepState};a.prototype.getImageScaleStepState=function(){return this.imageScaleStepState};a.prototype.getStepsView=function(){if(this.stepsView==null){var c=this.home.getSelectedLevel()!=null?this.home.getSelectedLevel().getBackgroundImage():this.home.getBackgroundImage();this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_viewFactory.createBackgroundImageWizardStepsView(c,this.__com_eteks_sweethome3d_viewcontroller_BackgroundImageWizardController_preferences,this)}return this.stepsView};a.prototype.setStep=function(c){if(c!==this.step){var d=this.step;this.step=c;this.propertyChangeSupport.firePropertyChange("STEP",d,c)}};a.prototype.getStep=function(){return this.step};a.prototype.getReferenceBackgroundImage=function(){return this.referenceBackgroundImage};a.prototype.setImage=function(d){if(d!==this.image){var c=this.image;this.image=d;this.propertyChangeSupport.firePropertyChange("IMAGE",c,d)}};a.prototype.getImage=function(){return this.image};a.prototype.setScaleDistance=function(d){if(d!==this.scaleDistance){var c=this.scaleDistance;this.scaleDistance=d;this.propertyChangeSupport.firePropertyChange("SCALE_DISTANCE",c,d)}};a.prototype.getScaleDistance=function(){return this.scaleDistance};a.prototype.setScaleDistancePoints=function(c,g,e,d){if(c!==this.scaleDistanceXStart||g!==this.scaleDistanceYStart||e!==this.scaleDistanceXEnd||d!==this.scaleDistanceYEnd){var f=[[this.scaleDistanceXStart,this.scaleDistanceYStart],[this.scaleDistanceXEnd,this.scaleDistanceYEnd]];this.scaleDistanceXStart=c;this.scaleDistanceYStart=g;this.scaleDistanceXEnd=e;this.scaleDistanceYEnd=d;this.propertyChangeSupport.firePropertyChange("SCALE_DISTANCE_POINTS",f,[[c,g],[e,d]])}};a.prototype.getScaleDistancePoints=function(){return[[this.scaleDistanceXStart,this.scaleDistanceYStart],[this.scaleDistanceXEnd,this.scaleDistanceYEnd]]};a.prototype.setOrigin=function(e,c){if(e!==this.xOrigin){var d=this.xOrigin;this.xOrigin=e;this.propertyChangeSupport.firePropertyChange("X_ORIGIN",d,e)}if(c!==this.yOrigin){var f=this.yOrigin;this.yOrigin=c;this.propertyChangeSupport.firePropertyChange("Y_ORIGIN",f,c)}};a.prototype.getXOrigin=function(){return this.xOrigin};a.prototype.getYOrigin=function(){return this.yOrigin};return a}(WizardController));BackgroundImageWizardController.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController";BackgroundImageWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var d;(function(h){h[h.CHOICE=0]="CHOICE";h[h.SCALE=1]="SCALE";h[h.ORIGIN=2]="ORIGIN"})(d=b.Step||(b.Step={}));var f=(function(h){__extends(j,h);function j(o,l,q,m,n,k){var p=h.call(this,l,b,k?"undoImportBackgroundImageName":"undoModifyBackgroundImageName")||this;if(p.home===undefined){p.home=null}if(p.level===undefined){p.level=null}if(p.oldImage===undefined){p.oldImage=null}if(p.image===undefined){p.image=null}p.home=o;p.level=q;p.oldImage=m;p.image=n;return p}j.prototype.undo=function(){h.prototype.undo.call(this);this.home.setSelectedLevel(this.level);if(this.level!=null){this.level.setBackgroundImage(this.oldImage)}else{this.home.setBackgroundImage(this.oldImage)}};j.prototype.redo=function(){h.prototype.redo.call(this);this.home.setSelectedLevel(this.level);if(this.level!=null){this.level.setBackgroundImage(this.image)}else{this.home.setBackgroundImage(this.image)}};return j}(LocalizedUndoableEdit));b.BackgroundImageUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.BackgroundImageUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var e=(function(j){__extends(h,j);function h(k){var l=j.call(this)||this;l.__parent=k;l.icon="resources/backgroundImageWizard.png";return l}h.prototype.enter=function(){this.__parent.setStep(this.getStep())};h.prototype.getView=function(){return this.__parent.getStepsView()};h.prototype.getIcon=function(){return this.icon};return h}(WizardController.WizardControllerStepState));b.BackgroundImageWizardStepState=e;e.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.BackgroundImageWizardStepState";var a=(function(j){__extends(h,j);function h(k){var l=j.call(this,k)||this;l.__parent=k;k.addPropertyChangeListener("IMAGE",new h.ImageChoiceStepState$0(l));return l}h.prototype.enter=function(){j.prototype.enter.call(this);this.setFirstStep(true);this.setNextStepEnabled(this.__parent.getImage()!=null)};h.prototype.getStep=function(){return b.Step.CHOICE};h.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getImageScaleStepState())};return h}(b.BackgroundImageWizardStepState));b.ImageChoiceStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageChoiceStepState";(function(h){var j=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(l){this.__parent.setNextStepEnabled(this.__parent.__parent.getImage()!=null)};return k}());h.ImageChoiceStepState$0=j})(a=b.ImageChoiceStepState||(b.ImageChoiceStepState={}));var c=(function(j){__extends(h,j);function h(k){var l=j.call(this,k)||this;l.__parent=k;k.addPropertyChangeListener("SCALE_DISTANCE",new h.ImageScaleStepState$0(l));return l}h.prototype.enter=function(){j.prototype.enter.call(this);this.setNextStepEnabled(this.__parent.getScaleDistance()!=null)};h.prototype.getStep=function(){return b.Step.SCALE};h.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getImageChoiceStepState())};h.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getImageOriginStepState())};return h}(b.BackgroundImageWizardStepState));b.ImageScaleStepState=c;c.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageScaleStepState";(function(h){var j=(function(){function k(l){this.__parent=l}k.prototype.propertyChange=function(l){this.__parent.setNextStepEnabled(this.__parent.__parent.getScaleDistance()!=null)};return k}());h.ImageScaleStepState$0=j})(c=b.ImageScaleStepState||(b.ImageScaleStepState={}));var g=(function(h){__extends(j,h);function j(k){var l=h.call(this,k)||this;l.__parent=k;return l}j.prototype.enter=function(){h.prototype.enter.call(this);this.setLastStep(true);this.setNextStepEnabled(true)};j.prototype.getStep=function(){return b.Step.ORIGIN};j.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getImageScaleStepState())};return j}(b.BackgroundImageWizardStepState));b.ImageOriginStepState=g;g.__class="com.eteks.sweethome3d.viewcontroller.BackgroundImageWizardController.ImageOriginStepState"})(BackgroundImageWizardController||(BackgroundImageWizardController={}));var RoomController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.floorTextureController===undefined){this.floorTextureController=null}if(this.ceilingTextureController===undefined){this.ceilingTextureController=null}if(this.wallSidesTextureController===undefined){this.wallSidesTextureController=null}if(this.wallSidesBaseboardController===undefined){this.wallSidesBaseboardController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.roomView===undefined){this.roomView=null}if(this.name===undefined){this.name=null}if(this.areaVisible===undefined){this.areaVisible=null}if(this.floorVisible===undefined){this.floorVisible=null}if(this.floorColor===undefined){this.floorColor=null}if(this.floorPaint===undefined){this.floorPaint=null}if(this.floorShininess===undefined){this.floorShininess=null}if(this.ceilingVisible===undefined){this.ceilingVisible=null}if(this.ceilingColor===undefined){this.ceilingColor=null}if(this.ceilingPaint===undefined){this.ceilingPaint=null}if(this.ceilingShininess===undefined){this.ceilingShininess=null}if(this.ceilingFlat===undefined){this.ceilingFlat=null}if(this.wallSidesEditable===undefined){this.wallSidesEditable=false}if(this.splitSurroundingWalls===undefined){this.splitSurroundingWalls=false}if(this.splitSurroundingWallsNeeded===undefined){this.splitSurroundingWallsNeeded=false}if(this.wallSidesColor===undefined){this.wallSidesColor=null}if(this.wallSidesPaint===undefined){this.wallSidesPaint=null}if(this.wallSidesShininess===undefined){this.wallSidesShininess=null}this.home=f;this.preferences=c;this.viewFactory=b;this.contentManager=e;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getFloorTextureController=function(){if(this.floorTextureController==null){this.floorTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"floorTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.floorTextureController.addPropertyChangeListener("TEXTURE",new a.RoomController$0(this))}return this.floorTextureController};a.prototype.getCeilingTextureController=function(){if(this.ceilingTextureController==null){this.ceilingTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"ceilingTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.ceilingTextureController.addPropertyChangeListener("TEXTURE",new a.RoomController$1(this))}return this.ceilingTextureController};a.prototype.getWallSidesTextureController=function(){if(this.wallSidesTextureController==null){this.wallSidesTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"wallSidesTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.wallSidesTextureController.addPropertyChangeListener("TEXTURE",new a.RoomController$2(this))}return this.wallSidesTextureController};a.prototype.getWallSidesBaseboardController=function(){if(this.wallSidesBaseboardController==null){this.wallSidesBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)}return this.wallSidesBaseboardController};a.prototype.getView=function(){if(this.roomView==null){this.roomView=this.viewFactory.createRoomView(this.preferences,this)}return this.roomView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.isPropertyEditable=function(b){switch((b)){case"SPLIT_SURROUNDING_WALLS":case"WALL_SIDES_COLOR":case"WALL_SIDES_PAINT":case"WALL_SIDES_SHININESS":case"WALL_SIDES_BASEBOARD":return this.wallSidesEditable;default:return true}};a.prototype.updateProperties=function(){var B=Home.getRoomsSubList(this.home.getSelectedItems());if((B.length==0)){this.setAreaVisible(null);this.setFloorColor(null);this.getFloorTextureController().setTexture(null);this.setFloorPaint(null);this.setFloorShininess(null);this.setCeilingColor(null);this.getCeilingTextureController().setTexture(null);this.setCeilingPaint(null);this.setCeilingShininess(null);this.setCeilingFlat(null)}else{var G=B[0];var x=G.getName();if(x!=null){for(var z=1;z<B.length;z++){if(!(x===B[z].getName())){x=null;break}}}this.setName(x);var v=G.isAreaVisible();for(var z=1;z<B.length;z++){if(v!==B[z].isAreaVisible()){v=null;break}}this.setAreaVisible(v);var y=G.isFloorVisible();for(var z=1;z<B.length;z++){if(y!==B[z].isFloorVisible()){y=null;break}}this.setFloorVisible(y);var q=G.getFloorColor();if(q!=null){for(var z=1;z<B.length;z++){if(!(q===B[z].getFloorColor())){q=null;break}}}this.setFloorColor(q);var d=G.getFloorTexture();if(d!=null){for(var z=1;z<B.length;z++){if(!d.equals(B[z].getFloorTexture())){d=null;break}}}this.getFloorTextureController().setTexture(d);var s=true;for(var z=0;z<B.length;z++){var F=B[z];if(F.getFloorColor()!=null||F.getFloorTexture()!=null){s=false;break}}if(q!=null){this.setFloorPaint(a.RoomPaint.COLORED)}else{if(d!=null){this.setFloorPaint(a.RoomPaint.TEXTURED)}else{if(s){this.setFloorPaint(a.RoomPaint.DEFAULT)}else{this.setFloorPaint(null)}}}var w=G.getFloorShininess();for(var z=1;z<B.length;z++){if(!(w===B[z].getFloorShininess())){w=null;break}}this.setFloorShininess(w);var p=G.isCeilingVisible();for(var z=1;z<B.length;z++){if(p!==B[z].isCeilingVisible()){p=null;break}}this.setCeilingVisible(p);var A=G.getCeilingColor();if(A!=null){for(var z=1;z<B.length;z++){if(!(A===B[z].getCeilingColor())){A=null;break}}}this.setCeilingColor(A);var C=G.getCeilingTexture();if(C!=null){for(var z=1;z<B.length;z++){if(!C.equals(B[z].getCeilingTexture())){C=null;break}}}this.getCeilingTextureController().setTexture(C);s=true;for(var z=0;z<B.length;z++){var F=B[z];if(F.getCeilingColor()!=null||F.getCeilingTexture()!=null){s=false;break}}if(A!=null){this.setCeilingPaint(a.RoomPaint.COLORED)}else{if(C!=null){this.setCeilingPaint(a.RoomPaint.TEXTURED)}else{if(s){this.setCeilingPaint(a.RoomPaint.DEFAULT)}else{this.setCeilingPaint(null)}}}var c=G.getCeilingShininess();for(var z=1;z<B.length;z++){if(!(c===B[z].getCeilingShininess())){c=null;break}}this.setCeilingShininess(c);var l=G.isCeilingFlat();for(var z=1;z<B.length;z++){if(l!==B[z].isCeilingFlat()){l=null;break}}this.setCeilingFlat(l)}var u=this.getRoomsWallSides(B,null);if((u.length==0)){this.wallSidesEditable=this.splitSurroundingWallsNeeded=this.splitSurroundingWalls=false;this.setWallSidesColor(null);this.setWallSidesPaint(null);this.setWallSidesShininess(null);this.getWallSidesBaseboardController().setVisible(null);this.getWallSidesBaseboardController().setThickness(null);this.getWallSidesBaseboardController().setHeight(null);this.getWallSidesBaseboardController().setColor(null);this.getWallSidesBaseboardController().getTextureController().setTexture(null);this.getWallSidesBaseboardController().setPaint(null)}else{this.wallSidesEditable=true;this.splitSurroundingWallsNeeded=this.splitWalls(u,null,null,null);this.splitSurroundingWalls=false;var f=u[0];var e=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideColor():f.getWall().getRightSideColor();if(e!=null){for(var z=1;z<u.length;z++){var m=u[z];if(!(e===(m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideColor():m.getWall().getRightSideColor()))){e=null;break}}}this.setWallSidesColor(e);var b=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideTexture():f.getWall().getRightSideTexture();if(b!=null){for(var z=1;z<u.length;z++){var m=u[z];if(!b.equals(m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideTexture():m.getWall().getRightSideTexture())){b=null;break}}}this.getWallSidesTextureController().setTexture(b);var s=true;for(var z=0;z<u.length;z++){var m=u[z];if((m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideColor():m.getWall().getRightSideColor())!=null||(m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideTexture():m.getWall().getRightSideTexture())!=null){s=false;break}}if(e!=null){this.setWallSidesPaint(a.RoomPaint.COLORED)}else{if(b!=null){this.setWallSidesPaint(a.RoomPaint.TEXTURED)}else{if(s){this.setWallSidesPaint(a.RoomPaint.DEFAULT)}else{this.setWallSidesPaint(null)}}}var o=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideShininess():f.getWall().getRightSideShininess();if(o!=null){for(var z=1;z<u.length;z++){var m=u[z];if(!(o===(m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideShininess():m.getWall().getRightSideShininess()))){o=null;break}}}this.setWallSidesShininess(o);var r=f.getSide()===a.WallSide.LEFT_SIDE?f.getWall().getLeftSideBaseboard():f.getWall().getRightSideBaseboard();var D=r!=null;for(var z=1;z<u.length;z++){var m=u[z];if(D!==(m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideBaseboard()!=null:m.getWall().getRightSideBaseboard()!=null)){D=null;break}}this.getWallSidesBaseboardController().setVisible(D);var g=r!=null?r.getThickness():this.preferences.getNewWallBaseboardThickness();for(var z=1;z<u.length;z++){var m=u[z];var k=m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideBaseboard():m.getWall().getRightSideBaseboard();if(!(g===(k!=null?k.getThickness():this.preferences.getNewWallBaseboardThickness()))){g=null;break}}this.getWallSidesBaseboardController().setThickness(g);var t=r!=null?r.getHeight():this.preferences.getNewWallBaseboardHeight();for(var z=1;z<u.length;z++){var m=u[z];var k=m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideBaseboard():m.getWall().getRightSideBaseboard();if(!(t===(k!=null?k.getHeight():this.preferences.getNewWallBaseboardHeight()))){t=null;break}}this.getWallSidesBaseboardController().setHeight(t);var j=f.getWall().isTrapezoidal()?Math.max(f.getWall().getHeight(),f.getWall().getHeightAtEnd()):f.getWall().getHeight();for(var z=1;z<u.length;z++){var E=u[z].getWall();j=Math.max(j,E.isTrapezoidal()?Math.max(E.getHeight(),E.getHeightAtEnd()):E.getHeight())}this.getWallSidesBaseboardController().setMaxHeight(j);var n=r!=null?r.getColor():null;if(n!=null){for(var z=1;z<u.length;z++){var m=u[z];var k=m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideBaseboard():m.getWall().getRightSideBaseboard();if(k==null||!(n===k.getColor())){n=null;break}}}this.getWallSidesBaseboardController().setColor(n);var h=r!=null?r.getTexture():null;if(h!=null){for(var z=1;z<u.length;z++){var m=u[z];var k=m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideBaseboard():m.getWall().getRightSideBaseboard();if(k==null||!h.equals(k.getTexture())){h=null;break}}}this.getWallSidesBaseboardController().getTextureController().setTexture(h);s=true;for(var z=0;z<u.length;z++){var m=u[z];var k=m.getSide()===a.WallSide.LEFT_SIDE?m.getWall().getLeftSideBaseboard():m.getWall().getRightSideBaseboard();if(k!=null&&(k.getColor()!=null||k.getTexture()!=null)){s=false;break}}if(n!=null){this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED)}else{if(h!=null){this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED)}else{if(s){this.getWallSidesBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT)}else{this.getWallSidesBaseboardController().setPaint(null)}}}}};a.prototype.getRoomsWallSides=function(e,d){var k=([]);for(var f=0;f<e.length;f++){var b=e[f];var j=new java.awt.geom.Area(this.getPath(b.getPoints(),true));if(d!=null){for(var h=0;h<d.length;h++){var c=d[h];if(this.isRoomItersectingWallSide(c.getWall().getPoints$(),c.getSide(),j)){(k.push(c)>0)}}}else{var g=this.home.getWalls();for(var h=0;h<g.length;h++){var l=g[h];if((l.getLevel()==null||l.getLevel().isViewable())&&l.isAtLevel(this.home.getSelectedLevel())){var m=l.getPoints$();if(this.isRoomItersectingWallSide(m,a.WallSide.LEFT_SIDE,j)){(k.push(new a.WallSide(l,a.WallSide.LEFT_SIDE))>0)}if(this.isRoomItersectingWallSide(m,a.WallSide.RIGHT_SIDE,j)){(k.push(new a.WallSide(l,a.WallSide.RIGHT_SIDE))>0)}}}}}return k};a.prototype.isRoomItersectingWallSide=function(b,d,e){var c=this.getWallSideArea(b,d);var g=this.getSurface(c);c.intersect(e);if(!c.isEmpty()){var f=this.getSurface(c);if(f>g*0.02){return true}}return false};a.prototype.getWallSideArea=function(b,c){var e=2;if(b.length===4){if(c===a.WallSide.LEFT_SIDE){return new java.awt.geom.Area(this.getPath(new Wall(b[0][0],b[0][1],b[1][0],b[1][1],e,0).getPoints$(),true))}else{return new java.awt.geom.Area(this.getPath(new Wall(b[2][0],b[2][1],b[3][0],b[3][1],e,0).getPoints$(),true))}}else{var g=(function(k){var j=[];while(k-->0){j.push(null)}return j})((b.length/2|0));(function(n,m,p,o,l){if(n!==p||o>=m+l){while(--l>=0){p[o++]=n[m++]}}else{var k=n.slice(m,m+l);for(var j=0;j<l;j++){p[o++]=k[j]}}})(b,c===a.WallSide.LEFT_SIDE?0:g.length,g,0,g.length);var f=(function(k){var j=[];while(k-->0){j.push(null)}return j})(g.length-1);for(var d=0;d<f.length;d++){f[d]=new Wall(g[d][0],g[d][1],g[d+1][0],g[d+1][1],e,0);if(d>0){f[d].setWallAtStart(f[d-1]);f[d-1].setWallAtEnd(f[d])}}g=(function(k){var j=[];while(k-->0){j.push(null)}return j})(b.length);var h=null;for(var d=0;d<f.length;d++){h=f[d].getPoints$();g[d]=h[0];g[g.length-d-1]=h[3]}g[(g.length/2|0)-1]=h[1];g[(g.length/2|0)]=h[2];return new java.awt.geom.Area(this.getPath(g,true))}};a.prototype.getPath=function(d,c){var e=new java.awt.geom.GeneralPath();e.moveTo(d[0][0],d[0][1]);for(var b=1;b<d.length;b++){e.lineTo(d[b][0],d[b][1])}if(c){e.closePath()}return e};a.prototype.getSurface=function(g){var b=0;var f=([]);for(var e=g.getPathIterator(null);!e.isDone();){var d=[0,0];switch((e.currentSegment(d))){case java.awt.geom.PathIterator.SEG_MOVETO:(f.push(d)>0);break;case java.awt.geom.PathIterator.SEG_LINETO:(f.push(d)>0);break;case java.awt.geom.PathIterator.SEG_CLOSE:var c=f.slice(0);b+=Math.abs(this.getSignedSurface(c));(f.length=0);break}e.next()}return b};a.prototype.getSignedSurface=function(d){var c=0;for(var b=1;b<d.length;b++){c+=d[b][0]*d[b-1][1];c-=d[b][1]*d[b-1][0]}c+=d[0][0]*d[d.length-1][1];c-=d[0][1]*d[d.length-1][0];return c/2};a.prototype.setName=function(b){if(b!==this.name){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b)}};a.prototype.getName=function(){return this.name};a.prototype.setAreaVisible=function(b){if(b!==this.areaVisible){var c=this.areaVisible;this.areaVisible=b;this.propertyChangeSupport.firePropertyChange("AREA_VISIBLE",c,b)}};a.prototype.getAreaVisible=function(){return this.areaVisible};a.prototype.setFloorVisible=function(c){if(c!==this.floorVisible){var b=this.floorVisible;this.floorVisible=c;this.propertyChangeSupport.firePropertyChange("FLOOR_VISIBLE",b,c)}};a.prototype.getFloorVisible=function(){return this.floorVisible};a.prototype.setFloorColor=function(b){if(b!==this.floorColor){var c=this.floorColor;this.floorColor=b;this.propertyChangeSupport.firePropertyChange("FLOOR_COLOR",c,b);this.setFloorPaint(a.RoomPaint.COLORED)}};a.prototype.getFloorColor=function(){return this.floorColor};a.prototype.setFloorPaint=function(b){if(b!==this.floorPaint){var c=this.floorPaint;this.floorPaint=b;this.propertyChangeSupport.firePropertyChange("FLOOR_PAINT",c,b)}};a.prototype.getFloorPaint=function(){return this.floorPaint};a.prototype.setFloorShininess=function(c){if(c!==this.floorShininess){var b=this.floorShininess;this.floorShininess=c;this.propertyChangeSupport.firePropertyChange("FLOOR_SHININESS",b,c)}};a.prototype.getFloorShininess=function(){return this.floorShininess};a.prototype.setCeilingVisible=function(b){if(b!==this.ceilingVisible){var c=this.ceilingVisible;this.ceilingVisible=b;this.propertyChangeSupport.firePropertyChange("CEILING_VISIBLE",c,b)}};a.prototype.getCeilingVisible=function(){return this.ceilingVisible};a.prototype.setCeilingColor=function(b){if(b!==this.ceilingColor){var c=this.ceilingColor;this.ceilingColor=b;this.propertyChangeSupport.firePropertyChange("CEILING_COLOR",c,b);this.setCeilingPaint(a.RoomPaint.COLORED)}};a.prototype.getCeilingColor=function(){return this.ceilingColor};a.prototype.setCeilingPaint=function(b){if(b!==this.ceilingPaint){var c=this.ceilingPaint;this.ceilingPaint=b;this.propertyChangeSupport.firePropertyChange("CEILING_PAINT",c,b)}};a.prototype.getCeilingPaint=function(){return this.ceilingPaint};a.prototype.setCeilingShininess=function(c){if(c!==this.ceilingShininess){var b=this.ceilingShininess;this.ceilingShininess=c;this.propertyChangeSupport.firePropertyChange("CEILING_SHININESS",b,c)}};a.prototype.getCeilingShininess=function(){return this.ceilingShininess};a.prototype.setCeilingFlat=function(b){if(b!==this.ceilingFlat){var c=this.ceilingFlat;this.ceilingFlat=b;this.propertyChangeSupport.firePropertyChange("CEILING_FLAT",c,b)}};a.prototype.getCeilingFlat=function(){return this.ceilingFlat};a.prototype.isSplitSurroundingWalls=function(){return this.splitSurroundingWalls};a.prototype.setSplitSurroundingWalls=function(b){if(b!==this.splitSurroundingWalls){this.splitSurroundingWalls=b;this.propertyChangeSupport.firePropertyChange("SPLIT_SURROUNDING_WALLS",!b,b)}};a.prototype.isSplitSurroundingWallsNeeded=function(){return this.splitSurroundingWallsNeeded};a.prototype.setWallSidesColor=function(b){if(b!==this.wallSidesColor){var c=this.wallSidesColor;this.wallSidesColor=b;this.propertyChangeSupport.firePropertyChange("WALL_SIDES_COLOR",c,b);this.setWallSidesPaint(a.RoomPaint.COLORED)}};a.prototype.getWallSidesColor=function(){return this.wallSidesColor};a.prototype.setWallSidesPaint=function(c){if(c!==this.wallSidesPaint){var b=this.wallSidesPaint;this.wallSidesPaint=c;this.propertyChangeSupport.firePropertyChange("WALL_SIDES_PAINT",b,c)}};a.prototype.getWallSidesPaint=function(){return this.wallSidesPaint};a.prototype.setWallSidesShininess=function(b){if(b!==this.wallSidesShininess){var c=this.wallSidesShininess;this.wallSidesShininess=b;this.propertyChangeSupport.firePropertyChange("WALL_SIDES_SHININESS",c,b)}};a.prototype.getWallSidesShininess=function(){return this.wallSidesShininess};a.prototype.modifyRooms=function(){var F=this.home.getSelectedItems();var D=Home.getRoomsSubList(F);if(!(D.length==0)){var u=this.getName();var t=this.getAreaVisible();var y=this.getFloorVisible();var k=this.getFloorPaint();var p=k===a.RoomPaint.COLORED?this.getFloorColor():null;var e=k===a.RoomPaint.TEXTURED?this.getFloorTextureController().getTexture():null;var v=this.getFloorShininess();var o=this.getCeilingVisible();var x=this.getCeilingPaint();var C=x===a.RoomPaint.COLORED?this.getCeilingColor():null;var E=x===a.RoomPaint.TEXTURED?this.getCeilingTextureController().getTexture():null;var c=this.getCeilingShininess();var l=this.getCeilingFlat();var d=this.getWallSidesPaint();var f=d===a.RoomPaint.COLORED?this.getWallSidesColor():null;var b=d===a.RoomPaint.TEXTURED?this.getWallSidesTextureController().getTexture():null;var n=this.getWallSidesShininess();var G=this.getWallSidesBaseboardController().getVisible();var g=this.getWallSidesBaseboardController().getThickness();var r=this.getWallSidesBaseboardController().getHeight();var j=this.getWallSidesBaseboardController().getPaint();var m=j===BaseboardChoiceController.BaseboardPaint.COLORED?this.getWallSidesBaseboardController().getColor():null;var h=j===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getWallSidesBaseboardController().getTextureController().getTexture():null;var B=this.getRoomsWallSides(D,null);var q=(function(J){var I=[];while(J-->0){I.push(null)}return I})(D.length);for(var A=0;A<q.length;A++){q[A]=new a.ModifiedRoom(D[A])}var z=([]);var s=([]);var w=(F.slice(0));if(this.splitSurroundingWalls){if(this.splitWalls(B,z,s,w)){this.home.setSelectedItems(w);B=this.getRoomsWallSides(D,B)}}var H=(function(J){var I=[];while(J-->0){I.push(null)}return I})(B.length);for(var A=0;A<H.length;A++){H[A]=new a.ModifiedWallSide(B[A])}a.doModifyRoomsAndWallSides(this.home,q,u,t,y,k,p,e,v,o,x,C,E,c,l,H,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),d,f,b,n,G,g,r,j,m,h,null,null);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.RoomsAndWallSidesModificationUndoableEdit(this.home,this.preferences,F.slice(0),w.slice(0),q,u,t,y,k,p,e,v,o,x,C,E,c,l,H,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),d,f,b,n,G,g,r,j,m,h,z.slice(0),s.slice(0)))}if(u!=null){this.preferences.addAutoCompletionString("RoomName",u)}}};a.prototype.splitWalls=function(m,l,n,g){var f=null;var j=([]);var o;var b=function(){o=null;var H=null;var B=null;var s=null;for(var D=0;D<m.length&&o==null;D++){var y=m[D];var F=y.getWall();var C=F.getArcExtent();if(C==null||C===0){var q=new java.awt.geom.Area(p.getPath(F.getPoints$(),true));for(var v=0;v<m.length;v++){var t=m[v];var x=t.getWall();if(F!==x){var I=new java.awt.geom.Area(p.getPath(x.getPoints$(),true));I.intersect(q);if(!I.isEmpty()&&I.isSingular()){var A=p.computeIntersection(F.getXStart(),F.getYStart(),F.getXEnd(),F.getYEnd(),x.getXStart(),x.getYStart(),x.getXEnd(),x.getYEnd());if(A!=null){H=F.duplicate();B=F.duplicate();H.setLevel(F.getLevel());B.setLevel(F.getLevel());H.setXEnd(A[0]);H.setYEnd(A[1]);B.setXStart(A[0]);B.setYStart(A[1]);if(H.getLength()>x.getThickness()/2&&B.getLength()>x.getThickness()/2){if(l==null){return{value:true}}if(f==null){f=({});for(var u=0;u<m.length;u++){var r=m[u];if(!(function(K,L){if(K.entries==null){K.entries=[]}for(var M=0;M<K.entries.length;M++){if(K.entries[M].key==null&&L==null||K.entries[M].key.equals!=null&&K.entries[M].key.equals(L)||K.entries[M].key===L){return true}}return false})(f,r.getWall())){(function(K,M,L){if(K.entries==null){K.entries=[]}for(var N=0;N<K.entries.length;N++){if(K.entries[N].key==null&&M==null||K.entries[N].key.equals!=null&&K.entries[N].key.equals(M)||K.entries[N].key===M){K.entries[N].value=L;return}}K.entries.push({key:M,value:L,getKey:function(){return this.key},getValue:function(){return this.value}})})(f,r.getWall(),new a.ModifiedWall(r.getWall()))}}}s=(function(K,L){if(K.entries==null){K.entries=[]}for(var M=0;M<K.entries.length;M++){if(K.entries[M].key==null&&L==null||K.entries[M].key.equals!=null&&K.entries[M].key.equals(L)||K.entries[M].key===L){return K.entries[M].value}}return null})(f,F);var G=F.getWallAtStart();if(G!=null){H.setWallAtStart(G);if(G.getWallAtEnd()===F){G.setWallAtEnd(H)}else{G.setWallAtStart(H)}}var w=F.getWallAtEnd();if(w!=null){B.setWallAtEnd(w);if(w.getWallAtEnd()===F){w.setWallAtEnd(B)}else{w.setWallAtStart(B)}}H.setWallAtEnd(B);B.setWallAtStart(H);if(F.getHeightAtEnd()!=null){var z=F.getHeight()+(F.getHeightAtEnd()-F.getHeight())*java.awt.geom.Point2D.distance(F.getXStart(),F.getYStart(),A[0],A[1])/F.getLength();H.setHeightAtEnd(z);B.setHeight(z)}o=y;break}}}}}}}if(o!=null){(j.push(H)>0);(j.push(B)>0);var E=o.getWall();if((p.home.getWalls().indexOf((E))>=0)){(l.push(s)>0)}else{for(var D=j.length-1;D>=0;D--){if(j[D]===E){j.splice(D,1)[0];break}}}if((function(K){var L=K.indexOf(E);if(L>=0){K.splice(L,1);return true}else{return false}})(g)){(g.push(H)>0);(g.push(B)>0)}(function(K){var L=K.indexOf(o);if(L>=0){K.splice(L,1);return true}else{return false}})(m);(m.push(new a.WallSide(H,o.getSide()))>0);(m.push(new a.WallSide(B,o.getSide()))>0);var J=([]);for(var D=m.length-1;D>=0;D--){var y=m[D];if(y.getWall()===E){m.splice(D,1)[0];(J.push(new a.WallSide(H,y.getSide()))>0);(J.push(new a.WallSide(B,y.getSide()))>0)}}(function(L,K){return L.push.apply(L,K)})(m,J)}};var p=this;do{var c=b();if(typeof c==="object"){return c.value}}while((o!=null));if(l==null){return false}else{for(var h=0;h<j.length;h++){var e=j[h];var k=new a.ModifiedWall(e);(n.push(k)>0);this.home.addWall(e);e.setLevel(k.getLevel())}for(var h=0;h<l.length;h++){var d=l[h];this.home.deleteWall(d.getWall())}return !(l.length==0)}};a.prototype.computeIntersection=function(k,e,j,d,h,c,g,b){var f=PlanController.computeIntersection$float$float$float$float$float$float$float$float(k,e,j,d,h,c,g,b);if(java.awt.geom.Line2D.ptSegDistSq(k,e,j,d,f[0],f[1])<1e-7&&(Math.abs(k-f[0])>0.0001||Math.abs(e-f[1])>0.0001)&&(Math.abs(j-f[0])>0.0001||Math.abs(d-f[1])>0.0001)){return f}else{return null}};a.doModifyRoomsAndWallSides=function(k,E,o,d,I,C,q,D,x,M,w,l,J,H,A,z,p,e,j,L,K,Q,P,f,h,F,r,N,s,u){if(s!=null){for(var B=0;B<u.length;B++){var O=u[B];O.resetJoinedWalls();k.addWall(O.getWall());O.getWall().setLevel(O.getLevel())}for(var B=0;B<s.length;B++){var G=s[B];k.deleteWall(G.getWall())}}for(var B=0;B<E.length;B++){var g=E[B];var v=g.getRoom();if(o!=null){v.setName(o)}if(d!=null){v.setAreaVisible(d)}if(I!=null){v.setFloorVisible(I)}if(C!=null){switch((C)){case a.RoomPaint.DEFAULT:v.setFloorColor(null);v.setFloorTexture(null);break;case a.RoomPaint.COLORED:v.setFloorColor(q);v.setFloorTexture(null);break;case a.RoomPaint.TEXTURED:v.setFloorColor(null);v.setFloorTexture(D);break}}if(x!=null){v.setFloorShininess(x)}if(M!=null){v.setCeilingVisible(M)}if(w!=null){switch((w)){case a.RoomPaint.DEFAULT:v.setCeilingColor(null);v.setCeilingTexture(null);break;case a.RoomPaint.COLORED:v.setCeilingColor(l);v.setCeilingTexture(null);break;case a.RoomPaint.TEXTURED:v.setCeilingColor(null);v.setCeilingTexture(J);break}}if(H!=null){v.setCeilingShininess(H)}if(A!=null){v.setCeilingFlat(A)}}for(var B=0;B<z.length;B++){var b=z[B];var S=b.getWallSide();var m=S.getWall();if(S.getSide()===a.WallSide.LEFT_SIDE){if(j!=null){switch((j)){case a.RoomPaint.DEFAULT:m.setLeftSideColor(null);m.setLeftSideTexture(null);break;case a.RoomPaint.COLORED:m.setLeftSideColor(L);m.setLeftSideTexture(null);break;case a.RoomPaint.TEXTURED:m.setLeftSideColor(null);m.setLeftSideTexture(K);break}}if(Q!=null){m.setLeftSideShininess(Q)}}else{if(j!=null){switch((j)){case a.RoomPaint.DEFAULT:m.setRightSideColor(null);m.setRightSideTexture(null);break;case a.RoomPaint.COLORED:m.setRightSideColor(L);m.setRightSideTexture(null);break;case a.RoomPaint.TEXTURED:m.setRightSideColor(null);m.setRightSideTexture(K);break}}if(Q!=null){m.setRightSideShininess(Q)}}if(P===false){if(S.getSide()===a.WallSide.LEFT_SIDE){m.setLeftSideBaseboard(null)}else{m.setRightSideBaseboard(null)}}else{var c=S.getSide()===a.WallSide.LEFT_SIDE?m.getLeftSideBaseboard():m.getRightSideBaseboard();if(P===true||c!=null){var t=c!=null?c.getThickness():p;var y=c!=null?c.getHeight():e;var R=c!=null?c.getColor():null;var n=c!=null?c.getTexture():null;if(F!=null){switch((F)){case BaseboardChoiceController.BaseboardPaint.DEFAULT:R=null;n=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:if(r!=null){R=r}n=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:R=null;if(N!=null){n=N}break}}c=Baseboard.getInstance(f!=null?f:t,h!=null?h:y,R,n);if(S.getSide()===a.WallSide.LEFT_SIDE){m.setLeftSideBaseboard(c)}else{m.setRightSideBaseboard(c)}}}}};a.undoModifyRoomsAndWallSides=function(h,d,l,j,k){for(var g=0;g<d.length;g++){var c=d[g];c.reset()}for(var g=0;g<l.length;g++){var b=l[g];b.reset()}for(var g=0;g<k.length;g++){var f=k[g];h.deleteWall(f.getWall())}for(var g=0;g<j.length;g++){var e=j[g];e.resetJoinedWalls();h.addWall(e.getWall());e.getWall().setLevel(e.getLevel())}};return a}());RoomController.__class="com.eteks.sweethome3d.viewcontroller.RoomController";RoomController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(c){var f;(function(l){l[l.DEFAULT=0]="DEFAULT";l[l.COLORED=1]="COLORED";l[l.TEXTURED=2]="TEXTURED"})(f=c.RoomPaint||(c.RoomPaint={}));var a=(function(l){__extends(m,l);function m(S,E,Q,J,F,U,H,M,w,B,r,I,A,K,O,P,p,x,T,C,q,o,s,n,z,R,t,D,v,y,u,N,G){var L=l.call(this,E,c,"undoModifyRoomsName")||this;if(L.home===undefined){L.home=null}if(L.oldSelection===undefined){L.oldSelection=null}if(L.newSelection===undefined){L.newSelection=null}if(L.modifiedRooms===undefined){L.modifiedRooms=null}if(L.name===undefined){L.name=null}if(L.areaVisible===undefined){L.areaVisible=null}if(L.floorVisible===undefined){L.floorVisible=null}if(L.floorPaint===undefined){L.floorPaint=null}if(L.floorColor===undefined){L.floorColor=null}if(L.floorTexture===undefined){L.floorTexture=null}if(L.floorShininess===undefined){L.floorShininess=null}if(L.ceilingVisible===undefined){L.ceilingVisible=null}if(L.ceilingPaint===undefined){L.ceilingPaint=null}if(L.ceilingColor===undefined){L.ceilingColor=null}if(L.ceilingTexture===undefined){L.ceilingTexture=null}if(L.ceilingShininess===undefined){L.ceilingShininess=null}if(L.ceilingFlat===undefined){L.ceilingFlat=null}if(L.modifiedWallSides===undefined){L.modifiedWallSides=null}if(L.newWallBaseboardHeight===undefined){L.newWallBaseboardHeight=0}if(L.newWallBaseboardThickness===undefined){L.newWallBaseboardThickness=0}if(L.wallSidesPaint===undefined){L.wallSidesPaint=null}if(L.wallSidesColor===undefined){L.wallSidesColor=null}if(L.wallSidesTexture===undefined){L.wallSidesTexture=null}if(L.wallSidesShininess===undefined){L.wallSidesShininess=null}if(L.wallSidesBaseboardVisible===undefined){L.wallSidesBaseboardVisible=null}if(L.wallSidesBaseboardThickness===undefined){L.wallSidesBaseboardThickness=null}if(L.wallSidesBaseboardHeight===undefined){L.wallSidesBaseboardHeight=null}if(L.wallSidesBaseboardPaint===undefined){L.wallSidesBaseboardPaint=null}if(L.wallSidesBaseboardColor===undefined){L.wallSidesBaseboardColor=null}if(L.wallSidesBaseboardTexture===undefined){L.wallSidesBaseboardTexture=null}if(L.deletedWalls===undefined){L.deletedWalls=null}if(L.addedWalls===undefined){L.addedWalls=null}L.home=S;L.oldSelection=Q;L.newSelection=J;L.modifiedRooms=F;L.name=U;L.areaVisible=H;L.floorVisible=M;L.floorPaint=w;L.floorColor=B;L.floorTexture=r;L.floorShininess=I;L.ceilingVisible=A;L.ceilingPaint=K;L.ceilingColor=O;L.ceilingTexture=P;L.ceilingShininess=p;L.ceilingFlat=x;L.modifiedWallSides=T;L.newWallBaseboardThickness=C;L.newWallBaseboardHeight=q;L.wallSidesPaint=o;L.wallSidesColor=s;L.wallSidesTexture=n;L.wallSidesShininess=z;L.wallSidesBaseboardVisible=R;L.wallSidesBaseboardThickness=t;L.wallSidesBaseboardHeight=D;L.wallSidesBaseboardPaint=v;L.wallSidesBaseboardColor=y;L.wallSidesBaseboardTexture=u;L.deletedWalls=N;L.addedWalls=G;return L}m.prototype.undo=function(){l.prototype.undo.call(this);c.undoModifyRoomsAndWallSides(this.home,this.modifiedRooms,this.modifiedWallSides,this.deletedWalls,this.addedWalls);this.home.setSelectedItems(this.oldSelection.slice(0))};m.prototype.redo=function(){l.prototype.redo.call(this);c.doModifyRoomsAndWallSides(this.home,this.modifiedRooms,this.name,this.areaVisible,this.floorVisible,this.floorPaint,this.floorColor,this.floorTexture,this.floorShininess,this.ceilingVisible,this.ceilingPaint,this.ceilingColor,this.ceilingTexture,this.ceilingShininess,this.ceilingFlat,this.modifiedWallSides,this.newWallBaseboardThickness,this.newWallBaseboardHeight,this.wallSidesPaint,this.wallSidesColor,this.wallSidesTexture,this.wallSidesShininess,this.wallSidesBaseboardVisible,this.wallSidesBaseboardThickness,this.wallSidesBaseboardHeight,this.wallSidesBaseboardPaint,this.wallSidesBaseboardColor,this.wallSidesBaseboardTexture,this.deletedWalls,this.addedWalls);this.home.setSelectedItems(this.newSelection.slice(0))};return m}(LocalizedUndoableEdit));c.RoomsAndWallSidesModificationUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.RoomController.RoomsAndWallSidesModificationUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var k=(function(){function l(m){if(this.room===undefined){this.room=null}if(this.name===undefined){this.name=null}if(this.areaVisible===undefined){this.areaVisible=false}if(this.floorVisible===undefined){this.floorVisible=false}if(this.floorColor===undefined){this.floorColor=null}if(this.floorTexture===undefined){this.floorTexture=null}if(this.floorShininess===undefined){this.floorShininess=0}if(this.ceilingVisible===undefined){this.ceilingVisible=false}if(this.ceilingColor===undefined){this.ceilingColor=null}if(this.ceilingTexture===undefined){this.ceilingTexture=null}if(this.ceilingShininess===undefined){this.ceilingShininess=0}if(this.ceilingFlat===undefined){this.ceilingFlat=false}this.room=m;this.name=m.getName();this.areaVisible=m.isAreaVisible();this.floorVisible=m.isFloorVisible();this.floorColor=m.getFloorColor();this.floorTexture=m.getFloorTexture();this.floorShininess=m.getFloorShininess();this.ceilingVisible=m.isCeilingVisible();this.ceilingColor=m.getCeilingColor();this.ceilingTexture=m.getCeilingTexture();this.ceilingShininess=m.getCeilingShininess();this.ceilingFlat=m.isCeilingFlat()}l.prototype.getRoom=function(){return this.room};l.prototype.reset=function(){this.room.setName(this.name);this.room.setAreaVisible(this.areaVisible);this.room.setFloorVisible(this.floorVisible);this.room.setFloorColor(this.floorColor);this.room.setFloorTexture(this.floorTexture);this.room.setFloorShininess(this.floorShininess);this.room.setCeilingVisible(this.ceilingVisible);this.room.setCeilingColor(this.ceilingColor);this.room.setCeilingTexture(this.ceilingTexture);this.room.setCeilingShininess(this.ceilingShininess);this.room.setCeilingFlat(this.ceilingFlat)};return l}());c.ModifiedRoom=k;k.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedRoom";var j=(function(){function l(m,n){if(this.wall===undefined){this.wall=null}if(this.side===undefined){this.side=0}if(this.wallAtStart===undefined){this.wallAtStart=null}if(this.wallAtEnd===undefined){this.wallAtEnd=null}if(this.joinedAtEndOfWallAtStart===undefined){this.joinedAtEndOfWallAtStart=false}if(this.joinedAtStartOfWallAtEnd===undefined){this.joinedAtStartOfWallAtEnd=false}this.wall=m;this.side=n;this.wallAtStart=m.getWallAtStart();this.joinedAtEndOfWallAtStart=this.wallAtStart!=null&&this.wallAtStart.getWallAtEnd()===m;this.wallAtEnd=m.getWallAtEnd();this.joinedAtStartOfWallAtEnd=this.wallAtEnd!=null&&this.wallAtEnd.getWallAtStart()===m}l.prototype.getWall=function(){return this.wall};l.prototype.getSide=function(){return this.side};l.prototype.getWallAtStart=function(){return this.wallAtStart};l.prototype.getWallAtEnd=function(){return this.wallAtEnd};l.prototype.isJoinedAtEndOfWallAtStart=function(){return this.joinedAtEndOfWallAtStart};l.prototype.isJoinedAtStartOfWallAtEnd=function(){return this.joinedAtStartOfWallAtEnd};l.LEFT_SIDE=0;l.RIGHT_SIDE=1;return l}());c.WallSide=j;j.__class="com.eteks.sweethome3d.viewcontroller.RoomController.WallSide";var g=(function(){function l(m){if(this.wall===undefined){this.wall=null}if(this.level===undefined){this.level=null}if(this.wallAtStart===undefined){this.wallAtStart=null}if(this.wallAtEnd===undefined){this.wallAtEnd=null}if(this.joinedAtEndOfWallAtStart===undefined){this.joinedAtEndOfWallAtStart=false}if(this.joinedAtStartOfWallAtEnd===undefined){this.joinedAtStartOfWallAtEnd=false}this.wall=m;this.level=m.getLevel();this.wallAtStart=m.getWallAtStart();this.joinedAtEndOfWallAtStart=this.wallAtStart!=null&&this.wallAtStart.getWallAtEnd()===m;this.wallAtEnd=m.getWallAtEnd();this.joinedAtStartOfWallAtEnd=this.wallAtEnd!=null&&this.wallAtEnd.getWallAtStart()===m}l.prototype.getWall=function(){return this.wall};l.prototype.getLevel=function(){return this.level};l.prototype.resetJoinedWalls=function(){if(this.wallAtStart!=null){this.wall.setWallAtStart(this.wallAtStart);if(this.joinedAtEndOfWallAtStart){this.wallAtStart.setWallAtEnd(this.wall)}else{this.wallAtStart.setWallAtStart(this.wall)}}if(this.wallAtEnd!=null){this.wall.setWallAtEnd(this.wallAtEnd);if(this.joinedAtStartOfWallAtEnd){this.wallAtEnd.setWallAtStart(this.wall)}else{this.wallAtEnd.setWallAtEnd(this.wall)}}};return l}());c.ModifiedWall=g;g.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedWall";var h=(function(){function l(n){if(this.wallSide===undefined){this.wallSide=null}if(this.wallColor===undefined){this.wallColor=null}if(this.wallTexture===undefined){this.wallTexture=null}if(this.wallShininess===undefined){this.wallShininess=null}if(this.wallBaseboard===undefined){this.wallBaseboard=null}this.wallSide=n;var m=n.getWall();if(n.getSide()===c.WallSide.LEFT_SIDE){this.wallColor=m.getLeftSideColor();this.wallTexture=m.getLeftSideTexture();this.wallShininess=m.getLeftSideShininess();this.wallBaseboard=m.getLeftSideBaseboard()}else{this.wallColor=m.getRightSideColor();this.wallTexture=m.getRightSideTexture();this.wallShininess=m.getRightSideShininess();this.wallBaseboard=m.getRightSideBaseboard()}}l.prototype.getWallSide=function(){return this.wallSide};l.prototype.reset=function(){var m=this.wallSide.getWall();if(this.wallSide.getSide()===c.WallSide.LEFT_SIDE){m.setLeftSideColor(this.wallColor);m.setLeftSideTexture(this.wallTexture);m.setLeftSideShininess(this.wallShininess);m.setLeftSideBaseboard(this.wallBaseboard)}else{m.setRightSideColor(this.wallColor);m.setRightSideTexture(this.wallTexture);m.setRightSideShininess(this.wallShininess);m.setRightSideBaseboard(this.wallBaseboard)}var n=this.wallSide.getWallAtStart();if(n!=null){m.setWallAtStart(n);if(this.wallSide.isJoinedAtEndOfWallAtStart()){n.setWallAtEnd(m)}else{n.setWallAtStart(m)}}var o=this.wallSide.getWallAtEnd();if(o!=null){m.setWallAtEnd(o);if(this.wallSide.isJoinedAtStartOfWallAtEnd()){o.setWallAtStart(m)}else{o.setWallAtEnd(m)}}};return l}());c.ModifiedWallSide=h;h.__class="com.eteks.sweethome3d.viewcontroller.RoomController.ModifiedWallSide";var e=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setFloorPaint(c.RoomPaint.TEXTURED)};return l}());c.RoomController$0=e;var d=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setCeilingPaint(c.RoomPaint.TEXTURED)};return l}());c.RoomController$1=d;var b=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setWallSidesPaint(c.RoomPaint.TEXTURED)};return l}());c.RoomController$2=b})(RoomController||(RoomController={}));var CompassController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.compassView===undefined){this.compassView=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.diameter===undefined){this.diameter=0}if(this.visible===undefined){this.visible=false}if(this.northDirectionInDegrees===undefined){this.northDirectionInDegrees=0}if(this.latitudeInDegrees===undefined){this.latitudeInDegrees=0}if(this.longitudeInDegrees===undefined){this.longitudeInDegrees=0}if(this.timeZone===undefined){this.timeZone=null}this.home=e;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.compassView==null){this.compassView=this.viewFactory.createCompassView(this.preferences,this)}return this.compassView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getCompass();this.setX(b.getX());this.setY(b.getY());this.setDiameter(b.getDiameter());this.setVisible(b.isVisible());this.setNorthDirectionInDegrees((function(c){return c*180/Math.PI})(b.getNorthDirection()));this.setLatitudeInDegrees((function(c){return c*180/Math.PI})(b.getLatitude()));this.setLongitudeInDegrees((function(c){return c*180/Math.PI})(b.getLongitude()));this.setTimeZone(b.getTimeZone())};a.prototype.getX=function(){return this.x};a.prototype.setX=function(b){if(b!==this.x){var c=this.x;this.x=b;this.propertyChangeSupport.firePropertyChange("X",c,b)}};a.prototype.getY=function(){return this.y};a.prototype.setY=function(c){if(c!==this.y){var b=this.y;this.y=c;this.propertyChangeSupport.firePropertyChange("Y",b,c)}};a.prototype.getDiameter=function(){return this.diameter};a.prototype.setDiameter=function(b){if(b!==this.diameter){var c=this.diameter;this.diameter=b;this.propertyChangeSupport.firePropertyChange("DIAMETER",c,b)}};a.prototype.isVisible=function(){return this.visible};a.prototype.setVisible=function(b){if(b!==this.visible){this.visible=b;this.propertyChangeSupport.firePropertyChange("VISIBLE",!b,b)}};a.prototype.getNorthDirectionInDegrees=function(){return this.northDirectionInDegrees};a.prototype.setNorthDirectionInDegrees=function(b){if(b!==this.northDirectionInDegrees){var c=this.northDirectionInDegrees;this.northDirectionInDegrees=b;this.propertyChangeSupport.firePropertyChange("NORTH_DIRECTION_IN_DEGREES",c,b)}};a.prototype.getLatitudeInDegrees=function(){return this.latitudeInDegrees};a.prototype.setLatitudeInDegrees=function(c){if(c!==this.latitudeInDegrees){var b=this.latitudeInDegrees;this.latitudeInDegrees=c;this.propertyChangeSupport.firePropertyChange("LATITUDE_IN_DEGREES",b,c)}};a.prototype.getLongitudeInDegrees=function(){return this.longitudeInDegrees};a.prototype.setLongitudeInDegrees=function(c){if(c!==this.longitudeInDegrees){var b=this.longitudeInDegrees;this.longitudeInDegrees=c;this.propertyChangeSupport.firePropertyChange("LONGITUDE_IN_DEGREES",b,c)}};a.prototype.getTimeZone=function(){return this.timeZone};a.prototype.setTimeZone=function(b){if(!(b===this.timeZone)){var c=this.timeZone;this.timeZone=b;this.propertyChangeSupport.firePropertyChange("TIME_ZONE",c,b)}};a.prototype.modifyCompass=function(){var h=this.getX();var f=this.getY();var k=this.getDiameter();var d=this.isVisible();var e=(function(l){return l*Math.PI/180})(this.getNorthDirectionInDegrees());var g=(function(l){return l*Math.PI/180})(this.getLatitudeInDegrees());var b=(function(l){return l*Math.PI/180})(this.getLongitudeInDegrees());var j=this.getTimeZone();var c=new a.CompassUndoableEdit(this.home.getCompass(),this.preferences,h,f,k,d,e,g,b,j);a.doModifyCompass(this.home.getCompass(),h,f,k,d,e,g,b,j);this.undoSupport.postEdit(c)};a.doModifyCompass=function(c,h,f,k,d,e,g,b,j){c.setX(h);c.setY(f);c.setDiameter(k);c.setVisible(d);c.setNorthDirection(e);c.setLatitude(g);c.setLongitude(b);c.setTimeZone(j)};return a}());CompassController.__class="com.eteks.sweethome3d.viewcontroller.CompassController";CompassController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(c){__extends(d,c);function d(f,j,e,o,p,g,h,k,n,m){var l=c.call(this,j,b,"undoModifyCompassName")||this;if(l.compass===undefined){l.compass=null}if(l.oldX===undefined){l.oldX=0}if(l.oldY===undefined){l.oldY=0}if(l.oldDiameter===undefined){l.oldDiameter=0}if(l.oldNorthDirection===undefined){l.oldNorthDirection=0}if(l.oldLatitude===undefined){l.oldLatitude=0}if(l.oldLongitude===undefined){l.oldLongitude=0}if(l.oldTimeZone===undefined){l.oldTimeZone=null}if(l.oldVisible===undefined){l.oldVisible=false}if(l.newX===undefined){l.newX=0}if(l.newY===undefined){l.newY=0}if(l.newDiameter===undefined){l.newDiameter=0}if(l.newNorthDirection===undefined){l.newNorthDirection=0}if(l.newLatitude===undefined){l.newLatitude=0}if(l.newLongitude===undefined){l.newLongitude=0}if(l.newTimeZone===undefined){l.newTimeZone=null}if(l.newVisible===undefined){l.newVisible=false}l.compass=f;l.oldX=f.getX();l.oldY=f.getY();l.oldDiameter=f.getDiameter();l.oldVisible=f.isVisible();l.oldNorthDirection=f.getNorthDirection();l.oldLatitude=f.getLatitude();l.oldLongitude=f.getLongitude();l.oldTimeZone=f.getTimeZone();l.newX=e;l.newY=o;l.newDiameter=p;l.newVisible=g;l.newNorthDirection=h;l.newLatitude=k;l.newLongitude=n;l.newTimeZone=m;return l}d.prototype.undo=function(){c.prototype.undo.call(this);b.doModifyCompass(this.compass,this.oldX,this.oldY,this.oldDiameter,this.oldVisible,this.oldNorthDirection,this.oldLatitude,this.oldLongitude,this.oldTimeZone)};d.prototype.redo=function(){c.prototype.redo.call(this);b.doModifyCompass(this.compass,this.newX,this.newY,this.newDiameter,this.newVisible,this.newNorthDirection,this.newLatitude,this.newLongitude,this.newTimeZone)};return d}(LocalizedUndoableEdit));b.CompassUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.CompassController.CompassUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"]})(CompassController||(CompassController={}));var PolylineController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.polylineView===undefined){this.polylineView=null}if(this.thickness===undefined){this.thickness=null}if(this.capStyleEditable===undefined){this.capStyleEditable=false}if(this.capStyle===undefined){this.capStyle=null}if(this.joinStyle===undefined){this.joinStyle=null}if(this.joinStyleEditable===undefined){this.joinStyleEditable=false}if(this.dashStyle===undefined){this.dashStyle=null}if(this.dashPattern===undefined){this.dashPattern=null}if(this.dashOffset===undefined){this.dashOffset=null}if(this.arrowsStyleEditable===undefined){this.arrowsStyleEditable=false}if(this.startArrowStyle===undefined){this.startArrowStyle=null}if(this.endArrowStyle===undefined){this.endArrowStyle=null}if(this.color===undefined){this.color=null}if(this.elevation===undefined){this.elevation=null}if(this.elevationEnabled===undefined){this.elevationEnabled=null}this.home=f;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.polylineView==null){this.polylineView=this.viewFactory.createPolylineView(this.preferences,this)}return this.polylineView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var m=Home.getPolylinesSubList(this.home.getSelectedItems());if((m.length==0)){this.setThickness(null);this.capStyleEditable=false;this.setCapStyle(null);this.joinStyleEditable=false;this.setJoinStyle(null);this.setDashStyle(null);this.dashPattern=null;this.setDashOffset(null);this.arrowsStyleEditable=false;this.setStartArrowStyle(null);this.setEndArrowStyle(null);this.setColor(null);this.elevationEnabled=false}else{var d=m[0];var l=d.getThickness();for(var h=1;h<m.length;h++){if(l!==m[h].getThickness()){l=null;break}}this.setThickness(l);this.capStyleEditable=false;for(var h=0;h<m.length;h++){if(!m[h].isClosedPath()){this.capStyleEditable=true;break}}if(this.capStyleEditable){var o=d.getCapStyle();if(o!=null){for(var h=1;h<m.length;h++){if(o!==m[h].getCapStyle()){o=null;break}}}this.setCapStyle(o)}else{this.setCapStyle(null)}this.joinStyleEditable=false;for(var h=0;h<m.length;h++){if(m[h].getPointCount()>2){this.joinStyleEditable=true;break}}if(this.joinStyleEditable){var g=d.getJoinStyle();if(g!=null){for(var h=1;h<m.length;h++){if(g!==m[h].getJoinStyle()){g=null;break}}}this.setJoinStyle(g)}else{this.setJoinStyle(null)}var b=d.getDashPattern();if(b!=null){for(var h=1;h<m.length;h++){if(!(function(r,q){if(r==null&&q==null){return true}if(r==null||q==null){return false}if(r.length!=q.length){return false}for(var s=0;s<r.length;s++){if(r[s]!=q[s]){return false}}return true})(b,m[h].getDashPattern())){b=null;break}}}this.setDashPattern(b);if(b!=null){var p=d.getDashStyle();if(p!=null){for(var h=1;h<m.length;h++){if(p!==m[h].getDashStyle()){p=null;break}}}if(p===Polyline.DashStyle.CUSTOMIZED){}this.setDashStyle(p)}else{this.setDashStyle(null)}var f=d.getDashOffset();for(var h=1;h<m.length;h++){if(f!==m[h].getDashOffset()){f=null;break}}this.setDashOffset(f);this.arrowsStyleEditable=this.capStyleEditable;if(this.arrowsStyleEditable){var j=d.getStartArrowStyle();if(j!=null){for(var h=1;h<m.length;h++){if(j!==m[h].getStartArrowStyle()){j=null;break}}}this.setStartArrowStyle(j);var c=d.getEndArrowStyle();if(c!=null){for(var h=1;h<m.length;h++){if(c!==m[h].getEndArrowStyle()){c=null;break}}}this.setEndArrowStyle(c)}else{this.setStartArrowStyle(null);this.setEndArrowStyle(null)}var e=d.getColor();if(e!=null){for(var h=1;h<m.length;h++){if(e!==m[h].getColor()){e=null;break}}}this.setColor(e);var n=d.getElevation();for(var h=1;h<m.length;h++){if(n!==m[h].getElevation()){n=null;break}}this.setElevation(n);var k=d.isVisibleIn3D();for(var h=1;h<m.length;h++){if(!(k===m[h].isVisibleIn3D())){k=null;break}}this.elevationEnabled=k}};a.prototype.setThickness=function(c){if(c!==this.thickness){var b=this.thickness;this.thickness=c;this.propertyChangeSupport.firePropertyChange("THICKNESS",b,c)}};a.prototype.getThickness=function(){return this.thickness};a.prototype.setCapStyle=function(c){if(c!==this.capStyle){var b=this.capStyle;this.capStyle=c;this.propertyChangeSupport.firePropertyChange("CAP_STYLE",b,c)}};a.prototype.getCapStyle=function(){return this.capStyle};a.prototype.isCapStyleEditable=function(){return this.capStyleEditable};a.prototype.setJoinStyle=function(c){if(c!==this.joinStyle){var b=this.joinStyle;this.joinStyle=c;this.propertyChangeSupport.firePropertyChange("JOIN_STYLE",b,c)}};a.prototype.getJoinStyle=function(){return this.joinStyle};a.prototype.isJoinStyleEditable=function(){return this.joinStyleEditable};a.prototype.setDashStyle=function(c){if(c!==this.dashStyle){var b=this.dashStyle;this.dashStyle=c;this.propertyChangeSupport.firePropertyChange("DASH_STYLE",b,c)}};a.prototype.getDashStyle=function(){return this.dashStyle};a.prototype.setDashPattern=function(b){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(b,this.dashPattern)){var c=this.dashPattern;this.dashPattern=b;this.propertyChangeSupport.firePropertyChange("DASH_PATTERN",c,b)}};a.prototype.getDashPattern=function(){return this.dashPattern};a.prototype.setDashOffset=function(c){if(c!==this.dashOffset){var b=this.dashOffset;this.dashOffset=c;this.propertyChangeSupport.firePropertyChange("DASH_OFFSET",b,c)}};a.prototype.getDashOffset=function(){return this.dashOffset};a.prototype.setStartArrowStyle=function(c){if(c!==this.startArrowStyle){var b=this.startArrowStyle;this.startArrowStyle=c;this.propertyChangeSupport.firePropertyChange("START_ARROW_STYLE",b,c)}};a.prototype.getStartArrowStyle=function(){return this.startArrowStyle};a.prototype.setEndArrowStyle=function(b){if(b!==this.endArrowStyle){var c=this.endArrowStyle;this.endArrowStyle=b;this.propertyChangeSupport.firePropertyChange("END_ARROW_STYLE",c,b)}};a.prototype.getEndArrowStyle=function(){return this.endArrowStyle};a.prototype.isArrowsStyleEditable=function(){return this.arrowsStyleEditable};a.prototype.setColor=function(b){if(b!==this.color){var c=this.color;this.color=b;this.propertyChangeSupport.firePropertyChange("COLOR",c,b)}};a.prototype.getColor=function(){return this.color};a.prototype.setElevation=function(c){if(c!==this.elevation){var b=this.elevation;this.elevation=c;this.propertyChangeSupport.firePropertyChange("ELEVATION",b,c)}this.elevationEnabled=c!=null};a.prototype.getElevation=function(){return this.elevation};a.prototype.isElevationEnabled=function(){return this.elevationEnabled};a.prototype.modifyPolylines=function(){var b=this.home.getSelectedItems();var o=Home.getPolylinesSubList(b);if(!(o.length==0)){var n=this.getThickness();var q=this.getCapStyle();var k=this.getJoinStyle();var r=this.getDashStyle();var c=this.getDashPattern();var h=this.getDashOffset();var l=this.getStartArrowStyle();var d=this.getEndArrowStyle();var g=this.getColor();var p=this.getElevation();var m=this.isElevationEnabled();var f=(function(u){var t=[];while(u-->0){t.push(null)}return t})(o.length);for(var j=0;j<f.length;j++){f[j]=new a.ModifiedPolyline(o[j])}a.doModifyPolylines(f,n,q,k,r,c,h,l,d,g,p,m);if(this.undoSupport!=null){var e=new a.PolylinesModificationUndoableEdit(this.home,this.preferences,b.slice(0),f,n,q,k,r,c,h,l,d,g,p,m);this.undoSupport.postEdit(e)}}};a.doModifyPolylines=function(f,n,p,g,q,b,e,h,c,d,o,j){for(var k=0;k<f.length;k++){var m=f[k];var l=m.getPolyline();if(n!=null){l.setThickness(n)}if(p!=null){l.setCapStyle(p)}if(g!=null){l.setJoinStyle(g)}if(q!=null){l.setDashStyle(q)}if(q===Polyline.DashStyle.CUSTOMIZED&&b!=null){l.setDashPattern(b)}if(e!=null){l.setDashOffset(l.getDashStyle()!==Polyline.DashStyle.SOLID?e:0)}if(h!=null){l.setStartArrowStyle(h)}if(c!=null){l.setEndArrowStyle(c)}if(d!=null){l.setColor(d)}if(j!=null){if(false===j){l.setVisibleIn3D(false)}else{if(o!=null){l.setVisibleIn3D(true);l.setElevation(o)}}}}};a.undoModifyPolylines=function(d){for(var b=0;b<d.length;b++){var c=d[b];c.reset()}};return a}());PolylineController.__class="com.eteks.sweethome3d.viewcontroller.PolylineController";PolylineController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(b){var a=(function(e){__extends(d,e);function d(r,o,f,l,s,u,m,v,g,k,n,h,j,t,p){var q=e.call(this,o,b,"undoModifyPolylinesName")||this;if(q.home===undefined){q.home=null}if(q.oldSelection===undefined){q.oldSelection=null}if(q.modifiedPolylines===undefined){q.modifiedPolylines=null}if(q.thickness===undefined){q.thickness=null}if(q.capStyle===undefined){q.capStyle=null}if(q.joinStyle===undefined){q.joinStyle=null}if(q.dashStyle===undefined){q.dashStyle=null}if(q.dashPattern===undefined){q.dashPattern=null}if(q.dashOffset===undefined){q.dashOffset=null}if(q.startArrowStyle===undefined){q.startArrowStyle=null}if(q.endArrowStyle===undefined){q.endArrowStyle=null}if(q.color===undefined){q.color=null}if(q.elevation===undefined){q.elevation=null}if(q.elevationEnabled===undefined){q.elevationEnabled=null}q.home=r;q.oldSelection=f;q.modifiedPolylines=l;q.thickness=s;q.capStyle=u;q.joinStyle=m;q.dashStyle=v;q.dashPattern=g;q.dashOffset=k;q.startArrowStyle=n;q.endArrowStyle=h;q.color=j;q.elevation=t;q.elevationEnabled=p;return q}d.prototype.undo=function(){e.prototype.undo.call(this);b.undoModifyPolylines(this.modifiedPolylines);this.home.setSelectedItems(this.oldSelection.slice(0))};d.prototype.redo=function(){e.prototype.redo.call(this);b.doModifyPolylines(this.modifiedPolylines,this.thickness,this.capStyle,this.joinStyle,this.dashStyle,this.dashPattern,this.dashOffset,this.startArrowStyle,this.endArrowStyle,this.color,this.elevation,this.elevationEnabled);this.home.setSelectedItems(this.oldSelection.slice(0))};return d}(LocalizedUndoableEdit));b.PolylinesModificationUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.PolylineController.PolylinesModificationUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var c=(function(){function d(e){if(this.polyline===undefined){this.polyline=null}if(this.thickness===undefined){this.thickness=0}if(this.capStyle===undefined){this.capStyle=null}if(this.joinStyle===undefined){this.joinStyle=null}if(this.dashPattern===undefined){this.dashPattern=null}if(this.dashOffset===undefined){this.dashOffset=null}if(this.startArrowStyle===undefined){this.startArrowStyle=null}if(this.endArrowStyle===undefined){this.endArrowStyle=null}if(this.color===undefined){this.color=0}if(this.visibleIn3D===undefined){this.visibleIn3D=false}if(this.elevation===undefined){this.elevation=0}this.polyline=e;this.thickness=e.getThickness();this.capStyle=e.getCapStyle();this.joinStyle=e.getJoinStyle();this.dashPattern=e.getDashPattern();this.dashOffset=e.getDashOffset();this.startArrowStyle=e.getStartArrowStyle();this.endArrowStyle=e.getEndArrowStyle();this.color=e.getColor();this.visibleIn3D=e.isVisibleIn3D();this.elevation=e.getElevation()}d.prototype.getPolyline=function(){return this.polyline};d.prototype.reset=function(){this.polyline.setThickness(this.thickness);this.polyline.setCapStyle(this.capStyle);this.polyline.setJoinStyle(this.joinStyle);this.polyline.setDashPattern(this.dashPattern);this.polyline.setDashOffset(this.dashOffset);this.polyline.setStartArrowStyle(this.startArrowStyle);this.polyline.setEndArrowStyle(this.endArrowStyle);this.polyline.setColor(this.color);this.polyline.setVisibleIn3D(this.visibleIn3D);this.polyline.setElevation(this.elevation)};return d}());b.ModifiedPolyline=c;c.__class="com.eteks.sweethome3d.viewcontroller.PolylineController.ModifiedPolyline"})(PolylineController||(PolylineController={}));var HomeFurnitureController=(function(){function a(j,d,h,k,c){if(((j!=null&&j instanceof Home)||j===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||k===null)&&((c!=null&&c instanceof javax.swing.undo.UndoableEditSupport)||c===null)){var f=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureController===undefined){this.textureController=null}if(this.modelMaterialsController===undefined){this.modelMaterialsController=null}if(this.homeFurnitureView===undefined){this.homeFurnitureView=null}if(this.icon===undefined){this.icon=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.additionalProperties===undefined){this.additionalProperties=null}if(this.priceEditable===undefined){this.priceEditable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentageEditable===undefined){this.valueAddedTaxPercentageEditable=false}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.nameVisible===undefined){this.nameVisible=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.elevation===undefined){this.elevation=null}if(this.angleInDegrees===undefined){this.angleInDegrees=null}if(this.angle===undefined){this.angle=null}if(this.rollAndPitchEditable===undefined){this.rollAndPitchEditable=false}if(this.roll===undefined){this.roll=null}if(this.pitch===undefined){this.pitch=null}if(this.horizontalAxis===undefined){this.horizontalAxis=null}if(this.width===undefined){this.width=null}if(this.proportionalWidth===undefined){this.proportionalWidth=null}if(this.depth===undefined){this.depth=null}if(this.proportionalDepth===undefined){this.proportionalDepth=null}if(this.height===undefined){this.height=null}if(this.proportionalHeight===undefined){this.proportionalHeight=null}if(this.proportional===undefined){this.proportional=false}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.modelPresetTransformationsNames===undefined){this.modelPresetTransformationsNames=null}if(this.modelPresetTransformations===undefined){this.modelPresetTransformations=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=null}if(this.modelMirrored===undefined){this.modelMirrored=null}if(this.basePlanItem===undefined){this.basePlanItem=null}if(this.basePlanItemEnabled===undefined){this.basePlanItemEnabled=false}if(this.lightPowerEditable===undefined){this.lightPowerEditable=false}if(this.lightPower===undefined){this.lightPower=null}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.widthDepthDeformable===undefined){this.widthDepthDeformable=false}if(this.texturable===undefined){this.texturable=false}if(this.visibleEditable===undefined){this.visibleEditable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.wallThickness===undefined){this.wallThickness=0}if(this.wallDistance===undefined){this.wallDistance=0}if(this.wallWidth===undefined){this.wallWidth=0}if(this.wallLeft===undefined){this.wallLeft=0}if(this.wallHeight===undefined){this.wallHeight=0}if(this.wallTop===undefined){this.wallTop=0}if(this.sashes===undefined){this.sashes=null}this.home=j;this.preferences=d;this.viewFactory=h;this.contentManager=k;this.undoSupport=c;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{if(((j!=null&&j instanceof Home)||j===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((k!=null&&k instanceof javax.swing.undo.UndoableEditSupport)||k===null)&&c===undefined){var f=arguments;var b=f[3];var e=arguments;var g=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureController===undefined){this.textureController=null}if(this.modelMaterialsController===undefined){this.modelMaterialsController=null}if(this.homeFurnitureView===undefined){this.homeFurnitureView=null}if(this.icon===undefined){this.icon=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.additionalProperties===undefined){this.additionalProperties=null}if(this.priceEditable===undefined){this.priceEditable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentageEditable===undefined){this.valueAddedTaxPercentageEditable=false}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.nameVisible===undefined){this.nameVisible=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.elevation===undefined){this.elevation=null}if(this.angleInDegrees===undefined){this.angleInDegrees=null}if(this.angle===undefined){this.angle=null}if(this.rollAndPitchEditable===undefined){this.rollAndPitchEditable=false}if(this.roll===undefined){this.roll=null}if(this.pitch===undefined){this.pitch=null}if(this.horizontalAxis===undefined){this.horizontalAxis=null}if(this.width===undefined){this.width=null}if(this.proportionalWidth===undefined){this.proportionalWidth=null}if(this.depth===undefined){this.depth=null}if(this.proportionalDepth===undefined){this.proportionalDepth=null}if(this.height===undefined){this.height=null}if(this.proportionalHeight===undefined){this.proportionalHeight=null}if(this.proportional===undefined){this.proportional=false}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.modelPresetTransformationsNames===undefined){this.modelPresetTransformationsNames=null}if(this.modelPresetTransformations===undefined){this.modelPresetTransformations=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=null}if(this.modelMirrored===undefined){this.modelMirrored=null}if(this.basePlanItem===undefined){this.basePlanItem=null}if(this.basePlanItemEnabled===undefined){this.basePlanItemEnabled=false}if(this.lightPowerEditable===undefined){this.lightPowerEditable=false}if(this.lightPower===undefined){this.lightPower=null}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.widthDepthDeformable===undefined){this.widthDepthDeformable=false}if(this.texturable===undefined){this.texturable=false}if(this.visibleEditable===undefined){this.visibleEditable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.wallThickness===undefined){this.wallThickness=0}if(this.wallDistance===undefined){this.wallDistance=0}if(this.wallWidth===undefined){this.wallWidth=0}if(this.wallLeft===undefined){this.wallLeft=0}if(this.wallHeight===undefined){this.wallHeight=0}if(this.wallTop===undefined){this.wallTop=0}if(this.sashes===undefined){this.sashes=null}this.home=j;this.preferences=d;this.viewFactory=h;this.contentManager=g;this.undoSupport=b;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties();if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.textureController===undefined){this.textureController=null}if(this.modelMaterialsController===undefined){this.modelMaterialsController=null}if(this.homeFurnitureView===undefined){this.homeFurnitureView=null}if(this.icon===undefined){this.icon=null}if(this.name===undefined){this.name=null}if(this.description===undefined){this.description=null}if(this.additionalProperties===undefined){this.additionalProperties=null}if(this.priceEditable===undefined){this.priceEditable=false}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentageEditable===undefined){this.valueAddedTaxPercentageEditable=false}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.nameVisible===undefined){this.nameVisible=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.elevation===undefined){this.elevation=null}if(this.angleInDegrees===undefined){this.angleInDegrees=null}if(this.angle===undefined){this.angle=null}if(this.rollAndPitchEditable===undefined){this.rollAndPitchEditable=false}if(this.roll===undefined){this.roll=null}if(this.pitch===undefined){this.pitch=null}if(this.horizontalAxis===undefined){this.horizontalAxis=null}if(this.width===undefined){this.width=null}if(this.proportionalWidth===undefined){this.proportionalWidth=null}if(this.depth===undefined){this.depth=null}if(this.proportionalDepth===undefined){this.proportionalDepth=null}if(this.height===undefined){this.height=null}if(this.proportionalHeight===undefined){this.proportionalHeight=null}if(this.proportional===undefined){this.proportional=false}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.modelPresetTransformationsNames===undefined){this.modelPresetTransformationsNames=null}if(this.modelPresetTransformations===undefined){this.modelPresetTransformations=null}if(this.color===undefined){this.color=null}if(this.paint===undefined){this.paint=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=null}if(this.modelMirrored===undefined){this.modelMirrored=null}if(this.basePlanItem===undefined){this.basePlanItem=null}if(this.basePlanItemEnabled===undefined){this.basePlanItemEnabled=false}if(this.lightPowerEditable===undefined){this.lightPowerEditable=false}if(this.lightPower===undefined){this.lightPower=null}if(this.resizable===undefined){this.resizable=false}if(this.deformable===undefined){this.deformable=false}if(this.widthDepthDeformable===undefined){this.widthDepthDeformable=false}if(this.texturable===undefined){this.texturable=false}if(this.visibleEditable===undefined){this.visibleEditable=false}if(this.doorOrWindow===undefined){this.doorOrWindow=false}if(this.wallThickness===undefined){this.wallThickness=0}if(this.wallDistance===undefined){this.wallDistance=0}if(this.wallWidth===undefined){this.wallWidth=0}if(this.wallLeft===undefined){this.wallLeft=0}if(this.wallHeight===undefined){this.wallHeight=0}if(this.wallTop===undefined){this.wallTop=0}if(this.sashes===undefined){this.sashes=null}}else{throw new Error("invalid overload")}}}a.prototype.getTextureController=function(){if(this.textureController==null){this.textureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"textureTitle"),this.preferences,this.viewFactory,this.contentManager);this.textureController.addPropertyChangeListener("TEXTURE",new a.HomeFurnitureController$0(this))}return this.textureController};a.prototype.getModelMaterialsController=function(){if(this.modelMaterialsController==null){this.modelMaterialsController=new ModelMaterialsController(this.preferences.getLocalizedString(a,"modelMaterialsTitle"),this.preferences,this.viewFactory,this.contentManager);this.modelMaterialsController.addPropertyChangeListener("MATERIALS",new a.HomeFurnitureController$1(this));var b=new a.HomeFurnitureController$2(this);this.addPropertyChangeListener("WIDTH",b);this.addPropertyChangeListener("DEPTH",b);this.addPropertyChangeListener("HEIGHT",b);this.addPropertyChangeListener("MODEL_TRANSFORMATIONS",new a.HomeFurnitureController$3(this))}return this.modelMaterialsController};a.prototype.getView=function(){if(this.homeFurnitureView==null){this.homeFurnitureView=this.viewFactory.createHomeFurnitureView(this.preferences,this)}return this.homeFurnitureView};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var D=Home.getFurnitureSubList(this.home.getSelectedItems());var C=this.getTextureController();var P=this.getModelMaterialsController();if((D.length==0)){this.setIcon(null);this.setName(null);this.setNameVisible(null);this.setDescription(null);this.setAdditionalProperties(null);this.setPrice(null,false);this.priceEditable=false;this.setValueAddedTaxPercentage(null);this.valueAddedTaxPercentageEditable=false;this.setX(null);this.setY(null);this.setElevation(null);this.basePlanItemEnabled=false;this.setAngleInDegrees(null);this.setRoll(null);this.setPitch(null);this.setHorizontalAxis(null);this.rollAndPitchEditable=false;this.setWidth$java_lang_Float$boolean$boolean$boolean(null,true,false,false);this.setDepth$java_lang_Float$boolean$boolean$boolean(null,true,false,false);this.setHeight$java_lang_Float$boolean$boolean(null,true,false);this.setColor(null);if(C!=null){C.setTexture(null)}if(P!=null){P.setMaterials(null);P.setModel(null);P.setModelCreator(null)}this.setPaint(null);this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(null);this.modelPresetTransformationsNames=[];this.modelPresetTransformations=[];this.doorOrWindow=false;this.wallThickness=1;this.wallDistance=0;this.wallWidth=1;this.wallLeft=0;this.wallHeight=1;this.wallTop=0;this.sashes=[];this.setShininess(null);this.visibleEditable=false;this.setVisible(null);this.setModelMirrored(null);this.lightPowerEditable=false;this.setLightPower(null);this.setResizable(true);this.setDeformable(true);this.setTexturable(true);this.setProportional(false)}else{var m=D[0];var A=m.getIcon();if(A!=null){for(var ai=1;ai<D.length;ai++){if(!(function(x,j){if(x&&x.equals){return x.equals(j)}else{return x===j}})(A,D[ai].getIcon())){A=null;break}}}this.setIcon(A);var W=m.getName();if(W!=null){for(var ai=1;ai<D.length;ai++){if(!(W===D[ai].getName())){W=null;break}}}this.setName(W);var ak=m.isNameVisible();for(var ai=1;ai<D.length;ai++){if(ak!==D[ai].isNameVisible()){ak=null;break}}this.setNameVisible(ak);var E=m.getDescription();if(E!=null){for(var ai=1;ai<D.length;ai++){if(!(E===D[ai].getDescription())){E=null;break}}}this.setDescription(E);if(D.length===1){var c=({});var n=this.home.getFurnitureAdditionalProperties();for(var U=0;U<n.length;U++){var ae=n[U];var am=ae.getName();if(ae.isModifiable()){(function(j,y,x){if(j.entries==null){j.entries=[]}for(var ao=0;ao<j.entries.length;ao++){if(j.entries[ao].key==null&&y==null||j.entries[ao].key.equals!=null&&j.entries[ao].key.equals(y)||j.entries[ao].key===y){j.entries[ao].value=x;return}}j.entries.push({key:y,value:x,getKey:function(){return this.key},getValue:function(){return this.value}})})(c,ae,m.isContentProperty(am)?m.getContentProperty(am):m.getProperty(am))}}this.setAdditionalProperties((function(j){if(j.entries==null){j.entries=[]}return j.entries.length})(c)>0?c:null)}else{this.setAdditionalProperties(null)}var V=this.preferences.getCurrency()!=null;if(V){for(var ai=0;ai<D.length;ai++){if(D[ai]!=null&&D[ai] instanceof HomeFurnitureGroup){V=false;break}}}this.priceEditable=V;if(V){var S=m.getPrice();if(S!=null){for(var ai=1;ai<D.length;ai++){if(!((D[ai].getPrice())!=null?S.eq(D[ai].getPrice()):(S===(D[ai].getPrice())))){S=null;break}}}this.setPrice(S,false);this.valueAddedTaxPercentageEditable=this.preferences.isValueAddedTaxEnabled();var l=m.getValueAddedTaxPercentage();if(l!=null){for(var ai=1;ai<D.length;ai++){if(!((D[ai].getValueAddedTaxPercentage())!=null?l.eq(D[ai].getValueAddedTaxPercentage()):(l===(D[ai].getValueAddedTaxPercentage())))){l=null;break}}}this.setValueAddedTaxPercentage(l)}else{this.setPrice(null,false);this.setValueAddedTaxPercentage(null);this.valueAddedTaxPercentageEditable=false}var aa=m.getX();for(var ai=1;ai<D.length;ai++){if(aa!==D[ai].getX()){aa=null;break}}this.setX(aa);var Z=m.getY();for(var ai=1;ai<D.length;ai++){if(Z!==D[ai].getY()){Z=null;break}}this.setY(Z);var t=m.getElevation();for(var ai=1;ai<D.length;ai++){if(t!==D[ai].getElevation()){t=null;break}}this.setElevation(t);var F=!m.isDoorOrWindow();for(var ai=1;!F&&ai<D.length;ai++){if(!D[ai].isDoorOrWindow()){F=true}}this.basePlanItemEnabled=F;var an=!m.isMovable();for(var ai=1;ai<D.length;ai++){if(an!==!D[ai].isMovable()){an=null;break}}this.setBasePlanItem(an);var H=m.getAngle();for(var ai=1;ai<D.length;ai++){if(H!==D[ai].getAngle()){H=null;break}}this.setAngle(H);var al=true;for(var ai=0;al&&ai<D.length;ai++){var J=D[ai];al=J.isHorizontallyRotatable()&&J.getStaircaseCutOutShape()==null}this.rollAndPitchEditable=al;if(this.rollAndPitchEditable){var Q=m.getRoll();for(var ai=1;ai<D.length;ai++){if(Q!==D[ai].getRoll()){Q=null;break}}this.setRoll(Q);var T=m.getPitch();for(var ai=1;ai<D.length;ai++){if(T!==D[ai].getPitch()){T=null;break}}this.setPitch(T);if(Q==null&&T==null||(Q!=null&&Q!==0&&T!=null&&T!==0)||(Q!=null&&Q===0&&T!=null&&T===0)){this.setHorizontalAxis(null)}else{if(Q==null&&T!=null&&T===0||Q!=null&&Q!==0){this.setHorizontalAxis(a.FurnitureHorizontalAxis.ROLL)}else{this.setHorizontalAxis(a.FurnitureHorizontalAxis.PITCH)}}}else{this.setRoll(null);this.setPitch(null);this.setHorizontalAxis(null)}var b=m.getWidth();for(var ai=1;ai<D.length;ai++){if(b!==D[ai].getWidth()){b=null;break}}this.setWidth$java_lang_Float$boolean$boolean$boolean(b,true,false,false);var u=m.getDepth();for(var ai=1;ai<D.length;ai++){if(u!==D[ai].getDepth()){u=null;break}}this.setDepth$java_lang_Float$boolean$boolean$boolean(u,true,false,false);var d=m.getHeight();for(var ai=1;ai<D.length;ai++){if(d!==D[ai].getHeight()){d=null;break}}this.setHeight$java_lang_Float$boolean$boolean(d,true,false);var h=this.getFurnitureWithoutGroups(D);var g=h[0];var O=g.getColor();if(O!=null){for(var ai=1;ai<h.length;ai++){if(!(O===h[ai].getColor())){O=null;break}}}this.setColor(O);var I=g.getTexture();if(I!=null){for(var ai=1;ai<h.length;ai++){if(!I.equals(h[ai].getTexture())){I=null;break}}}if(C!=null){C.setTexture(I)}var ac=g.getModelMaterials();var e=g.getModel();var K=g.getCreator();if(e!=null){for(var ai=1;ai<h.length;ai++){var J=h[ai];if(!(function(x,j){if(x==null&&j==null){return true}if(x==null||j==null){return false}if(x.length!=j.length){return false}for(var y=0;y<x.length;y++){if(x[y]!=j[y]){return false}}return true})(ac,J.getModelMaterials())||e!==J.getModel()){ac=null;e=null;K=null;break}}}if(P!=null){P.setMaterials(ac);P.setModel(e);P.setModelCreator(K);P.setModelSize(g.getWidth(),g.getDepth(),g.getHeight());P.setModelRotation(g.getModelRotation());P.setModelTransformations(g.getModelTransformations());P.setModelFlags(g.getModelFlags())}var ah=true;for(var ai=0;ai<h.length;ai++){var J=h[ai];if(J.getColor()!=null||J.getTexture()!=null||J.getModelMaterials()!=null){ah=false;break}}if(O!=null){this.setPaint(a.FurniturePaint.COLORED)}else{if(I!=null){this.setPaint(a.FurniturePaint.TEXTURED)}else{if(ac!=null){this.setPaint(a.FurniturePaint.MODEL_MATERIALS)}else{if(ah){this.setPaint(a.FurniturePaint.DEFAULT)}else{this.setPaint(null)}}}}var z=m.getModelTransformations();if(D.length!==1||(m!=null&&m instanceof HomeFurnitureGroup)){z=null}else{if(z==null){z=[]}if(m!=null&&m instanceof HomeDoorOrWindow){var o=m;this.doorOrWindow=true;this.wallThickness=o.getWallThickness();this.wallDistance=o.getWallDistance();this.wallWidth=o.getWallWidth();this.wallLeft=o.getWallLeft();this.wallHeight=o.getWallHeight();this.wallTop=o.getWallTop();this.sashes=o.getSashes()}}this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(z);this.modelPresetTransformationsNames=([]);this.modelPresetTransformations=([]);if(D.length===1&&!(m!=null&&m instanceof HomeFurnitureGroup)&&m.getCatalogId()!=null){var q=this.preferences.getFurnitureCatalog().getPieceOfFurnitureWithId(m.getCatalogId());if(q!=null){var ai=1;for(var v=q.getProperty("modelPresetTransformationsName_"+ai);v!=null;v=q.getProperty("modelPresetTransformationsName_"+ ++ai)){var af=q.getProperty("modelPresetTransformations_"+ai);if(af!=null){var N=af.trim().split(/\s+/);if(N.length%13===0){var X=(function(x){var j=[];while(x-->0){j.push(null)}return j})((N.length/13|0));try{for(var ag=0;ag<N.length;ag+=12){var ab=N[ag++];var R=[[parseFloat(N[ag+0]),parseFloat(N[ag+1]),parseFloat(N[ag+2]),parseFloat(N[ag+3])],[parseFloat(N[ag+4]),parseFloat(N[ag+5]),parseFloat(N[ag+6]),parseFloat(N[ag+7])],[parseFloat(N[ag+8]),parseFloat(N[ag+9]),parseFloat(N[ag+10]),parseFloat(N[ag+11])]];X[(ag/13|0)]=new Transformation(ab,R)}(this.modelPresetTransformationsNames.push(v)>0);(this.modelPresetTransformations.push(X)>0)}catch(ad){console.info("Invalid value in preset transformations matrices for "+m.getCatalogId()+"\n"+ad)}}}}}}var B=g.getShininess();var s=B==null?a.FurnitureShininess.DEFAULT:(B===0?a.FurnitureShininess.MATT:a.FurnitureShininess.SHINY);for(var ai=1;ai<h.length;ai++){var J=h[ai];if(B!==J.getShininess()||(B!=null&&!(B===J.getShininess()))){s=null;break}}this.setShininess(s);var L=true;var G=this.home.getFurniture();for(var U=0;U<D.length;U++){var J=D[U];if(!(G.indexOf((J))>=0)){L=false;break}}this.visibleEditable=L;if(L){var M=m.isVisible();for(var ai=1;ai<D.length;ai++){if(M!==D[ai].isVisible()){M=null;break}}this.setVisible(M)}else{this.setVisible(null)}var p=m.isModelMirrored();for(var ai=1;ai<D.length;ai++){if(p!==D[ai].isModelMirrored()){p=null;break}}this.setModelMirrored(p);var aj=(m!=null&&m instanceof HomeLight);for(var ai=1;aj&&ai<D.length;ai++){aj=(D[ai]!=null&&D[ai] instanceof HomeLight)}this.lightPowerEditable=aj;if(aj){var f=m.getPower();for(var ai=1;ai<D.length;ai++){if(f!==D[ai].getPower()){f=null;break}}this.setLightPower(f)}else{this.setLightPower(null)}var Y=m.isResizable();for(var ai=1;ai<D.length;ai++){if(Y!==D[ai].isResizable()){Y=null;break}}this.setResizable(Y!=null&&Y);var w=true;for(var ai=0;w&&ai<D.length;ai++){var J=D[ai];if(J!=null&&J instanceof HomeFurnitureGroup){var n=J.getAllFurniture();for(var U=0;U<n.length;U++){var k=n[U];if(!k.isDeformable()||k.isHorizontallyRotated()||k.getModelTransformations()!=null){w=false;break}}}else{w=J.isDeformable()&&J.getModelTransformations()==null}}this.setDeformable(w);if(!this.isDeformable()){this.setProportional(true)}this.widthDepthDeformable=true;for(var ai=0;this.widthDepthDeformable&&ai<D.length;ai++){var J=D[ai];this.widthDepthDeformable=J.isWidthDepthDeformable()}var r=m.isTexturable();for(var ai=1;ai<D.length;ai++){if(r!==D[ai].isTexturable()){r=null;break}}this.setTexturable(r==null||r)}};a.prototype.getFurnitureWithoutGroups=function(e){var d=([]);for(var b=0;b<e.length;b++){var c=e[b];if(c!=null&&c instanceof HomeFurnitureGroup){(function(g,f){return g.push.apply(g,f)})(d,this.getFurnitureWithoutGroups(c.getFurniture()))}else{(d.push(c)>0)}}return d};a.prototype.isPropertyEditable=function(b){switch((b)){case"ADDITIONAL_PROPERTIES":return this.getAdditionalProperties()!=null;case"PRICE":return this.isPriceEditable();case"VALUE_ADDED_TAX_PERCENTAGE":return this.isValueAddedTaxPercentageEditable();case"ROLL":case"PITCH":return this.isRollAndPitchEditable();case"MODEL_TRANSFORMATIONS":return this.getModelTransformations()!=null;case"LIGHT_POWER":return this.isLightPowerEditable();case"VISIBLE":return this.visibleEditable;default:return true}};a.prototype.setIcon=function(b){if(b!==this.icon){var c=this.icon;this.icon=b;this.propertyChangeSupport.firePropertyChange("ICON",c,b)}};a.prototype.getIcon=function(){return this.icon};a.prototype.setName=function(b){if(b!==this.name){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b)}};a.prototype.getName=function(){return this.name};a.prototype.setNameVisible=function(b){if(b!==this.nameVisible){var c=this.nameVisible;this.nameVisible=b;this.propertyChangeSupport.firePropertyChange("NAME_VISIBLE",c,b)}};a.prototype.getNameVisible=function(){return this.nameVisible};a.prototype.setDescription=function(b){if(b!==this.description){var c=this.description;this.description=b;this.propertyChangeSupport.firePropertyChange("DESCRIPTION",c,b)}};a.prototype.getDescription=function(){return this.description};a.prototype.setAdditionalProperties=function(c){if(c!==this.additionalProperties&&(c==null||!(function(e,d){if(e&&e.equals){return e.equals(d)}else{return e===d}})(c,this.additionalProperties))){var b=this.additionalProperties;this.additionalProperties=c!=null?((function(e){var d={};d.entries=e.entries!=null?e.entries.slice():null;return d})(c)):null;this.propertyChangeSupport.firePropertyChange("ADDITIONAL_PROPERTIES",b,c)}};a.prototype.getAdditionalProperties=function(){return this.additionalProperties};a.prototype.setPrice=function(c,d){if(d===void 0){d=true}if(c!==this.price&&(c==null||!((this.price)!=null?c.eq(this.price):(c===(this.price))))){var b=this.price;this.price=c;this.propertyChangeSupport.firePropertyChange("PRICE",b,c);if(d){if(c!=null&&this.isValueAddedTaxPercentageEditable()&&this.getValueAddedTaxPercentage()==null&&Home.getFurnitureSubList(this.home.getSelectedItems()).length===1){this.setValueAddedTaxPercentage(this.preferences.getDefaultValueAddedTaxPercentage())}}}};a.prototype.getPrice=function(){return this.price};a.prototype.isPriceEditable=function(){return this.priceEditable};a.prototype.setValueAddedTaxPercentage=function(c){if(c!==this.valueAddedTaxPercentage&&(c==null||!((this.valueAddedTaxPercentage)!=null?c.eq(this.valueAddedTaxPercentage):(c===(this.valueAddedTaxPercentage))))){var b=this.valueAddedTaxPercentage;this.valueAddedTaxPercentage=c;this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_PERCENTAGE",b,c)}};a.prototype.getValueAddedTaxPercentage=function(){return this.valueAddedTaxPercentage};a.prototype.isValueAddedTaxPercentageEditable=function(){return this.valueAddedTaxPercentageEditable};a.prototype.setX=function(b){if(b!==this.x){var c=this.x;this.x=b;this.propertyChangeSupport.firePropertyChange("X",c,b)}};a.prototype.getX=function(){return this.x};a.prototype.setY=function(c){if(c!==this.y){var b=this.y;this.y=c;this.propertyChangeSupport.firePropertyChange("Y",b,c)}};a.prototype.getY=function(){return this.y};a.prototype.setElevation=function(c){if(c!==this.elevation){var b=this.elevation;this.elevation=c;this.propertyChangeSupport.firePropertyChange("ELEVATION",b,c)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.setAngleInDegrees=function(c,b){if(b===void 0){b=true}if(c!==this.angleInDegrees){var d=this.angleInDegrees;this.angleInDegrees=c;this.propertyChangeSupport.firePropertyChange("ANGLE_IN_DEGREES",d,c);if(b){if(this.angleInDegrees==null){this.setAngle(null,false)}else{this.setAngle(new Number((function(e){return e*Math.PI/180})(this.angleInDegrees)).valueOf(),false)}}}};a.prototype.getAngleInDegrees=function(){return this.angleInDegrees};a.prototype.setAngle=function(d,b){if(b===void 0){b=true}if(d!==this.angle){var c=this.angle;this.angle=d;this.propertyChangeSupport.firePropertyChange("ANGLE",c,d);if(b){if(d==null){this.setAngleInDegrees(null,false)}else{this.setAngleInDegrees(((Math.round((function(e){return e*180/Math.PI})(d))+360)|0)%360,false)}}}};a.prototype.getAngle=function(){return this.angle};a.prototype.isRollAndPitchEditable=function(){return this.rollAndPitchEditable};a.prototype.setRoll=function(b){if(b!==this.roll){var c=this.roll;this.roll=b;this.propertyChangeSupport.firePropertyChange("ROLL",c,b)}};a.prototype.getRoll=function(){return this.roll};a.prototype.setPitch=function(c){if(c!==this.pitch){var b=this.pitch;this.pitch=c;this.propertyChangeSupport.firePropertyChange("PITCH",b,c)}};a.prototype.getPitch=function(){return this.pitch};a.prototype.setHorizontalAxis=function(b){if(b!==this.horizontalAxis){var c=this.horizontalAxis;this.horizontalAxis=b;this.propertyChangeSupport.firePropertyChange("HORIZONTAL_AXIS",c,b)}};a.prototype.getHorizontalAxis=function(){return this.horizontalAxis};a.prototype.isBasePlanItemEnabled=function(){return this.basePlanItemEnabled};a.prototype.isBasePlanItemEditable=function(){return this.basePlanItemEnabled};a.prototype.setBasePlanItem=function(b){if(b!==this.basePlanItem){var c=this.basePlanItem;this.basePlanItem=b;this.propertyChangeSupport.firePropertyChange("BASE_PLAN_ITEM",c,b)}};a.prototype.getBasePlanItem=function(){return this.basePlanItem};a.prototype.setWidth$java_lang_Float=function(b){this.setWidth$java_lang_Float$boolean$boolean$boolean(b,false,this.isProportional()||!this.widthDepthDeformable,this.isProportional())};a.prototype.setWidth$java_lang_Float$boolean$boolean$boolean=function(f,h,c,g){var d=f!=null?Math.max(f,0.001):null;if(d===f||d!=null&&(d===f)||!h){this.proportionalWidth=f}if(d==null&&this.width!=null||d!=null&&!(d===this.width)){var b=this.width;this.width=d;this.propertyChangeSupport.firePropertyChange("WIDTH",b,d);if(b!=null&&d!=null){var e=d/b;if(c&&this.proportionalDepth!=null){this.setDepth$java_lang_Float$boolean$boolean$boolean(this.proportionalDepth*e,true,false,false)}if(g&&this.proportionalHeight!=null){this.setHeight$java_lang_Float$boolean$boolean(this.proportionalHeight*e,true,false)}}else{if(c){this.setDepth$java_lang_Float$boolean$boolean$boolean(null,false,false,false)}if(g){this.setHeight$java_lang_Float$boolean$boolean(null,false,false)}}}};a.prototype.setWidth=function(c,e,b,d){if(((typeof c==="number")||c===null)&&((typeof e==="boolean")||e===null)&&((typeof b==="boolean")||b===null)&&((typeof d==="boolean")||d===null)){return this.setWidth$java_lang_Float$boolean$boolean$boolean(c,e,b,d)}else{if(((typeof c==="number")||c===null)&&e===undefined&&b===undefined&&d===undefined){return this.setWidth$java_lang_Float(c)}else{throw new Error("invalid overload")}}};a.prototype.getWidth=function(){return this.width};a.prototype.setDepth$java_lang_Float=function(b){this.setDepth$java_lang_Float$boolean$boolean$boolean(b,false,this.isProportional()||!this.widthDepthDeformable,this.isProportional())};a.prototype.setDepth$java_lang_Float$boolean$boolean$boolean=function(f,e,h,g){var d=f!=null?Math.max(f,0.001):null;if(d===f||d!=null&&(d===f)||!e){this.proportionalDepth=f}if(d==null&&this.depth!=null||d!=null&&!(d===this.depth)){var c=this.depth;this.depth=d;this.propertyChangeSupport.firePropertyChange("DEPTH",c,d);if(c!=null&&d!=null){var b=d/c;if(h&&this.proportionalWidth!=null){this.setWidth$java_lang_Float$boolean$boolean$boolean(this.proportionalWidth*b,true,false,false)}if(g&&this.proportionalHeight!=null){this.setHeight$java_lang_Float$boolean$boolean(this.proportionalHeight*b,true,false)}}else{if(h){this.setWidth$java_lang_Float$boolean$boolean$boolean(null,false,false,false)}if(g){this.setHeight$java_lang_Float$boolean$boolean(null,false,false)}}}};a.prototype.setDepth=function(c,b,e,d){if(((typeof c==="number")||c===null)&&((typeof b==="boolean")||b===null)&&((typeof e==="boolean")||e===null)&&((typeof d==="boolean")||d===null)){return this.setDepth$java_lang_Float$boolean$boolean$boolean(c,b,e,d)}else{if(((typeof c==="number")||c===null)&&b===undefined&&e===undefined&&d===undefined){return this.setDepth$java_lang_Float(c)}else{throw new Error("invalid overload")}}};a.prototype.getDepth=function(){return this.depth};a.prototype.setHeight$java_lang_Float=function(b){this.setHeight$java_lang_Float$boolean$boolean(b,false,this.isProportional())};a.prototype.setHeight$java_lang_Float$boolean$boolean=function(b,c,e){var f=b!=null?Math.max(b,0.001):null;if(f===b||f!=null&&(f===b)||!c){this.proportionalHeight=b}if(f==null&&this.height!=null||f!=null&&!(f===this.height)){var g=this.height;this.height=f;this.propertyChangeSupport.firePropertyChange("HEIGHT",g,f);if(e){if(g!=null&&f!=null){var d=f/g;if(this.proportionalWidth!=null){this.setWidth$java_lang_Float$boolean$boolean$boolean(this.proportionalWidth*d,true,false,false)}if(this.proportionalDepth!=null){this.setDepth$java_lang_Float$boolean$boolean$boolean(this.proportionalDepth*d,true,false,false)}}else{this.setWidth$java_lang_Float$boolean$boolean$boolean(null,false,false,false);this.setDepth$java_lang_Float$boolean$boolean$boolean(null,false,false,false)}}}};a.prototype.setHeight=function(b,c,d){if(((typeof b==="number")||b===null)&&((typeof c==="boolean")||c===null)&&((typeof d==="boolean")||d===null)){return this.setHeight$java_lang_Float$boolean$boolean(b,c,d)}else{if(((typeof b==="number")||b===null)&&c===undefined&&d===undefined){return this.setHeight$java_lang_Float(b)}else{throw new Error("invalid overload")}}};a.prototype.getHeight=function(){return this.height};a.prototype.setProportional=function(b){if(b!==this.proportional){var c=this.proportional;this.proportional=b;this.propertyChangeSupport.firePropertyChange("PROPORTIONAL",c,b)}};a.prototype.isProportional=function(){return this.proportional};a.prototype.setColor=function(b){if(b!==this.color){var c=this.color;this.color=b;this.propertyChangeSupport.firePropertyChange("COLOR",c,b)}};a.prototype.getColor=function(){return this.color};a.prototype.setPaint=function(c){if(c!==this.paint){var b=this.paint;this.paint=c;this.propertyChangeSupport.firePropertyChange("PAINT",b,c)}};a.prototype.getPaint=function(){return this.paint};a.prototype.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A=function(c){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(c,this.modelTransformations)){var b=this.modelTransformations;this.modelTransformations=c;this.propertyChangeSupport.firePropertyChange("MODEL_TRANSFORMATIONS",b,c);this.setDeformable(c==null||c.length===0);this.setProportional(c!=null&&c.length>0)}};a.prototype.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A$float$float$float$float$float$float=function(d,o,n,u,s,L,q){if(this.doorOrWindow){var D=this.getX();var w=this.getY();var B=this.getElevation();var m=this.getWidth();var C=this.getDepth();var e=this.getHeight();var G=-this.getAngle();var f=(D*Math.cos(G)-w*Math.sin(G));var I=(o*Math.cos(G)-n*Math.sin(G));var c=this.wallLeft*m;var k=this.wallWidth*m;var v=f-m/2+c;var t=v-I+s/2;var A=(D*Math.sin(G)+w*Math.cos(G));var F=(o*Math.sin(G)+n*Math.cos(G));var K=this.wallDistance*C;var J=this.wallThickness*C;var r=A-C/2+K;var j=r-F+L/2;var g=this.wallTop*e;var H=this.wallHeight*e;var h=g+u+q-(B+e);var p=this.sashes;for(var E=0;E<p.length;E++){var z=p[E];var l=z.getXAxis()*m;l+=t-c;var b=z.getYAxis()*C;b+=j-K;p[E]=new Sash(l/s,b/L,z.getWidth()*m/s,z.getStartAngle(),z.getEndAngle())}this.wallThickness=J/L;this.wallDistance=j/L;this.wallWidth=k/s;this.wallLeft=t/s;this.wallHeight=H/q;this.wallTop=h/q;this.sashes=p}this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(d);this.setX(o);this.setY(n);this.setWidth$java_lang_Float$boolean$boolean$boolean(s,false,false,false);this.setDepth$java_lang_Float$boolean$boolean$boolean(L,false,false,false);this.setHeight$java_lang_Float$boolean$boolean(q,false,false)};a.prototype.setModelTransformations=function(d,c,h,f,e,g,b){if(((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(d[0]!=null&&d[0] instanceof Transformation)))||d===null)&&((typeof c==="number")||c===null)&&((typeof h==="number")||h===null)&&((typeof f==="number")||f===null)&&((typeof e==="number")||e===null)&&((typeof g==="number")||g===null)&&((typeof b==="number")||b===null)){return this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A$float$float$float$float$float$float(d,c,h,f,e,g,b)}else{if(((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(d[0]!=null&&d[0] instanceof Transformation)))||d===null)&&c===undefined&&h===undefined&&f===undefined&&e===undefined&&g===undefined&&b===undefined){return this.setModelTransformations$com_eteks_sweethome3d_model_Transformation_A(d)}else{throw new Error("invalid overload")}}};a.prototype.getModelTransformations=function(){return this.modelTransformations};a.prototype.getModelPresetTransformationsNames=function(){return this.modelPresetTransformationsNames.slice(0)};a.prototype.getModelPresetTransformations=function(b){return this.modelPresetTransformations[b]};a.prototype.setShininess=function(c){if(c!==this.shininess){var b=this.shininess;this.shininess=c;this.propertyChangeSupport.firePropertyChange("SHININESS",b,c)}};a.prototype.getShininess=function(){return this.shininess};a.prototype.setVisible=function(c){if(c!==this.visible){var b=this.visible;this.visible=c;this.propertyChangeSupport.firePropertyChange("VISIBLE",b,c)}};a.prototype.getVisible=function(){return this.visible};a.prototype.setModelMirrored=function(c){if(c!==this.modelMirrored){var b=this.modelMirrored;this.modelMirrored=c;this.propertyChangeSupport.firePropertyChange("MODEL_MIRRORED",b,c)}};a.prototype.getModelMirrored=function(){return this.modelMirrored};a.prototype.isLightPowerEditable=function(){return this.lightPowerEditable};a.prototype.getLightPower=function(){return this.lightPower};a.prototype.setLightPower=function(b){if(b!==this.lightPower){var c=this.lightPower;this.lightPower=b;this.propertyChangeSupport.firePropertyChange("LIGHT_POWER",c,b)}};a.prototype.setResizable=function(c){if(c!==this.resizable){var b=this.resizable;this.resizable=c;this.propertyChangeSupport.firePropertyChange("RESIZABLE",b,c)}};a.prototype.isResizable=function(){return this.resizable};a.prototype.setDeformable=function(b){if(b!==this.deformable){var c=this.deformable;this.deformable=b;this.propertyChangeSupport.firePropertyChange("DEFORMABLE",c,b)}};a.prototype.isDeformable=function(){return this.deformable};a.prototype.setTexturable=function(b){if(b!==this.texturable){var c=this.texturable;this.texturable=b;this.propertyChangeSupport.firePropertyChange("TEXTURABLE",c,b)}};a.prototype.isTexturable=function(){return this.texturable};a.prototype.modifyFurniture=function(){var w=this.home.getSelectedItems();var s=Home.getFurnitureSubList(w);if(!(s.length==0)){var B=this.getName();var T=this.getNameVisible();var t=this.getDescription();var G=this.getAdditionalProperties();var c=void 0;if(G==null){c=null}else{c=({});var j=(function(x){if(x.entries==null){x.entries=[]}return x.entries})(G);for(var K=0;K<j.length;K++){var H=j[K];(c[H.getKey().getName()]=H.getValue())}}var I=this.getPrice();var L=s.length===1&&I==null;var h=this.getValueAddedTaxPercentage();var o=s.length===1&&h==null;var Q=this.preferences.getCurrency();var O=this.getX();var M=this.getY();var m=this.getElevation();var u=this.getAngle();var F=this.getRoll();var J=this.getPitch();var r=this.getHorizontalAxis();var U=this.getBasePlanItem();var b=this.getWidth();var n=this.getDepth();var e=this.getHeight();var d=this.isProportional()&&(b==null||n==null||e==null);var S=this.getPaint();var D=S===a.FurniturePaint.COLORED?this.getColor():null;var q=this.getTextureController();var z=void 0;if(q!=null&&S===a.FurniturePaint.TEXTURED){z=q.getTexture()}else{z=null}var E=this.getModelMaterialsController();var P=void 0;if(E!=null&&S===a.FurniturePaint.MODEL_MATERIALS){P=E.getMaterials()}else{P=null}var p=this.getModelTransformations();var g=this.getShininess()===a.FurnitureShininess.DEFAULT;var l=this.getShininess()===a.FurnitureShininess.SHINY?new Number(0.5).valueOf():(this.getShininess()===a.FurnitureShininess.MATT?new Number(0).valueOf():null);var C=this.getVisible();var k=this.getModelMirrored();var f=this.getLightPower();var A=(function(y){var x=[];while(y-->0){x.push(null)}return x})(s.length);for(var R=0;R<A.length;R++){var v=s[R];if(v!=null&&v instanceof HomeLight){A[R]=new a.ModifiedLight(v)}else{if(v!=null&&v instanceof HomeDoorOrWindow){A[R]=new a.ModifiedDoorOrWindow(v)}else{if(v!=null&&v instanceof HomeFurnitureGroup){A[R]=new a.ModifiedFurnitureGroup(v)}else{A[R]=new a.ModifiedPieceOfFurniture(v)}}}}a.doModifyFurniture(A,B,T,t,c,I,L,h,o,Q,O,M,m,u,F,J,r,U,b,n,e,d,p,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,S,D,z,P,g,l,C,k,f);if(this.undoSupport!=null){var N=this.home.getSelectedItems();this.undoSupport.postEdit(new a.FurnitureModificationUndoableEdit(this.home,this.preferences,w.slice(0),N.slice(0),A,B,T,t,c,I,L,h,o,Q,O,M,m,u,F,J,r,U,b,n,e,d,p,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,S,D,z,P,g,l,C,k,f))}if(B!=null){this.preferences.addAutoCompletionString("HomePieceOfFurnitureName",B)}if(t!=null){this.preferences.addAutoCompletionString("HomePieceOfFurnitureDescription",t)}if(h!=null){this.preferences.setDefaultValueAddedTaxPercentage(h)}}};a.doModifyFurniture=function(D,u,Z,v,d,J,M,k,K,X,P,O,o,A,H,L,t,ab,b,p,f,e,r,aa,W,g,Q,s,c,U,Y,G,C,S,j,n,E,m,h){for(var I=0;I<D.length;I++){var z=D[I];var B=z.getPieceOfFurniture();if(u!=null){B.setName(u)}if(Z!=null){B.setNameVisible(Z)}if(d!=null){var l=(function(ac){var x=[];for(var y in ac){x.push({k:y,v:ac[y],getKey:function(){return this.k},getValue:function(){return this.v}})}return x})(d);for(var R=0;R<l.length;R++){var V=l[R];B.setProperty$java_lang_String$java_lang_Object(V.getKey(),V.getValue())}}if(v!=null){B.setDescription(v)}if(!(B!=null&&B instanceof HomeFurnitureGroup)){if(J!=null||M){if(J!==B.getPrice()&&(J==null||!((B.getPrice())!=null?J.eq(B.getPrice()):(J===(B.getPrice()))))){B.setCurrency(J!=null?X:null)}if(J!=null){try{J=J.round((["JPY","VND"].indexOf(X)>=0?0:2))}catch(T){}}B.setPrice(J)}if(k!=null||K){B.setValueAddedTaxPercentage(k)}}if(P!=null){B.setX(P)}if(O!=null){B.setY(O)}if(o!=null){B.setElevation(o)}if(A!=null){B.setAngle(A)}if(t!=null){switch((t)){case a.FurnitureHorizontalAxis.ROLL:if(H!=null){B.setRoll(H);B.setPitch(0)}break;case a.FurnitureHorizontalAxis.PITCH:if(L!=null){B.setPitch(L);B.setRoll(0)}break}}if(ab!=null&&!B.isDoorOrWindow()){B.setMovable(!ab)}if(B.isResizable()){var w=B.getWidth();var F=B.getDepth();var q=!e&&B.isDeformable();if(q){if(b!=null){B.setWidth(b)}else{if(p!=null&&!B.isWidthDepthDeformable()){B.setWidth(B.getWidth()*p/F)}}if(p!=null){B.setDepth(p)}else{if(b!=null&&!B.isWidthDepthDeformable()){B.setDepth(B.getDepth()*b/w)}}if(f!=null){B.setHeight(f)}}else{if(b!=null){B.scale(b/B.getWidth())}else{if(p!=null){B.scale(p/B.getDepth())}else{if(f!=null){B.scale(f/B.getHeight())}}}}if(m!=null){B.setModelMirrored(m)}if((B!=null&&B instanceof HomeDoorOrWindow)&&D.length===1&&!(JSON.stringify(B.getModelTransformations())===JSON.stringify(r!=null&&r.length>0?r:null))){var N=B;N.setWallThickness(aa);N.setWallDistance(W);N.setWallWidth(g);N.setWallLeft(Q);N.setWallHeight(s);N.setWallTop(c);N.setSashes(U)}}if(B.isTexturable()){if(Y!=null){switch((Y)){case a.FurniturePaint.DEFAULT:B.setColor(null);B.setTexture(null);B.setModelMaterials(null);break;case a.FurniturePaint.COLORED:B.setColor(G);B.setTexture(null);B.setModelMaterials(null);break;case a.FurniturePaint.TEXTURED:B.setColor(null);B.setTexture(C);B.setModelMaterials(null);break;case a.FurniturePaint.MODEL_MATERIALS:B.setColor(null);B.setTexture(null);B.setModelMaterials(S);break}}if(j){B.setShininess(null)}else{if(n!=null){B.setShininess(n)}}}if(r!=null){B.setModelTransformations(r.length>0?r:null)}if(E!=null){B.setVisible(E)}if(h!=null){B.setPower(h)}}};a.undoModifyFurniture=function(b){for(var d=0;d<b.length;d++){var c=b[d];c.reset()}};return a}());HomeFurnitureController.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController";HomeFurnitureController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(l){var j;(function(o){o[o.DEFAULT=0]="DEFAULT";o[o.COLORED=1]="COLORED";o[o.TEXTURED=2]="TEXTURED";o[o.MODEL_MATERIALS=3]="MODEL_MATERIALS"})(j=l.FurniturePaint||(l.FurniturePaint={}));var n;(function(o){o[o.DEFAULT=0]="DEFAULT";o[o.MATT=1]="MATT";o[o.SHINY=2]="SHINY"})(n=l.FurnitureShininess||(l.FurnitureShininess={}));var k;(function(o){o[o.ROLL=0]="ROLL";o[o.PITCH=1]="PITCH"})(k=l.FurnitureHorizontalAxis||(l.FurnitureHorizontalAxis={}));var g=(function(o){__extends(p,o);function p(G,T,P,aa,Q,K,aj,L,s,V,Y,B,W,ag,ab,Z,E,M,U,X,J,al,q,F,u,t,H,ak,af,v,ac,I,r,ae,ai,S,O,ad,z,D,R,C,w){var A=o.call(this,T,l,"undoModifyFurnitureName")||this;if(A.home===undefined){A.home=null}if(A.modifiedFurniture===undefined){A.modifiedFurniture=null}if(A.oldSelection===undefined){A.oldSelection=null}if(A.newSelection===undefined){A.newSelection=null}if(A.name===undefined){A.name=null}if(A.nameVisible===undefined){A.nameVisible=null}if(A.description===undefined){A.description=null}if(A.additionalProperties===undefined){A.additionalProperties=null}if(A.price===undefined){A.price=null}if(A.removePrice===undefined){A.removePrice=false}if(A.currency===undefined){A.currency=null}if(A.valueAddedTaxPercentage===undefined){A.valueAddedTaxPercentage=null}if(A.removeValueAddedTaxPercentage===undefined){A.removeValueAddedTaxPercentage=false}if(A.x===undefined){A.x=null}if(A.y===undefined){A.y=null}if(A.elevation===undefined){A.elevation=null}if(A.angle===undefined){A.angle=null}if(A.roll===undefined){A.roll=null}if(A.pitch===undefined){A.pitch=null}if(A.horizontalAxis===undefined){A.horizontalAxis=null}if(A.basePlanItem===undefined){A.basePlanItem=null}if(A.width===undefined){A.width=null}if(A.depth===undefined){A.depth=null}if(A.height===undefined){A.height=null}if(A.proportional===undefined){A.proportional=false}if(A.modelTransformations===undefined){A.modelTransformations=null}if(A.paint===undefined){A.paint=null}if(A.color===undefined){A.color=null}if(A.texture===undefined){A.texture=null}if(A.modelMaterials===undefined){A.modelMaterials=null}if(A.defaultShininess===undefined){A.defaultShininess=false}if(A.shininess===undefined){A.shininess=null}if(A.visible===undefined){A.visible=null}if(A.modelMirrored===undefined){A.modelMirrored=null}if(A.lightPower===undefined){A.lightPower=null}if(A.wallThickness===undefined){A.wallThickness=0}if(A.wallDistance===undefined){A.wallDistance=0}if(A.wallWidth===undefined){A.wallWidth=0}if(A.wallLeft===undefined){A.wallLeft=0}if(A.wallHeight===undefined){A.wallHeight=0}if(A.wallTop===undefined){A.wallTop=0}if(A.sashes===undefined){A.sashes=null}if(A.widthsInPlan===undefined){A.widthsInPlan=null}if(A.depthsInPlan===undefined){A.depthsInPlan=null}if(A.heightsInPlan===undefined){A.heightsInPlan=null}A.home=G;A.oldSelection=P;A.newSelection=aa;A.modifiedFurniture=Q;A.name=K;A.nameVisible=aj;A.description=L;A.additionalProperties=s;A.price=V;A.removePrice=Y;A.valueAddedTaxPercentage=B;A.removeValueAddedTaxPercentage=W;A.currency=ag;A.x=ab;A.y=Z;A.elevation=E;A.angle=M;A.roll=U;A.pitch=X;A.horizontalAxis=J;A.basePlanItem=al;A.width=q;A.depth=F;A.height=u;A.proportional=t;A.modelTransformations=H;A.wallThickness=ak;A.wallDistance=af;A.wallWidth=v;A.wallLeft=ac;A.wallHeight=I;A.wallTop=r;A.sashes=ae;A.paint=ai;A.color=S;A.texture=O;A.modelMaterials=ad;A.defaultShininess=z;A.shininess=D;A.visible=R;A.modelMirrored=C;A.lightPower=w;A.widthsInPlan=(function(y){var x=[];while(y-->0){x.push(0)}return x})(Q.length);A.depthsInPlan=(function(y){var x=[];while(y-->0){x.push(0)}return x})(Q.length);A.heightsInPlan=(function(y){var x=[];while(y-->0){x.push(0)}return x})(Q.length);for(var ah=0;ah<Q.length;ah++){var N=Q[ah].getPieceOfFurniture();A.widthsInPlan[ah]=N.getWidthInPlan();A.depthsInPlan[ah]=N.getDepthInPlan();A.heightsInPlan[ah]=N.getHeightInPlan()}return A}p.prototype.undo=function(){o.prototype.undo.call(this);l.undoModifyFurniture(this.modifiedFurniture);this.home.setSelectedItems(this.oldSelection.slice(0))};p.prototype.redo=function(){o.prototype.redo.call(this);l.doModifyFurniture(this.modifiedFurniture,this.name,this.nameVisible,this.description,this.additionalProperties,this.price,this.removePrice,this.valueAddedTaxPercentage,this.removeValueAddedTaxPercentage,this.currency,this.x,this.y,this.elevation,this.angle,this.roll,this.pitch,this.horizontalAxis,this.basePlanItem,this.width,this.depth,this.height,this.proportional,this.modelTransformations,this.wallThickness,this.wallDistance,this.wallWidth,this.wallLeft,this.wallHeight,this.wallTop,this.sashes,this.paint,this.color,this.texture,this.modelMaterials,this.defaultShininess,this.shininess,this.visible,this.modelMirrored,this.lightPower);for(var q=0;q<this.modifiedFurniture.length;q++){var r=this.modifiedFurniture[q].getPieceOfFurniture();r.setWidthInPlan(this.widthsInPlan[q]);r.setDepthInPlan(this.depthsInPlan[q]);r.setHeightInPlan(this.heightsInPlan[q])}this.home.setSelectedItems(this.newSelection.slice(0))};return p}(LocalizedUndoableEdit));l.FurnitureModificationUndoableEdit=g;g.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.FurnitureModificationUndoableEdit";g.__interfaces=["javax.swing.undo.UndoableEdit"];var f=(function(){function o(t){if(this.piece===undefined){this.piece=null}if(this.name===undefined){this.name=null}if(this.nameVisible===undefined){this.nameVisible=false}if(this.description===undefined){this.description=null}if(this.properties===undefined){this.properties=null}if(this.price===undefined){this.price=null}if(this.valueAddedTaxPercentage===undefined){this.valueAddedTaxPercentage=null}if(this.currency===undefined){this.currency=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.elevation===undefined){this.elevation=0}if(this.angle===undefined){this.angle=0}if(this.roll===undefined){this.roll=0}if(this.pitch===undefined){this.pitch=0}if(this.movable===undefined){this.movable=false}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.widthInPlan===undefined){this.widthInPlan=0}if(this.depthInPlan===undefined){this.depthInPlan=0}if(this.heightInPlan===undefined){this.heightInPlan=0}if(this.modelTransformations===undefined){this.modelTransformations=null}if(this.color===undefined){this.color=null}if(this.texture===undefined){this.texture=null}if(this.modelMaterials===undefined){this.modelMaterials=null}if(this.shininess===undefined){this.shininess=null}if(this.visible===undefined){this.visible=false}if(this.modelMirrored===undefined){this.modelMirrored=false}this.piece=t;this.name=t.getName();this.nameVisible=t.isNameVisible();this.description=t.getDescription();var q=t.getPropertyNames();if(q.length===0){this.properties={}}else{if(q.length===1){var s=(function(u){var v=0;return{next:function(){return v<u.length?u[v++]:null},hasNext:function(){return v<u.length}}})(q).next();this.properties=(function(u){var v={};v[u]=(t.isContentProperty(s)?t.getContentProperty(s):t.getProperty(s));return v})(s)}else{this.properties=({});for(var r=0;r<q.length;r++){var p=q[r];(this.properties[p]=t.isContentProperty(p)?t.getContentProperty(p):t.getProperty(p))}}}this.price=t.getPrice();this.valueAddedTaxPercentage=t.getValueAddedTaxPercentage();this.currency=t.getCurrency();this.x=t.getX();this.y=t.getY();this.elevation=t.getElevation();this.angle=t.getAngle();this.roll=t.getRoll();this.pitch=t.getPitch();this.movable=t.isMovable();this.width=t.getWidth();this.depth=t.getDepth();this.height=t.getHeight();this.widthInPlan=t.getWidthInPlan();this.depthInPlan=t.getDepthInPlan();this.heightInPlan=t.getHeightInPlan();this.modelTransformations=t.getModelTransformations();this.color=t.getColor();this.texture=t.getTexture();this.modelMaterials=t.getModelMaterials();this.shininess=t.getShininess();this.visible=t.isVisible();this.modelMirrored=t.isModelMirrored()}o.prototype.getPieceOfFurniture=function(){return this.piece};o.prototype.reset=function(){this.piece.setName(this.name);this.piece.setNameVisible(this.nameVisible);this.piece.setDescription(this.description);var q=this.piece.getPropertyNames();for(var r=0;r<q.length;r++){var p=q[r];this.piece.setProperty$java_lang_String$java_lang_Object(p,(function(u,v){return u[v]===undefined?null:u[v]})(this.properties,p))}var t=(function(w){var u=[];for(var v in w){u.push({k:v,v:w[v],getKey:function(){return this.k},getValue:function(){return this.v}})}return u})(this.properties);for(var r=0;r<t.length;r++){var s=t[r];if(!(q.indexOf((s.getKey()))>=0)){this.piece.setProperty$java_lang_String$java_lang_Object(s.getKey(),s.getValue())}}if(!(this.piece!=null&&this.piece instanceof HomeFurnitureGroup)){this.piece.setPrice(this.price);this.piece.setValueAddedTaxPercentage(this.valueAddedTaxPercentage);this.piece.setCurrency(this.currency)}this.piece.setX(this.x);this.piece.setY(this.y);this.piece.setElevation(this.elevation);this.piece.setAngle(this.angle);if(this.piece.isHorizontallyRotatable()){this.piece.setRoll(this.roll);this.piece.setPitch(this.pitch)}this.piece.setMovable(this.movable);if(this.piece.isResizable()){this.piece.setWidth(this.width);this.piece.setDepth(this.depth);this.piece.setHeight(this.height);this.piece.setModelMirrored(this.modelMirrored)}this.piece.setWidthInPlan(this.widthInPlan);this.piece.setDepthInPlan(this.depthInPlan);this.piece.setHeightInPlan(this.heightInPlan);this.piece.setModelTransformations(this.modelTransformations);if(this.piece.isTexturable()){this.piece.setColor(this.color);this.piece.setTexture(this.texture);this.piece.setModelMaterials(this.modelMaterials);this.piece.setShininess(this.shininess)}this.piece.setVisible(this.visible)};return o}());l.ModifiedPieceOfFurniture=f;f.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedPieceOfFurniture";var h=(function(p){__extends(o,p);function o(q){var r=p.call(this,q)||this;if(r.boundToWall===undefined){r.boundToWall=false}if(r.wallThickness===undefined){r.wallThickness=0}if(r.wallDistance===undefined){r.wallDistance=0}if(r.wallWidth===undefined){r.wallWidth=0}if(r.wallLeft===undefined){r.wallLeft=0}if(r.wallHeight===undefined){r.wallHeight=0}if(r.wallTop===undefined){r.wallTop=0}if(r.sashes===undefined){r.sashes=null}r.boundToWall=q.isBoundToWall();r.wallThickness=q.getWallThickness();r.wallDistance=q.getWallDistance();r.wallWidth=q.getWallWidth();r.wallLeft=q.getWallLeft();r.wallHeight=q.getWallHeight();r.wallTop=q.getWallTop();r.sashes=q.getSashes();return r}o.prototype.reset=function(){p.prototype.reset.call(this);var q=this.getPieceOfFurniture();q.setBoundToWall(this.boundToWall);q.setWallThickness(this.wallThickness);q.setWallDistance(this.wallDistance);q.setWallWidth(this.wallWidth);q.setWallLeft(this.wallLeft);q.setWallHeight(this.wallHeight);q.setWallTop(this.wallTop);q.setSashes(this.sashes)};return o}(l.ModifiedPieceOfFurniture));l.ModifiedDoorOrWindow=h;h.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedDoorOrWindow";var e=(function(p){__extends(o,p);function o(q){var r=p.call(this,q)||this;if(r.power===undefined){r.power=0}r.power=q.getPower();return r}o.prototype.reset=function(){p.prototype.reset.call(this);this.getPieceOfFurniture().setPower(this.power)};return o}(l.ModifiedPieceOfFurniture));l.ModifiedLight=e;e.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedLight";var m=(function(p){__extends(o,p);function o(s){var u=p.call(this,s)||this;if(u.groupFurnitureX===undefined){u.groupFurnitureX=null}if(u.groupFurnitureY===undefined){u.groupFurnitureY=null}if(u.groupFurnitureWidth===undefined){u.groupFurnitureWidth=null}if(u.groupFurnitureDepth===undefined){u.groupFurnitureDepth=null}if(u.groupFurnitureColor===undefined){u.groupFurnitureColor=null}if(u.groupFurnitureTexture===undefined){u.groupFurnitureTexture=null}if(u.groupFurnitureModelMaterials===undefined){u.groupFurnitureModelMaterials=null}if(u.groupFurnitureShininess===undefined){u.groupFurnitureShininess=null}var q=u.getGroupFurniture(s);u.groupFurnitureX=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureY=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureWidth=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureDepth=(function(w){var v=[];while(w-->0){v.push(0)}return v})(q.length);u.groupFurnitureColor=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);u.groupFurnitureTexture=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);u.groupFurnitureShininess=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);u.groupFurnitureModelMaterials=(function(w){var v=[];while(w-->0){v.push(null)}return v})(q.length);for(var r=0;r<q.length;r++){var t=q[r];u.groupFurnitureX[r]=t.getX();u.groupFurnitureY[r]=t.getY();u.groupFurnitureWidth[r]=t.getWidth();u.groupFurnitureDepth[r]=t.getDepth();u.groupFurnitureColor[r]=t.getColor();u.groupFurnitureTexture[r]=t.getTexture();u.groupFurnitureShininess[r]=t.getShininess();u.groupFurnitureModelMaterials[r]=t.getModelMaterials()}return u}o.prototype.reset=function(){p.prototype.reset.call(this);var s=this.getPieceOfFurniture();var q=this.getGroupFurniture(s);for(var r=0;r<q.length;r++){var t=q[r];if(s.isResizable()){t.setX(this.groupFurnitureX[r]);t.setY(this.groupFurnitureY[r]);t.setWidth(this.groupFurnitureWidth[r]);t.setDepth(this.groupFurnitureDepth[r])}if(s.isTexturable()&&!(t!=null&&t instanceof HomeFurnitureGroup)){t.setColor(this.groupFurnitureColor[r]);t.setTexture(this.groupFurnitureTexture[r]);t.setModelMaterials(this.groupFurnitureModelMaterials[r]);t.setShininess(this.groupFurnitureShininess[r])}}};o.prototype.getGroupFurniture=function(r){var t=([]);var u=r.getFurniture();for(var q=0;q<u.length;q++){var s=u[q];(t.push(s)>0);if(s!=null&&s instanceof HomeFurnitureGroup){(function(w,v){return w.push.apply(w,v)})(t,this.getGroupFurniture(s))}}return t};return o}(l.ModifiedPieceOfFurniture));l.ModifiedFurnitureGroup=m;m.__class="com.eteks.sweethome3d.viewcontroller.HomeFurnitureController.ModifiedFurnitureGroup";var d=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){this.__parent.setPaint(l.FurniturePaint.TEXTURED)};return o}());l.HomeFurnitureController$0=d;var c=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){this.__parent.setPaint(l.FurniturePaint.MODEL_MATERIALS)};return o}());l.HomeFurnitureController$1=c;var b=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){if(this.__parent.getWidth()!=null&&this.__parent.getDepth()!=null&&this.__parent.getHeight()!=null){this.__parent.modelMaterialsController.setModelSize(this.__parent.getWidth(),this.__parent.getDepth(),this.__parent.getHeight())}};return o}());l.HomeFurnitureController$2=b;var a=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){if(this.__parent.getModelTransformations()!=null){this.__parent.modelMaterialsController.setModelTransformations(this.__parent.getModelTransformations())}};return o}());l.HomeFurnitureController$3=a})(HomeFurnitureController||(HomeFurnitureController={}));var HomeController=(function(){function a(r,k,n,s,p){if(((r!=null&&r instanceof Home)||r===null)&&((k!=null&&k instanceof HomeApplication)||k===null)&&((n!=null&&n instanceof UserPreferences)||n===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||s===null)&&((p!=null&&(p.constructor!=null&&p.constructor.__interfaces!=null&&p.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||p===null)){var j=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=r;this.preferences=n;this.viewFactory=s;this.contentManager=p;this.application=k;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);this.notUndoableModifications=r.isModified();if(r.getName()!=null){var o=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(r.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(o);o.splice(0,0,r.getName());this.updateUserPreferencesRecentHomes(o)}}else{if(((r!=null&&r instanceof Home)||r===null)&&((k!=null&&k instanceof HomeApplication)||k===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||n===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||s===null)&&p===undefined){var j=arguments;var d=j[2];var m=j[3];var l=arguments;var h=l[1].getUserPreferences();if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=r;this.preferences=h;this.viewFactory=d;this.contentManager=m;this.application=k;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);this.notUndoableModifications=r.isModified();if(r.getName()!=null){var o=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(r.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(o);o.splice(0,0,r.getName());this.updateUserPreferencesRecentHomes(o)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{if(((r!=null&&r instanceof Home)||r===null)&&((k!=null&&k instanceof UserPreferences)||k===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||n===null)&&((s!=null&&(s.constructor!=null&&s.constructor.__interfaces!=null&&s.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||s===null)&&p===undefined){var j=arguments;var g=j[1];var u=j[2];var c=j[3];var y=arguments;var z=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=r;this.preferences=g;this.viewFactory=u;this.contentManager=c;this.application=z;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);this.notUndoableModifications=r.isModified();if(r.getName()!=null){var o=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(r.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(o);o.splice(0,0,r.getName());this.updateUserPreferencesRecentHomes(o)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{if(((r!=null&&r instanceof Home)||r===null)&&((k!=null&&k instanceof HomeApplication)||k===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||n===null)&&s===undefined&&p===undefined){var j=arguments;var t=j[2];var w=arguments;var f=w[1].getUserPreferences();var b=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=r;this.preferences=f;this.viewFactory=t;this.contentManager=b;this.application=k;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);this.notUndoableModifications=r.isModified();if(r.getName()!=null){var o=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(r.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(o);o.splice(0,0,r.getName());this.updateUserPreferencesRecentHomes(o)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{if(((r!=null&&r instanceof Home)||r===null)&&((k!=null&&k instanceof UserPreferences)||k===null)&&((n!=null&&(n.constructor!=null&&n.constructor.__interfaces!=null&&n.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||n===null)&&s===undefined&&p===undefined){var j=arguments;var e=j[1];var q=j[2];var v=arguments;var x=null;var A=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}this.home=r;this.preferences=e;this.viewFactory=q;this.contentManager=A;this.application=x;this.undoSupport=new a.HomeController$0(this);this.undoManager=new javax.swing.undo.UndoManager();this.undoSupport.addUndoableEditListener(this.undoManager);this.notUndoableModifications=r.isModified();if(r.getName()!=null){var o=(this.preferences.getRecentHomes().slice(0));(function(B){var C=B.indexOf(r.getName());if(C>=0){B.splice(C,1);return true}else{return false}})(o);o.splice(0,0,r.getName());this.updateUserPreferencesRecentHomes(o)}if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.application===undefined){this.application=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.undoManager===undefined){this.undoManager=null}if(this.homeView===undefined){this.homeView=null}if(this.childControllers===undefined){this.childControllers=null}if(this.furnitureCatalogController===undefined){this.furnitureCatalogController=null}if(this.furnitureController===undefined){this.furnitureController=null}if(this.planController===undefined){this.planController=null}if(this.homeController3D===undefined){this.homeController3D=null}if(this.saveUndoLevel===undefined){this.saveUndoLevel=0}if(this.notUndoableModifications===undefined){this.notUndoableModifications=false}if(this.focusedView===undefined){this.focusedView=null}}else{throw new Error("invalid overload")}}}}}}a.prototype.enableDefaultActions=function(c){var h=this.application!=null;c.setEnabled(HomeView.ActionType.NEW_HOME,h);c.setEnabled(HomeView.ActionType.NEW_HOME_FROM_EXAMPLE,h);c.setEnabled(HomeView.ActionType.OPEN,h);c.setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,h&&!(this.preferences.getRecentHomes().length==0));c.setEnabled(HomeView.ActionType.CLOSE,h);c.setEnabled(HomeView.ActionType.SAVE,h);c.setEnabled(HomeView.ActionType.SAVE_AS,h);c.setEnabled(HomeView.ActionType.SAVE_AND_COMPRESS,h);c.setEnabled(HomeView.ActionType.PAGE_SETUP,true);c.setEnabled(HomeView.ActionType.PRINT_PREVIEW,true);c.setEnabled(HomeView.ActionType.PRINT,true);c.setEnabled(HomeView.ActionType.PRINT_TO_PDF,true);c.setEnabled(HomeView.ActionType.PREFERENCES,true);c.setEnabled(HomeView.ActionType.EXIT,h);c.setEnabled(HomeView.ActionType.IMPORT_FURNITURE,true);c.setEnabled(HomeView.ActionType.IMPORT_FURNITURE_LIBRARY,true);c.setEnabled(HomeView.ActionType.IMPORT_TEXTURE,true);c.setEnabled(HomeView.ActionType.IMPORT_TEXTURES_LIBRARY,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CATALOG_ID,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_NAME,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCRIPTION,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CREATOR,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_LICENSE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_WIDTH,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_HEIGHT,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DEPTH,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_X,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_Y,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_ELEVATION,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_ANGLE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_LEVEL,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_MODEL_SIZE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_COLOR,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_TEXTURE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_MOVABILITY,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_TYPE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VISIBILITY,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,true);c.setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,this.home.getFurnitureSortedPropertyName()!=null);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CATALOG_ID,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_NAME,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DESCRIPTION,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CREATOR,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_LICENSE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_WIDTH,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DEPTH,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_HEIGHT,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_X,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_Y,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_ELEVATION,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_ANGLE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_LEVEL,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_MODEL_SIZE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_COLOR,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_TEXTURE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_MOVABLE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VISIBLE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,true);c.setEnabled(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,true);var g=this.home.getFurnitureAdditionalProperties();for(var d=0;d<g.length;d++){var f=g[d];c.setActionEnabled(HomeView.SORT_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX+f.getName(),true);c.setActionEnabled(HomeView.DISPLAY_HOME_FURNITURE_ADDITIONAL_PROPERTY_ACTION_PREFIX+f.getName(),true)}c.setEnabled(HomeView.ActionType.EXPORT_TO_CSV,true);c.setEnabled(HomeView.ActionType.SELECT,true);c.setEnabled(HomeView.ActionType.PAN,true);c.setEnabled(HomeView.ActionType.LOCK_BASE_PLAN,true);c.setEnabled(HomeView.ActionType.UNLOCK_BASE_PLAN,true);c.setEnabled(HomeView.ActionType.ENABLE_MAGNETISM,true);c.setEnabled(HomeView.ActionType.DISABLE_MAGNETISM,true);c.setEnabled(HomeView.ActionType.MODIFY_COMPASS,true);var e=this.home.getSelectedLevel();this.enableBackgroungImageActions(c,e!=null?e.getBackgroundImage():this.home.getBackgroundImage());this.enableLevelActions(c);c.setEnabled(HomeView.ActionType.ZOOM_IN,true);c.setEnabled(HomeView.ActionType.ZOOM_OUT,true);c.setEnabled(HomeView.ActionType.EXPORT_TO_SVG,true);c.setEnabled(HomeView.ActionType.VIEW_FROM_TOP,true);c.setEnabled(HomeView.ActionType.VIEW_FROM_OBSERVER,true);c.setEnabled(HomeView.ActionType.MODIFY_OBSERVER,this.home.getCamera()===this.home.getObserverCamera());c.setEnabled(HomeView.ActionType.STORE_POINT_OF_VIEW,true);var b=(this.home.getStoredCameras().length==0);c.setEnabled(HomeView.ActionType.DELETE_POINTS_OF_VIEW,!b);c.setEnabled(HomeView.ActionType.CREATE_PHOTOS_AT_POINTS_OF_VIEW,!b);c.setEnabled(HomeView.ActionType.DETACH_3D_VIEW,true);c.setEnabled(HomeView.ActionType.ATTACH_3D_VIEW,true);c.setEnabled(HomeView.ActionType.VIEW_FROM_OBSERVER,true);c.setEnabled(HomeView.ActionType.MODIFY_3D_ATTRIBUTES,true);c.setEnabled(HomeView.ActionType.CREATE_PHOTO,true);c.setEnabled(HomeView.ActionType.CREATE_VIDEO,true);c.setEnabled(HomeView.ActionType.EXPORT_TO_OBJ,true);c.setEnabled(HomeView.ActionType.HELP,true);c.setEnabled(HomeView.ActionType.ABOUT,true);this.enableCreationToolsActions(c);c.setTransferEnabled(true)};a.prototype.enableLevelActions=function(b){var f=this.getPlanController().isModificationState();b.setEnabled(HomeView.ActionType.ADD_LEVEL,!f);b.setEnabled(HomeView.ActionType.ADD_LEVEL_AT_SAME_ELEVATION,!f);var e=this.home.getLevels();var d=this.home.getSelectedLevel();var c=e.length>1&&d!=null;b.setEnabled(HomeView.ActionType.SELECT_ALL_AT_ALL_LEVELS,!f&&e.length>1);b.setEnabled(HomeView.ActionType.MAKE_LEVEL_VIEWABLE,!f&&c);b.setEnabled(HomeView.ActionType.MAKE_LEVEL_UNVIEWABLE,!f&&c);b.setEnabled(HomeView.ActionType.MAKE_LEVEL_ONLY_VIEWABLE_ONE,c);b.setEnabled(HomeView.ActionType.MAKE_ALL_LEVELS_VIEWABLE,e.length>1);b.setEnabled(HomeView.ActionType.MODIFY_LEVEL,c);b.setEnabled(HomeView.ActionType.DELETE_LEVEL,!f&&c);b.setEnabled(HomeView.ActionType.DISPLAY_ALL_LEVELS,e.length>1);b.setEnabled(HomeView.ActionType.DISPLAY_SELECTED_LEVEL,e.length>1)};a.prototype.enableCreationToolsActions=function(b){var d=this.home.getSelectedLevel();var c=d==null||d.isViewable();b.setEnabled(HomeView.ActionType.CREATE_WALLS,c);b.setEnabled(HomeView.ActionType.CREATE_ROOMS,c);b.setEnabled(HomeView.ActionType.CREATE_POLYLINES,c);b.setEnabled(HomeView.ActionType.CREATE_DIMENSION_LINES,c);b.setEnabled(HomeView.ActionType.CREATE_LABELS,c)};a.prototype.getView=function(){var b=this;if(this.homeView==null){this.homeView=this.viewFactory.createHomeView(this.home,this.preferences,this);this.enableDefaultActions(this.homeView);this.addListeners();if(this.home.getName()!=null&&this.home.getVersion()>Home.CURRENT_VERSION){this.homeView.invokeLater(function(){var c=b.preferences.getLocalizedString(a,"moreRecentVersionHome",b.home.getName());b.getView().showMessage(c)})}}return this.homeView};a.prototype.getContentManager=function(){return this.contentManager};a.prototype.getFurnitureCatalogController=function(){if(this.furnitureCatalogController==null){this.furnitureCatalogController=new FurnitureCatalogController(this.preferences.getFurnitureCatalog(),this.preferences,this.viewFactory,this.contentManager)}return this.furnitureCatalogController};a.prototype.getFurnitureController=function(){if(this.furnitureController==null){this.furnitureController=new FurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())}return this.furnitureController};a.prototype.getPlanController=function(){if(this.planController==null){this.planController=new PlanController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())}return this.planController};a.prototype.getHomeController3D=function(){if(this.homeController3D==null){this.homeController3D=new HomeController3D(this.home,this.getPlanController(),this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport())}return this.homeController3D};a.prototype.getUndoableEditSupport=function(){return this.undoSupport};a.prototype.addListeners=function(){this.preferences.getFurnitureCatalog().addFurnitureListener((function(b){if(b==null||typeof b=="function"){return b}return function(c){return(b.collectionChanged?b.collectionChanged:b).call(b,c)}})(new a.FurnitureCatalogChangeListener(this)));this.preferences.getTexturesCatalog().addTexturesListener((function(b){if(b==null||typeof b=="function"){return b}return function(c){return(b.collectionChanged?b.collectionChanged:b).call(b,c)}})(new a.TexturesCatalogChangeListener(this)));this.preferences.addPropertyChangeListener(new a.UserPreferencesPropertiesChangeListener(this));this.addCatalogSelectionListener();this.addHomeBackgroundImageListener();this.addNotUndoableModificationListeners();this.addHomeSelectionListener();this.addFurnitureSortListener();this.addUndoSupportListener();this.addHomeItemsListener();this.addLevelListeners();this.addStoredCamerasListener();this.addPlanControllerListeners();this.addLanguageListener()};a.prototype.addCatalogSelectionListener=function(){this.getFurnitureCatalogController().addSelectionListener(new a.HomeController$1(this))};a.prototype.addLanguageListener=function(){this.preferences.addPropertyChangeListener("LANGUAGE",new a.LanguageChangeListener(this))};a.prototype.addHomeSelectionListener=function(){if(this.home!=null){this.home.addSelectionListener(new a.HomeController$2(this))}};a.prototype.addFurnitureSortListener=function(){if(this.home!=null){this.home.addPropertyChangeListener("FURNITURE_SORTED_PROPERTY",new a.HomeController$3(this))}};a.prototype.addHomeBackgroundImageListener=function(){if(this.home!=null){this.home.addPropertyChangeListener("BACKGROUND_IMAGE",new a.HomeController$4(this))}};a.prototype.enableBackgroungImageActions=function(c,e){var d=this.home.getSelectedLevel();var b=e!=null&&(d==null||d.isViewable());this.getView().setEnabled(HomeView.ActionType.IMPORT_BACKGROUND_IMAGE,!b);this.getView().setEnabled(HomeView.ActionType.MODIFY_BACKGROUND_IMAGE,b);this.getView().setEnabled(HomeView.ActionType.HIDE_BACKGROUND_IMAGE,b&&e.isVisible());this.getView().setEnabled(HomeView.ActionType.SHOW_BACKGROUND_IMAGE,b&&!e.isVisible());this.getView().setEnabled(HomeView.ActionType.DELETE_BACKGROUND_IMAGE,b)};a.prototype.addNotUndoableModificationListeners=function(){if(this.home!=null){var b=new a.HomeController$5(this);this.home.addPropertyChangeListener("STORED_CAMERAS",b);this.home.getEnvironment().addPropertyChangeListener("OBSERVER_CAMERA_ELEVATION_ADJUSTED",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_WIDTH",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_ASPECT_RATIO",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_FRAME_RATE",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_QUALITY",b);this.home.getEnvironment().addPropertyChangeListener("VIDEO_CAMERA_PATH",b);this.home.getEnvironment().addPropertyChangeListener("CEILING_LIGHT_COLOR",b);this.home.getEnvironment().addPropertyChangeListener("PHOTO_QUALITY",b);this.home.getEnvironment().addPropertyChangeListener("PHOTO_ASPECT_RATIO",b);var d=new a.HomeController$6(this,b);this.home.getEnvironment().addPropertyChangeListener("PHOTO_WIDTH",d);this.home.getEnvironment().addPropertyChangeListener("PHOTO_HEIGHT",d);var c=new a.HomeController$7(this,b);this.home.getObserverCamera().addPropertyChangeListener(c);this.home.getTopCamera().addPropertyChangeListener(c)}};a.prototype.enableActionsBoundToSelection=function(){var k=this.getPlanController().isModificationState();var b=this.getFurnitureCatalogController().getSelectedFurniture();var E=!(b.length==0);var j=b.length===1&&b[0].isModifiable();var v=this.home.getSelectedItems();var B=false;var g=false;var q=false;var R=false;var p=false;var e=false;var x=false;var c=false;var w=v.length===1&&(v[0]!=null&&v[0] instanceof HomeFurnitureGroup);var F=false;var u=false;var A=false;var C=false;var N=false;var y=false;var K=false;var h=false;var L=false;var Q=false;var I=false;var J=false;var m=this.getFurnitureController();if(!k){for(var D=0;D<v.length;D++){var z=v[D];if(this.getPlanController().isItemDeletable(z)){B=true;break}}var n=Home.getFurnitureSubList(v);g=!(n.length==0);for(var D=0;D<n.length;D++){var t=n[D];if(m.isPieceOfFurnitureDeletable(t)){q=true;break}}for(var D=0;D<n.length;D++){var t=n[D];if(t!=null&&t instanceof HomeFurnitureGroup){F=true;break}}var M=0;for(var D=0;D<n.length;D++){var t=n[D];if(m.isPieceOfFurnitureMovable(t)){p=true;M++;if(M>=2){e=true}if(M>=3){c=true;break}}}if(e){x=true;var G=this.home.getFurniture();for(var D=0;D<n.length;D++){var t=n[D];if(!m.isPieceOfFurnitureMovable(t)||!(G.indexOf((t))>=0)){x=false;break}}}var o=Home.getWallsSubList(v);u=!(o.length==0);A=o.length===1;if(o.length>=2){var r=[null,null,null];for(var D=0;D<o.length;D++){var l=o[D];if((l.getArcExtent()==null||l.getArcExtent()===0)&&(l.getWallAtStart()==null||l.getWallAtEnd()==null)){for(var O=0;O<r.length;O++){if(r[O]==null){r[O]=l;break}}if(r[2]!=null){break}}}C=r[2]==null&&r[0]!=null&&(r[1]==null&&!(o.indexOf((r[0].getWallAtStart()))>=0)&&!(o.indexOf((r[0].getWallAtEnd()))>=0)||r[0].getWallAtEnd()!==r[1]&&r[0].getWallAtStart()!==r[1])}var H=Home.getRoomsSubList(v);N=!(H.length==0);y=v.length===1&&H.length===1;K=y&&H[0].getPointCount()>=4;L=!(Home.getDimensionLinesSubList(v).length==0);h=!(Home.getPolylinesSubList(v).length==0);Q=!(Home.getLabelsSubList(v).length==0);J=(v.indexOf((this.home.getCompass()))>=0);R=g||u||N||L||h||Q||J;I=g||N||L||Q}var d=this.getView();if(this.focusedView===this.getFurnitureCatalogController().getView()){d.setEnabled(HomeView.ActionType.COPY,!k&&E);d.setEnabled(HomeView.ActionType.CUT,false);d.setEnabled(HomeView.ActionType.DELETE,false);for(var D=0;D<b.length;D++){var t=b[D];if(t.isModifiable()){d.setEnabled(HomeView.ActionType.DELETE,true);break}}}else{if(this.focusedView===m.getView()){d.setEnabled(HomeView.ActionType.COPY,g);d.setEnabled(HomeView.ActionType.CUT,q);d.setEnabled(HomeView.ActionType.DELETE,q)}else{if(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled()){d.setEnabled(HomeView.ActionType.COPY,R);d.setEnabled(HomeView.ActionType.CUT,B);d.setEnabled(HomeView.ActionType.DELETE,B)}else{d.setEnabled(HomeView.ActionType.COPY,false);d.setEnabled(HomeView.ActionType.CUT,false);d.setEnabled(HomeView.ActionType.DELETE,false)}}}this.enablePasteToGroupAction();this.enablePasteStyleAction();var f=this.home.getSelectedLevel();var s=f==null||f.isViewable();d.setEnabled(HomeView.ActionType.ADD_HOME_FURNITURE,E&&s);d.setEnabled(HomeView.ActionType.ADD_FURNITURE_TO_GROUP,E&&s&&w);d.setEnabled(HomeView.ActionType.DELETE_HOME_FURNITURE,q);d.setEnabled(HomeView.ActionType.DELETE_SELECTION,(E&&this.focusedView===this.getFurnitureCatalogController().getView())||(B&&(this.focusedView===m.getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView())));d.setEnabled(HomeView.ActionType.MODIFY_FURNITURE,(j&&this.focusedView===this.getFurnitureCatalogController().getView())||(g&&(this.focusedView===m.getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView())));d.setEnabled(HomeView.ActionType.MODIFY_WALL,u);d.setEnabled(HomeView.ActionType.FLIP_HORIZONTALLY,R);d.setEnabled(HomeView.ActionType.FLIP_VERTICALLY,R);d.setEnabled(HomeView.ActionType.JOIN_WALLS,C);d.setEnabled(HomeView.ActionType.REVERSE_WALL_DIRECTION,u);d.setEnabled(HomeView.ActionType.SPLIT_WALL,A);d.setEnabled(HomeView.ActionType.MODIFY_ROOM,N);d.setEnabled(HomeView.ActionType.MODIFY_POLYLINE,h);d.setEnabled(HomeView.ActionType.MODIFY_DIMENSION_LINE,L);d.setEnabled(HomeView.ActionType.MODIFY_LABEL,Q);d.setEnabled(HomeView.ActionType.TOGGLE_BOLD_STYLE,I);d.setEnabled(HomeView.ActionType.TOGGLE_ITALIC_STYLE,I);d.setEnabled(HomeView.ActionType.INCREASE_TEXT_SIZE,I);d.setEnabled(HomeView.ActionType.DECREASE_TEXT_SIZE,I);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_TOP,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_BOTTOM,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_LEFT,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_RIGHT,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_FRONT_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_BACK_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_LEFT_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_ON_RIGHT_SIDE,e);d.setEnabled(HomeView.ActionType.ALIGN_FURNITURE_SIDE_BY_SIDE,e);d.setEnabled(HomeView.ActionType.DISTRIBUTE_FURNITURE_HORIZONTALLY,c);d.setEnabled(HomeView.ActionType.DISTRIBUTE_FURNITURE_VERTICALLY,c);d.setEnabled(HomeView.ActionType.RESET_FURNITURE_ELEVATION,p);d.setEnabled(HomeView.ActionType.GROUP_FURNITURE,x&&s);d.setEnabled(HomeView.ActionType.UNGROUP_FURNITURE,F);var P=this.getPlanController()!=null&&this.getPlanController().getMode()===PlanController.Mode.SELECTION_$LI$();d.setEnabled(HomeView.ActionType.ADD_ROOM_POINT,y&&P);d.setEnabled(HomeView.ActionType.DELETE_ROOM_POINT,K&&P);d.setEnabled(HomeView.ActionType.RECOMPUTE_ROOM_POINTS,K&&P)};a.prototype.enablePasteAction=function(){var b=this.getView();var c=false;if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled()){var d=this.home.getSelectedLevel();c=(d==null||d.isViewable())&&!this.getPlanController().isModificationState()&&!b.isClipboardEmpty()}b.setEnabled(HomeView.ActionType.PASTE,c);this.enablePasteToGroupAction();this.enablePasteStyleAction()};a.prototype.enablePasteToGroupAction=function(){var b=this.getView();var e=false;if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()){var g=this.home.getSelectedLevel();if((g==null||g.isViewable())&&!this.getPlanController().isModificationState()){var h=this.home.getSelectedItems();if(h.length===1&&(h[0]!=null&&h[0] instanceof HomeFurnitureGroup)){var c=b.getClipboardItems();if(c!=null){e=true;for(var d=0;d<c.length;d++){var f=c[d];if(!(f!=null&&f instanceof HomePieceOfFurniture)){e=false;break}}}}}}b.setEnabled(HomeView.ActionType.PASTE_TO_GROUP,e)};a.prototype.enablePasteStyleAction=function(){var b=this.getView();var f=false;if((this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled())&&!this.getPlanController().isModificationState()){var c=b.getClipboardItems();if(c!=null&&c.length===1){var g=c[0];var h=this.home.getSelectedItems();for(var d=0;d<h.length;d++){var e=h[d];if((e!=null&&e instanceof HomePieceOfFurniture)&&(g!=null&&g instanceof HomePieceOfFurniture)||(e!=null&&e instanceof Wall)&&(g!=null&&g instanceof Wall)||(e!=null&&e instanceof Room)&&(g!=null&&g instanceof Room)||(e!=null&&e instanceof Polyline)&&(g!=null&&g instanceof Polyline)||(e!=null&&e instanceof Label)&&(g!=null&&g instanceof Label)){f=true;break}}}}b.setEnabled(HomeView.ActionType.PASTE_STYLE,f)};a.prototype.enableSelectAllAction=function(){var b=this.getView();var d=this.getPlanController().isModificationState();if(this.focusedView===this.getFurnitureController().getView()){b.setEnabled(HomeView.ActionType.SELECT_ALL,!d&&this.home.getFurniture().length>0)}else{if(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()){var c=!this.home.isEmpty()||this.home.getCompass().isVisible();b.setEnabled(HomeView.ActionType.SELECT_ALL,!d&&c)}else{b.setEnabled(HomeView.ActionType.SELECT_ALL,false)}}};a.prototype.enableZoomActions=function(){var c=this.getPlanController();var d=c.getScale();var b=this.getView();b.setEnabled(HomeView.ActionType.ZOOM_IN,d<c.getMaximumScale());b.setEnabled(HomeView.ActionType.ZOOM_OUT,d>c.getMinimumScale())};a.prototype.addUndoSupportListener=function(){this.getUndoableEditSupport().addUndoableEditListener(new a.HomeController$8(this));this.home.addPropertyChangeListener("MODIFIED",new a.HomeController$9(this))};a.prototype.addHomeItemsListener=function(){var c=this;var b=function(d){if(d.getType()===CollectionEvent.Type.ADD||d.getType()===CollectionEvent.Type.DELETE){c.enableSelectAllAction()}};this.home.addFurnitureListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addWallsListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addRoomsListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addPolylinesListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addDimensionLinesListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.addLabelsListener(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(((function(d){if(d==null||typeof d=="function"){return d}return function(e){return(d.collectionChanged?d.collectionChanged:d).call(d,e)}})(b)))));this.home.getCompass().addPropertyChangeListener(new a.HomeController$10(this));this.home.addPropertyChangeListener("CAMERA",new a.HomeController$11(this))};a.prototype.addLevelListeners=function(){var g=this;var b=new a.HomeController$12(this);this.home.addPropertyChangeListener("SELECTED_LEVEL",b);var c=new a.HomeController$13(this);var f=this.home.getLevels();for(var d=0;d<f.length;d++){var e=f[d];e.addPropertyChangeListener(c)}this.home.addLevelsListener(function(h){switch((h.getType())){case CollectionEvent.Type.ADD:g.home.setSelectedLevel(h.getItem());h.getItem().addPropertyChangeListener(c);break;case CollectionEvent.Type.DELETE:b.propertyChange(null);h.getItem().removePropertyChangeListener(c);break}})};a.prototype.addStoredCamerasListener=function(){this.home.addPropertyChangeListener("STORED_CAMERAS",new a.HomeController$14(this))};a.prototype.addPlanControllerListeners=function(){this.getPlanController().addPropertyChangeListener("MODIFICATION_STATE",new a.HomeController$15(this));this.getPlanController().addPropertyChangeListener("MODE",new a.HomeController$16(this));this.getPlanController().addPropertyChangeListener("SCALE",new a.HomeController$17(this))};a.prototype.addHomeFurniture=function(){this.addFurniture(null)};a.prototype.addFurnitureToGroup=function(){this.addFurniture(this.home.getSelectedItems()[0])};a.prototype.addFurniture=function(f){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var c=this.getFurnitureCatalogController().getSelectedFurniture();if(!(c.length==0)){var b=([]);for(var d=0;d<c.length;d++){var e=c[d];(b.push(this.getFurnitureController().createHomePieceOfFurniture(e))>0)}if(f!=null){this.getFurnitureController().addFurnitureToGroup(b,f)}else{this.getFurnitureController().addFurniture$java_util_List(b)}this.adjustFurnitureSizeAndElevation(b,false)}};a.prototype.modifySelectedFurniture=function(){if(this.focusedView===this.getFurnitureCatalogController().getView()){this.getFurnitureCatalogController().modifySelectedFurniture()}else{if(this.focusedView===this.getFurnitureController().getView()||this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()){this.getFurnitureController().modifySelectedFurniture()}}};a.prototype.importLanguageLibrary$=function(){var b=this;this.getView().invokeLater(function(){var c=b.getView().showImportLanguageLibraryDialog();if(c!=null){b.importLanguageLibrary$java_lang_String(c)}})};a.prototype.importLanguageLibrary$java_lang_String=function(c){try{if(!this.preferences.languageLibraryExists(c)||this.getView().confirmReplaceLanguageLibrary(c)){this.preferences.addLanguageLibrary(c)}}catch(b){var d=this.preferences.getLocalizedString(a,"importLanguageLibraryError",c);this.getView().showError(d)}};a.prototype.importLanguageLibrary=function(b){if(((typeof b==="string")||b===null)){return this.importLanguageLibrary$java_lang_String(b)}else{if(b===undefined){return this.importLanguageLibrary$()}else{throw new Error("invalid overload")}}};a.prototype.importFurniture=function(){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());if(this.focusedView===this.getFurnitureCatalogController().getView()){this.getFurnitureCatalogController().importFurniture$()}else{this.getFurnitureController().importFurniture$()}};a.prototype.importFurnitureLibrary$=function(){var b=this;this.getView().invokeLater(function(){var c=b.getView().showImportFurnitureLibraryDialog();if(c!=null){b.importFurnitureLibrary$java_lang_String(c)}})};a.prototype.importFurnitureLibrary$java_lang_String=function(c){try{if(!this.preferences.furnitureLibraryExists(c)||this.getView().confirmReplaceFurnitureLibrary(c)){this.preferences.addFurnitureLibrary(c);this.getView().showMessage(this.preferences.getLocalizedString(a,"importedFurnitureLibraryMessage",this.contentManager!=null?this.contentManager.getPresentationName(c,ContentManager.ContentType.FURNITURE_LIBRARY):c))}}catch(b){var d=this.preferences.getLocalizedString(a,"importFurnitureLibraryError",c);this.getView().showError(d)}};a.prototype.importFurnitureLibrary=function(b){if(((typeof b==="string")||b===null)){return this.importFurnitureLibrary$java_lang_String(b)}else{if(b===undefined){return this.importFurnitureLibrary$()}else{throw new Error("invalid overload")}}};a.prototype.importTexture=function(){new ImportedTextureWizardController(this.preferences,this.viewFactory,this.contentManager).displayView(this.getView())};a.prototype.importTexturesLibrary$=function(){var b=this;this.getView().invokeLater(function(){var c=b.getView().showImportTexturesLibraryDialog();if(c!=null){b.importTexturesLibrary$java_lang_String(c)}})};a.prototype.importTexturesLibrary$java_lang_String=function(d){try{if(!this.preferences.texturesLibraryExists(d)||this.getView().confirmReplaceTexturesLibrary(d)){this.preferences.addTexturesLibrary(d);this.getView().showMessage(this.preferences.getLocalizedString(a,"importedTexturesLibraryMessage",this.contentManager!=null?this.contentManager.getPresentationName(d,ContentManager.ContentType.TEXTURES_LIBRARY):d))}}catch(b){var c=this.preferences.getLocalizedString(a,"importTexturesLibraryError",d);this.getView().showError(c)}};a.prototype.importTexturesLibrary=function(b){if(((typeof b==="string")||b===null)){return this.importTexturesLibrary$java_lang_String(b)}else{if(b===undefined){return this.importTexturesLibrary$()}else{throw new Error("invalid overload")}}};a.prototype.undo=function(){this.undoManager.undo();var b=this.getView();var c=this.undoManager.canUndo();b.setEnabled(HomeView.ActionType.UNDO,c);b.setEnabled(HomeView.ActionType.REDO,true);if(c){b.setUndoRedoName(this.undoManager.getUndoPresentationName(),this.undoManager.getRedoPresentationName())}else{b.setUndoRedoName(null,this.undoManager.getRedoPresentationName())}this.saveUndoLevel--;this.home.setModified(this.saveUndoLevel!==0||this.notUndoableModifications)};a.prototype.redo=function(){this.undoManager.redo();var b=this.getView();var c=this.undoManager.canRedo();b.setEnabled(HomeView.ActionType.UNDO,true);b.setEnabled(HomeView.ActionType.REDO,c);if(c){b.setUndoRedoName(this.undoManager.getUndoPresentationName(),this.undoManager.getRedoPresentationName())}else{b.setUndoRedoName(this.undoManager.getUndoPresentationName(),null)}this.saveUndoLevel++;this.home.setModified(this.saveUndoLevel!==0||this.notUndoableModifications)};a.prototype.cut=function(b){var c=this.getUndoableEditSupport();c.beginUpdate();this.getPlanController().deleteItems(b);c.postEdit(new LocalizedUndoableEdit(this.preferences,a,"undoCutName"));c.endUpdate()};a.prototype.paste=function(g){var d=this.home.getSelectedItems();var k=0;if(g.length===d.length){k=20;for(var e=0;e<g.length;e++){var h=g[e];var j=h.getPoints();var b=false;for(var f=0;f<d.length;f++){var c=d[f];if((JSON.stringify(j)===JSON.stringify(c.getPoints()))){b=true;break}}if(!b){k=0;break}}}this.addPastedItems(g,null,k,k,null,"undoPasteName")};a.prototype.drop$java_util_List$float$float=function(d,c,b){this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(d,null,c,b)};a.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float=function(d,e,c,b){this.addPastedItems(d,e,c,b,null,"undoDropName")};a.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Level$float$float$java_lang_Float=function(g,e,b,n,l,k){var j=this.home.getSelectedLevel();if(b!==j||k!=null&&g.length===1&&(g[0]!=null&&g[0] instanceof HomePieceOfFurniture)&&this.application.getUserPreferences().isMagnetismEnabled()){var c=this.getUndoableEditSupport();c.beginUpdate();var m=g[0];m.setElevation(Math.max(0,k));if(b!==j){var h=this.home.getSelectedItems();var d=h.slice(0);var f=this.home.isAllLevelsSelection();this.home.setSelectedLevel(b);c.postEdit(new a.LevelModificationUndoableEdit(this.home,this.preferences,j,b,d,f))}this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(g,e,n,l);c.postEdit(new LocalizedUndoableEdit(this.preferences,a,"undoDropName"));c.endUpdate()}else{this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(g,e,n,l)}};a.prototype.drop=function(e,f,g,d,c,b){if(((e!=null&&(e instanceof Array))||e===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0))||f===null)&&((g!=null&&g instanceof Level)||g===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)&&((typeof b==="number")||b===null)){return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Level$float$float$java_lang_Float(e,f,g,d,c,b)}else{if(((e!=null&&(e instanceof Array))||e===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0))||f===null)&&((typeof g==="number")||g===null)&&((typeof d==="number")||d===null)&&c===undefined&&b===undefined){return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$float$float(e,f,g,d)}else{if(((e!=null&&(e instanceof Array))||e===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.View")>=0))||f===null)&&((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Selectable")>=0))||g===null)&&d===undefined&&c===undefined&&b===undefined){return this.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Selectable(e,f,g)}else{if(((e!=null&&(e instanceof Array))||e===null)&&((typeof f==="number")||f===null)&&((typeof g==="number")||g===null)&&d===undefined&&c===undefined&&b===undefined){return this.drop$java_util_List$float$float(e,f,g)}else{throw new Error("invalid overload")}}}}};a.prototype.drop$java_util_List$com_eteks_sweethome3d_viewcontroller_View$com_eteks_sweethome3d_model_Selectable=function(b,d,c){this.addPastedItems(b,d,0,0,c,"undoDropName")};a.prototype.addPastedItems=function(g,f,k,j,d,h){if(g.length>1||(g.length===1&&!(g[0]!=null&&g[0] instanceof Compass))){var e=Home.getSubList(g,Compass);if(e.length!==0){g=(g.slice(0));(function(m,p){var l=false;for(var o=0;o<p.length;o++){var n=m.indexOf(p[o]);if(n>=0){m.splice(n,1);l=true}}return l})(g,e)}this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var b=this.getUndoableEditSupport();b.beginUpdate();if(f!=null&&f===this.getFurnitureController().getView()){this.getFurnitureController().addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(Home.getFurnitureSubList(g),d)}else{this.getPlanController().addItems(g)}var c=Home.getFurnitureSubList(g);this.adjustFurnitureSizeAndElevation(c,k===0&&j===0&&f==null);this.getPlanController().moveItems(g,k,j);if(f===this.getPlanController().getView()||f===this.getHomeController3D().getView()){if(this.preferences.isMagnetismEnabled()&&g.length===1&&c.length===1){this.getPlanController().adjustMagnetizedPieceOfFurniture(g[0],k,j)}}b.postEdit(new LocalizedUndoableEdit(this.preferences,a,h));b.endUpdate()}};a.prototype.adjustFurnitureSizeAndElevation=function(e,b){if(this.preferences.isMagnetismEnabled()){for(var c=0;c<e.length;c++){var d=e[c];if(!(d!=null&&d instanceof HomeFurnitureGroup)&&d.isResizable()){d.setWidth(this.preferences.getLengthUnit().getMagnetizedLength(d.getWidth(),0.1));if(!(d!=null&&d instanceof HomeDoorOrWindow)||!b){d.setDepth(this.preferences.getLengthUnit().getMagnetizedLength(d.getDepth(),0.1))}d.setHeight(this.preferences.getLengthUnit().getMagnetizedLength(d.getHeight(),0.1))}d.setElevation(this.preferences.getLengthUnit().getMagnetizedLength(d.getElevation(),0.1))}}};a.prototype.dropFiles=function(d,c,b){this.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$());var g=([]);var j=function(k){(g.push(k.getItem())>0)};this.home.addFurnitureListener(((function(k){if(k==null||typeof k=="function"){return k}return function(l){return(k.collectionChanged?k.collectionChanged:k).call(k,l)}})(j)));var h=this.getUndoableEditSupport();h.beginUpdate();for(var f=0;f<d.length;f++){var e=d[f];this.getFurnitureController().importFurniture$java_lang_String(e)}this.home.removeFurnitureListener(((function(k){if(k==null||typeof k=="function"){return k}return function(l){return(k.collectionChanged?k.collectionChanged:k).call(k,l)}})(j)));if(g.length>0){this.getPlanController().moveItems(g,c,b);this.home.setSelectedItems(g);h.postEdit(new a.DroppingEndUndoableEdit(this.home,this.preferences,g.slice(0)))}h.endUpdate()};a.prototype.pasteToGroup=function(){var c=this.getUndoableEditSupport();c.beginUpdate();var b=Home.getFurnitureSubList(this.getView().getClipboardItems());this.getFurnitureController().addFurnitureToGroup(b,this.home.getSelectedItems()[0]);this.adjustFurnitureSizeAndElevation(b,true);c.postEdit(new LocalizedUndoableEdit(this.preferences,a,"undoPasteToGroupName"));c.endUpdate()};a.prototype.pasteStyle=function(){var d=this.getUndoableEditSupport();d.beginUpdate();var n=this.getView().getClipboardItems()[0];var j=this.home.getSelectedItems();if(n!=null&&n instanceof HomePieceOfFurniture){var b=n;var c=new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,d);var r=b.getModelMaterials();if(r!=null){c.getModelMaterialsController().setMaterials(b.getModelMaterials());c.setPaint(HomeFurnitureController.FurniturePaint.MODEL_MATERIALS)}else{if(b.getTexture()!=null){c.getTextureController().setTexture(b.getTexture());c.setPaint(HomeFurnitureController.FurniturePaint.TEXTURED)}else{if(b.getColor()!=null){c.setColor(b.getColor());c.setPaint(HomeFurnitureController.FurniturePaint.COLORED)}else{c.setPaint(HomeFurnitureController.FurniturePaint.DEFAULT)}}}var q=b.getShininess();c.setShininess(q==null?HomeFurnitureController.FurnitureShininess.DEFAULT:(q===0?HomeFurnitureController.FurnitureShininess.MATT:HomeFurnitureController.FurnitureShininess.SHINY));c.modifyFurniture()}else{if(n!=null&&n instanceof Wall){var l=n;var k=new WallController(this.home,this.preferences,this.viewFactory,this.contentManager,d);if(l.getLeftSideColor()!=null){k.setLeftSideColor(l.getLeftSideColor());k.setLeftSidePaint(WallController.WallPaint.COLORED)}else{if(l.getLeftSideTexture()!=null){k.getLeftSideTextureController().setTexture(l.getLeftSideTexture());k.setLeftSidePaint(WallController.WallPaint.TEXTURED)}else{k.setLeftSidePaint(WallController.WallPaint.DEFAULT)}}k.setLeftSideShininess(l.getLeftSideShininess());k.getLeftSideBaseboardController().setBaseboard(l.getLeftSideBaseboard());if(l.getRightSideColor()!=null){k.setRightSideColor(l.getRightSideColor());k.setRightSidePaint(WallController.WallPaint.COLORED)}else{if(l.getRightSideTexture()!=null){k.getRightSideTextureController().setTexture(l.getRightSideTexture());k.setRightSidePaint(WallController.WallPaint.TEXTURED)}else{k.setRightSidePaint(WallController.WallPaint.DEFAULT)}}k.setRightSideShininess(l.getRightSideShininess());k.getRightSideBaseboardController().setBaseboard(l.getRightSideBaseboard());k.setPattern(l.getPattern());k.setTopColor(l.getTopColor());k.setTopPaint(l.getTopColor()!=null?WallController.WallPaint.COLORED:WallController.WallPaint.DEFAULT);k.modifyWalls()}else{if(n!=null&&n instanceof Room){var p=n;var f=new RoomController(this.home,this.preferences,this.viewFactory,this.contentManager,d);if(p.getFloorColor()!=null){f.setFloorColor(p.getFloorColor());f.setFloorPaint(RoomController.RoomPaint.COLORED)}else{if(p.getFloorTexture()!=null){f.getFloorTextureController().setTexture(p.getFloorTexture());f.setFloorPaint(RoomController.RoomPaint.TEXTURED)}else{f.setFloorPaint(RoomController.RoomPaint.DEFAULT)}}f.setFloorShininess(p.getFloorShininess());if(p.getCeilingColor()!=null){f.setCeilingColor(p.getCeilingColor());f.setCeilingPaint(RoomController.RoomPaint.COLORED)}else{if(p.getCeilingTexture()!=null){f.getCeilingTextureController().setTexture(p.getCeilingTexture());f.setCeilingPaint(RoomController.RoomPaint.TEXTURED)}else{f.setCeilingPaint(RoomController.RoomPaint.DEFAULT)}}f.setCeilingShininess(p.getCeilingShininess());f.modifyRooms()}else{if(n!=null&&n instanceof Polyline){var h=n;var g=new PolylineController(this.home,this.preferences,this.viewFactory,this.contentManager,d);g.setThickness(h.getThickness());g.setJoinStyle(h.getJoinStyle());g.setCapStyle(h.getCapStyle());g.setStartArrowStyle(h.getStartArrowStyle());g.setEndArrowStyle(h.getEndArrowStyle());g.setDashStyle(h.getDashStyle());g.setDashPattern(h.getDashPattern());g.setDashOffset(h.getDashOffset());g.setColor(h.getColor());g.modifyPolylines()}else{if(n!=null&&n instanceof Label){var o=n;var e=new LabelController(this.home,this.preferences,this.viewFactory,d);e.setColor(o.getColor());var m=o.getStyle();if(m!=null){e.setAlignment(m.getAlignment());e.setFontName(m.getFontName());e.setFontSize(m.getFontSize())}else{e.setAlignment(null);e.setFontName(null);e.setFontSize(this.preferences.getDefaultTextStyle(Label).getFontSize())}e.modifyLabels()}}}}}d.postEdit(new a.PastingStyleEndUndoableEdit(this.home,this.preferences,j.slice(0)));d.endUpdate()};a.prototype.createTransferData=function(b){var e=[];for(var g=1;g<arguments.length;g++){e[g-1]=arguments[g]}var f=([]);for(var d=0;d<e.length;d++){if(this.childControllers==null){this.childControllers=([]);(this.childControllers.push(this.getFurnitureCatalogController())>0);(this.childControllers.push(this.getFurnitureController())>0);(this.childControllers.push(this.getPlanController())>0);(this.childControllers.push(this.getHomeController3D())>0)}for(var c=0;c<this.childControllers.length;c++){var h=this.childControllers[c];if(h.getView()!=null&&(h.getView().constructor!=null&&h.getView().constructor.__interfaces!=null&&h.getView().constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.TransferableView")>=0)){(f.push(h.getView().createTransferData(e[d]))>0)}}}b.dataReady(f.slice(0))};a.prototype["delete"]=function(){if(this.focusedView===this.getFurnitureCatalogController().getView()){if(this.getView().confirmDeleteCatalogSelection()){this.getFurnitureCatalogController().deleteSelection()}}else{if(this.focusedView===this.getFurnitureController().getView()){this.getFurnitureController().deleteSelection()}else{if(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()&&this.preferences.isEditingIn3DViewEnabled()){this.getPlanController().deleteSelection()}}}};a.prototype.focusedViewChanged=function(b){this.focusedView=b;this.enableActionsBoundToSelection();this.enablePasteAction();this.enablePasteToGroupAction();this.enablePasteStyleAction();this.enableSelectAllAction()};a.prototype.selectAll=function(){if(this.focusedView===this.getFurnitureController().getView()){this.getFurnitureController().selectAll()}else{if(this.focusedView===this.getPlanController().getView()||this.focusedView===this.getHomeController3D().getView()){this.getPlanController().selectAll()}}};a.prototype.newHome=function(){var b;if(this.application!=null){b=this.application.createHome()}else{b=new Home(this.preferences.getNewWallHeight())}this.application.addHome(b)};a.prototype.newHomeFromExample=function(){};a.prototype.getCatalogFurnitureNames=function(b){var d=({});var j=b.getCategories();for(var c=0;c<j.length;c++){var f=j[c];var g=f.getFurniture();for(var h=0;h<g.length;h++){var e=g[h];if(e.getId()!=null){(d[e.getId()]=e.getName())}}}return d};a.prototype.renameToCatalogName=function(d,c,h){if(d!=null&&d instanceof HomeFurnitureGroup){d.setName(h);var g=d.getFurniture();for(var b=0;b<g.length;b++){var e=g[b];this.renameToCatalogName(e,c,h)}}else{var f=d.getCatalogId();if(f!=null){d.setName((function(j,l){return j[l]===undefined?null:j[l]})(c,f))}}};a.prototype.open=function(){};a.prototype.addHomeToApplication=function(b){var c=this;this.getView().invokeLater(function(){c.application.addHome(b)})};a.prototype.updateUserPreferencesRecentHomes=function(d){if(this.application!=null){for(var c=d.length-1;c>=0;c--){try{if(!null){d.splice(c,1)[0]}}catch(b){}}this.preferences.setRecentHomes(d)}};a.prototype.getRecentHomes=function(){if(this.application!=null){var e=([]);var f=this.preferences.getRecentHomes();for(var c=0;c<f.length;c++){var b=f[c];try{if(null){(e.push(b)>0);if(e.length===this.preferences.getRecentHomesMaxCount()){break}}}catch(d){}}this.getView().setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,!(e.length==0));return e.slice(0)}else{return([])}};a.prototype.getVersion=function(){if(this.application!=null){var d=this.application.getVersion();try{var c="JS";if(c!=null){d+=" "+c}}catch(b){}return d}else{return""}};a.prototype.deleteRecentHomes=function(){this.updateUserPreferencesRecentHomes(([]));this.getView().setEnabled(HomeView.ActionType.DELETE_RECENT_HOMES,false)};a.prototype.close=function(){};a.prototype.save=function(){};a.prototype.saveAs=function(){};a.prototype.saveAndCompress=function(){};a.prototype.saveAsAndCompress=function(){};a.prototype.updateSavedHome=function(b,d,c){var e=this;this.getView().invokeLater(function(){e.home.setName(b);e.home.setModified(false);e.home.setRecovered(false);e.home.setRepaired(false);e.home.setVersion(d);var g=(e.preferences.getRecentHomes().slice(0));var f=g.indexOf(b);if(f>=0){g.splice(f,1)[0]}g.splice(0,0,b);e.updateUserPreferencesRecentHomes(g);if(c!=null){(function(h){return(typeof h==="function")?h():h.run()})(c)}})};a.prototype.exportToCSV=function(){};a.prototype.exportToSVG=function(){};a.prototype.exportToOBJ=function(){};a.prototype.createPhotos=function(){};a.prototype.createPhoto=function(){};a.prototype.createVideo=function(){};a.prototype.setupPage=function(){};a.prototype.previewPrint=function(){};a.prototype.print=function(){};a.prototype.printToPDF=function(){};a.prototype.exit=function(){var d=this.application.getHomes();for(var b=0;b<d.length;b++){var c=d[b];if(c.isModified()||c.isRecovered()||c.isRepaired()){if(this.getView().confirmExit()){break}else{return}}}var d=this.application.getHomes();for(var b=0;b<d.length;b++){var c=d[b];c.setRecovered(false);this.application.deleteHome(c)}};a.prototype.editPreferences=function(){new UserPreferencesController(this.preferences,this.viewFactory,this.contentManager,this).displayView(this.getView())};a.prototype.enableMagnetism=function(){this.preferences.setMagnetismEnabled(true)};a.prototype.disableMagnetism=function(){this.preferences.setMagnetismEnabled(false)};a.prototype.setMode=function(c){var d=this;if(this.getPlanController().getMode()!==c){var b;if(c===PlanController.Mode.WALL_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_WALLS]}else{if(c===PlanController.Mode.ROOM_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_ROOMS]}else{if(c===PlanController.Mode.POLYLINE_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_POLYLINES]}else{if(c===PlanController.Mode.DIMENSION_LINE_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_DIMENSION_LINES]}else{if(c===PlanController.Mode.LABEL_CREATION_$LI$()){b=HomeView.ActionType[HomeView.ActionType.CREATE_LABELS]}else{b=null}}}}}if(b!=null&&!this.preferences.isActionTipIgnored(b)){this.getView().invokeLater(function(){if(d.getView().showActionTipMessage(b)){d.preferences.setActionTipIgnored(b)}})}this.getPlanController().setMode(c)}};a.prototype.importBackgroundImage=function(){new BackgroundImageWizardController(this.home,this.preferences,this.viewFactory,this.contentManager,this.getUndoableEditSupport()).displayView(this.getView())};a.prototype.modifyBackgroundImage=function(){this.importBackgroundImage()};a.prototype.hideBackgroundImage=function(){this.toggleBackgroundImageVisibility("undoHideBackgroundImageName")};a.prototype.showBackgroundImage=function(){this.toggleBackgroundImageVisibility("undoShowBackgroundImageName")};a.prototype.toggleBackgroundImageVisibility=function(b){var c=this.home.getSelectedLevel();a.doToggleBackgroundImageVisibility(this.home);this.getUndoableEditSupport().postEdit(new a.BackgroundImageVisibilityTogglingUndoableEdit(this.home,this.preferences,b,c))};a.doToggleBackgroundImageVisibility=function(c){var b=c.getSelectedLevel()!=null?c.getSelectedLevel().getBackgroundImage():c.getBackgroundImage();b=new BackgroundImage(b.getImage(),b.getScaleDistance(),b.getScaleDistanceXStart(),b.getScaleDistanceYStart(),b.getScaleDistanceXEnd(),b.getScaleDistanceYEnd(),b.getXOrigin(),b.getYOrigin(),!b.isVisible());if(c.getSelectedLevel()!=null){c.getSelectedLevel().setBackgroundImage(b)}else{c.setBackgroundImage(b)}};a.prototype.deleteBackgroundImage=function(){var c=this.home.getSelectedLevel();var b;if(c!=null){b=c.getBackgroundImage();c.setBackgroundImage(null)}else{b=this.home.getBackgroundImage();this.home.setBackgroundImage(null)}this.getUndoableEditSupport().postEdit(new a.BackgroundImageDeletionUndoableEdit(this.home,this.preferences,c,b))};a.prototype.zoomOut=function(){var b=this.getPlanController();var c=b.getScale()/1.5;b.setScale(c);b.getView().makeSelectionVisible()};a.prototype.zoomIn=function(){var b=this.getPlanController();var c=b.getScale()*1.5;b.setScale(c);b.getView().makeSelectionVisible()};a.prototype.storeCamera=function(){var c=new Date().toLocaleDateString(this.preferences.getLanguage().replace("_","-"));var b=this.getView().showStoreCameraDialog(c);if(b!=null){this.getHomeController3D().storeCamera(b)}};a.prototype.deleteCameras=function(){var b=this.getView().showDeletedCamerasDialog();if(b!=null){this.getHomeController3D().deleteCameras(b)}};a.prototype.detachView=function(b){if(b!=null){this.getView().detachView(b);this.notUndoableModifications=true;this.home.setModified(true)}};a.prototype.attachView=function(b){if(b!=null){this.getView().attachView(b);this.notUndoableModifications=true;this.home.setModified(true)}};a.prototype.help=function(){};a.prototype.about=function(){this.getView().showAboutDialog()};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};a.helpController=null;return a}());HomeController.__class="com.eteks.sweethome3d.viewcontroller.HomeController";HomeController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(D){var c=(function(){function E(){}E.writingPreferences_$LI$=function(){if(E.writingPreferences==null){E.writingPreferences=([])}return E.writingPreferences};E.prototype.writePreferences=function(F){if(!(E.writingPreferences_$LI$().indexOf((F.preferences))>=0)){(function(G,H){if(G.indexOf(H)==-1){G.push(H);return true}else{return false}})(E.writingPreferences_$LI$(),F.preferences);F.getView().invokeLater(function(){try{F.preferences.write();(function(H){var I=H.indexOf(F.preferences);if(I>=0){H.splice(I,1);return true}else{return false}})(E.writingPreferences_$LI$())}catch(G){F.getView().showError(F.preferences.getLocalizedString(D,"savePreferencesError"))}})}};return E}());D.UserPreferencesChangeListener=c;c.__class="com.eteks.sweethome3d.viewcontroller.HomeController.UserPreferencesChangeListener";var C=(function(){function E(F){if(this.homeController===undefined){this.homeController=null}this.homeController=(F)}E.prototype.propertyChange=function(G){var F=this.homeController;if(F==null){(G.getSource()).removePropertyChangeListener("LANGUAGE",this)}else{F.getView().setUndoRedoName(F.undoManager.canUndo()?F.undoManager.getUndoPresentationName():null,F.undoManager.canRedo()?F.undoManager.getRedoPresentationName():null)}};return E}());D.LanguageChangeListener=C;C.__class="com.eteks.sweethome3d.viewcontroller.HomeController.LanguageChangeListener";var z=(function(F){__extends(E,F);function E(K,G,I,J,M,H){var L=F.call(this,G,D,"undoDropName")||this;if(L.home===undefined){L.home=null}if(L.oldSelectedLevel===undefined){L.oldSelectedLevel=null}if(L.selectedLevel===undefined){L.selectedLevel=null}if(L.selectedItems===undefined){L.selectedItems=null}if(L.allLevelsSelection===undefined){L.allLevelsSelection=false}L.home=K;L.oldSelectedLevel=I;L.selectedLevel=J;L.selectedItems=M;L.allLevelsSelection=H;return L}E.prototype.undo=function(){F.prototype.undo.call(this);if(this.allLevelsSelection){this.home.setAllLevelsSelection(this.allLevelsSelection)}else{this.home.setSelectedLevel(this.oldSelectedLevel)}this.home.setSelectedItems(this.selectedItems.slice(0))};E.prototype.redo=function(){F.prototype.redo.call(this);this.home.setSelectedLevel(this.selectedLevel)};return E}(LocalizedUndoableEdit));D.LevelModificationUndoableEdit=z;z.__class="com.eteks.sweethome3d.viewcontroller.HomeController.LevelModificationUndoableEdit";z.__interfaces=["javax.swing.undo.UndoableEdit"];var y=(function(E){__extends(F,E);function F(I,G,H){var J=E.call(this,G,D,"undoDropName")||this;if(J.home===undefined){J.home=null}if(J.importedFurniture===undefined){J.importedFurniture=null}J.home=I;J.importedFurniture=H;return J}F.prototype.redo=function(){E.prototype.redo.call(this);this.home.setSelectedItems(this.importedFurniture.slice(0))};return F}(LocalizedUndoableEdit));D.DroppingEndUndoableEdit=y;y.__class="com.eteks.sweethome3d.viewcontroller.HomeController.DroppingEndUndoableEdit";y.__interfaces=["javax.swing.undo.UndoableEdit"];var A=(function(F){__extends(E,F);function E(H,G,J){var I=F.call(this,G,D,"undoPasteStyleName")||this;if(I.home===undefined){I.home=null}if(I.selectedItems===undefined){I.selectedItems=null}I.home=H;I.selectedItems=J;return I}E.prototype.redo=function(){F.prototype.redo.call(this);this.home.setSelectedItems(this.selectedItems.slice(0))};return E}(LocalizedUndoableEdit));D.PastingStyleEndUndoableEdit=A;A.__class="com.eteks.sweethome3d.viewcontroller.HomeController.PastingStyleEndUndoableEdit";A.__interfaces=["javax.swing.undo.UndoableEdit"];var n=(function(F){__extends(E,F);function E(J,G,H,I){var K=F.call(this,G,D,H)||this;if(K.home===undefined){K.home=null}if(K.selectedLevel===undefined){K.selectedLevel=null}K.home=J;K.selectedLevel=I;return K}E.prototype.undo=function(){F.prototype.undo.call(this);this.home.setSelectedLevel(this.selectedLevel);D.doToggleBackgroundImageVisibility(this.home)};E.prototype.redo=function(){F.prototype.redo.call(this);this.home.setSelectedLevel(this.selectedLevel);D.doToggleBackgroundImageVisibility(this.home)};return E}(LocalizedUndoableEdit));D.BackgroundImageVisibilityTogglingUndoableEdit=n;n.__class="com.eteks.sweethome3d.viewcontroller.HomeController.BackgroundImageVisibilityTogglingUndoableEdit";n.__interfaces=["javax.swing.undo.UndoableEdit"];var x=(function(E){__extends(F,E);function F(J,G,I,H){var K=E.call(this,G,D,"undoDeleteBackgroundImageName")||this;if(K.home===undefined){K.home=null}if(K.selectedLevel===undefined){K.selectedLevel=null}if(K.oldImage===undefined){K.oldImage=null}K.home=J;K.oldImage=H;K.selectedLevel=I;return K}F.prototype.undo=function(){E.prototype.undo.call(this);this.home.setSelectedLevel(this.selectedLevel);if(this.selectedLevel!=null){this.selectedLevel.setBackgroundImage(this.oldImage)}else{this.home.setBackgroundImage(this.oldImage)}};F.prototype.redo=function(){E.prototype.redo.call(this);this.home.setSelectedLevel(this.selectedLevel);if(this.selectedLevel!=null){this.selectedLevel.setBackgroundImage(null)}else{this.home.setBackgroundImage(null)}};return F}(LocalizedUndoableEdit));D.BackgroundImageDeletionUndoableEdit=x;x.__class="com.eteks.sweethome3d.viewcontroller.HomeController.BackgroundImageDeletionUndoableEdit";x.__interfaces=["javax.swing.undo.UndoableEdit"];var B=(function(F){__extends(E,F);function E(G){var H=F.call(this)||this;if(H.homeController===undefined){H.homeController=null}H.homeController=(G);return H}E.prototype.collectionChanged=function(H){var G=this.homeController;if(G==null){H.getSource().removeFurnitureListener(((function(I){if(I==null||typeof I=="function"){return I}return function(J){return(I.collectionChanged?I.collectionChanged:I).call(I,J)}})(this)))}else{this.writePreferences(G)}};return E}(D.UserPreferencesChangeListener));D.FurnitureCatalogChangeListener=B;B.__class="com.eteks.sweethome3d.viewcontroller.HomeController.FurnitureCatalogChangeListener";B.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var j=(function(F){__extends(E,F);function E(G){var H=F.call(this)||this;if(H.homeController===undefined){H.homeController=null}H.homeController=(G);return H}E.prototype.collectionChanged=function(H){var G=this.homeController;if(G==null){H.getSource().removeTexturesListener(((function(I){if(I==null||typeof I=="function"){return I}return function(J){return(I.collectionChanged?I.collectionChanged:I).call(I,J)}})(this)))}else{this.writePreferences(G)}};return E}(D.UserPreferencesChangeListener));D.TexturesCatalogChangeListener=j;j.__class="com.eteks.sweethome3d.viewcontroller.HomeController.TexturesCatalogChangeListener";j.__interfaces=["com.eteks.sweethome3d.model.CollectionListener"];var w=(function(F){__extends(E,F);function E(G){var H=F.call(this)||this;if(H.homeController===undefined){H.homeController=null}H.homeController=(G);return H}E.prototype.propertyChange=function(H){var G=this.homeController;if(G==null){(H.getSource()).removePropertyChangeListener(H.getPropertyName(),this)}else{this.writePreferences(G)}};return E}(D.UserPreferencesChangeListener));D.UserPreferencesPropertiesChangeListener=w;w.__class="com.eteks.sweethome3d.viewcontroller.HomeController.UserPreferencesPropertiesChangeListener";var m=(function(E){__extends(F,E);function F(G){var H=E.call(this)||this;H.__parent=G;return H}F.prototype._postEdit=function(G){if(!(G!=null&&G instanceof javax.swing.undo.CompoundEdit)||G.isSignificant()){E.prototype._postEdit.call(this,G)}};return F}(javax.swing.undo.UndoableEditSupport));D.HomeController$0=m;var l=(function(){function E(F){this.__parent=F}E.prototype.selectionChanged=function(F){this.__parent.enableActionsBoundToSelection()};return E}());D.HomeController$1=l;l.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var k=(function(){function E(F){this.__parent=F}E.prototype.selectionChanged=function(F){this.__parent.enableActionsBoundToSelection()};return E}());D.HomeController$2=k;k.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var h=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){this.__parent.getView().setEnabled(HomeView.ActionType.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,F.getNewValue()!=null)};return E}());D.HomeController$3=h;var g=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){this.__parent.enableBackgroungImageActions(this.__parent.getView(),F.getNewValue())};return E}());D.HomeController$4=g;var f=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){this.__parent.notUndoableModifications=true;this.__parent.home.setModified(true)};return E}());D.HomeController$5=f;var e=(function(){function E(G,F){this.notUndoableModificationListener=F;this.__parent=G}E.prototype.propertyChange=function(F){if(this.__parent.home.getEnvironment().getPhotoAspectRatio()!==AspectRatio.VIEW_3D_RATIO){this.notUndoableModificationListener.propertyChange(F)}};return E}());D.HomeController$6=e;var d=(function(){function E(G,F){this.notUndoableModificationListener=F;this.__parent=G}E.prototype.propertyChange=function(F){if((F.getPropertyName()==="TIME")||(F.getPropertyName()==="LENS")){this.notUndoableModificationListener.propertyChange(F)}};return E}());D.HomeController$7=d;var b=(function(){function E(F){this.__parent=F}E.prototype.undoableEditHappened=function(G){var F=this.__parent.getView();F.setEnabled(HomeView.ActionType.UNDO,!this.__parent.getPlanController().isModificationState());F.setEnabled(HomeView.ActionType.REDO,false);F.setUndoRedoName(G.getEdit().getUndoPresentationName(),null);this.__parent.saveUndoLevel++;this.__parent.home.setModified(true)};return E}());D.HomeController$8=b;b.__interfaces=["javax.swing.event.UndoableEditListener"];var a=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){if(!this.__parent.home.isModified()){this.__parent.saveUndoLevel=0;this.__parent.notUndoableModifications=false}};return E}());D.HomeController$9=a;var v=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){if("VISIBLE"===F.getPropertyName()){this.__parent.enableSelectAllAction()}};return E}());D.HomeController$10=v;var u=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){this.__parent.getView().setEnabled(HomeView.ActionType.MODIFY_OBSERVER,this.__parent.home.getCamera()===this.__parent.home.getObserverCamera())};return E}());D.HomeController$11=u;var t=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(J){var K=this.__parent.home.getSelectedLevel();if(!this.__parent.home.isAllLevelsSelection()){var H=([]);var L=this.__parent.home.getSelectedItems();for(var G=0;G<L.length;G++){var I=L[G];if(!(I!=null&&(I.constructor!=null&&I.constructor.__interfaces!=null&&I.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))||I.isAtLevel(K)){(H.push(I)>0)}}this.__parent.home.setSelectedItems(H)}var F=this.__parent.getView();this.__parent.enableCreationToolsActions(F);this.__parent.enableBackgroungImageActions(F,K==null?this.__parent.home.getBackgroundImage():K.getBackgroundImage());this.__parent.enableLevelActions(F)};return E}());D.HomeController$12=t;var s=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){if("BACKGROUND_IMAGE"===F.getPropertyName()){this.__parent.enableBackgroungImageActions(this.__parent.getView(),F.getNewValue())}else{if("VIEWABLE"===F.getPropertyName()){this.__parent.enableCreationToolsActions(this.__parent.getView());this.__parent.enableActionsBoundToSelection();if(!F.getNewValue()){var G=this.__parent.getPlanController().getMode();if(G!==PlanController.Mode.SELECTION_$LI$()&&G!==PlanController.Mode.PANNING_$LI$()){this.__parent.getPlanController().setMode(PlanController.Mode.SELECTION_$LI$())}}}}};return E}());D.HomeController$13=s;var r=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(G){var F=(this.__parent.home.getStoredCameras().length==0);this.__parent.getView().setEnabled(HomeView.ActionType.DELETE_POINTS_OF_VIEW,!F);this.__parent.getView().setEnabled(HomeView.ActionType.CREATE_PHOTOS_AT_POINTS_OF_VIEW,!F)};return E}());D.HomeController$14=r;var q=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(G){this.__parent.enableActionsBoundToSelection();this.__parent.enableSelectAllAction();var F=this.__parent.getView();this.__parent.enableLevelActions(F);var H=this.__parent.getPlanController().isModificationState();if(H){F.setEnabled(HomeView.ActionType.PASTE,false);F.setEnabled(HomeView.ActionType.UNDO,false);F.setEnabled(HomeView.ActionType.REDO,false)}else{this.__parent.enablePasteAction();F.setEnabled(HomeView.ActionType.UNDO,this.__parent.undoManager.canUndo());F.setEnabled(HomeView.ActionType.REDO,this.__parent.undoManager.canRedo())}F.setEnabled(HomeView.ActionType.LOCK_BASE_PLAN,!H);F.setEnabled(HomeView.ActionType.UNLOCK_BASE_PLAN,!H)};return E}());D.HomeController$15=q;var p=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){this.__parent.enableActionsBoundToSelection()};return E}());D.HomeController$16=p;var o=(function(){function E(F){this.__parent=F}E.prototype.propertyChange=function(F){this.__parent.enableZoomActions()};return E}());D.HomeController$17=o})(HomeController||(HomeController={}));var Home3DAttributesController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.groundTextureController===undefined){this.groundTextureController=null}if(this.skyTextureController===undefined){this.skyTextureController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.home3DAttributesView===undefined){this.home3DAttributesView=null}if(this.groundColor===undefined){this.groundColor=0}if(this.groundPaint===undefined){this.groundPaint=null}if(this.backgroundImageVisibleOnGround3D===undefined){this.backgroundImageVisibleOnGround3D=false}if(this.skyColor===undefined){this.skyColor=0}if(this.skyPaint===undefined){this.skyPaint=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}this.home=f;this.preferences=c;this.viewFactory=b;this.contentManager=e;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getGroundTextureController=function(){if(this.groundTextureController==null){this.groundTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"groundTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.groundTextureController.addPropertyChangeListener("TEXTURE",new a.Home3DAttributesController$0(this))}return this.groundTextureController};a.prototype.getSkyTextureController=function(){if(this.skyTextureController==null){this.skyTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"skyTextureTitle"),false,this.preferences,this.viewFactory,this.contentManager);this.skyTextureController.addPropertyChangeListener("TEXTURE",new a.Home3DAttributesController$1(this))}return this.skyTextureController};a.prototype.getView=function(){if(this.home3DAttributesView==null){this.home3DAttributesView=this.viewFactory.createHome3DAttributesView(this.preferences,this)}return this.home3DAttributesView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var c=this.home.getEnvironment();this.setGroundColor(c.getGroundColor());var d=c.getGroundTexture();this.getGroundTextureController().setTexture(d);if(d!=null){this.setGroundPaint(a.EnvironmentPaint.TEXTURED)}else{this.setGroundPaint(a.EnvironmentPaint.COLORED)}this.setBackgroundImageVisibleOnGround3D(c.isBackgroundImageVisibleOnGround3D());this.setSkyColor(c.getSkyColor());var b=c.getSkyTexture();this.getSkyTextureController().setTexture(b);if(b!=null){this.setSkyPaint(a.EnvironmentPaint.TEXTURED)}else{this.setSkyPaint(a.EnvironmentPaint.COLORED)}this.setLightColor(c.getLightColor());this.setWallsAlpha(c.getWallsAlpha())};a.prototype.setGroundColor=function(b){if(b!==this.groundColor){var c=this.groundColor;this.groundColor=b;this.propertyChangeSupport.firePropertyChange("GROUND_COLOR",c,b);this.setGroundPaint(a.EnvironmentPaint.COLORED)}};a.prototype.getGroundColor=function(){return this.groundColor};a.prototype.setGroundPaint=function(b){if(b!==this.groundPaint){var c=this.groundPaint;this.groundPaint=b;this.propertyChangeSupport.firePropertyChange("GROUND_PAINT",c,b)}};a.prototype.getGroundPaint=function(){return this.groundPaint};a.prototype.isBackgroundImageVisibleOnGround3D=function(){return this.backgroundImageVisibleOnGround3D};a.prototype.setBackgroundImageVisibleOnGround3D=function(b){if(this.backgroundImageVisibleOnGround3D!==b){this.backgroundImageVisibleOnGround3D=b;this.propertyChangeSupport.firePropertyChange("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",!b,b)}};a.prototype.setSkyColor=function(c){if(c!==this.skyColor){var b=this.skyColor;this.skyColor=c;this.propertyChangeSupport.firePropertyChange("SKY_COLOR",b,c)}};a.prototype.getSkyColor=function(){return this.skyColor};a.prototype.setSkyPaint=function(b){if(b!==this.skyPaint){var c=this.skyPaint;this.skyPaint=b;this.propertyChangeSupport.firePropertyChange("SKY_PAINT",c,b)}};a.prototype.getSkyPaint=function(){return this.skyPaint};a.prototype.setLightColor=function(b){if(b!==this.lightColor){var c=this.lightColor;this.lightColor=b;this.propertyChangeSupport.firePropertyChange("LIGHT_COLOR",c,b)}};a.prototype.getLightColor=function(){return this.lightColor};a.prototype.setWallsAlpha=function(c){if(c!==this.wallsAlpha){var b=this.wallsAlpha;this.wallsAlpha=c;this.propertyChangeSupport.firePropertyChange("WALLS_ALPHA",b,c)}};a.prototype.getWallsAlpha=function(){return this.wallsAlpha};a.prototype.modify3DAttributes=function(){var f=this.getGroundColor();var e=this.getGroundPaint()===a.EnvironmentPaint.TEXTURED?this.getGroundTextureController().getTexture():null;var c=this.isBackgroundImageVisibleOnGround3D();var m=this.getSkyColor();var q=this.getSkyPaint()===a.EnvironmentPaint.TEXTURED?this.getSkyTextureController().getTexture():null;var g=this.getLightColor();var j=this.getWallsAlpha();var l=this.home.getEnvironment();var d=l.getGroundColor();var p=l.isBackgroundImageVisibleOnGround3D();var k=l.getGroundTexture();var b=l.getSkyColor();var h=l.getSkyTexture();var o=l.getLightColor();var n=l.getWallsAlpha();a.doModify3DAttributes(this.home,f,e,c,m,q,g,j);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.Home3DAttributesModificationUndoableEdit(this.home,this.preferences,d,k,p,b,h,o,n,f,e,c,m,q,g,j))}};a.doModify3DAttributes=function(h,d,c,b,j,k,e,f){var g=h.getEnvironment();g.setGroundColor(d);g.setGroundTexture(c);g.setBackgroundImageVisibleOnGround3D(b);g.setSkyColor(j);g.setSkyTexture(k);g.setLightColor(e);g.setWallsAlpha(f)};return a}());Home3DAttributesController.__class="com.eteks.sweethome3d.viewcontroller.Home3DAttributesController";Home3DAttributesController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var b;(function(f){f[f.COLORED=0]="COLORED";f[f.TEXTURED=1]="TEXTURED"})(b=d.EnvironmentPaint||(d.EnvironmentPaint={}));var a=(function(g){__extends(f,g);function f(t,o,k,s,y,j,q,w,v,m,l,h,u,x,n,p){var r=g.call(this,o,d,"undoModify3DAttributesName")||this;if(r.home===undefined){r.home=null}if(r.oldGroundColor===undefined){r.oldGroundColor=0}if(r.oldGroundTexture===undefined){r.oldGroundTexture=null}if(r.oldBackgroundImageVisibleOnGround3D===undefined){r.oldBackgroundImageVisibleOnGround3D=false}if(r.oldSkyColor===undefined){r.oldSkyColor=0}if(r.oldSkyTexture===undefined){r.oldSkyTexture=null}if(r.oldLightColor===undefined){r.oldLightColor=0}if(r.oldWallsAlpha===undefined){r.oldWallsAlpha=0}if(r.groundColor===undefined){r.groundColor=0}if(r.groundTexture===undefined){r.groundTexture=null}if(r.backgroundImageVisibleOnGround3D===undefined){r.backgroundImageVisibleOnGround3D=false}if(r.skyColor===undefined){r.skyColor=0}if(r.skyTexture===undefined){r.skyTexture=null}if(r.lightColor===undefined){r.lightColor=0}if(r.wallsAlpha===undefined){r.wallsAlpha=0}r.home=t;r.oldGroundColor=k;r.oldGroundTexture=s;r.oldBackgroundImageVisibleOnGround3D=y;r.oldSkyColor=j;r.oldSkyTexture=q;r.oldLightColor=w;r.oldWallsAlpha=v;r.groundColor=m;r.groundTexture=l;r.backgroundImageVisibleOnGround3D=h;r.skyColor=u;r.skyTexture=x;r.lightColor=n;r.wallsAlpha=p;return r}f.prototype.undo=function(){g.prototype.undo.call(this);d.doModify3DAttributes(this.home,this.oldGroundColor,this.oldGroundTexture,this.oldBackgroundImageVisibleOnGround3D,this.oldSkyColor,this.oldSkyTexture,this.oldLightColor,this.oldWallsAlpha)};f.prototype.redo=function(){g.prototype.redo.call(this);d.doModify3DAttributes(this.home,this.groundColor,this.groundTexture,this.backgroundImageVisibleOnGround3D,this.skyColor,this.skyTexture,this.lightColor,this.wallsAlpha)};return f}(LocalizedUndoableEdit));d.Home3DAttributesModificationUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.Home3DAttributesController.Home3DAttributesModificationUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var e=(function(){function f(g){this.__parent=g}f.prototype.propertyChange=function(g){this.__parent.setGroundPaint(d.EnvironmentPaint.TEXTURED)};return f}());d.Home3DAttributesController$0=e;var c=(function(){function f(g){this.__parent=g}f.prototype.propertyChange=function(g){this.__parent.setSkyPaint(d.EnvironmentPaint.TEXTURED)};return f}());d.Home3DAttributesController$1=c})(Home3DAttributesController||(Home3DAttributesController={}));var ImportedFurnitureWizardController=(function(a){__extends(b,a);function b(s,H,h,L,E,g,R,ab){var f=this;if(((s!=null&&s instanceof Home)||s===null)&&((H!=null&&H instanceof CatalogPieceOfFurniture)||H===null)&&((typeof h==="string")||h===null)&&((L!=null&&L instanceof UserPreferences)||L===null)&&((E!=null&&E instanceof FurnitureController)||E===null)&&((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||g===null)&&((R!=null&&(R.constructor!=null&&R.constructor.__interfaces!=null&&R.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||R===null)&&((ab!=null&&ab instanceof javax.swing.undo.UndoableEditSupport)||ab===null)){var aa=arguments;f=a.call(this,L,g)||this;if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}f.home=s;f.piece=H;f.modelName=h;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=L;f.furnitureController=E;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=g;f.undoSupport=ab;f.contentManager=R;f.setTitle(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,H==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));f.furnitureModelStepState=new b.FurnitureModelStepState(f);f.furnitureOrientationStepState=new b.FurnitureOrientationStepState(f);f.furnitureAttributesStepState=new b.FurnitureAttributesStepState(f);f.furnitureIconStepState=new b.FurnitureIconStepState(f);f.setStepState(f.furnitureModelStepState)}else{if(((s!=null&&s instanceof Home)||s===null)&&((typeof H==="string")||H===null)&&((h!=null&&h instanceof UserPreferences)||h===null)&&((L!=null&&L instanceof FurnitureController)||L===null)&&((E!=null&&(E.constructor!=null&&E.constructor.__interfaces!=null&&E.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||E===null)&&((g!=null&&(g.constructor!=null&&g.constructor.__interfaces!=null&&g.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||g===null)&&((R!=null&&R instanceof javax.swing.undo.UndoableEditSupport)||R===null)&&ab===undefined){var aa=arguments;var Q=aa[1];var K=aa[2];var X=aa[3];var r=aa[4];var D=aa[5];var e=aa[6];var z=arguments;var A=null;f=a.call(this,K,r)||this;if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}f.home=s;f.piece=A;f.modelName=Q;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=K;f.furnitureController=X;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=r;f.undoSupport=e;f.contentManager=D;f.setTitle(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,A==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));f.furnitureModelStepState=new b.FurnitureModelStepState(f);f.furnitureOrientationStepState=new b.FurnitureOrientationStepState(f);f.furnitureAttributesStepState=new b.FurnitureAttributesStepState(f);f.furnitureIconStepState=new b.FurnitureIconStepState(f);f.setStepState(f.furnitureModelStepState);if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((s!=null&&s instanceof Home)||s===null)&&((H!=null&&H instanceof UserPreferences)||H===null)&&((h!=null&&h instanceof FurnitureController)||h===null)&&((L!=null&&(L.constructor!=null&&L.constructor.__interfaces!=null&&L.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||L===null)&&((E!=null&&(E.constructor!=null&&E.constructor.__interfaces!=null&&E.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||E===null)&&((g!=null&&g instanceof javax.swing.undo.UndoableEditSupport)||g===null)&&R===undefined&&ab===undefined){var aa=arguments;var J=aa[1];var V=aa[2];var o=aa[3];var C=aa[4];var d=aa[5];var w=arguments;var x=null;var P=null;f=a.call(this,J,o)||this;if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}f.home=s;f.piece=x;f.modelName=P;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=J;f.furnitureController=V;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=o;f.undoSupport=d;f.contentManager=C;f.setTitle(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,x==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));f.furnitureModelStepState=new b.FurnitureModelStepState(f);f.furnitureOrientationStepState=new b.FurnitureOrientationStepState(f);f.furnitureAttributesStepState=new b.FurnitureAttributesStepState(f);f.furnitureIconStepState=new b.FurnitureIconStepState(f);f.setStepState(f.furnitureModelStepState);if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((typeof s==="string")||s===null)&&((H!=null&&H instanceof UserPreferences)||H===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((L!=null&&(L.constructor!=null&&L.constructor.__interfaces!=null&&L.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||L===null)&&E===undefined&&g===undefined&&R===undefined&&ab===undefined){var aa=arguments;var O=aa[0];var I=aa[1];var l=aa[2];var B=aa[3];var t=arguments;var Z=null;var u=null;var U=null;var c=null;f=a.call(this,I,l)||this;if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}f.home=Z;f.piece=u;f.modelName=O;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=I;f.furnitureController=U;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=l;f.undoSupport=c;f.contentManager=B;f.setTitle(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,u==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));f.furnitureModelStepState=new b.FurnitureModelStepState(f);f.furnitureOrientationStepState=new b.FurnitureOrientationStepState(f);f.furnitureAttributesStepState=new b.FurnitureAttributesStepState(f);f.furnitureIconStepState=new b.FurnitureIconStepState(f);f.setStepState(f.furnitureModelStepState);if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((s!=null&&s instanceof CatalogPieceOfFurniture)||s===null)&&((H!=null&&H instanceof UserPreferences)||H===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((L!=null&&(L.constructor!=null&&L.constructor.__interfaces!=null&&L.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||L===null)&&E===undefined&&g===undefined&&R===undefined&&ab===undefined){var aa=arguments;var q=aa[0];var G=aa[1];var k=aa[2];var y=aa[3];var p=arguments;var Y=null;var N=null;var T=null;var ad=null;f=a.call(this,G,k)||this;if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}f.home=Y;f.piece=q;f.modelName=N;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=G;f.furnitureController=T;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=k;f.undoSupport=ad;f.contentManager=y;f.setTitle(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,q==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));f.furnitureModelStepState=new b.FurnitureModelStepState(f);f.furnitureOrientationStepState=new b.FurnitureOrientationStepState(f);f.furnitureAttributesStepState=new b.FurnitureAttributesStepState(f);f.furnitureIconStepState=new b.FurnitureIconStepState(f);f.setStepState(f.furnitureModelStepState);if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{if(((s!=null&&s instanceof UserPreferences)||s===null)&&((H!=null&&(H.constructor!=null&&H.constructor.__interfaces!=null&&H.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||H===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||h===null)&&L===undefined&&E===undefined&&g===undefined&&R===undefined&&ab===undefined){var aa=arguments;var F=aa[0];var j=aa[1];var v=aa[2];var n=arguments;var W=null;var m=null;var M=null;var S=null;var ac=null;f=a.call(this,F,j)||this;if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}f.home=W;f.piece=m;f.modelName=M;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=F;f.furnitureController=S;f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=j;f.undoSupport=ac;f.contentManager=v;f.setTitle(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getLocalizedString(b,m==null?"importFurnitureWizard.title":"modifyFurnitureWizard.title"));f.furnitureModelStepState=new b.FurnitureModelStepState(f);f.furnitureOrientationStepState=new b.FurnitureOrientationStepState(f);f.furnitureAttributesStepState=new b.FurnitureAttributesStepState(f);f.furnitureIconStepState=new b.FurnitureIconStepState(f);f.setStepState(f.furnitureModelStepState);if(f.home===undefined){f.home=null}if(f.piece===undefined){f.piece=null}if(f.modelName===undefined){f.modelName=null}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences=null}if(f.furnitureController===undefined){f.furnitureController=null}if(f.contentManager===undefined){f.contentManager=null}if(f.undoSupport===undefined){f.undoSupport=null}if(f.furnitureModelStepState===undefined){f.furnitureModelStepState=null}if(f.furnitureOrientationStepState===undefined){f.furnitureOrientationStepState=null}if(f.furnitureAttributesStepState===undefined){f.furnitureAttributesStepState=null}if(f.furnitureIconStepState===undefined){f.furnitureIconStepState=null}if(f.stepsView===undefined){f.stepsView=null}if(f.step===undefined){f.step=null}if(f.name===undefined){f.name=null}if(f.creator===undefined){f.creator=null}if(f.model===undefined){f.model=null}if(f.width===undefined){f.width=0}if(f.proportionalWidth===undefined){f.proportionalWidth=0}if(f.depth===undefined){f.depth=0}if(f.proportionalDepth===undefined){f.proportionalDepth=0}if(f.height===undefined){f.height=0}if(f.proportionalHeight===undefined){f.proportionalHeight=0}if(f.elevation===undefined){f.elevation=0}if(f.movable===undefined){f.movable=false}if(f.doorOrWindow===undefined){f.doorOrWindow=false}if(f.staircaseCutOutShape===undefined){f.staircaseCutOutShape=null}if(f.color===undefined){f.color=null}if(f.category===undefined){f.category=null}if(f.modelSize===undefined){f.modelSize=0}if(f.modelRotation===undefined){f.modelRotation=null}if(f.edgeColorMaterialHidden===undefined){f.edgeColorMaterialHidden=false}if(f.backFaceShown===undefined){f.backFaceShown=false}if(f.iconYaw===undefined){f.iconYaw=0}if(f.iconPitch===undefined){f.iconPitch=0}if(f.iconScale===undefined){f.iconScale=0}if(f.proportional===undefined){f.proportional=false}if(f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory===undefined){f.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory=null}}else{throw new Error("invalid overload")}}}}}}return f}b.prototype.finish=function(){var d;var e=(this.isBackFaceShown()?PieceOfFurniture.SHOW_BACK_FACE:0)|(this.isEdgeColorMaterialHidden()?PieceOfFurniture.HIDE_EDGE_COLOR_MATERIAL:0);if(this.isDoorOrWindow()){d=new CatalogDoorOrWindow(this.getName(),this.getIcon(),this.getModel(),this.getWidth(),this.getDepth(),this.getHeight(),this.getElevation(),this.isMovable(),1,0,[],this.getColor(),this.getModelRotation(),e,this.getModelSize(),this.getCreator(),this.getIconYaw(),this.getIconPitch(),this.getIconScale(),this.isProportional())}else{d=new CatalogPieceOfFurniture(this.getName(),this.getIcon(),this.getModel(),this.getWidth(),this.getDepth(),this.getHeight(),this.getElevation(),this.isMovable(),this.getStaircaseCutOutShape(),this.getColor(),this.getModelRotation(),e,this.getModelSize(),this.getCreator(),this.getIconYaw(),this.getIconPitch(),this.getIconScale(),this.isProportional())}if(this.home!=null){this.addPieceOfFurniture(this.furnitureController.createHomePieceOfFurniture(d))}var c=this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences.getFurnitureCatalog();if(this.piece!=null){c["delete"](this.piece)}if(this.category!=null){c.add(this.category,d)}};b.prototype.addPieceOfFurniture=function(g){var c=this.home.isBasePlanLocked();var f=this.home.isAllLevelsSelection();var d=this.home.getSelectedItems();var h=this.home.getFurniture().length;this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(g,h);this.home.setSelectedItems([g]);if(!g.isMovable()&&c){this.home.setBasePlanLocked(false)}this.home.setAllLevelsSelection(false);if(this.undoSupport!=null){var e=new b.PieceOfFurnitureImportationUndoableEdit(this.home,this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences,d.slice(0),c,f,g,h);this.undoSupport.postEdit(e)}};b.prototype.getContentManager=function(){return this.contentManager};b.prototype.getStepState=function(){return a.prototype.getStepState.call(this)};b.prototype.getFurnitureModelStepState=function(){return this.furnitureModelStepState};b.prototype.getFurnitureOrientationStepState=function(){return this.furnitureOrientationStepState};b.prototype.getFurnitureAttributesStepState=function(){return this.furnitureAttributesStepState};b.prototype.getFurnitureIconStepState=function(){return this.furnitureIconStepState};b.prototype.getStepsView=function(){if(this.stepsView==null){this.stepsView=this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_viewFactory.createImportedFurnitureWizardStepsView(this.piece,this.modelName,this.home!=null,this.__com_eteks_sweethome3d_viewcontroller_ImportedFurnitureWizardController_preferences,this)}return this.stepsView};b.prototype.setStep=function(c){if(c!==this.step){var d=this.step;this.step=c;this.propertyChangeSupport.firePropertyChange("STEP",d,c)}};b.prototype.getStep=function(){return this.step};b.prototype.getModel=function(){return this.model};b.prototype.setModel=function(c){if(c!==this.model){var d=this.model;this.model=c;this.propertyChangeSupport.firePropertyChange("MODEL",d,c)}};b.prototype.isBackFaceShown=function(){return this.backFaceShown};b.prototype.setBackFaceShown=function(c){if(c!==this.backFaceShown){this.backFaceShown=c;this.propertyChangeSupport.firePropertyChange("BACK_FACE_SHOWN",!c,c)}};b.prototype.getModelSize=function(){return this.modelSize};b.prototype.setModelSize=function(c){if(c!==this.modelSize){var d=this.modelSize;this.modelSize=c;this.propertyChangeSupport.firePropertyChange("MODEL_SIZE",d,c)}};b.prototype.getModelRotation=function(){return this.modelRotation};b.prototype.setModelRotation=function(c){if(c!==this.modelRotation){var d=this.modelRotation;this.modelRotation=c;this.propertyChangeSupport.firePropertyChange("MODEL_ROTATION",d,c)}};b.prototype.isEdgeColorMaterialHidden=function(){return this.edgeColorMaterialHidden};b.prototype.setEdgeColorMaterialHidden=function(c){if(c!==this.edgeColorMaterialHidden){this.edgeColorMaterialHidden=c;this.propertyChangeSupport.firePropertyChange("EDGE_COLOR_MATERIAL_HIDDEN",!c,c)}};b.prototype.getName=function(){return this.name};b.prototype.setName=function(c){if(c!==this.name){var d=this.name;this.name=c;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("NAME",d,c)}}};b.prototype.getCreator=function(){return this.creator};b.prototype.setCreator=function(d){if(d!==this.creator){var c=this.creator;this.creator=d;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("CREATOR",c,d)}}};b.prototype.getWidth=function(){return this.width};b.prototype.setWidth$float=function(c){this.setWidth$float$boolean(c,false)};b.prototype.setWidth$float$boolean=function(e,f){var d=Math.max(e,0.001);if(d===e||!f){this.proportionalWidth=e}if(d!==this.width){var c=this.width;this.width=d;this.propertyChangeSupport.firePropertyChange("WIDTH",c,d)}};b.prototype.setWidth=function(c,d){if(((typeof c==="number")||c===null)&&((typeof d==="boolean")||d===null)){return this.setWidth$float$boolean(c,d)}else{if(((typeof c==="number")||c===null)&&d===undefined){return this.setWidth$float(c)}else{throw new Error("invalid overload")}}};b.prototype.getDepth=function(){return this.depth};b.prototype.setDepth$float=function(c){this.setDepth$float$boolean(c,false)};b.prototype.setDepth$float$boolean=function(f,e){var d=Math.max(f,0.001);if(d===f||!e){this.proportionalDepth=f}if(d!==this.depth){var c=this.depth;this.depth=d;this.propertyChangeSupport.firePropertyChange("DEPTH",c,d)}};b.prototype.setDepth=function(d,c){if(((typeof d==="number")||d===null)&&((typeof c==="boolean")||c===null)){return this.setDepth$float$boolean(d,c)}else{if(((typeof d==="number")||d===null)&&c===undefined){return this.setDepth$float(d)}else{throw new Error("invalid overload")}}};b.prototype.getHeight=function(){return this.height};b.prototype.setHeight$float=function(c){this.setHeight$float$boolean(c,false)};b.prototype.setHeight$float$boolean=function(c,d){var e=Math.max(c,0.001);if(e===c||!d){this.proportionalHeight=c}if(e!==this.height){var f=this.height;this.height=e;this.propertyChangeSupport.firePropertyChange("HEIGHT",f,e)}};b.prototype.setHeight=function(c,d){if(((typeof c==="number")||c===null)&&((typeof d==="boolean")||d===null)){return this.setHeight$float$boolean(c,d)}else{if(((typeof c==="number")||c===null)&&d===undefined){return this.setHeight$float(c)}else{throw new Error("invalid overload")}}};b.prototype.getElevation=function(){return this.elevation};b.prototype.setElevation=function(d){if(d!==this.elevation){var c=this.elevation;this.elevation=d;this.propertyChangeSupport.firePropertyChange("ELEVATION",c,d)}};b.prototype.isMovable=function(){return this.movable};b.prototype.setMovable=function(c){if(c!==this.movable){this.movable=c;this.propertyChangeSupport.firePropertyChange("MOVABLE",!c,c)}};b.prototype.isDoorOrWindow=function(){return this.doorOrWindow};b.prototype.setDoorOrWindow=function(c){if(c!==this.doorOrWindow){this.doorOrWindow=c;this.propertyChangeSupport.firePropertyChange("DOOR_OR_WINDOW",!c,c);if(c){this.setStaircaseCutOutShape(null);this.setMovable(false)}}};b.prototype.getStaircaseCutOutShape=function(){return this.staircaseCutOutShape};b.prototype.setStaircaseCutOutShape=function(d){if(d!==this.staircaseCutOutShape){var c=this.staircaseCutOutShape;this.staircaseCutOutShape=d;if(this.propertyChangeSupport!=null){this.propertyChangeSupport.firePropertyChange("STAIRCASE_CUT_OUT_SHAPE",c,d)}if(this.staircaseCutOutShape!=null){this.setDoorOrWindow(false);this.setMovable(false)}}};b.prototype.getColor=function(){return this.color};b.prototype.setColor=function(c){if(c!==this.color){var d=this.color;this.color=c;this.propertyChangeSupport.firePropertyChange("COLOR",d,c)}};b.prototype.getCategory=function(){return this.category};b.prototype.setCategory=function(d){if(d!==this.category){var c=this.category;this.category=d;this.propertyChangeSupport.firePropertyChange("CATEGORY",c,d)}};b.prototype.getIcon=function(){return this.getStepsView().getIcon()};b.prototype.getIconYaw=function(){return this.iconYaw};b.prototype.setIconYaw=function(c){if(c!==this.iconYaw){var d=this.iconYaw;this.iconYaw=c;this.propertyChangeSupport.firePropertyChange("ICON_YAW",d,c)}};b.prototype.getIconPitch=function(){return this.iconPitch};b.prototype.setIconPitch=function(c){if(c!==this.iconPitch){var d=this.iconPitch;this.iconPitch=c;this.propertyChangeSupport.firePropertyChange("ICON_PITCH",d,c)}};b.prototype.getIconScale=function(){return this.iconScale};b.prototype.setIconScale=function(c){if(c!==this.iconScale){var d=this.iconScale;this.iconScale=c;this.propertyChangeSupport.firePropertyChange("ICON_SCALE",d,c)}};b.prototype.isProportional=function(){return this.proportional};b.prototype.setProportional=function(c){if(c!==this.proportional){this.proportional=c;this.propertyChangeSupport.firePropertyChange("PROPORTIONAL",!c,c)}};b.prototype.isPieceOfFurnitureNameValid=function(){return this.name!=null&&this.name.length>0};return b}(WizardController));ImportedFurnitureWizardController.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController";ImportedFurnitureWizardController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(h){var c;(function(j){j[j.MODEL=0]="MODEL";j[j.ROTATION=1]="ROTATION";j[j.ATTRIBUTES=2]="ATTRIBUTES";j[j.ICON=3]="ICON"})(c=h.Step||(h.Step={}));var f=(function(j){__extends(k,j);function k(r,m,l,p,q,n,o){var s=j.call(this,m,h,"undoImportFurnitureName")||this;if(s.home===undefined){s.home=null}if(s.oldSelection===undefined){s.oldSelection=null}if(s.oldBasePlanLocked===undefined){s.oldBasePlanLocked=false}if(s.oldAllLevelsSelection===undefined){s.oldAllLevelsSelection=false}if(s.piece===undefined){s.piece=null}if(s.pieceIndex===undefined){s.pieceIndex=0}s.home=r;s.oldSelection=l;s.oldBasePlanLocked=p;s.oldAllLevelsSelection=q;s.piece=n;s.pieceIndex=o;return s}k.prototype.undo=function(){j.prototype.undo.call(this);this.home.deletePieceOfFurniture(this.piece);this.home.setSelectedItems(this.oldSelection.slice(0));this.home.setAllLevelsSelection(this.oldAllLevelsSelection);this.home.setBasePlanLocked(this.oldBasePlanLocked)};k.prototype.redo=function(){j.prototype.redo.call(this);this.home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(this.piece,this.pieceIndex);this.home.setSelectedItems([this.piece]);if(!this.piece.isMovable()&&this.oldBasePlanLocked){this.home.setBasePlanLocked(false)}this.home.setAllLevelsSelection(false)};return k}(LocalizedUndoableEdit));h.PieceOfFurnitureImportationUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.PieceOfFurnitureImportationUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var d=(function(k){__extends(j,k);function j(l){var m=k.call(this)||this;m.__parent=l;m.icon="resources/importedFurnitureWizard.png";return m}j.prototype.enter=function(){this.__parent.setStep(this.getStep())};j.prototype.getView=function(){return this.__parent.getStepsView()};j.prototype.getIcon=function(){return this.icon};return j}(WizardController.WizardControllerStepState));h.ImportedFurnitureWizardStepState=d;d.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.ImportedFurnitureWizardStepState";var g=(function(j){__extends(k,j);function k(l){var m=j.call(this,l)||this;m.__parent=l;m.modelChangeListener=new k.FurnitureModelStepState$0(m);return m}k.prototype.enter=function(){j.prototype.enter.call(this);this.setFirstStep(true);this.setNextStepEnabled(this.__parent.getModel()!=null);this.__parent.addPropertyChangeListener("MODEL",this.modelChangeListener)};k.prototype.getStep=function(){return h.Step.MODEL};k.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureOrientationStepState())};k.prototype.exit=function(){this.__parent.removePropertyChangeListener("MODEL",this.modelChangeListener)};return k}(h.ImportedFurnitureWizardStepState));h.FurnitureModelStepState=g;g.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureModelStepState";(function(k){var j=(function(){function l(m){this.__parent=m}l.prototype.propertyChange=function(m){this.__parent.setNextStepEnabled(this.__parent.__parent.getModel()!=null)};return l}());k.FurnitureModelStepState$0=j})(g=h.FurnitureModelStepState||(h.FurnitureModelStepState={}));var b=(function(k){__extends(j,k);function j(l){var m=k.call(this,l)||this;m.__parent=l;return m}j.prototype.enter=function(){k.prototype.enter.call(this);this.setNextStepEnabled(true)};j.prototype.getStep=function(){return h.Step.ROTATION};j.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureModelStepState())};j.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureAttributesStepState())};return j}(h.ImportedFurnitureWizardStepState));h.FurnitureOrientationStepState=b;b.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureOrientationStepState";var e=(function(j){__extends(k,j);function k(l){var m=j.call(this,l)||this;m.__parent=l;m.widthChangeListener=new k.FurnitureAttributesStepState$0(m);m.depthChangeListener=new k.FurnitureAttributesStepState$1(m);m.heightChangeListener=new k.FurnitureAttributesStepState$2(m);m.nameAndCategoryChangeListener=new k.FurnitureAttributesStepState$3(m);return m}k.prototype.enter=function(){j.prototype.enter.call(this);this.__parent.addPropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.addPropertyChangeListener("DEPTH",this.depthChangeListener);this.__parent.addPropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.addPropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.addPropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener);this.checkPieceOfFurnitureNameInCategory()};k.prototype.checkPieceOfFurnitureNameInCategory=function(){this.setNextStepEnabled(this.__parent.isPieceOfFurnitureNameValid())};k.prototype.getStep=function(){return h.Step.ATTRIBUTES};k.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureOrientationStepState())};k.prototype.goToNextStep=function(){this.__parent.setStepState(this.__parent.getFurnitureIconStepState())};k.prototype.exit=function(){this.__parent.removePropertyChangeListener("WIDTH",this.widthChangeListener);this.__parent.removePropertyChangeListener("DEPTH",this.depthChangeListener);this.__parent.removePropertyChangeListener("HEIGHT",this.heightChangeListener);this.__parent.removePropertyChangeListener("NAME",this.nameAndCategoryChangeListener);this.__parent.removePropertyChangeListener("CATEGORY",this.nameAndCategoryChangeListener)};return k}(h.ImportedFurnitureWizardStepState));h.FurnitureAttributesStepState=e;e.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureAttributesStepState";(function(m){var l=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(q){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("DEPTH",this.__parent.depthChangeListener);this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var p=q.getNewValue()/q.getOldValue();this.__parent.__parent.setDepth(this.__parent.__parent.proportionalDepth*p,true);this.__parent.__parent.setHeight(this.__parent.__parent.proportionalHeight*p,true);this.__parent.__parent.addPropertyChangeListener("DEPTH",this.__parent.depthChangeListener);this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)}};return o}());m.FurnitureAttributesStepState$0=l;var k=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(q){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.removePropertyChangeListener("HEIGHT",this.__parent.heightChangeListener);var p=q.getNewValue()/q.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.proportionalWidth*p,true);this.__parent.__parent.setHeight(this.__parent.__parent.proportionalHeight*p,true);this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.addPropertyChangeListener("HEIGHT",this.__parent.heightChangeListener)}};return o}());m.FurnitureAttributesStepState$1=k;var j=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(q){if(this.__parent.__parent.isProportional()){this.__parent.__parent.removePropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.removePropertyChangeListener("DEPTH",this.__parent.depthChangeListener);var p=q.getNewValue()/q.getOldValue();this.__parent.__parent.setWidth(this.__parent.__parent.proportionalWidth*p,true);this.__parent.__parent.setDepth(this.__parent.__parent.proportionalDepth*p,true);this.__parent.__parent.addPropertyChangeListener("WIDTH",this.__parent.widthChangeListener);this.__parent.__parent.addPropertyChangeListener("DEPTH",this.__parent.depthChangeListener)}};return o}());m.FurnitureAttributesStepState$2=j;var n=(function(){function o(p){this.__parent=p}o.prototype.propertyChange=function(p){this.__parent.checkPieceOfFurnitureNameInCategory()};return o}());m.FurnitureAttributesStepState$3=n})(e=h.FurnitureAttributesStepState||(h.FurnitureAttributesStepState={}));var a=(function(k){__extends(j,k);function j(l){var m=k.call(this,l)||this;m.__parent=l;return m}j.prototype.enter=function(){k.prototype.enter.call(this);this.setLastStep(true);this.setNextStepEnabled(true)};j.prototype.getStep=function(){return h.Step.ICON};j.prototype.goBackToPreviousStep=function(){this.__parent.setStepState(this.__parent.getFurnitureAttributesStepState())};return j}(h.ImportedFurnitureWizardStepState));h.FurnitureIconStepState=a;a.__class="com.eteks.sweethome3d.viewcontroller.ImportedFurnitureWizardController.FurnitureIconStepState"})(ImportedFurnitureWizardController||(ImportedFurnitureWizardController={}));var PageSetupController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.pageSetupView===undefined){this.pageSetupView=null}if(this.print===undefined){this.print=null}this.home=e;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.setPrint(e.getPrint())}a.prototype.getView=function(){if(this.pageSetupView==null){this.pageSetupView=this.viewFactory.createPageSetupView(this.preferences,this)}return this.pageSetupView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setPrint=function(b){if(b!==this.print){var c=this.print;this.print=b;this.propertyChangeSupport.firePropertyChange("PRINT",c,b)}};a.prototype.getPrint=function(){return this.print};a.prototype.getPrintableLevels=function(){return this.home.getLevels()};a.prototype.modifyPageSetup=function(){var b=this.home.getPrint();var d=this.getPrint();this.home.setPrint(d);var c=new a.HomePrintModificationUndoableEdit(this.home,this.preferences,b,d);this.undoSupport.postEdit(c)};return a}());PageSetupController.__class="com.eteks.sweethome3d.viewcontroller.PageSetupController";PageSetupController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var b=(function(d){__extends(c,d);function c(h,f,e,g){var j=d.call(this,f,a,"undoPageSetupName")||this;if(j.home===undefined){j.home=null}if(j.oldHomePrint===undefined){j.oldHomePrint=null}if(j.homePrint===undefined){j.homePrint=null}j.home=h;j.oldHomePrint=e;j.homePrint=g;return j}c.prototype.undo=function(){d.prototype.undo.call(this);this.home.setPrint(this.oldHomePrint)};c.prototype.redo=function(){d.prototype.redo.call(this);this.home.setPrint(this.homePrint)};return c}(LocalizedUndoableEdit));a.HomePrintModificationUndoableEdit=b;b.__class="com.eteks.sweethome3d.viewcontroller.PageSetupController.HomePrintModificationUndoableEdit";b.__interfaces=["javax.swing.undo.UndoableEdit"]})(PageSetupController||(PageSetupController={}));var LevelController=(function(){function a(e,c,b,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.homeLevelView===undefined){this.homeLevelView=null}if(this.name===undefined){this.name=null}if(this.viewable===undefined){this.viewable=null}if(this.elevation===undefined){this.elevation=null}if(this.elevationIndex===undefined){this.elevationIndex=null}if(this.floorThickness===undefined){this.floorThickness=null}if(this.height===undefined){this.height=null}if(this.levels===undefined){this.levels=null}if(this.selectedLevelIndex===undefined){this.selectedLevelIndex=null}this.home=e;this.preferences=c;this.viewFactory=b;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getView=function(){if(this.homeLevelView==null){this.homeLevelView=this.viewFactory.createLevelView(this.preferences,this)}return this.homeLevelView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var b=this.home.getSelectedLevel();this.setLevels(this.clone((function(d,c){if(d.length>=c.length){d.length=0;d.push.apply(d,c);return d}else{return c.slice(0)}})([],this.home.getLevels())));if(b==null){this.setSelectedLevelIndex(null);this.setName(null);this.setViewable(true);this.setElevation(null,false);this.setFloorThickness(null);this.setHeight(null);this.setElevationIndex(null,false)}else{this.setSelectedLevelIndex(this.home.getLevels().indexOf(b));this.setName(b.getName());this.setViewable(b.isViewable());this.setElevation(b.getElevation(),false);this.setFloorThickness(b.getFloorThickness());this.setHeight(b.getHeight());this.setElevationIndex(b.getElevationIndex(),false)}};a.prototype.clone=function(c){for(var b=0;b<c.length;b++){c[b]=(function(e){if(e.clone!=undefined){return e.clone()}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(c[b])}return c};a.prototype.isPropertyEditable=function(b){return true};a.prototype.setName=function(b){if(b!==this.name){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b);if(this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setName(b);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getName=function(){return this.name};a.prototype.setViewable=function(b){if(b!==this.viewable){var c=b;this.viewable=b;this.propertyChangeSupport.firePropertyChange("VIEWABLE",c,b);if(b!=null&&this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setViewable(b);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getViewable=function(){return this.viewable};a.prototype.setElevation=function(e,d){if(d===void 0){d=true}if(e!==this.elevation){var c=this.elevation;this.elevation=e;this.propertyChangeSupport.firePropertyChange("ELEVATION",c,e);if(d&&e!=null&&this.selectedLevelIndex!=null){var b=a.updateLevelElevation(this.levels[this.selectedLevelIndex],e,this.levels.slice(0));this.setElevationIndex(b,false);this.updateLevels()}}};a.updateLevelElevation=function(h,e,f){var g=f.length;var c=0;for(var d=0;d<f.length;d++){var b=f[d];if(b===h){g=d}else{if(b.getElevation()===e){c=b.getElevationIndex()+1}else{if(d>g&&b.getElevation()===h.getElevation()){b.setElevationIndex(b.getElevationIndex()-1)}}}}h.setElevation(e);h.setElevationIndex(c);return c};a.prototype.getElevation=function(){return this.elevation};a.prototype.setElevationIndex=function(b,c){if(c===void 0){c=true}if(b!==this.elevationIndex){var d=this.elevationIndex;this.elevationIndex=b;this.propertyChangeSupport.firePropertyChange("ELEVATION_INDEX",d,b);if(c&&b!=null&&this.selectedLevelIndex!=null){a.updateLevelElevationIndex(this.levels[this.selectedLevelIndex],b,this.levels.slice(0));this.updateLevels()}}};a.updateLevelElevationIndex=function(g,c,f){var d=(function(h){if(h>0){return 1}else{if(h<0){return -1}else{return 0}}})(c-g.getElevationIndex());for(var e=0;e<f.length;e++){var b=f[e];if(b!==g&&b.getElevation()===g.getElevation()&&(function(h){if(h>0){return 1}else{if(h<0){return -1}else{return 0}}})(b.getElevationIndex()-g.getElevationIndex())===d&&(function(h){if(h>0){return 1}else{if(h<0){return -1}else{return 0}}})(b.getElevationIndex()-c)!==d){b.setElevationIndex(b.getElevationIndex()-(d|0))}else{if(b.getElevation()>g.getElevation()){break}}}g.setElevationIndex(c)};a.prototype.updateLevels=function(){var f=new Home();var e=this.levels[this.selectedLevelIndex];for(var c=0;c<this.levels.length;c++){var b=this.levels[c];f.addLevel(b)}var d=f.getLevels();this.setLevels(d.slice(0));this.setSelectedLevelIndex(d.indexOf(e))};a.prototype.getElevationIndex=function(){return this.elevationIndex};a.prototype.setFloorThickness=function(c){if(c!==this.floorThickness){var b=this.floorThickness;this.floorThickness=c;this.propertyChangeSupport.firePropertyChange("FLOOR_THICKNESS",b,c);if(c!=null&&this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setFloorThickness(c);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getFloorThickness=function(){return this.floorThickness};a.prototype.setHeight=function(b){if(b!==this.height){var c=this.height;this.height=b;this.propertyChangeSupport.firePropertyChange("HEIGHT",c,b);if(b!=null&&this.selectedLevelIndex!=null){this.levels[this.selectedLevelIndex].setHeight(b);this.propertyChangeSupport.firePropertyChange("LEVELS",null,this.levels)}}};a.prototype.getHeight=function(){return this.height};a.prototype.setLevels=function(c){if(c!==this.levels){var b=this.levels;this.levels=c;this.propertyChangeSupport.firePropertyChange("LEVELS",b,c)}};a.prototype.getLevels=function(){return this.levels.slice(0)};a.prototype.setSelectedLevelIndex=function(c){if(c!==this.selectedLevelIndex){var b=this.selectedLevelIndex;this.selectedLevelIndex=c;this.propertyChangeSupport.firePropertyChange("SELECT_LEVEL_INDEX",b,c)}};a.prototype.getSelectedLevelIndex=function(){return this.selectedLevelIndex};a.prototype.modifyLevels=function(){var g=this.home.getSelectedLevel();if(g!=null){var b=this.home.getSelectedItems();var h=this.getName();var d=this.getViewable();var j=this.getElevation();var e=this.getFloorThickness();var k=this.getHeight();var f=this.getElevationIndex();var l=new a.ModifiedLevel(g);a.doModifyLevel(this.home,l,h,d,j,e,k,f);if(this.undoSupport!=null){var c=new a.LevelModificationUndoableEdit(this.home,this.preferences,b.slice(0),l,h,d,j,e,k,f);this.undoSupport.postEdit(c)}if(h!=null){this.preferences.addAutoCompletionString("LevelName",h)}}};a.doModifyLevel=function(l,q,c,f,o,g,p,j){var b=q.getLevel();if(c!=null){b.setName(c)}if(f!=null){var e=l.getSelectedItems();b.setViewable(f);l.setSelectedItems(a.getViewableSublist(e))}if(o!=null&&o!==b.getElevation()){a.updateLevelElevation(b,o,l.getLevels())}if(j!=null){a.updateLevelElevationIndex(b,j,l.getLevels())}if(!l.getEnvironment().isAllLevelsVisible()){var m=l.getSelectedLevel();var d=true;var k=l.getLevels();for(var h=0;h<k.length;h++){var n=k[h];n.setVisible(d);if(n===m){d=false}}}if(g!=null){b.setFloorThickness(g)}if(p!=null){b.setHeight(p)}};a.getViewableSublist=function(b){var e=([]);for(var c=0;c<b.length;c++){var d=b[c];if(!(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))||d.getLevel().isViewable()){(e.push(d)>0)}}return e};a.undoModifyLevel=function(c,b){b.reset();var d=b.getLevel();if(b.getElevation()!==d.getElevation()){a.updateLevelElevation(d,b.getElevation(),c.getLevels())}if(b.getElevationIndex()!==d.getElevationIndex()){a.updateLevelElevationIndex(d,b.getElevationIndex(),c.getLevels())}};return a}());LevelController.__class="com.eteks.sweethome3d.viewcontroller.LevelController";LevelController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var c=(function(e){__extends(d,e);function d(n,k,f,q,g,h,p,j,o,m){var l=e.call(this,k,a,"undoModifyLevelName")||this;if(l.home===undefined){l.home=null}if(l.oldSelection===undefined){l.oldSelection=null}if(l.modifiedLevel===undefined){l.modifiedLevel=null}if(l.name===undefined){l.name=null}if(l.viewable===undefined){l.viewable=null}if(l.elevation===undefined){l.elevation=null}if(l.floorThickness===undefined){l.floorThickness=null}if(l.height===undefined){l.height=null}if(l.elevationIndex===undefined){l.elevationIndex=null}l.home=n;l.oldSelection=f;l.modifiedLevel=q;l.name=g;l.viewable=h;l.elevation=p;l.floorThickness=j;l.height=o;l.elevationIndex=m;return l}d.prototype.undo=function(){e.prototype.undo.call(this);a.undoModifyLevel(this.home,this.modifiedLevel);this.home.setSelectedLevel(this.modifiedLevel.getLevel());this.home.setSelectedItems(this.oldSelection.slice(0))};d.prototype.redo=function(){e.prototype.redo.call(this);this.home.setSelectedLevel(this.modifiedLevel.getLevel());a.doModifyLevel(this.home,this.modifiedLevel,this.name,this.viewable,this.elevation,this.floorThickness,this.height,this.elevationIndex)};return d}(LocalizedUndoableEdit));a.LevelModificationUndoableEdit=c;c.__class="com.eteks.sweethome3d.viewcontroller.LevelController.LevelModificationUndoableEdit";c.__interfaces=["javax.swing.undo.UndoableEdit"];var b=(function(){function d(e){if(this.level===undefined){this.level=null}if(this.name===undefined){this.name=null}if(this.viewable===undefined){this.viewable=false}if(this.elevation===undefined){this.elevation=0}if(this.floorThickness===undefined){this.floorThickness=0}if(this.height===undefined){this.height=0}if(this.elevationIndex===undefined){this.elevationIndex=0}this.level=e;this.name=e.getName();this.viewable=e.isViewable();this.elevation=e.getElevation();this.floorThickness=e.getFloorThickness();this.height=e.getHeight();this.elevationIndex=e.getElevationIndex()}d.prototype.getLevel=function(){return this.level};d.prototype.getElevation=function(){return this.elevation};d.prototype.getElevationIndex=function(){return this.elevationIndex};d.prototype.reset=function(){this.level.setName(this.name);this.level.setViewable(this.viewable);this.level.setFloorThickness(this.floorThickness);this.level.setHeight(this.height)};return d}());a.ModifiedLevel=b;b.__class="com.eteks.sweethome3d.viewcontroller.LevelController.ModifiedLevel"})(LevelController||(LevelController={}));var WallController=(function(){function a(f,c,b,e,d){if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.leftSideTextureController===undefined){this.leftSideTextureController=null}if(this.leftSideBaseboardController===undefined){this.leftSideBaseboardController=null}if(this.rightSideTextureController===undefined){this.rightSideTextureController=null}if(this.rightSideBaseboardController===undefined){this.rightSideBaseboardController=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.wallView===undefined){this.wallView=null}if(this.editablePoints===undefined){this.editablePoints=false}if(this.xStart===undefined){this.xStart=null}if(this.yStart===undefined){this.yStart=null}if(this.xEnd===undefined){this.xEnd=null}if(this.yEnd===undefined){this.yEnd=null}if(this.length===undefined){this.length=null}if(this.distanceToEndPoint===undefined){this.distanceToEndPoint=null}if(this.leftSideColor===undefined){this.leftSideColor=null}if(this.leftSidePaint===undefined){this.leftSidePaint=null}if(this.leftSideShininess===undefined){this.leftSideShininess=null}if(this.rightSideColor===undefined){this.rightSideColor=null}if(this.rightSidePaint===undefined){this.rightSidePaint=null}if(this.rightSideShininess===undefined){this.rightSideShininess=null}if(this.pattern===undefined){this.pattern=null}if(this.topColor===undefined){this.topColor=null}if(this.topPaint===undefined){this.topPaint=null}if(this.shape===undefined){this.shape=null}if(this.rectangularWallHeight===undefined){this.rectangularWallHeight=null}if(this.slopingWallHeightAtStart===undefined){this.slopingWallHeightAtStart=null}if(this.sloppingWallHeightAtEnd===undefined){this.sloppingWallHeightAtEnd=null}if(this.thickness===undefined){this.thickness=null}if(this.arcExtentInDegrees===undefined){this.arcExtentInDegrees=null}this.home=f;this.preferences=c;this.viewFactory=b;this.contentManager=e;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}a.prototype.getLeftSideTextureController=function(){if(this.leftSideTextureController==null){this.leftSideTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"leftSideTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.leftSideTextureController.addPropertyChangeListener("TEXTURE",new a.WallController$0(this))}return this.leftSideTextureController};a.prototype.getLeftSideBaseboardController=function(){if(this.leftSideBaseboardController==null){this.leftSideBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)}return this.leftSideBaseboardController};a.prototype.getRightSideTextureController=function(){if(this.rightSideTextureController==null){this.rightSideTextureController=new TextureChoiceController(this.preferences.getLocalizedString(a,"rightSideTextureTitle"),this.preferences,this.viewFactory,this.contentManager);this.rightSideTextureController.addPropertyChangeListener("TEXTURE",new a.WallController$1(this))}return this.rightSideTextureController};a.prototype.getRightSideBaseboardController=function(){if(this.rightSideBaseboardController==null){this.rightSideBaseboardController=new BaseboardChoiceController(this.preferences,this.viewFactory,this.contentManager)}return this.rightSideBaseboardController};a.prototype.getView=function(){if(this.wallView==null){this.wallView=this.viewFactory.createWallView(this.preferences,this)}return this.wallView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.updateProperties=function(){var v=Home.getWallsSubList(this.home.getSelectedItems());if((v.length==0)){this.setXStart(null);this.setYStart(null);this.setXEnd(null);this.setYEnd(null);this.setEditablePoints(false);this.setLeftSideColor(null);this.getLeftSideTextureController().setTexture(null);this.setLeftSidePaint(null);this.setLeftSideShininess(null);this.getLeftSideBaseboardController().setVisible(null);this.getLeftSideBaseboardController().setThickness(null);this.getLeftSideBaseboardController().setHeight(null);this.getLeftSideBaseboardController().setColor(null);this.getLeftSideBaseboardController().getTextureController().setTexture(null);this.getLeftSideBaseboardController().setPaint(null);this.setRightSideColor(null);this.getRightSideTextureController().setTexture(null);this.setRightSidePaint(null);this.setRightSideShininess(null);this.getRightSideBaseboardController().setVisible(null);this.getRightSideBaseboardController().setThickness(null);this.getRightSideBaseboardController().setHeight(null);this.getRightSideBaseboardController().setColor(null);this.getRightSideBaseboardController().getTextureController().setTexture(null);this.getRightSideBaseboardController().setPaint(null);this.setPattern(null);this.setTopColor(null);this.setTopPaint(null);this.setRectangularWallHeight(null);this.setSlopingWallHeightAtStart(null);this.setSlopingWallHeightAtEnd(null);this.setShape(null);this.setThickness(null);this.setArcExtentInDegrees(null)}else{var G=v[0];var K=v.length>1;this.setEditablePoints(!K);var o=G.getXStart();for(var P=1;P<v.length;P++){if(!(o===v[P].getXStart())){o=null;break}}this.setXStart(o);var H=G.getYStart();for(var P=1;P<v.length;P++){if(!(H===v[P].getYStart())){H=null;break}}this.setYStart(H);var w=G.getXEnd();for(var P=1;P<v.length;P++){if(!(w===v[P].getXEnd())){w=null;break}}this.setXEnd(w);var J=G.getYEnd();for(var P=1;P<v.length;P++){if(!(J===v[P].getYEnd())){J=null;break}}this.setYEnd(J);var c=G.getLeftSideColor();if(c!=null){for(var P=1;P<v.length;P++){if(!(c===v[P].getLeftSideColor())){c=null;break}}}this.setLeftSideColor(c);var C=G.getLeftSideTexture();if(C!=null){for(var P=1;P<v.length;P++){if(!C.equals(v[P].getLeftSideTexture())){C=null;break}}}this.getLeftSideTextureController().setTexture(C);var O=true;for(var P=0;P<v.length;P++){var r=v[P];if(r.getLeftSideColor()!=null||r.getLeftSideTexture()!=null){O=false;break}}if(c!=null){this.setLeftSidePaint(a.WallPaint.COLORED)}else{if(C!=null){this.setLeftSidePaint(a.WallPaint.TEXTURED)}else{if(O){this.setLeftSidePaint(a.WallPaint.DEFAULT)}else{this.setLeftSidePaint(null)}}}var g=G.getLeftSideShininess();for(var P=1;P<v.length;P++){if(!(g===v[P].getLeftSideShininess())){g=null;break}}this.setLeftSideShininess(g);var F=G.getLeftSideBaseboard()!=null;for(var P=1;P<v.length;P++){if(F!==(v[P].getLeftSideBaseboard()!=null)){F=null;break}}this.getLeftSideBaseboardController().setVisible(F);var s=G.getLeftSideBaseboard();var E=s!=null?s.getThickness():this.preferences.getNewWallBaseboardThickness();for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(!(E===(d!=null?d.getThickness():this.preferences.getNewWallBaseboardThickness()))){E=null;break}}this.getLeftSideBaseboardController().setThickness(E);var z=s!=null?s.getHeight():this.preferences.getNewWallBaseboardHeight();for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(!(z===(d!=null?d.getHeight():this.preferences.getNewWallBaseboardHeight()))){z=null;break}}this.getLeftSideBaseboardController().setHeight(z);var M=s!=null?s.getColor():null;if(M!=null){for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(d==null||!(M===d.getColor())){M=null;break}}}this.getLeftSideBaseboardController().setColor(M);var D=s!=null?s.getTexture():null;if(D!=null){for(var P=1;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(d==null||!D.equals(d.getTexture())){D=null;break}}}this.getLeftSideBaseboardController().getTextureController().setTexture(D);O=true;for(var P=0;P<v.length;P++){var d=v[P].getLeftSideBaseboard();if(d!=null&&(d.getColor()!=null||d.getTexture()!=null)){O=false;break}}if(M!=null){this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED)}else{if(D!=null){this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED)}else{if(O){this.getLeftSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT)}else{this.getLeftSideBaseboardController().setPaint(null)}}}var b=G.getRightSideColor();if(b!=null){for(var P=1;P<v.length;P++){if(!(b===v[P].getRightSideColor())){b=null;break}}}this.setRightSideColor(b);var m=G.getRightSideTexture();if(m!=null){for(var P=1;P<v.length;P++){if(!m.equals(v[P].getRightSideTexture())){m=null;break}}}this.getRightSideTextureController().setTexture(m);O=true;for(var P=0;P<v.length;P++){var r=v[P];if(r.getRightSideColor()!=null||r.getRightSideTexture()!=null){O=false;break}}if(b!=null){this.setRightSidePaint(a.WallPaint.COLORED)}else{if(m!=null){this.setRightSidePaint(a.WallPaint.TEXTURED)}else{if(O){this.setRightSidePaint(a.WallPaint.DEFAULT)}else{this.setRightSidePaint(null)}}}var N=G.getRightSideShininess();for(var P=1;P<v.length;P++){if(!(N===v[P].getRightSideShininess())){N=null;break}}this.setRightSideShininess(N);var q=G.getRightSideBaseboard()!=null;for(var P=1;P<v.length;P++){if(q!==(v[P].getRightSideBaseboard()!=null)){q=null;break}}this.getRightSideBaseboardController().setVisible(q);var I=G.getRightSideBaseboard();var j=I!=null?I.getThickness():this.preferences.getNewWallBaseboardThickness();for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(!(j===(d!=null?d.getThickness():this.preferences.getNewWallBaseboardThickness()))){j=null;break}}this.getRightSideBaseboardController().setThickness(j);var k=I!=null?I.getHeight():this.preferences.getNewWallBaseboardHeight();for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(!(k===(d!=null?d.getHeight():this.preferences.getNewWallBaseboardHeight()))){k=null;break}}this.getRightSideBaseboardController().setHeight(k);var y=I!=null?I.getColor():null;if(y!=null){for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(d==null||!(y===d.getColor())){y=null;break}}}this.getRightSideBaseboardController().setColor(y);var l=I!=null?I.getTexture():null;if(l!=null){for(var P=1;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(d==null||!l.equals(d.getTexture())){l=null;break}}}this.getRightSideBaseboardController().getTextureController().setTexture(l);O=true;for(var P=0;P<v.length;P++){var d=v[P].getRightSideBaseboard();if(d!=null&&(d.getColor()!=null||d.getTexture()!=null)){O=false;break}}if(y!=null){this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.COLORED)}else{if(l!=null){this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.TEXTURED)}else{if(O){this.getRightSideBaseboardController().setPaint(BaseboardChoiceController.BaseboardPaint.DEFAULT)}else{this.getRightSideBaseboardController().setPaint(null)}}}var n=G.getPattern();if(n==null){n=this.preferences.getWallPattern()}for(var P=1;P<v.length;P++){var h=v[P].getPattern();if(h==null){h=this.preferences.getWallPattern()}if(!(function(R,Q){if(R&&R.equals){return R.equals(Q)}else{return R===Q}})(n,h)){n=null;break}}this.setPattern(n);var A=G.getTopColor();var B=void 0;if(A!=null){B=false;for(var P=1;P<v.length;P++){if(!(A===v[P].getTopColor())){A=null;break}}}else{B=true;for(var P=1;P<v.length;P++){if(v[P].getTopColor()!=null){B=false;break}}}this.setTopColor(A);if(B){this.setTopPaint(a.WallPaint.DEFAULT)}else{if(A!=null){this.setTopPaint(a.WallPaint.COLORED)}else{this.setTopPaint(null)}}var e=G.getHeight();if(e==null&&G.getHeight()==null){e=this.home.getWallHeight()}for(var P=1;P<v.length;P++){var r=v[P];var t=r.getHeight()==null?this.home.getWallHeight():r.getHeight();if(e!==t){e=null;break}}this.setRectangularWallHeight(e);this.setSlopingWallHeightAtStart(e);var p=G.getHeightAtEnd();if(p!=null){for(var P=1;P<v.length;P++){if(!(p===v[P].getHeightAtEnd())){p=null;break}}}this.setSlopingWallHeightAtEnd(p==null&&v.length===1?e:p);var u=!G.isTrapezoidal();var L=G.isTrapezoidal();for(var P=1;P<v.length;P++){if(!v[P].isTrapezoidal()){L=false}else{u=false}}if(u){this.setShape(a.WallShape.RECTANGULAR_WALL)}else{if(L){this.setShape(a.WallShape.SLOPING_WALL)}else{this.setShape(null)}}var x=G.getThickness();for(var P=1;P<v.length;P++){if(x!==v[P].getThickness()){x=null;break}}this.setThickness(x);var f=G.getArcExtent();if(f!=null){for(var P=1;P<v.length;P++){if(!(f===v[P].getArcExtent())){f=null;break}}}if(f!=null){this.setArcExtentInDegrees((function(Q){return Q*180/Math.PI})(f))}else{this.setArcExtentInDegrees(v.length===1?new Number(0).valueOf():null)}}};a.prototype.setXStart=function(c){if(c!==this.xStart){var b=this.xStart;this.xStart=c;this.propertyChangeSupport.firePropertyChange("X_START",b,c);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getXStart=function(){return this.xStart};a.prototype.setYStart=function(c){if(c!==this.yStart){var b=this.yStart;this.yStart=c;this.propertyChangeSupport.firePropertyChange("Y_START",b,c);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getYStart=function(){return this.yStart};a.prototype.setXEnd=function(b){if(b!==this.xEnd){var c=this.xEnd;this.xEnd=b;this.propertyChangeSupport.firePropertyChange("X_END",c,b);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getXEnd=function(){return this.xEnd};a.prototype.setYEnd=function(b){if(b!==this.yEnd){var c=this.yEnd;this.yEnd=b;this.propertyChangeSupport.firePropertyChange("Y_END",c,b);this.updateLength();this.updateDistanceToEndPoint()}};a.prototype.getYEnd=function(){return this.yEnd};a.prototype.updateLength=function(){var g=this.getXStart();var d=this.getYStart();var c=this.getXEnd();var f=this.getYEnd();if(g!=null&&d!=null&&c!=null&&f!=null){var b=new Wall(g,d,c,f,0,0);var e=this.getArcExtentInDegrees();if(e!=null){b.setArcExtent((function(h){return h*Math.PI/180})(e))}this.setLength(b.getLength(),false)}else{this.setLength(null,false)}};a.prototype.getLength=function(){return this.length};a.prototype.setLength=function(e,c){if(c===void 0){c=true}if(e!==this.length){var d=this.length;this.length=e;this.propertyChangeSupport.firePropertyChange("LENGTH",d,e);if(c){var j=this.getXStart();var f=this.getYStart();var b=this.getXEnd();var h=this.getYEnd();if(j!=null&&f!=null&&b!=null&&h!=null&&e!=null){if(this.getArcExtentInDegrees()!=null&&this.getArcExtentInDegrees()===0){var g=Math.atan2(f-h,b-j);this.setXEnd((j+e*Math.cos(g)));this.setYEnd((f-e*Math.sin(g)))}else{throw new UnsupportedOperationException("Computing end point of a round wall from its length not supported")}}else{this.setXEnd(null);this.setYEnd(null)}}}};a.prototype.updateDistanceToEndPoint=function(){var e=this.getXStart();var c=this.getYStart();var b=this.getXEnd();var d=this.getYEnd();if(e!=null&&c!=null&&b!=null&&d!=null){this.setDistanceToEndPoint(java.awt.geom.Point2D.distance(e,c,b,d),false)}else{this.setDistanceToEndPoint(null,false)}};a.prototype.setDistanceToEndPoint=function(e,c){if(c===void 0){c=true}if(e!==this.distanceToEndPoint){var d=this.distanceToEndPoint;this.distanceToEndPoint=e;this.propertyChangeSupport.firePropertyChange("DISTANCE_TO_END_POINT",d,e);if(c){var j=this.getXStart();var f=this.getYStart();var b=this.getXEnd();var h=this.getYEnd();if(j!=null&&f!=null&&b!=null&&h!=null&&e!=null){var g=Math.atan2(f-h,b-j);this.setXEnd((j+e*Math.cos(g)));this.setYEnd((f-e*Math.sin(g)))}else{this.setXEnd(null);this.setYEnd(null)}}}};a.prototype.getDistanceToEndPoint=function(){return this.distanceToEndPoint};a.prototype.setEditablePoints=function(b){if(b!==this.editablePoints){this.editablePoints=b;this.propertyChangeSupport.firePropertyChange("EDITABLE_POINTS",!b,b)}};a.prototype.isEditablePoints=function(){return this.editablePoints};a.prototype.setLeftSideColor=function(b){if(b!==this.leftSideColor){var c=this.leftSideColor;this.leftSideColor=b;this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_COLOR",c,b);this.setLeftSidePaint(a.WallPaint.COLORED)}};a.prototype.getLeftSideColor=function(){return this.leftSideColor};a.prototype.setLeftSidePaint=function(c){if(c!==this.leftSidePaint){var b=this.leftSidePaint;this.leftSidePaint=c;this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_PAINT",b,c)}};a.prototype.getLeftSidePaint=function(){return this.leftSidePaint};a.prototype.setLeftSideShininess=function(b){if(b!==this.leftSideShininess){var c=this.leftSideShininess;this.leftSideShininess=b;this.propertyChangeSupport.firePropertyChange("LEFT_SIDE_SHININESS",c,b)}};a.prototype.getLeftSideShininess=function(){return this.leftSideShininess};a.prototype.setRightSideColor=function(c){if(c!==this.rightSideColor){var b=this.rightSideColor;this.rightSideColor=c;this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_COLOR",b,c);this.setRightSidePaint(a.WallPaint.COLORED)}};a.prototype.getRightSideColor=function(){return this.rightSideColor};a.prototype.setRightSidePaint=function(b){if(b!==this.rightSidePaint){var c=this.rightSidePaint;this.rightSidePaint=b;this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_PAINT",c,b)}};a.prototype.getRightSidePaint=function(){return this.rightSidePaint};a.prototype.setRightSideShininess=function(c){if(c!==this.rightSideShininess){var b=this.rightSideShininess;this.rightSideShininess=c;this.propertyChangeSupport.firePropertyChange("RIGHT_SIDE_SHININESS",b,c)}};a.prototype.getRightSideShininess=function(){return this.rightSideShininess};a.prototype.setPattern=function(c){if(this.pattern!==c){var b=this.pattern;this.pattern=c;this.propertyChangeSupport.firePropertyChange("PATTERN",b,c)}};a.prototype.getPattern=function(){return this.pattern};a.prototype.setTopColor=function(b){if(b!==this.topColor){var c=this.topColor;this.topColor=b;this.propertyChangeSupport.firePropertyChange("TOP_COLOR",c,b)}};a.prototype.getTopColor=function(){return this.topColor};a.prototype.setTopPaint=function(c){if(c!==this.topPaint){var b=this.topPaint;this.topPaint=c;this.propertyChangeSupport.firePropertyChange("TOP_PAINT",b,c)}};a.prototype.getTopPaint=function(){return this.topPaint};a.prototype.setShape=function(c){if(c!==this.shape){var d=this.shape;this.shape=c;this.propertyChangeSupport.firePropertyChange("SHAPE",d,c);if(c===a.WallShape.RECTANGULAR_WALL){if(this.rectangularWallHeight!=null){this.getLeftSideBaseboardController().setMaxHeight(this.rectangularWallHeight);this.getRightSideBaseboardController().setMaxHeight(this.rectangularWallHeight)}}else{if(c===a.WallShape.SLOPING_WALL){if(this.slopingWallHeightAtStart!=null&&this.sloppingWallHeightAtEnd!=null){var b=Math.max(this.sloppingWallHeightAtEnd,this.slopingWallHeightAtStart);this.getLeftSideBaseboardController().setMaxHeight(b);this.getRightSideBaseboardController().setMaxHeight(b)}else{if(this.slopingWallHeightAtStart!=null){this.getLeftSideBaseboardController().setMaxHeight(this.slopingWallHeightAtStart);this.getRightSideBaseboardController().setMaxHeight(this.slopingWallHeightAtStart)}else{if(this.sloppingWallHeightAtEnd!=null){this.getLeftSideBaseboardController().setMaxHeight(this.sloppingWallHeightAtEnd);this.getRightSideBaseboardController().setMaxHeight(this.sloppingWallHeightAtEnd)}}}}}}};a.prototype.getShape=function(){return this.shape};a.prototype.setRectangularWallHeight=function(b){if(b!==this.rectangularWallHeight){var c=this.rectangularWallHeight;this.rectangularWallHeight=b;this.propertyChangeSupport.firePropertyChange("RECTANGULAR_WALL_HEIGHT",c,b);this.setShape(a.WallShape.RECTANGULAR_WALL);if(b!=null){this.getLeftSideBaseboardController().setMaxHeight(b);this.getRightSideBaseboardController().setMaxHeight(b)}}};a.prototype.getRectangularWallHeight=function(){return this.rectangularWallHeight};a.prototype.setSlopingWallHeightAtStart=function(c){if(c!==this.slopingWallHeightAtStart){var d=this.slopingWallHeightAtStart;this.slopingWallHeightAtStart=c;this.propertyChangeSupport.firePropertyChange("SLOPING_WALL_HEIGHT_AT_START",d,c);this.setShape(a.WallShape.SLOPING_WALL);if(c!=null){var b=this.sloppingWallHeightAtEnd!=null?Math.max(this.sloppingWallHeightAtEnd,c):c;b=Math.max(b,this.preferences.getLengthUnit().getMinimumLength());this.getLeftSideBaseboardController().setMaxHeight(b);this.getRightSideBaseboardController().setMaxHeight(b)}}};a.prototype.getSlopingWallHeightAtStart=function(){return this.slopingWallHeightAtStart};a.prototype.setSlopingWallHeightAtEnd=function(b){if(b!==this.sloppingWallHeightAtEnd){var d=this.sloppingWallHeightAtEnd;this.sloppingWallHeightAtEnd=b;this.propertyChangeSupport.firePropertyChange("SLOPING_WALL_HEIGHT_AT_END",d,b);this.setShape(a.WallShape.SLOPING_WALL);if(b!=null){var c=this.slopingWallHeightAtStart!=null?Math.max(this.slopingWallHeightAtStart,b):b;c=Math.max(c,this.preferences.getLengthUnit().getMinimumLength());this.getLeftSideBaseboardController().setMaxHeight(c);this.getRightSideBaseboardController().setMaxHeight(c)}}};a.prototype.getSlopingWallHeightAtEnd=function(){return this.sloppingWallHeightAtEnd};a.prototype.setThickness=function(c){if(c!==this.thickness){var b=this.thickness;this.thickness=c;this.propertyChangeSupport.firePropertyChange("THICKNESS",b,c)}};a.prototype.getThickness=function(){return this.thickness};a.prototype.setArcExtentInDegrees=function(c){if(c!==this.arcExtentInDegrees){var b=this.arcExtentInDegrees;this.arcExtentInDegrees=c;this.propertyChangeSupport.firePropertyChange("ARC_EXTENT_IN_DEGREES",b,c)}};a.prototype.getArcExtentInDegrees=function(){return this.arcExtentInDegrees};a.prototype.getArcLength=function(){var g=this.getXStart();var e=this.getYStart();var c=this.getXEnd();var f=this.getYEnd();var d=this.getArcExtentInDegrees();if(g!=null&&e!=null&&c!=null&&f!=null&&d!=null){var b=new Wall(g,e,c,f,0.00001,0);b.setArcExtent((function(h){return h*Math.PI/180})(d));return b.getLength()}else{return null}};a.prototype.modifyWalls=function(){var y=this.home.getSelectedItems();var r=Home.getWallsSubList(y);if(!(r.length==0)){var n=this.getXStart();var G=this.getYStart();var s=this.getXEnd();var I=this.getYEnd();var v=this.getLeftSidePaint();var c=v===a.WallPaint.COLORED?this.getLeftSideColor():null;var C=v===a.WallPaint.TEXTURED?this.getLeftSideTextureController().getTexture():null;var f=this.getLeftSideShininess();var F=this.getLeftSideBaseboardController().getVisible();var E=this.getLeftSideBaseboardController().getThickness();var z=this.getLeftSideBaseboardController().getHeight();var l=this.getLeftSideBaseboardController().getPaint();var J=l===BaseboardChoiceController.BaseboardPaint.COLORED?this.getLeftSideBaseboardController().getColor():null;var D=l===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getLeftSideBaseboardController().getTextureController().getTexture():null;var u=this.getRightSidePaint();var b=u===a.WallPaint.COLORED?this.getRightSideColor():null;var k=u===a.WallPaint.TEXTURED?this.getRightSideTextureController().getTexture():null;var K=this.getRightSideShininess();var p=this.getRightSideBaseboardController().getVisible();var g=this.getRightSideBaseboardController().getThickness();var h=this.getRightSideBaseboardController().getHeight();var H=this.getRightSideBaseboardController().getPaint();var x=H===BaseboardChoiceController.BaseboardPaint.COLORED?this.getRightSideBaseboardController().getColor():null;var j=H===BaseboardChoiceController.BaseboardPaint.TEXTURED?this.getRightSideBaseboardController().getTextureController().getTexture():null;var m=this.getPattern();var B=this.getTopPaint()!=null;var A=this.getTopPaint()===a.WallPaint.COLORED?this.getTopColor():null;var w=this.getThickness();var e=this.getArcExtentInDegrees();if(e!=null){e=(function(N){return N*Math.PI/180})(e)}var d=void 0;if(this.getShape()===a.WallShape.SLOPING_WALL){d=this.getSlopingWallHeightAtStart()}else{if(this.getShape()===a.WallShape.RECTANGULAR_WALL){d=this.getRectangularWallHeight()}else{d=null}}var o=void 0;if(this.getShape()===a.WallShape.SLOPING_WALL){o=this.getSlopingWallHeightAtEnd()}else{if(this.getShape()===a.WallShape.RECTANGULAR_WALL){o=this.getRectangularWallHeight()}else{o=null}}if(d!=null&&o!=null){var L=Math.max(d,o);if(z!=null){z=Math.min(z,L)}if(h!=null){h=Math.min(h,L)}}var q=(function(O){var N=[];while(O-->0){N.push(null)}return N})(r.length);for(var M=0;M<q.length;M++){q[M]=new a.ModifiedWall(r[M])}a.doModifyWalls(q,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),n,G,s,I,v,c,C,f,F,E,z,l,J,D,u,b,k,K,p,g,h,H,x,j,m,B,A,d,o,w,e);if(this.undoSupport!=null){var t=new a.WallsModificationUndoableEdit(this.home,this.preferences,y.slice(0),q,this.preferences.getNewWallBaseboardThickness(),this.preferences.getNewWallBaseboardHeight(),n,G,s,I,v,c,C,f,F,E,z,l,J,D,u,b,k,K,p,g,h,H,x,j,m,B,A,d,o,w,e);this.undoSupport.postEdit(t)}}};a.doModifyWalls=function(t,v,h,p,L,w,N,y,c,F,g,K,I,B,n,P,G,x,b,m,Q,r,j,k,M,A,l,o,E,C,e,q,z,f){for(var J=0;J<t.length;J++){var O=t[J];var s=O.getWall();a.moveWallPoints(s,p,L,w,N);if(y!=null){switch((y)){case a.WallPaint.DEFAULT:s.setLeftSideColor(null);s.setLeftSideTexture(null);break;case a.WallPaint.COLORED:if(c!=null){s.setLeftSideColor(c)}s.setLeftSideTexture(null);break;case a.WallPaint.TEXTURED:s.setLeftSideColor(null);if(F!=null){s.setLeftSideTexture(F)}break}}if(g!=null){s.setLeftSideShininess(g)}if(K===false){s.setLeftSideBaseboard(null)}else{var d=s.getLeftSideBaseboard();if(K===true||d!=null){var D=d!=null?d.getThickness():v;var H=d!=null?d.getHeight():h;var R=d!=null?d.getColor():null;var u=d!=null?d.getTexture():null;if(n!=null){switch((n)){case BaseboardChoiceController.BaseboardPaint.DEFAULT:R=null;u=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:if(P!=null){R=P}u=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:R=null;if(G!=null){u=G}break}}s.setLeftSideBaseboard(Baseboard.getInstance(I!=null?I:D,B!=null?B:H,R,u))}}if(x!=null){switch((x)){case a.WallPaint.DEFAULT:s.setRightSideColor(null);s.setRightSideTexture(null);break;case a.WallPaint.COLORED:if(b!=null){s.setRightSideColor(b)}s.setRightSideTexture(null);break;case a.WallPaint.TEXTURED:s.setRightSideColor(null);if(m!=null){s.setRightSideTexture(m)}break}}if(Q!=null){s.setRightSideShininess(Q)}if(r===false){s.setRightSideBaseboard(null)}else{var d=s.getRightSideBaseboard();if(r===true||d!=null){var D=d!=null?d.getThickness():v;var H=d!=null?d.getHeight():h;var R=d!=null?d.getColor():null;var u=d!=null?d.getTexture():null;if(M!=null){switch((M)){case BaseboardChoiceController.BaseboardPaint.DEFAULT:R=null;u=null;break;case BaseboardChoiceController.BaseboardPaint.COLORED:if(A!=null){R=A}u=null;break;case BaseboardChoiceController.BaseboardPaint.TEXTURED:R=null;if(l!=null){u=l}break}}s.setRightSideBaseboard(Baseboard.getInstance(j!=null?j:D,k!=null?k:H,R,u))}}if(o!=null){s.setPattern(o)}if(E){s.setTopColor(C)}if(e!=null){s.setHeight(e);if(q!=null){if(q===e){s.setHeightAtEnd(null)}else{s.setHeightAtEnd(q)}}}if(z!=null){s.setThickness(z)}if(f!=null){if(f===0){s.setArcExtent(null)}else{s.setArcExtent(f)}}}};a.undoModifyWalls=function(d){for(var e=0;e<d.length;e++){var c=d[e];var b=c.getWall();a.moveWallPoints(b,c.getXStart(),c.getYStart(),c.getXEnd(),c.getYEnd());b.setLeftSideColor(c.getLeftSideColor());b.setLeftSideTexture(c.getLeftSideTexture());b.setLeftSideShininess(c.getLeftSideShininess());b.setLeftSideBaseboard(c.getLeftSideBaseboard());b.setRightSideColor(c.getRightSideColor());b.setRightSideTexture(c.getRightSideTexture());b.setRightSideShininess(c.getRightSideShininess());b.setRightSideBaseboard(c.getRightSideBaseboard());b.setPattern(c.getPattern());b.setTopColor(c.getTopColor());b.setHeight(c.getHeight());b.setHeightAtEnd(c.getHeightAtEnd());b.setThickness(c.getThickness());b.setArcExtent(c.getArcExtent())}};a.moveWallPoints=function(c,g,e,b,f){var d=c.getWallAtStart();if(g!=null){c.setXStart(g);if(d!=null){if(d.getWallAtStart()===c){d.setXStart(g)}else{if(d.getWallAtEnd()===c){d.setXEnd(g)}}}}if(e!=null){c.setYStart(e);if(d!=null){if(d.getWallAtStart()===c){d.setYStart(e)}else{if(d.getWallAtEnd()===c){d.setYEnd(e)}}}}var h=c.getWallAtEnd();if(b!=null){c.setXEnd(b);if(h!=null){if(h.getWallAtStart()===c){h.setXStart(b)}else{if(h.getWallAtEnd()===c){h.setXEnd(b)}}}}if(f!=null){c.setYEnd(f);if(h!=null){if(h.getWallAtStart()===c){h.setYStart(f)}else{if(h.getWallAtEnd()===c){h.setYEnd(f)}}}}};return a}());WallController.__class="com.eteks.sweethome3d.viewcontroller.WallController";WallController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(d){var c;(function(h){h[h.RECTANGULAR_WALL=0]="RECTANGULAR_WALL";h[h.SLOPING_WALL=1]="SLOPING_WALL"})(c=d.WallShape||(d.WallShape={}));var g;(function(h){h[h.DEFAULT=0]="DEFAULT";h[h.COLORED=1]="COLORED";h[h.TEXTURED=2]="TEXTURED"})(g=d.WallPaint||(d.WallPaint={}));var b=(function(j){__extends(h,j);function h(y,M,I,B,C,p,x,R,D,T,G,l,N,o,Q,P,J,v,U,O,F,k,u,V,A,r,s,S,H,t,w,L,K,m,z,E,n){var q=j.call(this,M,d,"undoModifyWallsName")||this;if(q.home===undefined){q.home=null}if(q.oldSelection===undefined){q.oldSelection=null}if(q.modifiedWalls===undefined){q.modifiedWalls=null}if(q.newWallBaseboardThickness===undefined){q.newWallBaseboardThickness=0}if(q.newWallBaseboardHeight===undefined){q.newWallBaseboardHeight=0}if(q.xStart===undefined){q.xStart=null}if(q.yStart===undefined){q.yStart=null}if(q.xEnd===undefined){q.xEnd=null}if(q.yEnd===undefined){q.yEnd=null}if(q.leftSidePaint===undefined){q.leftSidePaint=null}if(q.leftSideColor===undefined){q.leftSideColor=null}if(q.leftSideTexture===undefined){q.leftSideTexture=null}if(q.leftSideShininess===undefined){q.leftSideShininess=null}if(q.leftSideBaseboardVisible===undefined){q.leftSideBaseboardVisible=null}if(q.leftSideBaseboardThickness===undefined){q.leftSideBaseboardThickness=null}if(q.leftSideBaseboardHeight===undefined){q.leftSideBaseboardHeight=null}if(q.leftSideBaseboardPaint===undefined){q.leftSideBaseboardPaint=null}if(q.leftSideBaseboardColor===undefined){q.leftSideBaseboardColor=null}if(q.leftSideBaseboardTexture===undefined){q.leftSideBaseboardTexture=null}if(q.rightSidePaint===undefined){q.rightSidePaint=null}if(q.rightSideColor===undefined){q.rightSideColor=null}if(q.rightSideTexture===undefined){q.rightSideTexture=null}if(q.rightSideShininess===undefined){q.rightSideShininess=null}if(q.rightSideBaseboardVisible===undefined){q.rightSideBaseboardVisible=null}if(q.rightSideBaseboardThickness===undefined){q.rightSideBaseboardThickness=null}if(q.rightSideBaseboardHeight===undefined){q.rightSideBaseboardHeight=null}if(q.rightSideBaseboardPaint===undefined){q.rightSideBaseboardPaint=null}if(q.rightSideBaseboardColor===undefined){q.rightSideBaseboardColor=null}if(q.rightSideBaseboardTexture===undefined){q.rightSideBaseboardTexture=null}if(q.pattern===undefined){q.pattern=null}if(q.modifiedTopColor===undefined){q.modifiedTopColor=false}if(q.topColor===undefined){q.topColor=null}if(q.height===undefined){q.height=null}if(q.heightAtEnd===undefined){q.heightAtEnd=null}if(q.thickness===undefined){q.thickness=null}if(q.arcExtent===undefined){q.arcExtent=null}q.home=y;q.oldSelection=I;q.modifiedWalls=B;q.newWallBaseboardThickness=C;q.newWallBaseboardHeight=p;q.xStart=x;q.yStart=R;q.xEnd=D;q.yEnd=T;q.leftSidePaint=G;q.leftSideColor=l;q.leftSideShininess=o;q.leftSideBaseboardVisible=Q;q.leftSideBaseboardThickness=P;q.leftSideBaseboardHeight=J;q.leftSideBaseboardPaint=v;q.leftSideBaseboardColor=U;q.leftSideBaseboardTexture=O;q.rightSidePaint=F;q.rightSideColor=k;q.rightSideTexture=u;q.leftSideTexture=N;q.rightSideShininess=V;q.rightSideBaseboardVisible=A;q.rightSideBaseboardThickness=r;q.rightSideBaseboardHeight=s;q.rightSideBaseboardPaint=S;q.rightSideBaseboardColor=H;q.rightSideBaseboardTexture=t;q.pattern=w;q.modifiedTopColor=L;q.topColor=K;q.height=m;q.heightAtEnd=z;q.thickness=E;q.arcExtent=n;return q}h.prototype.undo=function(){j.prototype.undo.call(this);d.undoModifyWalls(this.modifiedWalls);this.home.setSelectedItems(this.oldSelection.slice(0))};h.prototype.redo=function(){j.prototype.redo.call(this);d.doModifyWalls(this.modifiedWalls,this.newWallBaseboardThickness,this.newWallBaseboardHeight,this.xStart,this.yStart,this.xEnd,this.yEnd,this.leftSidePaint,this.leftSideColor,this.leftSideTexture,this.leftSideShininess,this.leftSideBaseboardVisible,this.leftSideBaseboardThickness,this.leftSideBaseboardHeight,this.leftSideBaseboardPaint,this.leftSideBaseboardColor,this.leftSideBaseboardTexture,this.rightSidePaint,this.rightSideColor,this.rightSideTexture,this.rightSideShininess,this.rightSideBaseboardVisible,this.rightSideBaseboardThickness,this.rightSideBaseboardHeight,this.rightSideBaseboardPaint,this.rightSideBaseboardColor,this.rightSideBaseboardTexture,this.pattern,this.modifiedTopColor,this.topColor,this.height,this.heightAtEnd,this.thickness,this.arcExtent);this.home.setSelectedItems(this.oldSelection.slice(0))};return h}(LocalizedUndoableEdit));d.WallsModificationUndoableEdit=b;b.__class="com.eteks.sweethome3d.viewcontroller.WallController.WallsModificationUndoableEdit";b.__interfaces=["javax.swing.undo.UndoableEdit"];var a=(function(){function h(j){if(this.wall===undefined){this.wall=null}if(this.xStart===undefined){this.xStart=0}if(this.yStart===undefined){this.yStart=0}if(this.xEnd===undefined){this.xEnd=0}if(this.yEnd===undefined){this.yEnd=0}if(this.leftSideColor===undefined){this.leftSideColor=null}if(this.leftSideTexture===undefined){this.leftSideTexture=null}if(this.leftSideShininess===undefined){this.leftSideShininess=0}if(this.leftSideBaseboard===undefined){this.leftSideBaseboard=null}if(this.rightSideColor===undefined){this.rightSideColor=null}if(this.rightSideTexture===undefined){this.rightSideTexture=null}if(this.rightSideShininess===undefined){this.rightSideShininess=0}if(this.rightSideBaseboard===undefined){this.rightSideBaseboard=null}if(this.pattern===undefined){this.pattern=null}if(this.topColor===undefined){this.topColor=null}if(this.height===undefined){this.height=null}if(this.heightAtEnd===undefined){this.heightAtEnd=null}if(this.thickness===undefined){this.thickness=0}if(this.arcExtent===undefined){this.arcExtent=null}this.wall=j;this.xStart=j.getXStart();this.yStart=j.getYStart();this.xEnd=j.getXEnd();this.yEnd=j.getYEnd();this.leftSideColor=j.getLeftSideColor();this.leftSideTexture=j.getLeftSideTexture();this.leftSideShininess=j.getLeftSideShininess();this.leftSideBaseboard=j.getLeftSideBaseboard();this.rightSideColor=j.getRightSideColor();this.rightSideTexture=j.getRightSideTexture();this.rightSideShininess=j.getRightSideShininess();this.rightSideBaseboard=j.getRightSideBaseboard();this.pattern=j.getPattern();this.topColor=j.getTopColor();this.height=j.getHeight();this.heightAtEnd=j.getHeightAtEnd();this.thickness=j.getThickness();this.arcExtent=j.getArcExtent()}h.prototype.getWall=function(){return this.wall};h.prototype.getXStart=function(){return this.xStart};h.prototype.getXEnd=function(){return this.xEnd};h.prototype.getYStart=function(){return this.yStart};h.prototype.getYEnd=function(){return this.yEnd};h.prototype.getHeight=function(){return this.height};h.prototype.getHeightAtEnd=function(){return this.heightAtEnd};h.prototype.getLeftSideColor=function(){return this.leftSideColor};h.prototype.getLeftSideTexture=function(){return this.leftSideTexture};h.prototype.getLeftSideShininess=function(){return this.leftSideShininess};h.prototype.getLeftSideBaseboard=function(){return this.leftSideBaseboard};h.prototype.getRightSideColor=function(){return this.rightSideColor};h.prototype.getRightSideTexture=function(){return this.rightSideTexture};h.prototype.getRightSideShininess=function(){return this.rightSideShininess};h.prototype.getRightSideBaseboard=function(){return this.rightSideBaseboard};h.prototype.getPattern=function(){return this.pattern};h.prototype.getTopColor=function(){return this.topColor};h.prototype.getThickness=function(){return this.thickness};h.prototype.getArcExtent=function(){return this.arcExtent};return h}());d.ModifiedWall=a;a.__class="com.eteks.sweethome3d.viewcontroller.WallController.ModifiedWall";var f=(function(){function h(j){this.__parent=j}h.prototype.propertyChange=function(j){this.__parent.setLeftSidePaint(d.WallPaint.TEXTURED)};return h}());d.WallController$0=f;var e=(function(){function h(j){this.__parent=j}h.prototype.propertyChange=function(j){this.__parent.setRightSidePaint(d.WallPaint.TEXTURED)};return h}());d.WallController$1=e})(WallController||(WallController={}));var FurnitureController=(function(){function a(g,d,f,h,c){if(((g!=null&&g instanceof Home)||g===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||f===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ContentManager")>=0))||h===null)&&((c!=null&&c instanceof javax.swing.undo.UndoableEditSupport)||c===null)){var e=arguments;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.furnitureView===undefined){this.furnitureView=null}if(this.leadSelectedPieceOfFurniture===undefined){this.leadSelectedPieceOfFurniture=null}this.home=g;this.preferences=d;this.viewFactory=f;this.undoSupport=c;this.contentManager=h;this.addModelListeners()}else{if(((g!=null&&g instanceof Home)||g===null)&&((d!=null&&d instanceof UserPreferences)||d===null)&&((f!=null&&(f.constructor!=null&&f.constructor.__interfaces!=null&&f.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||f===null)&&h===undefined&&c===undefined){var e=arguments;var b=arguments;var k=null;var j=null;if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.furnitureView===undefined){this.furnitureView=null}if(this.leadSelectedPieceOfFurniture===undefined){this.leadSelectedPieceOfFurniture=null}this.home=g;this.preferences=d;this.viewFactory=f;this.undoSupport=j;this.contentManager=k;this.addModelListeners();if(this.home===undefined){this.home=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.contentManager===undefined){this.contentManager=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.furnitureView===undefined){this.furnitureView=null}if(this.leadSelectedPieceOfFurniture===undefined){this.leadSelectedPieceOfFurniture=null}}else{throw new Error("invalid overload")}}}a.prototype.getView=function(){if(this.furnitureView==null){this.furnitureView=this.viewFactory.createFurnitureView(this.home,this.preferences,this)}return this.furnitureView};a.prototype.addModelListeners=function(){this.home.addSelectionListener(new a.FurnitureController$0(this));var d=new a.FurnitureController$1(this);var h=this.home.getFurniture();for(var c=0;c<h.length;c++){var e=h[c];e.addPropertyChangeListener(d);if(e!=null&&e instanceof HomeFurnitureGroup){var f=e.getAllFurniture();for(var g=0;g<f.length;g++){var b=f[g];b.addPropertyChangeListener(d)}}}this.home.addFurnitureListener(function(m){var l=m.getItem();if(m.getType()===CollectionEvent.Type.ADD){l.addPropertyChangeListener(d);if(l!=null&&l instanceof HomeFurnitureGroup){var n=l.getAllFurniture();for(var k=0;k<n.length;k++){var j=n[k];j.addPropertyChangeListener(d)}}}else{if(m.getType()===CollectionEvent.Type.DELETE){l.removePropertyChangeListener(d);if(l!=null&&l instanceof HomeFurnitureGroup){var n=l.getAllFurniture();for(var k=0;k<n.length;k++){var j=n[k];j.removePropertyChangeListener(d)}}}}})};a.prototype.addFurniture$java_util_List=function(b){this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,null,null,null)};a.prototype.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(c,b){this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(c,null,null,b)};a.prototype.addFurnitureToGroup=function(b,c){if(c==null){throw new IllegalArgumentException("Group shouldn't be null")}this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,null,c,null)};a.prototype.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(j,q,e,m){var n=this.home.isBasePlanLocked();var f=this.home.isAllLevelsSelection();var p=this.home.getSelectedItems();var d=j.slice(0);var t=(function(v){var u=[];while(v-->0){u.push(0)}return u})(j.length);var s=e==null?this.home.getFurniture().length:e.getFurniture().length;if(m!=null){var g=this.home.getFurniture();e=a.getPieceOfFurnitureGroup(m,null,g);if(e!=null){g=e.getFurniture()}s=g.indexOf(m)}var k=e!=null?(function(v){var u=[];while(v-->0){u.push(null)}return u})(j.length):null;var r=n;var l=e!=null||q==null;for(var o=0;o<t.length;o++){t[o]=s++;r=!this.isPieceOfFurniturePartOfBasePlan(d[o])&&r;if(q!=null){l=q[o]==null||l}if(k!=null){k[o]=e}}var b=l?null:q;var h=r;var c=e!=null?e.getLevel():this.home.getSelectedLevel();a.doAddFurniture(this.home,d,k,t,c,b,h,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureAdditionUndoableEdit(this.home,this.preferences,p.slice(0),n,f,d,t,k,b,c,h))}};a.prototype.addFurniture=function(d,b,e,c){if(((d!=null&&(d instanceof Array))||d===null)&&((b!=null&&b instanceof Array&&(b.length==0||b[0]==null||(b[0]!=null&&b[0] instanceof Level)))||b===null)&&((e!=null&&e instanceof HomeFurnitureGroup)||e===null)&&((c!=null&&c instanceof HomePieceOfFurniture)||c===null)){return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(d,b,e,c)}else{if(((d!=null&&(d instanceof Array))||d===null)&&((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&e===undefined&&c===undefined){return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(d,b)}else{if(((d!=null&&(d instanceof Array))||d===null)&&b===undefined&&e===undefined&&c===undefined){return this.addFurniture$java_util_List(d)}else{throw new Error("invalid overload")}}}};a.doAddFurniture=function(j,g,c,b,f,k,e,h){for(var d=0;d<b.length;d++){if(c!=null&&c[d]!=null){j.addPieceOfFurnitureToGroup(g[d],c[d],b[d]);g[d].setVisible(c[d].isVisible())}else{j.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(g[d],b[d])}g[d].setLevel(k!=null?k[d]:f)}j.setBasePlanLocked(e);j.setSelectedItems(g.slice(0));j.setAllLevelsSelection(h)};a.prototype.deleteSelection=function(){this.deleteFurniture(Home.getFurnitureSubList(this.home.getSelectedItems()))};a.prototype.deleteFurniture=function(b){var y=this.home.isBasePlanLocked();var r=this.home.isAllLevelsSelection();var w=this.home.getSelectedItems();var q=this.home.getFurniture();b=(b.slice(0));var e=([]);a.searchGroups(q,e);var v;do{v=false;for(var h=0;h<e.length;h++){var n=e[h];var l=n.getFurniture();if((function(B,C){for(var A=0;A<C.length;A++){if(B.indexOf(C[A])<0){return false}}return true})(b,l)){(function(C,E){var B=false;for(var A=0;A<E.length;A++){var D=C.indexOf(E[A]);if(D>=0){C.splice(D,1);B=true}}return B})(b,l);(b.push(n)>0);v=true}}}while((v));var t=({});var o=0;for(var h=0;h<b.length;h++){var f=b[h];if(this.isPieceOfFurnitureDeletable(f)){var n=a.getPieceOfFurnitureGroup(f,null,q);var d=(function(A,B){if(A.entries==null){A.entries=[]}for(var C=0;C<A.entries.length;C++){if(A.entries[C].key==null&&B==null||A.entries[C].key.equals!=null&&A.entries[C].key.equals(B)||A.entries[C].key===B){return A.entries[C].value}}return null})(t,n);if(d==null){d=({});(function(A,C,B){if(A.entries==null){A.entries=[]}for(var D=0;D<A.entries.length;D++){if(A.entries[D].key==null&&C==null||A.entries[D].key.equals!=null&&A.entries[D].key.equals(C)||A.entries[D].key===C){A.entries[D].value=B;return}}A.entries.push({key:C,value:B,getKey:function(){return this.key},getValue:function(){return this.value}})})(t,n,d)}if(n==null){(function(A,C,B){if(A.entries==null){A.entries=[]}for(var D=0;D<A.entries.length;D++){if(A.entries[D].key.equals!=null&&A.entries[D].key.equals(C)||A.entries[D].key===C){var E=A.entries[D].value;A.entries[D].value=B;return E}}A.entries.push({key:C,value:B,getKey:function(){return this.key},getValue:function(){return this.value}});A.entries.sort(function(G,F){return(G.key.compareTo!=null)?G.key.compareTo(F):(G.key-F.key)});return null})(d,q.indexOf(f),f)}else{(function(A,C,B){if(A.entries==null){A.entries=[]}for(var D=0;D<A.entries.length;D++){if(A.entries[D].key.equals!=null&&A.entries[D].key.equals(C)||A.entries[D].key===C){var E=A.entries[D].value;A.entries[D].value=B;return E}}A.entries.push({key:C,value:B,getKey:function(){return this.key},getValue:function(){return this.value}});A.entries.sort(function(G,F){return(G.key.compareTo!=null)?G.key.compareTo(F):(G.key-F.key)});return null})(d,n.getFurniture().indexOf(f),f)}o++}}var s=(function(B){var A=[];while(B-->0){A.push(null)}return A})(o);var j=(function(B){var A=[];while(B-->0){A.push(0)}return A})(s.length);var x=(function(B){var A=[];while(B-->0){A.push(null)}return A})(s.length);var p=(function(B){var A=[];while(B-->0){A.push(null)}return A})(s.length);var u=0;var k=(function(A){if(A.entries==null){A.entries=[]}return A.entries})(t);for(var h=0;h<k.length;h++){var m=k[h];var z=(function(A){if(A.entries==null){A.entries=[]}return A.entries})(m.getValue());for(var g=0;g<z.length;g++){var c=z[g];s[u]=c.getValue();j[u]=c.getKey();x[u]=s[u].getLevel();p[u++]=m.getKey()}}a.doDeleteFurniture(this.home,s,y,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureDeletionUndoableEdit(this.home,this.preferences,w.slice(0),y,r,s,j,p,x))}};a.doDeleteFurniture=function(g,f,b,d){for(var c=0;c<f.length;c++){var e=f[c];g.deletePieceOfFurniture(e)}g.setBasePlanLocked(b);g.setAllLevelsSelection(d)};a.searchGroups=function(e,b){for(var c=0;c<e.length;c++){var d=e[c];if(d!=null&&d instanceof HomeFurnitureGroup){(b.push(d)>0);a.searchGroups(d.getFurniture(),b)}}};a.getPieceOfFurnitureGroup=function(d,c,f){for(var b=0;b<f.length;b++){var e=f[b];if((function(j,h){if(j&&j.equals){return j.equals(h)}else{return j===h}})(e,d)){return c}else{if(e!=null&&e instanceof HomeFurnitureGroup){var g=a.getPieceOfFurnitureGroup(d,e,e.getFurniture());if(g!=null){return g}}}}return null};a.prototype.moveSelectedFurnitureBefore=function(d){var b=Home.getFurnitureSubList(this.home.getSelectedItems());if(!(b.length==0)){var c=(function(g){var f=[];while(g-->0){f.push(null)}return f})(b.length);for(var e=0;e<c.length;e++){c[e]=b[e].getLevel()}this.undoSupport.beginUpdate();this.deleteFurniture(b);this.addFurniture$java_util_List$com_eteks_sweethome3d_model_Level_A$com_eteks_sweethome3d_model_HomeFurnitureGroup$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,c,null,d);this.undoSupport.postEdit(new LocalizedUndoableEdit(this.preferences,a,"undoReorderName"));this.undoSupport.endUpdate()}};a.prototype.setSelectedFurniture$java_util_List=function(b){this.setSelectedFurniture$java_util_List$boolean(b,true)};a.prototype.setSelectedFurniture$java_util_List$boolean=function(b,f){if(this.home.isBasePlanLocked()){b=this.getFurnitureNotPartOfBasePlan(b)}if(f){this.home.setSelectedItems(b);this.home.setAllLevelsSelection(false)}else{var g=(this.home.getSelectedItems().slice(0));b=(b.slice(0));for(var d=g.length-1;d>=0;d--){var e=g[d];if(e!=null&&e instanceof HomePieceOfFurniture){var c=b.indexOf(e);if(c>=0){b.splice(c,1)[0]}else{g.splice(d,1)[0]}}}(function(j,h){return j.push.apply(j,h)})(g,b);this.home.setSelectedItems(g)}};a.prototype.setSelectedFurniture=function(b,c){if(((b!=null&&(b instanceof Array))||b===null)&&((typeof c==="boolean")||c===null)){return this.setSelectedFurniture$java_util_List$boolean(b,c)}else{if(((b!=null&&(b instanceof Array))||b===null)&&c===undefined){return this.setSelectedFurniture$java_util_List(b)}else{throw new Error("invalid overload")}}};a.prototype.selectAll=function(){this.setSelectedFurniture$java_util_List(this.home.getFurniture())};a.prototype.isPieceOfFurniturePartOfBasePlan=function(b){return !b.isMovable()||b.isDoorOrWindow()};a.prototype.isPieceOfFurnitureMovable=function(b){return true};a.prototype.isPieceOfFurnitureDeletable=function(b){return true};a.prototype.createHomePieceOfFurniture=function(d){var c=(d.getPropertyNames().slice(0));for(var b=c.length-1;b>=0;b--){var e=c[b];if((function(j,h,g){if(g===void 0){g=0}return j.substr(g,h.length)===h})(e,"modelPresetTransformationsName_")||(function(j,h,g){if(g===void 0){g=0}return j.substr(g,h.length)===h})(e,"modelPresetTransformations_")){c.splice(b,1)[0]}}var f=c.slice(0);if(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0)){return new HomeDoorOrWindow(d,f)}else{if(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0)){return new HomeLight(d,f)}else{if(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0)){return new HomeShelfUnit(d,f)}else{return new HomePieceOfFurniture(d,f)}}}};a.prototype.getFurnitureNotPartOfBasePlan=function(e){var c=([]);for(var b=0;b<e.length;b++){var d=e[b];if(!this.isPieceOfFurniturePartOfBasePlan(d)){(c.push(d)>0)}}return c};a.prototype.toggleFurnitureSort$java_lang_String=function(b){if(b===this.home.getFurnitureSortedPropertyName()){this.home.setFurnitureSortedPropertyName(null)}else{this.home.setFurnitureSortedPropertyName(b)}};a.prototype.toggleFurnitureSort=function(b){if(((typeof b==="string")||b===null)){return this.toggleFurnitureSort$java_lang_String(b)}else{if(((typeof b==="number")||b===null)){return this.toggleFurnitureSort$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty(b)}else{throw new Error("invalid overload")}}};a.prototype.toggleFurnitureSort$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty=function(b){if((b==this.home.getFurnitureSortedProperty())){this.home.setFurnitureSortedProperty(null)}else{this.home.setFurnitureSortedProperty(b)}};a.prototype.toggleFurnitureSortOrder=function(){this.home.setFurnitureDescendingSorted(!this.home.isFurnitureDescendingSorted())};a.prototype.sortFurniture$java_lang_String=function(e){var c=this.home.getFurnitureSortedPropertyName();var b=this.home.isFurnitureDescendingSorted();var d=false;if(e===c){if(b){e=null}else{d=true}}this.home.setFurnitureSortedPropertyName(e);this.home.setFurnitureDescendingSorted(d)};a.prototype.sortFurniture=function(b){if(((typeof b==="string")||b===null)){return this.sortFurniture$java_lang_String(b)}else{if(((typeof b==="number")||b===null)){return this.sortFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty(b)}else{throw new Error("invalid overload")}}};a.prototype.sortFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty=function(d){var c=this.home.getFurnitureSortedProperty();var b=this.home.isFurnitureDescendingSorted();var e=false;if((d==c)){if(b){d=null}else{e=true}}this.home.setFurnitureSortedProperty(d);this.home.setFurnitureDescendingSorted(e)};a.prototype.setFurnitureVisiblePropertyNames=function(b){this.home.setFurnitureVisiblePropertyNames(b)};a.prototype.setFurnitureVisibleProperties=function(b){this.home.setFurnitureVisibleProperties(b)};a.prototype.toggleFurnitureVisibleProperty$java_lang_String=function(g){var d=(this.home.getFurnitureVisiblePropertyNames().slice(0));if((d.indexOf((g))>=0)){(function(k){var l=k.indexOf(g);if(l>=0){k.splice(l,1);return true}else{return false}})(d);if((d.length==0)){(d.push("NAME")>0)}}else{var h=(["CATALOG_ID","NAME","DESCRIPTION","CREATOR","LICENSE","WIDTH","DEPTH","HEIGHT","X","Y","ELEVATION","ANGLE","LEVEL","MODEL_SIZE","COLOR","TEXTURE","MOVABLE","DOOR_OR_WINDOW","VISIBLE","PRICE","VALUE_ADDED_TAX_PERCENTAGE","VALUE_ADDED_TAX","PRICE_VALUE_ADDED_TAX_INCLUDED"].slice(0).slice(0));var j=this.home.getFurnitureAdditionalProperties();for(var c=0;c<j.length;c++){var e=j[c];(h.push(e.getName())>0)}var f=h.indexOf(g)-1;if(f>0){while((f>0)){var b=d.indexOf(h[f]);if(b>=0){f=b+1;break}else{f--}}}if(f<0){f=0}d.splice(f,0,g)}this.home.setFurnitureVisiblePropertyNames(d)};a.prototype.toggleFurnitureVisibleProperty=function(b){if(((typeof b==="string")||b===null)){return this.toggleFurnitureVisibleProperty$java_lang_String(b)}else{if(((typeof b==="number")||b===null)){return this.toggleFurnitureVisibleProperty$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty(b)}else{throw new Error("invalid overload")}}};a.prototype.toggleFurnitureVisibleProperty$com_eteks_sweethome3d_model_HomePieceOfFurniture_SortableProperty=function(b){this.toggleFurnitureVisibleProperty$java_lang_String(b)};a.prototype.modifySelectedFurniture=function(){if(!(Home.getFurnitureSubList(this.home.getSelectedItems()).length==0)){new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())}};a.prototype.toggleSelectedFurnitureVisibility=function(){if(Home.getFurnitureSubList(this.home.getSelectedItems()).length===1){var b=new HomeFurnitureController(this.home,this.preferences,this.viewFactory,this.contentManager,this.undoSupport);b.setVisible(!b.getVisible());b.modifyFurniture()}};a.prototype.groupSelectedFurniture=function(){var B=this.getMovableSelectedFurniture();if(B.length>0){var D=this.home.isBasePlanLocked();var r=this.home.isAllLevelsSelection();var z=this.home.getSelectedItems();var o=this.home.getFurniture();var t=({});var v=0;for(var k=0;k<B.length;k++){var f=B[k];var n=a.getPieceOfFurnitureGroup(f,null,o);var c=(function(H,I){if(H.entries==null){H.entries=[]}for(var J=0;J<H.entries.length;J++){if(H.entries[J].key==null&&I==null||H.entries[J].key.equals!=null&&H.entries[J].key.equals(I)||H.entries[J].key===I){return H.entries[J].value}}return null})(t,n);if(c==null){c=({});(function(H,K,J){if(H.entries==null){H.entries=[]}for(var I=0;I<H.entries.length;I++){if(H.entries[I].key==null&&K==null||H.entries[I].key.equals!=null&&H.entries[I].key.equals(K)||H.entries[I].key===K){H.entries[I].value=J;return}}H.entries.push({key:K,value:J,getKey:function(){return this.key},getValue:function(){return this.value}})})(t,n,c)}if(n==null){(function(H,J,I){if(H.entries==null){H.entries=[]}for(var K=0;K<H.entries.length;K++){if(H.entries[K].key.equals!=null&&H.entries[K].key.equals(J)||H.entries[K].key===J){var L=H.entries[K].value;H.entries[K].value=I;return L}}H.entries.push({key:J,value:I,getKey:function(){return this.key},getValue:function(){return this.value}});H.entries.sort(function(N,M){return(N.key.compareTo!=null)?N.key.compareTo(M):(N.key-M.key)});return null})(c,o.indexOf(f),f)}else{(function(H,J,I){if(H.entries==null){H.entries=[]}for(var K=0;K<H.entries.length;K++){if(H.entries[K].key.equals!=null&&H.entries[K].key.equals(J)||H.entries[K].key===J){var L=H.entries[K].value;H.entries[K].value=I;return L}}H.entries.push({key:J,value:I,getKey:function(){return this.key},getValue:function(){return this.value}});H.entries.sort(function(N,M){return(N.key.compareTo!=null)?N.key.compareTo(M):(N.key-M.key)});return null})(c,n.getFurniture().indexOf(f),f)}v++}var s=(function(I){var H=[];while(I-->0){H.push(null)}return H})(v);var y=(function(I){var H=[];while(I-->0){H.push(0)}return H})(s.length);var q=(function(I){var H=[];while(I-->0){H.push(null)}return H})(s.length);var u=(function(I){var H=[];while(I-->0){H.push(0)}return H})(s.length);var p=(function(I){var H=[];while(I-->0){H.push(false)}return H})(s.length);var j=(function(I){var H=[];while(I-->0){H.push(null)}return H})(s.length);var E=this.home.getSelectedLevel();var x=0;var l=(function(H){if(H.entries==null){H.entries=[]}return H.entries})(t);for(var k=0;k<l.length;k++){var m=l[k];var G=(function(H){if(H.entries==null){H.entries=[]}return H.entries})(m.getValue());for(var h=0;h<G.length;h++){var b=G[h];var f=b.getValue();s[x]=f;y[x]=b.getKey();q[x]=f.getLevel();u[x]=f.getElevation();p[x]=f.isVisible();j[x]=m.getKey();if(q[x]!=null){if(E==null||q[x].getElevation()<E.getElevation()){E=q[x]}}x++}}var g=void 0;var A=s.slice(0);if(A.indexOf(this.leadSelectedPieceOfFurniture)>0){g=this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(A,this.leadSelectedPieceOfFurniture)}else{g=this.createHomeFurnitureGroup$java_util_List(A)}var w=(function(I){var H=[];while(I-->0){H.push(0)}return H})(s.length);x=0;for(var k=0;k<s.length;k++){var f=s[k];w[x++]=f.getElevation()}var F=(function(H,J){if(H.entries==null){H.entries=[]}for(var I=0;I<H.entries.length;I++){if(H.entries[I].key==null&&J==null||H.entries[I].key.equals!=null&&H.entries[I].key.equals(J)||H.entries[I].key===J){return H.entries[I].value}}return null})(t,null);var e=F!=null?(function(H){return H.entries[H.entries.length-1].key})(F)+1-s.length:o.length;var d=g.isMovable();var C=E;a.doGroupFurniture(this.home,s,[g],null,[e],[C],D,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureGroupingUndoableEdit(this.home,this.preferences,z.slice(0),D,r,s,y,j,q,u,p,g,e,C,w,d))}}};a.prototype.createHomeFurnitureGroup$java_util_List=function(b){return this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(b,b[0])};a.prototype.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(e,d){var b=this.preferences.getLocalizedString(a,"groupName",a.getFurnitureGroupCount(this.home.getFurniture())+1);var c=new HomeFurnitureGroup(e,d,b);return c};a.prototype.createHomeFurnitureGroup=function(c,b){if(((c!=null&&(c instanceof Array))||c===null)&&((b!=null&&b instanceof HomePieceOfFurniture)||b===null)){return this.createHomeFurnitureGroup$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(c,b)}else{if(((c!=null&&(c instanceof Array))||c===null)&&b===undefined){return this.createHomeFurnitureGroup$java_util_List(c)}else{throw new Error("invalid overload")}}};a.getFurnitureGroupCount=function(e){var c=0;for(var b=0;b<e.length;b++){var d=e[b];if(d!=null&&d instanceof HomeFurnitureGroup){c+=1+a.getFurnitureGroupCount(d.getFurniture())}}return c};a.doGroupFurniture=function(j,h,d,g,c,e,b,f){a.doDeleteFurniture(j,h,b,f);a.doAddFurniture(j,d,g,c,null,e,b,f)};a.doUngroupFurniture=function(j,c,f,h,g,e,b,d){a.doDeleteFurniture(j,c,b,d);a.doAddFurniture(j,f,h,g,null,e,b,d)};a.prototype.ungroupSelectedFurniture=function(){var t=([]);var f=this.home.getSelectedItems();for(var A=0;A<f.length;A++){var y=f[A];if(y!=null&&y instanceof HomeFurnitureGroup){var r=y;if(this.isPieceOfFurnitureMovable(r)){(t.push(r)>0)}}}if(!(t.length==0)){var n=this.home.getFurniture();var j=this.home.isBasePlanLocked();var p=this.home.isAllLevelsSelection();var o=this.home.getSelectedItems();var k=({});var l=0;for(var A=0;A<t.length;A++){var q=t[A];var J=a.getPieceOfFurnitureGroup(q,null,n);var w=(function(N,O){if(N.entries==null){N.entries=[]}for(var M=0;M<N.entries.length;M++){if(N.entries[M].key==null&&O==null||N.entries[M].key.equals!=null&&N.entries[M].key.equals(O)||N.entries[M].key===O){return N.entries[M].value}}return null})(k,J);if(w==null){w=({});(function(M,O,N){if(M.entries==null){M.entries=[]}for(var P=0;P<M.entries.length;P++){if(M.entries[P].key==null&&O==null||M.entries[P].key.equals!=null&&M.entries[P].key.equals(O)||M.entries[P].key===O){M.entries[P].value=N;return}}M.entries.push({key:O,value:N,getKey:function(){return this.key},getValue:function(){return this.value}})})(k,J,w)}if(J==null){(function(M,O,N){if(M.entries==null){M.entries=[]}for(var P=0;P<M.entries.length;P++){if(M.entries[P].key.equals!=null&&M.entries[P].key.equals(O)||M.entries[P].key===O){var Q=M.entries[P].value;M.entries[P].value=N;return Q}}M.entries.push({key:O,value:N,getKey:function(){return this.key},getValue:function(){return this.value}});M.entries.sort(function(S,R){return(S.key.compareTo!=null)?S.key.compareTo(R):(S.key-R.key)});return null})(w,n.indexOf(q),q)}else{(function(M,O,N){if(M.entries==null){M.entries=[]}for(var P=0;P<M.entries.length;P++){if(M.entries[P].key.equals!=null&&M.entries[P].key.equals(O)||M.entries[P].key===O){var Q=M.entries[P].value;M.entries[P].value=N;return Q}}M.entries.push({key:O,value:N,getKey:function(){return this.key},getValue:function(){return this.value}});M.entries.sort(function(S,R){return(S.key.compareTo!=null)?S.key.compareTo(R):(S.key-R.key)});return null})(w,J.getFurniture().indexOf(q),q)}l++}var h=(function(N){var M=[];while(N-->0){M.push(null)}return M})(l);var L=(function(N){var M=[];while(N-->0){M.push(null)}return M})(h.length);var d=(function(N){var M=[];while(N-->0){M.push(0)}return M})(h.length);var b=(function(N){var M=[];while(N-->0){M.push(null)}return M})(h.length);var I=0;var B=([]);var z=([]);var D=([]);var f=(function(M){if(M.entries==null){M.entries=[]}return M.entries})(k);for(var A=0;A<f.length;A++){var G=f[A];var w=G.getValue();var g=(function(M){return M.entries[M.entries.length-1].key})(w)+1-(function(M){if(M.entries==null){M.entries=[]}return M.entries.length})(w);var u=(function(M){if(M.entries==null){M.entries=[]}return M.entries})(w);for(var F=0;F<u.length;F++){var c=u[F];var r=c.getValue();h[I]=r;L[I]=G.getKey();d[I]=c.getKey();b[I++]=r.getLevel();var s=r.getFurniture();for(var E=0;E<s.length;E++){var H=s[E];(B.push(H)>0);(D.push(G.getKey())>0);(z.push(g++)>0)}}}var v=B.slice(0);var C=D.slice(0);var x=(function(N){var M=[];while(N-->0){M.push(0)}return M})(v.length);var K=(function(N){var M=[];while(N-->0){M.push(null)}return M})(v.length);var e=j;for(I=0;I<v.length;I++){x[I]=z[I];K[I]=v[I].getLevel();e=!this.isPieceOfFurniturePartOfBasePlan(v[I])&&e}var m=e;a.doUngroupFurniture(this.home,h,v,C,x,K,m,false);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureUngroupingUndoableEdit(this.home,this.preferences,o.slice(0),j,p,h,d,L,b,v,x,C,K,m))}}};a.prototype.importFurniture$=function(){new ImportedFurnitureWizardController(this.home,this.preferences,this,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())};a.prototype.importFurniture$java_lang_String=function(b){new ImportedFurnitureWizardController(this.home,b,this.preferences,this,this.viewFactory,this.contentManager,this.undoSupport).displayView(this.getView())};a.prototype.importFurniture=function(b){if(((typeof b==="string")||b===null)){return this.importFurniture$java_lang_String(b)}else{if(b===undefined){return this.importFurniture$()}else{throw new Error("invalid overload")}}};a.prototype.alignSelectedFurnitureOnTop=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureTopAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnBottom=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureBottomAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnLeft=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureLeftAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnRight=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureRightAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnFrontSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureFrontSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnBackSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureBackSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnLeftSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureLeftSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureOnRightSide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureRightSideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.prototype.alignSelectedFurnitureSideBySide=function(){var b=this.home.getSelectedItems();this.alignSelectedFurniture(new a.FurnitureSideBySideAlignmentUndoableEdit(this.home,this.preferences,b.slice(0),this.getMovableSelectedFurniture(),this.leadSelectedPieceOfFurniture))};a.sortFurniture=function(d,e,c){var b=([]);if(e!=null){(b.push(e)>0)}(function(g,f){return g.push.apply(g,f)})(b,d.slice(0));(function(f,g){if(g.compare){f.sort(function(j,h){return g.compare(j,h)})}else{f.sort(g)}})(b,new a.FurnitureController$2(c));return b};a.alignPieceOfFurnitureAlongSides=function(o,j,h,n,l,m){var b=h.relativeCCW(o.getX(),o.getY())*h.ptLineDist(o.getX(),o.getY())+a.getPieceBoundingRectangleHeight(o,-j.getAngle())/2;if(n){b=-b}var g=Math.sin(j.getAngle());var k=Math.cos(j.getAngle());var e=(-b*g);var c=(b*k);var d=a.getPieceBoundingRectangleWidth(o,-j.getAngle());if(l!=null){var f=l.relativeCCW(o.getX(),o.getY());if(f===0){f=n?1:-1}b=m+f*(l.ptLineDist(o.getX(),o.getY())-d/2);e+=(b*k);c+=(b*g)}o.move(e,c);return d};a.alignPieceOfFurnitureAlongLeftOrRightSides=function(c,e,b,d){var f=b.relativeCCW(c.getX(),c.getY())*b.ptLineDist(c.getX(),c.getY())+a.getPieceBoundingRectangleWidth(c,-e.getAngle())/2;if(d){f=-f}c.move((f*Math.cos(e.getAngle())),(f*Math.sin(e.getAngle())))};a.getPieceBoundingRectangleWidth=function(c,b){return Math.abs(c.getWidthInPlan()*Math.cos(b+c.getAngle()))+Math.abs(c.getDepthInPlan()*Math.sin(b+c.getAngle()))};a.getPieceBoundingRectangleHeight=function(c,b){return Math.abs(c.getWidthInPlan()*Math.sin(b+c.getAngle()))+Math.abs(c.getDepthInPlan()*Math.cos(b+c.getAngle()))};a.prototype.alignSelectedFurniture=function(c){var b=this.getMovableSelectedFurniture();if(b.length>=2){this.home.setSelectedItems(b.slice(0));c.alignFurniture$();if(this.undoSupport!=null){this.undoSupport.postEdit(c)}}};a.prototype.getMovableSelectedFurniture=function(){var e=([]);var f=this.home.getSelectedItems();for(var b=0;b<f.length;b++){var d=f[b];if(d!=null&&d instanceof HomePieceOfFurniture){var c=d;if(this.isPieceOfFurnitureMovable(c)){(e.push(c)>0)}}}return e.slice(0)};a.undoAlignFurniture=function(c,b,f){for(var d=0;d<c.length;d++){var e=c[d];e.setX(b[d]);e.setY(f[d])}};a.getMinX=function(f){var e=f.getPoints();var c=Infinity;for(var d=0;d<e.length;d++){var b=e[d];c=Math.min(c,b[0])}return c};a.getMaxX=function(e){var d=e.getPoints();var f=-Infinity;for(var c=0;c<d.length;c++){var b=d[c];f=Math.max(f,b[0])}return f};a.getMinY=function(e){var d=e.getPoints();var f=Infinity;for(var c=0;c<d.length;c++){var b=d[c];f=Math.min(f,b[1])}return f};a.getMaxY=function(e){var d=e.getPoints();var f=-Infinity;for(var c=0;c<d.length;c++){var b=d[c];f=Math.max(f,b[1])}return f};a.prototype.distributeSelectedFurnitureHorizontally=function(){this.distributeSelectedFurniture(true)};a.prototype.distributeSelectedFurnitureVertically=function(){this.distributeSelectedFurniture(false)};a.prototype.distributeSelectedFurniture=function(d){var b=this.getMovableSelectedFurniture();if(b.length>=3){var c=this.home.getSelectedItems();var g=(function(j){var h=[];while(j-->0){h.push(0)}return h})(b.length);var f=(function(j){var h=[];while(j-->0){h.push(0)}return h})(b.length);for(var e=0;e<b.length;e++){g[e]=b[e].getX();f[e]=b[e].getY()}this.home.setSelectedItems(b.slice(0));a.doDistributeFurnitureAlongAxis(b,d);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureDistributionUndoableEdit(this.home,this.preferences,c.slice(0),g,f,b,d))}}};a.doDistributeFurnitureAlongAxis=function(e,b){var n=b?new java.awt.geom.Line2D.Float(0,0,0,-1):new java.awt.geom.Line2D.Float(0,0,1,0);var c=a.sortFurniture(e,null,n);var j=(b?0:Math.PI/2);var h=c[0];var g=a.getPieceBoundingRectangleWidth(h,j)/2;var o=c[c.length-1];var m=a.getPieceBoundingRectangleWidth(o,j)/2;var k=Math.abs(n.ptLineDist(o.getX(),o.getY())*n.relativeCCW(o.getX(),o.getY())-n.ptLineDist(h.getX(),h.getY())*n.relativeCCW(h.getX(),h.getY()))-m-g;var l=(function(r){var q=[];while(r-->0){q.push(0)}return q})(c.length-2);for(var f=1;f<c.length-1;f++){var p=c[f];l[f-1]=a.getPieceBoundingRectangleWidth(p,j);k-=l[f-1]}k/=c.length-1;var d=(b?h.getX():h.getY())+(g+k);for(var f=1;f<c.length-1;f++){var p=c[f];if(b){p.setX((d+l[f-1]/2))}else{p.setY((d+l[f-1]/2))}d+=k+l[f-1]}};a.prototype.resetFurnitureElevation=function(){var c=this.getMovableSelectedFurniture();if(c.length>=1){var b=this.home.getSelectedItems();var j=(function(l){var k=[];while(l-->0){k.push(0)}return k})(c.length);var h=(function(l){var k=[];while(l-->0){k.push(0)}return k})(c.length);for(var e=0;e<c.length;e++){var f=c[e];j[e]=f.getElevation();var d=this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(f,c.slice(0));if(d!=null){var g=d.getElevation();if(d.isHorizontallyRotated()){g+=d.getHeightInPlan()}else{g+=d.getHeight()*d.getDropOnTopElevation()}if(d.getLevel()!=null){g+=d.getLevel().getElevation()-f.getLevel().getElevation()}h[e]=Math.max(0,g)}else{h[e]=0}}this.home.setSelectedItems(c.slice(0));a.doSetFurnitureElevation(c,h);if(this.undoSupport!=null){this.undoSupport.postEdit(new a.FurnitureElevationResetUndoableEdit(this.home,this.preferences,b.slice(0),j,c,h))}}};a.doSetFurnitureElevation=function(b,d){for(var c=0;c<b.length;c++){b[c].setElevation(d[c])}};a.prototype.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(b){var c=[];return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(b,c)};a.prototype.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List=function(d,h){var c=null;var g=1.4e-45;var j=this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean(d,h,0.05,false);for(var b=0;b<j.length;b++){var f=j[b];var e=f.getElevation();if(f.isHorizontallyRotated()){e+=f.getHeightInPlan()}else{e+=f.getHeight()*f.getDropOnTopElevation()}if(e>g){g=e;c=f}}return c};a.prototype.getHighestSurroundingPieceOfFurniture=function(b,c){if(((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&((c!=null&&(c instanceof Array))||c===null)){return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List(b,c)}else{if(((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&c===undefined){return this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(b)}else{throw new Error("invalid overload")}}};a.prototype.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(b){var c=[];return this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean(b,c,0.2,true)};a.prototype.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean=function(o,n,d,h){var e=o.getPoints();var c=Math.min(o.getWidthInPlan(),o.getDepthInPlan())*d;var b=([]);var j=this.getFurnitureInSameGroup(o);for(var g=0;g<j.length;g++){var m=j[g];if(m!==o&&!(n.indexOf((m))>=0)&&this.isPieceOfFurnitureVisibleAtSelectedLevel(m)&&(m.getDropOnTopElevation()>=0||(h&&(m!=null&&m instanceof HomeShelfUnit)))){var f=true;for(var k=0;k<e.length;k++){var l=e[k];if(!m.containsPoint(l[0],l[1],c)){f=false;break}}if(f){(b.push(m)>0)}}}return b};a.prototype.getSurroundingFurniture=function(b,e,c,d){if(((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&((e!=null&&(e instanceof Array))||e===null)&&((typeof c==="number")||c===null)&&((typeof d==="boolean")||d===null)){return this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$java_util_List$float$boolean(b,e,c,d)}else{if(((b!=null&&b instanceof HomePieceOfFurniture)||b===null)&&e===undefined&&c===undefined&&d===undefined){return this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(b)}else{throw new Error("invalid overload")}}};a.prototype.getFurnitureInSameGroup=function(c){var b=this.home.getFurniture();var d=a.getFurnitureInSameGroup(c,b);if(d!=null){return d}else{return b}};a.getFurnitureInSameGroup=function(e,f){for(var c=0;c<f.length;c++){var d=f[c];if(d===e){return f}else{if(d!=null&&d instanceof HomeFurnitureGroup){var b=a.getFurnitureInSameGroup(e,d.getFurniture());if(b!=null){return b}}}}return null};a.prototype.isPieceOfFurnitureVisibleAtSelectedLevel=function(b){var c=this.home.getSelectedLevel();return b.isVisible()&&(b.getLevel()==null||b.getLevel().isViewable())&&(b.getLevel()===c||b.isAtLevel(c))};a.prototype.setVisualProperty=function(c,b){this.home.setVisualProperty(c,b)};a.prototype.setHomeProperty=function(c,b){this.home.setProperty(c,b)};return a}());FurnitureController.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController";FurnitureController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(l){var g=(function(w){__extends(v,w);function v(H,B,y,I,G,F,E,A,z,D,x){var C=w.call(this,B,l,"undoAddFurnitureName")||this;if(C.home===undefined){C.home=null}if(C.allLevelsSelection===undefined){C.allLevelsSelection=false}if(C.oldSelection===undefined){C.oldSelection=null}if(C.oldBasePlanLocked===undefined){C.oldBasePlanLocked=false}if(C.newFurniture===undefined){C.newFurniture=null}if(C.newFurnitureIndex===undefined){C.newFurnitureIndex=null}if(C.newFurnitureGroups===undefined){C.newFurnitureGroups=null}if(C.newFurnitureLevels===undefined){C.newFurnitureLevels=null}if(C.furnitureLevel===undefined){C.furnitureLevel=null}if(C.newBasePlanLocked===undefined){C.newBasePlanLocked=false}C.home=H;C.oldSelection=y;C.oldBasePlanLocked=I;C.allLevelsSelection=G;C.newFurniture=F;C.newFurnitureIndex=E;C.newFurnitureGroups=A;C.newFurnitureLevels=z;C.furnitureLevel=D;C.newBasePlanLocked=x;return C}v.prototype.undo=function(){w.prototype.undo.call(this);l.doDeleteFurniture(this.home,this.newFurniture,this.oldBasePlanLocked,this.allLevelsSelection);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);l.doAddFurniture(this.home,this.newFurniture,this.newFurnitureGroups,this.newFurnitureIndex,this.furnitureLevel,this.newFurnitureLevels,this.newBasePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureAdditionUndoableEdit=g;g.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureAdditionUndoableEdit";g.__interfaces=["javax.swing.undo.UndoableEdit"];var m=(function(w){__extends(v,w);function v(F,A,x,B,E,D,y,z,G){var C=w.call(this,A,l,"undoDeleteSelectionName")||this;if(C.home===undefined){C.home=null}if(C.oldSelection===undefined){C.oldSelection=null}if(C.basePlanLocked===undefined){C.basePlanLocked=false}if(C.allLevelsSelection===undefined){C.allLevelsSelection=false}if(C.furniture===undefined){C.furniture=null}if(C.furnitureIndex===undefined){C.furnitureIndex=null}if(C.furnitureGroups===undefined){C.furnitureGroups=null}if(C.furnitureLevels===undefined){C.furnitureLevels=null}C.home=F;C.oldSelection=x;C.basePlanLocked=B;C.allLevelsSelection=E;C.furniture=D;C.furnitureIndex=y;C.furnitureGroups=z;C.furnitureLevels=G;return C}v.prototype.undo=function(){w.prototype.undo.call(this);l.doAddFurniture(this.home,this.furniture,this.furnitureGroups,this.furnitureIndex,null,this.furnitureLevels,this.basePlanLocked,this.allLevelsSelection);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);this.home.setSelectedItems(this.furniture.slice(0));l.doDeleteFurniture(this.home,this.furniture,this.basePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureDeletionUndoableEdit=m;m.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureDeletionUndoableEdit";m.__interfaces=["javax.swing.undo.UndoableEdit"];var t=(function(w){__extends(v,w);function v(H,C,x,D,G,F,J,K,z,M,I,y,L,B,A,N){var E=w.call(this,C,l,"undoGroupName")||this;if(E.home===undefined){E.home=null}if(E.oldSelection===undefined){E.oldSelection=null}if(E.basePlanLocked===undefined){E.basePlanLocked=false}if(E.allLevelsSelection===undefined){E.allLevelsSelection=false}if(E.groupedPieces===undefined){E.groupedPieces=null}if(E.groupedPiecesIndex===undefined){E.groupedPiecesIndex=null}if(E.groupedPiecesGroups===undefined){E.groupedPiecesGroups=null}if(E.groupedPiecesLevel===undefined){E.groupedPiecesLevel=null}if(E.groupedPiecesElevation===undefined){E.groupedPiecesElevation=null}if(E.groupedPiecesVisible===undefined){E.groupedPiecesVisible=null}if(E.newGroup===undefined){E.newGroup=null}if(E.groupIndex===undefined){E.groupIndex=0}if(E.groupLevel===undefined){E.groupLevel=null}if(E.groupPiecesNewElevation===undefined){E.groupPiecesNewElevation=null}if(E.movable===undefined){E.movable=false}E.home=H;E.basePlanLocked=D;E.oldSelection=x;E.allLevelsSelection=G;E.groupedPieces=F;E.groupedPiecesIndex=J;E.groupedPiecesGroups=K;E.groupedPiecesLevel=z;E.groupedPiecesElevation=M;E.groupedPiecesVisible=I;E.newGroup=y;E.groupIndex=L;E.groupLevel=B;E.groupPiecesNewElevation=A;E.movable=N;return E}v.prototype.undo=function(){w.prototype.undo.call(this);l.doUngroupFurniture(this.home,[this.newGroup],this.groupedPieces,this.groupedPiecesGroups,this.groupedPiecesIndex,this.groupedPiecesLevel,this.basePlanLocked,this.allLevelsSelection);for(var x=0;x<this.groupedPieces.length;x++){this.groupedPieces[x].setElevation(this.groupedPiecesElevation[x]);this.groupedPieces[x].setVisible(this.groupedPiecesVisible[x])}this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);for(var x=0;x<this.groupedPieces.length;x++){this.groupedPieces[x].setElevation(this.groupPiecesNewElevation[x]);this.groupedPieces[x].setLevel(null)}this.newGroup.setMovable(this.movable);this.newGroup.setVisible(true);l.doGroupFurniture(this.home,this.groupedPieces,[this.newGroup],null,[this.groupIndex],[this.groupLevel],this.basePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureGroupingUndoableEdit=t;t.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureGroupingUndoableEdit";t.__interfaces=["javax.swing.undo.UndoableEdit"];var p=(function(w){__extends(v,w);function v(I,D,y,L,G,A,B,z,K,F,J,H,C,x){var E=w.call(this,D,l,"undoUngroupName")||this;if(E.home===undefined){E.home=null}if(E.oldBasePlanLocked===undefined){E.oldBasePlanLocked=false}if(E.oldSelection===undefined){E.oldSelection=null}if(E.allLevelsSelection===undefined){E.allLevelsSelection=false}if(E.groups===undefined){E.groups=null}if(E.groupsIndex===undefined){E.groupsIndex=null}if(E.groupsGroups===undefined){E.groupsGroups=null}if(E.groupsLevels===undefined){E.groupsLevels=null}if(E.ungroupedPieces===undefined){E.ungroupedPieces=null}if(E.ungroupedPiecesIndex===undefined){E.ungroupedPiecesIndex=null}if(E.ungroupedPiecesGroups===undefined){E.ungroupedPiecesGroups=null}if(E.ungroupedPiecesLevels===undefined){E.ungroupedPiecesLevels=null}if(E.newBasePlanLocked===undefined){E.newBasePlanLocked=false}E.home=I;E.oldSelection=y;E.oldBasePlanLocked=L;E.allLevelsSelection=G;E.groups=A;E.groupsIndex=B;E.groupsGroups=z;E.groupsLevels=K;E.ungroupedPieces=F;E.ungroupedPiecesIndex=J;E.ungroupedPiecesGroups=H;E.ungroupedPiecesLevels=C;E.newBasePlanLocked=x;return E}v.prototype.undo=function(){w.prototype.undo.call(this);l.doGroupFurniture(this.home,this.ungroupedPieces,this.groups,this.groupsGroups,this.groupsIndex,this.groupsLevels,this.oldBasePlanLocked,this.allLevelsSelection);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);l.doUngroupFurniture(this.home,this.groups,this.ungroupedPieces,this.ungroupedPiecesGroups,this.ungroupedPiecesIndex,this.ungroupedPiecesLevels,this.newBasePlanLocked,false)};return v}(LocalizedUndoableEdit));l.FurnitureUngroupingUndoableEdit=p;p.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureUngroupingUndoableEdit";p.__interfaces=["javax.swing.undo.UndoableEdit"];var k=(function(w){__extends(v,w);function v(E,A,x,y,D){var B=w.call(this,A,l,"undoAlignName")||this;if(B.home===undefined){B.home=null}if(B.oldSelection===undefined){B.oldSelection=null}if(B.selectedFurniture===undefined){B.selectedFurniture=null}if(B.leadPiece===undefined){B.leadPiece=null}if(B.alignedFurniture===undefined){B.alignedFurniture=null}if(B.oldX===undefined){B.oldX=null}if(B.oldY===undefined){B.oldY=null}B.home=E;B.oldSelection=x;B.selectedFurniture=y;B.leadPiece=D;B.alignedFurniture=(function(H){var G=[];while(H-->0){G.push(null)}return G})(D==null?y.length:y.length-1);B.oldX=(function(H){var G=[];while(H-->0){G.push(0)}return G})(B.alignedFurniture.length);B.oldY=(function(H){var G=[];while(H-->0){G.push(0)}return G})(B.alignedFurniture.length);var z=0;for(var C=0;C<y.length;C++){var F=y[C];if(F!==D){B.alignedFurniture[z]=F;B.oldX[z]=F.getX();B.oldY[z]=F.getY();z++}}return B}v.prototype.undo=function(){w.prototype.undo.call(this);l.undoAlignFurniture(this.alignedFurniture,this.oldX,this.oldY);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);this.home.setSelectedItems(this.selectedFurniture.slice(0));this.alignFurniture$()};v.prototype.alignFurniture$=function(){this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(this.alignedFurniture,this.leadPiece)};v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,y){throw new Error("cannot invoke abstract overloaded method... check your argument(s) type(s)")};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(LocalizedUndoableEdit));l.FurnitureAlignmentUndoableEdit=k;k.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureAlignmentUndoableEdit";k.__interfaces=["javax.swing.undo.UndoableEdit"];var b=(function(v){__extends(w,v);function w(D,A,z,C,B,x,y){var E=v.call(this,A,l,"undoDistributeName")||this;if(E.home===undefined){E.home=null}if(E.oldSelection===undefined){E.oldSelection=null}if(E.oldX===undefined){E.oldX=null}if(E.oldY===undefined){E.oldY=null}if(E.alignedFurniture===undefined){E.alignedFurniture=null}if(E.horizontal===undefined){E.horizontal=false}E.home=D;E.oldSelection=z;E.oldX=C;E.oldY=B;E.alignedFurniture=x;E.horizontal=y;return E}w.prototype.undo=function(){v.prototype.undo.call(this);l.undoAlignFurniture(this.alignedFurniture,this.oldX,this.oldY);this.home.setSelectedItems(this.oldSelection.slice(0))};w.prototype.redo=function(){v.prototype.redo.call(this);this.home.setSelectedItems(this.alignedFurniture.slice(0));l.doDistributeFurnitureAlongAxis(this.alignedFurniture,this.horizontal)};return w}(LocalizedUndoableEdit));l.FurnitureDistributionUndoableEdit=b;b.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureDistributionUndoableEdit";b.__interfaces=["javax.swing.undo.UndoableEdit"];var c=(function(w){__extends(v,w);function v(B,z,x,D,y,A){var C=w.call(this,z,l,"undoResetElevation")||this;if(C.home===undefined){C.home=null}if(C.oldSelection===undefined){C.oldSelection=null}if(C.furnitureOldElevation===undefined){C.furnitureOldElevation=null}if(C.selectedFurniture===undefined){C.selectedFurniture=null}if(C.furnitureNewElevation===undefined){C.furnitureNewElevation=null}C.home=B;C.oldSelection=x;C.furnitureOldElevation=D;C.selectedFurniture=y;C.furnitureNewElevation=A;return C}v.prototype.undo=function(){w.prototype.undo.call(this);l.doSetFurnitureElevation(this.selectedFurniture,this.furnitureOldElevation);this.home.setSelectedItems(this.oldSelection.slice(0))};v.prototype.redo=function(){w.prototype.redo.call(this);this.home.setSelectedItems(this.selectedFurniture.slice(0));l.doSetFurnitureElevation(this.selectedFurniture,this.furnitureNewElevation)};return v}(LocalizedUndoableEdit));l.FurnitureElevationResetUndoableEdit=c;c.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureElevationResetUndoableEdit";c.__interfaces=["javax.swing.undo.UndoableEdit"];var n=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,B){var A=l.getMinY(B);for(var y=0;y<x.length;y++){var z=x[y];var C=l.getMinY(z);z.setY(z.getY()+A-C)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureTopAlignmentUndoableEdit=n;n.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureTopAlignmentUndoableEdit";n.__interfaces=["javax.swing.undo.UndoableEdit"];var o=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var B=l.getMaxY(C);for(var y=0;y<x.length;y++){var z=x[y];var A=l.getMaxY(z);z.setY(z.getY()+B-A)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureBottomAlignmentUndoableEdit=o;o.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureBottomAlignmentUndoableEdit";o.__interfaces=["javax.swing.undo.UndoableEdit"];var f=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(y,C){var B=l.getMinX(C);for(var z=0;z<y.length;z++){var A=y[z];var x=l.getMinX(A);A.setX(A.getX()+B-x)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureLeftAlignmentUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureLeftAlignmentUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var e=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var A=l.getMaxX(C);for(var y=0;y<x.length;y++){var z=x[y];var B=l.getMaxX(z);z.setX(z.getX()+A-B)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureRightAlignmentUndoableEdit=e;e.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureRightAlignmentUndoableEdit";e.__interfaces=["javax.swing.undo.UndoableEdit"];var a=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var A=C.getPoints();var B=new java.awt.geom.Line2D.Float(A[2][0],A[2][1],A[3][0],A[3][1]);for(var y=0;y<x.length;y++){var z=x[y];l.alignPieceOfFurnitureAlongSides(z,C,B,true,null,0)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureFrontSideAlignmentUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureFrontSideAlignmentUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var r=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var A=C.getPoints();var B=new java.awt.geom.Line2D.Float(A[0][0],A[0][1],A[1][0],A[1][1]);for(var y=0;y<x.length;y++){var z=x[y];l.alignPieceOfFurnitureAlongSides(z,C,B,false,null,0)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureBackSideAlignmentUndoableEdit=r;r.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureBackSideAlignmentUndoableEdit";r.__interfaces=["javax.swing.undo.UndoableEdit"];var h=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var B=C.getPoints();var y=new java.awt.geom.Line2D.Float(B[3][0],B[3][1],B[0][0],B[0][1]);for(var z=0;z<x.length;z++){var A=x[z];l.alignPieceOfFurnitureAlongLeftOrRightSides(A,C,y,false)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureLeftSideAlignmentUndoableEdit=h;h.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureLeftSideAlignmentUndoableEdit";h.__interfaces=["javax.swing.undo.UndoableEdit"];var d=(function(v){__extends(w,v);function w(B,z,x,y,A){return v.call(this,B,z,x,y,A)||this}w.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(x,C){var z=C.getPoints();var B=new java.awt.geom.Line2D.Float(z[1][0],z[1][1],z[2][0],z[2][1]);for(var y=0;y<x.length;y++){var A=x[y];l.alignPieceOfFurnitureAlongLeftOrRightSides(A,C,B,true)}};w.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return w}(l.FurnitureAlignmentUndoableEdit));l.FurnitureRightSideAlignmentUndoableEdit=d;d.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureRightSideAlignmentUndoableEdit";d.__interfaces=["javax.swing.undo.UndoableEdit"];var j=(function(w){__extends(v,w);function v(B,z,x,y,A){return w.call(this,B,z,x,y,A)||this}v.prototype.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(z,C){var D=C.getPoints();var E=new java.awt.geom.Line2D.Float(C.getX(),C.getY(),(D[0][0]+D[1][0])/2,(D[0][1]+D[1][1])/2);var x=l.sortFurniture(z,C,E);var B=x.indexOf(C);var y=new java.awt.geom.Line2D.Float(D[0][0],D[0][1],D[1][0],D[1][1]);var F=C.getWidthInPlan()/2;for(var A=B+1;A<x.length;A++){F+=l.alignPieceOfFurnitureAlongSides(x[A],C,y,false,E,F)}F=-C.getWidthInPlan()/2;for(var A=B-1;A>=0;A--){F-=l.alignPieceOfFurnitureAlongSides(x[A],C,y,false,E,F)}};v.prototype.alignFurniture=function(x,y){if(((x!=null&&x instanceof Array&&(x.length==0||x[0]==null||(x[0]!=null&&x[0] instanceof HomePieceOfFurniture)))||x===null)&&((y!=null&&y instanceof HomePieceOfFurniture)||y===null)){return this.alignFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture_A$com_eteks_sweethome3d_model_HomePieceOfFurniture(x,y)}else{if(x===undefined&&y===undefined){return this.alignFurniture$()}else{throw new Error("invalid overload")}}};return v}(l.FurnitureAlignmentUndoableEdit));l.FurnitureSideBySideAlignmentUndoableEdit=j;j.__class="com.eteks.sweethome3d.viewcontroller.FurnitureController.FurnitureSideBySideAlignmentUndoableEdit";j.__interfaces=["javax.swing.undo.UndoableEdit"];var u=(function(){function v(w){this.__parent=w}v.prototype.selectionChanged=function(x){var w=Home.getFurnitureSubList(this.__parent.home.getSelectedItems());if((w.length==0)){this.__parent.leadSelectedPieceOfFurniture=null}else{if(this.__parent.leadSelectedPieceOfFurniture==null||w.length===1||w.indexOf(this.__parent.leadSelectedPieceOfFurniture)===-1){this.__parent.leadSelectedPieceOfFurniture=w[0]}}};return v}());l.FurnitureController$0=u;u.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var s=(function(){function v(w){this.__parent=w}v.prototype.propertyChange=function(w){if("MOVABLE"===w.getPropertyName()){var x=w.getSource();if(this.__parent.home.isBasePlanLocked()&&this.__parent.isPieceOfFurniturePartOfBasePlan(x)){var y=this.__parent.home.getSelectedItems();if((y.indexOf((x))>=0)){y=(y.slice(0));(function(z){var A=z.indexOf(x);if(A>=0){z.splice(A,1);return true}else{return false}})(y);this.__parent.home.setSelectedItems(y)}}}};return v}());l.FurnitureController$1=s;var q=(function(){function v(w){this.orthogonalAxis=w}v.prototype.compare=function(x,w){return(this.orthogonalAxis.ptLineDistSq(w.getX(),w.getY())*this.orthogonalAxis.relativeCCW(w.getX(),w.getY())-this.orthogonalAxis.ptLineDistSq(x.getX(),x.getY())*this.orthogonalAxis.relativeCCW(x.getX(),x.getY()))};return v}());l.FurnitureController$2=q})(FurnitureController||(FurnitureController={}));var LabelController=(function(){function a(j,l,k,e,h,c){if(((j!=null&&j instanceof Home)||j===null)&&((typeof l==="number")||l===null)&&((typeof k==="number")||k===null)&&((e!=null&&e instanceof UserPreferences)||e===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||h===null)&&((c!=null&&c instanceof javax.swing.undo.UndoableEditSupport)||c===null)){var g=arguments;if(this.home===undefined){this.home=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.labelView===undefined){this.labelView=null}if(this.text===undefined){this.text=null}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontNameSet===undefined){this.fontNameSet=false}if(this.fontSize===undefined){this.fontSize=null}if(this.color===undefined){this.color=null}if(this.pitch===undefined){this.pitch=null}if(this.pitchEnabled===undefined){this.pitchEnabled=null}if(this.elevation===undefined){this.elevation=null}this.home=j;this.x=l;this.y=k;this.preferences=e;this.viewFactory=h;this.undoSupport=c;this.propertyChangeSupport=new PropertyChangeSupport(this);this.alignment=TextStyle.Alignment.CENTER;this.fontName=e.getDefaultFontName();this.fontNameSet=true;this.fontSize=e.getDefaultTextStyle(Label).getFontSize();this.pitchEnabled=false;this.elevation=0}else{if(((j!=null&&j instanceof Home)||j===null)&&((l!=null&&l instanceof UserPreferences)||l===null)&&((k!=null&&(k.constructor!=null&&k.constructor.__interfaces!=null&&k.constructor.__interfaces.indexOf("com.eteks.sweethome3d.viewcontroller.ViewFactory")>=0))||k===null)&&((e!=null&&e instanceof javax.swing.undo.UndoableEditSupport)||e===null)&&h===undefined&&c===undefined){var g=arguments;var b=g[1];var f=g[2];var d=g[3];if(this.home===undefined){this.home=null}if(this.x===undefined){this.x=null}if(this.y===undefined){this.y=null}if(this.preferences===undefined){this.preferences=null}if(this.viewFactory===undefined){this.viewFactory=null}if(this.undoSupport===undefined){this.undoSupport=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.labelView===undefined){this.labelView=null}if(this.text===undefined){this.text=null}if(this.alignment===undefined){this.alignment=null}if(this.fontName===undefined){this.fontName=null}if(this.fontNameSet===undefined){this.fontNameSet=false}if(this.fontSize===undefined){this.fontSize=null}if(this.color===undefined){this.color=null}if(this.pitch===undefined){this.pitch=null}if(this.pitchEnabled===undefined){this.pitchEnabled=null}if(this.elevation===undefined){this.elevation=null}this.home=j;this.x=null;this.y=null;this.preferences=b;this.viewFactory=f;this.undoSupport=d;this.propertyChangeSupport=new PropertyChangeSupport(this);this.updateProperties()}else{throw new Error("invalid overload")}}}a.prototype.updateProperties=function(){var f=Home.getLabelsSubList(this.home.getSelectedItems());if((f.length==0)){this.setText(null);this.setFontName(null);this.fontNameSet=false;this.setFontSize(null);this.setAlignment(null);this.setColor(null);this.setPitch(null);this.pitchEnabled=false;this.setElevation(null)}else{var d=f[0];var o=d.getText();if(o!=null){for(var g=1;g<f.length;g++){if(!(o===f[g].getText())){o=null;break}}}this.setText(o);var j=d.getStyle()!=null?d.getStyle().getAlignment():TextStyle.Alignment.CENTER;for(var g=1;g<f.length;g++){var m=f[g];if(!((j)===(m.getStyle()!=null?m.getStyle().getAlignment():TextStyle.Alignment.CENTER))){j=null;break}}this.setAlignment(j);var b=d.getStyle()!=null?d.getStyle().getFontName():null;var k=true;for(var g=1;g<f.length;g++){var m=f[g];if(!(b==null&&(m.getStyle()==null||m.getStyle().getFontName()==null)||b!=null&&m.getStyle()!=null&&(b===m.getStyle().getFontName()))){k=false;break}}this.setFontName(b);this.fontNameSet=k;var l=this.preferences.getDefaultTextStyle(Label).getFontSize();var p=d.getStyle()!=null?d.getStyle().getFontSize():l;for(var g=1;g<f.length;g++){var m=f[g];if(!(p===(m.getStyle()!=null?m.getStyle().getFontSize():l))){p=null;break}}this.setFontSize(p);var e=d.getColor();if(e!=null){for(var g=1;g<f.length;g++){if(!(e===f[g].getColor())){e=null;break}}}this.setColor(e);var c=d.getPitch();for(var g=1;g<f.length;g++){var m=f[g];if(!(c==null&&m.getPitch()==null||c!=null&&(c===m.getPitch()))){c=null;break}}this.setPitch(c);var h=d.getPitch()!=null;for(var g=1;g<f.length;g++){if(!(h===(f[g].getPitch()!=null))){h=null;break}}this.pitchEnabled=h;var n=d.getElevation();for(var g=1;g<f.length;g++){if(n!==f[g].getElevation()){n=null;break}}this.setElevation(n)}};a.prototype.getView=function(){if(this.labelView==null){this.labelView=this.viewFactory.createLabelView(this.x==null,this.preferences,this)}return this.labelView};a.prototype.displayView=function(b){this.getView().displayView(b)};a.prototype.addPropertyChangeListener=function(c,b){this.propertyChangeSupport.addPropertyChangeListener(c,b)};a.prototype.removePropertyChangeListener=function(c,b){this.propertyChangeSupport.removePropertyChangeListener(c,b)};a.prototype.setText=function(c){if(c!==this.text){var b=this.text;this.text=c;this.propertyChangeSupport.firePropertyChange("TEXT",b,c)}};a.prototype.getText=function(){return this.text};a.prototype.setAlignment=function(c){if(c!==this.alignment){var b=this.alignment;this.alignment=c;this.propertyChangeSupport.firePropertyChange("ALIGNMENT",b,c)}};a.prototype.getAlignment=function(){return this.alignment};a.prototype.setFontName=function(c){if(c!==this.fontName){var b=this.fontName;this.fontName=c;this.propertyChangeSupport.firePropertyChange("FONT_NAME",b,c);this.fontNameSet=true}};a.prototype.getFontName=function(){return this.fontName};a.prototype.setFontSize=function(c){if(c!==this.fontSize){var b=this.fontSize;this.fontSize=c;this.propertyChangeSupport.firePropertyChange("FONT_SIZE",b,c)}};a.prototype.getFontSize=function(){return this.fontSize};a.prototype.isFontNameSet=function(){return this.fontNameSet};a.prototype.setColor=function(b){if(b!==this.color){var c=this.color;this.color=b;this.propertyChangeSupport.firePropertyChange("COLOR",c,b)}};a.prototype.getColor=function(){return this.color};a.prototype.setPitch=function(c){if(c!==this.pitch){var b=this.pitch;this.pitch=c;this.propertyChangeSupport.firePropertyChange("PITCH",b,c)}this.pitchEnabled=c!=null};a.prototype.getPitch=function(){return this.pitch};a.prototype.isPitchEnabled=function(){return this.pitchEnabled};a.prototype.setElevation=function(c){if(c!==this.elevation){var b=this.elevation;this.elevation=c;this.propertyChangeSupport.firePropertyChange("ELEVATION",b,c)}};a.prototype.getElevation=function(){return this.elevation};a.prototype.createLabel$java_lang_String$float$float=function(d,b,e){var c=new Label(d,b,e);this.home.addLabel(c);return c};a.prototype.createLabel=function(c,b,d){if(((typeof c==="string")||c===null)&&((typeof b==="number")||b===null)&&((typeof d==="number")||d===null)){return this.createLabel$java_lang_String$float$float(c,b,d)}else{if(c===undefined&&b===undefined&&d===undefined){return this.createLabel$()}else{throw new Error("invalid overload")}}};a.prototype.createLabel$=function(){var l=this.getText();if(l!=null&&l.trim().length>0){var c=this.home.getSelectedItems();var g=this.home.isBasePlanLocked();var h=this.home.isAllLevelsSelection();var k=this.createLabel$java_lang_String$float$float(l,this.x,this.y);var j=this.getAlignment();var e=this.getFontName();var m=this.getFontSize();if(e!=null||m!=null||this.getPitch()!=null){var d=this.preferences.getDefaultTextStyle(Label);if(e!=null){d=d.deriveStyle$java_lang_String(e)}if(m!=null){d=d.deriveStyle$float(m)}if(j!=null){d=d.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(j)}k.setStyle(d)}if(this.color!=null){k.setColor(this.color)}k.setColor(this.getColor());k.setPitch(this.getPitch());k.setElevation(this.getElevation());var b=g&&!this.isLabelPartOfBasePlan(k);a.doAddAndSelectLabel(this.home,k,false,b);if(this.undoSupport!=null){var f=new a.LabelCreationUndoableEdit(this.home,this.preferences,c.slice(0),g,h,k,b);this.undoSupport.postEdit(f)}if(l.indexOf("\n")<0){this.preferences.addAutoCompletionString("LabelText",l)}}};a.doAddAndSelectLabel=function(d,c,e,b){if(e){d.addLabel(c)}d.setBasePlanLocked(b);d.setSelectedItems([c].slice(0));d.setAllLevelsSelection(false)};a.doDeleteLabel=function(d,c,b){d.deleteLabel(c);d.setBasePlanLocked(b)};a.prototype.isLabelPartOfBasePlan=function(b){return true};a.prototype.modifyLabels=function(){var b=this.home.getSelectedItems();var g=Home.getLabelsSubList(b);if(!(g.length==0)){var o=this.getText();if(o!=null&&o.trim().length===0){o=null}var k=this.getAlignment();var c=this.getFontName();var l=this.isFontNameSet();var q=this.getFontSize();var f=this.getColor();var d=this.getPitch();var j=this.isPitchEnabled();var n=this.getElevation();var m=(function(t){var r=[];while(t-->0){r.push(null)}return r})(g.length);for(var h=0;h<m.length;h++){m[h]=new a.ModifiedLabel(g[h])}var p=this.preferences.getDefaultTextStyle(Label);a.doModifyLabels(m,o,k,c,l,q,p,f,d,j,n);if(this.undoSupport!=null){var e=new a.LabelModificationUndoableEdit(this.home,this.preferences,b.slice(0),m,o,k,c,l,q,p,f,d,j,n);this.undoSupport.postEdit(e)}if(o!=null&&o.indexOf("\n")<0){this.preferences.addAutoCompletionString("LabelText",o)}}};a.doModifyLabels=function(l,n,h,b,j,p,o,d,c,g,m){for(var e=0;e<l.length;e++){var f=l[e];var k=f.getLabel();if(n!=null){k.setText(n)}if(h!=null){k.setStyle(k.getStyle()!=null?k.getStyle().deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(h):o.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(h))}if(j){k.setStyle(k.getStyle()!=null?k.getStyle().deriveStyle$java_lang_String(b):o.deriveStyle$java_lang_String(b))}if(p!=null){k.setStyle(k.getStyle()!=null?k.getStyle().deriveStyle$float(p):o.deriveStyle$float(p))}if(d!=null){k.setColor(d)}if(g!=null){if(false===g){k.setPitch(null)}else{if(c!=null){k.setPitch(c);if(k.getStyle()==null){k.setStyle(o)}}}}if(m!=null){k.setElevation(m)}}};a.undoModifyLabels=function(d){for(var c=0;c<d.length;c++){var b=d[c];b.reset()}};return a}());LabelController.__class="com.eteks.sweethome3d.viewcontroller.LabelController";LabelController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var c=(function(e){__extends(f,e);function f(n,h,g,l,m,j,k){var o=e.call(this,h,a,"undoCreateLabelName")||this;if(o.home===undefined){o.home=null}if(o.oldSelection===undefined){o.oldSelection=null}if(o.oldBasePlanLocked===undefined){o.oldBasePlanLocked=false}if(o.oldAllLevelsSelection===undefined){o.oldAllLevelsSelection=false}if(o.label===undefined){o.label=null}if(o.newBasePlanLocked===undefined){o.newBasePlanLocked=false}o.home=n;o.oldSelection=g;o.oldBasePlanLocked=l;o.oldAllLevelsSelection=m;o.label=j;o.newBasePlanLocked=k;return o}f.prototype.undo=function(){e.prototype.undo.call(this);a.doDeleteLabel(this.home,this.label,this.oldBasePlanLocked);this.home.setSelectedItems(this.oldSelection.slice(0));this.home.setAllLevelsSelection(this.oldAllLevelsSelection)};f.prototype.redo=function(){e.prototype.redo.call(this);a.doAddAndSelectLabel(this.home,this.label,true,this.newBasePlanLocked)};return f}(LocalizedUndoableEdit));a.LabelCreationUndoableEdit=c;c.__class="com.eteks.sweethome3d.viewcontroller.LabelController.LabelCreationUndoableEdit";c.__interfaces=["javax.swing.undo.UndoableEdit"];var d=(function(e){__extends(f,e);function f(p,l,g,r,t,o,h,q,v,u,k,j,n,s){var m=e.call(this,l,a,"undoModifyLabelsName")||this;if(m.home===undefined){m.home=null}if(m.oldSelection===undefined){m.oldSelection=null}if(m.modifiedLabels===undefined){m.modifiedLabels=null}if(m.text===undefined){m.text=null}if(m.alignment===undefined){m.alignment=null}if(m.fontName===undefined){m.fontName=null}if(m.fontNameSet===undefined){m.fontNameSet=false}if(m.fontSize===undefined){m.fontSize=null}if(m.defaultStyle===undefined){m.defaultStyle=null}if(m.color===undefined){m.color=null}if(m.pitch===undefined){m.pitch=null}if(m.pitchEnabled===undefined){m.pitchEnabled=null}if(m.elevation===undefined){m.elevation=null}m.home=p;m.oldSelection=g;m.modifiedLabels=r;m.text=t;m.alignment=o;m.fontName=h;m.fontNameSet=q;m.fontSize=v;m.defaultStyle=u;m.color=k;m.pitch=j;m.pitchEnabled=n;m.elevation=s;return m}f.prototype.undo=function(){e.prototype.undo.call(this);a.undoModifyLabels(this.modifiedLabels);this.home.setSelectedItems(this.oldSelection.slice(0))};f.prototype.redo=function(){e.prototype.redo.call(this);a.doModifyLabels(this.modifiedLabels,this.text,this.alignment,this.fontName,this.fontNameSet,this.fontSize,this.defaultStyle,this.color,this.pitch,this.pitchEnabled,this.elevation);this.home.setSelectedItems(this.oldSelection.slice(0))};return f}(LocalizedUndoableEdit));a.LabelModificationUndoableEdit=d;d.__class="com.eteks.sweethome3d.viewcontroller.LabelController.LabelModificationUndoableEdit";d.__interfaces=["javax.swing.undo.UndoableEdit"];var b=(function(){function e(f){if(this.label===undefined){this.label=null}if(this.text===undefined){this.text=null}if(this.style===undefined){this.style=null}if(this.color===undefined){this.color=null}if(this.pitch===undefined){this.pitch=null}if(this.elevation===undefined){this.elevation=0}this.label=f;this.text=f.getText();this.style=f.getStyle();this.color=f.getColor();this.pitch=f.getPitch();this.elevation=f.getElevation()}e.prototype.getLabel=function(){return this.label};e.prototype.reset=function(){this.label.setText(this.text);this.label.setStyle(this.style);this.label.setColor(this.color);this.label.setPitch(this.pitch);this.label.setElevation(this.elevation)};return e}());a.ModifiedLabel=b;b.__class="com.eteks.sweethome3d.viewcontroller.LabelController.ModifiedLabel"})(LabelController||(LabelController={}));var PhotoController=(function(a){__extends(b,a);function b(f,d,h,c,e){var g=a.call(this,f,d,h,e)||this;if(g.__com_eteks_sweethome3d_viewcontroller_PhotoController_home===undefined){g.__com_eteks_sweethome3d_viewcontroller_PhotoController_home=null}if(g.preferences===undefined){g.preferences=null}if(g.viewFactory===undefined){g.viewFactory=null}if(g.cameraChangeListener===undefined){g.cameraChangeListener=null}if(g.photoView===undefined){g.photoView=null}if(g.time===undefined){g.time=0}if(g.lens===undefined){g.lens=null}if(g.renderer===undefined){g.renderer=null}g.__com_eteks_sweethome3d_viewcontroller_PhotoController_home=f;g.preferences=d;g.viewFactory=c;g.cameraChangeListener=new b.CameraChangeListener(g);f.getCamera().addPropertyChangeListener(g.cameraChangeListener);f.addPropertyChangeListener("CAMERA",new b.HomeCameraChangeListener(g));g.updateProperties();return g}b.prototype.getView=function(){if(this.photoView==null){this.photoView=this.viewFactory.createPhotoView(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home,this.preferences,this)}return this.photoView};b.prototype.displayView=function(c){this.getView().displayView(c)};b.prototype.updateProperties=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home!=null){a.prototype.updateProperties.call(this);this.setTime(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getTime());this.setLens(this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getLens());var c=this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().getRenderer();if(c==null){c=this.preferences.getPhotoRenderer()}this.setRenderer(c,false)}};b.prototype.setTime=function(d){if(this.time!==d){var e=this.time;this.time=d;this.propertyChangeSupport.firePropertyChange("TIME",e,d);var c=this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera();c.removePropertyChangeListener(this.cameraChangeListener);c.setTime(d);c.addPropertyChangeListener(this.cameraChangeListener)}};b.prototype.getTime=function(){return this.time};b.prototype.setLens=function(c){if(this.lens!==c){var d=this.lens;this.lens=c;this.propertyChangeSupport.firePropertyChange("LENS",d,c);if(c===Camera.Lens.SPHERICAL){this.setAspectRatio(AspectRatio.RATIO_2_1)}else{if(c===Camera.Lens.FISHEYE){this.setAspectRatio(AspectRatio.SQUARE_RATIO)}}this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getCamera().setLens(this.lens)}};b.prototype.getLens=function(){return this.lens};b.prototype.setRenderer=function(e,c){if(c===void 0){c=true}if(this.renderer!==e){var d=this.renderer;this.renderer=e;this.propertyChangeSupport.firePropertyChange("RENDERER",d,e);this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getTopCamera().setRenderer(this.renderer);this.__com_eteks_sweethome3d_viewcontroller_PhotoController_home.getObserverCamera().setRenderer(this.renderer);if(c){this.preferences.setPhotoRenderer(e)}}};b.prototype.getRenderer=function(){return this.renderer};return b}(AbstractPhotoController));PhotoController.__class="com.eteks.sweethome3d.viewcontroller.PhotoController";PhotoController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(c){var a=(function(){function d(e){if(this.photoController===undefined){this.photoController=null}this.photoController=(e)}d.prototype.propertyChange=function(f){var e=this.photoController;if(e==null){f.getSource().removePropertyChangeListener("CAMERA",this)}else{f.getOldValue().removePropertyChangeListener(e.cameraChangeListener);e.updateProperties();f.getNewValue().addPropertyChangeListener(e.cameraChangeListener)}};return d}());c.HomeCameraChangeListener=a;a.__class="com.eteks.sweethome3d.viewcontroller.PhotoController.HomeCameraChangeListener";var b=(function(){function d(e){if(this.photoController===undefined){this.photoController=null}this.photoController=(e)}d.prototype.propertyChange=function(f){var e=this.photoController;if(e==null){f.getSource().removePropertyChangeListener(this)}else{e.updateProperties()}};return d}());c.CameraChangeListener=b;b.__class="com.eteks.sweethome3d.viewcontroller.PhotoController.CameraChangeListener"})(PhotoController||(PhotoController={}));var PhotosController=(function(b){__extends(a,b);function a(f,d,h,c,e){var g=b.call(this,f,d,h,e)||this;if(g.__com_eteks_sweethome3d_viewcontroller_PhotosController_home===undefined){g.__com_eteks_sweethome3d_viewcontroller_PhotosController_home=null}if(g.preferences===undefined){g.preferences=null}if(g.viewFactory===undefined){g.viewFactory=null}if(g.photoView===undefined){g.photoView=null}if(g.cameras===undefined){g.cameras=null}if(g.selectedCameras===undefined){g.selectedCameras=null}if(g.fileFormat===undefined){g.fileFormat=null}if(g.fileCompressionQuality===undefined){g.fileCompressionQuality=null}g.__com_eteks_sweethome3d_viewcontroller_PhotosController_home=f;g.preferences=d;g.viewFactory=c;g.cameras=[];g.selectedCameras=[];f.addPropertyChangeListener("STORED_CAMERAS",new a.HomeStoredCamerasChangeListener(g));g.updateProperties();return g}a.prototype.getView=function(){if(this.photoView==null){this.photoView=this.viewFactory.createPhotosView(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home,this.preferences,this)}return this.photoView};a.prototype.displayView=function(c){this.getView().displayView(c)};a.prototype.updateProperties=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home!=null){b.prototype.updateProperties.call(this);this.setCameras(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home.getStoredCameras());this.setSelectedCameras(this.__com_eteks_sweethome3d_viewcontroller_PhotosController_home.getStoredCameras())}};a.prototype.getCameras=function(){return this.cameras};a.prototype.setCameras=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.cameras)){var c=this.cameras;this.cameras=(d.slice(0));this.propertyChangeSupport.firePropertyChange("CAMERAS",c.slice(0),d.slice(0))}};a.prototype.getSelectedCameras=function(){return this.selectedCameras};a.prototype.setSelectedCameras=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.selectedCameras)){var c=this.selectedCameras;this.selectedCameras=(d.slice(0));this.propertyChangeSupport.firePropertyChange("SELECTED_CAMERAS",c.slice(0),d.slice(0))}};a.prototype.getFileFormat=function(){return this.fileFormat};a.prototype.setFileFormat=function(d){if(d!==this.fileFormat){var c=this.fileFormat;this.fileFormat=d;this.propertyChangeSupport.firePropertyChange("FILE_FORMAT",c,d)}};a.prototype.getFileCompressionQuality=function(){return this.fileCompressionQuality};a.prototype.setFileCompressionQuality=function(d){if(d!==this.fileCompressionQuality){var c=this.fileCompressionQuality;this.fileCompressionQuality=d;this.propertyChangeSupport.firePropertyChange("FILE_COMPRESSION_QUALITY",c,d)}};return a}(AbstractPhotoController));PhotosController.__class="com.eteks.sweethome3d.viewcontroller.PhotosController";PhotosController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(a){var b=(function(){function c(d){if(this.photosController===undefined){this.photosController=null}this.photosController=(d)}c.prototype.propertyChange=function(e){var d=this.photosController;if(d==null){e.getSource().removePropertyChangeListener("STORED_CAMERAS",this)}else{d.updateProperties()}};return c}());a.HomeStoredCamerasChangeListener=b;b.__class="com.eteks.sweethome3d.viewcontroller.PhotosController.HomeStoredCamerasChangeListener"})(PhotosController||(PhotosController={}));var HomeShelfUnit=(function(a){__extends(b,a);function b(e,h,l){var p=this;if(((typeof e==="string")||e===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0))||h===null)&&((l!=null&&l instanceof Array&&(l.length==0||l[0]==null||(typeof l[0]==="string")))||l===null)){var q=arguments;p=a.call(this,e,h,l)||this;if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}p.shelfElevations=h.getShelfElevations();p.shelfBoxes=h.getShelfBoxes()}else{if(((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0))||e===null)&&((h!=null&&h instanceof Array&&(h.length==0||h[0]==null||(typeof h[0]==="string")))||h===null)&&l===undefined){var q=arguments;var o=q[0];var m=q[1];var f=arguments;var s=HomeObject.createId("shelfUnit");p=a.call(this,s,o,m)||this;if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}p.shelfElevations=o.getShelfElevations();p.shelfBoxes=o.getShelfBoxes();if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}}else{if(((typeof e==="string")||e===null)&&((h!=null&&(h.constructor!=null&&h.constructor.__interfaces!=null&&h.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0))||h===null)&&l===undefined){var q=arguments;var g=arguments;var k=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();p=a.call(this,e,h,k)||this;if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}p.shelfElevations=h.getShelfElevations();p.shelfBoxes=h.getShelfBoxes();if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}}else{if(((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.ShelfUnit")>=0))||e===null)&&h===undefined&&l===undefined){var q=arguments;var n=q[0];var d=arguments;var j=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();var c=arguments;var r=HomeObject.createId("shelfUnit");p=a.call(this,r,n,j)||this;if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}p.shelfElevations=n.getShelfElevations();p.shelfBoxes=n.getShelfBoxes();if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}if(p.shelfElevations===undefined){p.shelfElevations=null}if(p.shelfBoxes===undefined){p.shelfBoxes=null}}else{throw new Error("invalid overload")}}}}return p}b.prototype.getShelfElevations=function(){return this.shelfElevations!=null?this.shelfElevations.slice(0):null};b.prototype.setShelfElevations=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.shelfElevations)){var c=this.shelfElevations.length===0?this.shelfElevations:this.shelfElevations.slice(0);this.shelfElevations=d.length===0?d:d.slice(0);this.firePropertyChange("SHELF_ELEVATIONS",c,d)}};b.prototype.getShelfBoxes=function(){return this.shelfBoxes.slice(0)};b.prototype.setShelfBoxes=function(c){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(c,this.shelfBoxes)){var d=this.shelfBoxes.length===0?this.shelfBoxes:this.shelfBoxes.slice(0);this.shelfBoxes=c.length===0?c:c.slice(0);this.firePropertyChange("SHELF_BOXES",d,c)}};b.prototype.clone=function(){var c=this;return(function(e){if(a.prototype.clone!=undefined){return a.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return b}(HomePieceOfFurniture));HomeShelfUnit.__class="com.eteks.sweethome3d.model.HomeShelfUnit";HomeShelfUnit.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.ShelfUnit","com.eteks.sweethome3d.model.Elevatable"];HomeShelfUnit.__transients=["shapeCache","propertyChangeSupport"];var HomeLight=(function(b){__extends(a,b);function a(d,j,h){var k=this;if(((typeof d==="string")||d===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0))||j===null)&&((h!=null&&h instanceof Array&&(h.length==0||h[0]==null||(typeof h[0]==="string")))||h===null)){var l=arguments;k=b.call(this,d,j,h)||this;if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}k.lightSources=j.getLightSources();k.lightSourceMaterialNames=j.getLightSourceMaterialNames();k.power=0.5}else{if(((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0))||d===null)&&((j!=null&&j instanceof Array&&(j.length==0||j[0]==null||(typeof j[0]==="string")))||j===null)&&h===undefined){var l=arguments;var p=l[0];var g=l[1];var c=arguments;var n=HomeObject.createId("light");k=b.call(this,n,p,g)||this;if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}k.lightSources=p.getLightSources();k.lightSourceMaterialNames=p.getLightSourceMaterialNames();k.power=0.5;if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}}else{if(((typeof d==="string")||d===null)&&((j!=null&&(j.constructor!=null&&j.constructor.__interfaces!=null&&j.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0))||j===null)&&h===undefined){var l=arguments;var s=arguments;var f=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();k=b.call(this,d,j,f)||this;if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}k.lightSources=j.getLightSources();k.lightSourceMaterialNames=j.getLightSourceMaterialNames();k.power=0.5;if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}}else{if(((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Light")>=0))||d===null)&&j===undefined&&h===undefined){var l=arguments;var o=l[0];var r=arguments;var e=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();var q=arguments;var m=HomeObject.createId("light");k=b.call(this,m,o,e)||this;if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}k.lightSources=o.getLightSources();k.lightSourceMaterialNames=o.getLightSourceMaterialNames();k.power=0.5;if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}if(k.lightSources===undefined){k.lightSources=null}if(k.lightSourceMaterialNames===undefined){k.lightSourceMaterialNames=null}if(k.power===undefined){k.power=0}}else{throw new Error("invalid overload")}}}}return k}a.prototype.getLightSources=function(){if(this.lightSources.length===0){return this.lightSources}else{return this.lightSources.slice(0)}};a.prototype.setLightSources=function(c){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(c,this.lightSources)){var d=this.lightSources.length===0?this.lightSources:this.lightSources.slice(0);this.lightSources=c.length===0?c:c.slice(0);this.firePropertyChange("LIGHT_SOURCES",d,c)}};a.prototype.getLightSourceMaterialNames=function(){if(this.lightSourceMaterialNames.length===0){return this.lightSourceMaterialNames}else{return this.lightSourceMaterialNames.slice(0)}};a.prototype.setLightSourceMaterialNames=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.lightSourceMaterialNames)){var c=this.lightSourceMaterialNames.length===0?this.lightSourceMaterialNames:this.lightSourceMaterialNames.slice(0);this.lightSourceMaterialNames=d.length===0?d:d.slice(0);this.firePropertyChange("LIGHT_SOURCE_MATERIAL_NAMES",c,d)}};a.prototype.getPower=function(){return this.power};a.prototype.setPower=function(d){if(d!==this.power){var c=this.power;this.power=d;this.firePropertyChange("POWER",c,d)}};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(HomePieceOfFurniture));HomeLight.__class="com.eteks.sweethome3d.model.HomeLight";HomeLight.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable","com.eteks.sweethome3d.model.Light"];HomeLight.__transients=["shapeCache","propertyChangeSupport"];var HomeDoorOrWindow=(function(b){__extends(a,b);function a(d,r,h){var l=this;if(((typeof d==="string")||d===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0))||r===null)&&((h!=null&&h instanceof Array&&(h.length==0||h[0]==null||(typeof h[0]==="string")))||h===null)){var m=arguments;l=b.call(this,d,r,h)||this;if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}l.wallThickness=r.getWallThickness();l.wallDistance=r.getWallDistance();l.wallWidth=1;l.wallLeft=0;l.wallHeight=1;l.wallTop=0;l.wallCutOutOnBothSides=r.isWallCutOutOnBothSides();l.widthDepthDeformable=r.isWidthDepthDeformable();l.sashes=r.getSashes();l.cutOutShape=r.getCutOutShape()}else{if(((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0))||d===null)&&((r!=null&&r instanceof Array&&(r.length==0||r[0]==null||(typeof r[0]==="string")))||r===null)&&h===undefined){var m=arguments;var e=m[0];var j=m[1];var s=arguments;var k=HomeObject.createId("doorOrWindow");l=b.call(this,k,e,j)||this;if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}l.wallThickness=e.getWallThickness();l.wallDistance=e.getWallDistance();l.wallWidth=1;l.wallLeft=0;l.wallHeight=1;l.wallTop=0;l.wallCutOutOnBothSides=e.isWallCutOutOnBothSides();l.widthDepthDeformable=e.isWidthDepthDeformable();l.sashes=e.getSashes();l.cutOutShape=e.getCutOutShape();if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}}else{if(((typeof d==="string")||d===null)&&((r!=null&&(r.constructor!=null&&r.constructor.__interfaces!=null&&r.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0))||r===null)&&h===undefined){var m=arguments;var q=arguments;var g=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();l=b.call(this,d,r,g)||this;if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}l.wallThickness=r.getWallThickness();l.wallDistance=r.getWallDistance();l.wallWidth=1;l.wallLeft=0;l.wallHeight=1;l.wallTop=0;l.wallCutOutOnBothSides=r.isWallCutOutOnBothSides();l.widthDepthDeformable=r.isWidthDepthDeformable();l.sashes=r.getSashes();l.cutOutShape=r.getCutOutShape();if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}}else{if(((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.DoorOrWindow")>=0))||d===null)&&r===undefined&&h===undefined){var m=arguments;var c=m[0];var o=arguments;var f=HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();var p=arguments;var n=HomeObject.createId("doorOrWindow");l=b.call(this,n,c,f)||this;if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}l.wallThickness=c.getWallThickness();l.wallDistance=c.getWallDistance();l.wallWidth=1;l.wallLeft=0;l.wallHeight=1;l.wallTop=0;l.wallCutOutOnBothSides=c.isWallCutOutOnBothSides();l.widthDepthDeformable=c.isWidthDepthDeformable();l.sashes=c.getSashes();l.cutOutShape=c.getCutOutShape();if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}if(l.wallThickness===undefined){l.wallThickness=0}if(l.wallDistance===undefined){l.wallDistance=0}if(l.wallWidth===undefined){l.wallWidth=0}if(l.wallLeft===undefined){l.wallLeft=0}if(l.wallHeight===undefined){l.wallHeight=0}if(l.wallTop===undefined){l.wallTop=0}if(l.wallCutOutOnBothSides===undefined){l.wallCutOutOnBothSides=false}if(l.widthDepthDeformable===undefined){l.widthDepthDeformable=false}if(l.sashes===undefined){l.sashes=null}if(l.cutOutShape===undefined){l.cutOutShape=null}if(l.boundToWall===undefined){l.boundToWall=false}}else{throw new Error("invalid overload")}}}}return l}a.prototype.getWallThickness=function(){return this.wallThickness};a.prototype.setWallThickness=function(c){if(c!==this.wallThickness){var d=this.wallThickness;this.wallThickness=c;this.firePropertyChange("WALL_THICKNESS",d,c)}};a.prototype.getWallDistance=function(){return this.wallDistance};a.prototype.setWallDistance=function(c){if(c!==this.wallDistance){var d=this.wallDistance;this.wallDistance=c;this.firePropertyChange("WALL_DISTANCE",d,c)}};a.prototype.getWallWidth=function(){return this.wallWidth};a.prototype.setWallWidth=function(d){if(d!==this.wallWidth){var c=this.wallWidth;this.wallWidth=d;this.firePropertyChange("WALL_WIDTH",c,d)}};a.prototype.getWallLeft=function(){return this.wallLeft};a.prototype.setWallLeft=function(d){if(d!==this.wallLeft){var c=this.wallLeft;this.wallLeft=d;this.firePropertyChange("WALL_LEFT",c,d)}};a.prototype.getWallHeight=function(){return this.wallHeight};a.prototype.setWallHeight=function(c){if(c!==this.wallHeight){var d=this.wallHeight;this.wallHeight=c;this.firePropertyChange("WALL_HEIGHT",d,c)}};a.prototype.getWallTop=function(){return this.wallTop};a.prototype.setWallTop=function(d){if(d!==this.wallTop){var c=this.wallTop;this.wallTop=d;this.firePropertyChange("WALL_TOP",c,d)}};a.prototype.getSashes=function(){if(this.sashes.length===0){return this.sashes}else{return this.sashes.slice(0)}};a.prototype.setSashes=function(d){if(!(function(f,e){if(f==null&&e==null){return true}if(f==null||e==null){return false}if(f.length!=e.length){return false}for(var g=0;g<f.length;g++){if(f[g]!=e[g]){return false}}return true})(d,this.sashes)){var c=this.sashes.length===0?this.sashes:this.sashes.slice(0);this.sashes=d.length===0?d:d.slice(0);this.firePropertyChange("SASHES",c,d)}};a.prototype.getCutOutShape=function(){return this.cutOutShape};a.prototype.setCutOutShape=function(c){if(c!==this.cutOutShape&&(c==null||!(c===this.cutOutShape))){var d=this.cutOutShape;this.cutOutShape=c;this.firePropertyChange("CUT_OUT_SHAPE",d,c)}};a.prototype.isWallCutOutOnBothSides=function(){return this.wallCutOutOnBothSides};a.prototype.setWallCutOutOnBothSides=function(c){if(c!==this.wallCutOutOnBothSides){this.wallCutOutOnBothSides=c;this.firePropertyChange("WALL_CUT_OUT_ON_BOTH_SIDES",!c,c)}};a.prototype.isWidthDepthDeformable=function(){return this.widthDepthDeformable};a.prototype.setWidthDepthDeformable=function(c){if(c!==this.widthDepthDeformable){this.widthDepthDeformable=c;this.firePropertyChange("WIDTH_DEPTH_DEFORMABLE",!c,c)}};a.prototype.isBoundToWall=function(){return this.boundToWall};a.prototype.setBoundToWall=function(c){if(c!==this.boundToWall){this.boundToWall=c;this.firePropertyChange("BOUND_TO_WALL",!c,c)}};a.prototype.setX=function(c){if(this.getX()!==c){this.boundToWall=false}b.prototype.setX.call(this,c)};a.prototype.setY=function(c){if(this.getY()!==c){this.boundToWall=false}b.prototype.setY.call(this,c)};a.prototype.setAngle=function(c){if(this.getAngle()!==c){this.boundToWall=false}b.prototype.setAngle.call(this,c)};a.prototype.setDepth=function(c){if(this.getDepth()!==c){this.boundToWall=false}b.prototype.setDepth.call(this,c)};a.prototype.isDoorOrWindow=function(){return true};a.prototype.duplicate=function(){var c=b.prototype.duplicate.call(this);c.boundToWall=false;return c};return a}(HomePieceOfFurniture));HomeDoorOrWindow.__class="com.eteks.sweethome3d.model.HomeDoorOrWindow";HomeDoorOrWindow.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.DoorOrWindow","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"];HomeDoorOrWindow.__transients=["shapeCache","propertyChangeSupport"];var HomeFurnitureGroup=(function(b){__extends(a,b);function a(A,u,F,E,J){var D=this;if(((typeof A==="string")||A===null)&&((u!=null&&(u instanceof Array))||u===null)&&((typeof F==="number")||F===null)&&((typeof E==="boolean")||E===null)&&((typeof J==="string")||J===null)){var j=arguments;D=b.call(this,A,u[0])||this;if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}D.furniture=u.slice(0);D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var h=true;var f=false;for(var k=0;k<u.length;k++){var g=u[k];h=g.isMovable()&&h;f=g.isVisible()||f}D.setName(J);D.setCatalogId(null);D.setDescription(null);D.setInformation(null);D.setCreator(null);D.setNameVisible(false);D.setNameXOffset(0);D.setNameYOffset(0);D.setNameAngle(0);D.setNameStyle(null);b.prototype.setIcon.call(D,null);b.prototype.setPlanIcon.call(D,null);b.prototype.setModel.call(D,null);b.prototype.setMovable.call(D,h);b.prototype.setAngle.call(D,F);b.prototype.setModelMirrored.call(D,E);D.setVisible(f);D.updateLocationAndSize(u,F,true);D.addFurnitureListener()}else{if(((A!=null&&(A instanceof Array))||A===null)&&((typeof u==="number")||u===null)&&((typeof F==="boolean")||F===null)&&((typeof E==="string")||E===null)&&J===undefined){var j=arguments;var v=j[0];var I=j[1];var e=j[2];var C=j[3];var z=arguments;var s=HomeObject.createId("furnitureGroup");D=b.call(this,s,v[0])||this;if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}D.furniture=v.slice(0);D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var h=true;var f=false;for(var k=0;k<v.length;k++){var g=v[k];h=g.isMovable()&&h;f=g.isVisible()||f}D.setName(C);D.setCatalogId(null);D.setDescription(null);D.setInformation(null);D.setCreator(null);D.setNameVisible(false);D.setNameXOffset(0);D.setNameYOffset(0);D.setNameAngle(0);D.setNameStyle(null);b.prototype.setIcon.call(D,null);b.prototype.setPlanIcon.call(D,null);b.prototype.setModel.call(D,null);b.prototype.setMovable.call(D,h);b.prototype.setAngle.call(D,I);b.prototype.setModelMirrored.call(D,e);D.setVisible(f);D.updateLocationAndSize(v,I,true);D.addFurnitureListener();if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}}else{if(((A!=null&&(A instanceof Array))||A===null)&&((u!=null&&u instanceof HomePieceOfFurniture)||u===null)&&((typeof F==="string")||F===null)&&E===undefined&&J===undefined){var j=arguments;var r=j[0];var y=j[1];var B=j[2];var w=arguments;var H=y.getAngle();var d=false;var t=arguments;var p=HomeObject.createId("furnitureGroup");D=b.call(this,p,r[0])||this;if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}D.furniture=r.slice(0);D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var h=true;var f=false;for(var k=0;k<r.length;k++){var g=r[k];h=g.isMovable()&&h;f=g.isVisible()||f}D.setName(B);D.setCatalogId(null);D.setDescription(null);D.setInformation(null);D.setCreator(null);D.setNameVisible(false);D.setNameXOffset(0);D.setNameYOffset(0);D.setNameAngle(0);D.setNameStyle(null);b.prototype.setIcon.call(D,null);b.prototype.setPlanIcon.call(D,null);b.prototype.setModel.call(D,null);b.prototype.setMovable.call(D,h);b.prototype.setAngle.call(D,H);b.prototype.setModelMirrored.call(D,d);D.setVisible(f);D.updateLocationAndSize(r,H,true);D.addFurnitureListener();if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}}else{if(((A!=null&&(A instanceof Array))||A===null)&&((typeof u==="string")||u===null)&&F===undefined&&E===undefined&&J===undefined){var j=arguments;var o=j[0];var x=j[1];var q=arguments;var y=q[0][0];var n=arguments;var G=y.getAngle();var c=false;var m=arguments;var l=HomeObject.createId("furnitureGroup");D=b.call(this,l,o[0])||this;if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}D.furniture=o.slice(0);D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;var h=true;var f=false;for(var k=0;k<o.length;k++){var g=o[k];h=g.isMovable()&&h;f=g.isVisible()||f}D.setName(x);D.setCatalogId(null);D.setDescription(null);D.setInformation(null);D.setCreator(null);D.setNameVisible(false);D.setNameXOffset(0);D.setNameYOffset(0);D.setNameAngle(0);D.setNameStyle(null);b.prototype.setIcon.call(D,null);b.prototype.setPlanIcon.call(D,null);b.prototype.setModel.call(D,null);b.prototype.setMovable.call(D,h);b.prototype.setAngle.call(D,G);b.prototype.setModelMirrored.call(D,c);D.setVisible(f);D.updateLocationAndSize(o,G,true);D.addFurnitureListener();if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}if(D.furniture===undefined){D.furniture=null}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=false}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=false}if(D.fixedWidth===undefined){D.fixedWidth=0}if(D.fixedDepth===undefined){D.fixedDepth=0}if(D.fixedHeight===undefined){D.fixedHeight=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=0}if(D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency===undefined){D.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}if(D.furnitureListener===undefined){D.furnitureListener=null}}else{throw new Error("invalid overload")}}}}return D}a.prototype.updateLocationAndSize=function(j,s,p){this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=true;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=j[0].getCurrency();for(var f=0;f<j.length;f++){var e=j[f];this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable=e.isResizable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable=e.isDeformable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable=e.isTexturable()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable;this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow=e.isDoorOrWindow()&&this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow;if(this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency!=null){if(e.getCurrency()==null||!(e.getCurrency()===this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency)){this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency=null}}}var m=3.4028235e+38;if(p){var u=null;for(var f=0;f<j.length;f++){var e=j[f];var c=e.getLevel();if(c!=null&&(u==null||c.getElevation()<u.getElevation())){u=c}}for(var f=0;f<j.length;f++){var e=j[f];if(e.getLevel()!=null){m=Math.min(m,e.getGroundElevation()-u.getElevation());e.setElevation(e.getGroundElevation()-u.getElevation());e.setLevel(null)}else{m=Math.min(m,e.getElevation())}}}else{for(var f=0;f<j.length;f++){var e=j[f];m=Math.min(m,e.getElevation())}}var k=0;var o=-1;for(var f=0;f<j.length;f++){var e=j[f];k=Math.max(k,e.getElevation()+e.getHeightInPlan());if(e.getDropOnTopElevation()>=0){o=Math.max(o,e.getElevation()+e.getHeightInPlan()*e.getDropOnTopElevation())}}k-=m;o-=m;var n=java.awt.geom.AffineTransform.getRotateInstance(-s);var h=null;var g=this.getFurnitureWithoutGroups(j);for(var f=0;f<g.length;f++){var e=g[f];var d=new java.awt.geom.GeneralPath();var q=e.getPoints();d.moveTo(q[0][0],q[0][1]);for(var r=1;r<q.length;r++){d.lineTo(q[r][0],q[r][1])}d.closePath();if(h==null){h=d.createTransformedShape(n).getBounds2D()}else{h.add(d.createTransformedShape(n).getBounds2D())}}var t=new java.awt.geom.Point2D.Float(h.getCenterX(),h.getCenterY());n.setToRotation(s);n.transform(t,t);if(this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){var l=h.getWidth();b.prototype.setWidth.call(this,l);b.prototype.setWidthInPlan.call(this,l);var v=h.getHeight();b.prototype.setDepth.call(this,v);b.prototype.setDepthInPlan.call(this,v);b.prototype.setHeight.call(this,k);b.prototype.setHeightInPlan.call(this,k)}else{this.fixedWidth=h.getWidth();this.fixedDepth=h.getHeight();this.fixedHeight=k}this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation=o/k;b.prototype.setX.call(this,t.getX());b.prototype.setY.call(this,t.getY());b.prototype.setElevation.call(this,m)};a.prototype.addFurnitureListener=function(){this.furnitureListener=new a.LocationAndSizeChangeListener(this);for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.addPropertyChangeListener(this.furnitureListener)}};a.prototype.getFurnitureWithoutGroups=function(f){var e=([]);for(var c=0;c<f.length;c++){var d=f[c];if(d!=null&&d instanceof a){(function(h,g){return h.push.apply(h,g)})(e,this.getFurnitureWithoutGroups(d.getFurniture()))}else{(e.push(d)>0)}}return e};a.prototype.getAllFurniture=function(){var e=(this.furniture.slice(0));var f=this.getFurniture();for(var c=0;c<f.length;c++){var d=f[c];if(d!=null&&d instanceof a){(function(h,g){return h.push.apply(h,g)})(e,d.getAllFurniture())}}return e};a.prototype.getFurniture=function(){return this.furniture.slice(0)};a.prototype.addPieceOfFurniture=function(d,c){this.furniture=(this.furniture.slice(0));d.setLevel(this.getLevel());this.furniture.splice(c,0,d);d.addPropertyChangeListener(this.furnitureListener);this.updateLocationAndSize(this.furniture,this.getAngle(),false)};a.prototype.deletePieceOfFurniture=function(d){var c=this.furniture.indexOf(d);if(c!==-1){if(this.furniture.length>1){d.setLevel(null);d.removePropertyChangeListener(this.furnitureListener);this.furniture=(this.furniture.slice(0));this.furniture.splice(c,1)[0];this.updateLocationAndSize(this.furniture,this.getAngle(),false)}else{throw new IllegalStateException("Group can't be empty")}}};a.prototype.getCatalogId=function(){return b.prototype.getCatalogId.call(this)};a.prototype.getInformation=function(){return b.prototype.getInformation.call(this)};a.prototype.isMovable=function(){return b.prototype.isMovable.call(this)};a.prototype.setMovable=function(c){b.prototype.setMovable.call(this,c)};a.prototype.isDoorOrWindow=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_doorOrWindow};a.prototype.isResizable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable};a.prototype.isDeformable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_deformable};a.prototype.isTexturable=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_texturable};a.prototype.isHorizontallyRotatable=function(){return false};a.prototype.getWidth=function(){if(!this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){return this.fixedWidth}else{return b.prototype.getWidth.call(this)}};a.prototype.getWidthInPlan=function(){return this.getWidth()};a.prototype.getDepth=function(){if(!this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){return this.fixedDepth}else{return b.prototype.getDepth.call(this)}};a.prototype.getDepthInPlan=function(){return this.getDepth()};a.prototype.getHeight=function(){if(!this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_resizable){return this.fixedHeight}else{return b.prototype.getHeight.call(this)}};a.prototype.getHeightInPlan=function(){return this.getHeight()};a.prototype.isHorizontallyRotated=function(){if(b.prototype.isHorizontallyRotated.call(this)){return true}else{var e=this.getFurniture();for(var d=0;d<e.length;d++){var c=e[d];if(c.isHorizontallyRotated()){return true}}return false}};a.prototype.getDropOnTopElevation=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_dropOnTopElevation};a.prototype.getIcon=function(){return null};a.prototype.setIcon=function(c){throw new IllegalStateException("Can't set icon of a group")};a.prototype.getPlanIcon=function(){return null};a.prototype.setPlanIcon=function(c){throw new IllegalStateException("Can't set plan icon of a group")};a.prototype.getModel=function(){return null};a.prototype.setModel=function(c){throw new IllegalStateException("Can't set model of a group")};a.prototype.getModelSize=function(){return null};a.prototype.setModelSize=function(c){throw new IllegalStateException("Can't set model size of a group")};a.prototype.getModelRotation=function(){return PieceOfFurniture.IDENTITY_ROTATION_$LI$()};a.prototype.setModelRotation=function(c){throw new IllegalStateException("Can't set model rotation of a group")};a.prototype.isModelCenteredAtOrigin=function(){return true};a.prototype.getModelFlags=function(){return 0};a.prototype.setModelFlags=function(c){throw new IllegalStateException("Can't set model flags attribute of a group")};a.prototype.isBackFaceShown=function(){return false};a.prototype.setBackFaceShown=function(c){throw new IllegalStateException("Can't set back face shown attribute of a group")};a.prototype.getModelTransformations=function(){return null};a.prototype.setModelTransformations=function(e){if(this.isDeformable()){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setModelTransformations(e)}}};a.prototype.getPitch=function(){return 0};a.prototype.getRoll=function(){return 0};a.prototype.getStaircaseCutOutShape=function(){return null};a.prototype.setStaircaseCutOutShape=function(c){throw new IllegalStateException("Can't set staircase cut out shape of a group")};a.prototype.getCreator=function(){return b.prototype.getCreator.call(this)};a.prototype.getPrice=function(){var e=null;for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];if(d.getPrice()!=null){if(e==null){e=d.getPrice()}else{e=e.plus(d.getPrice())}}}if(e==null){return b.prototype.getPrice.call(this)}else{return e}};a.prototype.setPrice=function(e){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];if(d.getPrice()!=null){throw new UnsupportedOperationException("Can't change the price of a group containing pieces with a price")}}b.prototype.setPrice.call(this,e)};a.prototype.getValueAddedTaxPercentage=function(){var e=this.furniture[0].getValueAddedTaxPercentage();if(e!=null){for(var d=0;d<this.furniture.length;d++){var f=this.furniture[d];var c=f.getValueAddedTaxPercentage();if(c==null||!((e)!=null?c.eq(e):(c===(e)))){return null}}}return e};a.prototype.getCurrency=function(){return this.__com_eteks_sweethome3d_model_HomeFurnitureGroup_currency};a.prototype.getValueAddedTax=function(){var c=null;for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];var f=e.getValueAddedTax();if(f!=null){if(c==null){c=f}else{c=c.plus(f)}}}return c};a.prototype.getPriceValueAddedTaxIncluded=function(){var c=null;for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];if(e.getPrice()!=null){if(c==null){c=e.getPriceValueAddedTaxIncluded()}else{c=c.plus(e.getPriceValueAddedTaxIncluded())}}}return c};a.prototype.getColor=function(){return null};a.prototype.setColor=function(c){if(this.isTexturable()){for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.setColor(c)}}};a.prototype.getTexture=function(){return null};a.prototype.setTexture=function(e){if(this.isTexturable()){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setTexture(e)}}};a.prototype.getModelMaterials=function(){return null};a.prototype.setModelMaterials=function(d){if(this.isTexturable()){for(var c=0;c<this.furniture.length;c++){var e=this.furniture[c];e.setModelMaterials(d)}}};a.prototype.getShininess=function(){return null};a.prototype.setShininess=function(d){if(this.isTexturable()){for(var c=0;c<this.furniture.length;c++){var e=this.furniture[c];e.setShininess(d)}}};a.prototype.setAngle=function(k){if(k!==this.getAngle()){var c=k-this.getAngle();var f=Math.cos(c);var g=Math.sin(c);for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.removePropertyChangeListener(this.furnitureListener);e.setAngle(e.getAngle()+c);var j=this.getX()+((e.getX()-this.getX())*f-(e.getY()-this.getY())*g);var h=this.getY()+((e.getX()-this.getX())*g+(e.getY()-this.getY())*f);e.setX(j);e.setY(h);e.addPropertyChangeListener(this.furnitureListener)}b.prototype.setAngle.call(this,k)}};a.prototype.setX=function(c){if(c!==this.getX()){var d=c-this.getX();for(var e=0;e<this.furniture.length;e++){var f=this.furniture[e];f.removePropertyChangeListener(this.furnitureListener);f.setX(f.getX()+d);f.addPropertyChangeListener(this.furnitureListener)}b.prototype.setX.call(this,c)}};a.prototype.setY=function(f){if(f!==this.getY()){var c=f-this.getY();for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.removePropertyChangeListener(this.furnitureListener);e.setY(e.getY()+c);e.addPropertyChangeListener(this.furnitureListener)}b.prototype.setY.call(this,f)}};a.prototype.setWidth=function(d){if(d!==this.getWidth()){var k=d/this.getWidth();var h=this.getAngle();for(var j=0;j<this.furniture.length;j++){var o=this.furniture[j];o.removePropertyChangeListener(this.furnitureListener);var g=o.getAngle()-h;var m=o.getWidth();var e=o.getDepth();o.setWidth(m+m*(k-1)*Math.abs(Math.cos(g)));o.setDepth(e+e*(k-1)*Math.abs(Math.sin(g)));var l=Math.cos(h);var f=Math.sin(h);var c=this.getX()+((o.getX()-this.getX())*l+(o.getY()-this.getY())*f);var n=this.getY()+((o.getX()-this.getX())*-f+(o.getY()-this.getY())*l);c=this.getX()+(c-this.getX())*k;o.setX(this.getX()+((c-this.getX())*l-(n-this.getY())*f));o.setY(this.getY()+((c-this.getX())*f+(n-this.getY())*l));o.addPropertyChangeListener(this.furnitureListener)}b.prototype.setWidth.call(this,d)}};a.prototype.setDepth=function(j){if(j!==this.getDepth()){var d=j/this.getDepth();var h=this.getAngle();for(var k=0;k<this.furniture.length;k++){var o=this.furniture[k];o.removePropertyChangeListener(this.furnitureListener);var g=o.getAngle()-h;var m=o.getWidth();var e=o.getDepth();o.setWidth(m+m*(d-1)*Math.abs(Math.sin(g)));o.setDepth(e+e*(d-1)*Math.abs(Math.cos(g)));var l=Math.cos(h);var f=Math.sin(h);var c=this.getX()+((o.getX()-this.getX())*l+(o.getY()-this.getY())*f);var n=this.getY()+((o.getX()-this.getX())*-f+(o.getY()-this.getY())*l);n=this.getY()+(n-this.getY())*d;o.setX(this.getX()+((c-this.getX())*l-(n-this.getY())*f));o.setY(this.getY()+((c-this.getX())*f+(n-this.getY())*l));o.addPropertyChangeListener(this.furnitureListener)}b.prototype.setDepth.call(this,j)}};a.prototype.setHeight=function(c){if(c!==this.getHeight()){var e=c/this.getHeight();for(var d=0;d<this.furniture.length;d++){var f=this.furniture[d];f.removePropertyChangeListener(this.furnitureListener);f.setHeight(f.getHeight()*e);f.setElevation(this.getElevation()+(f.getElevation()-this.getElevation())*e);f.addPropertyChangeListener(this.furnitureListener)}b.prototype.setHeight.call(this,c)}};a.prototype.scale=function(k){var j=this.getAngle();for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];e.removePropertyChangeListener(this.furnitureListener);e.setWidth(e.getWidth()*k);e.setDepth(e.getDepth()*k);e.setHeight(e.getHeight()*k);var c=Math.cos(j);var f=Math.sin(j);var h=this.getX()+((e.getX()-this.getX())*c+(e.getY()-this.getY())*f);var g=this.getY()+((e.getX()-this.getX())*-f+(e.getY()-this.getY())*c);h=this.getX()+(h-this.getX())*k;g=this.getY()+(g-this.getY())*k;e.setX(this.getX()+((h-this.getX())*c-(g-this.getY())*f));e.setY(this.getY()+((h-this.getX())*f+(g-this.getY())*c));e.setElevation(this.getElevation()+(e.getElevation()-this.getElevation())*k);e.addPropertyChangeListener(this.furnitureListener)}b.prototype.setWidth.call(this,this.getWidth()*k);b.prototype.setDepth.call(this,this.getDepth()*k);b.prototype.setHeight.call(this,this.getHeight()*k)};a.prototype.setElevation=function(e){if(e!==this.getElevation()){var f=e-this.getElevation();for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.removePropertyChangeListener(this.furnitureListener);d.setElevation(d.getElevation()+f);d.addPropertyChangeListener(this.furnitureListener)}b.prototype.setElevation.call(this,e)}};a.prototype.setModelMirrored=function(c){if(c!==this.isModelMirrored()){var k=this.getAngle();for(var e=0;e<this.furniture.length;e++){var f=this.furniture[e];f.removePropertyChangeListener(this.furnitureListener);f.setModelMirrored(!f.isModelMirrored());var d=Math.cos(k);var g=Math.sin(k);var j=this.getX()+((f.getX()-this.getX())*d+(f.getY()-this.getY())*g);var h=this.getY()+((f.getX()-this.getX())*-g+(f.getY()-this.getY())*d);j=this.getX()-(j-this.getX());f.setX(this.getX()+((j-this.getX())*d-(h-this.getY())*g));f.setY(this.getY()+((j-this.getX())*g+(h-this.getY())*d));f.addPropertyChangeListener(this.furnitureListener)}b.prototype.setModelMirrored.call(this,c)}};a.prototype.setVisible=function(e){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setVisible(e)}b.prototype.setVisible.call(this,e)};a.prototype.setLevel=function(e){for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];d.setLevel(e)}b.prototype.setLevel.call(this,e)};a.prototype.intersectsRectangle=function(e,h,d,g){for(var c=0;c<this.furniture.length;c++){var f=this.furniture[c];if(f.intersectsRectangle(e,h,d,g)){return true}}return false};a.prototype.containsPoint=function(c,g,f){for(var d=0;d<this.furniture.length;d++){var e=this.furniture[d];if(e.containsPoint(c,g,f)){return true}}return false};a.prototype.duplicate=function(){var g=b.prototype.duplicate.call(this);var c=([]);for(var d=0;d<g.furniture.length;d++){var f=g.furniture[d];f.removePropertyChangeListener(g.furnitureListener);var e=f.duplicate();(c.push(e)>0);e.addPropertyChangeListener(g.furnitureListener)}g.furniture=c.slice(0);return g};a.prototype.clone=function(){var f=this;var e=(function(j){if(b.prototype.clone!=undefined){return b.prototype.clone.call(f)}else{var g=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){g[h]=j[h]}}return g}})(this);e.furniture=([]);for(var c=0;c<this.furniture.length;c++){var d=this.furniture[c];(e.furniture.push((function(j){if(j.clone!=undefined){return j.clone()}else{var h=Object.create(j);for(var g in j){if(j.hasOwnProperty(g)){h[g]=j[g]}}return h}})(d))>0)}e.furniture=e.furniture.slice(0);e.addFurnitureListener();return e};return a}(HomePieceOfFurniture));HomeFurnitureGroup.__class="com.eteks.sweethome3d.model.HomeFurnitureGroup";HomeFurnitureGroup.__interfaces=["com.eteks.sweethome3d.model.Selectable","com.eteks.sweethome3d.model.PieceOfFurniture","com.eteks.sweethome3d.model.Elevatable"];(function(a){var b=(function(){function c(d){if(this.group===undefined){this.group=null}this.group=(d)}c.prototype.propertyChange=function(d){var e=this.group;if(e==null){d.getSource().removePropertyChangeListener(this)}else{if(("X"===d.getPropertyName())||("Y"===d.getPropertyName())||("ELEVATION"===d.getPropertyName())||("ANGLE"===d.getPropertyName())||("WIDTH_IN_PLAN"===d.getPropertyName())||("DEPTH_IN_PLAN"===d.getPropertyName())||("HEIGHT_IN_PLAN"===d.getPropertyName())){e.updateLocationAndSize(e.getFurniture(),e.getAngle(),false)}}};return c}());a.LocationAndSizeChangeListener=b;b.__class="com.eteks.sweethome3d.model.HomeFurnitureGroup.LocationAndSizeChangeListener"})(HomeFurnitureGroup||(HomeFurnitureGroup={}));HomeFurnitureGroup.__transients=["furnitureListener","shapeCache","propertyChangeSupport"];var ObserverCamera=(function(b){__extends(a,b);function a(c,r,p,n,g,d,k){var m=this;if(((typeof c==="string")||c===null)&&((typeof r==="number")||r===null)&&((typeof p==="number")||p===null)&&((typeof n==="number")||n===null)&&((typeof g==="number")||g===null)&&((typeof d==="number")||d===null)&&((typeof k==="number")||k===null)){var l=arguments;m=b.call(this,c,r,p,n,g,d,k)||this;if(m.fixedSize===undefined){m.fixedSize=false}if(m.shapeCache===undefined){m.shapeCache=null}if(m.rectangleShapeCache===undefined){m.rectangleShapeCache=null}m.planScale=1}else{if(((typeof c==="number")||c===null)&&((typeof r==="number")||r===null)&&((typeof p==="number")||p===null)&&((typeof n==="number")||n===null)&&((typeof g==="number")||g===null)&&((typeof d==="number")||d===null)&&k===undefined){var l=arguments;var o=l[0];var s=l[1];var e=l[2];var q=l[3];var f=l[4];var t=l[5];var j=arguments;var h=HomeObject.createId("observerCamera");m=b.call(this,h,o,s,e,q,f,t)||this;if(m.fixedSize===undefined){m.fixedSize=false}if(m.shapeCache===undefined){m.shapeCache=null}if(m.rectangleShapeCache===undefined){m.rectangleShapeCache=null}m.planScale=1;if(m.fixedSize===undefined){m.fixedSize=false}if(m.shapeCache===undefined){m.shapeCache=null}if(m.rectangleShapeCache===undefined){m.rectangleShapeCache=null}m.planScale=1}else{throw new Error("invalid overload")}}return m}a.prototype.setFixedSize=function(e){if(this.fixedSize!==e){var c=this.getWidth();var d=this.getDepth();var f=this.getHeight();this.fixedSize=e;this.shapeCache=null;this.rectangleShapeCache=null;this.firePropertyChange("WIDTH",c,this.getWidth());this.firePropertyChange("DEPTH",d,this.getDepth());this.firePropertyChange("HEIGHT",f,this.getHeight())}};a.prototype.isFixedSize=function(){return this.fixedSize};a.prototype.setPlanScale=function(e){if(this.planScale!==e){var c=this.getWidth();var d=this.getDepth();var f=this.getHeight();this.planScale=e;this.shapeCache=null;this.rectangleShapeCache=null;this.firePropertyChange("WIDTH",c,this.getWidth());this.firePropertyChange("DEPTH",d,this.getDepth());this.firePropertyChange("HEIGHT",f,this.getHeight())}};a.prototype.getPlanScale=function(){return this.planScale};a.prototype.setYaw=function(c){b.prototype.setYaw.call(this,c);this.shapeCache=null;this.rectangleShapeCache=null};a.prototype.setX=function(c){b.prototype.setX.call(this,c);this.shapeCache=null;this.rectangleShapeCache=null};a.prototype.setY=function(c){b.prototype.setY.call(this,c);this.shapeCache=null;this.rectangleShapeCache=null};a.prototype.setZ=function(e){var c=this.getWidth();var d=this.getDepth();var f=this.getHeight();b.prototype.setZ.call(this,e);this.shapeCache=null;this.rectangleShapeCache=null;this.firePropertyChange("WIDTH",c,this.getWidth());this.firePropertyChange("DEPTH",d,this.getDepth());this.firePropertyChange("HEIGHT",f,this.getHeight())};a.prototype.getWidth=function(){if(this.fixedSize||this.planScale>1){return 46.6*this.planScale}else{var c=this.getZ()*4/14;return Math.min(Math.max(c,20),62.5)*this.planScale}};a.prototype.getDepth=function(){if(this.fixedSize||this.planScale>1){return 18.6*this.planScale}else{var c=this.getZ()*8/70;return Math.min(Math.max(c,8),25)*this.planScale}};a.prototype.getHeight=function(){if(this.fixedSize||this.planScale>1){return 175*this.planScale}else{return this.getZ()*15/14*this.planScale}};a.prototype.getPoints=function(){var e=(function(g){var f=function(j){if(j.length===0){return 0}else{var k=[];for(var h=0;h<j[0];h++){k.push(f(j.slice(1)))}return k}};return f(g)})([4,2]);var d=this.getRectangleShape().getPathIterator(null);for(var c=0;c<e.length;c++){d.currentSegment(e[c]);d.next()}return e};a.prototype.intersectsRectangle=function(e,g,c,f){var d=new java.awt.geom.Rectangle2D.Float(e,g,0,0);d.add(c,f);return this.getShape().intersects(d)};a.prototype.containsPoint=function(c,e,d){if(d===0){return this.getShape().contains(c,e)}else{return this.getShape().intersects(c-d,e-d,2*d,2*d)}};a.prototype.getShape=function(){if(this.shapeCache==null){if(this.planScale<=1){var c=new java.awt.geom.Ellipse2D.Float(this.getX()-this.getWidth()/2,this.getY()-this.getDepth()/2,this.getWidth(),this.getDepth());var d=java.awt.geom.AffineTransform.getRotateInstance(this.getYaw(),this.getX(),this.getY());var f=c.getPathIterator(d);var e=new java.awt.geom.GeneralPath();e.append(f,false);this.shapeCache=e}else{this.shapeCache=this.getRectangleShape()}}return this.shapeCache};a.prototype.getRectangleShape=function(){if(this.rectangleShapeCache==null){var c=new java.awt.geom.Rectangle2D.Float(this.getX()-this.getWidth()/2,this.getY()-this.getDepth()/2,this.getWidth(),this.getDepth());var d=java.awt.geom.AffineTransform.getRotateInstance(this.getYaw(),this.getX(),this.getY());var e=c.getPathIterator(d);var f=new java.awt.geom.GeneralPath();f.append(e,false);this.rectangleShapeCache=f}return this.rectangleShapeCache};a.prototype.move=function(d,c){this.setX(this.getX()+d);this.setY(this.getY()+c)};a.prototype.clone=function(){var c=this;return(function(e){if(b.prototype.clone!=undefined){return b.prototype.clone.call(c)}else{var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f}})(this)};return a}(Camera));ObserverCamera.__class="com.eteks.sweethome3d.model.ObserverCamera";ObserverCamera.__interfaces=["com.eteks.sweethome3d.model.Selectable"];ObserverCamera.__transients=["planScale","shapeCache","rectangleShapeCache","lens","propertyChangeSupport"];var Home=(function(){function a(l,b){if(((l!=null&&(l instanceof Array))||l===null)&&((typeof b==="number")||b===null)){var j=arguments;if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(l.slice(0));this.walls=([]);this.wallHeight=b;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.furnitureVisiblePropertyNames=([]);for(var k=0;k<this.furnitureVisibleProperties.length;k++){var n=this.furnitureVisibleProperties[k];(this.furnitureVisiblePropertyNames.push(n)>0)}this.init(true);this.addModelListeners()}else{if(((l!=null&&(l instanceof Array))||l===null)&&b===undefined){var j=arguments;var h=arguments;var q=250;if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(l.slice(0));this.walls=([]);this.wallHeight=q;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.furnitureVisiblePropertyNames=([]);for(var k=0;k<this.furnitureVisibleProperties.length;k++){var n=this.furnitureVisibleProperties[k];(this.furnitureVisiblePropertyNames.push(n)>0)}this.init(true);this.addModelListeners();if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}}else{if(((l!=null&&l instanceof a)||l===null)&&b===undefined){var j=arguments;var m=j[0];if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.wallHeight=m.getWallHeight();a.copyHomeData(m,this);a.initListenersSupport(this);this.addModelListeners()}else{if(((typeof l==="number")||l===null)&&b===undefined){var j=arguments;var p=j[0];var f=arguments;var d=[];if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(d.slice(0));this.walls=([]);this.wallHeight=p;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.furnitureVisiblePropertyNames=([]);for(var k=0;k<this.furnitureVisibleProperties.length;k++){var n=this.furnitureVisibleProperties[k];(this.furnitureVisiblePropertyNames.push(n)>0)}this.init(true);this.addModelListeners();if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}}else{if(l===undefined&&b===undefined){var j=arguments;var g=arguments;var o=250;var e=arguments;var c=[];if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}this.furniture=(c.slice(0));this.walls=([]);this.wallHeight=o;this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","VISIBLE"].slice(0);this.furnitureVisiblePropertyNames=([]);for(var k=0;k<this.furnitureVisibleProperties.length;k++){var n=this.furnitureVisibleProperties[k];(this.furnitureVisiblePropertyNames.push(n)>0)}this.init(true);this.addModelListeners();if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}if(this.furniture===undefined){this.furniture=null}if(this.furnitureChangeSupport===undefined){this.furnitureChangeSupport=null}if(this.selectedItems===undefined){this.selectedItems=null}if(this.selectionListeners===undefined){this.selectionListeners=null}if(this.allLevelsSelection===undefined){this.allLevelsSelection=false}if(this.levels===undefined){this.levels=null}if(this.selectedLevel===undefined){this.selectedLevel=null}if(this.levelsChangeSupport===undefined){this.levelsChangeSupport=null}if(this.walls===undefined){this.walls=null}if(this.wallsChangeSupport===undefined){this.wallsChangeSupport=null}if(this.rooms===undefined){this.rooms=null}if(this.roomsChangeSupport===undefined){this.roomsChangeSupport=null}if(this.polylines===undefined){this.polylines=null}if(this.polylinesChangeSupport===undefined){this.polylinesChangeSupport=null}if(this.dimensionLines===undefined){this.dimensionLines=null}if(this.dimensionLinesChangeSupport===undefined){this.dimensionLinesChangeSupport=null}if(this.labels===undefined){this.labels=null}if(this.labelsChangeSupport===undefined){this.labelsChangeSupport=null}if(this.camera===undefined){this.camera=null}if(this.name===undefined){this.name=null}if(this.wallHeight===undefined){this.wallHeight=0}if(this.modified===undefined){this.modified=false}if(this.recovered===undefined){this.recovered=false}if(this.repaired===undefined){this.repaired=false}if(this.backgroundImage===undefined){this.backgroundImage=null}if(this.observerCamera===undefined){this.observerCamera=null}if(this.topCamera===undefined){this.topCamera=null}if(this.storedCameras===undefined){this.storedCameras=null}if(this.environment===undefined){this.environment=null}if(this.print===undefined){this.print=null}if(this.furnitureSortedPropertyName===undefined){this.furnitureSortedPropertyName=null}if(this.furnitureVisiblePropertyNames===undefined){this.furnitureVisiblePropertyNames=null}if(this.furnitureDescendingSorted===undefined){this.furnitureDescendingSorted=false}if(this.visualProperties===undefined){this.visualProperties=null}if(this.properties===undefined){this.properties=null}if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=null}if(this.version===undefined){this.version=0}if(this.basePlanLocked===undefined){this.basePlanLocked=false}if(this.compass===undefined){this.compass=null}if(this.furnitureAdditionalProperties===undefined){this.furnitureAdditionalProperties=null}if(this.skyColor===undefined){this.skyColor=0}if(this.groundColor===undefined){this.groundColor=0}if(this.groundTexture===undefined){this.groundTexture=null}if(this.lightColor===undefined){this.lightColor=0}if(this.wallsAlpha===undefined){this.wallsAlpha=0}if(this.furnitureSortedProperty===undefined){this.furnitureSortedProperty=null}if(this.furnitureVisibleProperties===undefined){this.furnitureVisibleProperties=null}if(this.furnitureWithDoorsAndWindows===undefined){this.furnitureWithDoorsAndWindows=null}if(this.furnitureWithGroups===undefined){this.furnitureWithGroups=null}}else{throw new Error("invalid overload")}}}}}}a.LEVEL_ELEVATION_COMPARATOR_$LI$=function(){if(a.LEVEL_ELEVATION_COMPARATOR==null){a.LEVEL_ELEVATION_COMPARATOR=function(d,c){var b=(d.getElevation()-c.getElevation());if(b!==0){return b}else{return d.getElevationIndex()-c.getElevationIndex()}}}return a.LEVEL_ELEVATION_COMPARATOR};a.prototype.moveVisualProperty=function(b){var d=this;if(this.visualProperties.hasOwnProperty(b)){var c=(function(e,f){return e[f]===undefined?null:e[f]})(this.visualProperties,b);(this.properties[b]=c!=null?String(c).toString():null);(function(f){var e=d.visualProperties[b];delete d.visualProperties[b];return e})(this.visualProperties)}};a.prototype.init=function(b){this.selectedItems=([]);a.initListenersSupport(this);if(this.furnitureVisibleProperties==null){this.furnitureVisibleProperties=["NAME","WIDTH","DEPTH","HEIGHT","COLOR","MOVABLE","DOOR_OR_WINDOW","VISIBLE"].slice(0)}this.topCamera=new Camera(a.HOME_TOP_CAMERA_ID,50,1050,1010,Math.PI,Math.PI/4,Math.PI*63/180);this.observerCamera=new ObserverCamera(a.HOME_OBSERVER_CAMERA_ID,50,50,170,7*Math.PI/4,Math.PI/16,Math.PI*63/180);this.storedCameras=[];this.environment=new HomeEnvironment(a.HOME_ENVIRONMENT_ID);this.rooms=([]);this.polylines=([]);this.dimensionLines=([]);this.labels=([]);this.compass=new Compass(a.HOME_COMPASS_ID,-100,50,100);this.levels=([]);this.compass.setVisible(b);this.visualProperties=({});this.properties=({});this.furnitureAdditionalProperties=([]);this.version=a.CURRENT_VERSION};a.initListenersSupport=function(b){b.furnitureChangeSupport=(new CollectionChangeSupport(b));b.selectionListeners=([]);b.levelsChangeSupport=(new CollectionChangeSupport(b));b.wallsChangeSupport=(new CollectionChangeSupport(b));b.roomsChangeSupport=(new CollectionChangeSupport(b));b.polylinesChangeSupport=(new CollectionChangeSupport(b));b.dimensionLinesChangeSupport=(new CollectionChangeSupport(b));b.labelsChangeSupport=(new CollectionChangeSupport(b));b.propertyChangeSupport=new PropertyChangeSupport(b)};a.prototype.addModelListeners=function(){var c=new a.Home$0(this);for(var b=0;b<this.levels.length;b++){var d=this.levels[b];d.addPropertyChangeListener(c)}this.addLevelsListener(function(e){switch((e.getType())){case CollectionEvent.Type.ADD:e.getItem().addPropertyChangeListener(c);break;case CollectionEvent.Type.DELETE:e.getItem().removePropertyChangeListener(c);break}})};a.prototype.isFurnitureSortedPropertyBackwardCompatible=function(b){if(b!=null){switch((b)){case"NAME":case"WIDTH":case"DEPTH":case"HEIGHT":case"MOVABLE":case"DOOR_OR_WINDOW":case"COLOR":case"VISIBLE":case"X":case"Y":case"ELEVATION":case"ANGLE":return true;default:return false}}else{return false}};a.prototype.getGroupFurniture=function(d){var c=([]);var f=d.getFurniture();for(var b=0;b<f.length;b++){var e=f[b];if(e!=null&&e instanceof HomeFurnitureGroup){(function(h,g){return h.push.apply(h,g)})(c,this.getGroupFurniture(e))}else{(c.push(e)>0)}}return c};a.prototype.addLevelsListener=function(b){this.levelsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeLevelsListener=function(b){this.levelsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getLevels=function(){return this.levels.slice(0)};a.prototype.addLevel=function(g){if(g.getElevationIndex()<0){var d=0;for(var c=0;c<this.levels.length;c++){var b=this.levels[c];if(b.getElevation()===g.getElevation()){d=b.getElevationIndex()+1}else{if(b.getElevation()>g.getElevation()){break}}}g.setElevationIndex(d)}this.levels=(this.levels.slice(0));var e=(function(h,r,n){var m=n;if(typeof n!="function"){m=function(s,l){return n.compare(s,l)}}var o=0;var j=h.length-1;while(o<=j){var q=(o+j)>>>1;var k=h[q];var p=m(k,r);if(p<0){o=q+1}else{if(p>0){j=q-1}else{return q}}}return -(o+1)})(this.levels,g,a.LEVEL_ELEVATION_COMPARATOR_$LI$());var f;if(e>=0){f=e}else{f=-(e+1)}this.levels.splice(f,0,g);this.levelsChangeSupport.fireCollectionChanged(g,f,CollectionEvent.Type.ADD)};a.prototype.deleteLevel=function(c){var d=this.levels.indexOf(c);if(d!==-1){for(var f=0;f<this.furniture.length;f++){var l=this.furniture[f];if(l.getLevel()===c){this.deletePieceOfFurniture(l)}}for(var f=0;f<this.rooms.length;f++){var b=this.rooms[f];if(b.getLevel()===c){this.deleteRoom(b)}}for(var f=0;f<this.walls.length;f++){var j=this.walls[f];if(j.getLevel()===c){this.deleteWall(j)}}for(var f=0;f<this.polylines.length;f++){var h=this.polylines[f];if(h.getLevel()===c){this.deletePolyline(h)}}for(var f=0;f<this.dimensionLines.length;f++){var k=this.dimensionLines[f];if(k.getLevel()===c){this.deleteDimensionLine(k)}}for(var f=0;f<this.labels.length;f++){var g=this.labels[f];if(g.getLevel()===c){this.deleteLabel(g)}}if(this.selectedLevel===c){if(this.levels.length===1){this.setSelectedLevel(null);this.setAllLevelsSelection(false)}else{this.setSelectedLevel(this.levels[d>=1?d-1:d+1])}}if(this.print!=null&&this.print.getPrintedLevels()!=null){var e=(this.print.getPrintedLevels().slice(0));if((function(m){var n=m.indexOf(c);if(n>=0){m.splice(n,1);return true}else{return false}})(e)){this.print=new HomePrint(this.print.getPaperOrientation(),this.print.getPaperWidth(),this.print.getPaperHeight(),this.print.getPaperTopMargin(),this.print.getPaperLeftMargin(),this.print.getPaperBottomMargin(),this.print.getPaperRightMargin(),this.print.isFurniturePrinted(),this.print.isPlanPrinted(),e,this.print.isView3DPrinted(),this.print.getPlanScale(),this.print.getHeaderFormat(),this.print.getFooterFormat())}}this.levels=(this.levels.slice(0));this.levels.splice(d,1)[0];this.levelsChangeSupport.fireCollectionChanged(c,d,CollectionEvent.Type.DELETE)}};a.prototype.getSelectedLevel=function(){return this.selectedLevel};a.prototype.setSelectedLevel=function(c){if(c!==this.selectedLevel){var b=this.selectedLevel;this.selectedLevel=c;this.propertyChangeSupport.firePropertyChange("SELECTED_LEVEL",b,c)}};a.prototype.isAllLevelsSelection=function(){return this.allLevelsSelection};a.prototype.setAllLevelsSelection=function(b){if(b!==this.allLevelsSelection){this.allLevelsSelection=b;this.propertyChangeSupport.firePropertyChange("ALL_LEVELS_SELECTION",!b,b)}};a.prototype.addFurnitureListener=function(b){this.furnitureChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeFurnitureListener=function(b){this.furnitureChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getFurniture=function(){return this.furniture.slice(0)};a.prototype.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture=function(b){this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(b,this.furniture.length)};a.prototype.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int=function(c,b){this.furniture=(this.furniture.slice(0));c.setLevel(this.selectedLevel);this.furniture.splice(b,0,c);this.furnitureChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.ADD)};a.prototype.addPieceOfFurniture=function(c,b){if(((c!=null&&c instanceof HomePieceOfFurniture)||c===null)&&((typeof b==="number")||b===null)){return this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$int(c,b)}else{if(((c!=null&&c instanceof HomePieceOfFurniture)||c===null)&&b===undefined){return this.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(c)}else{throw new Error("invalid overload")}}};a.prototype.addPieceOfFurnitureToGroup=function(c,d,b){c.setLevel(this.selectedLevel);d.addPieceOfFurniture(c,b);this.furnitureChangeSupport.fireCollectionChanged(c,CollectionEvent.Type.ADD)};a.prototype.deletePieceOfFurniture=function(d){this.deselectItem(d);if(d!=null&&d instanceof HomeFurnitureGroup){var g=d.getAllFurniture();for(var b=0;b<g.length;b++){var f=g[b];this.deselectItem(f)}}var c=this.furniture.indexOf(d);var e=c===-1?this.getPieceOfFurnitureGroup(d,null,this.furniture):null;if(c!==-1||e!=null){d.setLevel(null);this.furniture=(this.furniture.slice(0));if(e!=null){e.deletePieceOfFurniture(d);this.furnitureChangeSupport.fireCollectionChanged(d,CollectionEvent.Type.DELETE)}else{this.furniture.splice(c,1)[0];this.furnitureChangeSupport.fireCollectionChanged(d,c,CollectionEvent.Type.DELETE)}}};a.prototype.getPieceOfFurnitureGroup=function(d,c,f){for(var b=0;b<f.length;b++){var e=f[b];if((function(j,h){if(j&&j.equals){return j.equals(h)}else{return j===h}})(e,d)){return c}else{if(e!=null&&e instanceof HomeFurnitureGroup){var g=this.getPieceOfFurnitureGroup(d,e,e.getFurniture());if(g!=null){return g}}}}return null};a.prototype.addSelectionListener=function(b){(this.selectionListeners.push(b)>0)};a.prototype.removeSelectionListener=function(b){(function(c){var d=c.indexOf(b);if(d>=0){c.splice(d,1);return true}else{return false}})(this.selectionListeners)};a.prototype.getSelectedItems=function(){return this.selectedItems.slice(0)};a.prototype.isItemSelected=function(b){return(this.selectedItems.indexOf((b))>=0)};a.prototype.setSelectedItems=function(g){var f=this.selectedItems.slice(0);this.selectedItems=(g.slice(0));if(!(this.selectionListeners.length==0)){var b=new SelectionEvent(this,f,this.getSelectedItems());var d=this.selectionListeners.slice(0);for(var c=0;c<d.length;c++){var e=d[c];e.selectionChanged(b)}}};a.prototype.deselectItem=function(c){var b=this.selectedItems.indexOf(c);if(b!==-1){var d=(this.getSelectedItems().slice(0));d.splice(b,1)[0];this.setSelectedItems(d)}};a.prototype.addRoomsListener=function(b){this.roomsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeRoomsListener=function(b){this.roomsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getRooms=function(){return this.rooms.slice(0)};a.prototype.addRoom$com_eteks_sweethome3d_model_Room=function(b){this.addRoom$com_eteks_sweethome3d_model_Room$int(b,this.rooms.length)};a.prototype.addRoom$com_eteks_sweethome3d_model_Room$int=function(c,b){this.rooms=(this.rooms.slice(0));this.rooms.splice(b,0,c);c.setLevel(this.selectedLevel);this.roomsChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.ADD)};a.prototype.addRoom=function(c,b){if(((c!=null&&c instanceof Room)||c===null)&&((typeof b==="number")||b===null)){return this.addRoom$com_eteks_sweethome3d_model_Room$int(c,b)}else{if(((c!=null&&c instanceof Room)||c===null)&&b===undefined){return this.addRoom$com_eteks_sweethome3d_model_Room(c)}else{throw new Error("invalid overload")}}};a.prototype.deleteRoom=function(c){this.deselectItem(c);var b=this.rooms.indexOf(c);if(b!==-1){c.setLevel(null);this.rooms=(this.rooms.slice(0));this.rooms.splice(b,1)[0];this.roomsChangeSupport.fireCollectionChanged(c,b,CollectionEvent.Type.DELETE)}};a.prototype.addWallsListener=function(b){this.wallsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeWallsListener=function(b){this.wallsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getWalls=function(){return this.walls.slice(0)};a.prototype.addWall=function(b){this.walls=(this.walls.slice(0));(this.walls.push(b)>0);b.setLevel(this.selectedLevel);this.wallsChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.deleteWall=function(b){this.deselectItem(b);var f=this.getWalls();for(var e=0;e<f.length;e++){var d=f[e];if((function(h,g){if(h&&h.equals){return h.equals(g)}else{return h===g}})(b,d.getWallAtStart())){d.setWallAtStart(null)}else{if((function(h,g){if(h&&h.equals){return h.equals(g)}else{return h===g}})(b,d.getWallAtEnd())){d.setWallAtEnd(null)}}}var c=this.walls.indexOf(b);if(c!==-1){b.setLevel(null);this.walls=(this.walls.slice(0));this.walls.splice(c,1)[0];this.wallsChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.DELETE)}};a.prototype.addPolylinesListener=function(b){this.polylinesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removePolylinesListener=function(b){this.polylinesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getPolylines=function(){return this.polylines.slice(0)};a.prototype.addPolyline$com_eteks_sweethome3d_model_Polyline=function(b){this.addPolyline$com_eteks_sweethome3d_model_Polyline$int(b,this.polylines.length)};a.prototype.addPolyline$com_eteks_sweethome3d_model_Polyline$int=function(b,c){this.polylines=(this.polylines.slice(0));this.polylines.splice(c,0,b);b.setLevel(this.selectedLevel);this.polylinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.addPolyline=function(b,c){if(((b!=null&&b instanceof Polyline)||b===null)&&((typeof c==="number")||c===null)){return this.addPolyline$com_eteks_sweethome3d_model_Polyline$int(b,c)}else{if(((b!=null&&b instanceof Polyline)||b===null)&&c===undefined){return this.addPolyline$com_eteks_sweethome3d_model_Polyline(b)}else{throw new Error("invalid overload")}}};a.prototype.deletePolyline=function(b){this.deselectItem(b);var c=this.polylines.indexOf(b);if(c!==-1){b.setLevel(null);this.polylines=(this.polylines.slice(0));this.polylines.splice(c,1)[0];this.polylinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.DELETE)}};a.prototype.addDimensionLinesListener=function(b){this.dimensionLinesChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeDimensionLinesListener=function(b){this.dimensionLinesChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getDimensionLines=function(){return this.dimensionLines.slice(0)};a.prototype.addDimensionLine=function(b){this.dimensionLines=(this.dimensionLines.slice(0));(this.dimensionLines.push(b)>0);b.setLevel(this.selectedLevel);this.dimensionLinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.deleteDimensionLine=function(b){this.deselectItem(b);var c=this.dimensionLines.indexOf(b);if(c!==-1){b.setLevel(null);this.dimensionLines=(this.dimensionLines.slice(0));this.dimensionLines.splice(c,1)[0];this.dimensionLinesChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.DELETE)}};a.prototype.addLabelsListener=function(b){this.labelsChangeSupport.addCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.removeLabelsListener=function(b){this.labelsChangeSupport.removeCollectionListener(((function(c){if(c==null||typeof c=="function"){return c}return function(d){return(c.collectionChanged?c.collectionChanged:c).call(c,d)}})(b)))};a.prototype.getLabels=function(){return this.labels.slice(0)};a.prototype.addLabel=function(b){this.labels=(this.labels.slice(0));(this.labels.push(b)>0);b.setLevel(this.selectedLevel);this.labelsChangeSupport.fireCollectionChanged(b,CollectionEvent.Type.ADD)};a.prototype.deleteLabel=function(c){this.deselectItem(c);var b=this.labels.indexOf(c);if(b!==-1){c.setLevel(null);this.labels=(this.labels.slice(0));this.labels.splice(b,1)[0];this.labelsChangeSupport.fireCollectionChanged(c,CollectionEvent.Type.DELETE)}};a.prototype.getSelectableViewableItems=function(){var b=([]);this.addViewableItems(this.walls,b);this.addViewableItems(this.rooms,b);this.addViewableItems(this.dimensionLines,b);this.addViewableItems(this.polylines,b);this.addViewableItems(this.labels,b);var e=this.getFurniture();for(var c=0;c<e.length;c++){var d=e[c];if(d.isVisible()&&(d.getLevel()==null||d.getLevel().isViewable())){(b.push(d)>0)}}if(this.compass.isVisible()){(b.push(this.compass)>0)}return b};a.prototype.addViewableItems=function(b,f){for(var c=0;c<b.length;c++){var d=b[c];if(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0)){var e=d;if(e.getLevel()==null||e.getLevel().isViewable()){(f.push(d)>0)}}}};a.prototype.getHomeObjects=function(){var c=([]);(c.push(this.environment)>0);(c.push(this.compass)>0);(function(g,f){return g.push.apply(g,f)})(c,this.levels);(function(g,f){return g.push.apply(g,f)})(c,this.walls);(function(g,f){return g.push.apply(g,f)})(c,this.rooms);(function(g,f){return g.push.apply(g,f)})(c,this.dimensionLines);(function(g,f){return g.push.apply(g,f)})(c,this.polylines);(function(g,f){return g.push.apply(g,f)})(c,this.labels);var e=this.getFurniture();for(var b=0;b<e.length;b++){var d=e[b];(c.push(d)>0);if(d!=null&&d instanceof HomeFurnitureGroup){(function(g,f){return g.push.apply(g,f)})(c,d.getAllFurniture())}}(c.push(this.topCamera)>0);(c.push(this.observerCamera)>0);(function(g,f){return g.push.apply(g,f)})(c,this.storedCameras);(function(g,f){return g.push.apply(g,f)})(c,this.environment.getVideoCameraPath());return c};a.prototype.isEmpty=function(){return(this.furniture.length==0)&&(this.walls.length==0)&&(this.rooms.length==0)&&(this.dimensionLines.length==0)&&(this.polylines.length==0)&&(this.labels.length==0)};a.prototype.getWallHeight=function(){return this.wallHeight};a.prototype.getName=function(){return this.name};a.prototype.setName=function(b){if(b!==this.name&&(b==null||!(b===this.name))){var c=this.name;this.name=b;this.propertyChangeSupport.firePropertyChange("NAME",c,b)}};a.prototype.isModified=function(){return this.modified};a.prototype.setModified=function(b){if(b!==this.modified){this.modified=b;this.propertyChangeSupport.firePropertyChange("MODIFIED",!b,b)}};a.prototype.isRecovered=function(){return this.recovered};a.prototype.setRecovered=function(b){if(b!==this.recovered){this.recovered=b;this.propertyChangeSupport.firePropertyChange("RECOVERED",!b,b)}};a.prototype.isRepaired=function(){return this.repaired};a.prototype.setRepaired=function(b){if(b!==this.repaired){this.repaired=b;this.propertyChangeSupport.firePropertyChange("REPAIRED",!b,b)}};a.prototype.getFurnitureSortedPropertyName=function(){return this.furnitureSortedPropertyName};a.prototype.setFurnitureSortedPropertyName=function(d){if(d!==this.furnitureSortedPropertyName&&(d==null||!(d===this.furnitureSortedPropertyName))){var c=this.furnitureSortedPropertyName;this.furnitureSortedPropertyName=d;try{this.furnitureSortedProperty=d!=null?d:null}catch(b){this.furnitureSortedProperty=null}this.propertyChangeSupport.firePropertyChange("FURNITURE_SORTED_PROPERTY",c,d)}};a.prototype.getFurnitureSortedProperty=function(){return this.furnitureSortedProperty};a.prototype.setFurnitureSortedProperty=function(b){if(b!==this.furnitureSortedProperty&&(b==null||!(b==this.furnitureSortedProperty))){var c=this.furnitureSortedProperty;this.furnitureSortedProperty=b;this.furnitureSortedPropertyName=b!=null?b:null;this.propertyChangeSupport.firePropertyChange("FURNITURE_SORTED_PROPERTY",c,b)}};a.prototype.isFurnitureDescendingSorted=function(){return this.furnitureDescendingSorted};a.prototype.setFurnitureDescendingSorted=function(b){if(b!==this.furnitureDescendingSorted){this.furnitureDescendingSorted=b;this.propertyChangeSupport.firePropertyChange("FURNITURE_DESCENDING_SORTED",!b,b)}};a.prototype.getFurnitureVisiblePropertyNames=function(){if(this.furnitureVisiblePropertyNames==null){return[]}else{return this.furnitureVisiblePropertyNames.slice(0)}};a.prototype.setFurnitureVisiblePropertyNames=function(d){if(d!==this.furnitureVisiblePropertyNames&&(d==null||!(function(h,g){if(h==null&&g==null){return true}if(h==null||g==null){return false}if(h.length!=g.length){return false}for(var j=0;j<h.length;j++){if(h[j]!=g[j]){return false}}return true})(d,this.furnitureVisiblePropertyNames))){var f=this.furnitureVisiblePropertyNames;this.furnitureVisiblePropertyNames=(d.slice(0));this.furnitureVisibleProperties=([]);for(var c=0;c<d.length;c++){var b=d[c];try{(this.furnitureVisibleProperties.push(b)>0)}catch(e){}}this.propertyChangeSupport.firePropertyChange("FURNITURE_VISIBLE_PROPERTIES",f.slice(0),d.slice(0))}};a.prototype.getFurnitureVisibleProperties=function(){if(this.furnitureVisibleProperties==null){return[]}else{return this.furnitureVisibleProperties.slice(0)}};a.prototype.setFurnitureVisibleProperties=function(d){if(d!==this.furnitureVisibleProperties&&(d==null||!(function(g,f){if(g==null&&f==null){return true}if(g==null||f==null){return false}if(g.length!=f.length){return false}for(var h=0;h<g.length;h++){if(g[h]!=f[h]){return false}}return true})(d,this.furnitureVisibleProperties))){var c=this.furnitureVisibleProperties;this.furnitureVisibleProperties=(d.slice(0));this.furnitureVisiblePropertyNames=([]);for(var b=0;b<d.length;b++){var e=d[b];(this.furnitureVisiblePropertyNames.push(e)>0)}this.propertyChangeSupport.firePropertyChange("FURNITURE_VISIBLE_PROPERTIES",c.slice(0),d.slice(0))}};a.prototype.getFurnitureAdditionalProperties=function(){return this.furnitureAdditionalProperties.slice(0)};a.prototype.setFurnitureAdditionalProperties=function(b){if(b!==this.furnitureAdditionalProperties&&(b==null||!(function(h,g){if(h==null&&g==null){return true}if(h==null||g==null){return false}if(h.length!=g.length){return false}for(var j=0;j<h.length;j++){if(h[j]!=g[j]){return false}}return true})(b,this.furnitureAdditionalProperties))){var f=this.furnitureAdditionalProperties;this.furnitureAdditionalProperties=(b.slice(0));var c=(this.getFurnitureVisiblePropertyNames().slice(0));for(var e=c.length-1;e>=0;e--){try{c[e]}catch(d){if(!(b.indexOf((new ObjectProperty(c[e])))>=0)){c.splice(e,1)[0]}}}this.setFurnitureVisiblePropertyNames(c);if(this.getFurnitureSortedPropertyName()!=null&&!(b.indexOf((new ObjectProperty(this.getFurnitureSortedPropertyName())))>=0)){this.setFurnitureSortedPropertyName(null)}this.propertyChangeSupport.firePropertyChange("FURNITURE_ADDITIONAL_PROPERTIES",f.slice(0),b.slice(0))}};a.prototype.getBackgroundImage=function(){return this.backgroundImage};a.prototype.setBackgroundImage=function(c){if(c!==this.backgroundImage){var b=this.backgroundImage;this.backgroundImage=c;this.propertyChangeSupport.firePropertyChange("BACKGROUND_IMAGE",b,c)}};a.prototype.getTopCamera=function(){return this.topCamera};a.prototype.getObserverCamera=function(){return this.observerCamera};a.prototype.setCamera=function(c){if(c!==this.camera){var b=this.camera;this.camera=c;this.propertyChangeSupport.firePropertyChange("CAMERA",b,c)}};a.prototype.getCamera=function(){if(this.camera==null){this.camera=this.getTopCamera()}return this.camera};a.prototype.setStoredCameras=function(c){if(!(function(e,d){if(e==null&&d==null){return true}if(e==null||d==null){return false}if(e.length!=d.length){return false}for(var f=0;f<e.length;f++){if(e[f]!=d[f]){return false}}return true})(this.storedCameras,c)){var b=this.storedCameras;if(c==null){this.storedCameras=[]}else{this.storedCameras=(c.slice(0))}this.propertyChangeSupport.firePropertyChange("STORED_CAMERAS",b.slice(0),c.slice(0))}};a.prototype.getStoredCameras=function(){return this.storedCameras.slice(0)};a.prototype.getEnvironment=function(){return this.environment};a.prototype.getCompass=function(){return this.compass};a.prototype.getPrint=function(){return this.print};a.prototype.setPrint=function(b){if(b!==this.print){var c=this.print;this.print=b;this.propertyChangeSupport.firePropertyChange("PRINT",c,b)}this.print=b};a.prototype.getVisualProperty=function(b){return(function(c,d){return c[d]===undefined?null:c[d]})(this.visualProperties,b)};a.prototype.setVisualProperty=function(b,c){(this.visualProperties[b]=c)};a.prototype.getProperty=function(b){return(function(c,d){return c[d]===undefined?null:c[d]})(this.properties,b)};a.prototype.getNumericProperty=function(b){var e=(function(f,g){return f[g]===undefined?null:f[g]})(this.properties,b);if(e!=null){try{return new Number(e).valueOf()}catch(c){try{return new Number(e).valueOf()}catch(d){}}}return null};a.prototype.setProperty=function(c,d){var e=this;var b=(function(f,g){return f[g]===undefined?null:f[g]})(this.properties,c);if(d==null){if(b!=null){(function(g){var f=e.properties[c];delete e.properties[c];return f})(this.properties);this.propertyChangeSupport.firePropertyChange(c,b,null)}}else{(this.properties[c]=d);this.propertyChangeSupport.firePropertyChange(c,b,d)}};a.prototype.getPropertyNames=function(){return Object.keys(this.properties)};a.prototype.addPropertyChangeListener=function(b,c){this.propertyChangeSupport.addPropertyChangeListener(b,c)};a.prototype.removePropertyChangeListener=function(b,c){this.propertyChangeSupport.removePropertyChangeListener(b,c)};a.prototype.isBasePlanLocked=function(){return this.basePlanLocked};a.prototype.setBasePlanLocked=function(b){if(b!==this.basePlanLocked){this.basePlanLocked=b;this.propertyChangeSupport.firePropertyChange("BASE_PLAN_LOCKED",!b,b)}};a.prototype.getVersion=function(){return this.version};a.prototype.setVersion=function(b){this.version=b};a.prototype.clone=function(){try{var c=(function(e){var f=Object.create(e);for(var d in e){if(e.hasOwnProperty(d)){f[d]=e[d]}}return f})(this);a.copyHomeData(this,c);a.initListenersSupport(c);c.addModelListeners();return c}catch(b){throw new IllegalStateException("Super class isn't cloneable")}};a.copyHomeData=function(b,k){k.allLevelsSelection=b.allLevelsSelection;k.name=b.name;k.modified=b.modified;k.recovered=b.recovered;k.repaired=b.repaired;k.backgroundImage=b.backgroundImage;k.furnitureDescendingSorted=b.furnitureDescendingSorted;k.version=b.version;k.basePlanLocked=b.basePlanLocked;k.skyColor=b.skyColor;k.groundColor=b.groundColor;k.lightColor=b.lightColor;k.wallsAlpha=b.wallsAlpha;k.furnitureSortedProperty=b.furnitureSortedProperty;k.selectedItems=([]);k.furniture=a.cloneSelectableItems(b.furniture,b.selectedItems,k.selectedItems);k.rooms=a.cloneSelectableItems(b.rooms,b.selectedItems,k.selectedItems);k.dimensionLines=a.cloneSelectableItems(b.dimensionLines,b.selectedItems,k.selectedItems);k.polylines=a.cloneSelectableItems(b.polylines,b.selectedItems,k.selectedItems);k.labels=a.cloneSelectableItems(b.labels,b.selectedItems,k.selectedItems);k.walls=Wall.clone(b.walls);for(var d=0;d<b.walls.length;d++){var m=b.walls[d];if((b.selectedItems.indexOf((m))>=0)){(k.selectedItems.push(k.walls[d])>0)}}k.levels=([]);if(b.levels.length>0){for(var e=0;e<b.levels.length;e++){var c=b.levels[e];(k.levels.push((function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(c))>0)}for(var d=0;d<b.furniture.length;d++){var n=b.furniture[d].getLevel();if(n!=null){k.furniture[d].setLevel(k.levels[b.levels.indexOf(n)])}}for(var d=0;d<b.rooms.length;d++){var p=b.rooms[d].getLevel();if(p!=null){k.rooms[d].setLevel(k.levels[b.levels.indexOf(p)])}}for(var d=0;d<b.dimensionLines.length;d++){var o=b.dimensionLines[d].getLevel();if(o!=null){k.dimensionLines[d].setLevel(k.levels[b.levels.indexOf(o)])}}for(var d=0;d<b.polylines.length;d++){var l=b.polylines[d].getLevel();if(l!=null){k.polylines[d].setLevel(k.levels[b.levels.indexOf(l)])}}for(var d=0;d<b.labels.length;d++){var h=b.labels[d].getLevel();if(h!=null){k.labels[d].setLevel(k.levels[b.levels.indexOf(h)])}}for(var d=0;d<b.walls.length;d++){var g=b.walls[d].getLevel();if(g!=null){k.walls[d].setLevel(k.levels[b.levels.indexOf(g)])}}if(b.selectedLevel!=null){k.selectedLevel=k.levels[b.levels.indexOf(b.selectedLevel)]}}if(b.print!=null&&b.print.getPrintedLevels()!=null){var j=(b.print.getPrintedLevels().slice(0));for(var d=0;d<j.length;d++){(j[d]=k.levels[b.levels.indexOf(j[d])])}k.print=new HomePrint(b.print.getPaperOrientation(),b.print.getPaperWidth(),b.print.getPaperHeight(),b.print.getPaperTopMargin(),b.print.getPaperLeftMargin(),b.print.getPaperBottomMargin(),b.print.getPaperRightMargin(),b.print.isFurniturePrinted(),b.print.isPlanPrinted(),j,b.print.isView3DPrinted(),b.print.getPlanScale(),b.print.getHeaderFormat(),b.print.getFooterFormat())}else{k.print=b.print}k.observerCamera=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.observerCamera);k.topCamera=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.topCamera);if(b.camera===b.observerCamera){k.camera=k.observerCamera;if((b.selectedItems.indexOf((b.observerCamera))>=0)){(k.selectedItems.push(k.observerCamera)>0)}}else{k.camera=k.topCamera}k.storedCameras=([]);for(var e=0;e<b.storedCameras.length;e++){var f=b.storedCameras[e];(k.storedCameras.push((function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(f))>0)}k.environment=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.environment);k.compass=(function(r){if(r.clone!=undefined){return r.clone()}else{var s=Object.create(r);for(var q in r){if(r.hasOwnProperty(q)){s[q]=r[q]}}return s}})(b.compass);k.furnitureVisibleProperties=(b.furnitureVisibleProperties.slice(0));k.furnitureVisiblePropertyNames=(b.furnitureVisiblePropertyNames.slice(0));k.visualProperties=((function(t){var q={};for(var s in t){q[s]=t[s]}return q})(b.visualProperties));k.properties=((function(t){var q={};for(var s in t){q[s]=t[s]}return q})(b.properties))};a.cloneSelectableItems=function(b,h,c){var k=([]);for(var g=0;g<b.length;g++){var l=b[g];var j=(function(r){if(r.clone!=undefined){return r.clone()}else{var q=Object.create(r);for(var n in r){if(r.hasOwnProperty(n)){q[n]=r[n]}}return q}})(l);(k.push(j)>0);if((h.indexOf((l))>=0)){(c.push(j)>0)}else{if(l!=null&&l instanceof HomeFurnitureGroup){var m=l.getAllFurniture();var d=null;for(var f=0,e=m.length;f<e;f++){var o=m[f];if((h.indexOf((o))>=0)){if(d==null){d=j.getAllFurniture()}(c.push(d[f])>0)}}}}}return k};a.duplicate=function(d){var g=([]);var c=Wall.duplicate(a.getWallsSubList(d));var b=0;for(var e=0;e<d.length;e++){var f=d[e];if(f!=null&&f instanceof Wall){(g.push(c[b++])>0)}else{if(f!=null&&f instanceof HomeObject){(g.push(f.duplicate())>0)}else{(g.push((function(j){if(j.clone!=undefined){return j.clone()}else{var k=Object.create(j);for(var h in j){if(j.hasOwnProperty(h)){k[h]=j[h]}}return k}})(f))>0)}}}return g};a.getFurnitureSubList=function(b){return a.getSubList(b,HomePieceOfFurniture)};a.getWallsSubList=function(b){return a.getSubList(b,Wall)};a.getRoomsSubList=function(b){return a.getSubList(b,Room)};a.getPolylinesSubList=function(b){return a.getSubList(b,Polyline)};a.getDimensionLinesSubList=function(b){return a.getSubList(b,DimensionLine)};a.getLabelsSubList=function(b){return a.getSubList(b,Label)};a.getSubList=function(c,f){var b=([]);for(var d=0;d<c.length;d++){var e=c[d];if((function(h,g){if(typeof h==="string"){return(g.constructor&&g.constructor.__interfaces&&g.constructor.__interfaces.indexOf(h)>=0)||(g.__interfaces&&g.__interfaces.indexOf(h)>=0)}else{if(typeof h==="function"){return(g instanceof h)||(g.constructor&&g.constructor===h)}}})(f,e)){(b.push(e)>0)}}return b};a.CURRENT_VERSION=7200;a.HOME_TOP_CAMERA_ID="camera-homeTopCamera";a.HOME_OBSERVER_CAMERA_ID="observerCamera-homeObserverCamera";a.HOME_ENVIRONMENT_ID="environment-homeEnvironment";a.HOME_COMPASS_ID="compass-homeCompass";a.KEEP_BACKWARD_COMPATIBLITY=true;return a}());Home.__class="com.eteks.sweethome3d.model.Home";(function(a){var b=(function(){function c(d){this.__parent=d}c.prototype.propertyChange=function(d){if(("ELEVATION"===d.getPropertyName())||("ELEVATION_INDEX"===d.getPropertyName())){this.__parent.levels=(this.__parent.levels.slice(0));(function(e,f){if(f.compare){e.sort(function(h,g){return f.compare(h,g)})}else{e.sort(f)}})(this.__parent.levels,a.LEVEL_ELEVATION_COMPARATOR_$LI$())}};return c}());a.Home$0=b})(Home||(Home={}));Home.__transients=["furnitureChangeSupport","selectedItems","selectionListeners","allLevelsSelection","levelsChangeSupport","wallsChangeSupport","roomsChangeSupport","polylinesChangeSupport","dimensionLinesChangeSupport","labelsChangeSupport","modified","recovered","repaired","propertyChangeSupport","furnitureAdditionalProperties"];var PlanController=(function(a){__extends(b,a);function b(h,d,c,f,e){var j=a.call(this,h,d,c,f,e)||this;if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_home===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_home=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager=null}if(j.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport===undefined){j.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport=null}if(j.propertyChangeSupport===undefined){j.propertyChangeSupport=null}if(j.planView===undefined){j.planView=null}if(j.selectionListener===undefined){j.selectionListener=null}if(j.wallChangeListener===undefined){j.wallChangeListener=null}if(j.furnitureSizeChangeListener===undefined){j.furnitureSizeChangeListener=null}if(j.selectionState===undefined){j.selectionState=null}if(j.rectangleSelectionState===undefined){j.rectangleSelectionState=null}if(j.selectionMoveState===undefined){j.selectionMoveState=null}if(j.panningState===undefined){j.panningState=null}if(j.dragAndDropState===undefined){j.dragAndDropState=null}if(j.wallCreationState===undefined){j.wallCreationState=null}if(j.wallDrawingState===undefined){j.wallDrawingState=null}if(j.wallResizeState===undefined){j.wallResizeState=null}if(j.wallArcExtentState===undefined){j.wallArcExtentState=null}if(j.pieceOfFurnitureRotationState===undefined){j.pieceOfFurnitureRotationState=null}if(j.pieceOfFurniturePitchRotationState===undefined){j.pieceOfFurniturePitchRotationState=null}if(j.pieceOfFurnitureRollRotationState===undefined){j.pieceOfFurnitureRollRotationState=null}if(j.pieceOfFurnitureElevationState===undefined){j.pieceOfFurnitureElevationState=null}if(j.pieceOfFurnitureHeightState===undefined){j.pieceOfFurnitureHeightState=null}if(j.pieceOfFurnitureResizeState===undefined){j.pieceOfFurnitureResizeState=null}if(j.lightPowerModificationState===undefined){j.lightPowerModificationState=null}if(j.pieceOfFurnitureNameOffsetState===undefined){j.pieceOfFurnitureNameOffsetState=null}if(j.pieceOfFurnitureNameRotationState===undefined){j.pieceOfFurnitureNameRotationState=null}if(j.cameraYawRotationState===undefined){j.cameraYawRotationState=null}if(j.cameraPitchRotationState===undefined){j.cameraPitchRotationState=null}if(j.cameraElevationState===undefined){j.cameraElevationState=null}if(j.dimensionLineCreationState===undefined){j.dimensionLineCreationState=null}if(j.dimensionLineDrawingState===undefined){j.dimensionLineDrawingState=null}if(j.dimensionLineResizeState===undefined){j.dimensionLineResizeState=null}if(j.dimensionLineOffsetState===undefined){j.dimensionLineOffsetState=null}if(j.dimensionLinePitchRotationState===undefined){j.dimensionLinePitchRotationState=null}if(j.dimensionLineHeightState===undefined){j.dimensionLineHeightState=null}if(j.dimensionLineElevationState===undefined){j.dimensionLineElevationState=null}if(j.roomCreationState===undefined){j.roomCreationState=null}if(j.roomDrawingState===undefined){j.roomDrawingState=null}if(j.roomResizeState===undefined){j.roomResizeState=null}if(j.roomAreaOffsetState===undefined){j.roomAreaOffsetState=null}if(j.roomAreaRotationState===undefined){j.roomAreaRotationState=null}if(j.roomNameOffsetState===undefined){j.roomNameOffsetState=null}if(j.roomNameRotationState===undefined){j.roomNameRotationState=null}if(j.polylineCreationState===undefined){j.polylineCreationState=null}if(j.polylineDrawingState===undefined){j.polylineDrawingState=null}if(j.polylineResizeState===undefined){j.polylineResizeState=null}if(j.labelCreationState===undefined){j.labelCreationState=null}if(j.labelRotationState===undefined){j.labelRotationState=null}if(j.labelElevationState===undefined){j.labelElevationState=null}if(j.compassRotationState===undefined){j.compassRotationState=null}if(j.compassResizeState===undefined){j.compassResizeState=null}if(j.state===undefined){j.state=null}if(j.previousState===undefined){j.previousState=null}if(j.xLastMousePress===undefined){j.xLastMousePress=0}if(j.yLastMousePress===undefined){j.yLastMousePress=0}if(j.shiftDownLastMousePress===undefined){j.shiftDownLastMousePress=false}if(j.alignmentActivatedLastMousePress===undefined){j.alignmentActivatedLastMousePress=false}if(j.duplicationActivatedLastMousePress===undefined){j.duplicationActivatedLastMousePress=false}if(j.magnetismToggledLastMousePress===undefined){j.magnetismToggledLastMousePress=false}if(j.pointerTypeLastMousePress===undefined){j.pointerTypeLastMousePress=null}if(j.xLastMouseMove===undefined){j.xLastMouseMove=0}if(j.yLastMouseMove===undefined){j.yLastMouseMove=0}if(j.wallsAreaCache===undefined){j.wallsAreaCache=null}if(j.wallsIncludingBaseboardsAreaCache===undefined){j.wallsIncludingBaseboardsAreaCache=null}if(j.insideWallsAreaCache===undefined){j.insideWallsAreaCache=null}if(j.roomPathsCache===undefined){j.roomPathsCache=null}if(j.furnitureSidesCache===undefined){j.furnitureSidesCache=null}if(j.draggedItems===undefined){j.draggedItems=null}j.feedbackDisplayed=true;j.__com_eteks_sweethome3d_viewcontroller_PlanController_home=h;j.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences=d;j.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory=c;j.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager=f;j.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport=e;j.propertyChangeSupport=new PropertyChangeSupport(j);j.furnitureSidesCache=({});j.selectionState=new b.SelectionState(j);j.selectionMoveState=new b.SelectionMoveState(j);j.rectangleSelectionState=new b.RectangleSelectionState(j);j.panningState=new b.PanningState(j);j.dragAndDropState=new b.DragAndDropState(j);j.wallCreationState=new b.WallCreationState(j);j.wallDrawingState=new b.WallDrawingState(j);j.wallResizeState=new b.WallResizeState(j);j.wallArcExtentState=new b.WallArcExtentState(j);j.pieceOfFurnitureRotationState=new b.PieceOfFurnitureRotationState(j);j.pieceOfFurniturePitchRotationState=new b.PieceOfFurniturePitchRotationState(j);j.pieceOfFurnitureRollRotationState=new b.PieceOfFurnitureRollRotationState(j);j.pieceOfFurnitureElevationState=new b.PieceOfFurnitureElevationState(j);j.pieceOfFurnitureHeightState=new b.PieceOfFurnitureHeightState(j);j.pieceOfFurnitureResizeState=new b.PieceOfFurnitureResizeState(j);j.lightPowerModificationState=new b.LightPowerModificationState(j);j.pieceOfFurnitureNameOffsetState=new b.PieceOfFurnitureNameOffsetState(j);j.pieceOfFurnitureNameRotationState=new b.PieceOfFurnitureNameRotationState(j);j.cameraYawRotationState=new b.CameraYawRotationState(j);j.cameraPitchRotationState=new b.CameraPitchRotationState(j);j.cameraElevationState=new b.CameraElevationState(j);j.dimensionLineCreationState=new b.DimensionLineCreationState(j);j.dimensionLineDrawingState=new b.DimensionLineDrawingState(j);j.dimensionLineResizeState=new b.DimensionLineResizeState(j);j.dimensionLineOffsetState=new b.DimensionLineOffsetState(j);j.dimensionLinePitchRotationState=new b.DimensionLinePitchRotationState(j);j.dimensionLineHeightState=new b.DimensionLineHeightState(j);j.dimensionLineElevationState=new b.DimensionLineElevationState(j);j.roomCreationState=new b.RoomCreationState(j);j.roomDrawingState=new b.RoomDrawingState(j);j.roomResizeState=new b.RoomResizeState(j);j.roomAreaOffsetState=new b.RoomAreaOffsetState(j);j.roomAreaRotationState=new b.RoomAreaRotationState(j);j.roomNameOffsetState=new b.RoomNameOffsetState(j);j.roomNameRotationState=new b.RoomNameRotationState(j);j.polylineCreationState=new b.PolylineCreationState(j);j.polylineDrawingState=new b.PolylineDrawingState(j);j.polylineResizeState=new b.PolylineResizeState(j);j.labelCreationState=new b.LabelCreationState(j);j.labelRotationState=new b.LabelRotationState(j);j.labelElevationState=new b.LabelElevationState(j);j.compassRotationState=new b.CompassRotationState(j);j.compassResizeState=new b.CompassResizeState(j);j.setState(j.selectionState);j.__com_eteks_sweethome3d_viewcontroller_PlanController_addModelListeners();var g=h.getNumericProperty(b.SCALE_VISUAL_PROPERTY);if(g!=null){j.setScale(g)}return j}b.prototype.getView=function(){if(this.planView==null){this.planView=this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory.createPlanView(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this)}return this.planView};b.prototype.setState=function(f){var c=null;var e=false;var d=false;if(this.state!=null){c=this.state.getMode();e=this.state.isModificationState();d=this.state.isBasePlanModificationState();this.state.exit()}this.previousState=this.state;this.state=f;this.state.enter();if(c!==f.getMode()){this.propertyChangeSupport.firePropertyChange("MODE",c,f.getMode())}if(e!==f.isModificationState()){this.propertyChangeSupport.firePropertyChange("MODIFICATION_STATE",e,!e)}if(d!==f.isBasePlanModificationState()){this.propertyChangeSupport.firePropertyChange("BASE_PLAN_MODIFICATION_STATE",d,!d)}};b.prototype.addPropertyChangeListener=function(d,c){this.propertyChangeSupport.addPropertyChangeListener(d,c)};b.prototype.removePropertyChangeListener=function(d,c){this.propertyChangeSupport.removePropertyChangeListener(d,c)};b.prototype.getMode=function(){return this.state.getMode()};b.prototype.setMode=function(d){var c=this.state.getMode();if(d!==c){this.state.setMode(d);this.propertyChangeSupport.firePropertyChange("MODE",c,d)}};b.prototype.isModificationState=function(){return this.state.isModificationState()};b.prototype.isBasePlanModificationState=function(){return this.state.isBasePlanModificationState()};b.prototype.deleteSelection=function(){this.state.deleteSelection()};b.prototype.escape=function(){this.state.escape()};b.prototype.moveSelection=function(d,c){this.state.moveSelection(d,c)};b.prototype.toggleMagnetism=function(c){this.state.toggleMagnetism(c)};b.prototype.setAlignmentActivated=function(c){this.state.setAlignmentActivated(c)};b.prototype.setDuplicationActivated=function(c){this.state.setDuplicationActivated(c)};b.prototype.setEditionActivated=function(c){this.state.setEditionActivated(c)};b.prototype.updateEditableProperty=function(d,c){this.state.updateEditableProperty(d,c)};b.prototype.pressMouse$float$float$int$boolean$boolean=function(d,g,c,e,f){this.pressMouse$float$float$int$boolean$boolean$boolean$boolean(d,g,c,e,e,f,e)};b.prototype.pressMouse$float$float$int$boolean$boolean$boolean$boolean=function(d,j,c,f,g,h,e){this.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(d,j,c,f,g,h,e,null)};b.prototype.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType=function(e,k,d,g,h,j,f,c){this.xLastMousePress=e;this.yLastMousePress=k;this.xLastMouseMove=e;this.yLastMouseMove=k;this.shiftDownLastMousePress=g;this.alignmentActivatedLastMousePress=h;this.duplicationActivatedLastMousePress=j;this.magnetismToggledLastMousePress=f;this.pointerTypeLastMousePress=c;this.state.pressMouse(e,k,d,g,j)};b.prototype.pressMouse=function(e,k,d,g,h,j,f,c){if(((typeof e==="number")||e===null)&&((typeof k==="number")||k===null)&&((typeof d==="number")||d===null)&&((typeof g==="boolean")||g===null)&&((typeof h==="boolean")||h===null)&&((typeof j==="boolean")||j===null)&&((typeof f==="boolean")||f===null)&&((typeof c==="number")||c===null)){return this.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(e,k,d,g,h,j,f,c)}else{if(((typeof e==="number")||e===null)&&((typeof k==="number")||k===null)&&((typeof d==="number")||d===null)&&((typeof g==="boolean")||g===null)&&((typeof h==="boolean")||h===null)&&((typeof j==="boolean")||j===null)&&((typeof f==="boolean")||f===null)&&c===undefined){return this.pressMouse$float$float$int$boolean$boolean$boolean$boolean(e,k,d,g,h,j,f)}else{if(((typeof e==="number")||e===null)&&((typeof k==="number")||k===null)&&((typeof d==="number")||d===null)&&((typeof g==="boolean")||g===null)&&((typeof h==="boolean")||h===null)&&j===undefined&&f===undefined&&c===undefined){return this.pressMouse$float$float$int$boolean$boolean(e,k,d,g,h)}else{throw new Error("invalid overload")}}}};b.prototype.releaseMouse=function(c,d){this.state.releaseMouse(c,d)};b.prototype.moveMouse=function(c,d){this.xLastMouseMove=c;this.yLastMouseMove=d;this.state.moveMouse(c,d)};b.prototype.zoom=function(c){this.state.zoom(c)};b.prototype.setFeedbackDisplayed=function(c){this.feedbackDisplayed=c;this.getView().deleteFeedback()};b.prototype.isFeedbackDisplayed=function(){return this.feedbackDisplayed};b.prototype.getSelectionState=function(){return this.selectionState};b.prototype.getSelectionMoveState=function(){return this.selectionMoveState};b.prototype.getRectangleSelectionState=function(){return this.rectangleSelectionState};b.prototype.getPanningState=function(){return this.panningState};b.prototype.getDragAndDropState=function(){return this.dragAndDropState};b.prototype.getWallCreationState=function(){return this.wallCreationState};b.prototype.getWallDrawingState=function(){return this.wallDrawingState};b.prototype.getWallResizeState=function(){return this.wallResizeState};b.prototype.getWallArcExtentState=function(){return this.wallArcExtentState};b.prototype.getPieceOfFurnitureRotationState=function(){return this.pieceOfFurnitureRotationState};b.prototype.getPieceOfFurniturePitchRotationState=function(){return this.pieceOfFurniturePitchRotationState};b.prototype.getPieceOfFurnitureRollRotationState=function(){return this.pieceOfFurnitureRollRotationState};b.prototype.getPieceOfFurnitureElevationState=function(){return this.pieceOfFurnitureElevationState};b.prototype.getPieceOfFurnitureHeightState=function(){return this.pieceOfFurnitureHeightState};b.prototype.getPieceOfFurnitureResizeState=function(){return this.pieceOfFurnitureResizeState};b.prototype.getLightPowerModificationState=function(){return this.lightPowerModificationState};b.prototype.getPieceOfFurnitureNameOffsetState=function(){return this.pieceOfFurnitureNameOffsetState};b.prototype.getPieceOfFurnitureNameRotationState=function(){return this.pieceOfFurnitureNameRotationState};b.prototype.getCameraYawRotationState=function(){return this.cameraYawRotationState};b.prototype.getCameraPitchRotationState=function(){return this.cameraPitchRotationState};b.prototype.getCameraElevationState=function(){return this.cameraElevationState};b.prototype.getDimensionLineCreationState=function(){return this.dimensionLineCreationState};b.prototype.getDimensionLineDrawingState=function(){return this.dimensionLineDrawingState};b.prototype.getDimensionLineResizeState=function(){return this.dimensionLineResizeState};b.prototype.getDimensionLineOffsetState=function(){return this.dimensionLineOffsetState};b.prototype.getDimensionLinePitchRotationState=function(){return this.dimensionLinePitchRotationState};b.prototype.getDimensionLineHeightState=function(){return this.dimensionLineHeightState};b.prototype.getDimensionLineElevationState=function(){return this.dimensionLineElevationState};b.prototype.getRoomCreationState=function(){return this.roomCreationState};b.prototype.getRoomDrawingState=function(){return this.roomDrawingState};b.prototype.getRoomResizeState=function(){return this.roomResizeState};b.prototype.getRoomAreaOffsetState=function(){return this.roomAreaOffsetState};b.prototype.getRoomAreaRotationState=function(){return this.roomAreaRotationState};b.prototype.getRoomNameOffsetState=function(){return this.roomNameOffsetState};b.prototype.getRoomNameRotationState=function(){return this.roomNameRotationState};b.prototype.getPolylineCreationState=function(){return this.polylineCreationState};b.prototype.getPolylineDrawingState=function(){return this.polylineDrawingState};b.prototype.getPolylineResizeState=function(){return this.polylineResizeState};b.prototype.getLabelCreationState=function(){return this.labelCreationState};b.prototype.getLabelRotationState=function(){return this.labelRotationState};b.prototype.getLabelElevationState=function(){return this.labelElevationState};b.prototype.getCompassRotationState=function(){return this.compassRotationState};b.prototype.getCompassResizeState=function(){return this.compassResizeState};b.prototype.getXLastMousePress=function(){return this.xLastMousePress};b.prototype.getYLastMousePress=function(){return this.yLastMousePress};b.prototype.wasShiftDownLastMousePress=function(){return this.shiftDownLastMousePress};b.prototype.wasMagnetismToggledLastMousePress=function(){return this.magnetismToggledLastMousePress};b.prototype.wasAlignmentActivatedLastMousePress=function(){return this.alignmentActivatedLastMousePress};b.prototype.wasDuplicationActivatedLastMousePress=function(){return this.duplicationActivatedLastMousePress};b.prototype.getPointerTypeLastMousePress=function(){return this.pointerTypeLastMousePress};b.prototype.getXLastMouseMove=function(){return this.xLastMouseMove};b.prototype.getYLastMouseMove=function(){return this.yLastMouseMove};b.prototype.modifySelectedItem=function(){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(d.length===1){var c=d[0];if(c!=null&&c instanceof HomePieceOfFurniture){this.modifySelectedFurniture()}else{if(c!=null&&c instanceof Wall){this.modifySelectedWalls()}else{if(c!=null&&c instanceof Room){this.modifySelectedRooms()}else{if(c!=null&&c instanceof Polyline){this.modifySelectedPolylines()}else{if(c!=null&&c instanceof DimensionLine){this.modifySelectedDimensionLines()}else{if(c!=null&&c instanceof Label){this.modifySelectedLabels()}else{if(c!=null&&c instanceof Compass){this.modifyCompass()}else{if(c!=null&&c instanceof ObserverCamera){this.modifyObserverCamera()}}}}}}}}}};b.prototype.modifySelectedWalls=function(){if(!(Home.getWallsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new WallController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.lockBasePlan=function(){if(!this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var d=g.slice(0);var c=this.getItemsNotPartOfBasePlan(g);var f=c.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(true);this.selectItems$java_util_List$boolean(c,e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LockingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,f))}};b.prototype.isItemPartOfBasePlan=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return this.isPieceOfFurniturePartOfBasePlan(c)}else{return !(c!=null&&c instanceof ObserverCamera)}};b.prototype.getItemsNotPartOfBasePlan=function(c){var f=([]);for(var d=0;d<c.length;d++){var e=c[d];if(!this.isItemPartOfBasePlan(e)){(f.push(e)>0)}}return f};b.prototype.unlockBasePlan=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var e=d.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.UnlockingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c))}};b.prototype.isItemMovable=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return this.isPieceOfFurnitureMovable(c)}else{return true}};b.prototype.isItemResizable=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return c.isResizable()}else{return true}};b.prototype.isItemDeletable=function(c){if(c!=null&&c instanceof HomePieceOfFurniture){return this.isPieceOfFurnitureDeletable(c)}else{return !((c!=null&&c instanceof Compass)||(c!=null&&c instanceof Camera))}};b.prototype.flipHorizontally=function(){this.flipSelectedItems(true)};b.prototype.flipVertically=function(){this.flipSelectedItems(false)};b.prototype.flipSelectedItems=function(k){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(!(e.length==0)){var d=e.slice(0);var f=(function(o){var j=[];while(o-->0){j.push(null)}return j})(d.length);for(var h=0;h<f.length;h++){if(d[h]!=null&&d[h] instanceof HomeFurnitureGroup){var m=d[h];var l=m.getAllFurniture();f[h]=(function(o){var j=[];while(o-->0){j.push(0)}return j})(l.length+1);f[h][0]=this.getTextBaseOffset(m.getName(),m.getNameStyle(),m.constructor);for(var g=0;g<l.length;g++){var n=l[g];f[h][g+1]=this.getTextBaseOffset(n.getName(),n.getNameStyle(),n.constructor)}}else{if(d[h]!=null&&d[h] instanceof HomePieceOfFurniture){var n=d[h];f[h]=[this.getTextBaseOffset(n.getName(),n.getNameStyle(),n.constructor)]}else{if(d[h]!=null&&d[h] instanceof Room){var c=d[h];f[h]=[this.getTextBaseOffset(c.getName(),c.getNameStyle(),c.constructor),this.getTextBaseOffset(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(c.getArea()),c.getAreaStyle(),c.constructor)]}}}}this.doFlipItems(d,f,k);this.selectAndShowItems$java_util_List$boolean(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.FlippingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),e.slice(0),f,k))}};b.prototype.doFlipItems=function(q,l,e){var k=3.4028235e+38;var g=3.4028235e+38;var d=-3.4028235e+38;var c=-3.4028235e+38;for(var n=0;n<q.length;n++){var s=q[n];if(!(s!=null&&s instanceof ObserverCamera)){var o=s.getPoints();for(var p=0;p<o.length;p++){var r=o[p];k=Math.min(k,r[0]);g=Math.min(g,r[1]);d=Math.max(d,r[0]);c=Math.max(c,r[1])}}}var j=(k+d)/2;var f=(g+c)/2;var h=q.slice(0);for(var m=0;m<q.length;m++){this.flipItem(q[m],l[m],0,e?j:f,e,h)}};b.prototype.flipItem=function(B,p,l,j,D,d){if(B!=null&&B instanceof HomePieceOfFurniture){var e=B;if(D){e.setX(j*2-e.getX());e.setAngle(-e.getAngle());b.flipPieceOfFurnitureName(e,p[0],D)}else{e.setY(j*2-e.getY());e.setAngle(Math.PI-e.getAngle());b.flipPieceOfFurnitureName(e,p[0],D)}if(e.isHorizontallyRotatable()){e.setRoll(-e.getRoll())}if(e.isResizable()){e.setModelMirrored(!e.isModelMirrored())}if(B!=null&&B instanceof HomeFurnitureGroup){var q=B.getAllFurniture();for(var w=0;w<q.length;w++){b.flipPieceOfFurnitureName(q[w],p[w+1],D)}}}else{if(B!=null&&B instanceof Wall){var y=B;if(D){y.setXStart(j*2-y.getXStart());var C=y.getWallAtStart();if(C!=null&&!(d.indexOf((C))>=0)){if(C.getWallAtStart()===y){C.setXStart(j*2-C.getXStart())}else{C.setXEnd(j*2-C.getXEnd())}}y.setXEnd(j*2-y.getXEnd());var k=y.getWallAtEnd();if(k!=null&&!(d.indexOf((k))>=0)){if(k.getWallAtStart()===y){k.setXStart(j*2-k.getXStart())}else{k.setXEnd(j*2-k.getXEnd())}}}else{y.setYStart(j*2-y.getYStart());var C=y.getWallAtStart();if(C!=null&&!(d.indexOf((C))>=0)){if(C.getWallAtStart()===y){C.setYStart(j*2-C.getYStart())}else{C.setYEnd(j*2-C.getYEnd())}}y.setYEnd(j*2-y.getYEnd());var k=y.getWallAtEnd();if(k!=null&&!(d.indexOf((k))>=0)){if(k.getWallAtStart()===y){k.setYStart(j*2-k.getYStart())}else{k.setYEnd(j*2-k.getYEnd())}}}var s=y.getArcExtent();if(s!=null){y.setArcExtent(-s)}b.reverseWallSidesStyle(y)}else{if(B!=null&&B instanceof Room){var z=B;var v=z.getPoints();for(var h=0;h<v.length;h++){var u=v[h];if(D){u[0]=j*2-u[0]}else{u[1]=j*2-u[1]}}z.setPoints(v);var t=z.getNameStyle();var o=z.getAreaStyle();if(D){z.setNameXOffset(-z.getNameXOffset());z.setAreaXOffset(-z.getAreaXOffset());if(t!=null){if(t.getAlignment()===TextStyle.Alignment.LEFT){z.setNameStyle(t.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(t.getAlignment()===TextStyle.Alignment.RIGHT){z.setNameStyle(t.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}if(o!=null){if(o.getAlignment()===TextStyle.Alignment.LEFT){z.setAreaStyle(o.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(o.getAlignment()===TextStyle.Alignment.RIGHT){z.setAreaStyle(o.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}}else{z.setNameYOffset(-z.getNameYOffset());var A=p[0];z.setNameXOffset(z.getNameXOffset()-A*Math.sin(z.getNameAngle()));z.setNameYOffset(z.getNameYOffset()-A*Math.cos(z.getNameAngle()));z.setAreaYOffset(-z.getAreaYOffset());A=p[1];z.setAreaXOffset(z.getAreaXOffset()-A*Math.sin(z.getAreaAngle()));z.setAreaYOffset(z.getAreaYOffset()-A*Math.cos(z.getAreaAngle()))}z.setNameAngle(-z.getNameAngle());z.setAreaAngle(-z.getAreaAngle())}else{if(B!=null&&B instanceof Polyline){var r=B;var v=r.getPoints();for(var h=0;h<v.length;h++){var u=v[h];if(D){u[0]=j*2-u[0]}else{u[1]=j*2-u[1]}}r.setPoints(v)}else{if(B!=null&&B instanceof DimensionLine){var g=B;if(g.isElevationDimensionLine()){if(D){g.setXStart(j*2-g.getXStart());g.setXEnd(g.getXStart());g.setPitch(Math.PI-g.getPitch())}else{g.setYStart(j*2-g.getYStart());g.setYEnd(g.getYStart());g.setPitch(-g.getPitch())}g.setOffset(-g.getOffset())}else{if(D){var f=g.getXStart();g.setXStart(j*2-g.getXEnd());g.setXEnd(j*2-f);var n=g.getYStart();g.setYStart(g.getYEnd());g.setYEnd(n)}else{g.setYStart(j*2-g.getYStart());g.setYEnd(j*2-g.getYEnd());g.setOffset(-g.getOffset())}}}else{if(B!=null&&B instanceof Label){var m=B;if(D){m.setX(j*2-m.getX());m.setAngle(-m.getAngle())}else{m.setY(j*2-m.getY());if(m.getPitch()!=null){m.setAngle(Math.PI-m.getAngle())}else{m.setAngle(-m.getAngle())}}var x=m.getStyle();if(x!=null){if(x.getAlignment()===TextStyle.Alignment.LEFT){m.setStyle(x.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(x.getAlignment()===TextStyle.Alignment.RIGHT){m.setStyle(x.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}}else{if(B!=null&&B instanceof Compass){var c=B;if(D){c.setX(j*2-c.getX());c.setNorthDirection(-c.getNorthDirection())}else{c.setY(j*2-c.getY());c.setNorthDirection(Math.PI-c.getNorthDirection())}}}}}}}}};b.flipPieceOfFurnitureName=function(c,d,f){if(f){c.setNameXOffset(-c.getNameXOffset());var e=c.getNameStyle();if(e!=null){if(e.getAlignment()===TextStyle.Alignment.LEFT){c.setNameStyle(e.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.RIGHT))}else{if(e.getAlignment()===TextStyle.Alignment.RIGHT){c.setNameStyle(e.deriveStyle$com_eteks_sweethome3d_model_TextStyle_Alignment(TextStyle.Alignment.LEFT))}}}}else{c.setNameYOffset(-c.getNameYOffset());if(c.getNameXOffset()!==0||c.getNameYOffset()!==0){c.setNameXOffset(c.getNameXOffset()-d*Math.sin(c.getNameAngle()));c.setNameYOffset(c.getNameYOffset()-d*Math.cos(c.getNameAngle()))}c.setNameAngle(-c.getNameAngle())}};b.prototype.getTextBaseOffset=function(f,e,d){if(e==null){e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(d)}var c=this.getView().getTextBounds(f!=null?f:"Ag",e,0,0,0);return(c[c.length-1][1]+c[0][1])/2};b.prototype.joinSelectedWalls=function(){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var p=Home.getWallsSubList(h);var f=[null,null];for(var l=0;l<p.length;l++){var o=p[l];if((o.getArcExtent()==null||o.getArcExtent()===0)&&(o.getWallAtStart()==null||o.getWallAtEnd()==null)){if(f[0]==null){f[0]=o}else{f[1]=o;break}}}if(f[1]==null){(function(q,r){if(r.compare){q.sort(function(t,s){return r.compare(t,s)})}else{q.sort(r)}})(p,new b.PlanController$0(this,f));if(f[0]!==p[1]){f[1]=p[1]}}if(f[1]!=null){var n=Math.atan2(f[0].getYEnd()-f[0].getYStart(),f[0].getXEnd()-f[0].getXStart());var g=Math.atan2(f[1].getYEnd()-f[1].getYStart(),f[1].getXEnd()-f[1].getXStart());var j=Math.abs(n-g)%Math.PI;var k=j<=Math.PI/360||(Math.PI-j)<=Math.PI/360;var e=null;if(!k){e=b.computeIntersection$float$float$float$float$float$float$float$float(f[0].getXStart(),f[0].getYStart(),f[0].getXEnd(),f[0].getYEnd(),f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd())}else{if(java.awt.geom.Line2D.ptLineDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXStart(),f[0].getYStart())<0.01&&java.awt.geom.Line2D.ptLineDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXEnd(),f[0].getYEnd())<0.01){if((f[1].getWallAtStart()==null)!==(f[1].getWallAtEnd()==null)){if(f[1].getWallAtStart()==null){e=[f[1].getXStart(),f[1].getYStart()]}else{e=[f[1].getXEnd(),f[1].getYEnd()]}}else{if(f[1].getWallAtStart()==null&&f[1].getWallAtEnd()==null){var m=java.awt.geom.Line2D.ptSegDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXStart(),f[0].getYStart());var d=java.awt.geom.Line2D.ptSegDistSq(f[1].getXStart(),f[1].getYStart(),f[1].getXEnd(),f[1].getYEnd(),f[0].getXEnd(),f[0].getYEnd());if(m>0.01&&d>0.01){if(f[0].getWallAtEnd()!=null||f[0].getWallAtStart()==null&&m<=d){if(java.awt.geom.Point2D.distanceSq(f[1].getXStart(),f[1].getYStart(),f[0].getXStart(),f[0].getYStart())<java.awt.geom.Point2D.distanceSq(f[1].getXEnd(),f[1].getYEnd(),f[0].getXStart(),f[0].getYStart())){e=[f[1].getXStart(),f[1].getYStart()]}else{e=[f[1].getXEnd(),f[1].getYEnd()]}}else{if(java.awt.geom.Point2D.distanceSq(f[1].getXStart(),f[1].getYStart(),f[0].getXEnd(),f[0].getYEnd())<java.awt.geom.Point2D.distanceSq(f[1].getXEnd(),f[1].getYEnd(),f[0].getXEnd(),f[0].getYEnd())){e=[f[1].getXStart(),f[1].getYStart()]}else{e=[f[1].getXEnd(),f[1].getYEnd()]}}}}}}}if(e!=null){var c=b.JoinedWall.getJoinedWalls([f[0],f[1]]);this.doJoinWalls(c,e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallsJoiningUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,h.slice(0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),c,e))}}};b.prototype.doJoinWalls=function(j,e){var d=[j[0].getWall(),j[1].getWall()];var g=false;for(var f=0;f<2;f++){var c=d[f].getWallAtEnd()==null;var h=d[f].getWallAtStart()==null;if(h&&c){if(java.awt.geom.Point2D.distanceSq(d[f].getXStart(),d[f].getYStart(),e[0],e[1])<java.awt.geom.Point2D.distanceSq(d[f].getXEnd(),d[f].getYEnd(),e[0],e[1])){c=false}else{h=false}}if(c){d[f].setXEnd(e[0]);d[f].setYEnd(e[1])}else{if(h){d[f].setXStart(e[0]);d[f].setYStart(e[1])}}if(g||d[(f+1)%2].getWallAtStart()==null||d[(f+1)%2].getWallAtEnd()==null){if(c){d[f].setWallAtEnd(d[(f+1)%2]);g=true}else{if(h){d[f].setWallAtStart(d[(f+1)%2]);g=true}}}}if(g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([d[0],d[1]])}else{this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([d[0]])}};b.prototype.reverseSelectedWallsDirection=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var c=Home.getWallsSubList(e);if(!(c.length==0)){var d=c.slice(0);this.doReverseWallsDirection(d);this.selectAndShowItems$java_util_List$boolean(d.slice(0),false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallsDirectionReversingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection(),d))}};b.prototype.doReverseWallsDirection=function(e){for(var h=0;h<e.length;h++){var m=e[h];var k=m.getXStart();var r=m.getYStart();var c=m.getXEnd();var n=m.getYEnd();m.setXStart(c);m.setYStart(n);m.setXEnd(k);m.setYEnd(r);if(m.getArcExtent()!=null){m.setArcExtent(-m.getArcExtent())}var l=m.getWallAtStart();var q=l!=null&&l.getWallAtEnd()===m;var p=l!=null&&l.getWallAtStart()===m;var d=m.getWallAtEnd();var f=d!=null&&d.getWallAtEnd()===m;var g=d!=null&&d.getWallAtStart()===m;m.setWallAtStart(d);m.setWallAtEnd(l);if(q){l.setWallAtEnd(m)}else{if(p){l.setWallAtStart(m)}}if(f){d.setWallAtEnd(m)}else{if(g){d.setWallAtStart(m)}}var j=m.getHeightAtEnd();if(j!=null){var o=m.getHeight();m.setHeight(j);m.setHeightAtEnd(o)}b.reverseWallSidesStyle(m)}};b.reverseWallSidesStyle=function(g){var f=g.getRightSideColor();var l=g.getRightSideTexture();var c=g.getLeftSideShininess();var d=g.getLeftSideBaseboard();var e=g.getLeftSideColor();var j=g.getLeftSideTexture();var h=g.getRightSideShininess();var k=g.getRightSideBaseboard();g.setLeftSideColor(f);g.setLeftSideTexture(l);g.setLeftSideShininess(h);g.setLeftSideBaseboard(k);g.setRightSideColor(e);g.setRightSideTexture(j);g.setRightSideShininess(c);g.setRightSideBaseboard(d)};b.prototype.splitSelectedWall=function(){var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var s=Home.getWallsSubList(m);if(s.length===1){var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var w=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var r=s[0];var x=new b.JoinedWall(r);var f=r.getXStart();var k=r.getYStart();var j=r.getXEnd();var n=r.getYEnd();var q=(f+j)/2;var d=(k+n)/2;var t=r.getWallAtStart();var g=t!=null&&t.getWallAtEnd()===r;var l=t!=null&&t.getWallAtStart()===r;var h=r.getWallAtEnd();var u=h!=null&&h.getWallAtEnd()===r;var c=h!=null&&h.getWallAtStart()===r;var v=r.duplicate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(v);v.setLevel(r.getLevel());var p=r.duplicate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(p);p.setLevel(r.getLevel());v.setXEnd(q);v.setYEnd(d);p.setXStart(q);p.setYStart(d);if(r.getHeightAtEnd()!=null){var e=(r.getHeight()+r.getHeightAtEnd())/2;v.setHeightAtEnd(e);p.setHeight(e)}v.setWallAtEnd(p);p.setWallAtStart(v);v.setWallAtStart(t);if(g){t.setWallAtEnd(v)}else{if(l){t.setWallAtStart(v)}}p.setWallAtEnd(h);if(c){h.setWallAtStart(p)}else{if(u){h.setWallAtEnd(p)}}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(r);this.selectAndShowItems$java_util_List$boolean([v].slice(0),false);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallSplittingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,m.slice(0),w,o,x,new b.JoinedWall(v),new b.JoinedWall(p),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()))}};b.prototype.modifySelectedRooms=function(){if(!(Home.getRoomsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new RoomController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.createDimensionLine$float$float=function(c,d){new DimensionLineController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,c,d,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())};b.prototype.createLabel=function(c,d){new LabelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,c,d,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())};b.prototype.modifySelectedLabels=function(){if(!(Home.getLabelsSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new LabelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.modifySelectedPolylines=function(){if(!(Home.getPolylinesSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new PolylineController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_contentManager,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.modifySelectedDimensionLines=function(){if(!(Home.getDimensionLinesSubList(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()).length==0)){new DimensionLineController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.modifyCompass=function(){new CompassController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())};b.prototype.modifyObserverCamera=function(){new ObserverCameraController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory).displayView(this.getView())};b.prototype.toggleBoldStyle=function(){var h=null;var k=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var j=0;j<k.length;j++){var r=k[j];var l=void 0;if(r!=null&&r instanceof Label){l=this.getItemTextStyle(r,r.getStyle()).isBold()}else{if((r!=null&&r instanceof HomePieceOfFurniture)&&r.isVisible()){l=this.getItemTextStyle(r,r.getNameStyle()).isBold()}else{if(r!=null&&r instanceof Room){var c=r;l=this.getItemTextStyle(c,c.getNameStyle()).isBold();if(l!==this.getItemTextStyle(c,c.getAreaStyle()).isBold()){l=null}}else{if(r!=null&&r instanceof DimensionLine){l=this.getItemTextStyle(r,r.getLengthStyle()).isBold()}else{continue}}}}if(h==null){h=l}else{if(l==null||!(h===l)){h=null;break}}}if(h==null){h=true}else{h=!h}var f=([]);var e=([]);var o=([]);var k=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var j=0;j<k.length;j++){var r=k[j];if(r!=null&&r instanceof Label){var n=r;(f.push(n)>0);var q=this.getItemTextStyle(n,n.getStyle());(e.push(q)>0);(o.push(q.deriveBoldStyle(h))>0)}else{if(r!=null&&r instanceof HomePieceOfFurniture){var s=r;if(s.isVisible()){(f.push(s)>0);var g=this.getItemTextStyle(s,s.getNameStyle());(e.push(g)>0);(o.push(g.deriveBoldStyle(h))>0)}}else{if(r!=null&&r instanceof Room){var c=r;(f.push(c)>0);var g=this.getItemTextStyle(c,c.getNameStyle());(e.push(g)>0);(o.push(g.deriveBoldStyle(h))>0);var d=this.getItemTextStyle(c,c.getAreaStyle());(e.push(d)>0);(o.push(d.deriveBoldStyle(h))>0)}else{if(r!=null&&r instanceof DimensionLine){var p=r;(f.push(p)>0);var m=this.getItemTextStyle(p,p.getLengthStyle());(e.push(m)>0);(o.push(m.deriveBoldStyle(h))>0)}}}}}this.modifyTextStyle(f.slice(0),e.slice(0),o.slice(0))};b.prototype.getItemTextStyle=function(c,d){if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(c.constructor)}return d};b.prototype.toggleItalicStyle=function(){var h=null;var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var k=0;k<l.length;k++){var r=l[k];var j=void 0;if(r!=null&&r instanceof Label){j=this.getItemTextStyle(r,r.getStyle()).isItalic()}else{if((r!=null&&r instanceof HomePieceOfFurniture)&&r.isVisible()){j=this.getItemTextStyle(r,r.getNameStyle()).isItalic()}else{if(r!=null&&r instanceof Room){var c=r;j=this.getItemTextStyle(c,c.getNameStyle()).isItalic();if(j!==this.getItemTextStyle(c,c.getAreaStyle()).isItalic()){j=null}}else{if(r!=null&&r instanceof DimensionLine){j=this.getItemTextStyle(r,r.getLengthStyle()).isItalic()}else{continue}}}}if(h==null){h=j}else{if(j==null||!(h===j)){h=null;break}}}if(h==null){h=true}else{h=!h}var f=([]);var e=([]);var o=([]);var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var k=0;k<l.length;k++){var r=l[k];if(r!=null&&r instanceof Label){var n=r;(f.push(n)>0);var q=this.getItemTextStyle(n,n.getStyle());(e.push(q)>0);(o.push(q.deriveItalicStyle(h))>0)}else{if(r!=null&&r instanceof HomePieceOfFurniture){var s=r;if(s.isVisible()){(f.push(s)>0);var g=this.getItemTextStyle(s,s.getNameStyle());(e.push(g)>0);(o.push(g.deriveItalicStyle(h))>0)}}else{if(r!=null&&r instanceof Room){var c=r;(f.push(c)>0);var g=this.getItemTextStyle(c,c.getNameStyle());(e.push(g)>0);(o.push(g.deriveItalicStyle(h))>0);var d=this.getItemTextStyle(c,c.getAreaStyle());(e.push(d)>0);(o.push(d.deriveItalicStyle(h))>0)}else{if(r!=null&&r instanceof DimensionLine){var p=r;(f.push(p)>0);var m=this.getItemTextStyle(p,p.getLengthStyle());(e.push(m)>0);(o.push(m.deriveItalicStyle(h))>0)}}}}}this.modifyTextStyle(f.slice(0),e.slice(0),o.slice(0))};b.prototype.increaseTextSize=function(){this.applyFactorToTextSize(1.1)};b.prototype.decreaseTextSize=function(){this.applyFactorToTextSize(1/1.1)};b.prototype.applyFactorToTextSize=function(k){var f=([]);var e=([]);var m=([]);var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var h=0;h<j.length;h++){var q=j[h];if(q!=null&&q instanceof Label){var n=q;(f.push(n)>0);var p=this.getItemTextStyle(q,n.getStyle());(e.push(p)>0);(m.push(p.deriveStyle$float(Math.round(p.getFontSize()*k)))>0)}else{if(q!=null&&q instanceof HomePieceOfFurniture){var r=q;if(r.isVisible()){(f.push(r)>0);var g=this.getItemTextStyle(r,r.getNameStyle());(e.push(g)>0);(m.push(g.deriveStyle$float(Math.round(g.getFontSize()*k)))>0)}}else{if(q!=null&&q instanceof Room){var c=q;(f.push(c)>0);var g=this.getItemTextStyle(c,c.getNameStyle());(e.push(g)>0);(m.push(g.deriveStyle$float(Math.round(g.getFontSize()*k)))>0);var d=this.getItemTextStyle(c,c.getAreaStyle());(e.push(d)>0);(m.push(d.deriveStyle$float(Math.round(d.getFontSize()*k)))>0)}else{if(q!=null&&q instanceof DimensionLine){var o=q;(f.push(o)>0);var l=this.getItemTextStyle(o,o.getLengthStyle());(e.push(l)>0);(m.push(l.deriveStyle$float(Math.round(l.getFontSize()*k)))>0)}}}}}this.modifyTextStyle(f.slice(0),e.slice(0),m.slice(0))};b.prototype.modifyTextStyle=function(d,f,g){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var c=h.slice(0);b.doModifyTextStyle(d,g);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.TextStyleModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,e,f,d,g))};b.doModifyTextStyle=function(c,g){var j=0;for(var d=0;d<c.length;d++){var f=c[d];if(f!=null&&f instanceof Label){f.setStyle(g[j++])}else{if(f!=null&&f instanceof HomePieceOfFurniture){var e=f;if(e.isVisible()){e.setNameStyle(g[j++])}}else{if(f!=null&&f instanceof Room){var h=f;h.setNameStyle(g[j++]);h.setAreaStyle(g[j++])}else{if(f!=null&&f instanceof DimensionLine){f.setLengthStyle(g[j++])}}}}}};b.prototype.getMinimumScale=function(){return 0.01};b.prototype.getMaximumScale=function(){return 10};b.prototype.getScale=function(){return this.getView().getScale()};b.prototype.setScale=function(e){e=Math.max(this.getMinimumScale(),Math.min(e,this.getMaximumScale()));if(e!==this.getView().getScale()){var d=this.getView().getScale();this.furnitureSidesCache.entries=[];if(this.getView()!=null){var c=this.getView().convertXModelToScreen(this.getXLastMouseMove());var f=this.getView().convertXModelToScreen(this.getYLastMouseMove());this.getView().setScale(e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setPlanScale(e<0.4?0.4/e:1);this.moveMouse(this.getView().convertXPixelToModel(c),this.getView().convertYPixelToModel(f))}this.propertyChangeSupport.firePropertyChange("SCALE",d,e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setProperty(b.SCALE_VISUAL_PROPERTY,String(e).toString())}};b.prototype.setSelectedLevel=function(c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedLevel(c)};b.prototype.selectAll=function(){var c=this.getVisibleItemsAtSelectedLevel();if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(this.getItemsNotPartOfBasePlan(c))}else{this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(false)};b.prototype.getVisibleItemsAtSelectedLevel=function(){var e=([]);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectableViewableItems();for(var c=0;c<g.length;c++){var d=g[c];if(d!=null&&d instanceof HomePieceOfFurniture){if(this.isPieceOfFurnitureVisibleAtSelectedLevel(d)){(e.push(d)>0)}}else{if(!(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))||d.isAtLevel(f)){(e.push(d)>0)}}}return e};b.prototype.selectAllAtAllLevels=function(){var c=(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectableViewableItems().slice(0));if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked()){c=this.getItemsNotPartOfBasePlan(c)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(true)};b.prototype.getDetectableRoomsAtSelectedLevel=function(){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();if(j==null||l.length<=1){return d}else{var g=([]);var f=l.indexOf(j);var k=l[0]===j||l[f-1].getElevation()===j.getElevation();var h=l[k&&f<l.length-1?f+1:f-1];for(var e=0;e<d.length;e++){var c=d[e];if(c.isAtLevel(j)||h!=null&&c.isAtLevel(h)&&(k&&c.isFloorVisible()||!k&&c.isCeilingVisible())){(g.push(c)>0)}}return g}};b.prototype.getDetectableWallsAtSelectedLevel=function(){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var l=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();if(j==null||l.length<=1){return c}else{var e=([]);var f=l.indexOf(j);var k=l[0]===j||l[f-1].getElevation()===j.getElevation();var g=l[k&&f<l.length-1?f+1:f-1];for(var d=0;d<c.length;d++){var h=c[d];if(h.isAtLevel(j)||g!=null&&h.isAtLevel(g)){(e.push(h)>0)}}return e}};b.prototype.getHorizontalRulerView=function(){return this.getView().getHorizontalRuler()};b.prototype.getVerticalRulerView=function(){return this.getView().getVerticalRuler()};b.prototype.__com_eteks_sweethome3d_viewcontroller_PlanController_addModelListeners=function(){var c=this;this.selectionListener=new b.PlanController$1(this);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().addPropertyChangeListener(new b.PlanController$2(this));this.wallChangeListener=new b.PlanController$3(this);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var d=0;d<e.length;d++){var h=e[d];h.addPropertyChangeListener(this.wallChangeListener)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWallsListener(function(m){if(m.getType()===CollectionEvent.Type.ADD){m.getItem().addPropertyChangeListener(c.wallChangeListener)}else{if(m.getType()===CollectionEvent.Type.DELETE){m.getItem().removePropertyChangeListener(c.wallChangeListener)}}c.resetAreaCache()});var g=new b.PlanController$4(this);this.furnitureSizeChangeListener=new b.PlanController$5(this);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var d=0;d<e.length;d++){var l=e[d];l.addPropertyChangeListener(g);l.addPropertyChangeListener(this.furnitureSizeChangeListener);if(l!=null&&l instanceof HomeFurnitureGroup){var k=l.getAllFurniture();for(var f=0;f<k.length;f++){var j=k[f];j.addPropertyChangeListener(this.furnitureSizeChangeListener)}}}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addFurnitureListener(function(p){var o=p.getItem();if(p.getType()===CollectionEvent.Type.ADD){o.addPropertyChangeListener(g);o.addPropertyChangeListener(c.furnitureSizeChangeListener);if(o!=null&&o instanceof HomeFurnitureGroup){var q=o.getAllFurniture();for(var n=0;n<q.length;n++){var m=q[n];m.addPropertyChangeListener(c.furnitureSizeChangeListener)}}}else{if(p.getType()===CollectionEvent.Type.DELETE){o.removePropertyChangeListener(g);(function(r,s){if(r.entries==null){r.entries=[]}for(var t=0;t<r.entries.length;t++){if(r.entries[t].key==null&&s==null||r.entries[t].key.equals!=null&&r.entries[t].key.equals(s)||r.entries[t].key===s){return r.entries.splice(t,1)[0]}}})(c.furnitureSidesCache,o);o.removePropertyChangeListener(c.furnitureSizeChangeListener);if(o!=null&&o instanceof HomeFurnitureGroup){var q=o.getAllFurniture();for(var n=0;n<q.length;n++){var m=q[n];m.removePropertyChangeListener(c.furnitureSizeChangeListener)}}}}});this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPropertyChangeListener("SELECTED_LEVEL",new b.PlanController$6(this));this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setFixedSize(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels().length>=2);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLevelsListener(function(m){c.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera().setFixedSize(c.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels().length>=2)})};b.prototype.getSelectionListener=function(){return this.selectionListener};b.prototype.resetAreaCache=function(){this.wallsAreaCache=null;this.wallsIncludingBaseboardsAreaCache=null;this.insideWallsAreaCache=null;this.roomPathsCache=null};b.prototype.startDraggedItems=function(h,c,g){this.draggedItems=h;if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()){var f=Home.getFurnitureSubList(h);for(var d=0;d<f.length;d++){var e=f[d];if(e.isResizable()){e.setWidth(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getWidth(),0.1));e.setWidthInPlan(e.getWidth());e.setDepth(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getDepth(),0.1));e.setDepthInPlan(e.getDepth());e.setHeight(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getHeight(),0.1));e.setHeightInPlan(e.getHeight())}e.setElevation(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(e.getElevation(),0.1))}}if(this.isModificationState()){this.escape()}this.setState(this.getDragAndDropState());this.moveMouse(c,g)};b.prototype.stopDraggedItems=function(){if(this.state!==this.getDragAndDropState()){throw new IllegalStateException("Controller isn't in a drag and drop state")}this.draggedItems=null;this.setState(this.previousState)};b.prototype.adjustMagnetizedPieceOfFurniture=function(d,c,h){var g=this.adjustPieceOfFurnitureElevation(d,false,3.4028235e+38)!=null;var f=this.adjustPieceOfFurnitureOnWallAt(d,c,h,true);var e=null;if(!g){e=this.adjustPieceOfFurnitureSideBySideAt(d,f==null,f)}if(e==null){this.adjustPieceOfFurnitureInShelfBox(d,f==null)}};b.prototype.adjustPieceOfFurnitureOnWallAt=function(A,X,W,w){var k=b.PIXEL_MARGIN/this.getScale();var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var ai=A.getPoints();var d=!A.isDoorOrWindow()&&A.getElevation()===0;var v=this.getWallsArea(d);var s=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();var h=null;var T=null;if(w||!A.isDoorOrWindow()){for(var R=0;R<s.length;R++){var q=s[R];if(q.isAtLevel(m)&&this.isLevelNullOrViewable(q.getLevel())&&q.containsPoint$float$float$boolean$float(X,W,d,0)&&q.getStartPointToEndPointDistance()>0){h=this.getReferenceWall(q,X,W);T=q.getArcExtent();break}}if(h==null){for(var R=0;R<s.length;R++){var q=s[R];if(q.isAtLevel(m)&&this.isLevelNullOrViewable(q.getLevel())&&q.containsPoint$float$float$boolean$float(X,W,d,0)&&q.getStartPointToEndPointDistance()>0){h=this.getReferenceWall(q,X,W);T=q.getArcExtent();break}}}}if(h==null){var c=new java.awt.geom.Area(this.getRotatedRectangle(A.getX()-A.getWidthInPlan()/2-k,A.getY()-A.getDepthInPlan()/2-k,A.getWidthInPlan()+2*k,A.getDepthInPlan()+2*k,A.getAngle()));var ag=0;for(var R=0;R<s.length;R++){var q=s[R];if(q.isAtLevel(m)&&this.isLevelNullOrViewable(q.getLevel())&&q.getStartPointToEndPointDistance()>0){var aj=q.getPoints$boolean(d);var ad=new java.awt.geom.Area(this.getPath$float_A_A(aj));ad.intersect(c);if(!ad.isEmpty()){var Y=this.getArea(ad);if(Y>ag){ag=Y;if(w){h=this.getReferenceWall(q,X,W);T=q.getArcExtent()}else{var r=ad.getBounds2D();h=this.getReferenceWall(q,r.getCenterX(),r.getCenterY());T=q.getArcExtent()}}}}}}if(h!=null){var e=X;var P=W;var B=A.getAngle();var O=A.getWidthInPlan()/2;var Z=A.getDepthInPlan()/2;var F=Math.atan2(h.getYEnd()-h.getYStart(),h.getXEnd()-h.getXStart());var aj=h.getPoints$boolean(d);var t=F>-Math.PI/2&&F<=Math.PI/2;var J=Math.cos(F);var G=Math.sin(F);var z=aj[0][0]!==aj[0][1]||aj[1][0]!==aj[1][1]?java.awt.geom.Line2D.ptLineDist(aj[0][0],aj[0][1],aj[1][0],aj[1][1],X,W):java.awt.geom.Point2D.distance(aj[0][0],aj[0][1],X,W);var H=aj[2][0]!==aj[2][1]||aj[3][0]!==aj[3][1]?java.awt.geom.Line2D.ptLineDist(aj[2][0],aj[2][1],aj[3][0],aj[3][1],X,W):java.awt.geom.Point2D.distance(aj[2][0],aj[2][1],X,W);var u=w||A.isDoorOrWindow()||h.containsPoint$float$float$boolean$float(X,W,d,k);if(u){var p=java.awt.geom.Line2D.ptLineDist(ai[0][0],ai[0][1],ai[3][0],ai[3][1],X,W);var Q=java.awt.geom.Line2D.ptLineDist(ai[1][0],ai[1][1],ai[2][0],ai[2][1],X,W);var l=B>(3*Math.PI/2+0.000001)||B<(Math.PI/2+0.000001)?p:Q;B=(H<z?F:F+Math.PI);if(A.isDoorOrWindow()){var E=0.00075;var ac=void 0;if(T==null||T===0){ac=E/2;if(A!=null&&A instanceof HomeDoorOrWindow){var V=A;if(A.isResizable()&&this.isItemResizable(A)&&V.isWidthDepthDeformable()&&V.getModelTransformations()==null){A.setDepth(E+h.getThickness()/V.getWallThickness());A.setDepthInPlan(A.getDepth());Z=A.getDepth()/2;ac+=A.getDepth()*V.getWallDistance()}else{ac+=A.getDepth()*(V.getWallDistance()+V.getWallThickness())-h.getThickness()}}}else{ac=-h.getThickness()/2;if(A!=null&&A instanceof HomeDoorOrWindow){var V=A;ac+=A.getDepth()*(V.getWallDistance()+V.getWallThickness()/2)}}if(H<z){e+=G*((z+ac)-Z);P+=J*(-(z+ac)+Z)}else{e+=G*(-(H+ac)+Z);P+=J*((H+ac)-Z)}if(t){e+=J*(O-l);P+=G*(O-l)}else{e+=-J*(O-l);P+=-G*(O-l)}}else{if(H<z){var o=java.awt.geom.Line2D.relativeCCW(aj[2][0],aj[2][1],aj[3][0],aj[3][1],X,W);e+=o*G*H-G*Z;P+=-o*J*H+J*Z}else{var o=java.awt.geom.Line2D.relativeCCW(aj[0][0],aj[0][1],aj[1][0],aj[1][1],X,W);e+=-o*G*z+G*Z;P+=o*J*z-J*Z}if(t){e+=J*(O-l);P+=G*(O-l)}else{e+=-J*(O-l);P+=-G*(O-l)}}}else{var I=new java.awt.geom.Line2D.Float(h.getXStart(),h.getYStart(),h.getXEnd(),h.getYEnd());var j=this.getRotatedRectangle(0,0,A.getWidthInPlan(),A.getDepthInPlan(),(B-F));var U=j.getBounds2D().getHeight();var M=(function(x){if(x>0){return 1}else{if(x<0){return -1}else{return 0}}})(I.relativeCCW(A.getX(),A.getY()));var f=(function(x){if(x>0){return 1}else{if(x<0){return -1}else{return 0}}})(I.relativeCCW(X,W));var D=M*(-h.getThickness()/2+I.ptLineDist(A.getX(),A.getY())-U/2);if(d){if(M>0&&h.getLeftSideBaseboard()!=null){D-=M*h.getLeftSideBaseboard().getThickness()}else{if(M<0&&h.getRightSideBaseboard()!=null){D-=M*h.getRightSideBaseboard().getThickness()}}}if(f!==M){D-=f*(U+h.getThickness());if(h.getLeftSideBaseboard()!=null){D-=f*h.getLeftSideBaseboard().getThickness()}if(h.getRightSideBaseboard()!=null){D-=f*h.getRightSideBaseboard().getThickness()}}e=A.getX()+(-D*G);P=A.getY()+(D*J)}if(!A.isDoorOrWindow()&&(h.getArcExtent()==null||!u||java.awt.geom.Line2D.relativeCCW(h.getXStart(),h.getYStart(),h.getXEnd(),h.getYEnd(),X,W)>0)){var S=new java.awt.geom.Area(v);var n=new java.awt.geom.Area(this.getRotatedRectangle(e-O,P-Z,A.getWidthInPlan(),A.getDepthInPlan(),B));S.subtract(new java.awt.geom.Area(this.getPath$float_A_A(aj)));S.intersect(n);if(!S.isEmpty()){var L=this.getClosestPath(this.getAreaPaths(S),X,W);if(L!=null){n.subtract(v);if(n.isEmpty()){return null}else{var ah=this.getAreaPaths(n);var C=(F-B+2*Math.PI)%Math.PI;if(C<0.00001||Math.PI-C<0.00001||ah.length<2){var K=this.getClosestPath(ah,X,W);var ae=new java.awt.geom.Area(L);for(var R=0;R<ah.length;R++){var ab=ah[R];if(ab!==K){ae.add(new java.awt.geom.Area(ab))}}var N=java.awt.geom.AffineTransform.getRotateInstance(-F);var af=ae.createTransformedArea(N).getBounds2D();var aa=K.createTransformedShape(N).getBounds2D();if(!af.contains(aa)){var g=(function(x){if(x>0){return 1}else{if(x<0){return -1}else{return 0}}})(aa.getCenterX()-af.getCenterX());e+=af.getWidth()*J*g;P+=af.getWidth()*G*g}}}}}}A.setAngle(B);A.setX(e);A.setY(P);if(A!=null&&A instanceof HomeDoorOrWindow){A.setBoundToWall(T==null||T===0)}return h}return null};b.prototype.isLevelNullOrViewable=function(c){return c==null||c.isViewable()};b.prototype.getReferenceWall=function(e,d,k){var h=e.getArcExtent();if(h==null||h===0){return e}else{var j=Math.atan2(e.getYArcCircleCenter()-k,d-e.getXArcCircleCenter());var c=java.awt.geom.Point2D.distance(e.getXArcCircleCenter(),e.getYArcCircleCenter(),e.getXStart(),e.getYStart());var f=0.001;var g=new Wall((e.getXArcCircleCenter()+Math.cos(j+f)*c),(e.getYArcCircleCenter()-Math.sin(j+f)*c),(e.getXArcCircleCenter()+Math.cos(j-f)*c),(e.getYArcCircleCenter()-Math.sin(j-f)*c),e.getThickness(),0);g.setLeftSideBaseboard(e.getLeftSideBaseboard());g.setRightSideBaseboard(e.getRightSideBaseboard());return g}};b.prototype.getClosestPath=function(l,j,h){var c=null;var d=1.7976931348623157e+308;for(var f=0;f<l.length;f++){var m=l[f];var g=this.getPathPoints(m,true);for(var e=0;e<g.length;e++){var k=java.awt.geom.Line2D.ptSegDistSq(g[e][0],g[e][1],g[(e+1)%g.length][0],g[(e+1)%g.length][1],j,h);if(k<d){d=k;c=m}}}return c};b.prototype.getDimensionLinesAlongWall=function(g,A){var e=g.getPoints();var y=g.getAngle();var c=A.getPoints$();var v;var r;var s=g.isDoorOrWindow()?e[3]:e[0];if(java.awt.geom.Line2D.ptLineDistSq(c[0][0],c[0][1],c[1][0],c[1][1],s[0],s[1])<=java.awt.geom.Line2D.ptLineDistSq(c[2][0],c[2][1],c[3][0],c[3][1],s[0],s[1])){v=b.computeIntersection$float_A$float_A$float_A$float_A(c[0],c[1],e[0],e[3]);r=b.computeIntersection$float_A$float_A$float_A$float_A(c[0],c[1],e[1],e[2])}else{v=b.computeIntersection$float_A$float_A$float_A$float_A(c[2],c[3],e[0],e[3]);r=b.computeIntersection$float_A$float_A$float_A$float_A(c[2],c[3],e[1],e[2])}var l=([]);var z=null;var q=null;var C=this.getRoomPathsFromWalls();for(var x=0;x<C.length&&z==null&&q==null;x++){var o=this.getPathPoints(C[x],true);for(var w=0;w<o.length;w++){var p=o[w];var n=o[(w+1)%o.length];var E=n[0]-p[0];var D=n[1]-p[1];var B=Math.abs(E)<0.00001?Math.PI/2:(Math.abs(D)<0.00001?0:Math.atan2(D,E));var F=(B-y+2*Math.PI)%Math.PI;if(F<0.00001||Math.PI-F<0.00001){var k=java.awt.geom.Line2D.ptSegDistSq(p[0],p[1],n[0],n[1],v[0],v[1])<0.0001;var u=java.awt.geom.Line2D.ptSegDistSq(p[0],p[1],n[0],n[1],r[0],r[1])<0.0001;if(k||u){if(k){var t=java.awt.geom.Point2D.distanceSq(p[0],p[1],v[0],v[1]);var G=java.awt.geom.Point2D.distanceSq(p[0],p[1],r[0],r[1]);if(t<G||!u){z=p.slice(0)}else{z=n.slice(0)}}if(u){var d=java.awt.geom.Point2D.distanceSq(n[0],n[1],v[0],v[1]);var f=java.awt.geom.Point2D.distanceSq(n[0],n[1],r[0],r[1]);if(d<f&&k){q=p.slice(0)}else{q=n.slice(0)}}break}}}}var m=!g.isDoorOrWindow()&&java.awt.geom.Line2D.ptLineDistSq(A.getXStart(),A.getYStart(),A.getXEnd(),A.getYEnd(),s[0],s[1])>java.awt.geom.Line2D.ptLineDistSq(A.getXStart(),A.getYStart(),A.getXEnd(),A.getYEnd(),e[3][0],e[3][1]);if(z!=null){var h=void 0;if(m){h=-java.awt.geom.Point2D.distance(v[0],v[1],e[0][0],e[0][1])-10/this.getView().getScale()}else{h=java.awt.geom.Point2D.distance(v[0],v[1],e[3][0],e[3][1])+10/this.getView().getScale()}(l.push(this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(z,v,h,0,false))>0)}if(q!=null){var h=void 0;if(m){h=-java.awt.geom.Point2D.distance(r[0],r[1],e[1][0],e[1][1])-10/this.getView().getScale()}else{h=java.awt.geom.Point2D.distance(r[0],r[1],e[2][0],e[2][1])+10/this.getView().getScale()}(l.push(this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(r,q,h,0,false))>0)}for(var x=l.length-1;x>=0;x--){if(l[x].getLength()<0.01){l.splice(x,1)[0]}}return l};b.computeIntersection$float_A$float_A$float_A$float_A=function(f,e,d,c){return b.computeIntersection$float$float$float$float$float$float$float$float(f[0],f[1],e[0],e[1],d[0],d[1],c[0],c[1])};b.computeIntersection$float$float$float$float$float$float$float$float=function(r,j,q,h,o,g,m,f){var l=q;var k=h;var p=(h-j)/(q-r);var n=(f-g)/(m-o);if(p!==n){if(Math.abs(p)>4000){if(Math.abs(n)<4000){l=r;var d=f-n*m;k=n*l+d}}else{if(Math.abs(n)>4000){if(Math.abs(p)<4000){l=o;var e=h-p*q;k=p*l+e}}else{var c=(function(s){if(s>0){return 1}else{if(s<0){return -1}else{return 0}}})(p)===(function(s){if(s>0){return 1}else{if(s<0){return -1}else{return 0}}})(n);if(Math.abs(p-n)>0.00001&&(!c||(Math.abs(p)>Math.abs(n)?p/n:n/p)>1.004)){var e=h-p*q;var d=f-n*m;l=(d-e)/(p-n);k=p*l+e}}}}return[l,k]};b.computeIntersection=function(d,h,c,g,k,f,j,e){if(((typeof d==="number")||d===null)&&((typeof h==="number")||h===null)&&((typeof c==="number")||c===null)&&((typeof g==="number")||g===null)&&((typeof k==="number")||k===null)&&((typeof f==="number")||f===null)&&((typeof j==="number")||j===null)&&((typeof e==="number")||e===null)){return b.computeIntersection$float$float$float$float$float$float$float$float(d,h,c,g,k,f,j,e)}else{if(((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(typeof d[0]==="number")))||d===null)&&((h!=null&&h instanceof Array&&(h.length==0||h[0]==null||(typeof h[0]==="number")))||h===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)&&((g!=null&&g instanceof Array&&(g.length==0||g[0]==null||(typeof g[0]==="number")))||g===null)&&k===undefined&&f===undefined&&j===undefined&&e===undefined){return b.computeIntersection$float_A$float_A$float_A$float_A(d,h,c,g)}else{throw new Error("invalid overload")}}};b.prototype.adjustPieceOfFurnitureElevation=function(f,d,p){if(!d||!f.isDoorOrWindow()&&f.getElevation()===0){var c=3.4028235e+38;var l=f.getElevation();var s=l;var v=void 0;if(d||f.getElevation()===0){var o=this.getHighestSurroundingPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(f);if(o!=null){v=[o]}else{return null}}else{v=this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(f);var k=false;for(var j=0;j<v.length;j++){var u=v[j];if(u!=null&&u instanceof HomeShelfUnit){k=true}}if(!k){return null}}for(var j=0;j<v.length;j++){var u=v[j];var n=[];if(!d&&(u!=null&&u instanceof HomeShelfUnit)&&!u.isHorizontallyRotated()){var r=u;var e=r.getShelfBoxes();if(e.length>0){n=(function(x){var w=[];while(x-->0){w.push(0)}return w})(e.length);for(var t=0;t<n.length;t++){n[t]=e[t].getZLower()}}else{n=r.getShelfElevations()}}if(n.length===0||n[0]!==0&&f.getElevation()===0){n=[u.getDropOnTopElevation()]}if(n.length!==0){for(var h=0;h<n.length;h++){var g=n[h];var q=u.getElevation();if(u.isHorizontallyRotated()){q+=u.getHeightInPlan()}else{q+=u.getHeight()*g}if(u.getLevel()!=null){q+=u.getLevel().getElevation()-(f.getLevel()!=null?f.getLevel().getElevation():this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel().getElevation())}var m=Math.abs(l-q);if(c>m){c=m;s=q}}}}if(s!==l&&Math.abs(s-l)<p){f.setElevation(s);return f}}return null};b.prototype.adjustPieceOfFurnitureSideBySideAt=function(u,s,K){var O=u.getPoints();var k=new java.awt.geom.Area(this.getPath$float_A_A(O));var m=(u!=null&&u instanceof HomeDoorOrWindow)&&u.isBoundToWall();var x=u.getGroundElevation();var h=2*b.PIXEL_MARGIN/this.getScale();var L=null;var c=null;var J=0;var n=null;var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var D=0;D<e.length;D++){var A=e[D];var F=A.getGroundElevation();if(A!==u&&this.isPieceOfFurnitureVisibleAtSelectedLevel(A)&&x<F+A.getHeightInPlan()&&x+u.getHeightInPlan()>F&&(!m||A.isDoorOrWindow())){var H=A.getPoints();var G=void 0;if(m&&A.isDoorOrWindow()){G=new java.awt.geom.Area(this.getPath$float_A_A(new Wall(H[1][0],H[1][1],H[2][0],H[2][1],h,0).getPoints$()));G.add(new java.awt.geom.Area(this.getPath$float_A_A(new Wall(H[3][0],H[3][1],H[0][0],H[0][1],h,0).getPoints$())))}else{G=(function(P,Q){if(P.entries==null){P.entries=[]}for(var R=0;R<P.entries.length;R++){if(P.entries[R].key==null&&Q==null||P.entries[R].key.equals!=null&&P.entries[R].key.equals(Q)||P.entries[R].key===Q){return P.entries[R].value}}return null})(this.furnitureSidesCache,A);if(G==null){var N=(function(Q){var P=[];while(Q-->0){P.push(null)}return P})(H.length);for(var M=0;M<N.length;M++){N[M]=new Wall(H[M][0],H[M][1],H[(M+1)%N.length][0],H[(M+1)%N.length][1],h,0)}for(var M=0;M<N.length;M++){N[(M+1)%N.length].setWallAtStart(N[M]);N[M].setWallAtEnd(N[(M+1)%N.length])}var C=(function(Q){var P=[];while(Q-->0){P.push(null)}return P})(N.length*2+2);var B=null;for(var M=0;M<N.length;M++){B=N[M].getPoints$();C[M]=B[0];C[C.length-M-1]=B[3]}C[(C.length/2|0)-1]=B[1];C[(C.length/2|0)]=B[2];G=new java.awt.geom.Area(this.getPath$float_A_A(C));(function(P,R,Q){if(P.entries==null){P.entries=[]}for(var S=0;S<P.entries.length;S++){if(P.entries[S].key==null&&R==null||P.entries[S].key.equals!=null&&P.entries[S].key.equals(R)||P.entries[S].key===R){P.entries[S].value=Q;return}}P.entries.push({key:R,value:Q,getKey:function(){return this.key},getValue:function(){return this.value}})})(this.furnitureSidesCache,A,G)}}var d=new java.awt.geom.Area(G);d.intersect(k);if(!d.isEmpty()){var r=new java.awt.geom.Area(k);r.exclusiveOr(d);if(r.isSingular()){var t=new java.awt.geom.Area(this.getPath$float_A_A(H));t.subtract(G);t.intersect(k);if(t.isEmpty()){var I=this.getArea(d);if(I>J){J=I;L=A;n=H;c=d}}}}}}if(L!=null){var v=void 0;if(m&&L.isDoorOrWindow()){v=false}else{var l=this.getRotatedRectangle(L.getX()-L.getWidthInPlan(),L.getY()-L.getDepthInPlan(),L.getWidthInPlan()*2,L.getDepthInPlan()*2,L.getAngle());var f=this.getPathPoints(l,false);v=this.isAreaLargerOnFrontOrBackSide(c,f)}if(s){u.setAngle(L.getAngle())}var j=this.getRotatedRectangle(0,0,u.getWidthInPlan(),u.getDepthInPlan(),u.getAngle()-L.getAngle());var p=0;var o=0;if(!v){var y=new java.awt.geom.Line2D.Float(L.getX(),L.getY(),(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2);var z=j.getBounds2D().getWidth();var w=y.relativeCCW(u.getX(),u.getY())*(-L.getWidthInPlan()/2+y.ptLineDist(u.getX(),u.getY())-z/2);p=(w*Math.cos(L.getAngle()));o=(w*Math.sin(L.getAngle()))}else{var y=new java.awt.geom.Line2D.Float(L.getX(),L.getY(),(n[2][0]+n[1][0])/2,(n[2][1]+n[1][1])/2);var E=j.getBounds2D().getHeight();var w=y.relativeCCW(u.getX(),u.getY())*(-L.getDepthInPlan()/2+y.ptLineDist(u.getX(),u.getY())-E/2);p=(-w*Math.sin(L.getAngle()));o=(w*Math.cos(L.getAngle()));if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(u,K,p,o)){p=o=0}}if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(u,L,p,o)){u.move(p,o);return L}else{if(s){O=u.getPoints()}var q=this.isAreaLargerOnFrontOrBackSide(c,O);var g=this.getRotatedRectangle(0,0,L.getWidthInPlan(),L.getDepthInPlan(),L.getAngle()-u.getAngle());if(!q){var y=new java.awt.geom.Line2D.Float(u.getX(),u.getY(),(O[0][0]+O[1][0])/2,(O[0][1]+O[1][1])/2);var z=g.getBounds2D().getWidth();var w=y.relativeCCW(L.getX(),L.getY())*(-u.getWidthInPlan()/2+y.ptLineDist(L.getX(),L.getY())-z/2);p=-(w*Math.cos(u.getAngle()));o=-(w*Math.sin(u.getAngle()))}else{var y=new java.awt.geom.Line2D.Float(u.getX(),u.getY(),(O[2][0]+O[1][0])/2,(O[2][1]+O[1][1])/2);var E=g.getBounds2D().getHeight();var w=y.relativeCCW(L.getX(),L.getY())*(-u.getDepthInPlan()/2+y.ptLineDist(L.getX(),L.getY())-E/2);p=-(-w*Math.sin(u.getAngle()));o=-(w*Math.cos(u.getAngle()));if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(u,K,p,o)){p=o=0}}if(!this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(u,L,p,o)){u.move(p,o);return L}}}return null};b.prototype.adjustPieceOfFurnitureInShelfBox=function(h,s){var o=h.getGroundElevation();var f=h.getPoints();var k=null;var r=0;var e=null;var C=null;var B=this.getSurroundingFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(h);var d=0;for(var m=0;m<B.length;m++){var z=B[m];if((z!=null&&z instanceof HomeShelfUnit)&&!z.isHorizontallyRotated()){var u=z;var v=u.getGroundElevation();var n=u.getShelfBoxes();for(var l=0;l<n.length;l++){var g=n[l];if(Math.abs(v+g.getZLower()*u.getHeight()-o)<0.1){var t=[new java.awt.geom.Point2D.Float(g.getXLower()*u.getWidth(),(1-g.getYUpper())*u.getDepth()),new java.awt.geom.Point2D.Float(g.getXUpper()*u.getWidth(),(1-g.getYUpper())*u.getDepth()),new java.awt.geom.Point2D.Float(g.getXUpper()*u.getWidth(),(1-g.getYLower())*u.getDepth()),new java.awt.geom.Point2D.Float(g.getXLower()*u.getWidth(),(1-g.getYLower())*u.getDepth())];var q=java.awt.geom.AffineTransform.getTranslateInstance(u.getX()-u.getWidth()/2,u.getY()-u.getDepth()/2);q.concatenate(java.awt.geom.AffineTransform.getRotateInstance(u.getAngle(),u.getWidth()/2,u.getDepth()/2));if(u.isModelMirrored()){q.concatenate(new java.awt.geom.AffineTransform(-1,0,0,1,u.getWidth(),0))}for(var x=0;x<t.length;x++){q.transform(t[x],t[x])}var w=new java.awt.geom.GeneralPath();w.moveTo(t[0].getX(),t[0].getY());w.lineTo(t[1].getX(),t[1].getY());w.lineTo(t[2].getX(),t[2].getY());w.lineTo(t[3].getX(),t[3].getY());w.closePath();var p=new java.awt.geom.Area(w);if(k==null){k=new java.awt.geom.Area(this.getPath$float_A_A(f))}p.intersect(k);if(!p.isEmpty()){if(d===0){d=this.getArea(k)}var A=d-this.getArea(p);e=u;if(Math.abs(A)>0.01&&A<d/4&&r<A){r=A;C=t}}}}}}if(s&&e!=null){h.setAngle(e.getAngle());f=h.getPoints()}if(C!=null){var c=0;for(var x=0;x<f.length;x++){if(java.awt.geom.Line2D.relativeCCW(C[0].getX(),C[0].getY(),C[3].getX(),C[3].getY(),f[x][0],f[x][1])===(e.isModelMirrored()?1:-1)){var j=java.awt.geom.Line2D.ptLineDistSq(C[0].getX(),C[0].getY(),C[3].getX(),C[3].getY(),f[x][0],f[x][1]);if(j>c){c=j}}}if(c>0){c=Math.sqrt(c)*(e.isModelMirrored()?-1:1);h.move(c*Math.cos(e.getAngle()),c*Math.sin(e.getAngle()))}else{for(var x=0;x<f.length;x++){if(java.awt.geom.Line2D.relativeCCW(C[1].getX(),C[1].getY(),C[2].getX(),C[2].getY(),f[x][0],f[x][1])===(e.isModelMirrored()?-1:1)){var j=java.awt.geom.Line2D.ptLineDistSq(C[1].getX(),C[1].getY(),C[2].getX(),C[2].getY(),f[x][0],f[x][1]);if(j>c){c=j}}}if(c>0){c=Math.sqrt(c)*(e.isModelMirrored()?1:-1);h.move(c*Math.cos(e.getAngle()),c*Math.sin(e.getAngle()))}}var y=0;for(var x=0;x<f.length;x++){if(java.awt.geom.Line2D.relativeCCW(C[0].getX(),C[0].getY(),C[1].getX(),C[1].getY(),f[x][0],f[x][1])===(e.isModelMirrored()?-1:1)){var j=java.awt.geom.Line2D.ptLineDistSq(C[0].getX(),C[0].getY(),C[1].getX(),C[1].getY(),f[x][0],f[x][1]);if(j>y){y=j}}}if(y>0){y=Math.sqrt(y);h.move(y*-Math.sin(e.getAngle()),y*Math.cos(e.getAngle()))}else{for(var x=0;x<f.length;x++){if(java.awt.geom.Line2D.relativeCCW(C[3].getX(),C[3].getY(),C[2].getX(),C[2].getY(),f[x][0],f[x][1])===(e.isModelMirrored()?1:-1)){var j=java.awt.geom.Line2D.ptLineDistSq(C[3].getX(),C[3].getY(),C[2].getX(),C[2].getY(),f[x][0],f[x][1]);if(j>y){y=j}}}if(y>0){y=-Math.sqrt(y);h.move(y*-Math.sin(e.getAngle()),y*Math.cos(e.getAngle()))}}return e}return null};b.prototype.isAreaLargerOnFrontOrBackSide=function(f,d){var e=new java.awt.geom.GeneralPath();e.moveTo(d[0][0],d[0][1]);e.lineTo(d[2][0],d[2][1]);e.lineTo(d[3][0],d[3][1]);e.lineTo(d[1][0],d[1][1]);e.closePath();var h=new java.awt.geom.Area(f);h.intersect(new java.awt.geom.Area(e));if(h.isEmpty()){return false}else{var g=new java.awt.geom.GeneralPath();g.moveTo(d[0][0],d[0][1]);g.lineTo(d[2][0],d[2][1]);g.lineTo(d[1][0],d[1][1]);g.lineTo(d[3][0],d[3][1]);g.closePath();var c=new java.awt.geom.Area(f);c.intersect(new java.awt.geom.Area(g));return this.getArea(h)>this.getArea(c)}};b.prototype.getArea=function(d){var c=this.getPathPoints(this.getPath$java_awt_geom_Area(d),false);if(c.length>1){return new Room(c).getArea()}else{return 0}};b.prototype.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float=function(f,e,d,c){var h=new java.awt.geom.Area(this.getRotatedRectangle(f.getX()-f.getWidthInPlan()/2+d,f.getY()-f.getDepthInPlan()/2+c,f.getWidthInPlan(),f.getDepth(),f.getAngle()));var g=0.01;h.intersect(new java.awt.geom.Area(this.getRotatedRectangle(e.getX()-e.getWidthInPlan()/2-g,e.getY()-e.getDepthInPlan()/2-g,e.getWidthInPlan()+2*g,e.getDepthInPlan()+2*g,e.getAngle())));return h.isEmpty()};b.prototype.isIntersectionEmpty=function(f,e,d,c){if(((f!=null&&f instanceof HomePieceOfFurniture)||f===null)&&((e!=null&&e instanceof HomePieceOfFurniture)||e===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture$float$float(f,e,d,c)}else{if(((f!=null&&f instanceof HomePieceOfFurniture)||f===null)&&((e!=null&&e instanceof Wall)||e===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)){return this.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float(f,e,d,c)}else{throw new Error("invalid overload")}}};b.prototype.isIntersectionEmpty$com_eteks_sweethome3d_model_HomePieceOfFurniture$com_eteks_sweethome3d_model_Wall$float$float=function(f,d,e,c){if(d!=null){var g=new java.awt.geom.Area(this.getPath$float_A_A(d.getPoints$()));g.intersect(new java.awt.geom.Area(this.getRotatedRectangle(f.getX()-f.getWidthInPlan()/2+e,f.getY()-f.getDepthInPlan()/2+c,f.getWidthInPlan(),f.getDepthInPlan(),f.getAngle())));return this.getArea(g)<0.0001}return true};b.prototype.getRotatedRectangle=function(d,k,h,c,j){var g=new java.awt.geom.Rectangle2D.Float(d,k,h,c);var f=java.awt.geom.AffineTransform.getRotateInstance(j,d+h/2,k+c/2);var e=new java.awt.geom.GeneralPath();e.append(g.getPathIterator(f),false);return e};b.prototype.getMeasuringDimensionLineAt=function(k,j,e){var d=this.getSelectionMargin();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var g=0;g<h.length;g++){var m=h[g];if(this.isPieceOfFurnitureVisibleAtSelectedLevel(m)){var l=this.getDimensionLineBetweenPointsAt(m.getPoints(),k,j,d,e);if(l!=null){return l}}}var h=this.getRoomPathsFromWalls();for(var g=0;g<h.length;g++){var f=h[g];if(f.intersects(k-d,j-d,2*d,2*d)){var l=this.getDimensionLineBetweenPointsAt(this.getPathPoints(f,true),k,j,d,e);if(l!=null){return l}}}var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();for(var g=0;g<h.length;g++){var c=h[g];if(this.isLevelNullOrViewable(c.getLevel())&&c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var l=this.getDimensionLineBetweenPointsAt(c.getPoints(),k,j,d,e);if(l!=null){return l}}}return null};b.prototype.getDimensionLineBetweenPointsAt=function(g,c,k,h,e){for(var f=0;f<g.length;f++){var d=(f+1)%g.length;var j=java.awt.geom.Point2D.distanceSq(g[f][0],g[f][1],g[d][0],g[d][1]);if(j>0.01&&java.awt.geom.Line2D.ptSegDistSq(g[f][0],g[f][1],g[d][0],g[d][1],c,k)<=h*h){return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(g[f],g[d],0,j,e)}}return null};b.prototype.getDimensionLineBetweenPoints$float_A$float_A$float$boolean=function(e,d,f,c){return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(e,d,f,java.awt.geom.Point2D.distanceSq(e[0],e[1],d[0],d[1]),c)};b.prototype.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean=function(l,k,f,o,g){var d=Math.atan2(l[1]-k[1],k[0]-l[0]);var h=d<=-Math.PI/2||d>Math.PI/2;var j;var n;var c;var m;if(h){j=k[0];n=k[1];c=l[0];m=l[1];f=-f}else{j=l[0];n=l[1];c=k[0];m=k[1]}if(g){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(Math.sqrt(o),this.getView().getPixelLength());if(h){c=k[0]-(e*Math.cos(d));m=k[1]+(e*Math.sin(d))}else{c=l[0]+(e*Math.cos(d));m=l[1]-(e*Math.sin(d))}}return new DimensionLine(j,n,c,m,f)};b.prototype.getDimensionLineBetweenPoints=function(e,d,g,f,c){if(((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||(typeof e[0]==="number")))||e===null)&&((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(typeof d[0]==="number")))||d===null)&&((typeof g==="number")||g===null)&&((typeof f==="number")||f===null)&&((typeof c==="boolean")||c===null)){return this.getDimensionLineBetweenPoints$float_A$float_A$float$double$boolean(e,d,g,f,c)}else{if(((e!=null&&e instanceof Array&&(e.length==0||e[0]==null||(typeof e[0]==="number")))||e===null)&&((d!=null&&d instanceof Array&&(d.length==0||d[0]==null||(typeof d[0]==="number")))||d===null)&&((typeof g==="number")||g===null)&&((typeof f==="boolean")||f===null)&&c===undefined){return this.getDimensionLineBetweenPoints$float_A$float_A$float$boolean(e,d,g,f)}else{throw new Error("invalid overload")}}};b.prototype.addLevel$=function(){this.addLevel$boolean(false)};b.prototype.addLevelAtSameElevation=function(){this.addLevel$boolean(true)};b.prototype.addLevel$boolean=function(o){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var c=f.slice(0);var n=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getBackgroundImage();var p=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();var r=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallHeight();var q=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewFloorThickness();var m;if((p.length==0)){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(b,"levelName",0);m=this.createLevel(d,0,q,r);this.moveHomeItemsToLevel(m);m.setBackgroundImage(g);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBackgroundImage(null);p=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels()}else{m=null}var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(b,"levelName",p.length);var e;if(o){var l=m!=null?m:this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();e=this.createLevel(h,l.getElevation(),l.getFloorThickness(),l.getHeight())}else{var k=p[p.length-1].getElevation()+r+q;e=this.createLevel(h,k,q,r)}this.setSelectedLevel(e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelAdditionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,j,n,m,g,e))};b.prototype.addLevel=function(c){if(((typeof c==="boolean")||c===null)){return this.addLevel$boolean(c)}else{if(c===undefined){return this.addLevel$()}else{throw new Error("invalid overload")}}};b.prototype.createLevel=function(e,f,g,d){var c=new Level(e,f,g,d);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLevel(c);return c};b.prototype.moveHomeItemsToLevel=function(d){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var e=0;e<f.length;e++){var l=f[e];l.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var e=0;e<f.length;e++){var j=f[e];j.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();for(var e=0;e<f.length;e++){var c=f[e];c.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();for(var e=0;e<f.length;e++){var h=f[e];h.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines();for(var e=0;e<f.length;e++){var k=f[e];k.setLevel(d)}var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels();for(var e=0;e<f.length;e++){var g=f[e];g.setLevel(d)}};b.prototype.toggleSelectedLevelViewability=function(){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();c.setViewable(!c.isViewable());this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c))};b.prototype.setSelectedLevelOnlyViewable=function(){var e=this.getLevels(true);var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var c=d.isViewable();if(e.length!==1||!c){b.setLevelsViewability(e,false);d.setViewable(true);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelsViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c,e))}};b.prototype.setAllLevelsViewable=function(){var c=this.getLevels(false);if(c.length>0){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();b.setLevelsViewability(c,true);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.AllLevelsViewabilityModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c))}};b.prototype.getLevels=function(c){var e=([]);var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();for(var d=0;d<g.length;d++){var f=g[d];if(f.isViewable()===c){(e.push(f)>0)}}return e.slice(0)};b.setLevelsViewability=function(e,c){for(var d=0;d<e.length;d++){var f=e[d];f.setViewable(c)}};b.prototype.modifySelectedLevel=function(){if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel()!=null){new LevelController(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,this.__com_eteks_sweethome3d_viewcontroller_PlanController_viewFactory,this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport).displayView(this.getView())}};b.prototype.deleteSelectedLevel=function(){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();var g=([]);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();for(var c=0;c<d.length;c++){var m=d[c];if(m.getLevel()===f){(g.push(m)>0)}}this.deleteFurniture(g);var h=([]);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls(),h);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms(),h);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines(),h);this.addLevelItemsAtSelectedLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels(),h);this.postDeleteItems(h,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());this.doDeleteItems(h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLevel(f);var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();var l;var k;var e;if(j.length===1){l=j[0];k=l.getElevation();e=l.isViewable();l.setElevation(0);l.setViewable(true)}else{l=null;k=null;e=false}this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LevelDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,f,l,k,e));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()};b.prototype.addLevelItemsAtSelectedLevel=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();for(var d=0;d<c.length;d++){var e=c[d];if((e!=null&&(e.constructor!=null&&e.constructor.__interfaces!=null&&e.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))&&e.getLevel()===f){(g.push(e)>0)}}};b.prototype.createWall=function(g,e,d,f,j,c){var h=new Wall(g,e,d,f,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallThickness(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallHeight(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallPattern());this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(h);if(j!=null){h.setWallAtStart(j);j.setWallAtStart(h)}else{if(c!=null){h.setWallAtStart(c);c.setWallAtEnd(h)}}return h};b.prototype.joinNewWallEndToWall=function(c,d,e){if(d!=null){c.setWallAtEnd(d);d.setWallAtStart(c);c.setXEnd(d.getXStart());c.setYEnd(d.getYStart())}else{if(e!=null){c.setWallAtEnd(e);e.setWallAtEnd(c);c.setXEnd(e.getXEnd());c.setYEnd(e.getYEnd())}}};b.prototype.getWallStartAt=function(d,j,f){var g=b.WALL_ENDS_PIXEL_MARGIN/this.getScale();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var e=0;e<h.length;e++){var c=h[e];if(c!==f&&this.isLevelNullOrViewable(c.getLevel())&&c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.getWallAtStart()==null&&c.containsWallStartAt(d,j,g)){return c}}return null};b.prototype.getWallEndAt=function(d,j,f){var g=b.WALL_ENDS_PIXEL_MARGIN/this.getScale();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var e=0;e<h.length;e++){var c=h[e];if(c!==f&&this.isLevelNullOrViewable(c.getLevel())&&c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.getWallAtEnd()==null&&c.containsWallEndAt(d,j,g)){return c}}return null};b.prototype.getIndicatorMargin=function(){var c=b.INDICATOR_PIXEL_MARGIN;if(this.getPointerTypeLastMousePress()===View.PointerType.TOUCH){c*=3}return c/this.getScale()};b.prototype.getResizedWallStartAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Wall)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsWallStartAt(d,g,e)){return c}}return null};b.prototype.getResizedWallEndAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Wall)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsWallEndAt(d,g,e)){return c}}return null};b.prototype.getArcExtentWallAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Wall)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.isMiddlePointAt(d,g,e)){return c}}return null};b.prototype.createRoom=function(c){var d=new Room(c);d.setFloorColor(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewRoomFloorColor());this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room(d);return d};b.prototype.computeRoomPointsAt=function(F,E){var c=this.getRoomPathsFromWalls();for(var z=0;z<c.length;z++){var g=c[z];if(g.contains(F,E)){var q=this.getVisibleDoorsAndWindowsAtGround(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture());for(var I=0;I<q.length;I++){var m=q[I];var e=m.getPoints();var N=0;for(var O=0;O<e.length;O++){if(g.contains(e[O][0],e[O][1])){N++}}if(e.length===4){var L=0.05;var j=null;if((m!=null&&m instanceof HomeDoorOrWindow)&&m.isWallCutOutOnBothSides()){var J=m;var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var D=new java.awt.geom.Area(this.getPath$float_A_A(e));var P=new java.awt.geom.Area();var p=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var G=0;G<p.length;G++){var f=p[G];if(f.isAtLevel(d)&&J.isParallelToWall(f)){var n=this.getPath$float_A_A(f.getPoints$());var o=new java.awt.geom.Area(n);o.intersect(D);if(!o.isEmpty()){var s=(function(y){if(y.clone!=undefined){return y.clone()}else{var S=Object.create(y);for(var x in y){if(y.hasOwnProperty(x)){S[x]=y[x]}}return S}})(J);s.setDepthInPlan(s.getDepth()+4*f.getThickness());o=new java.awt.geom.Area(n);o.intersect(new java.awt.geom.Area(this.getPath$float_A_A(s.getPoints())));P.add(o)}}}if(!P.isEmpty()&&P.isSingular()){var h=this.getPathPoints(this.getPath$java_awt_geom_Area(P),true);if(h.length===4){var w=J.getY()+J.getDepth()*(-0.5+J.getWallDistance()+J.getWallThickness()/2);var v=J.getWidth()/2;var r=[J.getX()-v,w,J.getX()+v,w];var u=java.awt.geom.AffineTransform.getRotateInstance(J.getAngle(),J.getX(),J.getY());u.transform(r,0,r,0,2);for(var O=0;O<h.length-1;O++){if(g.intersects(h[O][0]-L/2,h[O][1]-L/2,L,L)){var l=O;var C=void 0;var B=void 0;if(g.intersects(h[O+1][0]-L/2,h[O+1][1]-L/2,L,L)){B=(O+2)%4;C=(O+3)%4}else{if(g.intersects(h[(O+3)%4][0]-L/2,h[(O+3)%4][1]-L/2,L,L)){C=(O+1)%4;B=(O+2)%4}else{break}}if(java.awt.geom.Point2D.distanceSq(h[l][0],h[l][1],r[0],r[1])<java.awt.geom.Point2D.distanceSq(h[l][0],h[l][1],r[2],r[3])){h[C][0]=r[0];h[C][1]=r[1];h[B][0]=r[2];h[B][1]=r[3]}else{h[C][0]=r[2];h[C][1]=r[3];h[B][0]=r[0];h[B][1]=r[1]}j=h;break}}}}}if(j==null&&N===2){var P=new java.awt.geom.Area(this.getWallsArea(false));P.intersect(new java.awt.geom.Area(this.getPath$float_A_A(e)));var h=this.getPathPoints(this.getPath$java_awt_geom_Area(P),false);if(h.length===4){for(var O=0;O<h.length;O++){if(g.intersects(h[O][0]-L/2,h[O][1]-L/2,L,L)){var l=O;var k=void 0;var C=void 0;var B=void 0;if(g.intersects(h[O+1][0]-L/2,h[O+1][1]-L/2,L,L)){k=O+1;B=(O+2)%4;C=(O+3)%4}else{C=(O+1)%4;B=(O+2)%4;k=(O+3)%4}h[C][0]=(h[C][0]+h[l][0])/2;h[C][1]=(h[C][1]+h[l][1])/2;h[B][0]=(h[B][0]+h[k][0])/2;h[B][1]=(h[B][1]+h[k][1])/2;j=h;break}}}}if(j!=null){var K=this.getPath$float_A_A(j);var Q=K.getBounds2D();var t=java.awt.geom.AffineTransform.getTranslateInstance(Q.getCenterX(),Q.getCenterY());var R=Math.min(Q.getWidth(),Q.getHeight());var A=(R+L)/R;t.scale(A,A);t.translate(-Q.getCenterX(),-Q.getCenterY());var M=K.createTransformedShape(t);var H=new java.awt.geom.Area(M);H.add(new java.awt.geom.Area(g));g=this.getPath$java_awt_geom_Area(H)}}}return this.getPathPoints(g,false)}}return null};b.prototype.getVisibleDoorsAndWindowsAtGround=function(e){var f=([]);for(var c=0;c<e.length;c++){var d=e[c];if(this.isPieceOfFurnitureVisibleAtSelectedLevel(d)&&d.getElevation()===0){if(d!=null&&d instanceof HomeFurnitureGroup){(function(h,g){return h.push.apply(h,g)})(f,this.getVisibleDoorsAndWindowsAtGround(d.getFurniture()))}else{if(d.isDoorOrWindow()){(f.push(d)>0)}}}}return f};b.prototype.getResizedRoomAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemResizable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.getPointIndexAt(c,g,d)!==-1){return e}}return null};b.prototype.getRoomNameAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemMovable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.getName()!=null&&e.getName().trim().length>0&&e.isNameCenterPointAt(c,g,d)){return e}}return null};b.prototype.getRoomRotatedNameAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemMovable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.getName()!=null&&e.getName().trim().length>0&&this.isTextAnglePointAt(e,e.getName(),e.getNameStyle(),e.getXCenter()+e.getNameXOffset(),e.getYCenter()+e.getNameYOffset(),e.getNameAngle(),c,g,d)){return e}}return null};b.prototype.getRoomAreaAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Room)&&this.isItemMovable(f[0])){var e=f[0];var d=this.getIndicatorMargin();if(e.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&e.isAreaVisible()&&e.isAreaCenterPointAt(c,g,d)){return e}}return null};b.prototype.getRoomRotatedAreaAt=function(c,j){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(h.length===1&&(h[0]!=null&&h[0] instanceof Room)&&this.isItemMovable(h[0])){var g=h[0];var f=this.getIndicatorMargin();if(g.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&g.isAreaVisible()){var e=g.getArea();if(e>0.01){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(e);if(this.isTextAnglePointAt(g,d,g.getAreaStyle(),g.getXCenter()+g.getAreaXOffset(),g.getYCenter()+g.getAreaYOffset(),g.getAreaAngle(),c,j,f)){return g}}}}return null};b.prototype.isRoomPointDeletableAt=function(d,c,e){return this.isItemResizable(d)&&d.getPointIndexAt(c,e,this.getIndicatorMargin())>=0};b.prototype.deletePointFromSelectedRoom=function(j,h){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(d.length===1&&(d[0]!=null&&d[0] instanceof Room)&&this.isItemResizable(d[0])){var c=d[0];var f=c.getPointIndexAt(j,h,this.getIndicatorMargin());if(f>=0){var l=c.getPoints();var k=l[f];var e=k[0];var g=k[1];c.removePoint(f);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([c].slice(0));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomPointDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d.slice(0),c,f,e,g))}}};b.prototype.isRoomPointsComputableAt=function(e,c,f){if(this.isItemResizable(e)&&e.containsPoint(c,f,0)){var d=this.computeRoomPointsAt(c,f);return d!=null&&!(JSON.stringify(e.getPoints())===JSON.stringify(d))}return false};b.prototype.recomputeSelectedRoomPoints=function(c,h){var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(g.length===1&&(g[0]!=null&&g[0] instanceof Room)&&this.isItemResizable(g[0])){var f=g[0];var d=f.getPoints();var e=this.computeRoomPointsAt(c,h);if(e!=null){f.setPoints(e);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([f].slice(0));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomPointsModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,g.slice(0),f,d,e))}}};b.prototype.addPointToSelectedRoom=function(l,k){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(e.length===1&&(e[0]!=null&&e[0] instanceof Room)&&this.isItemResizable(e[0])){var c=e[0];var n=c.getPoints();var d=-1;var o=1.7976931348623157e+308;for(var f=0;f<n.length;f++){var m=n[f];var j=n[(f+1)%n.length];var g=java.awt.geom.Line2D.ptSegDistSq(m[0],m[1],j[0],j[1],l,k);if(o>g){o=g;d=f}}var h=d+1;c.addPoint$float$float$int(l,k,h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems([c].slice(0));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomPointAdditionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0),c,h,l,k))}};b.prototype.createDimensionLine$float$float$float$float$float=function(g,e,c,f,h){var d=new DimensionLine(g,e,c,f,h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(d);return d};b.prototype.createDimensionLine=function(f,d,c,e,g){if(((typeof f==="number")||f===null)&&((typeof d==="number")||d===null)&&((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&((typeof g==="number")||g===null)){return this.createDimensionLine$float$float$float$float$float(f,d,c,e,g)}else{if(((typeof f==="number")||f===null)&&((typeof d==="number")||d===null)&&c===undefined&&e===undefined&&g===undefined){return this.createDimensionLine$float$float(f,d)}else{throw new Error("invalid overload")}}};b.prototype.getResizedDimensionLineStartAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsStartExtensionLinetAt(d,g,e)){return c}}return null};b.prototype.getResizedDimensionLineEndAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.containsEndExtensionLineAt(d,g,e)){return c}}return null};b.prototype.getOffsetDimensionLineAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&(c.isMiddlePointAt(d,g,e)||c.isTopPointAt(d,g,e)&&!c.containsPoint(d,g,0))){return c}}return null};b.prototype.getPitchRotatedDimensionLineAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemMovable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.isElevationDimensionLine()&&c.isBottomPointAt(d,g,e)&&!c.containsPoint(d,g,0)){return c}}return null};b.prototype.getElevatedDimensionLineAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemMovable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.isLeftPointAt(d,g,e)&&!c.containsPoint(d,g,0)){return c}}return null};b.prototype.getHeightResizedDimensionLineAt=function(d,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof DimensionLine)&&this.isItemResizable(f[0])){var c=f[0];var e=this.getIndicatorMargin();if(c.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&c.isRightPointAt(d,g,e)&&!c.containsPoint(d,g,0)){return c}}return null};b.prototype.createPolyline=function(d){var e=new Polyline(d);var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();e.setThickness(c.isMetric()?2:LengthUnit.inchToCentimeter(1));this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline(e);return e};b.prototype.getResizedPolylineAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Polyline)&&this.isItemResizable(f[0])){var d=f[0];var e=this.getIndicatorMargin();if(d.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&d.getPointIndexAt(c,g,e)!==-1){return d}}return null};b.prototype.getSelectionMargin=function(){var c=b.PIXEL_MARGIN;if(this.getPointerTypeLastMousePress()===View.PointerType.TOUCH){c*=2}return c/this.getScale()};b.prototype.isItemSelectedAt=function(c,h){var f=this.getSelectionMargin();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var d=0;d<g.length;d++){var e=g[d];if(e.containsPoint(c,h,f)){return true}}return false};b.prototype.getSelectableItemAt$float$float=function(c,d){return this.getSelectableItemAt$float$float$boolean(c,d,true)};b.prototype.getSelectableItemAt$float$float$boolean=function(c,f,e){var d=this.getSelectableItemsAt$float$float$boolean$boolean(c,f,true,e);if(d.length!==0){return d[0]}else{return null}};b.prototype.getSelectableItemAt=function(c,e,d){if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&((typeof d==="boolean")||d===null)){return this.getSelectableItemAt$float$float$boolean(c,e,d)}else{if(((typeof c==="number")||c===null)&&((typeof e==="number")||e===null)&&d===undefined){return this.getSelectableItemAt$float$float(c,e)}else{throw new Error("invalid overload")}}};b.prototype.getSelectableItemsAt$float$float=function(c,d){return this.getSelectableItemsAt$float$float$boolean$boolean(c,d,false,true)};b.prototype.getSelectableItemsAt$float$float$boolean$boolean=function(t,r,k,e){var z=([]);var w=this.getSelectionMargin();var L=w/2;var D=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera();if(D!=null&&D===this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getCamera()&&D.containsPoint(t,r,w)){(z.push(D)>0);if(k){return z}}var J=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var I=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLabels();for(var m=0;m<o.length;m++){var p=o[m];if((!J||!this.isItemPartOfBasePlan(p))&&this.isLevelNullOrViewable(p.getLevel())&&p.isAtLevel(I)&&(p.containsPoint(t,r,w)||this.isItemTextAt(p,p.getText(),p.getStyle(),p.getX(),p.getY(),p.getAngle(),t,r,L))){(z.push(p)>0);if(k){return z}}}var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getDimensionLines();for(var m=0;m<o.length;m++){var l=o[m];if((!J||!this.isItemPartOfBasePlan(l))&&this.isLevelNullOrViewable(l.getLevel())&&l.isAtLevel(I)&&l.containsPoint(t,r,w)){(z.push(l)>0);if(k){return z}}}var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();for(var C=j.length-1;C>=0;C--){var B=j[C];if((!J||!this.isItemPartOfBasePlan(B))&&this.isLevelNullOrViewable(B.getLevel())&&B.isAtLevel(I)&&B.containsPoint(t,r,w)){(z.push(B)>0);if(k){return z}}}var v=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();var A=([]);var f=null;for(var C=v.length-1;C>=0;C--){var g=v[C];if((!J||!this.isItemPartOfBasePlan(g))&&this.isPieceOfFurnitureVisibleAtSelectedLevel(g)){if(g.containsPoint(t,r,w)){(A.push(g)>0);if(f==null||g.getGroundElevation()>f.getGroundElevation()){f=g}}else{if(f==null){var q=g.getName();if(q!=null&&g.isNameVisible()&&this.isItemTextAt(g,q,g.getNameStyle(),g.getX()+g.getNameXOffset(),g.getY()+g.getNameYOffset(),g.getNameAngle(),t,r,L)){(A.push(g)>0);f=g}}}}}if(f==null&&J){var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var m=0;m<o.length;m++){var G=o[m];if(G!=null&&G instanceof HomePieceOfFurniture){var g=G;if(!this.isItemPartOfBasePlan(g)&&this.isPieceOfFurnitureVisibleAtSelectedLevel(g)&&(g.containsPoint(t,r,w)||g.getName()!=null&&g.isNameVisible()&&this.isItemTextAt(g,g.getName(),g.getNameStyle(),g.getX()+g.getNameXOffset(),g.getY()+g.getNameYOffset(),g.getNameAngle(),t,r,L))){(A.push(g)>0);f=g;if(k){break}}}}}if(f!=null&&k){if(!e&&(f!=null&&f instanceof HomeFurnitureGroup)){var s=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(s.length>=1){if((s.length===1&&s[0]===f)||(function(x,M){for(var y=0;y<M.length;y++){if(x.indexOf(M[y])<0){return false}}return true})(f.getAllFurniture(),s)){for(var m=0;m<s.length;m++){var d=s[m];if(d!=null&&d instanceof HomeFurnitureGroup){var n=d.getFurniture();for(var C=n.length-1;C>=0;C--){var g=n[C];if((!J||!this.isItemPartOfBasePlan(g))&&!(s.indexOf((g))>=0)&&g.containsPoint(t,r,w)){return[g].slice(0)}}}}for(var m=0;m<s.length;m++){var d=s[m];if(d!=null&&d instanceof HomePieceOfFurniture){var n=this.getFurnitureInSameGroup(d);for(var C=n.length-1;C>=0;C--){var g=n[C];if((!J||!this.isItemPartOfBasePlan(g))&&g.containsPoint(t,r,w)){return[g].slice(0)}}}}}}}return[f].slice(0)}else{(function(x,y){if(y.compare){x.sort(function(N,M){return y.compare(N,M)})}else{x.sort(y)}})(A,new b.PlanController$7(this));(function(y,x){return y.push.apply(y,x)})(z,A);var o=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var m=0;m<o.length;m++){var F=o[m];if((!J||!this.isItemPartOfBasePlan(F))&&this.isLevelNullOrViewable(F.getLevel())&&F.isAtLevel(I)&&F.containsPoint$float$float$float(t,r,w)){(z.push(F)>0);if(k){return z}}}var K=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();var h=null;for(var C=K.length-1;C>=0;C--){var E=K[C];if((!J||!this.isItemPartOfBasePlan(E))&&this.isLevelNullOrViewable(E.getLevel())&&E.isAtLevel(I)){if(E.containsPoint(t,r,w)){(z.push(E)>0);if(h==null||E.isCeilingVisible()&&!h.isCeilingVisible()){h=E}}else{var H=E.getName();if(H!=null&&this.isItemTextAt(E,H,E.getNameStyle(),E.getXCenter()+E.getNameXOffset(),E.getYCenter()+E.getNameYOffset(),E.getNameAngle(),t,r,L)){(z.push(E)>0);h=E}if(E.isAreaVisible()){var u=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getAreaFormatWithUnit().format(E.getArea());if(this.isItemTextAt(E,u,E.getAreaStyle(),E.getXCenter()+E.getAreaXOffset(),E.getYCenter()+E.getAreaYOffset(),E.getAreaAngle(),t,r,L)){(z.push(E)>0);h=E}}}}}if(h!=null&&k){return[h].slice(0)}else{var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getCompass();if((!J||!this.isItemPartOfBasePlan(c))&&c.containsPoint(t,r,L)){(z.push(c)>0)}return z}}};b.prototype.getSelectableItemsAt=function(c,f,d,e){if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&((typeof d==="boolean")||d===null)&&((typeof e==="boolean")||e===null)){return this.getSelectableItemsAt$float$float$boolean$boolean(c,f,d,e)}else{if(((typeof c==="number")||c===null)&&((typeof f==="number")||f===null)&&d===undefined&&e===undefined){return this.getSelectableItemsAt$float$float(c,f)}else{throw new Error("invalid overload")}}};b.prototype.isItemTextAt=function(m,l,d,j,f,h,g,e,c){if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(m.constructor)}var k=this.getView().getTextBounds(l,d,j,f,h);return this.getPath$float_A_A(k).intersects(g-c,e-c,2*c,2*c)};b.prototype.getSelectableItemsIntersectingRectangle=function(d,l,c,k){var j=([]);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var h=this.getVisibleItemsAtSelectedLevel();for(var f=0;f<h.length;f++){var m=h[f];if((!e||!this.isItemPartOfBasePlan(m))&&m.intersectsRectangle(d,l,c,k)){(j.push(m)>0)}}var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getObserverCamera();if(g!=null&&g.intersectsRectangle(d,l,c,k)){(j.push(g)>0)}return j};b.prototype.getRotatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isTopLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getElevatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isTopRightPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getHeightResizedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedResizablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(!d.isHorizontallyRotated()&&d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getPitchRotatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null&&this.getView().isFurnitureSizeInPlanSupported()){var e=this.getIndicatorMargin();if(d.getPitch()!==0&&d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getRollRotatedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null&&this.getView().isFurnitureSizeInPlanSupported()){var e=this.getIndicatorMargin();if(d.getRoll()!==0&&d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getWidthAndDepthResizedPieceOfFurnitureAt=function(c,f){var d=this.getSelectedResizablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isBottomRightPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getSelectedMovablePieceOfFurniture=function(){var c=this.getSelectedPieceOfFurniture();if(c!=null&&this.isItemMovable(c)){return c}return null};b.prototype.getSelectedResizablePieceOfFurniture=function(){var c=this.getSelectedPieceOfFurniture();if(c!=null&&c.isResizable()&&this.isItemResizable(c)){return c}return null};b.prototype.getSelectedPieceOfFurniture=function(){var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(d.length===1&&(d[0]!=null&&d[0] instanceof HomePieceOfFurniture)){var c=d[0];if(this.isPieceOfFurnitureVisibleAtSelectedLevel(c)){return c}}return null};b.prototype.getModifiedLightPowerAt=function(c,f){var d=this.getSelectedPieceOfFurniture();if(d!=null&&d instanceof HomeLight){var e=this.getIndicatorMargin();if(d.isBottomLeftPointAt(c,f,e)&&!d.containsPoint(c,f,0)){return d}}return null};b.prototype.getPieceOfFurnitureNameAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isNameVisible()&&d.getName().trim().length>0&&d.isNameCenterPointAt(c,f,e)){return d}}return null};b.prototype.getPieceOfFurnitureRotatedNameAt=function(c,f){var d=this.getSelectedMovablePieceOfFurniture();if(d!=null){var e=this.getIndicatorMargin();if(d.isNameVisible()&&d.getName().trim().length>0&&this.isTextAnglePointAt(d,d.getName(),d.getNameStyle(),d.getX()+d.getNameXOffset(),d.getY()+d.getNameYOffset(),d.getNameAngle(),c,f,e)){return d}}return null};b.prototype.isTextAnglePointAt=function(o,m,d,j,f,h,g,e,c){if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(o.constructor)}var k=this.getView().getTextBounds(m,d,j,f,h);var n;var l;if(d.getAlignment()===TextStyle.Alignment.LEFT){n=k[0][0];l=k[0][1]}else{if(d.getAlignment()===TextStyle.Alignment.RIGHT){n=k[1][0];l=k[1][1]}else{n=(k[0][0]+k[1][0])/2;l=(k[0][1]+k[1][1])/2}}return Math.abs(g-n)<=c&&Math.abs(e-l)<=c};b.prototype.getRotatedLabelAt=function(c,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Label)&&this.isItemMovable(f[0])){var d=f[0];var e=this.getIndicatorMargin();if(d.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&this.isTextAnglePointAt(d,d.getText(),d.getStyle(),d.getX(),d.getY(),d.getAngle(),c,g,e)){return d}}return null};b.prototype.getElevatedLabelAt=function(j,g){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(f.length===1&&(f[0]!=null&&f[0] instanceof Label)){var h=f[0];if(h.getPitch()!=null&&this.isItemMovable(h)){var e=this.getIndicatorMargin();if(h.isAtLevel(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var d=h.getStyle();if(d==null){d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getDefaultTextStyle(h.constructor)}var k=this.getView().getTextBounds(h.getText(),this.getItemTextStyle(h,h.getStyle()),h.getX(),h.getY(),h.getAngle());var c=void 0;var l=void 0;if(d.getAlignment()===TextStyle.Alignment.LEFT){c=k[3][0];l=k[3][1]}else{if(d.getAlignment()===TextStyle.Alignment.RIGHT){c=k[2][0];l=k[2][1]}else{c=(k[2][0]+k[3][0])/2;l=(k[2][1]+k[3][1])/2}}if(Math.abs(j-c)<=e&&Math.abs(g-l)<=e){return h}}}}return null};b.prototype.getYawRotatedCameraAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Camera)&&this.isItemResizable(j[0])){var d=j[0];var f=this.getIndicatorMargin();var e=d.getPoints();var h=(e[0][0]+e[3][0])/2;var g=(e[0][1]+e[3][1])/2;if(Math.abs(c-h)<=f&&Math.abs(k-g)<=f&&!d.containsPoint(c,k,0)){return d}}return null};b.prototype.getPitchRotatedCameraAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Camera)&&this.isItemResizable(j[0])){var d=j[0];var f=this.getIndicatorMargin();var e=d.getPoints();var h=(e[1][0]+e[2][0])/2;var g=(e[1][1]+e[2][1])/2;if(Math.abs(c-h)<=f&&Math.abs(k-g)<=f&&!d.containsPoint(c,k,0)){return d}}return null};b.prototype.getElevatedCameraAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Camera)&&this.isItemResizable(j[0])){var e=j[0];var h=this.getIndicatorMargin();var f=e.getPoints();var d=(f[0][0]+f[1][0])/2;var g=(f[0][1]+f[1][1])/2;if(Math.abs(c-d)<=h&&Math.abs(k-g)<=h&&!e.containsPoint(c,k,0)){return e}}return null};b.prototype.getRotatedCompassAt=function(c,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Compass)&&this.isItemMovable(j[0])){var f=j[0];var g=this.getIndicatorMargin();var e=f.getPoints();var h=(e[2][0]+e[3][0])/2;var d=(e[2][1]+e[3][1])/2;if(Math.abs(c-h)<=g&&Math.abs(k-d)<=g&&!f.containsPoint(c,k,0)){return f}}return null};b.prototype.getResizedCompassAt=function(d,k){var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();if(j.length===1&&(j[0]!=null&&j[0] instanceof Compass)&&this.isItemMovable(j[0])){var g=j[0];var h=this.getIndicatorMargin();var e=g.getPoints();var f=(e[1][0]+e[2][0])/2;var c=(e[1][1]+e[2][1])/2;if(Math.abs(d-f)<=h&&Math.abs(k-c)<=h&&!g.containsPoint(d,k,0)){return g}}return null};b.prototype.deleteItems=function(c){var f=([]);for(var d=0;d<c.length;d++){var g=c[d];if(this.isItemDeletable(g)){(f.push(g)>0)}}if(!(f.length==0)){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var j=(c.slice(0));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsDeletionStartUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,e,j.slice(0)));this.deleteFurniture(Home.getFurnitureSubList(f));var h=(Home.getWallsSubList(f).slice(0));(function(l,k){return l.push.apply(l,k)})(h,Home.getRoomsSubList(f));(function(l,k){return l.push.apply(l,k)})(h,Home.getDimensionLinesSubList(f));(function(l,k){return l.push.apply(l,k)})(h,Home.getPolylinesSubList(f));(function(l,k){return l.push.apply(l,k)})(h,Home.getLabelsSubList(f));this.postDeleteItems(h,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());this.doDeleteItems(h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsDeletionEndUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()}};b.prototype.postDeleteItems=function(m,C,q){var w=Home.getWallsSubList(m);var r=b.JoinedWall.getJoinedWalls(w);var v=Home.getRoomsSubList(m);var F=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();var e=({});for(var h=0;h<v.length;h++){var z=v[h];(function(G,I,H){if(G.entries==null){G.entries=[]}for(var J=0;J<G.entries.length;J++){if(G.entries[J].key.equals!=null&&G.entries[J].key.equals(I)||G.entries[J].key===I){var K=G.entries[J].value;G.entries[J].value=H;return K}}G.entries.push({key:I,value:H,getKey:function(){return this.key},getValue:function(){return this.value}});G.entries.sort(function(M,L){return(M.key.compareTo!=null)?M.key.compareTo(L):(M.key-L.key)});return null})(e,F.indexOf(z),z)}var D=(function(H,G){if(H.length>=G.length){H.length=0;H.push.apply(H,G);return H}else{return G.slice(0)}})((function(H){var G=[];while(H-->0){G.push(null)}return G})((function(G){if(G.entries==null){G.entries=[]}return G.entries.length})(e)),(function(G){var H=[];if(G.entries==null){G.entries=[]}for(var I=0;I<G.entries.length;I++){H.push(G.entries[I].value)}return H})(e));var B=(function(H){var G=[];while(H-->0){G.push(0)}return G})(D.length);var k=(function(H){var G=[];while(H-->0){G.push(null)}return G})(D.length);var x=0;var j=(function(G){var H=[];if(G.entries==null){G.entries=[]}for(var I=0;I<G.entries.length;I++){H.push(G.entries[I].key)}return H})(e);for(var p=0;p<j.length;p++){var h=j[p];B[x]=h;k[x]=D[x].getLevel();x++}var o=Home.getDimensionLinesSubList(m);var l=o.slice(0);var n=(function(H){var G=[];while(H-->0){G.push(null)}return G})(l.length);for(x=0;x<l.length;x++){n[x]=l[x].getLevel()}var t=Home.getPolylinesSubList(m);var d=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();var y=({});for(var h=0;h<t.length;h++){var s=t[h];(function(G,I,H){if(G.entries==null){G.entries=[]}for(var J=0;J<G.entries.length;J++){if(G.entries[J].key.equals!=null&&G.entries[J].key.equals(I)||G.entries[J].key===I){var K=G.entries[J].value;G.entries[J].value=H;return K}}G.entries.push({key:I,value:H,getKey:function(){return this.key},getValue:function(){return this.value}});G.entries.sort(function(M,L){return(M.key.compareTo!=null)?M.key.compareTo(L):(M.key-L.key)});return null})(y,d.indexOf(s),s)}var g=(function(H,G){if(H.length>=G.length){H.length=0;H.push.apply(H,G);return H}else{return G.slice(0)}})((function(H){var G=[];while(H-->0){G.push(null)}return G})((function(G){if(G.entries==null){G.entries=[]}return G.entries.length})(y)),(function(G){var H=[];if(G.entries==null){G.entries=[]}for(var I=0;I<G.entries.length;I++){H.push(G.entries[I].value)}return H})(y));var c=(function(H){var G=[];while(H-->0){G.push(0)}return G})(g.length);var E=(function(H){var G=[];while(H-->0){G.push(null)}return G})(g.length);x=0;var j=(function(G){var I=[];if(G.entries==null){G.entries=[]}for(var H=0;H<G.entries.length;H++){I.push(G.entries[H].key)}return I})(y);for(var p=0;p<j.length;p++){var h=j[p];c[x]=h;E[x]=g[x].getLevel();x++}var u=Home.getLabelsSubList(m);var A=u.slice(0);var f=(function(H){var G=[];while(H-->0){G.push(null)}return G})(A.length);for(x=0;x<A.length;x++){f[x]=A[x].getLevel()}this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsDeletionUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,C,q,m.slice(0),r,D,B,k,l,n,g,c,E,A,f))};b.prototype.doDeleteItems=function(d){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();for(var e=0;e<d.length;e++){var f=d[e];if(f!=null&&f instanceof Wall){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(f)}else{if(f!=null&&f instanceof DimensionLine){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(f)}else{if(f!=null&&f instanceof Room){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(f)}else{if(f!=null&&f instanceof Polyline){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(f)}else{if(f!=null&&f instanceof Label){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLabel(f)}else{if(f!=null&&f instanceof HomePieceOfFurniture){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePieceOfFurniture(f)}}}}}}c=!this.isItemPartOfBasePlan(f)&&c}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(false)};b.prototype.moveAndShowSelectedItems=function(d,c){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();var g=([]);for(var e=0;e<h.length;e++){var f=h[e];if(this.isItemMovable(f)){(g.push(f)>0)}}if(!(g.length==0)){this.moveItems(g,d,c);this.selectAndShowItems$java_util_List$boolean(g,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection());if(g.length!==1||!(g[0]!=null&&g[0] instanceof Camera)){this.postItemsMove(g,h,d,c)}}};b.prototype.moveItems=function(f,e,d){for(var g=0;g<f.length;g++){var j=f[g];if(j!=null&&j instanceof Wall){var c=j;c.removePropertyChangeListener(this.wallChangeListener);b.moveWallStartPoint(c,c.getXStart()+e,c.getYStart()+d,!(f.indexOf((c.getWallAtStart()))>=0));b.moveWallEndPoint(c,c.getXEnd()+e,c.getYEnd()+d,!(f.indexOf((c.getWallAtEnd()))>=0));this.resetAreaCache();c.addPropertyChangeListener(this.wallChangeListener)}else{var h=false;if(j!=null&&j instanceof HomeDoorOrWindow){h=j.isBoundToWall()}j.move(e,d);if(h){var k=new java.awt.geom.Area(this.getPath$float_A_A(j.getPoints()));k.intersect(this.getWallsArea(true));j.setBoundToWall(!k.isEmpty())}}}};b.moveWallStartPoint=function(c,j,h,d){var g=c.getXStart();var f=c.getYStart();c.setXStart(j);c.setYStart(h);var e=c.getWallAtStart();if(e!=null&&d){if(e.getWallAtStart()===c&&(e.getWallAtEnd()!==c||(e.getXStart()===g&&e.getYStart()===f))){e.setXStart(j);e.setYStart(h)}else{if(e.getWallAtEnd()===c&&(e.getWallAtStart()!==c||(e.getXEnd()===g&&e.getYEnd()===f))){e.setXEnd(j);e.setYEnd(h)}}}};b.moveWallEndPoint=function(d,c,g,f){var e=d.getXEnd();var j=d.getYEnd();d.setXEnd(c);d.setYEnd(g);var h=d.getWallAtEnd();if(h!=null&&f){if(h.getWallAtStart()===d&&(h.getWallAtEnd()!==d||(h.getXStart()===e&&h.getYStart()===j))){h.setXStart(c);h.setYStart(g)}else{if(h.getWallAtEnd()===d&&(h.getWallAtStart()!==d||(h.getXEnd()===e&&h.getYEnd()===j))){h.setXEnd(c);h.setYEnd(g)}}}};b.moveWallPoint=function(d,c,f,e){if(e){b.moveWallStartPoint(d,c,f,true)}else{b.moveWallEndPoint(d,c,f,true)}};b.moveRoomPoint=function(e,c,f,d){e.setPoint(c,f,d)};b.moveDimensionLinePoint=function(d,c,f,e){if(e){d.setXStart(c);d.setYStart(f)}else{d.setXEnd(c);d.setYEnd(f)}};b.reverseDimensionLine=function(c){var e=c.getXStart();var d=c.getYStart();c.setXStart(c.getXEnd());c.setYStart(c.getYEnd());c.setXEnd(e);c.setYEnd(d);c.setOffset(-c.getOffset())};b.prototype.selectAndShowItems$java_util_List=function(c){this.selectAndShowItems$java_util_List$boolean(c,false)};b.prototype.selectAndShowItems$java_util_List$boolean=function(c,d){this.selectItems$java_util_List$boolean(c,d);this.selectLevelFromSelectedItems();this.getView().makeSelectionVisible()};b.prototype.selectAndShowItems=function(c,d){if(((c!=null&&(c instanceof Array))||c===null)&&((typeof d==="boolean")||d===null)){return this.selectAndShowItems$java_util_List$boolean(c,d)}else{if(((c!=null&&(c instanceof Array))||c===null)&&d===undefined){return this.selectAndShowItems$java_util_List(c)}else{throw new Error("invalid overload")}}};b.prototype.selectItems$java_util_List=function(c){this.selectItems$java_util_List$boolean(c,false)};b.prototype.selectItems$java_util_List$boolean=function(c,d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(d)};b.prototype.selectItems=function(c,d){if(((c!=null&&(c instanceof Array))||c===null)&&((typeof d==="boolean")||d===null)){return this.selectItems$java_util_List$boolean(c,d)}else{if(((c!=null&&(c instanceof Array))||c===null)&&d===undefined){return this.selectItems$java_util_List(c)}else{throw new Error("invalid overload")}}};b.prototype.selectItem=function(c){this.selectItems$java_util_List([c].slice(0))};b.prototype.toggleItemSelection=function(c){var d=(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0));if((d.indexOf((c))>=0)){(function(e){var f=e.indexOf(c);if(f>=0){e.splice(f,1);return true}else{return false}})(d)}else{(d.push(c)>0)}this.selectItems$java_util_List$boolean(d,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.deselectAll=function(){var c=[];this.selectItems$java_util_List(c)};b.prototype.addItems=function(c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();this.addFurniture$java_util_List(Home.getFurnitureSubList(c));this.addWalls(Home.getWallsSubList(c));this.addRooms(Home.getRoomsSubList(c));this.addPolylines(Home.getPolylinesSubList(c));this.addDimensionLines(Home.getDimensionLinesSubList(c));this.addLabels(Home.getLabelsSubList(c));this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setSelectedItems(c);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsAdditionEndUndoableEdit(this.__com_eteks_sweethome3d_viewcontroller_PlanController_home,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c.slice(0)));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate()};b.prototype.addFurniture=function(e,c,f,d){if(((e!=null&&(e instanceof Array))||e===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(c[0]!=null&&c[0] instanceof Level)))||c===null)&&((f!=null&&f instanceof HomeFurnitureGroup)||f===null)&&((d!=null&&d instanceof HomePieceOfFurniture)||d===null)){a.prototype.addFurniture.call(this,e,c,f,d)}else{if(((e!=null&&(e instanceof Array))||e===null)&&((c!=null&&c instanceof HomePieceOfFurniture)||c===null)&&f===undefined&&d===undefined){return this.addFurniture$java_util_List$com_eteks_sweethome3d_model_HomePieceOfFurniture(e,c)}else{if(((e!=null&&(e instanceof Array))||e===null)&&c===undefined&&f===undefined&&d===undefined){return this.addFurniture$java_util_List(e)}else{throw new Error("invalid overload")}}}};b.prototype.addFurniture$java_util_List=function(g){a.prototype.addFurniture$java_util_List.call(this,g);if(this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()){var e=this.getWallsArea(false);for(var d=0;d<g.length;d++){var f=g[d];if(f!=null&&f instanceof HomeDoorOrWindow){var c=f.getPoints();var h=new java.awt.geom.Area(this.getPath$float_A_A(c));h.intersect(e);if(!h.isEmpty()&&new Room(c).getArea()/this.getArea(h)>0.999){f.setBoundToWall(true)}}}}};b.prototype.addWalls=function(e){for(var d=0;d<e.length;d++){var c=e[d];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(c)}this.postCreateWalls(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateWalls=function(g,e,m,j){if(g.length>0){var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(f){for(var h=0;h<g.length;h++){var k=g[h];f=!this.isItemPartOfBasePlan(k)&&f}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(f)}var d=f;var l=b.JoinedWall.getJoinedWalls(g);var c=e.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,m,j,l,d))}};b.prototype.doAddWalls=function(j,d){for(var e=0;e<j.length;e++){var f=j[e];var c=f.getWall();this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(c);c.setLevel(f.getLevel())}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(d);for(var e=0;e<j.length;e++){var f=j[e];var c=f.getWall();var g=f.getWallAtStart();if(g!=null){c.setWallAtStart(g);if(f.isJoinedAtEndOfWallAtStart()){g.setWallAtEnd(c)}else{g.setWallAtStart(c)}}var h=f.getWallAtEnd();if(h!=null){c.setWallAtEnd(h);if(f.isJoinedAtStartOfWallAtEnd()){h.setWallAtStart(c)}else{h.setWallAtEnd(c)}}}};b.prototype.doDeleteWalls=function(d,c){for(var e=0;e<d.length;e++){var f=d[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(f.getWall())}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.addRooms=function(f){var g=f.slice(0);var c=(function(j){var h=[];while(j-->0){h.push(0)}return h})(f.length);var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms().length;for(var d=0;d<c.length;d++){c[d]=e++;this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room$int(g[d],c[d])}this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(g,c,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean=function(l,k,g,n,m){if(l.length>0){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(h){for(var j=0;j<l.length;j++){var e=l[j];h=!this.isItemPartOfBasePlan(e)&&h}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(h)}var d=h;var c=g.slice(0);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,m,l,k,f,d))}};b.prototype.postCreateRooms=function(g,c,f,d,e){if(((g!=null&&g instanceof Array&&(g.length==0||g[0]==null||(g[0]!=null&&g[0] instanceof Room)))||g===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)&&((f!=null&&(f instanceof Array))||f===null)&&((typeof d==="boolean")||d===null)&&((typeof e==="boolean")||e===null)){return this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(g,c,f,d,e)}else{if(((g!=null&&(g instanceof Array))||g===null)&&((c!=null&&(c instanceof Array))||c===null)&&((typeof f==="boolean")||f===null)&&((typeof d==="boolean")||d===null)&&e===undefined){return this.postCreateRooms$java_util_List$java_util_List$boolean$boolean(g,c,f,d)}else{throw new Error("invalid overload")}}};b.prototype.postCreateRooms$java_util_List$java_util_List$boolean$boolean=function(j,e,d,h){var k=j.slice(0);var f=(function(m){var l=[];while(m-->0){l.push(0)}return l})(j.length);var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getRooms();for(var g=0;g<f.length;g++){f[g]=c.lastIndexOf(k[g])}this.postCreateRooms$com_eteks_sweethome3d_model_Room_A$int_A$java_util_List$boolean$boolean(k,f,e,d,h)};b.prototype.doAddRooms=function(g,f,d,h,c){for(var e=0;e<f.length;e++){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room$int(g[e],f[e]);g[e].setLevel(d!=null?d[e]:h)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.doDeleteRooms=function(f,c){for(var d=0;d<f.length;d++){var e=f[d];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(e)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.addDimensionLines=function(d){for(var e=0;e<d.length;e++){var c=d[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(c)}this.postCreateDimensionLines(d,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateDimensionLines=function(e,g,n,k){if(e.length>0){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(h){for(var j=0;j<e.length;j++){var l=e[j];h=!this.isItemPartOfBasePlan(l)&&h}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(h)}var d=h;var f=e.slice(0);var c=g.slice(0);var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLinesCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,k,f,m,d))}};b.prototype.doAddDimensionLines=function(e,h,g,d){for(var f=0;f<e.length;f++){var c=e[f];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(c);c.setLevel(h!=null?h[f]:g)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(d)};b.prototype.doDeleteDimensionLines=function(e,d){for(var f=0;f<e.length;f++){var c=e[f];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(c)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(d)};b.prototype.addPolylines=function(d){var g=d.slice(0);var e=(function(j){var h=[];while(j-->0){h.push(0)}return h})(d.length);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines().length;for(var c=0;c<e.length;c++){e[c]=f++;this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline$int(g[c],e[c])}this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(g,e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean=function(e,g,f,n,k){if(e.length>0){var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(h){for(var j=0;j<e.length;j++){var l=e[j];h=!this.isItemPartOfBasePlan(l)&&h}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(h)}var d=h;var c=f.slice(0);var m=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PolylinesCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,k,e,g,m,d))}};b.prototype.postCreatePolylines=function(g,c,f,d,e){if(((g!=null&&g instanceof Array&&(g.length==0||g[0]==null||(g[0]!=null&&g[0] instanceof Polyline)))||g===null)&&((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||(typeof c[0]==="number")))||c===null)&&((f!=null&&(f instanceof Array))||f===null)&&((typeof d==="boolean")||d===null)&&((typeof e==="boolean")||e===null)){return this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(g,c,f,d,e)}else{if(((g!=null&&(g instanceof Array))||g===null)&&((c!=null&&(c instanceof Array))||c===null)&&((typeof f==="boolean")||f===null)&&((typeof d==="boolean")||d===null)&&e===undefined){return this.postCreatePolylines$java_util_List$java_util_List$boolean$boolean(g,c,f,d)}else{throw new Error("invalid overload")}}};b.prototype.postCreatePolylines$java_util_List$java_util_List$boolean$boolean=function(h,e,d,g){var k=h.slice(0);var j=(function(m){var l=[];while(m-->0){l.push(0)}return l})(h.length);var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines();for(var f=0;f<j.length;f++){j[f]=c.lastIndexOf(k[f])}this.postCreatePolylines$com_eteks_sweethome3d_model_Polyline_A$int_A$java_util_List$boolean$boolean(k,j,e,d,g)};b.prototype.doAddPolylines=function(g,h,d,f,c){for(var e=0;e<h.length;e++){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline$int(g[e],h[e]);g[e].setLevel(d!=null?d[e]:f)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.doDeletePolylines=function(f,c){for(var e=0;e<f.length;e++){var d=f[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(d)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.addLabels=function(e){for(var d=0;d<e.length;d++){var c=e[d];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(c)}this.postCreateLabels(e,this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked(),this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())};b.prototype.postCreateLabels=function(k,e,n,l){if(k.length>0){var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();if(g){for(var h=0;h<k.length;h++){var m=k[h];g=!this.isItemPartOfBasePlan(m)&&g}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(g)}var d=g;var f=k.slice(0);var c=e.slice(0);var j=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LabelsCreationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,n,l,f,j,d))}};b.prototype.doAddLabels=function(h,d,f,c){for(var g=0;g<h.length;g++){var e=h[g];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(e);e.setLevel(d!=null?d[g]:f)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.doDeleteLabels=function(f,c){for(var e=0;e<f.length;e++){var d=f[e];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteLabel(d)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setBasePlanLocked(c)};b.prototype.postLabelRotation=function(c,d){var e=c.getAngle();if(e!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LabelRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c,e))}};b.prototype.postLabelElevation=function(d,e){var c=d.getElevation();if(c!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LabelElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,c))}};b.prototype.postItemsMove=function(j,h,e,d){if(e!==0||d!==0){var g=j.slice(0);var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var c=h.slice(0);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.ItemsMovingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,f,g,e,d))}};b.prototype.doMoveAndShowItems=function(g,f,d,c,e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.setAllLevelsSelection(e);this.moveItems(g.slice(0),d,c);this.selectAndShowItems$java_util_List$boolean(f.slice(0),e)};b.prototype.postPieceOfFurnitureMove=function(l,m,k,e,g,d,h){var f=l.getAngle();var j=l.getDepth();var c=l.getElevation();if(m!==0||k!==0||f!==e||j!==g||c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureMovingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,g,d,h,l,m,k,f,j,c))}};b.prototype.postItemsDuplication=function(e,d){var c=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();var g=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();var j=Home.getFurnitureSubList(e);for(var f=0;f<j.length;f++){var h=j[f];this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePieceOfFurniture(h)}this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.beginUpdate();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DuplicationStartUndoableEdit(this,d.slice(0),g));this.addFurniture$java_util_List(j);var k=[];this.postCreateWalls(Home.getWallsSubList(e),k,c,g);this.postCreateRooms$java_util_List$java_util_List$boolean$boolean(Home.getRoomsSubList(e),k,c,g);this.postCreatePolylines$java_util_List$java_util_List$boolean$boolean(Home.getPolylinesSubList(e),k,c,g);this.postCreateDimensionLines(Home.getDimensionLinesSubList(e),k,c,g);this.postCreateLabels(Home.getLabelsSubList(e),k,c,g);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DuplicationEndUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e.slice(0)));this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.endUpdate();this.selectItems$java_util_List(e)};b.prototype.postWallResize=function(c,f,d,e){var h;var g;if(e){h=c.getXStart();g=c.getYStart()}else{h=c.getXEnd();g=c.getYEnd()}if(h!==f||g!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,f,d,c,e,h,g))}};b.prototype.postWallArcExtent=function(c,e){var d=c.getArcExtent();if(d!==e&&(d==null||!(d===e))){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.WallArcExtentModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c,d))}};b.prototype.postRoomResize=function(j,g,e,f){var d=j.getPoints()[f];var k=d[0];var h=d[1];if(k!==g||h!==e){var c=new b.RoomResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,g,e,j,f,k,h);this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(c)}};b.prototype.postRoomNameOffset=function(f,d,g){var c=f.getNameXOffset();var e=f.getNameYOffset();if(c!==d||e!==g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomNameOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,g,f,c,e))}};b.prototype.postRoomNameRotation=function(d,e){var c=d.getNameAngle();if(c!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomNameRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,c))}};b.prototype.postRoomAreaOffset=function(g,d,f){var c=g.getAreaXOffset();var e=g.getAreaYOffset();if(c!==d||e!==f){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomAreaOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,f,g,c,e))}};b.prototype.postRoomAreaRotation=function(e,d){var c=e.getAreaAngle();if(c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.RoomAreaRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,c))}};b.prototype.postPieceOfFurnitureRotation=function(d,c,e){var f=d.getAngle();if(f!==c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,e,d,f))}};b.prototype.postPieceOfFurniturePitchRotation=function(g,e,d,f,c){var h=g.getPitch();if(h!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurniturePitchRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,f,c,g,h,g.getWidthInPlan(),g.getDepthInPlan(),g.getHeightInPlan()))}};b.prototype.setPieceOfFurniturePitch=function(f,g,d,e,c){f.removePropertyChangeListener(this.furnitureSizeChangeListener);f.setPitch(g);f.setWidthInPlan(d);f.setDepthInPlan(e);f.setHeightInPlan(c);f.addPropertyChangeListener(this.furnitureSizeChangeListener)};b.prototype.postPieceOfFurnitureRollRotation=function(h,g,e,f,d){var c=h.getRoll();if(c!==g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureRollRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,g,e,f,d,h,c,h.getWidthInPlan(),h.getDepthInPlan(),h.getHeightInPlan()))}};b.prototype.setPieceOfFurnitureRoll=function(g,e,d,f,c){g.removePropertyChangeListener(this.furnitureSizeChangeListener);g.setRoll(e);g.setWidthInPlan(d);g.setDepthInPlan(f);g.setHeightInPlan(c);g.addPropertyChangeListener(this.furnitureSizeChangeListener)};b.prototype.postPieceOfFurnitureElevation=function(e,d){var c=e.getElevation();if(c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,c))}};b.prototype.postPieceOfFurnitureHeightResize=function(c){if(c.getPieceOfFurniture().getHeight()!==c.getHeight()){this.postPieceOfFurnitureResize(c,"undoPieceOfFurnitureHeightResizeName")}};b.prototype.postPieceOfFurnitureWidthAndDepthResize=function(c){var d=c.getPieceOfFurniture();if(d.getWidth()!==c.getWidth()||d.getDepth()!==c.getDepth()){this.postPieceOfFurnitureResize(c,"undoPieceOfFurnitureWidthAndDepthResizeName")}};b.prototype.postPieceOfFurnitureResize=function(d,c){var f=d.getPieceOfFurniture();var e=(f!=null&&f instanceof HomeDoorOrWindow)&&f.isBoundToWall();this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,e,d,f.getX(),f.getY(),f.getWidth(),f.getDepth(),f.getHeight()))};b.prototype.setPieceOfFurnitureSize=function(e,h,j,c){var g=e.getPieceOfFurniture();g.removePropertyChangeListener(this.furnitureSizeChangeListener);if(g!=null&&g instanceof HomeFurnitureGroup){var k=g.getAllFurniture();for(var f=0;f<k.length;f++){var d=k[f];d.removePropertyChangeListener(this.furnitureSizeChangeListener)}}b.ResizedPieceOfFurniture.setPieceOfFurnitureSize(g,h,j,c);g.addPropertyChangeListener(this.furnitureSizeChangeListener);if(g!=null&&g instanceof HomeFurnitureGroup){var k=g.getAllFurniture();for(var f=0;f<k.length;f++){var d=k[f];d.addPropertyChangeListener(this.furnitureSizeChangeListener)}}};b.prototype.resetPieceOfFurnitureSize=function(d){var f=d.getPieceOfFurniture();f.removePropertyChangeListener(this.furnitureSizeChangeListener);if(f!=null&&f instanceof HomeFurnitureGroup){var g=f.getAllFurniture();for(var e=0;e<g.length;e++){var c=g[e];c.removePropertyChangeListener(this.furnitureSizeChangeListener)}}d.reset();f.addPropertyChangeListener(this.furnitureSizeChangeListener);if(f!=null&&f instanceof HomeFurnitureGroup){var g=f.getAllFurniture();for(var e=0;e<g.length;e++){var c=g[e];c.addPropertyChangeListener(this.furnitureSizeChangeListener)}}};b.prototype.postLightPowerModification=function(d,c){var e=d.getPower();if(e!==c){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.LightPowerModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,c,d,e))}};b.prototype.postPieceOfFurnitureNameOffset=function(c,e,g){var d=c.getNameXOffset();var f=c.getNameYOffset();if(d!==e||f!==g){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureNameOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,g,c,d,f))}};b.prototype.postPieceOfFurnitureNameRotation=function(c,e){var d=c.getNameAngle();if(d!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PieceOfFurnitureNameRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c,d))}};b.prototype.postDimensionLineResize=function(c,f,d,e,j){var h;var g;if(e){h=c.getXStart();g=c.getYStart()}else{h=c.getXEnd();g=c.getYEnd()}if(h!==f||g!==d||j){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLineResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,f,d,c,h,g,e,j))}};b.prototype.postDimensionLineOffset=function(c,d){var e=c.getOffset();if(e!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLineOffsetModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c,e))}};b.prototype.postDimensionLinePitchRotation=function(c,d){var e=c.getPitch();if(e!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLinePitchRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,c,e))}};b.prototype.postDimensionLineHeight=function(c,e){var d=c.getElevationEnd()-c.getElevationStart();if(d!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLineHeightResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c,d))}};b.prototype.postDimensionLineElevation=function(c,e){var d=c.getElevationStart();if(d!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.DimensionLineElevationModificationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,c,d))}};b.prototype.postPolylineResize=function(c,g,e,f){var d=c.getPoints()[f];var j=d[0];var h=d[1];if(j!==g||h!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.PolylineResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,g,e,c,f,j,h))}};b.prototype.postCompassRotation=function(e,d){var c=e.getNorthDirection();if(c!==d){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.CompassRotationUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,d,e,c))}};b.prototype.postCompassResize=function(d,e){var c=d.getDiameter();if(c!==e){this.__com_eteks_sweethome3d_viewcontroller_PlanController_undoSupport.postEdit(new b.CompassResizingUndoableEdit(this,this.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences,e,d,c))}};b.prototype.getPathPoints=function(l,e){var k=([]);var j=null;for(var h=l.getPathIterator(null);!h.isDone();h.next()){var f=[0,0];if(h.currentSegment(f)!==java.awt.geom.PathIterator.SEG_CLOSE&&(j==null||!(function(n,m){if(n==null&&m==null){return true}if(n==null||m==null){return false}if(n.length!=m.length){return false}for(var o=0;o<n.length;o++){if(n[o]!=m[o]){return false}}return true})(f,j))){var d=false;if(e&&k.length>1){var c=k[k.length-2];var g=j;d=java.awt.geom.Line2D.ptLineDistSq(c[0],c[1],g[0],g[1],f[0],f[1])<0.0001}if(d){(k[k.length-1]=f)}else{(k.push(f)>0)}j=f}}if(k.length>1&&(function(n,m){if(n==null&&m==null){return true}if(n==null||m==null){return false}if(n.length!=m.length){return false}for(var o=0;o<n.length;o++){if(n[o]!=m[o]){return false}}return true})(k[0],k[k.length-1])){k.splice(k.length-1,1)[0]}return k.slice(0)};b.prototype.getRoomPathsFromWalls=function(){if(this.roomPathsCache==null){var e=this.getWallsArea(false);var d=this.getAreaPaths(e);var g=new java.awt.geom.Area(e);for(var c=0;c<d.length;c++){var f=d[c];g.add(new java.awt.geom.Area(f))}this.roomPathsCache=d;this.insideWallsAreaCache=g}return this.roomPathsCache};b.prototype.getAreaPaths=function(h){var d=([]);var g=null;var c=null;for(var f=h.getPathIterator(null,0.5);!f.isDone();f.next()){var e=[0,0];switch((f.currentSegment(e))){case java.awt.geom.PathIterator.SEG_MOVETO:g=new java.awt.geom.GeneralPath();g.moveTo(e[0],e[1]);c=e;break;case java.awt.geom.PathIterator.SEG_LINETO:if((e[0]!==c[0]||e[1]!==c[1])&&java.awt.geom.Point2D.distanceSq(e[0],e[1],c[0],c[1])>1e-10){g.lineTo(e[0],e[1]);c=e}break;case java.awt.geom.PathIterator.SEG_CLOSE:g.closePath();(d.push(g)>0);break}}return d};b.prototype.getInsideWallsArea=function(){if(this.insideWallsAreaCache==null){this.getRoomPathsFromWalls()}return this.insideWallsAreaCache};b.prototype.getWallsArea=function(g){if(!g&&this.wallsAreaCache==null||g&&this.wallsIncludingBaseboardsAreaCache==null){var e=new java.awt.geom.Area();var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var h=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var d=0;d<h.length;d++){var c=h[d];if(c.isAtLevel(f)){e.add(new java.awt.geom.Area(this.getPath$float_A_A(c.getPoints$boolean(g))))}}if(g){this.wallsIncludingBaseboardsAreaCache=e}else{this.wallsAreaCache=e}}return g?this.wallsIncludingBaseboardsAreaCache:this.wallsAreaCache};b.prototype.getPath$float_A_A=function(d){var e=new java.awt.geom.GeneralPath();e.moveTo(d[0][0],d[0][1]);for(var c=1;c<d.length;c++){e.lineTo(d[c][0],d[c][1])}e.closePath();return e};b.prototype.getPath=function(c){if(((c!=null&&c instanceof Array&&(c.length==0||c[0]==null||c[0] instanceof Array))||c===null)){return this.getPath$float_A_A(c)}else{if(((c!=null&&c instanceof java.awt.geom.Area)||c===null)){return this.getPath$java_awt_geom_Area(c)}else{throw new Error("invalid overload")}}};b.prototype.getPath$java_awt_geom_Area=function(e){var f=new java.awt.geom.GeneralPath();var c=[0,0];for(var d=e.getPathIterator(null,0.5);!d.isDone();d.next()){switch((d.currentSegment(c))){case java.awt.geom.PathIterator.SEG_MOVETO:f.moveTo(c[0],c[1]);break;case java.awt.geom.PathIterator.SEG_LINETO:f.lineTo(c[0],c[1]);break}}return f};b.prototype.selectLevelFromSelectedItems=function(){var e=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel();var f=this.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();for(var c=0;c<f.length;c++){var d=f[c];if((d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0))&&d.isAtLevel(e)){return}}for(var c=0;c<f.length;c++){var d=f[c];if(d!=null&&(d.constructor!=null&&d.constructor.__interfaces!=null&&d.constructor.__interfaces.indexOf("com.eteks.sweethome3d.model.Elevatable")>=0)){this.setSelectedLevel(d.getLevel());break}}};b.SCALE_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanScale";b.PIXEL_MARGIN=4;b.INDICATOR_PIXEL_MARGIN=5;b.WALL_ENDS_PIXEL_MARGIN=2;return b}(FurnitureController));PlanController.__class="com.eteks.sweethome3d.viewcontroller.PlanController";PlanController.__interfaces=["com.eteks.sweethome3d.viewcontroller.Controller"];(function(al){var aO=(function(){function bg(bh){if(this.__name===undefined){this.__name=null}this.__name=bh}bg.SELECTION_$LI$=function(){if(bg.SELECTION==null){bg.SELECTION=new al.Mode("SELECTION")}return bg.SELECTION};bg.PANNING_$LI$=function(){if(bg.PANNING==null){bg.PANNING=new al.Mode("PANNING")}return bg.PANNING};bg.WALL_CREATION_$LI$=function(){if(bg.WALL_CREATION==null){bg.WALL_CREATION=new al.Mode("WALL_CREATION")}return bg.WALL_CREATION};bg.ROOM_CREATION_$LI$=function(){if(bg.ROOM_CREATION==null){bg.ROOM_CREATION=new al.Mode("ROOM_CREATION")}return bg.ROOM_CREATION};bg.POLYLINE_CREATION_$LI$=function(){if(bg.POLYLINE_CREATION==null){bg.POLYLINE_CREATION=new al.Mode("POLYLINE_CREATION")}return bg.POLYLINE_CREATION};bg.DIMENSION_LINE_CREATION_$LI$=function(){if(bg.DIMENSION_LINE_CREATION==null){bg.DIMENSION_LINE_CREATION=new al.Mode("DIMENSION_LINE_CREATION")}return bg.DIMENSION_LINE_CREATION};bg.LABEL_CREATION_$LI$=function(){if(bg.LABEL_CREATION==null){bg.LABEL_CREATION=new al.Mode("LABEL_CREATION")}return bg.LABEL_CREATION};bg.prototype.name=function(){return this.__name};bg.prototype.toString=function(){return this.__name};return bg}());al.Mode=aO;aO.__class="com.eteks.sweethome3d.viewcontroller.PlanController.Mode";var l=(function(bh){__extends(bg,bh);function bg(bj,bn,bk,bi,bl,bm){var bo=bh.call(this,bk,al,"undoLockBasePlan")||this;if(bo.controller===undefined){bo.controller=null}if(bo.home===undefined){bo.home=null}if(bo.oldSelection===undefined){bo.oldSelection=null}if(bo.allLevelsSelection===undefined){bo.allLevelsSelection=false}if(bo.newSelectedItems===undefined){bo.newSelectedItems=null}bo.controller=bj;bo.home=bn;bo.oldSelection=bi;bo.allLevelsSelection=bl;bo.newSelectedItems=bm;return bo}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.home.setBasePlanLocked(false);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.home.setBasePlanLocked(true);this.controller.selectAndShowItems$java_util_List$boolean(this.newSelectedItems.slice(0),this.allLevelsSelection)};return bg}(LocalizedUndoableEdit));al.LockingUndoableEdit=l;l.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LockingUndoableEdit";l.__interfaces=["javax.swing.undo.UndoableEdit"];var aN=(function(bg){__extends(bh,bg);function bh(bi,bl,bj,bn,bk){var bm=bg.call(this,bj,al,"undoUnlockBasePlan")||this;if(bm.controller===undefined){bm.controller=null}if(bm.home===undefined){bm.home=null}if(bm.selectedItems===undefined){bm.selectedItems=null}if(bm.allLevelsSelection===undefined){bm.allLevelsSelection=false}bm.controller=bi;bm.home=bl;bm.selectedItems=bn;bm.allLevelsSelection=bk;return bm}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.home.setBasePlanLocked(true);this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),this.allLevelsSelection)};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.home.setBasePlanLocked(false);this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),false)};return bh}(LocalizedUndoableEdit));al.UnlockingUndoableEdit=aN;aN.__class="com.eteks.sweethome3d.viewcontroller.PlanController.UnlockingUndoableEdit";aN.__interfaces=["javax.swing.undo.UndoableEdit"];var J=(function(bg){__extends(bh,bg);function bh(bi,bk,bl,bj,bm,bn){var bo=bg.call(this,bk,al,"undoFlipName")||this;if(bo.controller===undefined){bo.controller=null}if(bo.allLevelsSelection===undefined){bo.allLevelsSelection=false}if(bo.items===undefined){bo.items=null}if(bo.itemTextBaseOffsets===undefined){bo.itemTextBaseOffsets=null}if(bo.horizontalFlip===undefined){bo.horizontalFlip=false}bo.controller=bi;bo.allLevelsSelection=bl;bo.items=bj;bo.itemTextBaseOffsets=bm;bo.horizontalFlip=bn;return bo}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.doFlipItems(this.items,this.itemTextBaseOffsets,this.horizontalFlip);this.controller.selectAndShowItems$java_util_List$boolean(this.items.slice(0),this.allLevelsSelection)};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.controller.doFlipItems(this.items,this.itemTextBaseOffsets,this.horizontalFlip);this.controller.selectAndShowItems$java_util_List$boolean(this.items.slice(0),this.allLevelsSelection)};return bh}(LocalizedUndoableEdit));al.FlippingUndoableEdit=J;J.__class="com.eteks.sweethome3d.viewcontroller.PlanController.FlippingUndoableEdit";J.__interfaces=["javax.swing.undo.UndoableEdit"];var U=(function(bg){__extends(bh,bg);function bh(bj,bk,bi,bm,bo,bl){var bn=bg.call(this,bk,al,"undoJoinWallsName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldSelection===undefined){bn.oldSelection=null}if(bn.allLevelsSelection===undefined){bn.allLevelsSelection=false}if(bn.joinedWalls===undefined){bn.joinedWalls=null}if(bn.joinPoint===undefined){bn.joinPoint=null}bn.controller=bj;bn.oldSelection=bi;bn.allLevelsSelection=bm;bn.joinedWalls=bo;bn.joinPoint=bl;return bn}bh.prototype.undo=function(){bg.prototype.undo.call(this);for(var bj=0;bj<this.joinedWalls.length;bj++){var bk=this.joinedWalls[bj];var bi=bk.getWall();bi.setWallAtStart(bk.getWallAtStart());if(bk.getWallAtStart()!=null){if(bk.isJoinedAtEndOfWallAtStart()){bk.getWallAtStart().setWallAtEnd(bi)}else{bk.getWallAtStart().setWallAtStart(bi)}}bi.setWallAtEnd(bk.getWallAtEnd());if(bk.getWallAtEnd()!=null){if(bk.isJoinedAtStartOfWallAtEnd()){bk.getWallAtEnd().setWallAtStart(bi)}else{bk.getWallAtEnd().setWallAtEnd(bi)}}bi.setXStart(bk.getXStart());bi.setYStart(bk.getYStart());bi.setXEnd(bk.getXEnd());bi.setYEnd(bk.getYEnd())}this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.controller.doJoinWalls(this.joinedWalls,this.joinPoint)};return bh}(LocalizedUndoableEdit));al.WallsJoiningUndoableEdit=U;U.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsJoiningUndoableEdit";U.__interfaces=["javax.swing.undo.UndoableEdit"];var aK=(function(bh){__extends(bg,bh);function bg(bj,bk,bi,bm,bl){var bn=bh.call(this,bk,al,"undoReverseWallsDirectionName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldSelection===undefined){bn.oldSelection=null}if(bn.allLevelsSelection===undefined){bn.allLevelsSelection=false}if(bn.walls===undefined){bn.walls=null}bn.controller=bj;bn.oldSelection=bi;bn.allLevelsSelection=bm;bn.walls=bl;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.doReverseWallsDirection(this.walls);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.doReverseWallsDirection(this.walls);this.controller.selectAndShowItems$java_util_List$boolean(this.walls.slice(0),false)};return bg}(LocalizedUndoableEdit));al.WallsDirectionReversingUndoableEdit=aK;aK.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsDirectionReversingUndoableEdit";aK.__interfaces=["javax.swing.undo.UndoableEdit"];var ar=(function(bh){__extends(bg,bh);function bg(bm,bl,bj,br,bo,bq,bp,bk,bi){var bn=bh.call(this,bl,al,"undoSplitWallName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldSelection===undefined){bn.oldSelection=null}if(bn.oldBasePlanLocked===undefined){bn.oldBasePlanLocked=false}if(bn.oldAllLevelsSelection===undefined){bn.oldAllLevelsSelection=false}if(bn.splitJoinedWall===undefined){bn.splitJoinedWall=null}if(bn.firstJoinedWall===undefined){bn.firstJoinedWall=null}if(bn.secondJoinedWall===undefined){bn.secondJoinedWall=null}if(bn.newBasePlanLocked===undefined){bn.newBasePlanLocked=false}bn.controller=bm;bn.oldSelection=bj;bn.oldBasePlanLocked=br;bn.oldAllLevelsSelection=bo;bn.splitJoinedWall=bq;bn.firstJoinedWall=bp;bn.secondJoinedWall=bk;bn.newBasePlanLocked=bi;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.doDeleteWalls([this.firstJoinedWall,this.secondJoinedWall],this.oldBasePlanLocked);this.controller.doAddWalls([this.splitJoinedWall],this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.doDeleteWalls([this.splitJoinedWall],this.newBasePlanLocked);this.controller.doAddWalls([this.firstJoinedWall,this.secondJoinedWall],this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean([this.firstJoinedWall.getWall()].slice(0),false)};return bg}(LocalizedUndoableEdit));al.WallSplittingUndoableEdit=ar;ar.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallSplittingUndoableEdit";ar.__interfaces=["javax.swing.undo.UndoableEdit"];var D=(function(bh){__extends(bg,bh);function bg(bj,bl,bi,bm,bn,bk,bo){var bp=bh.call(this,bl,al,"undoModifyTextStyleName")||this;if(bp.controller===undefined){bp.controller=null}if(bp.oldSelection===undefined){bp.oldSelection=null}if(bp.allLevelsSelection===undefined){bp.allLevelsSelection=false}if(bp.oldStyles===undefined){bp.oldStyles=null}if(bp.items===undefined){bp.items=null}if(bp.styles===undefined){bp.styles=null}bp.controller=bj;bp.oldSelection=bi;bp.allLevelsSelection=bm;bp.oldStyles=bn;bp.items=bk;bp.styles=bo;return bp}bg.prototype.undo=function(){bh.prototype.undo.call(this);al.doModifyTextStyle(this.items,this.oldStyles);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);al.doModifyTextStyle(this.items,this.styles);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};return bg}(LocalizedUndoableEdit));al.TextStyleModificationUndoableEdit=D;D.__class="com.eteks.sweethome3d.viewcontroller.PlanController.TextStyleModificationUndoableEdit";D.__interfaces=["javax.swing.undo.UndoableEdit"];var ak=(function(bg){__extends(bh,bg);function bh(bl,bp,bk,bi,bo,br,bq,bn,bj){var bm=bg.call(this,bk,al,"undoAddLevel")||this;if(bm.controller===undefined){bm.controller=null}if(bm.home===undefined){bm.home=null}if(bm.oldSelection===undefined){bm.oldSelection=null}if(bm.allLevelsSelection===undefined){bm.allLevelsSelection=false}if(bm.oldSelectedLevel===undefined){bm.oldSelectedLevel=null}if(bm.level0===undefined){bm.level0=null}if(bm.homeBackgroundImage===undefined){bm.homeBackgroundImage=null}if(bm.newLevel===undefined){bm.newLevel=null}bm.controller=bl;bm.home=bp;bm.oldSelection=bi;bm.allLevelsSelection=bo;bm.oldSelectedLevel=br;bm.level0=bq;bm.homeBackgroundImage=bn;bm.newLevel=bj;return bm}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.setSelectedLevel(this.oldSelectedLevel);this.home.deleteLevel(this.newLevel);if(this.level0!=null){this.home.setBackgroundImage(this.homeBackgroundImage);this.controller.moveHomeItemsToLevel(this.oldSelectedLevel);this.home.deleteLevel(this.level0)}this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};bh.prototype.redo=function(){bg.prototype.redo.call(this);if(this.level0!=null){this.home.addLevel(this.level0);this.controller.moveHomeItemsToLevel(this.level0);this.level0.setBackgroundImage(this.homeBackgroundImage);this.home.setBackgroundImage(null)}this.home.addLevel(this.newLevel);this.controller.setSelectedLevel(this.newLevel)};return bh}(LocalizedUndoableEdit));al.LevelAdditionUndoableEdit=ak;ak.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelAdditionUndoableEdit";ak.__interfaces=["javax.swing.undo.UndoableEdit"];var aQ=(function(bh){__extends(bg,bh);function bg(bi,bj,bk){var bl=bh.call(this,bj,al,"undoModifyLevelViewabilityName")||this;if(bl.controller===undefined){bl.controller=null}if(bl.selectedLevel===undefined){bl.selectedLevel=null}bl.controller=bi;bl.selectedLevel=bk;return bl}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.setSelectedLevel(this.selectedLevel);this.selectedLevel.setViewable(!this.selectedLevel.isViewable())};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.setSelectedLevel(this.selectedLevel);this.selectedLevel.setViewable(!this.selectedLevel.isViewable())};return bg}(LocalizedUndoableEdit));al.LevelViewabilityModificationUndoableEdit=aQ;aQ.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelViewabilityModificationUndoableEdit";aQ.__interfaces=["javax.swing.undo.UndoableEdit"];var bf=(function(bg){__extends(bh,bg);function bh(bi,bj,bl,bk,bm){var bn=bg.call(this,bj,al,"undoModifyLevelViewabilityName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.selectedLevel===undefined){bn.selectedLevel=null}if(bn.selectedLevelViewable===undefined){bn.selectedLevelViewable=false}if(bn.viewableLevels===undefined){bn.viewableLevels=null}bn.controller=bi;bn.selectedLevel=bl;bn.selectedLevelViewable=bk;bn.viewableLevels=bm;return bn}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.setSelectedLevel(this.selectedLevel);al.setLevelsViewability(this.viewableLevels,true);this.selectedLevel.setViewable(this.selectedLevelViewable)};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.controller.setSelectedLevel(this.selectedLevel);al.setLevelsViewability(this.viewableLevels,false);this.selectedLevel.setViewable(true)};return bh}(LocalizedUndoableEdit));al.LevelsViewabilityModificationUndoableEdit=bf;bf.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelsViewabilityModificationUndoableEdit";bf.__interfaces=["javax.swing.undo.UndoableEdit"];var C=(function(bh){__extends(bg,bh);function bg(bj,bk,bl,bi){var bm=bh.call(this,bk,al,"undoModifyLevelViewabilityName")||this;if(bm.controller===undefined){bm.controller=null}if(bm.selectedLevel===undefined){bm.selectedLevel=null}if(bm.unviewableLevels===undefined){bm.unviewableLevels=null}bm.controller=bj;bm.selectedLevel=bl;bm.unviewableLevels=bi;return bm}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.setSelectedLevel(this.selectedLevel);al.setLevelsViewability(this.unviewableLevels,false)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.setSelectedLevel(this.selectedLevel);al.setLevelsViewability(this.unviewableLevels,true)};return bg}(LocalizedUndoableEdit));al.AllLevelsViewabilityModificationUndoableEdit=C;C.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AllLevelsViewabilityModificationUndoableEdit";C.__interfaces=["javax.swing.undo.UndoableEdit"];var g=(function(bh){__extends(bg,bh);function bg(bj,bn,bk,bm,bp,bl,bi){var bo=bh.call(this,bk,al,"undoDeleteSelectedLevel")||this;if(bo.controller===undefined){bo.controller=null}if(bo.home===undefined){bo.home=null}if(bo.oldSelectedLevel===undefined){bo.oldSelectedLevel=null}if(bo.remainingLevel===undefined){bo.remainingLevel=null}if(bo.remainingLevelElevation===undefined){bo.remainingLevelElevation=null}if(bo.remainingLevelViewable===undefined){bo.remainingLevelViewable=false}bo.controller=bj;bo.home=bn;bo.oldSelectedLevel=bm;bo.remainingLevel=bp;bo.remainingLevelElevation=bl;bo.remainingLevelViewable=bi;return bo}bg.prototype.undo=function(){bh.prototype.undo.call(this);if(this.remainingLevel!=null){this.remainingLevel.setElevation(this.remainingLevelElevation);this.remainingLevel.setViewable(this.remainingLevelViewable)}this.home.addLevel(this.oldSelectedLevel);this.controller.setSelectedLevel(this.oldSelectedLevel)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.home.deleteLevel(this.oldSelectedLevel);if(this.remainingLevel!=null){this.remainingLevel.setElevation(0);this.remainingLevel.setViewable(true)}};return bg}(LocalizedUndoableEdit));al.LevelDeletionUndoableEdit=g;g.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LevelDeletionUndoableEdit";g.__interfaces=["javax.swing.undo.UndoableEdit"];var ba=(function(bh){__extends(bg,bh);function bg(bk,bl,bj,bn,bm,bi,bp){var bo=bh.call(this,bl,al,"undoAddRoomPointName")||this;if(bo.controller===undefined){bo.controller=null}if(bo.oldSelection===undefined){bo.oldSelection=null}if(bo.room===undefined){bo.room=null}if(bo.index===undefined){bo.index=0}if(bo.x===undefined){bo.x=0}if(bo.y===undefined){bo.y=0}bo.controller=bk;bo.oldSelection=bj;bo.room=bn;bo.index=bm;bo.x=bi;bo.y=bp;return bo}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.room.removePoint(this.index);this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.room.addPoint$float$float$int(this.x,this.y,this.index);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bg}(LocalizedUndoableEdit));al.RoomPointAdditionUndoableEdit=ba;ba.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointAdditionUndoableEdit";ba.__interfaces=["javax.swing.undo.UndoableEdit"];var ae=(function(bh){__extends(bg,bh);function bg(bj,bk,bi,bn,bl,bo,bm){var bp=bh.call(this,bk,al,"undoDeleteRoomPointName")||this;if(bp.controller===undefined){bp.controller=null}if(bp.oldSelection===undefined){bp.oldSelection=null}if(bp.room===undefined){bp.room=null}if(bp.index===undefined){bp.index=0}if(bp.xPoint===undefined){bp.xPoint=0}if(bp.yPoint===undefined){bp.yPoint=0}bp.controller=bj;bp.oldSelection=bi;bp.room=bn;bp.index=bl;bp.xPoint=bo;bp.yPoint=bm;return bp}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.room.addPoint$float$float$int(this.xPoint,this.yPoint,this.index);this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.room.removePoint(this.index);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bg}(LocalizedUndoableEdit));al.RoomPointDeletionUndoableEdit=ae;ae.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointDeletionUndoableEdit";ae.__interfaces=["javax.swing.undo.UndoableEdit"];var au=(function(bh){__extends(bg,bh);function bg(bj,bk,bi,bn,bl,bm){var bo=bh.call(this,bk,al,"undoRecomputeRoomPointsName")||this;if(bo.controller===undefined){bo.controller=null}if(bo.oldSelection===undefined){bo.oldSelection=null}if(bo.room===undefined){bo.room=null}if(bo.oldPoints===undefined){bo.oldPoints=null}if(bo.newPoints===undefined){bo.newPoints=null}bo.controller=bj;bo.oldSelection=bi;bo.room=bn;bo.oldPoints=bl;bo.newPoints=bm;return bo}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.room.setPoints(this.oldPoints);this.controller.selectAndShowItems$java_util_List(this.oldSelection.slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.room.setPoints(this.newPoints);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bg}(LocalizedUndoableEdit));al.RoomPointsModificationUndoableEdit=au;au.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointsModificationUndoableEdit";au.__interfaces=["javax.swing.undo.UndoableEdit"];var k=(function(bh){__extends(bg,bh);function bg(bi,bk,bj,bm){var bl=bh.call(this)||this;if(bl.controller===undefined){bl.controller=null}if(bl.home===undefined){bl.home=null}if(bl.allLevelsSelection===undefined){bl.allLevelsSelection=false}if(bl.selectedItems===undefined){bl.selectedItems=null}bl.controller=bi;bl.home=bk;bl.allLevelsSelection=bj;bl.selectedItems=bm;return bl}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.selectAndShowItems$java_util_List$boolean(this.selectedItems.slice(0),this.allLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.home.removeSelectionListener(this.controller.getSelectionListener())};return bg}(javax.swing.undo.AbstractUndoableEdit));al.ItemsDeletionStartUndoableEdit=k;k.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionStartUndoableEdit";k.__interfaces=["javax.swing.undo.UndoableEdit"];var ah=(function(bg){__extends(bh,bg);function bh(bi,bj){var bk=bg.call(this)||this;if(bk.controller===undefined){bk.controller=null}if(bk.home===undefined){bk.home=null}bk.controller=bi;bk.home=bj;return bk}bh.prototype.redo=function(){bg.prototype.redo.call(this);this.home.addSelectionListener(this.controller.getSelectionListener())};return bh}(javax.swing.undo.AbstractUndoableEdit));al.ItemsDeletionEndUndoableEdit=ah;ah.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionEndUndoableEdit";ah.__interfaces=["javax.swing.undo.UndoableEdit"];var af=(function(bg){__extends(bh,bg);function bh(bp,bo,br,bu,bi,bx,bl,bv,bw,bn,bm,bk,bt,by,bq,bj){var bs=bg.call(this,bo,al,"undoDeleteSelectionName")||this;if(bs.controller===undefined){bs.controller=null}if(bs.basePlanLocked===undefined){bs.basePlanLocked=false}if(bs.allLevelsSelection===undefined){bs.allLevelsSelection=false}if(bs.deletedItems===undefined){bs.deletedItems=null}if(bs.joinedDeletedWalls===undefined){bs.joinedDeletedWalls=null}if(bs.rooms===undefined){bs.rooms=null}if(bs.roomsIndices===undefined){bs.roomsIndices=null}if(bs.roomsLevels===undefined){bs.roomsLevels=null}if(bs.dimensionLines===undefined){bs.dimensionLines=null}if(bs.dimensionLinesLevels===undefined){bs.dimensionLinesLevels=null}if(bs.polylines===undefined){bs.polylines=null}if(bs.polylinesIndices===undefined){bs.polylinesIndices=null}if(bs.polylinesLevels===undefined){bs.polylinesLevels=null}if(bs.labels===undefined){bs.labels=null}if(bs.labelsLevels===undefined){bs.labelsLevels=null}bs.controller=bp;bs.basePlanLocked=br;bs.allLevelsSelection=bu;bs.deletedItems=bi;bs.joinedDeletedWalls=bx;bs.rooms=bl;bs.roomsIndices=bv;bs.roomsLevels=bw;bs.dimensionLines=bn;bs.dimensionLinesLevels=bm;bs.polylines=bk;bs.polylinesIndices=bt;bs.polylinesLevels=by;bs.labels=bq;bs.labelsLevels=bj;return bs}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.doAddWalls(this.joinedDeletedWalls,this.basePlanLocked);this.controller.doAddRooms(this.rooms,this.roomsIndices,this.roomsLevels,null,this.basePlanLocked);this.controller.doAddDimensionLines(this.dimensionLines,this.dimensionLinesLevels,null,this.basePlanLocked);this.controller.doAddPolylines(this.polylines,this.polylinesIndices,this.polylinesLevels,null,this.basePlanLocked);this.controller.doAddLabels(this.labels,this.labelsLevels,null,this.basePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.deletedItems.slice(0),this.allLevelsSelection)};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.controller.selectItems$java_util_List(this.deletedItems.slice(0));this.controller.doDeleteWalls(this.joinedDeletedWalls,this.basePlanLocked);this.controller.doDeleteRooms(this.rooms,this.basePlanLocked);this.controller.doDeleteDimensionLines(this.dimensionLines,this.basePlanLocked);this.controller.doDeletePolylines(this.polylines,this.basePlanLocked);this.controller.doDeleteLabels(this.labels,this.basePlanLocked)};return bh}(LocalizedUndoableEdit));al.ItemsDeletionUndoableEdit=af;af.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsDeletionUndoableEdit";af.__interfaces=["javax.swing.undo.UndoableEdit"];var aL=(function(bh){__extends(bg,bh);function bg(bk,bj,bi){var bl=bh.call(this,bj,al,"undoAddItemsName")||this;if(bl.home===undefined){bl.home=null}if(bl.items===undefined){bl.items=null}bl.home=bk;bl.items=bi;return bl}bg.prototype.redo=function(){bh.prototype.redo.call(this);this.home.setSelectedItems(this.items.slice(0))};return bg}(LocalizedUndoableEdit));al.ItemsAdditionEndUndoableEdit=aL;aL.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsAdditionEndUndoableEdit";aL.__interfaces=["javax.swing.undo.UndoableEdit"];var m=(function(bg){__extends(bh,bg);function bh(bj,bk,bi,bm,bo,bn,bl){var bp=bg.call(this,bk,al,"undoCreateWallsName")||this;if(bp.controller===undefined){bp.controller=null}if(bp.oldSelection===undefined){bp.oldSelection=null}if(bp.oldBasePlanLocked===undefined){bp.oldBasePlanLocked=false}if(bp.oldAllLevelsSelection===undefined){bp.oldAllLevelsSelection=false}if(bp.joinedNewWalls===undefined){bp.joinedNewWalls=null}if(bp.newBasePlanLocked===undefined){bp.newBasePlanLocked=false}bp.controller=bj;bp.oldSelection=bi;bp.oldBasePlanLocked=bm;bp.oldAllLevelsSelection=bo;bp.joinedNewWalls=bn;bp.newBasePlanLocked=bl;return bp}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.doDeleteWalls(this.joinedNewWalls,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.controller.doAddWalls(this.joinedNewWalls,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(al.JoinedWall.getWalls(this.joinedNewWalls),false)};return bh}(LocalizedUndoableEdit));al.WallsCreationUndoableEdit=m;m.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallsCreationUndoableEdit";m.__interfaces=["javax.swing.undo.UndoableEdit"];var ap=(function(bh){__extends(bg,bh);function bg(bm,bl,bj,br,bq,bp,bo,bk,bi){var bn=bh.call(this,bl,al,"undoCreateRoomsName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldSelection===undefined){bn.oldSelection=null}if(bn.oldBasePlanLocked===undefined){bn.oldBasePlanLocked=false}if(bn.oldAllLevelsSelection===undefined){bn.oldAllLevelsSelection=false}if(bn.newRooms===undefined){bn.newRooms=null}if(bn.roomsIndex===undefined){bn.roomsIndex=null}if(bn.roomsLevel===undefined){bn.roomsLevel=null}if(bn.newBasePlanLocked===undefined){bn.newBasePlanLocked=false}bn.controller=bm;bn.oldSelection=bj;bn.oldBasePlanLocked=br;bn.oldAllLevelsSelection=bq;bn.newRooms=bp;bn.roomsIndex=bo;bn.roomsLevel=bk;bn.newBasePlanLocked=bi;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.doDeleteRooms(this.newRooms,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.doAddRooms(this.newRooms,this.roomsIndex,null,this.roomsLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.newRooms.slice(0),false)};return bg}(LocalizedUndoableEdit));al.RoomsCreationUndoableEdit=ap;ap.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomsCreationUndoableEdit";ap.__interfaces=["javax.swing.undo.UndoableEdit"];var aE=(function(bg){__extends(bh,bg);function bh(bm,bl,bj,bq,bo,bk,bp,bi){var bn=bg.call(this,bl,al,"undoCreateDimensionLinesName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldSelection===undefined){bn.oldSelection=null}if(bn.oldBasePlanLocked===undefined){bn.oldBasePlanLocked=false}if(bn.oldAllLevelsSelection===undefined){bn.oldAllLevelsSelection=false}if(bn.dimensionLines===undefined){bn.dimensionLines=null}if(bn.dimensionLinesLevel===undefined){bn.dimensionLinesLevel=null}if(bn.newBasePlanLocked===undefined){bn.newBasePlanLocked=false}bn.controller=bm;bn.oldSelection=bj;bn.oldBasePlanLocked=bq;bn.oldAllLevelsSelection=bo;bn.dimensionLines=bk;bn.dimensionLinesLevel=bp;bn.newBasePlanLocked=bi;return bn}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.doDeleteDimensionLines(this.dimensionLines,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.controller.doAddDimensionLines(this.dimensionLines,null,this.dimensionLinesLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.dimensionLines.slice(0),false)};return bh}(LocalizedUndoableEdit));al.DimensionLinesCreationUndoableEdit=aE;aE.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLinesCreationUndoableEdit";aE.__interfaces=["javax.swing.undo.UndoableEdit"];var aw=(function(bh){__extends(bg,bh);function bg(bn,bm,bj,bq,bp,bk,bl,br,bi){var bo=bh.call(this,bm,al,"undoCreatePolylinesName")||this;if(bo.controller===undefined){bo.controller=null}if(bo.oldSelection===undefined){bo.oldSelection=null}if(bo.oldBasePlanLocked===undefined){bo.oldBasePlanLocked=false}if(bo.oldAllLevelsSelection===undefined){bo.oldAllLevelsSelection=false}if(bo.newPolylines===undefined){bo.newPolylines=null}if(bo.polylinesIndex===undefined){bo.polylinesIndex=null}if(bo.polylinesLevel===undefined){bo.polylinesLevel=null}if(bo.newBasePlanLocked===undefined){bo.newBasePlanLocked=false}bo.controller=bn;bo.oldSelection=bj;bo.oldBasePlanLocked=bq;bo.oldAllLevelsSelection=bp;bo.newPolylines=bk;bo.polylinesIndex=bl;bo.polylinesLevel=br;bo.newBasePlanLocked=bi;return bo}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.doDeletePolylines(this.newPolylines,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.doAddPolylines(this.newPolylines,this.polylinesIndex,null,this.polylinesLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List(this.newPolylines.slice(0))};return bg}(LocalizedUndoableEdit));al.PolylinesCreationUndoableEdit=aw;aw.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylinesCreationUndoableEdit";aw.__interfaces=["javax.swing.undo.UndoableEdit"];var bd=(function(bh){__extends(bg,bh);function bg(bl,bk,bj,bq,bp,bm,bo,bi){var bn=bh.call(this,bk,al,"undoCreateLabelsName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldSelection===undefined){bn.oldSelection=null}if(bn.oldBasePlanLocked===undefined){bn.oldBasePlanLocked=false}if(bn.oldAllLevelsSelection===undefined){bn.oldAllLevelsSelection=false}if(bn.labels===undefined){bn.labels=null}if(bn.labelsLevel===undefined){bn.labelsLevel=null}if(bn.newBasePlanLocked===undefined){bn.newBasePlanLocked=false}bn.controller=bl;bn.oldSelection=bj;bn.oldBasePlanLocked=bq;bn.oldAllLevelsSelection=bp;bn.labels=bm;bn.labelsLevel=bo;bn.newBasePlanLocked=bi;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.doDeleteLabels(this.labels,this.oldBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.oldAllLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.doAddLabels(this.labels,null,this.labelsLevel,this.newBasePlanLocked);this.controller.selectAndShowItems$java_util_List$boolean(this.labels.slice(0),false)};return bg}(LocalizedUndoableEdit));al.LabelsCreationUndoableEdit=bd;bd.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelsCreationUndoableEdit";bd.__interfaces=["javax.swing.undo.UndoableEdit"];var s=(function(bh){__extends(bg,bh);function bg(bi,bj,bl,bk,bn){var bm=bh.call(this,bj,al,"undoLabelRotationName")||this;if(bm.controller===undefined){bm.controller=null}if(bm.oldAngle===undefined){bm.oldAngle=0}if(bm.label===undefined){bm.label=null}if(bm.newAngle===undefined){bm.newAngle=0}bm.controller=bi;bm.oldAngle=bl;bm.label=bk;bm.newAngle=bn;return bm}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.label.setAngle(this.oldAngle);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.label.setAngle(this.newAngle);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};return bg}(LocalizedUndoableEdit));al.LabelRotationUndoableEdit=s;s.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelRotationUndoableEdit";s.__interfaces=["javax.swing.undo.UndoableEdit"];var ab=(function(bh){__extends(bg,bh);function bg(bi,bj,bm,bl,bk){var bn=bh.call(this,bj,al,bm<bk?"undoLabelRaiseName":"undoLabelLowerName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldElevation===undefined){bn.oldElevation=0}if(bn.label===undefined){bn.label=null}if(bn.newElevation===undefined){bn.newElevation=0}bn.controller=bi;bn.oldElevation=bm;bn.label=bl;bn.newElevation=bk;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.label.setElevation(this.oldElevation);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.label.setElevation(this.newElevation);this.controller.selectAndShowItems$java_util_List([this.label].slice(0))};return bg}(LocalizedUndoableEdit));al.LabelElevationModificationUndoableEdit=ab;ab.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelElevationModificationUndoableEdit";ab.__interfaces=["javax.swing.undo.UndoableEdit"];var aT=(function(bh){__extends(bg,bh);function bg(bk,bn,bj,bo,bm,bl,bi){var bp=bh.call(this,bn,al,"undoMoveSelectionName")||this;if(bp.controller===undefined){bp.controller=null}if(bp.oldSelection===undefined){bp.oldSelection=null}if(bp.allLevelsSelection===undefined){bp.allLevelsSelection=false}if(bp.itemsArray===undefined){bp.itemsArray=null}if(bp.dx===undefined){bp.dx=0}if(bp.dy===undefined){bp.dy=0}bp.controller=bk;bp.oldSelection=bj;bp.allLevelsSelection=bo;bp.itemsArray=bm;bp.dx=bl;bp.dy=bi;return bp}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.doMoveAndShowItems(this.itemsArray,this.oldSelection,-this.dx,-this.dy,this.allLevelsSelection)};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.doMoveAndShowItems(this.itemsArray,this.itemsArray,this.dx,this.dy,this.allLevelsSelection)};return bg}(LocalizedUndoableEdit));al.ItemsMovingUndoableEdit=aT;aT.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ItemsMovingUndoableEdit";aT.__interfaces=["javax.swing.undo.UndoableEdit"];var az=(function(bh){__extends(bg,bh);function bg(bl,bk,bm,bp,bj,bq,bt,bu,bs,bo,br,bi){var bn=bh.call(this,bk,al,"undoMoveSelectionName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldAngle===undefined){bn.oldAngle=0}if(bn.oldDepth===undefined){bn.oldDepth=0}if(bn.oldElevation===undefined){bn.oldElevation=0}if(bn.oldDoorOrWindowBoundToWall===undefined){bn.oldDoorOrWindowBoundToWall=false}if(bn.piece===undefined){bn.piece=null}if(bn.dx===undefined){bn.dx=0}if(bn.dy===undefined){bn.dy=0}if(bn.newAngle===undefined){bn.newAngle=0}if(bn.newDepth===undefined){bn.newDepth=0}if(bn.newElevation===undefined){bn.newElevation=0}bn.controller=bl;bn.oldAngle=bm;bn.oldDepth=bp;bn.oldElevation=bj;bn.oldDoorOrWindowBoundToWall=bq;bn.piece=bt;bn.dx=bu;bn.dy=bs;bn.newAngle=bo;bn.newDepth=br;bn.newElevation=bi;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.piece.move(-this.dx,-this.dy);this.piece.setAngle(this.oldAngle);if((this.piece!=null&&this.piece instanceof HomeDoorOrWindow)&&this.piece.isResizable()&&this.controller.isItemResizable(this.piece)){this.piece.setDepth(this.oldDepth)}this.piece.setElevation(this.oldElevation);if(this.piece!=null&&this.piece instanceof HomeDoorOrWindow){this.piece.setBoundToWall(this.oldDoorOrWindowBoundToWall)}this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.piece.move(this.dx,this.dy);this.piece.setAngle(this.newAngle);if((this.piece!=null&&this.piece instanceof HomeDoorOrWindow)&&this.piece.isResizable()&&this.controller.isItemResizable(this.piece)){this.piece.setDepth(this.newDepth)}this.piece.setElevation(this.newElevation);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return bg}(LocalizedUndoableEdit));al.PieceOfFurnitureMovingUndoableEdit=az;az.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureMovingUndoableEdit";az.__interfaces=["javax.swing.undo.UndoableEdit"];var aP=(function(bh){__extends(bg,bh);function bg(bj,bi,bk){var bl=bh.call(this)||this;if(bl.controller===undefined){bl.controller=null}if(bl.oldSelection===undefined){bl.oldSelection=null}if(bl.allLevelsSelection===undefined){bl.allLevelsSelection=false}bl.controller=bj;bl.oldSelection=bi;bl.allLevelsSelection=bk;return bl}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.selectAndShowItems$java_util_List$boolean(this.oldSelection.slice(0),this.allLevelsSelection)};return bg}(javax.swing.undo.AbstractUndoableEdit));al.DuplicationStartUndoableEdit=aP;aP.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DuplicationStartUndoableEdit";aP.__interfaces=["javax.swing.undo.UndoableEdit"];var aV=(function(bh){__extends(bg,bh);function bg(bi,bk,bj){var bl=bh.call(this,bk,al,"undoDuplicateSelectionName")||this;if(bl.controller===undefined){bl.controller=null}if(bl.items===undefined){bl.items=null}bl.controller=bi;bl.items=bj;return bl}bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.selectAndShowItems$java_util_List(this.items.slice(0))};return bg}(LocalizedUndoableEdit));al.DuplicationEndUndoableEdit=aV;aV.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DuplicationEndUndoableEdit";aV.__interfaces=["javax.swing.undo.UndoableEdit"];var G=(function(bh){__extends(bg,bh);function bg(bl,bk,bp,bo,bn,bj,bi,bq){var bm=bh.call(this,bk,al,"undoWallResizeName")||this;if(bm.controller===undefined){bm.controller=null}if(bm.oldX===undefined){bm.oldX=0}if(bm.oldY===undefined){bm.oldY=0}if(bm.wall===undefined){bm.wall=null}if(bm.startPoint===undefined){bm.startPoint=false}if(bm.newX===undefined){bm.newX=0}if(bm.newY===undefined){bm.newY=0}bm.controller=bl;bm.oldX=bp;bm.oldY=bo;bm.wall=bn;bm.startPoint=bj;bm.newX=bi;bm.newY=bq;return bm}bg.prototype.undo=function(){bh.prototype.undo.call(this);al.moveWallPoint(this.wall,this.oldX,this.oldY,this.startPoint);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);al.moveWallPoint(this.wall,this.newX,this.newY,this.startPoint);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};return bg}(LocalizedUndoableEdit));al.WallResizingUndoableEdit=G;G.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallResizingUndoableEdit";G.__interfaces=["javax.swing.undo.UndoableEdit"];var aM=(function(bh){__extends(bg,bh);function bg(bj,bk,bm,bi,bl){var bn=bh.call(this,bk,al,"undoWallArcExtentName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldArcExtent===undefined){bn.oldArcExtent=null}if(bn.wall===undefined){bn.wall=null}if(bn.newArcExtent===undefined){bn.newArcExtent=null}bn.controller=bj;bn.oldArcExtent=bm;bn.wall=bi;bn.newArcExtent=bl;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.wall.setArcExtent(this.oldArcExtent);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.wall.setArcExtent(this.newArcExtent);this.controller.selectAndShowItems$java_util_List([this.wall].slice(0))};return bg}(LocalizedUndoableEdit));al.WallArcExtentModificationUndoableEdit=aM;aM.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallArcExtentModificationUndoableEdit";aM.__interfaces=["javax.swing.undo.UndoableEdit"];var a=(function(bh){__extends(bg,bh);function bg(bl,bk,bp,bo,bj,bn,bi,bq){var bm=bh.call(this,bk,al,"undoRoomResizeName")||this;if(bm.controller===undefined){bm.controller=null}if(bm.oldX===undefined){bm.oldX=0}if(bm.oldY===undefined){bm.oldY=0}if(bm.room===undefined){bm.room=null}if(bm.pointIndex===undefined){bm.pointIndex=0}if(bm.newX===undefined){bm.newX=0}if(bm.newY===undefined){bm.newY=0}bm.controller=bl;bm.oldX=bp;bm.oldY=bo;bm.room=bj;bm.pointIndex=bn;bm.newX=bi;bm.newY=bq;return bm}bg.prototype.undo=function(){bh.prototype.undo.call(this);al.moveRoomPoint(this.room,this.oldX,this.oldY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);al.moveRoomPoint(this.room,this.newX,this.newY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bg}(LocalizedUndoableEdit));al.RoomResizingUndoableEdit=a;a.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomResizingUndoableEdit";a.__interfaces=["javax.swing.undo.UndoableEdit"];var o=(function(bg){__extends(bh,bg);function bh(bi,bj,bl,bp,bn,bk,bm){var bo=bg.call(this,bj,al,"undoRoomNameOffsetName")||this;if(bo.controller===undefined){bo.controller=null}if(bo.oldNameXOffset===undefined){bo.oldNameXOffset=0}if(bo.oldNameYOffset===undefined){bo.oldNameYOffset=0}if(bo.room===undefined){bo.room=null}if(bo.newNameXOffset===undefined){bo.newNameXOffset=0}if(bo.newNameYOffset===undefined){bo.newNameYOffset=0}bo.controller=bi;bo.oldNameXOffset=bl;bo.oldNameYOffset=bp;bo.room=bn;bo.newNameXOffset=bk;bo.newNameYOffset=bm;return bo}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.room.setNameXOffset(this.oldNameXOffset);this.room.setNameYOffset(this.oldNameYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.room.setNameXOffset(this.newNameXOffset);this.room.setNameYOffset(this.newNameYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bh}(LocalizedUndoableEdit));al.RoomNameOffsetModificationUndoableEdit=o;o.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameOffsetModificationUndoableEdit";o.__interfaces=["javax.swing.undo.UndoableEdit"];var am=(function(bh){__extends(bg,bh);function bg(bi,bj,bm,bl,bk){var bn=bh.call(this,bj,al,"undoRoomNameRotationName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldNameAngle===undefined){bn.oldNameAngle=0}if(bn.room===undefined){bn.room=null}if(bn.newNameAngle===undefined){bn.newNameAngle=0}bn.controller=bi;bn.oldNameAngle=bm;bn.room=bl;bn.newNameAngle=bk;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.room.setNameAngle(this.oldNameAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.room.setNameAngle(this.newNameAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bg}(LocalizedUndoableEdit));al.RoomNameRotationUndoableEdit=am;am.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameRotationUndoableEdit";am.__interfaces=["javax.swing.undo.UndoableEdit"];var at=(function(bh){__extends(bg,bh);function bg(bi,bj,bl,bo,bn,bk,bm){var bp=bh.call(this,bj,al,"undoRoomAreaOffsetName")||this;if(bp.controller===undefined){bp.controller=null}if(bp.oldAreaXOffset===undefined){bp.oldAreaXOffset=0}if(bp.oldAreaYOffset===undefined){bp.oldAreaYOffset=0}if(bp.room===undefined){bp.room=null}if(bp.newAreaXOffset===undefined){bp.newAreaXOffset=0}if(bp.newAreaYOffset===undefined){bp.newAreaYOffset=0}bp.controller=bi;bp.oldAreaXOffset=bl;bp.oldAreaYOffset=bo;bp.room=bn;bp.newAreaXOffset=bk;bp.newAreaYOffset=bm;return bp}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.room.setAreaXOffset(this.oldAreaXOffset);this.room.setAreaYOffset(this.oldAreaYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.room.setAreaXOffset(this.newAreaXOffset);this.room.setAreaYOffset(this.newAreaYOffset);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bg}(LocalizedUndoableEdit));al.RoomAreaOffsetModificationUndoableEdit=at;at.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaOffsetModificationUndoableEdit";at.__interfaces=["javax.swing.undo.UndoableEdit"];var aa=(function(bh){__extends(bg,bh);function bg(bi,bj,bl,bm,bk){var bn=bh.call(this,bj,al,"undoRoomAreaRotationName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldAreaAngle===undefined){bn.oldAreaAngle=0}if(bn.room===undefined){bn.room=null}if(bn.newAreaAngle===undefined){bn.newAreaAngle=0}bn.controller=bi;bn.oldAreaAngle=bl;bn.room=bm;bn.newAreaAngle=bk;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.room.setAreaAngle(this.oldAreaAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.room.setAreaAngle(this.newAreaAngle);this.controller.selectAndShowItems$java_util_List([this.room].slice(0))};return bg}(LocalizedUndoableEdit));al.RoomAreaRotationUndoableEdit=aa;aa.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaRotationUndoableEdit";aa.__interfaces=["javax.swing.undo.UndoableEdit"];var a5=(function(bh){__extends(bg,bh);function bg(bi,bj,bl,bm,bk,bo){var bn=bh.call(this,bj,al,"undoPieceOfFurnitureRotationName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldAngle===undefined){bn.oldAngle=0}if(bn.oldDoorOrWindowBoundToWall===undefined){bn.oldDoorOrWindowBoundToWall=false}if(bn.piece===undefined){bn.piece=null}if(bn.newAngle===undefined){bn.newAngle=0}bn.controller=bi;bn.oldAngle=bl;bn.oldDoorOrWindowBoundToWall=bm;bn.piece=bk;bn.newAngle=bo;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.piece.setAngle(this.oldAngle);if(this.piece!=null&&this.piece instanceof HomeDoorOrWindow){this.piece.setBoundToWall(this.oldDoorOrWindowBoundToWall)}this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.piece.setAngle(this.newAngle);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return bg}(LocalizedUndoableEdit));al.PieceOfFurnitureRotationUndoableEdit=a5;a5.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRotationUndoableEdit";a5.__interfaces=["javax.swing.undo.UndoableEdit"];var aB=(function(bg){__extends(bh,bg);function bh(bo,bn,bk,bm,bs,br,bt,bl,bq,bj,bi){var bp=bg.call(this,bn,al,"undoPieceOfFurnitureRotationName")||this;if(bp.controller===undefined){bp.controller=null}if(bp.oldPitch===undefined){bp.oldPitch=0}if(bp.oldWidthInPlan===undefined){bp.oldWidthInPlan=0}if(bp.oldDepthInPlan===undefined){bp.oldDepthInPlan=0}if(bp.oldHeightInPlan===undefined){bp.oldHeightInPlan=0}if(bp.piece===undefined){bp.piece=null}if(bp.newPitch===undefined){bp.newPitch=0}if(bp.newWidthInPlan===undefined){bp.newWidthInPlan=0}if(bp.newDepthInPlan===undefined){bp.newDepthInPlan=0}if(bp.newHeightInPlan===undefined){bp.newHeightInPlan=0}bp.controller=bo;bp.oldPitch=bk;bp.oldWidthInPlan=bm;bp.oldDepthInPlan=bs;bp.oldHeightInPlan=br;bp.piece=bt;bp.newPitch=bl;bp.newWidthInPlan=bq;bp.newDepthInPlan=bj;bp.newHeightInPlan=bi;return bp}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.setPieceOfFurniturePitch(this.piece,this.oldPitch,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.controller.setPieceOfFurniturePitch(this.piece,this.newPitch,this.newWidthInPlan,this.newDepthInPlan,this.newHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return bh}(LocalizedUndoableEdit));al.PieceOfFurniturePitchRotationUndoableEdit=aB;aB.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurniturePitchRotationUndoableEdit";aB.__interfaces=["javax.swing.undo.UndoableEdit"];var f=(function(bh){__extends(bg,bh);function bg(bn,bm,bk,bl,bs,br,bt,bq,bp,bj,bi){var bo=bh.call(this,bm,al,"undoPieceOfFurnitureRotationName")||this;if(bo.controller===undefined){bo.controller=null}if(bo.oldRoll===undefined){bo.oldRoll=0}if(bo.oldWidthInPlan===undefined){bo.oldWidthInPlan=0}if(bo.oldDepthInPlan===undefined){bo.oldDepthInPlan=0}if(bo.oldHeightInPlan===undefined){bo.oldHeightInPlan=0}if(bo.piece===undefined){bo.piece=null}if(bo.newRoll===undefined){bo.newRoll=0}if(bo.newWidthInPlan===undefined){bo.newWidthInPlan=0}if(bo.newDepthInPlan===undefined){bo.newDepthInPlan=0}if(bo.newHeightInPlan===undefined){bo.newHeightInPlan=0}bo.controller=bn;bo.oldRoll=bk;bo.oldWidthInPlan=bl;bo.oldDepthInPlan=bs;bo.oldHeightInPlan=br;bo.piece=bt;bo.newRoll=bq;bo.newWidthInPlan=bp;bo.newDepthInPlan=bj;bo.newHeightInPlan=bi;return bo}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.controller.setPieceOfFurnitureRoll(this.piece,this.oldRoll,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.controller.setPieceOfFurnitureRoll(this.piece,this.newRoll,this.newWidthInPlan,this.newDepthInPlan,this.newHeightInPlan);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return bg}(LocalizedUndoableEdit));al.PieceOfFurnitureRollRotationUndoableEdit=f;f.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRollRotationUndoableEdit";f.__interfaces=["javax.swing.undo.UndoableEdit"];var v=(function(bg){__extends(bh,bg);function bh(bi,bj,bl,bm,bk){var bn=bg.call(this,bj,al,bl<bk?"undoPieceOfFurnitureRaiseName":"undoPieceOfFurnitureLowerName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldElevation===undefined){bn.oldElevation=0}if(bn.piece===undefined){bn.piece=null}if(bn.newElevation===undefined){bn.newElevation=0}bn.controller=bi;bn.oldElevation=bl;bn.piece=bm;bn.newElevation=bk;return bn}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.piece.setElevation(this.oldElevation);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.piece.setElevation(this.newElevation);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return bh}(LocalizedUndoableEdit));al.PieceOfFurnitureElevationModificationUndoableEdit=v;v.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureElevationModificationUndoableEdit";v.__interfaces=["javax.swing.undo.UndoableEdit"];var Q=(function(bg){__extends(bh,bg);function bh(bm,bl,bq,bs,bn,bj,br,bk,bp,bi){var bo=bg.call(this,bl,al,bq)||this;if(bo.controller===undefined){bo.controller=null}if(bo.doorOrWindowBoundToWall===undefined){bo.doorOrWindowBoundToWall=false}if(bo.resizedPiece===undefined){bo.resizedPiece=null}if(bo.newX===undefined){bo.newX=0}if(bo.newY===undefined){bo.newY=0}if(bo.newWidth===undefined){bo.newWidth=0}if(bo.newDepth===undefined){bo.newDepth=0}if(bo.newHeight===undefined){bo.newHeight=0}bo.controller=bm;bo.doorOrWindowBoundToWall=bs;bo.resizedPiece=bn;bo.newX=bj;bo.newY=br;bo.newWidth=bk;bo.newDepth=bp;bo.newHeight=bi;return bo}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.controller.resetPieceOfFurnitureSize(this.resizedPiece);this.controller.selectAndShowItems$java_util_List([this.resizedPiece.getPieceOfFurniture()].slice(0))};bh.prototype.redo=function(){bg.prototype.redo.call(this);var bi=this.resizedPiece.getPieceOfFurniture();bi.setX(this.newX);bi.setY(this.newY);this.controller.setPieceOfFurnitureSize(this.resizedPiece,this.newWidth,this.newDepth,this.newHeight);if(bi!=null&&bi instanceof HomeDoorOrWindow){bi.setBoundToWall(this.doorOrWindowBoundToWall)}this.controller.selectAndShowItems$java_util_List([bi].slice(0))};return bh}(LocalizedUndoableEdit));al.PieceOfFurnitureResizingUndoableEdit=Q;Q.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureResizingUndoableEdit";Q.__interfaces=["javax.swing.undo.UndoableEdit"];var aC=(function(bh){__extends(bg,bh);function bg(bk,bl,bj,bi,bm){var bn=bh.call(this,bl,al,"undoLightPowerModificationName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldPower===undefined){bn.oldPower=0}if(bn.light===undefined){bn.light=null}if(bn.newPower===undefined){bn.newPower=0}bn.controller=bk;bn.oldPower=bj;bn.light=bi;bn.newPower=bm;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.light.setPower(this.oldPower);this.controller.selectAndShowItems$java_util_List([this.light].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.light.setPower(this.newPower);this.controller.selectAndShowItems$java_util_List([this.light].slice(0))};return bg}(LocalizedUndoableEdit));al.LightPowerModificationUndoableEdit=aC;aC.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LightPowerModificationUndoableEdit";aC.__interfaces=["javax.swing.undo.UndoableEdit"];var z=(function(bh){__extends(bg,bh);function bg(bi,bj,bm,bp,bk,bl,bn){var bo=bh.call(this,bj,al,"undoPieceOfFurnitureNameOffsetName")||this;if(bo.controller===undefined){bo.controller=null}if(bo.oldNameXOffset===undefined){bo.oldNameXOffset=0}if(bo.oldNameYOffset===undefined){bo.oldNameYOffset=0}if(bo.piece===undefined){bo.piece=null}if(bo.newNameXOffset===undefined){bo.newNameXOffset=0}if(bo.newNameYOffset===undefined){bo.newNameYOffset=0}bo.controller=bi;bo.oldNameXOffset=bm;bo.oldNameYOffset=bp;bo.piece=bk;bo.newNameXOffset=bl;bo.newNameYOffset=bn;return bo}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.piece.setNameXOffset(this.oldNameXOffset);this.piece.setNameYOffset(this.oldNameYOffset);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.piece.setNameXOffset(this.newNameXOffset);this.piece.setNameYOffset(this.newNameYOffset);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return bg}(LocalizedUndoableEdit));al.PieceOfFurnitureNameOffsetModificationUndoableEdit=z;z.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameOffsetModificationUndoableEdit";z.__interfaces=["javax.swing.undo.UndoableEdit"];var ag=(function(bg){__extends(bh,bg);function bh(bi,bj,bm,bk,bl){var bn=bg.call(this,bj,al,"undoPieceOfFurnitureNameRotationName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldNameAngle===undefined){bn.oldNameAngle=0}if(bn.piece===undefined){bn.piece=null}if(bn.newNameAngle===undefined){bn.newNameAngle=0}bn.controller=bi;bn.oldNameAngle=bm;bn.piece=bk;bn.newNameAngle=bl;return bn}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.piece.setNameAngle(this.oldNameAngle);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.piece.setNameAngle(this.newNameAngle);this.controller.selectAndShowItems$java_util_List([this.piece].slice(0))};return bh}(LocalizedUndoableEdit));al.PieceOfFurnitureNameRotationUndoableEdit=ag;ag.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameRotationUndoableEdit";ag.__interfaces=["javax.swing.undo.UndoableEdit"];var a4=(function(bh){__extends(bg,bh);function bg(bm,bl,bq,bp,bo,bi,br,bj,bk){var bn=bh.call(this,bl,al,"undoDimensionLineResizeName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldX===undefined){bn.oldX=0}if(bn.oldY===undefined){bn.oldY=0}if(bn.dimensionLine===undefined){bn.dimensionLine=null}if(bn.newX===undefined){bn.newX=0}if(bn.newY===undefined){bn.newY=0}if(bn.startPoint===undefined){bn.startPoint=false}if(bn.reversed===undefined){bn.reversed=false}bn.controller=bm;bn.oldX=bq;bn.oldY=bp;bn.dimensionLine=bo;bn.newX=bi;bn.newY=br;bn.startPoint=bj;bn.reversed=bk;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);if(this.reversed){al.reverseDimensionLine(this.dimensionLine);al.moveDimensionLinePoint(this.dimensionLine,this.oldX,this.oldY,!this.startPoint)}else{al.moveDimensionLinePoint(this.dimensionLine,this.oldX,this.oldY,this.startPoint)}this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);if(this.reversed){al.moveDimensionLinePoint(this.dimensionLine,this.newX,this.newY,!this.startPoint);al.reverseDimensionLine(this.dimensionLine)}else{al.moveDimensionLinePoint(this.dimensionLine,this.newX,this.newY,this.startPoint)}this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};return bg}(LocalizedUndoableEdit));al.DimensionLineResizingUndoableEdit=a4;a4.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineResizingUndoableEdit";a4.__interfaces=["javax.swing.undo.UndoableEdit"];var aA=(function(bg){__extends(bh,bg);function bh(bj,bk,bl,bi,bn){var bm=bg.call(this,bk,al,"undoDimensionLineOffsetName")||this;if(bm.controller===undefined){bm.controller=null}if(bm.oldOffset===undefined){bm.oldOffset=0}if(bm.dimensionLine===undefined){bm.dimensionLine=null}if(bm.newOffset===undefined){bm.newOffset=0}bm.controller=bj;bm.oldOffset=bl;bm.dimensionLine=bi;bm.newOffset=bn;return bm}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.dimensionLine.setOffset(this.oldOffset);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.dimensionLine.setOffset(this.newOffset);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};return bh}(LocalizedUndoableEdit));al.DimensionLineOffsetModificationUndoableEdit=aA;aA.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineOffsetModificationUndoableEdit";aA.__interfaces=["javax.swing.undo.UndoableEdit"];var ao=(function(bh){__extends(bg,bh);function bg(bj,bk,bl,bi,bm){var bn=bh.call(this,bk,al,"undoDimensionLineRotationName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldPitch===undefined){bn.oldPitch=0}if(bn.dimensionLine===undefined){bn.dimensionLine=null}if(bn.newPitch===undefined){bn.newPitch=0}bn.controller=bj;bn.oldPitch=bl;bn.dimensionLine=bi;bn.newPitch=bm;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.dimensionLine.setPitch(this.oldPitch);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.dimensionLine.setPitch(this.newPitch);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};return bg}(LocalizedUndoableEdit));al.DimensionLinePitchRotationUndoableEdit=ao;ao.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLinePitchRotationUndoableEdit";ao.__interfaces=["javax.swing.undo.UndoableEdit"];var c=(function(bh){__extends(bg,bh);function bg(bk,bl,bn,bi,bj){var bm=bh.call(this,bl,al,"undoDimensionLineHeightResizeName")||this;if(bm.controller===undefined){bm.controller=null}if(bm.oldHeight===undefined){bm.oldHeight=0}if(bm.dimensionLine===undefined){bm.dimensionLine=null}if(bm.newHeight===undefined){bm.newHeight=0}bm.controller=bk;bm.oldHeight=bn;bm.dimensionLine=bi;bm.newHeight=bj;return bm}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.dimensionLine.setElevationEnd(this.dimensionLine.getElevationStart()+this.oldHeight);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.dimensionLine.setElevationEnd(this.dimensionLine.getElevationStart()+this.newHeight);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};return bg}(LocalizedUndoableEdit));al.DimensionLineHeightResizingUndoableEdit=c;c.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineHeightResizingUndoableEdit";c.__interfaces=["javax.swing.undo.UndoableEdit"];var ax=(function(bh){__extends(bg,bh);function bg(bj,bk,bm,bi,bl){var bn=bh.call(this,bk,al,bm<bl?"undoDimensionLineRaiseName":"undoDimensionLineLowerName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldElevation===undefined){bn.oldElevation=0}if(bn.dimensionLine===undefined){bn.dimensionLine=null}if(bn.newElevation===undefined){bn.newElevation=0}bn.controller=bj;bn.oldElevation=bm;bn.dimensionLine=bi;bn.newElevation=bl;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.dimensionLine.setElevationStart(this.oldElevation);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.dimensionLine.setElevationStart(this.newElevation);this.controller.selectAndShowItems$java_util_List([this.dimensionLine].slice(0))};return bg}(LocalizedUndoableEdit));al.DimensionLineElevationModificationUndoableEdit=ax;ax.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineElevationModificationUndoableEdit";ax.__interfaces=["javax.swing.undo.UndoableEdit"];var w=(function(bh){__extends(bg,bh);function bg(bk,bj,bp,bo,bn,bm,bi,bq){var bl=bh.call(this,bj,al,"undoPolylineResizeName")||this;if(bl.controller===undefined){bl.controller=null}if(bl.oldX===undefined){bl.oldX=0}if(bl.oldY===undefined){bl.oldY=0}if(bl.polyline===undefined){bl.polyline=null}if(bl.pointIndex===undefined){bl.pointIndex=0}if(bl.newX===undefined){bl.newX=0}if(bl.newY===undefined){bl.newY=0}bl.controller=bk;bl.oldX=bp;bl.oldY=bo;bl.polyline=bn;bl.pointIndex=bm;bl.newX=bi;bl.newY=bq;return bl}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.polyline.setPoint(this.oldX,this.oldY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.polyline].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.polyline.setPoint(this.newX,this.newY,this.pointIndex);this.controller.selectAndShowItems$java_util_List([this.polyline].slice(0))};return bg}(LocalizedUndoableEdit));al.PolylineResizingUndoableEdit=w;w.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineResizingUndoableEdit";w.__interfaces=["javax.swing.undo.UndoableEdit"];var h=(function(bh){__extends(bg,bh);function bg(bk,bl,bj,bm,bi){var bn=bh.call(this,bl,al,"undoCompassRotationName")||this;if(bn.controller===undefined){bn.controller=null}if(bn.oldNorthDirection===undefined){bn.oldNorthDirection=0}if(bn.compass===undefined){bn.compass=null}if(bn.newNorthDirection===undefined){bn.newNorthDirection=0}bn.controller=bk;bn.compass=bm;bn.newNorthDirection=bi;bn.oldNorthDirection=bj;return bn}bg.prototype.undo=function(){bh.prototype.undo.call(this);this.compass.setNorthDirection(this.oldNorthDirection);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};bg.prototype.redo=function(){bh.prototype.redo.call(this);this.compass.setNorthDirection(this.newNorthDirection);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};return bg}(LocalizedUndoableEdit));al.CompassRotationUndoableEdit=h;h.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassRotationUndoableEdit";h.__interfaces=["javax.swing.undo.UndoableEdit"];var aq=(function(bg){__extends(bh,bg);function bh(bj,bk,bn,bl,bi){var bm=bg.call(this,bk,al,"undoCompassResizeName")||this;if(bm.controller===undefined){bm.controller=null}if(bm.oldDiameter===undefined){bm.oldDiameter=0}if(bm.compass===undefined){bm.compass=null}if(bm.newDiameter===undefined){bm.newDiameter=0}bm.controller=bj;bm.oldDiameter=bn;bm.compass=bl;bm.newDiameter=bi;return bm}bh.prototype.undo=function(){bg.prototype.undo.call(this);this.compass.setDiameter(this.oldDiameter);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};bh.prototype.redo=function(){bg.prototype.redo.call(this);this.compass.setDiameter(this.newDiameter);this.controller.selectAndShowItems$java_util_List([this.compass].slice(0))};return bh}(LocalizedUndoableEdit));al.CompassResizingUndoableEdit=aq;aq.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassResizingUndoableEdit";aq.__interfaces=["javax.swing.undo.UndoableEdit"];var aZ=(function(){function bg(bj){if(this.piece===undefined){this.piece=null}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.width===undefined){this.width=0}if(this.depth===undefined){this.depth=0}if(this.height===undefined){this.height=0}if(this.doorOrWindowBoundToWall===undefined){this.doorOrWindowBoundToWall=false}if(this.groupFurnitureX===undefined){this.groupFurnitureX=null}if(this.groupFurnitureY===undefined){this.groupFurnitureY=null}if(this.groupFurnitureWidth===undefined){this.groupFurnitureWidth=null}if(this.groupFurnitureDepth===undefined){this.groupFurnitureDepth=null}if(this.groupFurnitureHeight===undefined){this.groupFurnitureHeight=null}this.piece=bj;this.x=bj.getX();this.y=bj.getY();this.width=bj.getWidth();this.depth=bj.getDepth();this.height=bj.getHeight();this.doorOrWindowBoundToWall=(bj!=null&&bj instanceof HomeDoorOrWindow)&&bj.isBoundToWall();if(bj!=null&&bj instanceof HomeFurnitureGroup){var bh=bj.getAllFurniture();this.groupFurnitureX=(function(bm){var bl=[];while(bm-->0){bl.push(0)}return bl})(bh.length);this.groupFurnitureY=(function(bm){var bl=[];while(bm-->0){bl.push(0)}return bl})(bh.length);this.groupFurnitureWidth=(function(bm){var bl=[];while(bm-->0){bl.push(0)}return bl})(bh.length);this.groupFurnitureDepth=(function(bm){var bl=[];while(bm-->0){bl.push(0)}return bl})(bh.length);this.groupFurnitureHeight=(function(bm){var bl=[];while(bm-->0){bl.push(0)}return bl})(bh.length);for(var bi=0;bi<bh.length;bi++){var bk=bh[bi];this.groupFurnitureX[bi]=bk.getX();this.groupFurnitureY[bi]=bk.getY();this.groupFurnitureWidth[bi]=bk.getWidth();this.groupFurnitureDepth[bi]=bk.getDepth();this.groupFurnitureHeight[bi]=bk.getHeight()}}else{this.groupFurnitureX=null;this.groupFurnitureY=null;this.groupFurnitureWidth=null;this.groupFurnitureDepth=null;this.groupFurnitureHeight=null}}bg.prototype.getPieceOfFurniture=function(){return this.piece};bg.prototype.getWidth=function(){return this.width};bg.prototype.getDepth=function(){return this.depth};bg.prototype.getHeight=function(){return this.height};bg.prototype.isDoorOrWindowBoundToWall=function(){return this.doorOrWindowBoundToWall};bg.prototype.reset=function(){this.piece.setX(this.x);this.piece.setY(this.y);bg.setPieceOfFurnitureSize(this.piece,this.width,this.depth,this.height);if(this.piece!=null&&this.piece instanceof HomeDoorOrWindow){this.piece.setBoundToWall(this.doorOrWindowBoundToWall)}if(this.piece!=null&&this.piece instanceof HomeFurnitureGroup){var bh=this.piece.getAllFurniture();for(var bi=0;bi<bh.length;bi++){var bj=bh[bi];if(this.piece.isResizable()){bj.setX(this.groupFurnitureX[bi]);bj.setY(this.groupFurnitureY[bi]);bg.setPieceOfFurnitureSize(bj,this.groupFurnitureWidth[bi],this.groupFurnitureDepth[bi],this.groupFurnitureHeight[bi])}}}};bg.setPieceOfFurnitureSize=function(br,bi,bl,bq){if(br.isHorizontallyRotated()){var bj=bi/br.getWidth();br.scale(bj);br.setWidthInPlan(bj*br.getWidthInPlan());br.setDepthInPlan(bj*br.getDepthInPlan());br.setHeightInPlan(bj*br.getHeightInPlan());if(br!=null&&br instanceof HomeFurnitureGroup){var bn=br.getAllFurniture();for(var bm=0;bm<bn.length;bm++){var bp=bn[bm];bp.setWidthInPlan(bj*bp.getWidthInPlan());bp.setDepthInPlan(bj*bp.getDepthInPlan());bp.setHeightInPlan(bj*bp.getHeightInPlan())}}}else{var bo=br.getWidthInPlan()*bi/br.getWidth();br.setWidth(bi);br.setWidthInPlan(bo);var bh=br.getDepthInPlan()*bl/br.getDepth();br.setDepth(bl);br.setDepthInPlan(bh);var bk=br.getHeightInPlan()*bq/br.getHeight();br.setHeight(bq);br.setHeightInPlan(bk);if(br!=null&&br instanceof HomeFurnitureGroup){var bn=br.getAllFurniture();for(var bm=0;bm<bn.length;bm++){var bp=bn[bm];bp.setWidthInPlan(bp.getWidth());bp.setDepthInPlan(bp.getDepth());bp.setHeightInPlan(bp.getHeight())}}}};return bg}());al.ResizedPieceOfFurniture=aZ;aZ.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ResizedPieceOfFurniture";var av=(function(){function bg(bh){if(this.wall===undefined){this.wall=null}if(this.level===undefined){this.level=null}if(this.xStart===undefined){this.xStart=0}if(this.yStart===undefined){this.yStart=0}if(this.xEnd===undefined){this.xEnd=0}if(this.yEnd===undefined){this.yEnd=0}if(this.wallAtStart===undefined){this.wallAtStart=null}if(this.wallAtEnd===undefined){this.wallAtEnd=null}if(this.joinedAtEndOfWallAtStart===undefined){this.joinedAtEndOfWallAtStart=false}if(this.joinedAtStartOfWallAtEnd===undefined){this.joinedAtStartOfWallAtEnd=false}this.wall=bh;this.level=bh.getLevel();this.xStart=bh.getXStart();this.xEnd=bh.getXEnd();this.yStart=bh.getYStart();this.yEnd=bh.getYEnd();this.wallAtStart=bh.getWallAtStart();this.joinedAtEndOfWallAtStart=this.wallAtStart!=null&&this.wallAtStart.getWallAtEnd()===bh;this.wallAtEnd=bh.getWallAtEnd();this.joinedAtStartOfWallAtEnd=this.wallAtEnd!=null&&this.wallAtEnd.getWallAtStart()===bh}bg.prototype.getWall=function(){return this.wall};bg.prototype.getLevel=function(){return this.level};bg.prototype.getXStart=function(){return this.xStart};bg.prototype.getYStart=function(){return this.yStart};bg.prototype.getXEnd=function(){return this.xEnd};bg.prototype.getYEnd=function(){return this.yEnd};bg.prototype.getWallAtEnd=function(){return this.wallAtEnd};bg.prototype.getWallAtStart=function(){return this.wallAtStart};bg.prototype.isJoinedAtEndOfWallAtStart=function(){return this.joinedAtEndOfWallAtStart};bg.prototype.isJoinedAtStartOfWallAtEnd=function(){return this.joinedAtStartOfWallAtEnd};bg.getJoinedWalls=function(bh){var bj=(function(bl){var bk=[];while(bl-->0){bk.push(null)}return bk})(bh.length);for(var bi=0;bi<bj.length;bi++){bj[bi]=new al.JoinedWall(bh[bi])}return bj};bg.getWalls=function(bj){var bh=(function(bl){var bk=[];while(bl-->0){bk.push(null)}return bk})(bj.length);for(var bi=0;bi<bj.length;bi++){bh[bi]=bj[bi].getWall()}return bh.slice(0)};return bg}());al.JoinedWall=av;av.__class="com.eteks.sweethome3d.viewcontroller.PlanController.JoinedWall";var be=(function(){function bg(bm,bp,bu,bs,bw,bt,bB){if(((typeof bm==="number")||bm===null)&&((typeof bp==="number")||bp===null)&&((typeof bu==="number")||bu===null)&&((typeof bs==="number")||bs===null)&&((bw!=null)||bw===null)&&((typeof bt==="number")||bt===null)&&((typeof bB==="number")||bB===null)){var bn=arguments;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.angle===undefined){this.angle=0}this.x=bu;this.y=bs;if(bm===bu){var bx=bw.getMagnetizedLength(Math.abs(bp-bs),bt);this.y=bp+(bx*(function(bG){if(bG>0){return 1}else{if(bG<0){return -1}else{return 0}}})(bs-bp))}else{if(bp===bs){var bx=bw.getMagnetizedLength(Math.abs(bm-bu),bt);this.x=bm+(bx*(function(bG){if(bG>0){return 1}else{if(bG<0){return -1}else{return 0}}})(bu-bm))}else{var bv=2*Math.PI/bB;var bE=Math.atan2(bp-bs,bu-bm);var bq=Math.floor(bE/bv)*bv;var bj=void 0;var bz=void 0;var bh=void 0;var by=void 0;if(Math.tan(bE)>0){bj=bq;bz=Math.tan(bq);bh=bq+bv;by=Math.tan(bq+bv)}else{bj=bq+bv;bz=Math.tan(bq+bv);bh=bq;by=Math.tan(bq)}var br=Math.abs(bz);var bo=Math.abs(by);var bl=Math.abs(bm-bu);var bA=Math.abs(bp-bs);var bk=0;if(bo>1e-10){bk=(bA/bo)}var bC=0;if(br<10000000000){bC=(bl*br)}var bD=void 0;if(Math.abs(bk-bl)<Math.abs(bC-bA)){bD=bh;this.x=bm+((bp-bs)/by)}else{bD=bj;this.y=bp-((bu-bm)*bz)}var bx=bw.getMagnetizedLength(java.awt.geom.Point2D.distance(bm,bp,this.x,this.y),bt);this.x=bm+(bx*Math.cos(bD));this.y=bp-(bx*Math.sin(bD));this.angle=bD}}}else{if(((typeof bm==="number")||bm===null)&&((typeof bp==="number")||bp===null)&&((typeof bu==="number")||bu===null)&&((typeof bs==="number")||bs===null)&&((bw!=null)||bw===null)&&((typeof bt==="number")||bt===null)&&bB===undefined){var bn=arguments;var bF=arguments;var bi=bg.CIRCLE_STEPS_15_DEG;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.angle===undefined){this.angle=0}this.x=bu;this.y=bs;if(bm===bu){var bx=bw.getMagnetizedLength(Math.abs(bp-bs),bt);this.y=bp+(bx*(function(bG){if(bG>0){return 1}else{if(bG<0){return -1}else{return 0}}})(bs-bp))}else{if(bp===bs){var bx=bw.getMagnetizedLength(Math.abs(bm-bu),bt);this.x=bm+(bx*(function(bG){if(bG>0){return 1}else{if(bG<0){return -1}else{return 0}}})(bu-bm))}else{var bv=2*Math.PI/bi;var bE=Math.atan2(bp-bs,bu-bm);var bq=Math.floor(bE/bv)*bv;var bj=void 0;var bz=void 0;var bh=void 0;var by=void 0;if(Math.tan(bE)>0){bj=bq;bz=Math.tan(bq);bh=bq+bv;by=Math.tan(bq+bv)}else{bj=bq+bv;bz=Math.tan(bq+bv);bh=bq;by=Math.tan(bq)}var br=Math.abs(bz);var bo=Math.abs(by);var bl=Math.abs(bm-bu);var bA=Math.abs(bp-bs);var bk=0;if(bo>1e-10){bk=(bA/bo)}var bC=0;if(br<10000000000){bC=(bl*br)}var bD=void 0;if(Math.abs(bk-bl)<Math.abs(bC-bA)){bD=bh;this.x=bm+((bp-bs)/by)}else{bD=bj;this.y=bp-((bu-bm)*bz)}var bx=bw.getMagnetizedLength(java.awt.geom.Point2D.distance(bm,bp,this.x,this.y),bt);this.x=bm+(bx*Math.cos(bD));this.y=bp-(bx*Math.sin(bD));this.angle=bD}}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.angle===undefined){this.angle=0}}else{throw new Error("invalid overload")}}}bg.prototype.getX=function(){return this.x};bg.prototype.setX=function(bh){this.x=bh};bg.prototype.getY=function(){return this.y};bg.prototype.setY=function(bh){this.y=bh};bg.prototype.getAngle=function(){return this.angle};bg.CIRCLE_STEPS_15_DEG=24;return bg}());al.PointWithAngleMagnetism=be;be.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PointWithAngleMagnetism";var aS=(function(){function bg(bj,br,bp,bv,bu){if(((br!=null&&br instanceof Room)||br===null)&&((typeof bp==="number")||bp===null)&&((typeof bv==="number")||bv===null)&&((typeof bu==="number")||bu===null)){var bo=Array.prototype.slice.call(arguments,[1]);if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.magnetized===undefined){this.magnetized=false}var bl=bj.getSelectionMargin();var bw=1.7976931348623157e+308;var bq=bj.getRoomPathsFromWalls();for(var bn=0;bn<bq.length;bn++){var bm=bq[bn];bw=this.updateMagnetizedPoint(-1,bv,bu,bw,bj.getPathPoints(bm,false))}var bq=bj.getDetectableRoomsAtSelectedLevel();for(var bn=0;bn<bq.length;bn++){var bh=bq[bn];bw=this.updateMagnetizedPoint(bh===br?bp:-1,bv,bu,bw,bh.getPoints())}this.magnetized=bw<=bl*bl;if(!this.magnetized){this.x=bv;this.y=bu}}else{if(((typeof br==="number")||br===null)&&((typeof bp==="number")||bp===null)&&bv===undefined&&bu===undefined){var bo=Array.prototype.slice.call(arguments,[1]);var bt=bo[0];var bx=bo[1];var bk=Array.prototype.slice.call(arguments,[1]);var bs=null;var bi=-1;if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.magnetized===undefined){this.magnetized=false}var bl=bj.getSelectionMargin();var bw=1.7976931348623157e+308;var bq=bj.getRoomPathsFromWalls();for(var bn=0;bn<bq.length;bn++){var bm=bq[bn];bw=this.updateMagnetizedPoint(-1,bt,bx,bw,bj.getPathPoints(bm,false))}var bq=bj.getDetectableRoomsAtSelectedLevel();for(var bn=0;bn<bq.length;bn++){var bh=bq[bn];bw=this.updateMagnetizedPoint(bh===bs?bi:-1,bt,bx,bw,bh.getPoints())}this.magnetized=bw<=bl*bl;if(!this.magnetized){this.x=bt;this.y=bx}if(this.x===undefined){this.x=0}if(this.y===undefined){this.y=0}if(this.magnetized===undefined){this.magnetized=false}}else{throw new Error("invalid overload")}}}bg.prototype.updateMagnetizedPoint=function(bl,bh,bn,bi,bk){for(var bj=0;bj<bk.length;bj++){if(bj!==bl){var bm=java.awt.geom.Point2D.distanceSq(bk[bj][0],bk[bj][1],bh,bn);if(bm<bi){this.x=bk[bj][0];this.y=bk[bj][1];bi=bm}}}return bi};bg.prototype.getX=function(){return this.x};bg.prototype.getY=function(){return this.y};bg.prototype.isMagnetized=function(){return this.magnetized};return bg}());al.PointMagnetizedToClosestWallOrRoomPoint=aS;aS.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PointMagnetizedToClosestWallOrRoomPoint";var A=(function(){function bg(){}bg.prototype.enter=function(){};bg.prototype.exit=function(){};bg.prototype.setMode=function(bh){};bg.prototype.isModificationState=function(){return false};bg.prototype.isBasePlanModificationState=function(){return false};bg.prototype.deleteSelection=function(){};bg.prototype.escape=function(){};bg.prototype.moveSelection=function(bi,bh){};bg.prototype.toggleMagnetism=function(bh){};bg.prototype.setAlignmentActivated=function(bh){};bg.prototype.setDuplicationActivated=function(bh){};bg.prototype.setEditionActivated=function(bh){};bg.prototype.updateEditableProperty=function(bh,bi){};bg.prototype.pressMouse=function(bi,bl,bh,bj,bk){};bg.prototype.releaseMouse=function(bh,bi){};bg.prototype.moveMouse=function(bh,bi){};bg.prototype.zoom=function(bh){};return bg}());al.ControllerState=A;A.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ControllerState";var O=(function(bg){__extends(bh,bg);function bh(bk,bA,bi,bt,bo,bn){var br=bg.call(this,bi,bt,bo,bn,bk.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bk.getView().getPixelLength())||this;br.__parent=bk;var bq=al.PIXEL_MARGIN/bk.getScale();var bw=Infinity;var bz=Infinity;var bp=0;var bs=0;var bm=bk.getDetectableWallsAtSelectedLevel();for(var bl=0;bl<bm.length;bl++){var bu=bm[bl];if(bu!==bA){if(Math.abs(br.getX()-bu.getXStart())<bq&&(bA==null||!br.equalsWallPoint(bu.getXStart(),bu.getYStart(),bA))){if(Math.abs(bz)>Math.abs(br.getY()-bu.getYStart())){bp=bu.getXStart();bz=br.getY()-bs}}else{if(Math.abs(br.getX()-bu.getXEnd())<bq&&(bA==null||!br.equalsWallPoint(bu.getXEnd(),bu.getYEnd(),bA))){if(Math.abs(bz)>Math.abs(br.getY()-bu.getYEnd())){bp=bu.getXEnd();bz=br.getY()-bs}}}if(Math.abs(br.getY()-bu.getYStart())<bq&&(bA==null||!br.equalsWallPoint(bu.getXStart(),bu.getYStart(),bA))){if(Math.abs(bw)>Math.abs(br.getX()-bu.getXStart())){bs=bu.getYStart();bw=br.getX()-bp}}else{if(Math.abs(br.getY()-bu.getYEnd())<bq&&(bA==null||!br.equalsWallPoint(bu.getXEnd(),bu.getYEnd(),bA))){if(Math.abs(bw)>Math.abs(br.getX()-bu.getXEnd())){bs=bu.getYEnd();bw=br.getX()-bp}}}}}if(bA!=null){var bj=-Math.tan(br.getAngle());var by=Math.abs(bj)<10000000000?bt-bj*bi:Infinity;if(bw!==Infinity&&Math.abs(bj)>1e-10){var bx=((bs-by)/bj);if(java.awt.geom.Point2D.distanceSq(br.getX(),br.getY(),bx,bs)<=bq*bq){br.setX(bx);br.setY(bs);return br}}if(bz!==Infinity&&by!==Infinity){var bv=(bj*bp+by);if(java.awt.geom.Point2D.distanceSq(br.getX(),br.getY(),bp,bv)<=bq*bq){br.setX(bp);br.setY(bv)}}}else{if(bw!==Infinity){br.setY(bs)}if(bz!==Infinity){br.setX(bp)}}return br}bh.prototype.equalsWallPoint=function(bj,bk,bi){return bj===bi.getXStart()&&bk===bi.getYStart()||bj===bi.getXEnd()&&bk===bi.getYEnd()};return bh}(al.PointWithAngleMagnetism));al.WallPointWithAngleMagnetism=O;O.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallPointWithAngleMagnetism";var j=(function(bg){__extends(bh,bg);function bh(bm,bG,bF,bk,bw,br,bq){var bv=bg.call(this,bk,bw,br,bq,bm.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bm.getView().getPixelLength())||this;bv.__parent=bm;var by=bm.getScale();var bt=al.PIXEL_MARGIN/by;var bz=Infinity;var bj=Infinity;var bp=0;var bs=0;var bo=bm.getDetectableRoomsAtSelectedLevel();for(var bn=0;bn<bo.length;bn++){var bB=bo[bn];var bu=bB.getPoints();for(var bx=0;bx<bu.length;bx++){if(bF===-1||(bx!==bF&&bu.length>2)){if(Math.abs(bv.getX()-bu[bx][0])<bt&&Math.abs(bj)>Math.abs(bv.getY()-bu[bx][1])){bp=bu[bx][0];bj=bv.getY()-bu[bx][1]}if(Math.abs(bv.getY()-bu[bx][1])<bt&&Math.abs(bz)>Math.abs(bv.getX()-bu[bx][0])){bs=bu[bx][1];bz=bv.getX()-bu[bx][0]}}}}var bo=bm.getDetectableWallsAtSelectedLevel();for(var bn=0;bn<bo.length;bn++){var bA=bo[bn];var bi=bA.getPoints$();bi=[bi[0],bi[(bi.length/2|0)-1],bi[(bi.length/2|0)],bi[bi.length-1]];for(var bx=0;bx<bi.length;bx++){if(Math.abs(bv.getX()-bi[bx][0])<bt&&Math.abs(bj)>Math.abs(bv.getY()-bi[bx][1])){bp=bi[bx][0];bj=bv.getY()-bi[bx][1]}if(Math.abs(bv.getY()-bi[bx][1])<bt&&Math.abs(bz)>Math.abs(bv.getX()-bi[bx][0])){bs=bi[bx][1];bz=bv.getX()-bi[bx][0]}}}if(bG!=null){var bl=-Math.tan(bv.getAngle());var bE=Math.abs(bl)<10000000000?bw-bl*bk:Infinity;if(bz!==Infinity&&Math.abs(bl)>1e-10){var bD=((bs-bE)/bl);if(java.awt.geom.Point2D.distanceSq(bv.getX(),bv.getY(),bD,bs)<=bt*bt){bv.setX(bD);bv.setY(bs);return bv}}if(bj!==Infinity&&bE!==Infinity){var bC=(bl*bp+bE);if(java.awt.geom.Point2D.distanceSq(bv.getX(),bv.getY(),bp,bC)<=bt*bt){bv.setX(bp);bv.setY(bC)}}}else{if(bz!==Infinity){bv.setY(bs)}if(bj!==Infinity){bv.setX(bp)}}return bv}return bh}(al.PointWithAngleMagnetism));al.RoomPointWithAngleMagnetism=j;j.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomPointWithAngleMagnetism";var a9=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;if(bj.state===undefined){bj.state=null}bj.state=bi;return bj}bh.prototype.enter=function(){this.state.enter()};bh.prototype.exit=function(){this.state.exit()};bh.prototype.getMode=function(){return this.state.getMode()};bh.prototype.setMode=function(bi){this.state.setMode(bi)};bh.prototype.isModificationState=function(){return this.state.isModificationState()};bh.prototype.isBasePlanModificationState=function(){return this.state.isBasePlanModificationState()};bh.prototype.deleteSelection=function(){this.state.deleteSelection()};bh.prototype.escape=function(){this.state.escape()};bh.prototype.moveSelection=function(bj,bi){this.state.moveSelection(bj,bi)};bh.prototype.toggleMagnetism=function(bi){this.state.toggleMagnetism(bi)};bh.prototype.setAlignmentActivated=function(bi){this.state.setAlignmentActivated(bi)};bh.prototype.setDuplicationActivated=function(bi){this.state.setDuplicationActivated(bi)};bh.prototype.setEditionActivated=function(bi){this.state.setEditionActivated(bi)};bh.prototype.updateEditableProperty=function(bi,bj){this.state.updateEditableProperty(bi,bj)};bh.prototype.pressMouse=function(bj,bm,bi,bk,bl){this.state.pressMouse(bj,bm,bi,bk,bl)};bh.prototype.releaseMouse=function(bi,bj){this.state.releaseMouse(bi,bj)};bh.prototype.moveMouse=function(bi,bj){this.state.moveMouse(bi,bj)};bh.prototype.zoom=function(bi){this.state.zoom(bi)};return bh}(al.ControllerState));al.ControllerStateDecorator=a9;a9.__class="com.eteks.sweethome3d.viewcontroller.PlanController.ControllerStateDecorator";var aH=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;return bj}bg.prototype.setMode=function(bi){if(bi===al.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bi===al.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bi===al.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bi===al.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bi===al.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bi===al.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bi===al.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}}};bg.prototype.deleteSelection=function(){this.__parent.deleteItems(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems());this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.moveSelection=function(bj,bi){this.__parent.moveAndShowSelectedItems(bj,bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.zoom=function(bi){this.__parent.setScale(this.__parent.getScale()*bi)};return bg}(al.ControllerState));al.AbstractModeChangeState=aH;aH.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractModeChangeState";var aD=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.xLastMouseMove===undefined){bj.xLastMouseMove=0}if(bj.yLastMouseMove===undefined){bj.yLastMouseMove=0}if(bj.mouseMoved===undefined){bj.mouseMoved=false}if(bj.oldSelection===undefined){bj.oldSelection=null}if(bj.selectionUpdateNeeded===undefined){bj.selectionUpdateNeeded=false}if(bj.movedItems===undefined){bj.movedItems=null}if(bj.duplicatedItems===undefined){bj.duplicatedItems=null}if(bj.movedPieceOfFurniture===undefined){bj.movedPieceOfFurniture=null}if(bj.angleMovedPieceOfFurniture===undefined){bj.angleMovedPieceOfFurniture=0}if(bj.depthMovedPieceOfFurniture===undefined){bj.depthMovedPieceOfFurniture=0}if(bj.elevationMovedPieceOfFurniture===undefined){bj.elevationMovedPieceOfFurniture=0}if(bj.xMovedPieceOfFurniture===undefined){bj.xMovedPieceOfFurniture=0}if(bj.yMovedPieceOfFurniture===undefined){bj.yMovedPieceOfFurniture=0}if(bj.movedDoorOrWindowBoundToWall===undefined){bj.movedDoorOrWindowBoundToWall=false}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.duplicationActivated===undefined){bj.duplicationActivated=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}if(bj.basePlanModification===undefined){bj.basePlanModification=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return this.basePlanModification};bg.prototype.enter=function(){this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.mouseMoved=false;var bo=this.__parent.getSelectableItemsAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());var bi=(bo.slice(0));var bn=this.__parent.getSelectionMargin();for(var bk=0;bk<bo.length;bk++){var bp=bo[bk];if(bp!=null&&bp instanceof HomeFurnitureGroup){var bl=bp.getAllFurniture();for(var bm=0;bm<bl.length;bm++){var bq=bl[bm];if(bq.containsPoint(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bn)){(bi.push(bq)>0)}}}}this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());this.selectionUpdateNeeded=(function(bt,bs){for(var br=0;br<bt.length;br++){if(bs.indexOf(bt[br])>=0){return false}}return true})(bi,this.oldSelection);if(this.selectionUpdateNeeded&&this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.__parent.selectItem(this.__parent.getSelectableItemAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),false))}var bj=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.movedItems=([]);this.basePlanModification=false;for(var bk=0;bk<bj.length;bk++){var bp=bj[bk];if(this.__parent.isItemMovable(bp)){(this.movedItems.push(bp)>0);if(!this.basePlanModification&&this.__parent.isItemPartOfBasePlan(bp)){this.basePlanModification=true}}}if(this.movedItems.length===1&&(this.movedItems[0]!=null&&this.movedItems[0] instanceof HomePieceOfFurniture)){this.movedPieceOfFurniture=this.movedItems[0];this.xMovedPieceOfFurniture=this.movedPieceOfFurniture.getX();this.yMovedPieceOfFurniture=this.movedPieceOfFurniture.getY();this.angleMovedPieceOfFurniture=this.movedPieceOfFurniture.getAngle();this.depthMovedPieceOfFurniture=this.movedPieceOfFurniture.getDepth();this.elevationMovedPieceOfFurniture=this.movedPieceOfFurniture.getElevation();this.movedDoorOrWindowBoundToWall=(this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isBoundToWall()}this.duplicatedItems=null;this.duplicationActivated=this.__parent.wasDuplicationActivatedLastMousePress()&&!this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();if(!(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded)){this.__parent.getView().setCursor(PlanView.CursorType.MOVE)}};bg.prototype.moveMouse=function(bi,bn){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded){this.__parent.setState(new bg.SelectionMoveState$0(this,this.__parent.getPanningState()))}else{if(!this.mouseMoved){this.toggleDuplication(this.duplicationActivated)}if(this.alignmentActivated){var bj=new al.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bi,bn,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bi=bj.getX();bn=bj.getY()}if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture);this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture);this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture);if((this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)){this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture)}this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture);this.movedPieceOfFurniture.move(bi-this.__parent.getXLastMousePress(),bn-this.__parent.getYLastMousePress());if(this.magnetismEnabled&&!this.alignmentActivated){var bm=this.__parent.adjustPieceOfFurnitureElevation(this.movedPieceOfFurniture,true,3.4028235e+38)!=null;var bl=this.__parent.adjustPieceOfFurnitureOnWallAt(this.movedPieceOfFurniture,bi,bn,false);var bk=null;if(!bm){bk=this.__parent.adjustPieceOfFurnitureSideBySideAt(this.movedPieceOfFurniture,false,bl)}if(bk==null){this.__parent.adjustPieceOfFurnitureInShelfBox(this.movedPieceOfFurniture,false)}if(this.__parent.feedbackDisplayed&&bl!=null){this.__parent.getView().setDimensionLinesFeedback(this.__parent.getDimensionLinesAlongWall(this.movedPieceOfFurniture,bl))}else{this.__parent.getView().setDimensionLinesFeedback(null)}}}else{this.__parent.moveItems(this.movedItems,bi-this.xLastMouseMove,bn-this.yLastMouseMove)}if(!this.mouseMoved){this.__parent.selectItems(this.movedItems,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}this.__parent.getView().makePointVisible(bi,bn);this.xLastMouseMove=bi;this.yLastMouseMove=bn;this.mouseMoved=true}};bg.prototype.releaseMouse=function(bi,bk){if(this.mouseMoved){if(this.movedItems.length>0&&!(this.movedItems[0]!=null&&this.movedItems[0] instanceof Camera)){if(this.duplicatedItems!=null){this.__parent.postItemsDuplication(this.movedItems,this.duplicatedItems)}else{if(this.movedPieceOfFurniture!=null){this.__parent.postPieceOfFurnitureMove(this.movedPieceOfFurniture,this.movedPieceOfFurniture.getX()-this.xMovedPieceOfFurniture,this.movedPieceOfFurniture.getY()-this.yMovedPieceOfFurniture,this.angleMovedPieceOfFurniture,this.depthMovedPieceOfFurniture,this.elevationMovedPieceOfFurniture,this.movedDoorOrWindowBoundToWall)}else{this.__parent.postItemsMove(this.movedItems,this.oldSelection,this.xLastMouseMove-this.__parent.getXLastMousePress(),this.yLastMouseMove-this.__parent.getYLastMousePress())}}}}else{if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH||!(function(bn,bm){for(var bl=0;bl<bn.length;bl++){if(bm.indexOf(bn[bl])>=0){return false}}return true})(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems(),this.oldSelection)){var bj=this.__parent.getSelectableItemAt(bi,bk,false);if(bj!=null){this.__parent.selectItem(bj)}else{this.__parent.deselectAll()}}}this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.movedPieceOfFurniture!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());if(!this.magnetismEnabled){this.__parent.getView().deleteFeedback()}}};bg.prototype.escape=function(){if(this.mouseMoved){if(this.duplicatedItems!=null){this.__parent.doDeleteItems(this.movedItems);this.__parent.selectItems(this.duplicatedItems)}else{if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture);this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture);this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture);if((this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)){this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture)}this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture);if(this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow){this.movedPieceOfFurniture.setBoundToWall(this.movedDoorOrWindowBoundToWall)}}else{this.__parent.moveItems(this.movedItems,this.__parent.getXLastMousePress()-this.xLastMouseMove,this.__parent.getYLastMousePress()-this.yLastMouseMove)}}}this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.setDuplicationActivated=function(bi){bi=!this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&bi;if(this.mouseMoved){this.toggleDuplication(bi)}this.duplicationActivated=bi};bg.prototype.setAlignmentActivated=function(bi){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.selectionUpdateNeeded&&!this.duplicationActivated){this.__parent.setState(this.__parent.getSelectionState());this.__parent.pressMouse$float$float$int$boolean$boolean$boolean$boolean$com_eteks_sweethome3d_viewcontroller_View_PointerType(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),1,true,false,false,false,this.__parent.getPointerTypeLastMousePress())}else{this.alignmentActivated=bi;if(this.mouseMoved){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}if(this.alignmentActivated){this.__parent.getView().deleteFeedback()}}};bg.prototype.toggleDuplication=function(bk){if(this.movedItems.length>1||(this.movedItems.length===1&&!(this.movedItems[0]!=null&&this.movedItems[0] instanceof Camera)&&!(this.movedItems[0]!=null&&this.movedItems[0] instanceof Compass))){if(bk&&this.duplicatedItems==null){this.duplicatedItems=this.movedItems;this.movedItems=([]);var bl=Home.duplicate(this.duplicatedItems);for(var bi=0;bi<bl.length;bi++){var bj=bl[bi];if(bj!=null&&bj instanceof Wall){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addWall(bj)}else{if(bj!=null&&bj instanceof Room){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addRoom$com_eteks_sweethome3d_model_Room(bj)}else{if(bj!=null&&bj instanceof Polyline){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPolyline$com_eteks_sweethome3d_model_Polyline(bj)}else{if(bj!=null&&bj instanceof DimensionLine){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addDimensionLine(bj)}else{if(bj!=null&&bj instanceof HomePieceOfFurniture){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addPieceOfFurniture$com_eteks_sweethome3d_model_HomePieceOfFurniture(bj)}else{if(bj!=null&&bj instanceof Label){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addLabel(bj)}else{continue}}}}}}(this.movedItems.push(bj)>0)}if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture.setX(this.xMovedPieceOfFurniture);this.movedPieceOfFurniture.setY(this.yMovedPieceOfFurniture);this.movedPieceOfFurniture.setAngle(this.angleMovedPieceOfFurniture);if((this.movedPieceOfFurniture!=null&&this.movedPieceOfFurniture instanceof HomeDoorOrWindow)&&this.movedPieceOfFurniture.isResizable()&&this.__parent.isItemResizable(this.movedPieceOfFurniture)){this.movedPieceOfFurniture.setDepth(this.depthMovedPieceOfFurniture)}this.movedPieceOfFurniture.setElevation(this.elevationMovedPieceOfFurniture);this.movedPieceOfFurniture=this.movedItems[0]}else{this.__parent.moveItems(this.duplicatedItems,this.__parent.getXLastMousePress()-this.xLastMouseMove,this.__parent.getYLastMousePress()-this.yLastMouseMove)}this.__parent.getView().setCursor(PlanView.CursorType.DUPLICATION)}else{if(!bk&&this.duplicatedItems!=null){this.__parent.doDeleteItems(this.movedItems);this.__parent.moveItems(this.duplicatedItems,this.xLastMouseMove-this.__parent.getXLastMousePress(),this.yLastMouseMove-this.__parent.getYLastMousePress());this.movedItems=this.duplicatedItems;this.duplicatedItems=null;if(this.movedPieceOfFurniture!=null){this.movedPieceOfFurniture=this.movedItems[0]}this.__parent.getView().setCursor(PlanView.CursorType.MOVE)}}this.__parent.selectItems(this.movedItems,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}};bg.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.movedItems=null;this.duplicatedItems=null;this.movedPieceOfFurniture=null};return bg}(al.ControllerState));al.SelectionMoveState=aD;aD.__class="com.eteks.sweethome3d.viewcontroller.PlanController.SelectionMoveState";(function(bh){var bg=(function(bj){__extends(bi,bj);function bi(bk,bl){var bm=bj.call(this,bl)||this;bm.__parent=bk;return bm}bi.prototype.enter=function(){bj.prototype.enter.call(this);this.pressMouse(this.__parent.__parent.getXLastMousePress(),this.__parent.__parent.getYLastMousePress(),1,this.__parent.__parent.wasShiftDownLastMousePress(),this.__parent.__parent.wasDuplicationActivatedLastMousePress());this.moveMouse(this.__parent.__parent.getXLastMouseMove(),this.__parent.__parent.getYLastMouseMove())};bi.prototype.releaseMouse=function(bk,bl){this.escape()};bi.prototype.escape=function(){bj.prototype.escape.call(this);this.__parent.__parent.setState(this.__parent.__parent.getSelectionState())};return bi}(al.ControllerStateDecorator));bh.SelectionMoveState$0=bg})(aD=al.SelectionMoveState||(al.SelectionMoveState={}));var aX=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedItemsMousePressed===undefined){bj.selectedItemsMousePressed=null}if(bj.ignoreRectangleSelection===undefined){bj.ignoreRectangleSelection=false}if(bj.mouseMoved===undefined){bj.mouseMoved=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.enter=function(){var bj=this.__parent.getSelectableItemAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(bj==null&&!this.__parent.wasShiftDownLastMousePress()){this.__parent.deselectAll()}this.selectedItemsMousePressed=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0));var bl=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getFurniture();this.ignoreRectangleSelection=false;for(var bi=0;bi<this.selectedItemsMousePressed.length;bi++){var bk=this.selectedItemsMousePressed[bi];if((bk!=null&&bk instanceof HomePieceOfFurniture)&&!(bl.indexOf((bk))>=0)){this.ignoreRectangleSelection=true;break}}this.mouseMoved=false};bg.prototype.moveMouse=function(bj,bk){this.mouseMoved=true;if(!this.ignoreRectangleSelection){this.updateSelectedItems(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bj,bk,this.selectedItemsMousePressed);if(this.__parent.feedbackDisplayed){var bi=this.__parent.getView();bi.setRectangleFeedback(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bj,bk)}this.__parent.planView.makePointVisible(bj,bk)}};bg.prototype.releaseMouse=function(bi,bm){if(!this.mouseMoved){var bk=this.__parent.getSelectableItemAt(bi,bm,false);if(bk!=null){if((this.selectedItemsMousePressed.indexOf((bk))>=0)){(function(bn){var bo=bn.indexOf(bk);if(bo>=0){bn.splice(bo,1);return true}else{return false}})(this.selectedItemsMousePressed)}else{for(var bj=this.selectedItemsMousePressed.length-1;bj>=0;bj--){var bl=this.selectedItemsMousePressed[bj];if((bl!=null&&bl instanceof Camera)||((bk!=null&&bk instanceof HomePieceOfFurniture)&&(bl!=null&&bl instanceof HomeFurnitureGroup)&&(bl.getAllFurniture().indexOf((bk))>=0))||((bk!=null&&bk instanceof HomeFurnitureGroup)&&(bl!=null&&bl instanceof HomePieceOfFurniture)&&(bk.getAllFurniture().indexOf((bl))>=0))){this.selectedItemsMousePressed.splice(bj,1)[0]}}if(!(bk!=null&&bk instanceof Camera)||this.selectedItemsMousePressed.length===0){(this.selectedItemsMousePressed.push(bk)>0)}}this.__parent.selectItems(this.selectedItemsMousePressed,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&this.__parent.wasShiftDownLastMousePress())}}this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.escape=function(){this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.selectedItemsMousePressed=null};bg.prototype.updateSelectedItems=function(bk,br,bj,bq,bp){var bl;var bm=this.__parent.wasShiftDownLastMousePress();if(bm){bl=(bp.slice(0))}else{bl=([])}var bo=this.__parent.getSelectableItemsIntersectingRectangle(bk,br,bj,bq);var bi=function(bs){var bt=bo[bs];if(!(bt!=null&&bt instanceof Camera)){if(bm){if((bp.indexOf((bt))>=0)){(function(bu){var bv=bu.indexOf(bt);if(bv>=0){bu.splice(bv,1);return true}else{return false}})(bl)}else{(bl.push(bt)>0)}}else{if(!(bp.indexOf((bt))>=0)){(bl.push(bt)>0)}}}};for(var bn=0;bn<bo.length;bn++){bi(bn)}this.__parent.selectItems(bl,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection()&&bm)};return bg}(al.ControllerState));al.RectangleSelectionState=aX;aX.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RectangleSelectionState";var an=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.xLastMouseMove===undefined){bj.xLastMouseMove=null}if(bj.yLastMouseMove===undefined){bj.yLastMouseMove=null}return bj}bg.prototype.getMode=function(){return al.Mode.PANNING_$LI$()};bg.prototype.setMode=function(bi){if(bi===al.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bi===al.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bi===al.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bi===al.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bi===al.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bi===al.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};bg.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.PANNING)};bg.prototype.moveSelection=function(bj,bi){this.__parent.getView().moveView(bj*10,bi*10)};bg.prototype.pressMouse=function(bj,bm,bi,bk,bl){if(bi===1){this.xLastMouseMove=this.__parent.getView().convertXModelToScreen(bj);this.yLastMouseMove=this.__parent.getView().convertYModelToScreen(bm)}else{this.xLastMouseMove=null;this.yLastMouseMove=null}};bg.prototype.moveMouse=function(bi,bl){if(this.xLastMouseMove!=null){var bk=this.__parent.getView().convertXModelToScreen(bi);var bj=this.__parent.getView().convertYModelToScreen(bl);this.__parent.getView().moveView((this.xLastMouseMove-bk)/this.__parent.getScale(),(this.yLastMouseMove-bj)/this.__parent.getScale());this.xLastMouseMove=bk;this.yLastMouseMove=bj}};bg.prototype.releaseMouse=function(bi,bj){this.xLastMouseMove=null};bg.prototype.escape=function(){this.xLastMouseMove=null};bg.prototype.zoom=function(bi){this.__parent.setScale(this.__parent.getScale()*bi)};return bg}(al.ControllerState));al.PanningState=an;an.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PanningState";var a7=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.xLastMouseMove===undefined){bj.xLastMouseMove=0}if(bj.yLastMouseMove===undefined){bj.yLastMouseMove=0}if(bj.draggedPieceOfFurniture===undefined){bj.draggedPieceOfFurniture=null}if(bj.xDraggedPieceOfFurniture===undefined){bj.xDraggedPieceOfFurniture=0}if(bj.yDraggedPieceOfFurniture===undefined){bj.yDraggedPieceOfFurniture=0}if(bj.angleDraggedPieceOfFurniture===undefined){bj.angleDraggedPieceOfFurniture=0}if(bj.depthDraggedPieceOfFurniture===undefined){bj.depthDraggedPieceOfFurniture=0}if(bj.elevationDraggedPieceOfFurniture===undefined){bj.elevationDraggedPieceOfFurniture=0}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return false};bg.prototype.isBasePlanModificationState=function(){return this.draggedPieceOfFurniture!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.draggedPieceOfFurniture)};bg.prototype.enter=function(){this.xLastMouseMove=0;this.yLastMouseMove=0;if(this.__parent.feedbackDisplayed){this.__parent.getView().setDraggedItemsFeedback(this.__parent.draggedItems)}if(this.__parent.draggedItems.length===1&&(this.__parent.draggedItems[0]!=null&&this.__parent.draggedItems[0] instanceof HomePieceOfFurniture)){this.draggedPieceOfFurniture=this.__parent.draggedItems[0];this.xDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getX();this.yDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getY();this.angleDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getAngle();this.depthDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getDepth();this.elevationDraggedPieceOfFurniture=this.draggedPieceOfFurniture.getElevation()}};bg.prototype.moveMouse=function(bi,bn){var bj=(this.__parent.draggedItems.slice(0));this.__parent.moveItems(this.__parent.draggedItems,bi-this.xLastMouseMove,bn-this.yLastMouseMove);if(this.draggedPieceOfFurniture!=null&&this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled()){this.draggedPieceOfFurniture.setX(this.xDraggedPieceOfFurniture);this.draggedPieceOfFurniture.setY(this.yDraggedPieceOfFurniture);this.draggedPieceOfFurniture.setAngle(this.angleDraggedPieceOfFurniture);if(this.draggedPieceOfFurniture.isResizable()){this.draggedPieceOfFurniture.setDepth(this.depthDraggedPieceOfFurniture);this.draggedPieceOfFurniture.setDepthInPlan(this.depthDraggedPieceOfFurniture)}this.draggedPieceOfFurniture.setElevation(this.elevationDraggedPieceOfFurniture);this.draggedPieceOfFurniture.move(bi,bn);var bm=this.__parent.adjustPieceOfFurnitureElevation(this.draggedPieceOfFurniture,false,3.4028235e+38)!=null;var bl=this.__parent.adjustPieceOfFurnitureOnWallAt(this.draggedPieceOfFurniture,bi,bn,true);var bk=null;if(!bm){bk=this.__parent.adjustPieceOfFurnitureSideBySideAt(this.draggedPieceOfFurniture,bl==null,bl)}if(bk==null){this.__parent.adjustPieceOfFurnitureInShelfBox(this.draggedPieceOfFurniture,bl==null)}if(this.__parent.feedbackDisplayed&&bl!=null){this.__parent.getView().setDimensionLinesFeedback(this.__parent.getDimensionLinesAlongWall(this.draggedPieceOfFurniture,bl))}else{this.__parent.getView().setDimensionLinesFeedback(null)}}if(this.__parent.feedbackDisplayed){this.__parent.getView().setDraggedItemsFeedback(bj)}this.xLastMouseMove=bi;this.yLastMouseMove=bn};bg.prototype.exit=function(){this.draggedPieceOfFurniture=null;this.__parent.getView().deleteFeedback()};return bg}(al.ControllerState));al.DragAndDropState=a7;a7.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DragAndDropState";var p=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.wallLengthToolTipFeedback===undefined){bj.wallLengthToolTipFeedback=null}if(bj.wallAngleToolTipFeedback===undefined){bj.wallAngleToolTipFeedback=null}if(bj.wallArcExtentToolTipFeedback===undefined){bj.wallArcExtentToolTipFeedback=null}if(bj.wallThicknessToolTipFeedback===undefined){bj.wallThicknessToolTipFeedback=null}return bj}bg.prototype.enter=function(){this.wallLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"wallLengthToolTipFeedback");try{this.wallAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"wallAngleToolTipFeedback")}catch(bi){}this.wallArcExtentToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"wallArcExtentToolTipFeedback");try{this.wallThicknessToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"wallThicknessToolTipFeedback")}catch(bi){}};bg.prototype.getToolTipFeedbackText=function(bi,bm){var bl=bi.getArcExtent();if(!bm&&bl!=null){return"<html>"+CoreTools.format(this.wallArcExtentToolTipFeedback,Math.round((function(bn){return bn*180/Math.PI})(bl)))}else{var bk=bi.getStartPointToEndPointDistance();var bj="<html>"+CoreTools.format(this.wallLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bk));if(this.wallAngleToolTipFeedback!=null&&this.wallAngleToolTipFeedback.length>0){bj+="<br>"+CoreTools.format(this.wallAngleToolTipFeedback,this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(bi,bk))}if(this.wallThicknessToolTipFeedback!=null&&this.wallThicknessToolTipFeedback.length>0){bj+="<br>"+CoreTools.format(this.wallThicknessToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bi.getThickness()))}return bj}};bg.prototype.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall=function(bi){return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(bi,bi.getStartPointToEndPointDistance())};bg.prototype.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float=function(bn,bi){var bm=bn.getWallAtStart();if(bm!=null){var bp=bm.getStartPointToEndPointDistance();if(bi!==0&&bp!==0){var bq=(bn.getXEnd()-bn.getXStart())/bi;var bk=(bn.getYEnd()-bn.getYStart())/bi;var bl=(bm.getXEnd()-bm.getXStart())/bp;var bj=(bm.getYEnd()-bm.getYStart())/bp;if(bm.getWallAtStart()===bn){bl=-bl;bj=-bj}var bo=(Math.round(180-(function(br){return br*180/Math.PI})(Math.atan2(bk*bl-bq*bj,bq*bl+bk*bj)))|0);if(bo>180){bo-=360}return bo}}if(bi===0){return 0}else{return(Math.round((function(br){return br*180/Math.PI})(Math.atan2(bn.getYStart()-bn.getYEnd(),bn.getXEnd()-bn.getXStart())))|0)}};bg.prototype.getWallAngleInDegrees=function(bi,bj){if(((bi!=null&&bi instanceof Wall)||bi===null)&&((typeof bj==="number")||bj===null)){return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall$float(bi,bj)}else{if(((bi!=null&&bi instanceof Wall)||bi===null)&&bj===undefined){return this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(bi)}else{throw new Error("invalid overload")}}};bg.prototype.getArcExtent=function(bk,br,bj,bq,bs,bp){var bm=this.getCircumscribedCircleCenter(bk,br,bj,bq,bs,bp);var bo=java.awt.geom.Point2D.distance(bk,br,bj,bq)/2;var bn=(function(bu){return Number.NEGATIVE_INFINITY===bu||Number.POSITIVE_INFINITY===bu})(bm[0])||(function(bu){return Number.NEGATIVE_INFINITY===bu||Number.POSITIVE_INFINITY===bu})(bm[1])?Infinity:java.awt.geom.Line2D.ptLineDist(bk,br,bj,bq,bm[0],bm[1]);var bt=java.awt.geom.Line2D.relativeCCW(bk,br,bj,bq,bs,bp);var bi=java.awt.geom.Line2D.relativeCCW(bk,br,bj,bq,bm[0],bm[1]);var bl;if(bi===bt){bl=(Math.PI+2*Math.atan2(bn,bo))}else{bl=(2*Math.atan2(bo,bn))}bl=Math.min(bl,3*Math.PI/2);bl*=bt;return bl};bg.prototype.getCircumscribedCircleCenter=function(bj,bp,bi,bo,bq,bn){var bl=this.getBissectorLine(bj,bp,bi,bo);var bk=this.getBissectorLine(bj,bp,bq,bn);var bm=al.computeIntersection(bl[0],bl[1],bk[0],bk[1]);return bm};bg.prototype.getBissectorLine=function(bk,bm,bj,bl){var bn=(bk+bj)/2;var bi=(bm+bl)/2;var bo=(bk-bj)/(bl-bm);if(bo>10000000000){return[[bn,bi],[bn,bi+1]]}else{return[[bn,bi],[bn+1,bo+bi]]}};bg.prototype.showWallAngleFeedback=function(bi,bl){var bk=bi.getArcExtent();if(!bl&&bk!=null){if(bk<0){this.__parent.getView().setAngleFeedback(bi.getXArcCircleCenter(),bi.getYArcCircleCenter(),bi.getXStart(),bi.getYStart(),bi.getXEnd(),bi.getYEnd())}else{this.__parent.getView().setAngleFeedback(bi.getXArcCircleCenter(),bi.getYArcCircleCenter(),bi.getXEnd(),bi.getYEnd(),bi.getXStart(),bi.getYStart())}}else{if(this.wallAngleToolTipFeedback!=null&&this.wallAngleToolTipFeedback.length>0){var bj=bi.getWallAtStart();if(bj!=null){if(bj.getWallAtStart()===bi){if(this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(bi)>0){this.__parent.getView().setAngleFeedback(bi.getXStart(),bi.getYStart(),bj.getXEnd(),bj.getYEnd(),bi.getXEnd(),bi.getYEnd())}else{this.__parent.getView().setAngleFeedback(bi.getXStart(),bi.getYStart(),bi.getXEnd(),bi.getYEnd(),bj.getXEnd(),bj.getYEnd())}}else{if(this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(bi)>0){this.__parent.getView().setAngleFeedback(bi.getXStart(),bi.getYStart(),bj.getXStart(),bj.getYStart(),bi.getXEnd(),bi.getYEnd())}else{this.__parent.getView().setAngleFeedback(bi.getXStart(),bi.getYStart(),bi.getXEnd(),bi.getYEnd(),bj.getXStart(),bj.getYStart())}}}}}};return bg}(al.ControllerState));al.AbstractWallState=p;p.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractWallState";var d=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}if(bj.selectedPiece===undefined){bj.selectedPiece=null}if(bj.angleMousePress===undefined){bj.angleMousePress=0}if(bj.oldAngle===undefined){bj.oldAngle=0}if(bj.doorOrWindowBoundToWall===undefined){bj.doorOrWindowBoundToWall=false}if(bj.rotationToolTipFeedback===undefined){bj.rotationToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};bh.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"rotationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedPiece.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedPiece.getX());this.oldAngle=this.selectedPiece.getAngle();this.doorOrWindowBoundToWall=(this.selectedPiece!=null&&this.selectedPiece instanceof HomeDoorOrWindow)&&this.selectedPiece.isBoundToWall();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldAngle),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bj,bn){if(bj!==this.selectedPiece.getX()||bn!==this.selectedPiece.getY()){var bm=Math.atan2(this.selectedPiece.getY()-bn,bj-this.selectedPiece.getX());var bl=this.oldAngle-bm+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bk=2*Math.PI/bh.STEP_COUNT;bl=Math.round(bl/bk)*bk}this.selectedPiece.setAngle(bl);var bi=this.__parent.getView();bi.makePointVisible(bj,bn);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(bl),bj,bn)}}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurnitureRotation(this.selectedPiece,this.oldAngle,this.doorOrWindowBoundToWall);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bh.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bh.prototype.escape=function(){this.selectedPiece.setAngle(this.oldAngle);if(this.selectedPiece!=null&&this.selectedPiece instanceof HomeDoorOrWindow){this.selectedPiece.setBoundToWall(this.doorOrWindowBoundToWall)}this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedPiece=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.rotationToolTipFeedback,(Math.round((function(bj){return bj*180/Math.PI})(bi))+360)%360)};bh.STEP_COUNT=24;return bh}(al.ControllerState));al.PieceOfFurnitureRotationState=d;d.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRotationState";var aJ=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedPiece===undefined){bj.selectedPiece=null}if(bj.oldPitch===undefined){bj.oldPitch=0}if(bj.oldWidthInPlan===undefined){bj.oldWidthInPlan=0}if(bj.oldDepthInPlan===undefined){bj.oldDepthInPlan=0}if(bj.oldHeightInPlan===undefined){bj.oldHeightInPlan=0}if(bj.pitchRotationToolTipFeedback===undefined){bj.pitchRotationToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};bh.prototype.enter=function(){this.pitchRotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"pitchRotationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldPitch=this.selectedPiece.getPitch();this.oldWidthInPlan=this.selectedPiece.getWidthInPlan();this.oldDepthInPlan=this.selectedPiece.getDepthInPlan();this.oldHeightInPlan=this.selectedPiece.getHeightInPlan();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPitch),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bi,bk){var bj=(this.oldPitch-(bk-this.__parent.getYLastMousePress())*Math.cos(this.selectedPiece.getAngle())*Math.PI/360+(bi-this.__parent.getXLastMousePress())*Math.sin(this.selectedPiece.getAngle())*Math.PI/360);if(Math.abs(bj)<1e-8){bj=0}this.selectedPiece.setPitch(bj);if(this.__parent.feedbackDisplayed){this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bj),bi,bk)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurniturePitchRotation(this.selectedPiece,this.oldPitch,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.escape=function(){this.selectedPiece.setPitch(this.oldPitch);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedPiece=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.pitchRotationToolTipFeedback,(Math.round((function(bj){return bj*180/Math.PI})(bi))+360)%360)};return bh}(al.ControllerState));al.PieceOfFurniturePitchRotationState=aJ;aJ.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurniturePitchRotationState";var n=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedPiece===undefined){bj.selectedPiece=null}if(bj.oldRoll===undefined){bj.oldRoll=0}if(bj.oldWidthInPlan===undefined){bj.oldWidthInPlan=0}if(bj.oldDepthInPlan===undefined){bj.oldDepthInPlan=0}if(bj.oldHeightInPlan===undefined){bj.oldHeightInPlan=0}if(bj.rollRotationToolTipFeedback===undefined){bj.rollRotationToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};bh.prototype.enter=function(){this.rollRotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"rollRotationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldRoll=this.selectedPiece.getRoll();this.oldWidthInPlan=this.selectedPiece.getWidthInPlan();this.oldDepthInPlan=this.selectedPiece.getDepthInPlan();this.oldHeightInPlan=this.selectedPiece.getHeightInPlan();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldRoll),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bi,bk){var bj=(this.oldRoll+(bk-this.__parent.getYLastMousePress())*Math.sin(this.selectedPiece.getAngle())*Math.PI/360+(bi-this.__parent.getXLastMousePress())*Math.cos(this.selectedPiece.getAngle())*Math.PI/360);if(Math.abs(bj)<1e-8){bj=0}this.selectedPiece.setRoll(bj);if(this.__parent.feedbackDisplayed){this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bj),bi,bk)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurnitureRollRotation(this.selectedPiece,this.oldRoll,this.oldWidthInPlan,this.oldDepthInPlan,this.oldHeightInPlan);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.escape=function(){this.selectedPiece.setRoll(this.oldRoll);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedPiece=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.rollRotationToolTipFeedback,(Math.round((function(bj){return bj*180/Math.PI})(bi))+360)%360)};return bh}(al.ControllerState));al.PieceOfFurnitureRollRotationState=n;n.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureRollRotationState";var X=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.deltaYToElevationPoint===undefined){bj.deltaYToElevationPoint=0}if(bj.selectedPiece===undefined){bj.selectedPiece=null}if(bj.oldElevation===undefined){bj.oldElevation=0}if(bj.elevationToolTipFeedback===undefined){bj.elevationToolTipFeedback=null}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return this.selectedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.selectedPiece)};bg.prototype.enter=function(){this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"elevationToolTipFeedback");this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bj=this.selectedPiece.getPoints()[1];this.deltaYToElevationPoint=this.__parent.getYLastMousePress()-bj[1];this.oldElevation=this.selectedPiece.getElevation();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bg.prototype.moveMouse=function(bk,bn){var bj=this.__parent.getView();var bm=this.selectedPiece.getPoints()[1];var bi=bn-this.deltaYToElevationPoint-bm[1];var bl=this.oldElevation-bi;bl=Math.min(Math.max(bl,0),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation());if(this.magnetismEnabled){bl=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bl,bj.getPixelLength())}this.selectedPiece.setElevation(bl);if(this.magnetismEnabled&&this.selectedPiece!=null){this.__parent.adjustPieceOfFurnitureElevation(this.selectedPiece,false,3*al.PIXEL_MARGIN/this.__parent.getScale())}if(this.__parent.feedbackDisplayed){bj.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedPiece.getElevation()),bk,bn)}bj.makeSelectionVisible()};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurnitureElevation(this.selectedPiece,this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedPiece.setElevation(this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedPiece=null};bg.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bi))};return bg}(al.ControllerState));al.PieceOfFurnitureElevationState=X;X.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureElevationState";var aF=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.deltaYToResizePoint===undefined){bj.deltaYToResizePoint=0}if(bj.resizedPiece===undefined){bj.resizedPiece=null}if(bj.topLeftPoint===undefined){bj.topLeftPoint=null}if(bj.resizePoint===undefined){bj.resizePoint=null}if(bj.resizeToolTipFeedback===undefined){bj.resizeToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.isBasePlanModificationState=function(){return this.resizedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.resizedPiece.getPieceOfFurniture())};bh.prototype.enter=function(){this.resizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"heightResizeToolTipFeedback");var bk=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.resizedPiece=new al.ResizedPieceOfFurniture(bk);var bj=bk.getPoints();this.resizePoint=bj[3];this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.resizePoint[1];this.topLeftPoint=bj[0];this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(bk.getHeight()),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bt,br){var bo=this.__parent.getView();var bs=this.resizedPiece.getPieceOfFurniture();var bm=br-this.deltaYToResizePoint-this.resizePoint[1];var bj=this.resizedPiece.getHeight()-bm;bj=Math.max(bj,0);if(this.magnetismEnabled){bj=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bj,bo.getPixelLength())}bj=Math.min(Math.max(bj,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());if(bs.isDeformable()&&!bs.isHorizontallyRotated()&&bs.getModelTransformations()==null){this.__parent.setPieceOfFurnitureSize(this.resizedPiece,this.resizedPiece.getWidth(),this.resizedPiece.getDepth(),bj)}else{var bl=bj/this.resizedPiece.getHeight();var bn=this.resizedPiece.getWidth()*bl;var bq=this.resizedPiece.getDepth()*bl;var bk=bs.getAngle();var bu=Math.cos(bk);var bp=Math.sin(bk);var bi=(this.topLeftPoint[0]+(bn*bu-bq*bp)/2);var bv=(this.topLeftPoint[1]+(bn*bp+bq*bu)/2);bs.setX(bi);bs.setY(bv);this.__parent.setPieceOfFurnitureSize(this.resizedPiece,bn,bq,bj)}bo.makePointVisible(bt,br);if(this.__parent.feedbackDisplayed){bo.setToolTipFeedback(this.getToolTipFeedbackText(bj),bt,br)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurnitureHeightResize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bh.prototype.escape=function(){this.__parent.resetPieceOfFurnitureSize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.resizedPiece=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.resizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bi))};return bh}(al.ControllerState));al.PieceOfFurnitureHeightState=aF;aF.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureHeightState";var ay=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}if(bj.widthOrDepthResizingActivated===undefined){bj.widthOrDepthResizingActivated=false}if(bj.deltaXToResizePoint===undefined){bj.deltaXToResizePoint=0}if(bj.deltaYToResizePoint===undefined){bj.deltaYToResizePoint=0}if(bj.resizedPiece===undefined){bj.resizedPiece=null}if(bj.resizedPieceWidthInPlan===undefined){bj.resizedPieceWidthInPlan=0}if(bj.resizePoint===undefined){bj.resizePoint=null}if(bj.topLeftPoint===undefined){bj.topLeftPoint=null}if(bj.widthResizeToolTipFeedback===undefined){bj.widthResizeToolTipFeedback=null}if(bj.depthResizeToolTipFeedback===undefined){bj.depthResizeToolTipFeedback=null}if(bj.heightResizeToolTipFeedback===undefined){bj.heightResizeToolTipFeedback=null}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return this.resizedPiece!=null&&this.__parent.isPieceOfFurniturePartOfBasePlan(this.resizedPiece.getPieceOfFurniture())};bg.prototype.enter=function(){this.widthResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"widthResizeToolTipFeedback");this.depthResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"depthResizeToolTipFeedback");this.heightResizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"heightResizeToolTipFeedback");var bk=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.resizedPiece=new al.ResizedPieceOfFurniture(bk);this.resizedPieceWidthInPlan=bk.getWidthInPlan();var bj=bk.getPoints();this.resizePoint=bj[2];this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.resizePoint[0];this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.resizePoint[1];this.topLeftPoint=bj[0];this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.widthOrDepthResizingActivated=this.__parent.wasDuplicationActivatedLastMousePress();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(bk.getWidth(),bk.getDepth(),bk.getHeight()),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bg.prototype.moveMouse=function(bu,bs){var bp=this.__parent.getView();var bt=this.resizedPiece.getPieceOfFurniture();var bl=bt.getAngle();var bv=Math.cos(bl);var bq=Math.sin(bl);var bn=bu-this.deltaXToResizePoint-this.topLeftPoint[0];var bm=bs-this.deltaYToResizePoint-this.topLeftPoint[1];var bo=(bm*bq+bn*bv);if(this.magnetismEnabled){bo=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bo,bp.getPixelLength())}bo=Math.min(Math.max(bo,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());var br=this.resizedPiece.getDepth();var bj=this.resizedPiece.getHeight();var bx=this.resizedPiece.isDoorOrWindowBoundToWall();if(this.isProprortionallyResized(bt)){var bk=bo/this.resizedPieceWidthInPlan;bo=this.resizedPiece.getWidth()*bk;br=this.resizedPiece.getDepth()*bk;bj=this.resizedPiece.getHeight()*bk;bx=br===this.resizedPiece.getDepth()}else{if(!bt.isWidthDepthDeformable()){br=this.resizedPiece.getDepth()*bo/this.resizedPiece.getWidth()}else{if(!this.resizedPiece.isDoorOrWindowBoundToWall()||!this.magnetismEnabled||this.widthOrDepthResizingActivated){br=(bm*bv-bn*bq);if(this.magnetismEnabled){br=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(br,bp.getPixelLength())}br=Math.min(Math.max(br,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());bx=br===this.resizedPiece.getDepth();if(this.widthOrDepthResizingActivated){if((function(by){if(by>0){return 1}else{if(by<0){return -1}else{return 0}}})(java.awt.geom.Line2D.relativeCCW(this.topLeftPoint[0],this.topLeftPoint[1],this.resizePoint[0],this.resizePoint[1],bu-this.deltaXToResizePoint,bs-this.deltaYToResizePoint))>=0){br=this.resizedPiece.getDepth()}else{bo=this.resizedPiece.getWidth()}}}}}this.__parent.setPieceOfFurnitureSize(this.resizedPiece,bo,br,bj);if(this.resizedPiece.isDoorOrWindowBoundToWall()){bt.setBoundToWall(this.magnetismEnabled&&bx)}var bi=(this.topLeftPoint[0]+(bt.getWidthInPlan()*bv-bt.getDepthInPlan()*bq)/2);var bw=(this.topLeftPoint[1]+(bt.getWidthInPlan()*bq+bt.getDepthInPlan()*bv)/2);bt.setX(bi);bt.setY(bw);bp.makePointVisible(bu,bs);if(this.__parent.feedbackDisplayed){bp.setToolTipFeedback(this.getToolTipFeedbackText(bo,br,bj),bu,bs)}};bg.prototype.isProprortionallyResized=function(bi){return !bi.isDeformable()||bi.isHorizontallyRotated()||bi.getModelTransformations()!=null||this.alignmentActivated};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurnitureWidthAndDepthResize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setDuplicationActivated=function(bi){this.widthOrDepthResizingActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.__parent.resetPieceOfFurnitureSize(this.resizedPiece);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.resizedPiece=null};bg.prototype.getToolTipFeedbackText=function(bk,bl,bi){var bj="<html>"+CoreTools.format(this.widthResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bk));if(!(this.resizedPiece.getPieceOfFurniture()!=null&&this.resizedPiece.getPieceOfFurniture() instanceof HomeDoorOrWindow)||!this.resizedPiece.getPieceOfFurniture().isBoundToWall()||this.isProprortionallyResized(this.resizedPiece.getPieceOfFurniture())){bj+="<br>"+CoreTools.format(this.depthResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bl))}if(this.isProprortionallyResized(this.resizedPiece.getPieceOfFurniture())){bj+="<br>"+CoreTools.format(this.heightResizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bi))}return bj};return bg}(al.ControllerState));al.PieceOfFurnitureResizeState=ay;ay.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureResizeState";var a2=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.deltaXToModificationPoint===undefined){bj.deltaXToModificationPoint=0}if(bj.selectedLight===undefined){bj.selectedLight=null}if(bj.oldPower===undefined){bj.oldPower=0}if(bj.lightPowerToolTipFeedback===undefined){bj.lightPowerToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.enter=function(){this.lightPowerToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"lightPowerToolTipFeedback");this.selectedLight=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bj=this.selectedLight.getPoints()[3];this.deltaXToModificationPoint=this.__parent.getXLastMousePress()-bj[0];this.oldPower=this.selectedLight.getPower();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPower),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bj,bn){var bi=this.__parent.getView();var bl=this.selectedLight.getPoints()[3];var bk=bj-this.deltaXToModificationPoint-bl[0];var bm=this.oldPower+bk/100*this.__parent.getScale();bm=Math.min(Math.max(bm,0),1);this.selectedLight.setPower(bm);bi.makePointVisible(bj,bn);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(bm),bj,bn)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postLightPowerModification(this.selectedLight,this.oldPower);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.escape=function(){this.selectedLight.setPower(this.oldPower);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedLight=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.lightPowerToolTipFeedback,Math.round(bi*100))};return bh}(al.ControllerState));al.LightPowerModificationState=a2;a2.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LightPowerModificationState";var aG=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedPiece===undefined){bj.selectedPiece=null}if(bj.oldNameXOffset===undefined){bj.oldNameXOffset=0}if(bj.oldNameYOffset===undefined){bj.oldNameYOffset=0}if(bj.xLastMouseMove===undefined){bj.xLastMouseMove=0}if(bj.yLastMouseMove===undefined){bj.yLastMouseMove=0}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.enter=function(){this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldNameXOffset=this.selectedPiece.getNameXOffset();this.oldNameYOffset=this.selectedPiece.getNameYOffset();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bh.prototype.moveMouse=function(bi,bk){if(this.alignmentActivated){var bj=new al.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bi,bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bi=bj.getX();bk=bj.getY()}this.selectedPiece.setNameXOffset(this.selectedPiece.getNameXOffset()+bi-this.xLastMouseMove);this.selectedPiece.setNameYOffset(this.selectedPiece.getNameYOffset()+bk-this.yLastMouseMove);this.xLastMouseMove=bi;this.yLastMouseMove=bk;this.__parent.getView().makePointVisible(bi,bk)};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurnitureNameOffset(this.selectedPiece,this.oldNameXOffset,this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.escape=function(){this.selectedPiece.setNameXOffset(this.oldNameXOffset);this.selectedPiece.setNameYOffset(this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bh.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedPiece=null};return bh}(al.ControllerState));al.PieceOfFurnitureNameOffsetState=aG;aG.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameOffsetState";var aW=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedPiece===undefined){bj.selectedPiece=null}if(bj.oldNameAngle===undefined){bj.oldNameAngle=0}if(bj.angleMousePress===undefined){bj.angleMousePress=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.enter=function(){this.selectedPiece=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedPiece.getX()-this.selectedPiece.getNameXOffset());this.oldNameAngle=this.selectedPiece.getNameAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bi,bm){if(bi!==this.selectedPiece.getX()+this.selectedPiece.getNameXOffset()||bm!==this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()){var bl=Math.atan2(this.selectedPiece.getY()+this.selectedPiece.getNameYOffset()-bm,bi-this.selectedPiece.getX()-this.selectedPiece.getNameXOffset());var bk=this.oldNameAngle-bl+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bj=2*Math.PI/bg.STEP_COUNT;bk=Math.round(bk/bj)*bj}this.selectedPiece.setNameAngle(bk);this.__parent.getView().makePointVisible(bi,bm)}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postPieceOfFurnitureNameRotation(this.selectedPiece,this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedPiece.setNameAngle(this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedPiece=null};bg.STEP_COUNT=24;return bg}(al.ControllerState));al.PieceOfFurnitureNameRotationState=aW;aW.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PieceOfFurnitureNameRotationState";var aI=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedCamera===undefined){bj.selectedCamera=null}if(bj.oldYaw===undefined){bj.oldYaw=0}if(bj.xLastMouseMove===undefined){bj.xLastMouseMove=0}if(bj.yLastMouseMove===undefined){bj.yLastMouseMove=0}if(bj.angleLastMouseMove===undefined){bj.angleLastMouseMove=0}if(bj.rotationToolTipFeedback===undefined){bj.rotationToolTipFeedback=null}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"cameraYawRotationToolTipFeedback");this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldYaw=this.selectedCamera.getYaw();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.angleLastMouseMove=Math.atan2(this.selectedCamera.getY()-this.yLastMouseMove,this.xLastMouseMove-this.selectedCamera.getX());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldYaw),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bg.prototype.moveMouse=function(bi,bn){if(bi!==this.selectedCamera.getX()||bn!==this.selectedCamera.getY()){var bm=Math.atan2(this.selectedCamera.getY()-bn,bi-this.selectedCamera.getX());var bj=this.angleLastMouseMove-bm;var bl=(function(bo){if(bo>0){return 1}else{if(bo<0){return -1}else{return 0}}})((bn-this.selectedCamera.getY())*(this.xLastMouseMove-this.selectedCamera.getX())-(this.yLastMouseMove-this.selectedCamera.getY())*(bi-this.selectedCamera.getX()));if(bl<0&&bj>0){bj-=(Math.PI*2)}else{if(bl>0&&bj<0){bj+=(Math.PI*2)}}var bk=this.selectedCamera.getYaw()+bj;this.selectedCamera.setYaw(bk);if(this.__parent.feedbackDisplayed){this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bk),bi,bn)}this.xLastMouseMove=bi;this.yLastMouseMove=bn;this.angleLastMouseMove=bm}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.escape=function(){this.selectedCamera.setYaw(this.oldYaw);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedCamera=null};bg.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.rotationToolTipFeedback,(Math.round((function(bj){return bj*180/Math.PI})(bi))+360)%360)};return bg}(al.ControllerState));al.CameraYawRotationState=aI;aI.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraYawRotationState";var q=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedCamera===undefined){bj.selectedCamera=null}if(bj.oldPitch===undefined){bj.oldPitch=0}if(bj.rotationToolTipFeedback===undefined){bj.rotationToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"cameraPitchRotationToolTipFeedback");this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldPitch=this.selectedCamera.getPitch();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldPitch),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bi,bk){var bj=(this.oldPitch+(bk-this.__parent.getYLastMousePress())*Math.cos(this.selectedCamera.getYaw())*Math.PI/360-(bi-this.__parent.getXLastMousePress())*Math.sin(this.selectedCamera.getYaw())*Math.PI/360);bj=Math.max(bj,-Math.PI/2);bj=Math.min(bj,Math.PI/2);this.selectedCamera.setPitch(bj);if(this.__parent.feedbackDisplayed){this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bj),bi,bk)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.escape=function(){this.selectedCamera.setPitch(this.oldPitch);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedCamera=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.rotationToolTipFeedback,Math.round((function(bj){return bj*180/Math.PI})(bi))%360)};return bh}(al.ControllerState));al.CameraPitchRotationState=q;q.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraPitchRotationState";var bc=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedCamera===undefined){bj.selectedCamera=null}if(bj.oldElevation===undefined){bj.oldElevation=0}if(bj.cameraElevationToolTipFeedback===undefined){bj.cameraElevationToolTipFeedback=null}if(bj.observerHeightToolTipFeedback===undefined){bj.observerHeightToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.enter=function(){this.cameraElevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"cameraElevationToolTipFeedback");this.observerHeightToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"observerHeightToolTipFeedback");this.selectedCamera=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldElevation=this.selectedCamera.getZ();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bi,bm){var bj=(this.oldElevation-(bm-this.__parent.getYLastMousePress()));var bl=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getLevels();var bk=bl.length===0?10:10+bl[0].getElevation();bj=Math.min(Math.max(bj,bk),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation());this.selectedCamera.setZ(bj);if(this.__parent.feedbackDisplayed){this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(bj),bi,bm)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.escape=function(){this.selectedCamera.setZ(this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedCamera=null};bh.prototype.getToolTipFeedbackText=function(bj){var bi="<html>"+CoreTools.format(this.cameraElevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bj));if(!this.selectedCamera.isFixedSize()&&bj>=70&&bj<=218.75){bi+="<br>"+CoreTools.format(this.observerHeightToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bj*15/14))}return bi};return bh}(al.ControllerState));al.CameraElevationState=bc;bc.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CameraElevationState";var t=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.xStart===undefined){bj.xStart=0}if(bj.yStart===undefined){bj.yStart=0}if(bj.editingStartPoint===undefined){bj.editingStartPoint=false}if(bj.newDimensionLine===undefined){bj.newDimensionLine=null}if(bj.oldSelection===undefined){bj.oldSelection=null}if(bj.oldBasePlanLocked===undefined){bj.oldBasePlanLocked=false}if(bj.oldAllLevelsSelection===undefined){bj.oldAllLevelsSelection=false}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}if(bj.offsetChoice===undefined){bj.offsetChoice=false}return bj}bg.prototype.getMode=function(){return al.Mode.DIMENSION_LINE_CREATION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.setMode=function(bi){this.escape();if(bi===al.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bi===al.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bi===al.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bi===al.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bi===al.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bi===al.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};bg.prototype.enter=function(){this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.xStart=this.__parent.getXLastMouseMove();this.yStart=this.__parent.getYLastMouseMove();this.editingStartPoint=false;this.offsetChoice=false;this.newDimensionLine=null;this.__parent.deselectAll();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getMeasuringDimensionLineAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),this.magnetismEnabled);if(this.__parent.feedbackDisplayed){if(bi!=null){this.__parent.getView().setDimensionLinesFeedback([bi].slice(0))}this.__parent.getView().setAlignmentFeedback(DimensionLine,null,this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),false)}};bg.prototype.moveMouse=function(bl,bp){var bk=this.__parent.getView();bk.deleteFeedback();if(this.offsetChoice){var bm=java.awt.geom.Line2D.ptLineDist(this.newDimensionLine.getXStart(),this.newDimensionLine.getYStart(),this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd(),bl,bp);if(this.newDimensionLine.getLength()>0){var bj=java.awt.geom.Line2D.relativeCCW(this.newDimensionLine.getXStart(),this.newDimensionLine.getYStart(),this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd(),bl,bp);this.newDimensionLine.setOffset(-(function(bq){if(bq>0){return 1}else{if(bq<0){return -1}else{return 0}}})(bj)*bm)}}else{var bo=void 0;var bn=void 0;if(this.magnetismEnabled||this.alignmentActivated){var bi=new al.PointWithAngleMagnetism(this.xStart,this.yStart,bl,bp,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bk.getPixelLength());bo=bi.getX();bn=bi.getY()}else{bo=bl;bn=bp}if(this.newDimensionLine==null){this.newDimensionLine=this.__parent.createDimensionLine(this.xStart,this.yStart,bo,bn,0);this.__parent.getView().setDimensionLinesFeedback(null)}else{if(this.editingStartPoint){this.newDimensionLine.setXStart(bo);this.newDimensionLine.setYStart(bn)}else{this.newDimensionLine.setXEnd(bo);this.newDimensionLine.setYEnd(bn)}}this.updateReversedDimensionLine();if(this.__parent.feedbackDisplayed){bk.setAlignmentFeedback(DimensionLine,this.newDimensionLine,bo,bn,false)}}bk.makePointVisible(bl,bp)};bg.prototype.updateReversedDimensionLine=function(){var bj=this.getDimensionLineAngle();var bi=bj<-Math.PI/2||bj>Math.PI/2;if((bi)!==(this.editingStartPoint)){al.reverseDimensionLine(this.newDimensionLine);this.editingStartPoint=!this.editingStartPoint}};bg.prototype.getDimensionLineAngle=function(){if(this.newDimensionLine.getLength()===0){return 0}else{if(this.editingStartPoint){return Math.atan2(this.yStart-this.newDimensionLine.getYStart(),this.newDimensionLine.getXStart()-this.xStart)}else{return Math.atan2(this.yStart-this.newDimensionLine.getYEnd(),this.newDimensionLine.getXEnd()-this.xStart)}}};bg.prototype.pressMouse=function(bl,bo,bk,bm,bn){if(this.newDimensionLine==null&&bk===2){var bj=this.__parent.getMeasuringDimensionLineAt(bl,bo,this.magnetismEnabled);if(bj!=null){this.newDimensionLine=this.__parent.createDimensionLine(bj.getXStart(),bj.getYStart(),bj.getXEnd(),bj.getYEnd(),bj.getOffset());if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.validateDrawnDimensionLine()}}else{this.__parent.setState(this.__parent.getDimensionLineCreationState());return}}if(this.newDimensionLine!=null){if(this.offsetChoice){this.validateDrawnDimensionLine()}else{this.offsetChoice=true;var bi=this.__parent.getView();bi.setCursor(PlanView.CursorType.HEIGHT);bi.deleteFeedback()}}};bg.prototype.releaseMouse=function(bi,bj){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH&&this.newDimensionLine!=null){this.validateDrawnDimensionLine()}};bg.prototype.validateDrawnDimensionLine=function(){this.__parent.selectItem(this.newDimensionLine);this.__parent.postCreateDimensionLines([this.newDimensionLine].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection);this.newDimensionLine=null;if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getDimensionLineCreationState())}};bg.prototype.setEditionActivated=function(bl){var bi=this.__parent.getView();if(bl){bi.deleteFeedback();if(this.newDimensionLine==null){bi.setToolTipEditedProperties(["X","Y"],[this.xStart,this.yStart],this.xStart,this.yStart)}else{if(this.offsetChoice){bi.setToolTipEditedProperties(["OFFSET"],[this.newDimensionLine.getOffset()],this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd())}else{bi.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.newDimensionLine.getLength(),(Math.round((function(bm){return bm*180/Math.PI})(this.getDimensionLineAngle()))|0)],this.newDimensionLine.getXEnd(),this.newDimensionLine.getYEnd())}}this.showDimensionLineFeedback()}else{if(this.newDimensionLine==null){var bj=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bk=bj.isMetric()?100:LengthUnit.footToCentimeter(3);this.newDimensionLine=this.__parent.createDimensionLine(this.xStart,this.yStart,this.xStart+bk,this.yStart,0);bi.deleteFeedback();this.setEditionActivated(true)}else{if(this.offsetChoice){this.validateDrawnDimensionLine()}else{this.offsetChoice=true;this.setEditionActivated(true)}}}};bg.prototype.updateEditableProperty=function(bn,bo){var bm=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();if(this.newDimensionLine==null){switch((bn)){case"X":this.xStart=bo!=null?bo:0;this.xStart=Math.max(-bm,Math.min(this.xStart,bm));break;case"Y":this.yStart=bo!=null?bo:0;this.yStart=Math.max(-bm,Math.min(this.yStart,bm));break}}else{if(this.offsetChoice){if(bn==="OFFSET"){var bl=bo!=null?bo:0;bl=Math.max(-bm,Math.min(bl,bm));this.newDimensionLine.setOffset(bl)}}else{var bi=void 0;var bq=void 0;switch((bn)){case"LENGTH":var bk=bo!=null?bo:0;bk=Math.max(0.001,Math.min(bk,bm));var bj=this.getDimensionLineAngle();bi=(this.xStart+bk*Math.cos(bj));bq=(this.yStart-bk*Math.sin(bj));break;case"ANGLE":bj=(function(br){return br*Math.PI/180})(bo!=null?bo:0);var bp=this.newDimensionLine.getLength();bi=(this.xStart+bp*Math.cos(bj));bq=(this.yStart-bp*Math.sin(bj));break;default:return}if(this.editingStartPoint){this.newDimensionLine.setXStart(bi);this.newDimensionLine.setYStart(bq)}else{this.newDimensionLine.setXEnd(bi);this.newDimensionLine.setYEnd(bq)}}}this.showDimensionLineFeedback()};bg.prototype.showDimensionLineFeedback=function(){var bi=this.__parent.getView();if(this.newDimensionLine==null){if(this.__parent.feedbackDisplayed){bi.setAlignmentFeedback(DimensionLine,null,this.xStart,this.yStart,true)}bi.makePointVisible(this.xStart,this.yStart)}else{if(!this.offsetChoice){var bk=void 0;var bj=void 0;if(this.editingStartPoint){bk=this.newDimensionLine.getXStart();bj=this.newDimensionLine.getYStart()}else{bk=this.newDimensionLine.getXEnd();bj=this.newDimensionLine.getYEnd()}this.updateReversedDimensionLine();if(this.__parent.feedbackDisplayed){bi.setAlignmentFeedback(DimensionLine,this.newDimensionLine,bk,bj,false)}bi.makePointVisible(this.xStart,this.yStart);bi.makePointVisible(bk,bj)}}};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.newDimensionLine!=null&&!this.offsetChoice){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){if(this.newDimensionLine!=null){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteDimensionLine(this.newDimensionLine)}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getDimensionLineCreationState())}};bg.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.newDimensionLine=null;this.oldSelection=null};return bg}(al.ControllerState));al.DimensionLineDrawingState=t;t.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineDrawingState";var Z=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedDimensionLine===undefined){bj.selectedDimensionLine=null}if(bj.editingStartPoint===undefined){bj.editingStartPoint=false}if(bj.oldX===undefined){bj.oldX=0}if(bj.oldY===undefined){bj.oldY=0}if(bj.reversedDimensionLine===undefined){bj.reversedDimensionLine=false}if(bj.deltaXToResizePoint===undefined){bj.deltaXToResizePoint=0}if(bj.deltaYToResizePoint===undefined){bj.deltaYToResizePoint=0}if(bj.distanceFromResizePointToDimensionBaseLine===undefined){bj.distanceFromResizePointToDimensionBaseLine=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){var bj=this.__parent.getView();bj.setResizeIndicatorVisible(true);this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.editingStartPoint=this.selectedDimensionLine===this.__parent.getResizedDimensionLineStartAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(this.editingStartPoint){this.oldX=this.selectedDimensionLine.getXStart();this.oldY=this.selectedDimensionLine.getYStart()}else{this.oldX=this.selectedDimensionLine.getXEnd();this.oldY=this.selectedDimensionLine.getYEnd()}this.reversedDimensionLine=false;var bk;var bm;var bi=(this.selectedDimensionLine.getYEnd()-this.selectedDimensionLine.getYStart())/(this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart());if(Math.abs(bi)>100000){bk=this.__parent.getXLastMousePress();if(this.editingStartPoint){bm=this.selectedDimensionLine.getYStart()}else{bm=this.selectedDimensionLine.getYEnd()}}else{if(this.selectedDimensionLine.getYStart()===this.selectedDimensionLine.getYEnd()){if(this.editingStartPoint){bk=this.selectedDimensionLine.getXStart()}else{bk=this.selectedDimensionLine.getXEnd()}bm=this.__parent.getYLastMousePress()}else{var bn=this.__parent.getYLastMousePress()-bi*this.__parent.getXLastMousePress();var bo=-1/bi;var bl=void 0;if(this.editingStartPoint){bl=this.selectedDimensionLine.getYStart()-bo*this.selectedDimensionLine.getXStart()}else{bl=this.selectedDimensionLine.getYEnd()-bo*this.selectedDimensionLine.getXEnd()}bk=(bl-bn)/(bi-bo);bm=bi*bk+bn}}this.deltaXToResizePoint=this.__parent.getXLastMousePress()-bk;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-bm;if(this.editingStartPoint){this.distanceFromResizePointToDimensionBaseLine=java.awt.geom.Point2D.distance(bk,bm,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart());if(this.__parent.feedbackDisplayed){bj.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),false)}}else{this.distanceFromResizePointToDimensionBaseLine=java.awt.geom.Point2D.distance(bk,bm,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd());if(this.__parent.feedbackDisplayed){bj.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),false)}}this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};bg.prototype.moveMouse=function(bs,bq){var bp=this.__parent.getView();var bx=bs-this.deltaXToResizePoint;var br=bq-this.deltaYToResizePoint;if(this.editingStartPoint){var bk=java.awt.geom.Point2D.distance(bx,br,this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd());var bo=Math.sqrt(bk*bk-this.distanceFromResizePointToDimensionBaseLine*this.distanceFromResizePointToDimensionBaseLine);if(bo>0){var bm=-Math.atan2(this.distanceFromResizePointToDimensionBaseLine,bo);if(this.selectedDimensionLine.getOffset()>=0){bm=-bm}var bw=Math.atan2(br-this.selectedDimensionLine.getYEnd(),bx-this.selectedDimensionLine.getXEnd());var bv=bm+bw;var bi=this.selectedDimensionLine.getXEnd()+(bo*Math.cos(bv));var by=this.selectedDimensionLine.getYEnd()+(bo*Math.sin(bv));if(this.alignmentActivated||this.magnetismEnabled){var bu=new al.PointWithAngleMagnetism(this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),bi,by,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bp.getPixelLength());bi=bu.getX();by=bu.getY()}al.moveDimensionLinePoint(this.selectedDimensionLine,bi,by,this.editingStartPoint);this.updateReversedDimensionLine();if(this.__parent.feedbackDisplayed){bp.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,bi,by,false)}}else{bp.deleteFeedback()}}else{var bn=java.awt.geom.Point2D.distance(bx,br,this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart());var bo=Math.sqrt(bn*bn-this.distanceFromResizePointToDimensionBaseLine*this.distanceFromResizePointToDimensionBaseLine);if(bo>0){var bm=Math.atan2(this.distanceFromResizePointToDimensionBaseLine,bo);if(this.selectedDimensionLine.getOffset()>=0){bm=-bm}var bt=Math.atan2(br-this.selectedDimensionLine.getYStart(),bx-this.selectedDimensionLine.getXStart());var bv=bm+bt;var bl=this.selectedDimensionLine.getXStart()+(bo*Math.cos(bv));var bj=this.selectedDimensionLine.getYStart()+(bo*Math.sin(bv));if(this.alignmentActivated||this.magnetismEnabled){var bu=new al.PointWithAngleMagnetism(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),bl,bj,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bp.getPixelLength());bl=bu.getX();bj=bu.getY()}al.moveDimensionLinePoint(this.selectedDimensionLine,bl,bj,this.editingStartPoint);this.updateReversedDimensionLine();if(this.__parent.feedbackDisplayed){bp.setAlignmentFeedback(DimensionLine,this.selectedDimensionLine,bl,bj,false)}}else{bp.deleteFeedback()}}this.__parent.getView().makePointVisible(bs,bq)};bg.prototype.updateReversedDimensionLine=function(){var bi=this.getDimensionLineAngle();if(bi<-Math.PI/2||bi>Math.PI/2){al.reverseDimensionLine(this.selectedDimensionLine);this.editingStartPoint=!this.editingStartPoint;this.reversedDimensionLine=!this.reversedDimensionLine}};bg.prototype.getDimensionLineAngle=function(){if(this.selectedDimensionLine.getLength()===0){return 0}else{return Math.atan2(this.selectedDimensionLine.getYStart()-this.selectedDimensionLine.getYEnd(),this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart())}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postDimensionLineResize(this.selectedDimensionLine,this.oldX,this.oldY,this.editingStartPoint,this.reversedDimensionLine);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){if(this.reversedDimensionLine){al.reverseDimensionLine(this.selectedDimensionLine);this.editingStartPoint=!this.editingStartPoint}al.moveDimensionLinePoint(this.selectedDimensionLine,this.oldX,this.oldY,this.editingStartPoint);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.deleteFeedback();bi.setResizeIndicatorVisible(false);this.selectedDimensionLine=null};return bg}(al.ControllerState));al.DimensionLineResizeState=Z;Z.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineResizeState";var Y=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedDimensionLine===undefined){bj.selectedDimensionLine=null}if(bj.oldOffset===undefined){bj.oldOffset=0}if(bj.deltaXToOffsetPoint===undefined){bj.deltaXToOffsetPoint=0}if(bj.deltaYToOffsetPoint===undefined){bj.deltaYToOffsetPoint=0}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldOffset=this.selectedDimensionLine.getOffset();var bm=this.selectedDimensionLine.getYEnd()!==this.selectedDimensionLine.getYStart()||this.selectedDimensionLine.getXEnd()!==this.selectedDimensionLine.getXStart()?Math.atan2(this.selectedDimensionLine.getYEnd()-this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd()-this.selectedDimensionLine.getXStart()):this.selectedDimensionLine.getPitch();var bk=-Math.sin(bm)*this.oldOffset;var bj=Math.cos(bm)*this.oldOffset;var bn=(this.selectedDimensionLine.getXStart()+this.selectedDimensionLine.getXEnd())/2+bk;var bl=(this.selectedDimensionLine.getYStart()+this.selectedDimensionLine.getYEnd())/2+bj;this.deltaXToOffsetPoint=this.__parent.getXLastMousePress()-bn;this.deltaYToOffsetPoint=this.__parent.getYLastMousePress()-bl;var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bj,bo){var bm=bj-this.deltaXToOffsetPoint;var bl=bo-this.deltaYToOffsetPoint;var bk;var bi;if(this.selectedDimensionLine.getYEnd()!==this.selectedDimensionLine.getYStart()||this.selectedDimensionLine.getXEnd()!==this.selectedDimensionLine.getXStart()){bk=java.awt.geom.Line2D.ptLineDist(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),bm,bl);bi=java.awt.geom.Line2D.relativeCCW(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXEnd(),this.selectedDimensionLine.getYEnd(),bm,bl)}else{bk=java.awt.geom.Point2D.distance(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),bm,bl);bi=java.awt.geom.Line2D.relativeCCW(this.selectedDimensionLine.getXStart(),this.selectedDimensionLine.getYStart(),this.selectedDimensionLine.getXStart()+Math.cos(this.selectedDimensionLine.getPitch()),this.selectedDimensionLine.getYStart()+Math.sin(this.selectedDimensionLine.getPitch()),bm,bl)}var bn;bn=-(function(bp){if(bp>0){return 1}else{if(bp<0){return -1}else{return 0}}})(bi)*bk;this.selectedDimensionLine.setOffset(bn);this.__parent.getView().makePointVisible(bj,bo)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postDimensionLineOffset(this.selectedDimensionLine,this.oldOffset);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.escape=function(){this.selectedDimensionLine.setOffset(this.oldOffset);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedDimensionLine=null};return bg}(al.ControllerState));al.DimensionLineOffsetState=Y;Y.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineOffsetState";var aR=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedDimensionLine===undefined){bj.selectedDimensionLine=null}if(bj.oldPitch===undefined){bj.oldPitch=0}if(bj.pitchMousePress===undefined){bj.pitchMousePress=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.pitchMousePress=Math.atan2(this.selectedDimensionLine.getYStart()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedDimensionLine.getXStart());this.oldPitch=this.selectedDimensionLine.getPitch();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());this.__parent.getView().setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bi,bm){if(bi!==this.selectedDimensionLine.getXStart()||bm!==this.selectedDimensionLine.getYStart()){var bl=Math.atan2(this.selectedDimensionLine.getYStart()-bm,bi-this.selectedDimensionLine.getXStart());var bk=((this.oldPitch-bl+this.pitchMousePress+2*Math.PI)%(2*Math.PI));if(this.alignmentActivated||this.magnetismEnabled){var bj=2*Math.PI/bg.STEP_COUNT;bk=Math.round(bk/bj)*bj}this.selectedDimensionLine.setPitch(bk);this.__parent.planView.makePointVisible(bi,bm)}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postDimensionLinePitchRotation(this.selectedDimensionLine,this.oldPitch);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedDimensionLine.setPitch(this.oldPitch);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedDimensionLine=null};bg.STEP_COUNT=24;return bg}(al.ControllerState));al.DimensionLinePitchRotationState=aR;aR.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLinePitchRotationState";var W=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedDimensionLine===undefined){bj.selectedDimensionLine=null}if(bj.oldHeight===undefined){bj.oldHeight=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldHeight=this.selectedDimensionLine.getElevationEnd()-this.selectedDimensionLine.getElevationStart();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bj,bl){var bi=bl-this.__parent.getYLastMousePress();var bk=Math.max(this.oldHeight-bi,0);if(this.magnetismEnabled){bk=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bk,this.__parent.planView.getPixelLength())}bk=Math.min(Math.max(bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength());this.selectedDimensionLine.setElevationEnd(this.selectedDimensionLine.getElevationStart()+bk);this.__parent.getView().makePointVisible(bj,bl)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postDimensionLineHeight(this.selectedDimensionLine,this.oldHeight);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedDimensionLine.setElevationEnd(this.selectedDimensionLine.getElevationStart()+this.oldHeight);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedDimensionLine=null};return bg}(al.ControllerState));al.DimensionLineHeightState=W;W.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineHeightState";var u=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedDimensionLine===undefined){bj.selectedDimensionLine=null}if(bj.elevationToolTipFeedback===undefined){bj.elevationToolTipFeedback=null}if(bj.oldElevation===undefined){bj.oldElevation=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.isBasePlanModificationState=function(){return true};bh.prototype.enter=function(){this.selectedDimensionLine=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"elevationToolTipFeedback");this.oldElevation=this.selectedDimensionLine.getElevationStart();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bk,bm){var bj=this.__parent.getView();var bi=bm-this.__parent.getYLastMousePress();var bl=Math.max(this.oldElevation-bi,0);if(this.magnetismEnabled){bl=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bl,bj.getPixelLength())}bl=Math.min(bl,this.selectedDimensionLine.getElevationEnd()-this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength());this.selectedDimensionLine.setElevationStart(bl);bj.makePointVisible(bk,bm);if(this.__parent.feedbackDisplayed){bj.setToolTipFeedback(this.getToolTipFeedbackText(bl),bk,bm)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postDimensionLineElevation(this.selectedDimensionLine,this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bh.prototype.escape=function(){this.selectedDimensionLine.setElevationStart(this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedDimensionLine=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bi))};return bh}(al.ControllerState));al.DimensionLineElevationState=u;u.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineElevationState";var a8=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.roomSideLengthToolTipFeedback===undefined){bj.roomSideLengthToolTipFeedback=null}if(bj.roomDiagonalLengthToolTipFeedback===undefined){bj.roomDiagonalLengthToolTipFeedback=null}if(bj.roomSideAngleToolTipFeedback===undefined){bj.roomSideAngleToolTipFeedback=null}return bj}bh.prototype.enter=function(){this.roomSideLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"roomSideLengthToolTipFeedback");try{this.roomDiagonalLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"roomDiagonalLengthToolTipFeedback")}catch(bi){}try{this.roomSideAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"roomSideAngleToolTipFeedback")}catch(bi){}};bh.prototype.getToolTipFeedbackText=function(bm,bk){var bj=this.getRoomSideLength(bm,bk);var bn=this.getRoomSideAngle(bm,bk);var bi="<html>"+CoreTools.format(this.roomSideLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bj));if(this.roomDiagonalLengthToolTipFeedback!=null&&this.roomDiagonalLengthToolTipFeedback.length>0&&bm.getPointCount()>2){var bl=this.getRoomDiagonalLength(bm,bk);bi+="<br>"+CoreTools.format(this.roomDiagonalLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bl))}if(this.roomSideAngleToolTipFeedback!=null&&this.roomSideAngleToolTipFeedback.length>0){bi+="<br>"+CoreTools.format(this.roomSideAngleToolTipFeedback,bn)}return bi};bh.prototype.getRoomSideLength=function(bl,bk){var bj=bl.getPoints();var bi=bj[(bk+bj.length-1)%bj.length];return java.awt.geom.Point2D.distance(bi[0],bi[1],bj[bk][0],bj[bk][1])};bh.prototype.getRoomDiagonalLength=function(bl,bk){var bi=bl.getPoints();if(bi.length>2){var bj=bi[(bk+bi.length-2)%bi.length];return java.awt.geom.Point2D.distance(bi[bk][0],bi[bk][1],bj[0],bj[1])}else{throw new IllegalArgumentException("Room doesn't have at least 3 points")}};bh.prototype.getTriangulationDimensionLines=function(bo,bm){var bk=bo.getPoints();var bj=bk[(bm+bk.length-1)%bk.length];var bi=([]);var bp=20/this.__parent.getView().getScale();if(!(function(br,bq){if(br==null&&bq==null){return true}if(br==null||bq==null){return false}if(br.length!=bq.length){return false}for(var bs=0;bs<br.length;bs++){if(br[bs]!=bq[bs]){return false}}return true})(bk[bm],bj)){(bi.push(this.__parent.getDimensionLineBetweenPoints(bj,bk[bm],this.isDimensionInsideRoom(bo,bj,bk[bm])?-bp:bp,false))>0)}if(bk.length>2){var bn=bk[bm+1<bk.length?bm+1:0];if(!(function(br,bq){if(br==null&&bq==null){return true}if(br==null||bq==null){return false}if(br.length!=bq.length){return false}for(var bs=0;bs<br.length;bs++){if(br[bs]!=bq[bs]){return false}}return true})(bk[bm],bn)){(bi.push(this.__parent.getDimensionLineBetweenPoints(bk[bm],bn,this.isDimensionInsideRoom(bo,bk[bm],bn)?-bp:bp,false))>0)}var bl=bk[(bm+bk.length-2)%bk.length];if(bk.length===3){(bi.push(this.__parent.getDimensionLineBetweenPoints(bj,bl,this.isDimensionInsideRoom(bo,bj,bl)?-bp:bp,false))>0)}else{if(!(function(br,bq){if(br==null&&bq==null){return true}if(br==null||bq==null){return false}if(br.length!=bq.length){return false}for(var bs=0;bs<br.length;bs++){if(br[bs]!=bq[bs]){return false}}return true})(bk[bm],bl)){(bi.push(this.__parent.getDimensionLineBetweenPoints(bk[bm],bl,0,false))>0)}}}return bi};bh.prototype.isDimensionInsideRoom=function(bl,bk,bj){var bi=java.awt.geom.AffineTransform.getRotateInstance(Math.atan2(bj[1]-bk[1],bj[0]-bk[0]),bk[0],bk[1]);var bm=[(bk[0]+java.awt.geom.Point2D.distance(bk[0],bk[1],bj[0],bj[1])/2),bk[1]+1];bi.transform(bm,0,bm,0,1);return bl.containsPoint(bm[0],bm[1],0)};bh.prototype.getRoomSideAngle=function(bj,bq){var bs=bj.getPoints();var br=bs[bq];var bo=bs[(bq+bs.length-1)%bs.length];var bl=bs[(bq+bs.length-2)%bs.length];var bt=java.awt.geom.Point2D.distance(bo[0],bo[1],bs[bq][0],bs[bq][1]);var bp=java.awt.geom.Point2D.distance(bl[0],bl[1],bo[0],bo[1]);if(bl!==br&&bt!==0&&bp!==0){var bn=(br[0]-bo[0])/bt;var bu=(br[1]-bo[1])/bt;var bi=(bo[0]-bl[0])/bp;var bk=(bo[1]-bl[1])/bp;var bm=(Math.round(180-(function(bv){return bv*180/Math.PI})(Math.atan2(bu*bi-bn*bk,bn*bi+bu*bk)))|0);if(bm>180){bm-=360}return bm}if(bt===0){return 0}else{return(Math.round((function(bv){return bv*180/Math.PI})(Math.atan2(bo[1]-br[1],br[0]-bo[0])))|0)}};bh.prototype.showRoomAngleFeedback=function(bm,bl){var bj=bm.getPoints();if(this.roomSideAngleToolTipFeedback!=null&&this.roomSideAngleToolTipFeedback.length>0&&bj.length>2){var bi=bj[(bl+bj.length-1)%bj.length];var bk=bj[(bl+bj.length-2)%bj.length];if(this.getRoomSideAngle(bm,bl)>0){this.__parent.getView().setAngleFeedback(bi[0],bi[1],bk[0],bk[1],bj[bl][0],bj[bl][1])}else{this.__parent.getView().setAngleFeedback(bi[0],bi[1],bj[bl][0],bj[bl][1],bk[0],bk[1])}}};return bh}(al.ControllerState));al.AbstractRoomState=a8;a8.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractRoomState";var a6=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedRoom===undefined){bj.selectedRoom=null}if(bj.oldNameXOffset===undefined){bj.oldNameXOffset=0}if(bj.oldNameYOffset===undefined){bj.oldNameYOffset=0}if(bj.xLastMouseMove===undefined){bj.xLastMouseMove=0}if(bj.yLastMouseMove===undefined){bj.yLastMouseMove=0}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldNameXOffset=this.selectedRoom.getNameXOffset();this.oldNameYOffset=this.selectedRoom.getNameYOffset();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bi,bk){if(this.alignmentActivated){var bj=new al.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bi,bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bi=bj.getX();bk=bj.getY()}this.selectedRoom.setNameXOffset(this.selectedRoom.getNameXOffset()+bi-this.xLastMouseMove);this.selectedRoom.setNameYOffset(this.selectedRoom.getNameYOffset()+bk-this.yLastMouseMove);this.xLastMouseMove=bi;this.yLastMouseMove=bk;this.__parent.getView().makePointVisible(bi,bk)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postRoomNameOffset(this.selectedRoom,this.oldNameXOffset,this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedRoom.setNameXOffset(this.oldNameXOffset);this.selectedRoom.setNameYOffset(this.oldNameYOffset);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};return bg}(al.ControllerState));al.RoomNameOffsetState=a6;a6.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameOffsetState";var ai=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedRoom===undefined){bj.selectedRoom=null}if(bj.oldNameAngle===undefined){bj.oldNameAngle=0}if(bj.angleMousePress===undefined){bj.angleMousePress=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedRoom.getXCenter()-this.selectedRoom.getNameXOffset());this.oldNameAngle=this.selectedRoom.getNameAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bi,bm){if(bi!==this.selectedRoom.getXCenter()+this.selectedRoom.getNameXOffset()||bm!==this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()){var bl=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getNameYOffset()-bm,bi-this.selectedRoom.getXCenter()-this.selectedRoom.getNameXOffset());var bk=this.oldNameAngle-bl+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bj=2*Math.PI/bg.STEP_COUNT;bk=Math.round(bk/bj)*bj}this.selectedRoom.setNameAngle(bk);this.__parent.getView().makePointVisible(bi,bm)}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postRoomNameRotation(this.selectedRoom,this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedRoom.setNameAngle(this.oldNameAngle);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};bg.STEP_COUNT=24;return bg}(al.ControllerState));al.RoomNameRotationState=ai;ai.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomNameRotationState";var bb=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedRoom===undefined){bj.selectedRoom=null}if(bj.oldAreaXOffset===undefined){bj.oldAreaXOffset=0}if(bj.oldAreaYOffset===undefined){bj.oldAreaYOffset=0}if(bj.xLastMouseMove===undefined){bj.xLastMouseMove=0}if(bj.yLastMouseMove===undefined){bj.yLastMouseMove=0}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldAreaXOffset=this.selectedRoom.getAreaXOffset();this.oldAreaYOffset=this.selectedRoom.getAreaYOffset();this.xLastMouseMove=this.__parent.getXLastMousePress();this.yLastMouseMove=this.__parent.getYLastMousePress();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bi,bk){if(this.alignmentActivated){var bj=new al.PointWithAngleMagnetism(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bi,bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),this.__parent.getView().getPixelLength(),4);bi=bj.getX();bk=bj.getY()}this.selectedRoom.setAreaXOffset(this.selectedRoom.getAreaXOffset()+bi-this.xLastMouseMove);this.selectedRoom.setAreaYOffset(this.selectedRoom.getAreaYOffset()+bk-this.yLastMouseMove);this.xLastMouseMove=bi;this.yLastMouseMove=bk;this.__parent.getView().makePointVisible(bi,bk)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postRoomAreaOffset(this.selectedRoom,this.oldAreaXOffset,this.oldAreaYOffset);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedRoom.setAreaXOffset(this.oldAreaXOffset);this.selectedRoom.setAreaYOffset(this.oldAreaYOffset);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};return bg}(al.ControllerState));al.RoomAreaOffsetState=bb;bb.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaOffsetState";var F=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedRoom===undefined){bj.selectedRoom=null}if(bj.oldAreaAngle===undefined){bj.oldAreaAngle=0}if(bj.angleMousePress===undefined){bj.angleMousePress=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.enter=function(){this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedRoom.getXCenter()-this.selectedRoom.getAreaXOffset());this.oldAreaAngle=this.selectedRoom.getAreaAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bh.prototype.moveMouse=function(bi,bm){if(bi!==this.selectedRoom.getXCenter()+this.selectedRoom.getAreaXOffset()||bm!==this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()){var bl=Math.atan2(this.selectedRoom.getYCenter()+this.selectedRoom.getAreaYOffset()-bm,bi-this.selectedRoom.getXCenter()-this.selectedRoom.getAreaXOffset());var bk=this.oldAreaAngle-bl+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bj=2*Math.PI/bh.STEP_COUNT;bk=Math.round(bk/bj)*bj}this.selectedRoom.setAreaAngle(bk);this.__parent.getView().makePointVisible(bi,bm)}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postRoomAreaRotation(this.selectedRoom,this.oldAreaAngle);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bh.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bh.prototype.escape=function(){this.selectedRoom.setAreaAngle(this.oldAreaAngle);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedRoom=null};bh.STEP_COUNT=24;return bh}(al.ControllerState));al.RoomAreaRotationState=F;F.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomAreaRotationState";var e=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.polylineSegmentLengthToolTipFeedback===undefined){bj.polylineSegmentLengthToolTipFeedback=null}if(bj.polylineSegmentAngleToolTipFeedback===undefined){bj.polylineSegmentAngleToolTipFeedback=null}return bj}bg.prototype.enter=function(){this.polylineSegmentLengthToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"polylineSegmentLengthToolTipFeedback");try{this.polylineSegmentAngleToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"polylineSegmentAngleToolTipFeedback")}catch(bi){}};bg.prototype.getToolTipFeedbackText=function(bi,bl){var bk=this.getPolylineSegmentLength(bi,bl);var bm=this.getPolylineSegmentAngle(bi,bl);var bj="<html>"+CoreTools.format(this.polylineSegmentLengthToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bk));if(this.polylineSegmentAngleToolTipFeedback!=null&&this.polylineSegmentAngleToolTipFeedback.length>0){bj+="<br>"+CoreTools.format(this.polylineSegmentAngleToolTipFeedback,bm)}return bj};bg.prototype.getPolylineSegmentLength=function(bi,bl){if(bl===0&&!bi.isClosedPath()){bl++}var bk=bi.getPoints();var bj=bk[(bl+bk.length-1)%bk.length];return java.awt.geom.Point2D.distance(bj[0],bj[1],bk[bl][0],bk[bl][1])};bg.prototype.getPolylineSegmentAngle=function(br,bq){if(bq===0&&!br.isClosedPath()){bq++}var bu=br.getPoints();var bs=bu[bq];var bl=bu[(bq+bu.length-1)%bu.length];var bj=bu[(bq+bu.length-2)%bu.length];var bm=java.awt.geom.Point2D.distance(bl[0],bl[1],bu[bq][0],bu[bq][1]);var bk=java.awt.geom.Point2D.distance(bj[0],bj[1],bl[0],bl[1]);if(bj!==bs&&bm!==0&&bk!==0){var bp=(bs[0]-bl[0])/bm;var bn=(bs[1]-bl[1])/bm;var bt=(bl[0]-bj[0])/bk;var bo=(bl[1]-bj[1])/bk;var bi=(Math.round(180-(function(bv){return bv*180/Math.PI})(Math.atan2(bn*bt-bp*bo,bp*bt+bn*bo)))|0);if(bi>180){bi-=360}return bi}if(bm===0){return 0}else{return(Math.round((function(bv){return bv*180/Math.PI})(Math.atan2(bl[1]-bs[1],bs[0]-bl[0])))|0)}};bg.prototype.showPolylineAngleFeedback=function(bi,bm){var bk=bi.getPoints();if(this.polylineSegmentAngleToolTipFeedback!=null&&this.polylineSegmentAngleToolTipFeedback.length>0&&(bm>=2||bk.length>2&&bi.isClosedPath())){var bj=bk[(bm+bk.length-1)%bk.length];var bl=bk[(bm+bk.length-2)%bk.length];this.__parent.getView().setAngleFeedback(bj[0],bj[1],bl[0],bl[1],bk[bm][0],bk[bm][1])}};return bg}(al.ControllerState));al.AbstractPolylineState=e;e.__class="com.eteks.sweethome3d.viewcontroller.PlanController.AbstractPolylineState";var a3=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedLabel===undefined){bj.selectedLabel=null}if(bj.oldAngle===undefined){bj.oldAngle=0}if(bj.angleMousePress===undefined){bj.angleMousePress=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){this.selectedLabel=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedLabel.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedLabel.getX());this.oldAngle=this.selectedLabel.getAngle();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true)};bg.prototype.moveMouse=function(bi,bm){if(bi!==this.selectedLabel.getX()||bm!==this.selectedLabel.getY()){var bl=Math.atan2(this.selectedLabel.getY()-bm,bi-this.selectedLabel.getX());var bk=this.oldAngle-bl+this.angleMousePress;if(this.alignmentActivated||this.magnetismEnabled){var bj=2*Math.PI/bg.STEP_COUNT;bk=Math.round(bk/bj)*bj}this.selectedLabel.setAngle(bk);this.__parent.getView().makePointVisible(bi,bm)}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postLabelRotation(this.selectedLabel,this.oldAngle);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedLabel.setAngle(this.oldAngle);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){this.__parent.getView().setResizeIndicatorVisible(false);this.selectedLabel=null};bg.STEP_COUNT=24;return bg}(al.ControllerState));al.LabelRotationState=a3;a3.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelRotationState";var T=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.deltaYToElevationPoint===undefined){bj.deltaYToElevationPoint=0}if(bj.selectedLabel===undefined){bj.selectedLabel=null}if(bj.oldElevation===undefined){bj.oldElevation=0}if(bj.elevationToolTipFeedback===undefined){bj.elevationToolTipFeedback=null}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){this.elevationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"elevationToolTipFeedback");this.selectedLabel=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bk=this.__parent.getItemTextStyle(this.selectedLabel,this.selectedLabel.getStyle());var bj=this.__parent.getView().getTextBounds(this.selectedLabel.getText(),bk,this.selectedLabel.getX(),this.selectedLabel.getY(),this.selectedLabel.getAngle());this.deltaYToElevationPoint=this.__parent.getYLastMousePress()-(bj[2][1]+bj[3][1])/2;this.oldElevation=this.selectedLabel.getElevation();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldElevation),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bg.prototype.moveMouse=function(bk,bo){var bj=this.__parent.getView();var bn=this.__parent.getItemTextStyle(this.selectedLabel,this.selectedLabel.getStyle());var bm=this.__parent.getView().getTextBounds(this.selectedLabel.getText(),bn,this.selectedLabel.getX(),this.selectedLabel.getY(),this.selectedLabel.getAngle());var bi=bo-this.deltaYToElevationPoint-(bm[2][1]+bm[3][1])/2;var bl=this.oldElevation-bi;bl=Math.min(Math.max(bl,0),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumElevation());if(this.magnetismEnabled){bl=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bl,bj.getPixelLength())}this.selectedLabel.setElevation(bl);bj.makePointVisible(bk,bo);if(this.__parent.feedbackDisplayed){bj.setToolTipFeedback(this.getToolTipFeedbackText(bl),bk,bo)}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postLabelElevation(this.selectedLabel,this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedLabel.setElevation(this.oldElevation);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedLabel=null};bg.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.elevationToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bi))};return bg}(al.ControllerState));al.LabelElevationState=T;T.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelElevationState";var M=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this)||this;bj.__parent=bi;if(bj.selectedCompass===undefined){bj.selectedCompass=null}if(bj.angleMousePress===undefined){bj.angleMousePress=0}if(bj.oldNorthDirection===undefined){bj.oldNorthDirection=0}if(bj.rotationToolTipFeedback===undefined){bj.rotationToolTipFeedback=null}return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.isModificationState=function(){return true};bh.prototype.isBasePlanModificationState=function(){return true};bh.prototype.enter=function(){this.rotationToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"rotationToolTipFeedback");this.selectedCompass=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.angleMousePress=Math.atan2(this.selectedCompass.getY()-this.__parent.getYLastMousePress(),this.__parent.getXLastMousePress()-this.selectedCompass.getX());this.oldNorthDirection=this.selectedCompass.getNorthDirection();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldNorthDirection),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bh.prototype.moveMouse=function(bk,bn){if(bk!==this.selectedCompass.getX()||bn!==this.selectedCompass.getY()){var bm=Math.atan2(this.selectedCompass.getY()-bn,bk-this.selectedCompass.getX());var bj=this.oldNorthDirection-bm+this.angleMousePress;var bl=Math.PI/180;bj=Math.round(bj/bl)*bl;bj=((bj+2*Math.PI)%(2*Math.PI));this.selectedCompass.setNorthDirection(bj);var bi=this.__parent.getView();bi.makePointVisible(bk,bn);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(bj),bk,bn)}}};bh.prototype.releaseMouse=function(bi,bj){this.__parent.postCompassRotation(this.selectedCompass,this.oldNorthDirection);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.escape=function(){this.selectedCompass.setNorthDirection(this.oldNorthDirection);this.__parent.setState(this.__parent.getSelectionState())};bh.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedCompass=null};bh.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.rotationToolTipFeedback,Math.round((function(bj){return bj*180/Math.PI})(bi)))};return bh}(al.ControllerState));al.CompassRotationState=M;M.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassRotationState";var aj=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this)||this;bj.__parent=bi;if(bj.selectedCompass===undefined){bj.selectedCompass=null}if(bj.oldDiameter===undefined){bj.oldDiameter=0}if(bj.deltaXToResizePoint===undefined){bj.deltaXToResizePoint=0}if(bj.deltaYToResizePoint===undefined){bj.deltaYToResizePoint=0}if(bj.resizeToolTipFeedback===undefined){bj.resizeToolTipFeedback=null}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){this.resizeToolTipFeedback=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLocalizedString(al,"diameterToolTipFeedback");this.selectedCompass=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bk=this.selectedCompass.getPoints();var bl=(bk[1][0]+bk[2][0])/2;var bj=(bk[1][1]+bk[2][1])/2;this.deltaXToResizePoint=this.__parent.getXLastMousePress()-bl;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-bj;this.oldDiameter=this.selectedCompass.getDiameter();var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.oldDiameter),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress())}};bg.prototype.moveMouse=function(bk,bl){var bj=this.__parent.getView();var bi=java.awt.geom.Point2D.distance(this.selectedCompass.getX(),this.selectedCompass.getY(),bk-this.deltaXToResizePoint,bl-this.deltaYToResizePoint)*2;bi=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMagnetizedLength(bi,bj.getPixelLength());bi=Math.min(Math.max(bi,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMinimumLength()),this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()/10);this.selectedCompass.setDiameter(bi);bj.makePointVisible(bk,bl);if(this.__parent.feedbackDisplayed){bj.setToolTipFeedback(this.getToolTipFeedbackText(bi),bk,bl)}};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postCompassResize(this.selectedCompass,this.oldDiameter);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.escape=function(){this.selectedCompass.setDiameter(this.oldDiameter);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedCompass=null};bg.prototype.getToolTipFeedbackText=function(bi){return CoreTools.format(this.resizeToolTipFeedback,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getFormatWithUnit().format(bi))};return bg}(al.ControllerState));al.CompassResizeState=aj;aj.__class="com.eteks.sweethome3d.viewcontroller.PlanController.CompassResizeState";var aY=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this,bi)||this;bj.__parent=bi;bj.selectionListener=new bh.SelectionState$0(bj);return bj}bh.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bh.prototype.enter=function(){if(this.__parent.getView()!=null){if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.addSelectionListener(this.selectionListener);this.selectionListener.selectionChanged(null)}};bh.prototype.moveMouse=function(bi,bj){if(this.__parent.getRotatedLabelAt(bi,bj)!=null||this.__parent.getYawRotatedCameraAt(bi,bj)!=null||this.__parent.getPitchRotatedCameraAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getElevatedLabelAt(bi,bj)!=null||this.__parent.getElevatedCameraAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ELEVATION)}else{if(this.__parent.getRoomNameAt(bi,bj)!=null||this.__parent.getRoomAreaAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.getRoomRotatedNameAt(bi,bj)!=null||this.__parent.getRoomRotatedAreaAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getResizedDimensionLineStartAt(bi,bj)!=null||this.__parent.getResizedDimensionLineEndAt(bi,bj)!=null||this.__parent.getHeightResizedDimensionLineAt(bi,bj)!=null||this.__parent.getWidthAndDepthResizedPieceOfFurnitureAt(bi,bj)!=null||this.__parent.getResizedWallStartAt(bi,bj)!=null||this.__parent.getResizedWallEndAt(bi,bj)!=null||this.__parent.getResizedPolylineAt(bi,bj)!=null||this.__parent.getResizedRoomAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.getPitchRotatedPieceOfFurnitureAt(bi,bj)!=null||this.__parent.getRollRotatedPieceOfFurnitureAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getModifiedLightPowerAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.POWER)}else{if(this.__parent.getOffsetDimensionLineAt(bi,bj)!=null||this.__parent.getHeightResizedPieceOfFurnitureAt(bi,bj)!=null||this.__parent.getArcExtentWallAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.HEIGHT)}else{if(this.__parent.getRotatedPieceOfFurnitureAt(bi,bj)!=null||this.__parent.getPitchRotatedDimensionLineAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getElevatedPieceOfFurnitureAt(bi,bj)!=null||this.__parent.getElevatedDimensionLineAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ELEVATION)}else{if(this.__parent.getPieceOfFurnitureNameAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.getPieceOfFurnitureRotatedNameAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getRotatedCompassAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.ROTATION)}else{if(this.__parent.getResizedCompassAt(bi,bj)!=null){this.__parent.getView().setCursor(PlanView.CursorType.RESIZE)}else{if(this.__parent.isItemSelectedAt(bi,bj)){this.__parent.getView().setCursor(PlanView.CursorType.MOVE)}else{this.__parent.getView().setCursor(PlanView.CursorType.SELECTION)}}}}}}}}}}}}}}}};bh.prototype.pressMouse=function(bj,bn,bi,bk,bm){if(bi===1){if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.moveMouse(bj,bn)}if(this.__parent.getRotatedLabelAt(bj,bn)!=null){this.__parent.setState(this.__parent.getLabelRotationState())}else{if(this.__parent.getYawRotatedCameraAt(bj,bn)!=null){this.__parent.setState(this.__parent.getCameraYawRotationState())}else{if(this.__parent.getPitchRotatedCameraAt(bj,bn)!=null){this.__parent.setState(this.__parent.getCameraPitchRotationState())}else{if(this.__parent.getElevatedLabelAt(bj,bn)!=null){this.__parent.setState(this.__parent.getLabelElevationState())}else{if(this.__parent.getElevatedCameraAt(bj,bn)!=null){this.__parent.setState(this.__parent.getCameraElevationState())}else{if(this.__parent.getRoomNameAt(bj,bn)!=null){this.__parent.setState(this.__parent.getRoomNameOffsetState())}else{if(this.__parent.getRoomRotatedNameAt(bj,bn)!=null){this.__parent.setState(this.__parent.getRoomNameRotationState())}else{if(this.__parent.getRoomAreaAt(bj,bn)!=null){this.__parent.setState(this.__parent.getRoomAreaOffsetState())}else{if(this.__parent.getRoomRotatedAreaAt(bj,bn)!=null){this.__parent.setState(this.__parent.getRoomAreaRotationState())}else{if(this.__parent.getResizedDimensionLineStartAt(bj,bn)!=null||this.__parent.getResizedDimensionLineEndAt(bj,bn)!=null){this.__parent.setState(this.__parent.getDimensionLineResizeState())}else{if(this.__parent.getHeightResizedDimensionLineAt(bj,bn)!=null){this.__parent.setState(this.__parent.getDimensionLineHeightState())}else{if(this.__parent.getWidthAndDepthResizedPieceOfFurnitureAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureResizeState())}else{if(this.__parent.getResizedWallStartAt(bj,bn)!=null||this.__parent.getResizedWallEndAt(bj,bn)!=null){this.__parent.setState(this.__parent.getWallResizeState())}else{if(this.__parent.getResizedRoomAt(bj,bn)!=null){this.__parent.setState(this.__parent.getRoomResizeState())}else{if(this.__parent.getOffsetDimensionLineAt(bj,bn)!=null){this.__parent.setState(this.__parent.getDimensionLineOffsetState())}else{if(this.__parent.getResizedPolylineAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPolylineResizeState())}else{if(this.__parent.getPitchRotatedPieceOfFurnitureAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurniturePitchRotationState())}else{if(this.__parent.getRollRotatedPieceOfFurnitureAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureRollRotationState())}else{if(this.__parent.getModifiedLightPowerAt(bj,bn)!=null){this.__parent.setState(this.__parent.getLightPowerModificationState())}else{if(this.__parent.getHeightResizedPieceOfFurnitureAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureHeightState())}else{if(this.__parent.getArcExtentWallAt(bj,bn)!=null){this.__parent.setState(this.__parent.getWallArcExtentState())}else{if(this.__parent.getRotatedPieceOfFurnitureAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureRotationState())}else{if(this.__parent.getPitchRotatedDimensionLineAt(bj,bn)!=null){this.__parent.setState(this.__parent.getDimensionLinePitchRotationState())}else{if(this.__parent.getElevatedPieceOfFurnitureAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureElevationState())}else{if(this.__parent.getElevatedDimensionLineAt(bj,bn)!=null){this.__parent.setState(this.__parent.getDimensionLineElevationState())}else{if(this.__parent.getPieceOfFurnitureNameAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureNameOffsetState())}else{if(this.__parent.getPieceOfFurnitureRotatedNameAt(bj,bn)!=null){this.__parent.setState(this.__parent.getPieceOfFurnitureNameRotationState())}else{if(this.__parent.getRotatedCompassAt(bj,bn)!=null){this.__parent.setState(this.__parent.getCompassRotationState())}else{if(this.__parent.getResizedCompassAt(bj,bn)!=null){this.__parent.setState(this.__parent.getCompassResizeState())}else{if(!bk&&(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH||this.__parent.getSelectableItemAt(bj,bn)!=null)){this.__parent.setState(this.__parent.getSelectionMoveState())}else{this.__parent.setState(this.__parent.getRectangleSelectionState())}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}else{if(bi===2){var bl=this.__parent.getSelectableItemAt(bj,bn);if(!bk&&bl!=null){this.__parent.modifySelectedItem()}}}};bh.prototype.exit=function(){if(this.__parent.getView()!=null){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.removeSelectionListener(this.selectionListener);this.__parent.getView().setResizeIndicatorVisible(false)}};return bh}(al.AbstractModeChangeState));al.SelectionState=aY;aY.__class="com.eteks.sweethome3d.viewcontroller.PlanController.SelectionState";(function(bg){var bh=(function(){function bi(bj){this.__parent=bj}bi.prototype.selectionChanged=function(bj){var bk=this.__parent.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.__parent.__parent.getView().setResizeIndicatorVisible(bk.length===1&&(this.__parent.__parent.isItemResizable(bk[0])||this.__parent.__parent.isItemMovable(bk[0])))};return bi}());bg.SelectionState$0=bh;bh.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"]})(aY=al.SelectionState||(al.SelectionState={}));var r=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this,bi)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}return bj}bh.prototype.getMode=function(){return al.Mode.WALL_CREATION_$LI$()};bh.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW);this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};bh.prototype.moveMouse=function(bj,bk){if(this.magnetismEnabled){var bi=new al.WallPointWithAngleMagnetism(this.__parent,null,bj,bk,bj,bk);bj=bi.getX();bk=bi.getY()}if(this.__parent.feedbackDisplayed){this.__parent.getView().setAlignmentFeedback(Wall,null,bj,bk,false)}};bh.prototype.pressMouse=function(bj,bm,bi,bk,bl){this.__parent.setState(this.__parent.getWallDrawingState())};bh.prototype.setEditionActivated=function(bi){if(bi){this.__parent.setState(this.__parent.getWallDrawingState());this.setEditionActivated(bi)}};bh.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};bh.prototype.exit=function(){this.__parent.getView().deleteFeedback()};return bh}(al.AbstractModeChangeState));al.WallCreationState=r;r.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallCreationState";var B=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}return bj}bg.prototype.getMode=function(){return al.Mode.DIMENSION_LINE_CREATION_$LI$()};bg.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW);this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};bg.prototype.moveMouse=function(bj,bk){if(this.__parent.feedbackDisplayed){this.__parent.getView().setAlignmentFeedback(DimensionLine,null,bj,bk,false);var bi=this.__parent.getMeasuringDimensionLineAt(bj,bk,this.magnetismEnabled);if(bi!=null){this.__parent.getView().setDimensionLinesFeedback([bi].slice(0))}else{this.__parent.getView().setDimensionLinesFeedback(null)}}};bg.prototype.pressMouse=function(bj,bm,bi,bk,bl){if(bi===1){if(this.__parent.wasDuplicationActivatedLastMousePress()){this.__parent.getView().deleteFeedback();this.__parent.createDimensionLine(bj,bm)}else{this.__parent.setState(this.__parent.getDimensionLineDrawingState())}}};bg.prototype.setEditionActivated=function(bi){if(bi){this.__parent.setState(this.__parent.getDimensionLineDrawingState());this.setEditionActivated(bi)}};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};bg.prototype.exit=function(){this.__parent.getView().deleteFeedback()};return bg}(al.AbstractModeChangeState));al.DimensionLineCreationState=B;B.__class="com.eteks.sweethome3d.viewcontroller.PlanController.DimensionLineCreationState";var b=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this,bi)||this;bj.__parent=bi;if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}return bj}bh.prototype.getMode=function(){return al.Mode.ROOM_CREATION_$LI$()};bh.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW);this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress())};bh.prototype.moveMouse=function(bj,bl){if(this.__parent.feedbackDisplayed&&this.magnetismEnabled){var bi=new al.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,bj,bl);if(bi.isMagnetized()){this.__parent.getView().setAlignmentFeedback(Room,null,bi.getX(),bi.getY(),bi.isMagnetized())}else{var bk=new al.RoomPointWithAngleMagnetism(this.__parent,null,-1,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove(),this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());this.__parent.getView().setAlignmentFeedback(Room,null,bk.getX(),bk.getY(),bi.isMagnetized())}}else{this.__parent.getView().setAlignmentFeedback(Room,null,bj,bl,false)}};bh.prototype.pressMouse=function(bj,bm,bi,bk,bl){this.__parent.setState(this.__parent.getRoomDrawingState())};bh.prototype.setEditionActivated=function(bi){if(bi){this.__parent.setState(this.__parent.getRoomDrawingState());this.setEditionActivated(bi)}};bh.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.__parent.getPointerTypeLastMousePress()!==View.PointerType.TOUCH){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};bh.prototype.exit=function(){this.__parent.getView().deleteFeedback()};return bh}(al.AbstractModeChangeState));al.RoomCreationState=b;b.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomCreationState";var a1=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;return bj}bg.prototype.getMode=function(){return al.Mode.POLYLINE_CREATION_$LI$()};bg.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW)};bg.prototype.pressMouse=function(bj,bm,bi,bk,bl){this.__parent.setState(this.__parent.getPolylineDrawingState())};bg.prototype.setEditionActivated=function(bi){if(bi){this.__parent.setState(this.__parent.getPolylineDrawingState());this.setEditionActivated(bi)}};return bg}(al.AbstractModeChangeState));al.PolylineCreationState=a1;a1.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineCreationState";var ad=(function(bg){__extends(bh,bg);function bh(bi){var bj=bg.call(this,bi)||this;bj.__parent=bi;return bj}bh.prototype.getMode=function(){return al.Mode.LABEL_CREATION_$LI$()};bh.prototype.enter=function(){this.__parent.getView().setCursor(PlanView.CursorType.DRAW)};bh.prototype.pressMouse=function(bj,bm,bi,bk,bl){this.__parent.createLabel(bj,bm);if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}};return bh}(al.AbstractModeChangeState));al.LabelCreationState=ad;ad.__class="com.eteks.sweethome3d.viewcontroller.PlanController.LabelCreationState";var ac=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.xStart===undefined){bj.xStart=0}if(bj.yStart===undefined){bj.yStart=0}if(bj.xLastEnd===undefined){bj.xLastEnd=0}if(bj.yLastEnd===undefined){bj.yLastEnd=0}if(bj.wallStartAtStart===undefined){bj.wallStartAtStart=null}if(bj.wallEndAtStart===undefined){bj.wallEndAtStart=null}if(bj.newWall===undefined){bj.newWall=null}if(bj.wallStartAtEnd===undefined){bj.wallStartAtEnd=null}if(bj.wallEndAtEnd===undefined){bj.wallEndAtEnd=null}if(bj.lastWall===undefined){bj.lastWall=null}if(bj.oldSelection===undefined){bj.oldSelection=null}if(bj.oldBasePlanLocked===undefined){bj.oldBasePlanLocked=false}if(bj.oldAllLevelsSelection===undefined){bj.oldAllLevelsSelection=false}if(bj.newWalls===undefined){bj.newWalls=null}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}if(bj.roundWall===undefined){bj.roundWall=false}if(bj.lastWallCreationTime===undefined){bj.lastWallCreationTime=0}if(bj.wallArcExtent===undefined){bj.wallArcExtent=null}return bj}bg.prototype.getMode=function(){return al.Mode.WALL_CREATION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.setMode=function(bi){this.escape();if(bi===al.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bi===al.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bi===al.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bi===al.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bi===al.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bi===al.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};bg.prototype.enter=function(){bh.prototype.enter.call(this);this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());this.xStart=this.__parent.getXLastMouseMove();this.yStart=this.__parent.getYLastMouseMove();this.wallEndAtStart=this.__parent.getWallEndAt(this.xStart,this.yStart,null);if(this.wallEndAtStart!=null){this.wallStartAtStart=null;this.xStart=this.wallEndAtStart.getXEnd();this.yStart=this.wallEndAtStart.getYEnd()}else{this.wallStartAtStart=this.__parent.getWallStartAt(this.xStart,this.yStart,null);if(this.wallStartAtStart!=null){this.xStart=this.wallStartAtStart.getXStart();this.yStart=this.wallStartAtStart.getYStart()}else{if(this.magnetismEnabled){var bi=new al.WallPointWithAngleMagnetism(this.__parent,null,this.xStart,this.yStart,this.xStart,this.yStart);this.xStart=bi.getX();this.yStart=bi.getY()}}}this.newWall=null;this.wallStartAtEnd=null;this.wallEndAtEnd=null;this.lastWall=null;this.newWalls=([]);this.lastWallCreationTime=-1;this.__parent.deselectAll();this.setDuplicationActivated(this.__parent.wasDuplicationActivatedLastMousePress());if(this.__parent.feedbackDisplayed){this.__parent.getView().setAlignmentFeedback(Wall,null,this.xStart,this.yStart,false)}};bg.prototype.moveMouse=function(bl,bn){var bk=this.__parent.getView();var bj;var bm;if(this.alignmentActivated){var bi=new al.PointWithAngleMagnetism(this.xStart,this.yStart,bl,bn,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bk.getPixelLength());bj=bi.getX();bm=bi.getY()}else{if(this.magnetismEnabled){var bi=new al.WallPointWithAngleMagnetism(this.__parent,this.newWall,this.xStart,this.yStart,bl,bn);bj=bi.getX();bm=bi.getY()}else{bj=bl;bm=bn}}if(this.newWall==null){this.newWall=this.__parent.createWall(this.xStart,this.yStart,bj,bm,this.wallStartAtStart,this.wallEndAtStart);(this.newWalls.push(this.newWall)>0)}else{if(this.wallArcExtent!=null){this.wallArcExtent=this.getArcExtent(this.newWall.getXStart(),this.newWall.getXEnd(),this.newWall.getYStart(),this.newWall.getYEnd(),bl,bn);if(this.alignmentActivated||this.magnetismEnabled){this.wallArcExtent=(function(bo){return bo*Math.PI/180})(Math.round((function(bo){return bo*180/Math.PI})(this.wallArcExtent)))}this.newWall.setArcExtent(this.wallArcExtent)}else{this.newWall.setXEnd(bj);this.newWall.setYEnd(bm)}}if(this.__parent.feedbackDisplayed){bk.setToolTipFeedback(this.getToolTipFeedbackText(this.newWall,false),bl,bn);bk.setAlignmentFeedback(Wall,this.newWall,bj,bm,false);this.showWallAngleFeedback(this.newWall,false)}this.wallStartAtEnd=this.__parent.getWallStartAt(bj,bm,this.newWall);if(this.wallStartAtEnd!=null){this.wallEndAtEnd=null;this.__parent.selectItem(this.wallStartAtEnd)}else{this.wallEndAtEnd=this.__parent.getWallEndAt(bj,bm,this.newWall);if(this.wallEndAtEnd!=null){this.__parent.selectItem(this.wallEndAtEnd)}else{this.__parent.deselectAll()}}bk.makePointVisible(bl,bn);this.xLastEnd=bj;this.yLastEnd=bm};bg.prototype.pressMouse=function(bj,bn,bi,bk,bm){if(bi===2){var bl=this.__parent.getSelectableItemAt(bj,bn);if(this.newWalls.length===0&&(bl!=null&&bl instanceof Room)){this.createWallsAroundRoom(bl)}else{if(this.roundWall&&this.newWall!=null){this.endWallCreation()}if(this.lastWall!=null){this.__parent.joinNewWallEndToWall(this.lastWall,this.wallStartAtEnd,this.wallEndAtEnd)}}this.validateDrawnWalls()}else{if(this.newWall!=null&&this.newWall.getStartPointToEndPointDistance()>0){if(this.roundWall&&this.wallArcExtent==null){this.wallArcExtent=Math.PI;this.newWall.setArcExtent(this.wallArcExtent);if(this.__parent.feedbackDisplayed){this.__parent.getView().setToolTipFeedback(this.getToolTipFeedbackText(this.newWall,false),bj,bn)}}else{this.__parent.getView().deleteToolTipFeedback();this.__parent.selectItem(this.newWall);this.endWallCreation()}}}};bg.prototype.createWallsAroundRoom=function(bK){if(bK.isSingular()){var bB=bK.getPoints();var bs=(bB.slice(0).slice(0));if(!bK.isClockwise()){bs.reverse()}for(var bG=0;bG<bs.length;){var bD=bs[bG];var bI=bs[(bG+1)%bs.length];if(bD[0]===bI[0]&&bD[1]===bI[1]){bs.splice(bG,1)[0]}else{bG++}}bB=bs.slice(0);var bt=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getNewWallThickness()/2;var bN=(function(bR){var bQ=[];while(bR-->0){bQ.push(null)}return bQ})(bB.length);for(var bG=0;bG<bB.length;bG++){var bD=bB[bG];var bC=bB[(bG+bB.length-1)%bB.length];var bI=bB[(bG+1)%bB.length];var bF=Math.atan2(bD[0]-bC[0],bC[1]-bD[1]);var bM=(Math.cos(bF)*bt);var bL=(Math.sin(bF)*bt);var bo=[bC[0]-bM,bC[1]-bL];var bn=[bD[0]-bM,bD[1]-bL];var bO=Math.atan2(bI[0]-bD[0],bD[1]-bI[1]);bM=(Math.cos(bO)*bt);bL=(Math.sin(bO)*bt);var bm=[bD[0]-bM,bD[1]-bL];var bl=[bI[0]-bM,bI[1]-bL];bN[bG]=al.computeIntersection(bo,bn,bm,bl)}var bu=null;var bw=this.__parent.getWallsArea(false);var bH=0.05;for(var bG=0;bG<bN.length;bG++){var bz=bN[bG];var bv=bN[(bG+1)%bB.length];var by=new java.awt.geom.Area(this.__parent.getPath(new Wall(bz[0],bz[1],bv[0],bv[1],bH,0).getPoints$()));by.subtract(bw);var bi=this.__parent.getAreaPaths(by);var bk=([]);var bP=0;for(var bE=0;bE<bi.length;bE++){var bj=this.__parent.getPathPoints(bi[bE],false);if(bj.length>4){bj=this.__parent.getPathPoints(bi[bE],true)}if(bj.length===4){var bo=void 0;var bn=void 0;if(java.awt.geom.Point2D.distanceSq(bj[0][0],bj[0][1],bj[1][0],bj[1][1])<java.awt.geom.Point2D.distanceSq(bj[0][0],bj[0][1],bj[3][0],bj[3][1])){bo=[(bj[0][0]+bj[1][0])/2,(bj[0][1]+bj[1][1])/2];bn=[(bj[2][0]+bj[3][0])/2,(bj[2][1]+bj[3][1])/2]}else{bo=[(bj[0][0]+bj[3][0])/2,(bj[0][1]+bj[3][1])/2];bn=[(bj[1][0]+bj[2][0])/2,(bj[1][1]+bj[2][1])/2]}var bA=void 0;var bx=void 0;if(java.awt.geom.Point2D.distanceSq(bo[0],bo[1],bz[0],bz[1])<java.awt.geom.Point2D.distanceSq(bn[0],bn[1],bz[0],bz[1])){bA=bo;bx=bn}else{bA=bn;bx=bo}if(java.awt.geom.Point2D.distanceSq(bA[0],bA[1],bx[0],bx[1])>0.01){(bk.push(this.__parent.createWall(bA[0],bA[1],bx[0],bx[1],null,bu!=null&&java.awt.geom.Point2D.distanceSq(bu.getXEnd(),bu.getYEnd(),bA[0],bA[1])<0.01?bu:null))>0)}else{bP++}}}if(bi.length>bP&&(bk.length==0)){var br=null;var bq=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getWalls();for(var bp=0;bp<bq.length;bp++){var bJ=bq[bp];if(bJ.isAtLevel(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())&&Math.abs(bJ.getXStart()-bz[0])<0.05&&Math.abs(bJ.getYStart()-bz[1])<0.05&&Math.abs(bJ.getXEnd()-bv[0])<0.05&&Math.abs(bJ.getYEnd()-bv[1])<0.05&&(bJ.getArcExtent()==null||bJ.getArcExtent()===0)){br=bJ;break}}if(br==null){(bk.push(this.__parent.createWall(bz[0],bz[1],bv[0],bv[1],null,bu))>0)}}if(bk.length>0){(function(bQ,bR){if(bR.compare){bQ.sort(function(bT,bS){return bR.compare(bT,bS)})}else{bQ.sort(bR)}})(bk,new bg.WallDrawingState$0(this,bz));(function(bR,bQ){return bR.push.apply(bR,bQ)})(this.newWalls,bk);bu=bk[bk.length-1]}else{bu=null}}if(bu!=null&&java.awt.geom.Point2D.distanceSq(bu.getXEnd(),bu.getYEnd(),this.newWalls[0].getXStart(),this.newWalls[0].getYStart())<0.01){this.__parent.joinNewWallEndToWall(bu,this.newWalls[0],null)}}};bg.prototype.validateDrawnWalls=function(){if(this.newWalls.length>0){this.__parent.postCreateWalls(this.newWalls,this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection);this.__parent.selectItems(this.newWalls)}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getWallCreationState())}};bg.prototype.endWallCreation=function(){this.lastWall=this.wallEndAtStart=this.newWall;this.wallStartAtStart=null;this.xStart=this.newWall.getXEnd();this.yStart=this.newWall.getYEnd();this.newWall=null;this.wallArcExtent=null};bg.prototype.setEditionActivated=function(bl){var bm=this;var bi=this.__parent.getView();if(bl){bi.deleteFeedback();if(this.newWalls.length===0&&this.wallEndAtStart==null&&this.wallStartAtStart==null){bi.setToolTipEditedProperties(["X","Y"],[this.xStart,this.yStart],this.xStart,this.yStart)}else{if(this.newWall==null){this.createNextWall()}if(this.wallArcExtent==null){bi.setToolTipEditedProperties(["LENGTH","ANGLE","THICKNESS"],[this.newWall.getLength(),this.getWallAngleInDegrees$com_eteks_sweethome3d_model_Wall(this.newWall),this.newWall.getThickness()],this.newWall.getXEnd(),this.newWall.getYEnd())}else{bi.setToolTipEditedProperties(["ARC_EXTENT"],[new Number((Math.round((function(bn){return bn*180/Math.PI})(this.wallArcExtent))|0)).valueOf()],this.newWall.getXEnd(),this.newWall.getYEnd())}}if(this.__parent.feedbackDisplayed){this.showWallFeedback()}}else{if(this.newWall==null){var bj=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bk=!bj.isMetric()?300:LengthUnit.footToCentimeter(10);this.xLastEnd=this.xStart+bk;this.yLastEnd=this.yStart;this.newWall=this.__parent.createWall(this.xStart,this.yStart,this.xLastEnd,this.yLastEnd,this.wallStartAtStart,this.wallEndAtStart);(this.newWalls.push(this.newWall)>0);bi.deleteFeedback();this.setEditionActivated(true)}else{if(this.roundWall&&this.wallArcExtent==null){this.wallArcExtent=Math.PI;this.newWall.setArcExtent(this.wallArcExtent);this.setEditionActivated(true)}else{if(Date.now()-this.lastWallCreationTime<300){if(this.newWalls.length>1){(function(bn){var bo=bn.indexOf(bm.newWall);if(bo>=0){bn.splice(bo,1);return true}else{return false}})(this.newWalls);this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(this.newWall)}this.validateDrawnWalls()}else{this.endWallCreation();if(this.newWalls.length>2&&this.wallStartAtEnd!=null){this.__parent.joinNewWallEndToWall(this.lastWall,this.wallStartAtEnd,null);this.validateDrawnWalls();return}this.createNextWall();bi.deleteToolTipFeedback();this.setEditionActivated(true)}}}}};bg.prototype.createNextWall=function(){var bk=this.wallEndAtStart!=null?this.wallEndAtStart:this.wallStartAtStart;var bj=Math.PI-Math.atan2(bk.getYStart()-bk.getYEnd(),bk.getXStart()-bk.getXEnd());bj-=Math.PI/2;var bi=bk.getStartPointToEndPointDistance();this.xLastEnd=(this.xStart+bi*Math.cos(bj));this.yLastEnd=(this.yStart-bi*Math.sin(bj));this.newWall=this.__parent.createWall(this.xStart,this.yStart,this.xLastEnd,this.yLastEnd,this.wallStartAtStart,bk);this.newWall.setThickness(bk.getThickness());(this.newWalls.push(this.newWall)>0);this.lastWallCreationTime=Date.now();this.__parent.deselectAll()};bg.prototype.updateEditableProperty=function(bn,bq){if(this.newWall==null){var bm=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();switch((bn)){case"X":this.xStart=bq!=null?bq:0;this.xStart=Math.max(-bm,Math.min(this.xStart,bm));break;case"Y":this.yStart=bq!=null?bq:0;this.yStart=Math.max(-bm,Math.min(this.yStart,bm));break}}else{if(bn==="THICKNESS"){var bo=bq!=null?Math.abs(bq):0;bo=Math.max(0.01,Math.min(bo,1000));this.newWall.setThickness(bo)}else{if(bn==="ARC_EXTENT"){var bi=(function(br){return br*Math.PI/180})(bq!=null?bq:0);this.wallArcExtent=((function(br){if(br>0){return 1}else{if(br<0){return -1}else{return 0}}})(bi)*Math.min(Math.abs(bi),3*Math.PI/2));this.newWall.setArcExtent(this.wallArcExtent);if(this.__parent.feedbackDisplayed){this.showWallAngleFeedback(this.newWall,false)}return}else{switch((bn)){case"LENGTH":var bj=bq!=null?bq:0;bj=Math.max(0.001,Math.min(bj,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var bp=Math.PI-Math.atan2(this.yStart-this.yLastEnd,this.xStart-this.xLastEnd);this.xLastEnd=(this.xStart+bj*Math.cos(bp));this.yLastEnd=(this.yStart-bj*Math.sin(bp));break;case"ANGLE":bp=(function(br){return br*Math.PI/180})(bq!=null?bq:0);var bk=this.newWall.getWallAtStart();if(bk!=null&&bk.getStartPointToEndPointDistance()>0){bp-=Math.atan2(bk.getYStart()-bk.getYEnd(),bk.getXStart()-bk.getXEnd())}var bl=this.newWall.getStartPointToEndPointDistance();this.xLastEnd=(this.xStart+bl*Math.cos(bp));this.yLastEnd=(this.yStart-bl*Math.sin(bp));break;default:return}this.newWall.setXEnd(this.xLastEnd);this.newWall.setYEnd(this.yLastEnd)}}}if(this.__parent.feedbackDisplayed){this.showWallFeedback()}};bg.prototype.showWallFeedback=function(){var bi=this.__parent.getView();if(this.newWall==null){bi.setAlignmentFeedback(Wall,null,this.xStart,this.yStart,true);bi.makePointVisible(this.xStart,this.yStart)}else{bi.setAlignmentFeedback(Wall,this.newWall,this.xLastEnd,this.yLastEnd,false);this.showWallAngleFeedback(this.newWall,false);bi.makePointVisible(this.xStart,this.yStart);bi.makePointVisible(this.xLastEnd,this.yLastEnd);if(this.newWalls.length>2&&this.newWalls[0].getWallAtStart()==null&&this.newWalls[0].containsWallStartAt(this.xLastEnd,this.yLastEnd,0.001)){this.wallStartAtEnd=this.newWalls[0];this.__parent.selectItem(this.wallStartAtEnd)}else{this.wallStartAtEnd=null;this.__parent.deselectAll()}}};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.newWall!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setDuplicationActivated=function(bi){this.roundWall=bi};bg.prototype.escape=function(){var bi=this;if(this.newWall!=null){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteWall(this.newWall);(function(bj){var bk=bj.indexOf(bi.newWall);if(bk>=0){bj.splice(bk,1);return true}else{return false}})(this.newWalls)}this.validateDrawnWalls()};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.deleteFeedback();this.wallStartAtStart=null;this.wallEndAtStart=null;this.newWall=null;this.wallArcExtent=null;this.wallStartAtEnd=null;this.wallEndAtEnd=null;this.lastWall=null;this.oldSelection=null;this.newWalls=null};return bg}(al.AbstractWallState));al.WallDrawingState=ac;ac.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallDrawingState";(function(bg){var bh=(function(){function bi(bk,bj){this.sidePoint=bj;this.__parent=bk}bi.prototype.compare=function(bk,bj){return(java.awt.geom.Point2D.distanceSq(bk.getXStart(),bk.getYStart(),this.sidePoint[0],this.sidePoint[1])-java.awt.geom.Point2D.distanceSq(bj.getXStart(),bj.getYStart(),this.sidePoint[0],this.sidePoint[1]))};return bi}());bg.WallDrawingState$0=bh})(ac=al.WallDrawingState||(al.WallDrawingState={}));var V=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.selectedWall===undefined){bj.selectedWall=null}if(bj.startPoint===undefined){bj.startPoint=false}if(bj.oldX===undefined){bj.oldX=0}if(bj.oldY===undefined){bj.oldY=0}if(bj.deltaXToResizePoint===undefined){bj.deltaXToResizePoint=0}if(bj.deltaYToResizePoint===undefined){bj.deltaYToResizePoint=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){bh.prototype.enter.call(this);this.selectedWall=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.startPoint=this.selectedWall===this.__parent.getResizedWallStartAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(this.startPoint){this.oldX=this.selectedWall.getXStart();this.oldY=this.selectedWall.getYStart()}else{this.oldX=this.selectedWall.getXEnd();this.oldY=this.selectedWall.getYEnd()}this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,true),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());bi.setAlignmentFeedback(Wall,this.selectedWall,this.oldX,this.oldY,false);this.showWallAngleFeedback(this.selectedWall,true);bi.setDimensionLinesFeedback(this.getDimensionLinesAlongWall(this.selectedWall))}};bg.prototype.moveMouse=function(bl,bp){var bk=this.__parent.getView();var bn=bl-this.deltaXToResizePoint;var bm=bp-this.deltaYToResizePoint;var bj=this.startPoint?this.selectedWall.getXEnd():this.selectedWall.getXStart();var bo=this.startPoint?this.selectedWall.getYEnd():this.selectedWall.getYStart();if(this.alignmentActivated){var bi=new al.PointWithAngleMagnetism(bj,bo,bn,bm,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bk.getPixelLength());bn=bi.getX();bm=bi.getY()}else{if(this.magnetismEnabled){var bi=new al.WallPointWithAngleMagnetism(this.__parent,this.selectedWall,bj,bo,bn,bm);bn=bi.getX();bm=bi.getY()}}al.moveWallPoint(this.selectedWall,bn,bm,this.startPoint);if(this.__parent.feedbackDisplayed){bk.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,true),bl,bp);bk.setAlignmentFeedback(Wall,this.selectedWall,bn,bm,false);this.showWallAngleFeedback(this.selectedWall,true);bk.setDimensionLinesFeedback(this.getDimensionLinesAlongWall(this.selectedWall))}bk.makePointVisible(bl,bp)};bg.prototype.getDimensionLinesAlongWall=function(br){var bo=([]);if(br.getArcExtent()==null||br.getArcExtent()===0){var bm=20/this.__parent.getView().getScale();var bt=br.getPoints$();var bs=this.__parent.getRoomPathsFromWalls();for(var bp=0;bp<bs.length;bp++){var bk=this.__parent.getPathPoints(bs[bp],true);for(var bn=0;bn<bk.length;bn++){var bj=bk[bn];var bq=bk[(bn+1)%bk.length];var bl=java.awt.geom.Line2D.ptLineDistSq(bt[0][0],bt[0][1],bt[1][0],bt[1][1],bj[0],bj[1])<0.0001&&java.awt.geom.Line2D.ptLineDistSq(bt[0][0],bt[0][1],bt[1][0],bt[1][1],bq[0],bq[1])<0.0001;var bi=void 0;if(bl){bi=java.awt.geom.Line2D.ptSegDistSq(bt[0][0],bt[0][1],bt[1][0],bt[1][1],bj[0],bj[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bt[0][0],bt[0][1],bt[1][0],bt[1][1],bq[0],bq[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bj[0],bj[1],bq[0],bq[1],bt[0][0],bt[0][1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bj[0],bj[1],bq[0],bq[1],bt[1][0],bt[1][1])<0.0001}else{bi=java.awt.geom.Line2D.ptLineDistSq(bt[2][0],bt[2][1],bt[3][0],bt[3][1],bj[0],bj[1])<0.0001&&java.awt.geom.Line2D.ptLineDistSq(bt[2][0],bt[2][1],bt[3][0],bt[3][1],bq[0],bq[1])<0.0001&&(java.awt.geom.Line2D.ptSegDistSq(bt[2][0],bt[2][1],bt[3][0],bt[3][1],bj[0],bj[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bt[2][0],bt[2][1],bt[3][0],bt[3][1],bq[0],bq[1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bj[0],bj[1],bq[0],bq[1],bt[2][0],bt[2][1])<0.0001||java.awt.geom.Line2D.ptSegDistSq(bj[0],bj[1],bq[0],bq[1],bt[3][0],bt[3][1])<0.0001)}if(bi){(bo.push(this.__parent.getDimensionLineBetweenPoints(bj,bq,this.isDimensionInsideWall(br,bj,bq)?-bm:bm,false))>0)}}}for(var bp=bo.length-1;bp>=0;bp--){if(bo[bp].getLength()<0.01){bo.splice(bp,1)[0]}}if(bo.length===2&&Math.abs(bo[0].getLength()-bo[1].getLength())<0.01){bo.splice(1,1)[0]}}return bo};bg.prototype.isDimensionInsideWall=function(bi,bl,bk){var bj=java.awt.geom.AffineTransform.getRotateInstance(Math.atan2(bk[1]-bl[1],bk[0]-bl[0]),bl[0],bl[1]);var bm=[(bl[0]+java.awt.geom.Point2D.distance(bl[0],bl[1],bk[0],bk[1])/2),bl[1]+0.01];bj.transform(bm,0,bm,0,1);return bi.containsPoint$float$float$float(bm[0],bm[1],0)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postWallResize(this.selectedWall,this.oldX,this.oldY,this.startPoint);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){al.moveWallPoint(this.selectedWall,this.oldX,this.oldY,this.startPoint);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedWall=null};return bg}(al.AbstractWallState));al.WallResizeState=V;V.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallResizeState";var E=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.selectedWall===undefined){bj.selectedWall=null}if(bj.oldArcExtent===undefined){bj.oldArcExtent=null}if(bj.deltaXToMiddlePoint===undefined){bj.deltaXToMiddlePoint=0}if(bj.deltaYToMiddlePoint===undefined){bj.deltaYToMiddlePoint=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){bh.prototype.enter.call(this);this.selectedWall=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.oldArcExtent=this.selectedWall.getArcExtent();var bl=this.selectedWall.getPoints$();var bk=(bl.length/4|0);var bj=bl.length-1-bk;if(bl.length%4===0){bk--}var bn=(bl[bk][0]+bl[bj][0])/2;var bm=(bl[bk][1]+bl[bj][1])/2;this.deltaXToMiddlePoint=this.__parent.getXLastMousePress()-bn;this.deltaYToMiddlePoint=this.__parent.getYLastMousePress()-bm;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,false),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());this.showWallAngleFeedback(this.selectedWall,false)}};bg.prototype.moveMouse=function(bj,bn){var bi=this.__parent.getView();var bm=bj-this.deltaXToMiddlePoint;var bl=bn-this.deltaYToMiddlePoint;var bk=this.getArcExtent(this.selectedWall.getXStart(),this.selectedWall.getYStart(),this.selectedWall.getXEnd(),this.selectedWall.getYEnd(),bm,bl);if(this.alignmentActivated||this.magnetismEnabled){bk=(function(bo){return bo*Math.PI/180})(Math.round((function(bo){return bo*180/Math.PI})(bk)))}this.selectedWall.setArcExtent(bk);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedWall,false),bj,bn);this.showWallAngleFeedback(this.selectedWall,false)}bi.makePointVisible(bj,bn)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postWallArcExtent(this.selectedWall,this.oldArcExtent);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedWall.setArcExtent(this.oldArcExtent);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedWall=null};return bg}(al.AbstractWallState));al.WallArcExtentState=E;E.__class="com.eteks.sweethome3d.viewcontroller.PlanController.WallArcExtentState";var y=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.xPreviousPoint===undefined){bj.xPreviousPoint=0}if(bj.yPreviousPoint===undefined){bj.yPreviousPoint=0}if(bj.newRoom===undefined){bj.newRoom=null}if(bj.newPoint===undefined){bj.newPoint=null}if(bj.oldSelection===undefined){bj.oldSelection=null}if(bj.oldBasePlanLocked===undefined){bj.oldBasePlanLocked=false}if(bj.oldAllLevelsSelection===undefined){bj.oldAllLevelsSelection=false}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}if(bj.lastPointCreationTime===undefined){bj.lastPointCreationTime=0}return bj}bg.prototype.getMode=function(){return al.Mode.ROOM_CREATION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.setMode=function(bi){this.escape();if(bi===al.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bi===al.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bi===al.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bi===al.Mode.POLYLINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getPolylineCreationState())}else{if(bi===al.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bi===al.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};bg.prototype.enter=function(){bh.prototype.enter.call(this);this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.newRoom=null;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());if(this.magnetismEnabled){var bi=new al.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());if(bi.isMagnetized()){this.xPreviousPoint=bi.getX();this.yPreviousPoint=bi.getY()}else{var bj=new al.RoomPointWithAngleMagnetism(this.__parent,null,-1,this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove(),this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove());this.xPreviousPoint=bj.getX();this.yPreviousPoint=bj.getY()}if(this.__parent.feedbackDisplayed){this.__parent.getView().setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,bi.isMagnetized())}}else{this.xPreviousPoint=this.__parent.getXLastMousePress();this.yPreviousPoint=this.__parent.getYLastMousePress();if(this.__parent.feedbackDisplayed){this.__parent.getView().setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,false)}}this.__parent.deselectAll()};bg.prototype.moveMouse=function(bo,bn){var bl=this.__parent.getView();var bi=bo;var bp=bn;var bk=false;if(this.alignmentActivated){var bm=new al.PointWithAngleMagnetism(this.xPreviousPoint,this.yPreviousPoint,bo,bn,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bl.getPixelLength());bi=bm.getX();bp=bm.getY()}else{if(this.magnetismEnabled){var bq=this.newRoom!=null?new al.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.newRoom,this.newRoom.getPointCount()-1,bo,bn):new al.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,bo,bn);bk=bq.isMagnetized();if(bk){bi=bq.getX();bp=bq.getY()}else{var bj=this.newRoom!=null?this.newRoom.getPointCount()-1:-1;var bm=new al.RoomPointWithAngleMagnetism(this.__parent,this.newRoom,bj,this.xPreviousPoint,this.yPreviousPoint,bo,bn);bi=bm.getX();bp=bm.getY()}}}if(this.newRoom==null){this.newRoom=this.createAndSelectRoom(this.xPreviousPoint,this.yPreviousPoint,bi,bp)}else{if(this.newPoint!=null){var br=this.newRoom.getPoints();this.xPreviousPoint=br[br.length-1][0];this.yPreviousPoint=br[br.length-1][1];this.newRoom.addPoint$float$float(bi,bp);this.newPoint=null}else{this.newRoom.setPoint(bi,bp,this.newRoom.getPointCount()-1)}}if(this.__parent.feedbackDisplayed){bl.setToolTipFeedback(this.getToolTipFeedbackText(this.newRoom,this.newRoom.getPointCount()-1),bo,bn);bl.setAlignmentFeedback(Room,this.newRoom,bi,bp,bk);this.showRoomAngleFeedback(this.newRoom,this.newRoom.getPointCount()-1);bl.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.newRoom,this.newRoom.getPointCount()-1))}bl.makePointVisible(bo,bn)};bg.prototype.createAndSelectRoom=function(bm,bk,bi,bl){var bj=this.__parent.createRoom([[bm,bk],[bi,bl]]);var bn=this.__parent.getInsideWallsArea();bj.setCeilingVisible(bn.contains(bm,bk));this.__parent.selectItem(bj);return bj};bg.prototype.pressMouse=function(bj,bn,bi,bl,bm){if(bi===2){if(this.newRoom==null){var bk=this.__parent.computeRoomPointsAt(bj,bn);if(bk!=null){this.newRoom=this.__parent.createRoom(bk);this.__parent.selectItem(this.newRoom)}}this.validateDrawnRoom()}else{this.endRoomSide()}};bg.prototype.validateDrawnRoom=function(){if(this.newRoom!=null){var bi=this.newRoom.getPoints();if(bi.length<3){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deleteRoom(this.newRoom)}else{this.__parent.postCreateRooms([this.newRoom].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection)}}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getRoomCreationState())}};bg.prototype.endRoomSide=function(){if(this.newRoom!=null&&this.getRoomSideLength(this.newRoom,this.newRoom.getPointCount()-1)>0){this.newPoint=[0,0];if(this.newRoom.isCeilingVisible()){var bi=this.newRoom.getPoints();var bj=bi[bi.length-1];if(!this.__parent.getInsideWallsArea().contains(bj[0],bj[1])){this.newRoom.setCeilingVisible(false)}}}};bg.prototype.setEditionActivated=function(bl){var bi=this.__parent.getView();if(bl){bi.deleteFeedback();if(this.newRoom==null){bi.setToolTipEditedProperties(["X","Y"],[this.xPreviousPoint,this.yPreviousPoint],this.xPreviousPoint,this.yPreviousPoint)}else{if(this.newPoint!=null){this.createNextSide()}var bm=this.newRoom.getPoints();if(bm.length>2){bi.setToolTipEditedProperties(["LENGTH","DIAGONAL","ANGLE"],[this.getRoomSideLength(this.newRoom,bm.length-1),this.getRoomDiagonalLength(this.newRoom,bm.length-1),this.getRoomSideAngle(this.newRoom,bm.length-1)],bm[bm.length-1][0],bm[bm.length-1][1])}else{bi.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.getRoomSideLength(this.newRoom,bm.length-1),this.getRoomSideAngle(this.newRoom,bm.length-1)],bm[bm.length-1][0],bm[bm.length-1][1])}}this.showRoomFeedback()}else{if(this.newRoom==null){var bj=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bk=bj.isMetric()?300:LengthUnit.footToCentimeter(10);this.newRoom=this.createAndSelectRoom(this.xPreviousPoint,this.yPreviousPoint,this.xPreviousPoint+bk,this.yPreviousPoint);bi.deleteFeedback();this.setEditionActivated(true)}else{if(Date.now()-this.lastPointCreationTime<300){this.escape()}else{this.endRoomSide();var bm=this.newRoom.getPoints();if(bm.length>2&&this.newRoom.getPointIndexAt(bm[bm.length-1][0],bm[bm.length-1][1],0.001)===0){this.newRoom.removePoint(this.newRoom.getPointCount()-1);this.validateDrawnRoom();return}this.createNextSide();bi.deleteToolTipFeedback();this.setEditionActivated(true)}}}};bg.prototype.createNextSide=function(){var bj=this.newRoom.getPoints();this.xPreviousPoint=bj[bj.length-1][0];this.yPreviousPoint=bj[bj.length-1][1];var bk=Math.PI-Math.atan2(bj[bj.length-2][1]-bj[bj.length-1][1],bj[bj.length-2][0]-bj[bj.length-1][0]);bk-=Math.PI/2;var bi=this.getRoomSideLength(this.newRoom,bj.length-1);this.newRoom.addPoint$float$float((this.xPreviousPoint+bi*Math.cos(bk)),(this.yPreviousPoint-bi*Math.sin(bk)));this.newPoint=null;this.lastPointCreationTime=Date.now()};bg.prototype.updateEditableProperty=function(bq,bs){if(this.newRoom==null){var bn=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength();switch((bq)){case"X":this.xPreviousPoint=bs!=null?bs:0;this.xPreviousPoint=Math.max(-bn,Math.min(this.xPreviousPoint,bn));break;case"Y":this.yPreviousPoint=bs!=null?bs:0;this.yPreviousPoint=Math.max(-bn,Math.min(this.yPreviousPoint,bn));break}}else{var bp=this.__parent.getView();var bj=this.newRoom.getPoints();var bm=bj[bj.length-2];var bt=bj[bj.length-1];switch((bq)){case"LENGTH":var bu=bs!=null?bs:0;bu=Math.max(0.001,Math.min(bu,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var bl=Math.PI-Math.atan2(bm[1]-bt[1],bm[0]-bt[0]);var bi=(bm[0]+bu*Math.cos(bl));var bv=(bm[1]-bu*Math.sin(bl));this.newRoom.setPoint(bi,bv,bj.length-1);if(bj.length>2){bp.setToolTipEditedPropertyValue("DIAGONAL",this.getRoomDiagonalLength(this.newRoom,bj.length-1))}break;case"DIAGONAL":var bk=bs!=null?bs:0;bu=this.getRoomSideLength(this.newRoom,bj.length-1);var bo=this.getRoomSideLength(this.newRoom,bj.length-2);if(bk>=bu&&bk<=bu+bo){var br=(bu*bu+bo*bo-bk*bk)/(2*bu*bo);bl=(function(bw){if(bw>0){return 1}else{if(bw<0){return -1}else{return 0}}})(this.getRoomSideAngle(this.newRoom,bj.length-1))*Math.acos(br);bl-=Math.atan2(bj[bj.length-3][1]-bm[1],bj[bj.length-3][0]-bm[0]);bi=(bm[0]+bu*Math.cos(bl));bv=(bm[1]-bu*Math.sin(bl));this.newRoom.setPoint(bi,bv,bj.length-1);bp.setToolTipEditedPropertyValue("ANGLE",this.getRoomSideAngle(this.newRoom,bj.length-1))}break;case"ANGLE":bl=(function(bw){return bw*Math.PI/180})(bs!=null?bs:0);if(bj.length>2){bl-=Math.atan2(bj[bj.length-3][1]-bm[1],bj[bj.length-3][0]-bm[0])}bu=this.getRoomSideLength(this.newRoom,bj.length-1);bi=(bm[0]+bu*Math.cos(bl));bv=(bm[1]-bu*Math.sin(bl));this.newRoom.setPoint(bi,bv,bj.length-1);if(bj.length>2){bp.setToolTipEditedPropertyValue("DIAGONAL",this.getRoomDiagonalLength(this.newRoom,bj.length-1))}break;default:return}}this.showRoomFeedback()};bg.prototype.showRoomFeedback=function(){var bi=this.__parent.getView();if(this.newRoom==null){if(this.__parent.feedbackDisplayed){bi.setAlignmentFeedback(Room,null,this.xPreviousPoint,this.yPreviousPoint,true)}bi.makePointVisible(this.xPreviousPoint,this.yPreviousPoint)}else{var bk=this.newRoom.getPoints();var bj=bk[bk.length-1];if(this.__parent.feedbackDisplayed){bi.setAlignmentFeedback(Room,this.newRoom,bj[0],bj[1],false);this.showRoomAngleFeedback(this.newRoom,bk.length-1);bi.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.newRoom,bk.length-1))}var bl=bk[bk.length-2];bi.makePointVisible(bl[0],bl[1]);bi.makePointVisible(bj[0],bj[1])}};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.newRoom!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){if(this.newRoom!=null&&this.newPoint==null){this.newRoom.removePoint(this.newRoom.getPointCount()-1)}this.validateDrawnRoom()};bg.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.newRoom=null;this.newPoint=null;this.oldSelection=null};return bg}(al.AbstractRoomState));al.RoomDrawingState=y;y.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomDrawingState";var aU=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.selectedRoom===undefined){bj.selectedRoom=null}if(bj.roomPointIndex===undefined){bj.roomPointIndex=0}if(bj.oldX===undefined){bj.oldX=0}if(bj.oldY===undefined){bj.oldY=0}if(bj.deltaXToResizePoint===undefined){bj.deltaXToResizePoint=0}if(bj.deltaYToResizePoint===undefined){bj.deltaYToResizePoint=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){bh.prototype.enter.call(this);this.selectedRoom=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];var bk=this.__parent.getIndicatorMargin();this.roomPointIndex=this.selectedRoom.getPointIndexAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bk);var bj=this.selectedRoom.getPoints();this.oldX=bj[this.roomPointIndex][0];this.oldY=bj[this.roomPointIndex][1];this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);if(this.__parent.feedbackDisplayed){bi.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedRoom,this.roomPointIndex),this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());this.showRoomAngleFeedback(this.selectedRoom,this.roomPointIndex);bi.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.selectedRoom,this.roomPointIndex))}};bg.prototype.moveMouse=function(br,bp){var bn=this.__parent.getView();var bi=br-this.deltaXToResizePoint;var bt=bp-this.deltaYToResizePoint;var bj=this.selectedRoom.getPoints();var bq=this.roomPointIndex===0?bj.length-1:this.roomPointIndex-1;var bm=bj[bq][0];var bk=bj[bq][1];var bl=false;if(this.alignmentActivated){var bo=new al.PointWithAngleMagnetism(bm,bk,bi,bt,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bn.getPixelLength());bi=bo.getX();bt=bo.getY()}else{if(this.magnetismEnabled){var bs=new al.PointMagnetizedToClosestWallOrRoomPoint(this.__parent,this.selectedRoom,this.roomPointIndex,bi,bt);bl=bs.isMagnetized();if(bl){bi=bs.getX();bt=bs.getY()}else{var bo=new al.RoomPointWithAngleMagnetism(this.__parent,this.selectedRoom,this.roomPointIndex,bm,bk,bi,bt);bi=bo.getX();bt=bo.getY()}}}al.moveRoomPoint(this.selectedRoom,bi,bt,this.roomPointIndex);if(this.__parent.feedbackDisplayed){bn.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedRoom,this.roomPointIndex),br,bp);bn.setAlignmentFeedback(Room,this.selectedRoom,bi,bt,bl);this.showRoomAngleFeedback(this.selectedRoom,this.roomPointIndex);bn.setDimensionLinesFeedback(this.getTriangulationDimensionLines(this.selectedRoom,this.roomPointIndex))}bn.makePointVisible(br,bp)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postRoomResize(this.selectedRoom,this.oldX,this.oldY,this.roomPointIndex);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){al.moveRoomPoint(this.selectedRoom,this.oldX,this.oldY,this.roomPointIndex);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedRoom=null};return bg}(al.AbstractRoomState));al.RoomResizeState=aU;aU.__class="com.eteks.sweethome3d.viewcontroller.PlanController.RoomResizeState";var a0=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.xPreviousPoint===undefined){bj.xPreviousPoint=0}if(bj.yPreviousPoint===undefined){bj.yPreviousPoint=0}if(bj.newPolyline===undefined){bj.newPolyline=null}if(bj.newPoint===undefined){bj.newPoint=null}if(bj.oldSelection===undefined){bj.oldSelection=null}if(bj.oldBasePlanLocked===undefined){bj.oldBasePlanLocked=false}if(bj.oldAllLevelsSelection===undefined){bj.oldAllLevelsSelection=false}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}if(bj.curvedPolyline===undefined){bj.curvedPolyline=false}if(bj.lastPointCreationTime===undefined){bj.lastPointCreationTime=0}return bj}bg.prototype.getMode=function(){return al.Mode.POLYLINE_CREATION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.setMode=function(bi){this.escape();if(bi===al.Mode.SELECTION_$LI$()){this.__parent.setState(this.__parent.getSelectionState())}else{if(bi===al.Mode.PANNING_$LI$()){this.__parent.setState(this.__parent.getPanningState())}else{if(bi===al.Mode.WALL_CREATION_$LI$()){this.__parent.setState(this.__parent.getWallCreationState())}else{if(bi===al.Mode.ROOM_CREATION_$LI$()){this.__parent.setState(this.__parent.getRoomCreationState())}else{if(bi===al.Mode.DIMENSION_LINE_CREATION_$LI$()){this.__parent.setState(this.__parent.getDimensionLineCreationState())}else{if(bi===al.Mode.LABEL_CREATION_$LI$()){this.__parent.setState(this.__parent.getLabelCreationState())}}}}}}};bg.prototype.enter=function(){bh.prototype.enter.call(this);this.oldSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems();this.oldBasePlanLocked=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isBasePlanLocked();this.oldAllLevelsSelection=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection();this.newPolyline=null;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());this.xPreviousPoint=this.__parent.getXLastMousePress();this.yPreviousPoint=this.__parent.getYLastMousePress();this.setDuplicationActivated(this.__parent.wasDuplicationActivatedLastMousePress());this.__parent.deselectAll()};bg.prototype.moveMouse=function(bk,bo){var bj=this.__parent.getView();var bi=bk;var bn=bo;if(this.alignmentActivated||this.magnetismEnabled){var bm=new al.PointWithAngleMagnetism(this.xPreviousPoint,this.yPreviousPoint,bk,bo,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bj.getPixelLength());bi=bm.getX();bn=bm.getY()}if(this.newPolyline==null){this.newPolyline=this.createAndSelectPolyline(this.xPreviousPoint,this.yPreviousPoint,bi,bn)}else{if(this.newPoint!=null){var bl=this.newPolyline.getPoints();this.xPreviousPoint=bl[bl.length-1][0];this.yPreviousPoint=bl[bl.length-1][1];this.newPolyline.addPoint$float$float(bi,bn);this.newPoint[0]=bi;this.newPoint[1]=bn;this.newPoint=null}else{this.newPolyline.setPoint(bi,bn,this.newPolyline.getPointCount()-1)}}if(this.__parent.feedbackDisplayed){bj.setAlignmentFeedback(Polyline,null,bk,bo,false);bj.setToolTipFeedback(this.getToolTipFeedbackText(this.newPolyline,this.newPolyline.getPointCount()-1),bk,bo);if(this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.newPolyline,this.newPolyline.getPointCount()-1)}}bj.makePointVisible(bk,bo)};bg.prototype.createAndSelectPolyline=function(bm,bk,bi,bl){var bj=this.__parent.createPolyline([[bm,bk],[bi,bl]]);if(this.curvedPolyline){bj.setJoinStyle(Polyline.JoinStyle.CURVED)}this.__parent.selectItems([bj].slice(0));return bj};bg.prototype.pressMouse=function(bj,bn,bi,bk,bm){if(bi===2){if(this.newPolyline!=null){var bl=this.newPolyline.getPointIndexAt(bj,bn,this.__parent.getSelectionMargin());if(bl===0){this.newPolyline.removePoint(this.newPolyline.getPointCount()-1);this.newPolyline.setClosedPath(true)}this.validateDrawnPolyline()}else{if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getPolylineCreationState())}}}else{this.endPolylineSegment()}};bg.prototype.validateDrawnPolyline=function(){if(this.newPolyline!=null){var bi=this.newPolyline.getPoints();if(bi.length<2){this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.deletePolyline(this.newPolyline)}else{this.__parent.postCreatePolylines([this.newPolyline].slice(0),this.oldSelection,this.oldBasePlanLocked,this.oldAllLevelsSelection)}}if(this.__parent.getPointerTypeLastMousePress()===View.PointerType.TOUCH){this.__parent.setState(this.__parent.getSelectionState())}else{this.__parent.setState(this.__parent.getPolylineCreationState())}};bg.prototype.endPolylineSegment=function(){if(this.newPolyline!=null&&this.getPolylineSegmentLength(this.newPolyline,this.newPolyline.getPointCount()-1)>0){this.newPoint=[0,0];if(this.newPolyline.getPointCount()<=2&&this.curvedPolyline&&this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.newPolyline.setJoinStyle(Polyline.JoinStyle.CURVED)}}};bg.prototype.setEditionActivated=function(bl){var bi=this.__parent.getView();if(bl){bi.deleteFeedback();if(this.newPolyline==null){bi.setToolTipEditedProperties(["X","Y"],[this.xPreviousPoint,this.yPreviousPoint],this.xPreviousPoint,this.yPreviousPoint)}else{if(this.newPoint!=null){this.createNextSegment()}var bm=this.newPolyline.getPoints();bi.setToolTipEditedProperties(["LENGTH","ANGLE"],[this.getPolylineSegmentLength(this.newPolyline,bm.length-1),this.getPolylineSegmentAngle(this.newPolyline,bm.length-1)],bm[bm.length-1][0],bm[bm.length-1][1])}this.showPolylineFeedback()}else{if(this.newPolyline==null){var bj=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit();var bk=bj.isMetric()?300:LengthUnit.footToCentimeter(10);this.newPolyline=this.createAndSelectPolyline(this.xPreviousPoint,this.yPreviousPoint,this.xPreviousPoint+bk,this.yPreviousPoint);bi.deleteFeedback();this.setEditionActivated(true)}else{if(Date.now()-this.lastPointCreationTime<300){this.escape()}else{this.endPolylineSegment();var bm=this.newPolyline.getPoints();if(bm.length>2&&this.newPolyline.getPointIndexAt(bm[bm.length-1][0],bm[bm.length-1][1],0.001)===0){this.newPolyline.removePoint(this.newPolyline.getPointCount()-1);this.newPolyline.setClosedPath(true);this.validateDrawnPolyline();return}this.createNextSegment();bi.deleteToolTipFeedback();this.setEditionActivated(true)}}}};bg.prototype.createNextSegment=function(){var bj=this.newPolyline.getPoints();this.xPreviousPoint=bj[bj.length-1][0];this.yPreviousPoint=bj[bj.length-1][1];var bi=Math.PI-Math.atan2(bj[bj.length-2][1]-bj[bj.length-1][1],bj[bj.length-2][0]-bj[bj.length-1][0]);bi-=Math.PI/2;var bk=this.getPolylineSegmentLength(this.newPolyline,bj.length-1);this.newPolyline.addPoint$float$float((this.xPreviousPoint+bk*Math.cos(bi)),(this.yPreviousPoint-bk*Math.sin(bi)));this.newPoint=null;this.lastPointCreationTime=Date.now()};bg.prototype.updateEditableProperty=function(bn,bo){if(this.newPolyline==null){switch((bn)){case"X":this.xPreviousPoint=bo!=null?bo:0;this.xPreviousPoint=Math.max(-100000,Math.min(this.xPreviousPoint,100000));break;case"Y":this.yPreviousPoint=bo!=null?bo:0;this.yPreviousPoint=Math.max(-100000,Math.min(this.yPreviousPoint,100000));break}}else{var bq=this.newPolyline.getPoints();var bl=bq[bq.length-2];var bp=bq[bq.length-1];var bi=void 0;var br=void 0;switch((bn)){case"LENGTH":var bk=bo!=null?bo:0;bk=Math.max(0.001,Math.min(bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit().getMaximumLength()));var bj=Math.PI-Math.atan2(bl[1]-bp[1],bl[0]-bp[0]);bi=(bl[0]+bk*Math.cos(bj));br=(bl[1]-bk*Math.sin(bj));break;case"ANGLE":bj=(function(bs){return bs*Math.PI/180})(bo!=null?bo:0);if(bq.length>2){bj-=Math.atan2(bq[bq.length-3][1]-bl[1],bq[bq.length-3][0]-bl[0])}var bm=this.getPolylineSegmentLength(this.newPolyline,bq.length-1);bi=(bl[0]+bm*Math.cos(bj));br=(bl[1]-bm*Math.sin(bj));break;default:return}this.newPolyline.setPoint(bi,br,bq.length-1)}this.showPolylineFeedback()};bg.prototype.showPolylineFeedback=function(){var bi=this.__parent.getView();if(this.newPolyline==null){if(this.__parent.feedbackDisplayed){bi.setAlignmentFeedback(Polyline,null,this.xPreviousPoint,this.yPreviousPoint,true)}bi.makePointVisible(this.xPreviousPoint,this.yPreviousPoint)}else{var bl=this.newPolyline.getPoints();var bk=bl[bl.length-2];var bj=bl[bl.length-1];if(this.__parent.feedbackDisplayed){if(this.newPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.newPolyline,bl.length-1)}bi.setAlignmentFeedback(Polyline,null,bj[0],bj[1],false)}bi.makePointVisible(bk[0],bk[1]);bi.makePointVisible(bj[0],bj[1])}};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);if(this.newPolyline!=null){this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())}};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setDuplicationActivated=function(bi){this.curvedPolyline=bi};bg.prototype.escape=function(){if(this.newPolyline!=null&&this.newPoint==null){this.newPolyline.removePoint(this.newPolyline.getPointCount()-1)}this.validateDrawnPolyline()};bg.prototype.exit=function(){this.__parent.getView().deleteFeedback();this.newPolyline=null;this.newPoint=null;this.oldSelection=null};return bg}(al.AbstractPolylineState));al.PolylineDrawingState=a0;a0.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineDrawingState";var x=(function(bh){__extends(bg,bh);function bg(bi){var bj=bh.call(this,bi)||this;bj.__parent=bi;if(bj.polylines===undefined){bj.polylines=null}if(bj.selectedPolyline===undefined){bj.selectedPolyline=null}if(bj.polylinePointIndex===undefined){bj.polylinePointIndex=0}if(bj.oldX===undefined){bj.oldX=0}if(bj.oldY===undefined){bj.oldY=0}if(bj.deltaXToResizePoint===undefined){bj.deltaXToResizePoint=0}if(bj.deltaYToResizePoint===undefined){bj.deltaYToResizePoint=0}if(bj.magnetismEnabled===undefined){bj.magnetismEnabled=false}if(bj.alignmentActivated===undefined){bj.alignmentActivated=false}return bj}bg.prototype.getMode=function(){return al.Mode.SELECTION_$LI$()};bg.prototype.isModificationState=function(){return true};bg.prototype.isBasePlanModificationState=function(){return true};bg.prototype.enter=function(){var bm=this;bh.prototype.enter.call(this);this.selectedPolyline=this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems()[0];this.polylines=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getPolylines().slice(0));(function(bn){var bo=bn.indexOf(bm.selectedPolyline);if(bo>=0){bn.splice(bo,1);return true}else{return false}})(this.polylines);var bl=this.__parent.getIndicatorMargin();this.polylinePointIndex=this.selectedPolyline.getPointIndexAt(this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress(),bl);var bj=this.selectedPolyline.getPoints();this.oldX=bj[this.polylinePointIndex][0];this.oldY=bj[this.polylinePointIndex][1];this.deltaXToResizePoint=this.__parent.getXLastMousePress()-this.oldX;this.deltaYToResizePoint=this.__parent.getYLastMousePress()-this.oldY;this.alignmentActivated=this.__parent.wasAlignmentActivatedLastMousePress();this.toggleMagnetism(this.__parent.wasMagnetismToggledLastMousePress());var bi=this.__parent.getView();bi.setResizeIndicatorVisible(true);var bk=this.getToolTipFeedbackText(this.selectedPolyline,this.polylinePointIndex);if(this.__parent.feedbackDisplayed&&bk!=null){bi.setToolTipFeedback(bk,this.__parent.getXLastMousePress(),this.__parent.getYLastMousePress());if(this.selectedPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.selectedPolyline,this.polylinePointIndex)}}};bg.prototype.moveMouse=function(bq,bo){var bl=this.__parent.getView();var bi=bq-this.deltaXToResizePoint;var br=bo-this.deltaYToResizePoint;if(this.alignmentActivated||this.magnetismEnabled){var bn=this.selectedPolyline.getPoints();var bp=this.polylinePointIndex===0?(this.selectedPolyline.isClosedPath()?bn.length-1:1):this.polylinePointIndex-1;var bk=bn[bp][0];var bj=bn[bp][1];var bm=new al.PointWithAngleMagnetism(bk,bj,bi,br,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.getLengthUnit(),bl.getPixelLength());bi=bm.getX();br=bm.getY()}this.selectedPolyline.setPoint(bi,br,this.polylinePointIndex);if(this.__parent.feedbackDisplayed){bl.setToolTipFeedback(this.getToolTipFeedbackText(this.selectedPolyline,this.polylinePointIndex),bq,bo);if(this.selectedPolyline.getJoinStyle()!==Polyline.JoinStyle.CURVED){this.showPolylineAngleFeedback(this.selectedPolyline,this.polylinePointIndex)}}bl.makePointVisible(bq,bo)};bg.prototype.releaseMouse=function(bi,bj){this.__parent.postPolylineResize(this.selectedPolyline,this.oldX,this.oldY,this.polylinePointIndex);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.toggleMagnetism=function(bi){this.magnetismEnabled=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_preferences.isMagnetismEnabled())!==(bi);this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.setAlignmentActivated=function(bi){this.alignmentActivated=bi;this.moveMouse(this.__parent.getXLastMouseMove(),this.__parent.getYLastMouseMove())};bg.prototype.escape=function(){this.selectedPolyline.setPoint(this.oldX,this.oldY,this.polylinePointIndex);this.__parent.setState(this.__parent.getSelectionState())};bg.prototype.exit=function(){var bi=this.__parent.getView();bi.setResizeIndicatorVisible(false);bi.deleteFeedback();this.selectedPolyline=null};return bg}(al.AbstractPolylineState));al.PolylineResizeState=x;x.__class="com.eteks.sweethome3d.viewcontroller.PlanController.PolylineResizeState";var S=(function(){function bg(bi,bh){this.walls=bh;this.__parent=bi}bg.prototype.compare=function(bi,bh){var bl=al.computeIntersection(bi.getXStart(),bi.getYStart(),bi.getXEnd(),bi.getYEnd(),this.walls[0].getXStart(),this.walls[0].getYStart(),this.walls[0].getXEnd(),this.walls[0].getYEnd());var bj=al.computeIntersection(bh.getXStart(),bh.getYStart(),bh.getXEnd(),bh.getYEnd(),this.walls[0].getXStart(),this.walls[0].getYStart(),this.walls[0].getXEnd(),this.walls[0].getYEnd());var bm=Math.min(java.awt.geom.Point2D.distanceSq(this.walls[0].getXStart(),this.walls[0].getYStart(),bl[0],bl[1]),java.awt.geom.Point2D.distanceSq(this.walls[0].getXEnd(),this.walls[0].getYEnd(),bl[0],bl[1]));var bk=Math.min(java.awt.geom.Point2D.distanceSq(this.walls[0].getXStart(),this.walls[0].getYStart(),bj[0],bj[1]),java.awt.geom.Point2D.distanceSq(this.walls[0].getXEnd(),this.walls[0].getYEnd(),bj[0],bj[1]));return(bm-bk)};return bg}());al.PlanController$0=S;var R=(function(){function bg(bh){this.__parent=bh}bg.prototype.selectionChanged=function(bh){this.__parent.selectLevelFromSelectedItems();if(this.__parent.getView()!=null){this.__parent.getView().makeSelectionVisible()}};return bg}());al.PlanController$1=R;R.__interfaces=["com.eteks.sweethome3d.model.SelectionListener"];var P=(function(){function bg(bh){this.__parent=bh}bg.prototype.propertyChange=function(bh){if((this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().indexOf((bh.getSource()))>=0)){if(this.__parent.getView()!=null){this.__parent.getView().makeSelectionVisible()}}};return bg}());al.PlanController$2=P;var N=(function(){function bg(bh){this.__parent=bh}bg.prototype.propertyChange=function(bj){var bh=bj.getPropertyName();if(("X_START"===bh)||("X_END"===bh)||("Y_START"===bh)||("Y_END"===bh)||("WALL_AT_START"===bh)||("WALL_AT_END"===bh)||("THICKNESS"===bh)||("ARC_EXTENT"===bh)||("LEVEL"===bh)||("HEIGHT"===bh)||("HEIGHT_AT_END"===bh)||("LEFT_SIDE_BASEBOARD"===bh)||("RIGHT_SIDE_BASEBOARD"===bh)){this.__parent.resetAreaCache();var bi=bj.getSource();if(!bi.isAtLevel(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedLevel())){var bk=(this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.getSelectedItems().slice(0));if((function(bl){var bm=bl.indexOf(bi);if(bm>=0){bl.splice(bm,1);return true}else{return false}})(bk)){this.__parent.selectItems(bk,this.__parent.__com_eteks_sweethome3d_viewcontroller_PlanController_home.isAllLevelsSelection())}}}};return bg}());al.PlanController$3=N;var L=(function(){function bg(bh){this.__parent=bh}bg.prototype.propertyChange=function(bi){var bh=bi.getPropertyName();if(("X"===bh)||("Y"===bh)||("WIDTH_IN_PLAN"===bh)||("DEPTH_IN_PLAN"===bh)){(function(bj,bk){if(bj.entries==null){bj.entries=[]}for(var bl=0;bl<bj.entries.length;bl++){if(bj.entries[bl].key==null&&bk==null||bj.entries[bl].key.equals!=null&&bj.entries[bl].key.equals(bk)||bj.entries[bl].key===bk){return bj.entries.splice(bl,1)[0]}}})(this.__parent.furnitureSidesCache,bi.getSource())}};return bg}());al.PlanController$4=L;var K=(function(){function bg(bh){this.__parent=bh}bg.prototype.propertyChange=function(bk){var bj=bk.getSource();var bh=bk.getPropertyName();if(("MODEL"===bh)||("MODEL_MIRRORED"===bh)||("MODEL_ROTATION"===bh)||("WIDTH"===bh)||("DEPTH"===bh)||("HEIGHT"===bh)||("ROLL"===bh)||("PITCH"===bh)){var bi=this.__parent.getView().getPieceOfFurnitureSizeInPlan(bj);if(bi!=null){bj.setWidthInPlan(bi[0]);bj.setDepthInPlan(bi[1]);bj.setHeightInPlan(bi[2])}else{if("WIDTH"===bh){var bl=bj.getWidth()/bk.getOldValue();bj.setWidthInPlan(bl*bj.getWidthInPlan());bj.setDepthInPlan(bl*bj.getDepthInPlan());bj.setHeightInPlan(bl*bj.getHeightInPlan())}}}};return bg}());al.PlanController$5=K;var I=(function(){function bg(bh){this.__parent=bh}bg.prototype.propertyChange=function(bh){this.__parent.resetAreaCache()};return bg}());al.PlanController$6=I;var H=(function(){function bg(bh){this.__parent=bh}bg.prototype.compare=function(bi,bh){return -(bi.getGroundElevation()-bh.getGroundElevation())};return bg}());al.PlanController$7=H})(PlanController||(PlanController={}));PlanController.Mode.LABEL_CREATION_$LI$();PlanController.Mode.DIMENSION_LINE_CREATION_$LI$();PlanController.Mode.POLYLINE_CREATION_$LI$();PlanController.Mode.ROOM_CREATION_$LI$();PlanController.Mode.WALL_CREATION_$LI$();PlanController.Mode.PANNING_$LI$();PlanController.Mode.SELECTION_$LI$();Home.LEVEL_ELEVATION_COMPARATOR_$LI$();HomeController.UserPreferencesChangeListener.writingPreferences_$LI$();CatalogLight.EMPTY_LIGHT_SOURCE_MATERIAL_NAMES_$LI$();CatalogLight.EMPTY_LIGHT_SOURCES_$LI$();CatalogShelfUnit.EMPTY_SHELF_BOXES_$LI$();CatalogShelfUnit.EMPTY_SHELF_ELEVATIONS_$LI$();HomePieceOfFurniture.SORTABLE_PROPERTY_COMPARATORS_$LI$();HomePieceOfFurniture.EMPTY_PROPERTY_ARRAY_$LI$();HomePieceOfFurniture.ROUND_WALL_ANGLE_MARGIN_$LI$();HomePieceOfFurniture.STRAIGHT_WALL_ANGLE_MARGIN_$LI$();HomePieceOfFurniture.TWICE_PI_$LI$();HomePieceOfFurniture.__static_initialize();Label.TWICE_PI_$LI$();Room.TWICE_PI_$LI$();ExportableView.FormatType.CSV_$LI$();ExportableView.FormatType.SVG_$LI$();TransferableView.DataType.FURNITURE_LIST_$LI$();TransferableView.DataType.PLAN_IMAGE_$LI$();FurnitureCategory.COMPARATOR_$LI$();CatalogPieceOfFurniture.recentFilters_$LI$();CatalogPieceOfFurniture.COMPARATOR_$LI$();CatalogPieceOfFurniture.EMPTY_CRITERIA_$LI$();CatalogPieceOfFurniture.__static_initialize();Baseboard.baseboardsCache_$LI$();TextStyle.textStylesCache_$LI$();CatalogTexture.recentFilters_$LI$();CatalogTexture.COMPARATOR_$LI$();CatalogTexture.EMPTY_CRITERIA_$LI$();CatalogTexture.__static_initialize();TexturesCategory.COMPARATOR_$LI$();if(Math.fround===undefined){doubleToFloatConverter=new Float32Array(1);Math.fround=function(a){doubleToFloatConverter[0]=a;return doubleToFloatConverter[0]}}function Node3D(){}Node3D.READING_MODEL="Reading model";Node3D.PARSING_MODEL="Parsing model";Node3D.BUILDING_MODEL="Building model";Node3D.BINDING_MODEL="Binding model";Node3D.prototype.setCapability=function(a){if(this.capabilities===undefined){this.capabilities=0}this.capabilities|=a};Node3D.prototype.getCapability=function(a){if(this.capabilities===undefined){return false}else{return(this.capabilities&a)!==0}};Node3D.prototype.getParent=function(){if(this.parent===undefined){return null}else{return this.parent}};Node3D.prototype.getUserData=function(){if(this.userData===undefined){return null}else{return this.userData}};Node3D.prototype.setUserData=function(a){this.userData=a};Node3D.prototype.getName=function(){if(this.name===undefined){return null}else{return this.name}};Node3D.prototype.setName=function(a){this.name=a};Node3D.prototype.addPropertyChangeListener=function(a,b){if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=new PropertyChangeSupport(this)}this.propertyChangeSupport.addPropertyChangeListener(a,b)};Node3D.prototype.removePropertyChangeListener=function(a,b){if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.removePropertyChangeListener(a,b)}};Node3D.prototype.getPropertyChangeListeners=function(){if(this.propertyChangeSupport!==undefined){return this.propertyChangeSupport.getPropertyChangeListeners()}else{return[]}};Node3D.prototype.setPickable=function(a){this.pickable=a};Node3D.prototype.isPickable=function(){if(this.pickable!==undefined){return this.pickable}else{return true}};Node3D.prototype.clone=function(){var a=new Node3D();this.cloneNodeAttributes(a);return a};Node3D.prototype.cloneNodeAttributes=function(a){if(this.capabilities!==undefined){a.capabilities=this.capabilities}if(this.userData!==undefined){a.userData=this.userData}if(this.name!==undefined){a.name=this.name}if(this.pickable!==undefined){a.pickable=this.pickable}};function Shape3D(b,a){Node3D.call(this);if(b===undefined){b=null;a=null}else{if(a===undefined){a=null}}this.appearance=a;this.bounds=null;this.geometries=[];if(b!==null){this.geometries.push(b)}}Shape3D.prototype=Object.create(Node3D.prototype);Shape3D.prototype.constructor=Shape3D;Shape3D.ALLOW_GEOMETRY_WRITE=2;Shape3D.prototype.addGeometry=function(e){this.geometries.push(e);var b=vec3.fromValues(Infinity,Infinity,Infinity);var c=vec3.fromValues(-Infinity,-Infinity,-Infinity);if(this.bounds!==null){this.bounds.getLower(b);this.bounds.getUpper(c)}for(var a=0;a<e.vertexIndices.length;a++){var d=e.vertices[e.vertexIndices[a]];vec3.min(b,b,d);vec3.max(c,c,d)}this.bounds=new BoundingBox3D(b,c);if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("GEOMETRY",null,e)}};Shape3D.prototype.setGeometry=function(b,a){var c=this.geometries[a];this.geometries[a]=b;this.bounds=null;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("GEOMETRY",c,b)}};Shape3D.prototype.removeGeometry=function(a){var b=this.geometries[a];this.geometries.splice(a,1);this.bounds=null;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("GEOMETRY",b,null)}};Shape3D.prototype.getBounds=function(){if(this.geometries.length===0){return new BoundingBox3D(vec3.fromValues(Infinity,Infinity,Infinity),vec3.fromValues(-Infinity,-Infinity,-Infinity))}else{if(this.bounds===null){var b=vec3.fromValues(Infinity,Infinity,Infinity);var d=vec3.fromValues(-Infinity,-Infinity,-Infinity);for(var c=0;c<this.geometries.length;c++){var f=this.geometries[c];if(f.vertexIndices){for(var a=0;a<f.vertexIndices.length;a++){var e=f.vertices[f.vertexIndices[a]];vec3.min(b,b,e);vec3.max(d,d,e)}}}this.bounds=new BoundingBox3D(b,d)}}return this.bounds.clone()};Shape3D.prototype.getGeometries=function(){return this.geometries};Shape3D.prototype.getAppearance=function(){return this.appearance};Shape3D.prototype.setAppearance=function(a){this.appearance=a};Shape3D.prototype.clone=function(){var a=new Shape3D(null,this.appearance);this.cloneNodeAttributes(a);a.geometries=this.geometries;a.bounds=this.bounds;return a};function Background3D(a){Node3D.call(this);this.geometry=a;a.parent=this}Background3D.prototype=Object.create(Node3D.prototype);Background3D.prototype.constructor=Background3D;Background3D.prototype.getGeometry=function(){return this.geometry};Background3D.prototype.clone=function(){var a=new Background3D(this.geometry);this.cloneNodeAttributes(a);return a};function Light3D(a){Node3D.call(this);this.color=a}Light3D.prototype=Object.create(Node3D.prototype);Light3D.prototype.constructor=Light3D;Light3D.prototype.getColor=function(){return this.color};Light3D.prototype.setColor=function(a){var b=this.color;this.color=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("COLOR",b,a)}};function AmbientLight3D(a){Light3D.call(this,a)}AmbientLight3D.prototype=Object.create(Light3D.prototype);AmbientLight3D.prototype.constructor=AmbientLight3D;AmbientLight3D.prototype.clone=function(){var a=new AmbientLight3D(this.color);this.cloneNodeAttributes(a);return a};function DirectionalLight3D(a,b){Light3D.call(this,a);this.direction=b}DirectionalLight3D.prototype=Object.create(Light3D.prototype);DirectionalLight3D.prototype.constructor=DirectionalLight3D;DirectionalLight3D.prototype.getDirection=function(){return this.direction};DirectionalLight3D.prototype.clone=function(){var a=new DirectionalLight3D(this.color,this.direction);this.cloneNodeAttributes(a);return a};function Group3D(){Node3D.call(this);this.children=[]}Group3D.prototype=Object.create(Node3D.prototype);Group3D.prototype.constructor=Group3D;Group3D.ALLOW_CHILDREN_EXTEND=1;Group3D.prototype.addChild=function(a){this.insertChild(a,this.children.length)};Group3D.prototype.insertChild=function(e,a){this.children.splice(a,0,e);e.parent=this;if(this.childrenListeners!==undefined){var d={source:this,child:e,index:a};var c=this.childrenListeners.slice(0);for(var b=0;b<c.length;b++){c[b].childAdded(d)}}};Group3D.prototype.getChild=function(a){return this.children[a]};Group3D.prototype.getChildren=function(){return this.children};Group3D.prototype.removeChild=function(a){var e;if(a instanceof Node3D){e=a;a=this.children.indexOf(e)}else{e=this.children[a]}this.children.splice(a,1);delete e.parent;if(this.childrenListeners!==undefined){var d={source:this,child:e,index:a};var c=this.childrenListeners.slice(0);for(var b=0;b<c.length;b++){c[b].childRemoved(d)}}};Group3D.prototype.removeAllChildren=function(){for(var a=this.children.length-1;a>=0;a--){this.removeChild(a)}};Group3D.prototype.addChildrenListener=function(a){if(this.childrenListeners===undefined){this.childrenListeners=[]}this.childrenListeners.push(a)};Group3D.prototype.removeChildrenListener=function(b){if(this.childrenListeners!==undefined){var a=this.childrenListeners.indexOf(b);if(a!==-1){this.childrenListeners.splice(a,1)}}};Group3D.prototype.getChildrenListeners=function(){if(this.childrenListeners!==undefined){return this.childrenListeners.slice(0)}else{return[]}};Group3D.prototype.setPickable=function(b){Node3D.prototype.setPickable.call(this,b);for(var a=0;a<this.children.length;a++){this.children[a].setPickable(b)}};Group3D.prototype.clone=function(){var a=new Group3D();this.cloneNodeAttributes(a);return a};function BranchGroup3D(){Group3D.call(this)}BranchGroup3D.prototype=Object.create(Group3D.prototype);BranchGroup3D.prototype.constructor=BranchGroup3D;BranchGroup3D.prototype.detach=function(){if(this.parent){this.parent.removeChild(this)}};BranchGroup3D.prototype.clone=function(){var a=new BranchGroup3D();this.cloneNodeAttributes(a);return a};function SharedGroup3D(){Group3D.call(this)}SharedGroup3D.prototype=Object.create(Group3D.prototype);SharedGroup3D.prototype.constructor=SharedGroup3D;SharedGroup3D.prototype.clone=function(){var a=new SharedGroup3D();this.cloneNodeAttributes(a);return a};function Link3D(a){Node3D.call(this);this.sharedGroup=a}Link3D.prototype=Object.create(Node3D.prototype);Link3D.prototype.constructor=Link3D;Link3D.prototype.getSharedGroup=function(){return this.sharedGroup};Link3D.prototype.setSharedGroup=function(a){this.sharedGroup=a};Link3D.prototype.setPickable=function(a){Node3D.prototype.setPickable.call(this,a);this.sharedGroup.setPickable(a)};Link3D.prototype.clone=function(){var a=new Link3D(this.sharedGroup);this.cloneNodeAttributes(a);return a};function TransformGroup3D(a){Group3D.call(this);if(a!==undefined){this.transform=mat4.clone(a)}else{this.transform=mat4.create()}}TransformGroup3D.prototype=Object.create(Group3D.prototype);TransformGroup3D.prototype.constructor=TransformGroup3D;TransformGroup3D.ALLOW_TRANSFORM_WRITE=4;TransformGroup3D.prototype.getTransform=function(a){mat4.copy(a,this.transform)};TransformGroup3D.prototype.setTransform=function(a){if(!TransformGroup3D.areTransformationsEqual(this.transform,a)){var b=mat4.clone(this.transform);mat4.copy(this.transform,a);if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TRANSFORM",b,a)}}};TransformGroup3D.areTransformationsEqual=function(c,b){if(c&&b&&c.length===b.length){for(var a=0;a<c.length;a++){if(c[a]!==b[a]){return false}}return true}else{return c===b}};TransformGroup3D.isIdentity=function(a){if(TransformGroup3D.IDENTITY===undefined){TransformGroup3D.IDENTITY=mat4.create()}return mat4.exactEquals(a,TransformGroup3D.IDENTITY)};TransformGroup3D.prototype.clone=function(){var a=new TransformGroup3D(this.transform);this.cloneNodeAttributes(a);return a};function Appearance3D(a){if(a!==undefined){this.name=a}}Appearance3D.CULL_NONE=0;Appearance3D.CULL_BACK=1;Appearance3D.CULL_FRONT=2;Appearance3D.prototype.addPropertyChangeListener=function(a){if(this.propertyChangeSupport===undefined){this.propertyChangeSupport=new PropertyChangeSupport(this)}this.propertyChangeSupport.addPropertyChangeListener(a)};Appearance3D.prototype.removePropertyChangeListener=function(a){if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.removePropertyChangeListener(a)}};Appearance3D.prototype.setName=function(a){this.name=a};Appearance3D.prototype.getName=function(){return this.name};Appearance3D.prototype.setAmbientColor=function(a){var b=this.ambientColor;this.ambientColor=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("AMBIENT_COLOR",b,a)}};Appearance3D.prototype.getAmbientColor=function(){return this.ambientColor};Appearance3D.prototype.setEmissiveColor=function(a){var b=this.emissiveColor;this.emissiveColor=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("EMISSIVE_COLOR",b,a)}};Appearance3D.prototype.getEmissiveColor=function(){return this.emissiveColor};Appearance3D.prototype.setDiffuseColor=function(a){var b=this.diffuseColor;this.diffuseColor=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("DIFFUSE_COLOR",b,a)}};Appearance3D.prototype.getDiffuseColor=function(){return this.diffuseColor};Appearance3D.prototype.setSpecularColor=function(b){var a=this.specularColor;this.specularColor=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("SPECULAR_COLOR",a,b)}};Appearance3D.prototype.getSpecularColor=function(){return this.specularColor};Appearance3D.prototype.setShininess=function(b){b=Math.max(b,1);var a=this.shininess;this.shininess=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("SHININESS",a,b)}};Appearance3D.prototype.getShininess=function(){return this.shininess};Appearance3D.prototype.setTransparency=function(a){var b=this.transparency;this.transparency=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TRANSPARENCY",b,a)}};Appearance3D.prototype.getTransparency=function(){return this.transparency};Appearance3D.prototype.setIllumination=function(a){var b=this.illumination;this.illumination=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("ILLUMINATION",b,a)}};Appearance3D.prototype.getIllumination=function(){return this.illumination};Appearance3D.prototype.setTextureImage=function(a){if(this.textureImage!==a){var b=this.textureImage;this.textureImage=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TEXTURE_IMAGE",b,a)}}};Appearance3D.prototype.getTextureImage=function(){return this.textureImage};Appearance3D.isPowerOfTwo=function(a){return(a&(a-1))==0};Appearance3D.getNextHighestPowerOfTwo=function(a){--a;for(var b=1;b<32;b<<=1){a=a|a>>b}return(a+1)};Appearance3D.prototype.setTextureCoordinatesGeneration=function(b){if(!Appearance3D.areTextureCoordinatesGenerationsEqual(this.textureCoordinatesGeneration,b)){var a=this.textureCoordinatesGeneration;this.textureCoordinatesGeneration=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TEXTURE_COORDINATES_GENERATION",a,b)}}};Appearance3D.areTextureCoordinatesGenerationsEqual=function(c,b){if(c&&b){var e=c.planeS;var d=b.planeS;if(e&&d&&vec4.equals(e,d)){var a=c.planeT;var f=b.planeT;return a&&f&&vec4.equals(a,f)}return false}else{return c===b}};Appearance3D.prototype.getTextureCoordinatesGeneration=function(){return this.textureCoordinatesGeneration};Appearance3D.prototype.setTextureTransform=function(b){if(!TransformGroup3D.areTransformationsEqual(this.textureTransform,b)){var a=this.textureTransform;this.textureTransform=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("TEXTURE_TRANSFORM",a,b)}}};Appearance3D.prototype.getTextureTransform=function(){return this.textureTransform};Appearance3D.prototype.setVisible=function(b){var a=this.visible;this.visible=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("VISIBLE",a,b)}};Appearance3D.prototype.isVisible=function(){return this.visible!==false};Appearance3D.prototype.setCullFace=function(a){var b=this.cullFace;this.cullFace=a;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("CULL_FACE",b,a)}};Appearance3D.prototype.getCullFace=function(){return this.cullFace};Appearance3D.prototype.setBackFaceNormalFlip=function(b){var a=this.backFaceNormalFlip;this.backFaceNormalFlip=b;if(this.propertyChangeSupport!==undefined){this.propertyChangeSupport.firePropertyChange("BACK_FACE_NORMAL_FLIP",a,b)}};Appearance3D.prototype.getBackFaceNormalFlip=function(){return this.backFaceNormalFlip};Appearance3D.prototype.isBackFaceNormalFlip=function(){return this.backFaceNormalFlip===true};Appearance3D.prototype.clone=function(){var b=new Appearance3D(this.name);for(var a in this){if(this.hasOwnProperty(a)){b[a]=this[a]}}return b};function IndexedGeometryArray3D(b,c,a,d){this.vertices=b;this.vertexIndices=c;this.textureCoordinates=a;this.textureCoordinateIndices=d;this.textureCoordinatesDefined=this.textureCoordinateIndices&&this.textureCoordinateIndices.length>0}IndexedGeometryArray3D.prototype.hasTextureCoordinates=function(){return this.textureCoordinatesDefined};IndexedGeometryArray3D.prototype.disposeCoordinates=function(){delete this.textureCoordinates;delete this.textureCoordinateIndices};function IndexedLineArray3D(b,c,a,d){IndexedGeometryArray3D.call(this,b,c,a,d)}IndexedLineArray3D.prototype=Object.create(IndexedGeometryArray3D.prototype);IndexedLineArray3D.prototype.constructor=IndexedLineArray3D;function IndexedTriangleArray3D(c,d,a,f,e,b){IndexedGeometryArray3D.call(this,c,d,a,f);this.normals=e;this.normalIndices=b}IndexedTriangleArray3D.prototype=Object.create(IndexedGeometryArray3D.prototype);IndexedTriangleArray3D.prototype.constructor=IndexedTriangleArray3D;IndexedTriangleArray3D.prototype.disposeCoordinates=function(){IndexedGeometryArray3D.prototype.disposeCoordinates.call(this);delete this.normals;delete this.normalIndices};function BoundingBox3D(a,b){this.lower=a!==undefined?vec3.clone(a):vec3.fromValues(-1,-1,-1);this.upper=b!==undefined?vec3.clone(b):vec3.fromValues(1,1,1)}BoundingBox3D.prototype.getLower=function(a){vec3.copy(a,this.lower)};BoundingBox3D.prototype.getUpper=function(a){vec3.copy(a,this.upper)};BoundingBox3D.prototype.isEmpty=function(){return this.lower[0]===Infinity&&this.lower[1]===Infinity&&this.lower[2]===Infinity&&this.upper[0]===-Infinity&&this.upper[1]===-Infinity&&this.upper[2]===-Infinity};BoundingBox3D.prototype.combine=function(b){if(b instanceof BoundingBox3D){if(this.lower[0]>b.lower[0]){this.lower[0]=b.lower[0]}if(this.lower[1]>b.lower[1]){this.lower[1]=b.lower[1]}if(this.lower[2]>b.lower[2]){this.lower[2]=b.lower[2]}if(this.upper[0]<b.upper[0]){this.upper[0]=b.upper[0]}if(this.upper[1]<b.upper[1]){this.upper[1]=b.upper[1]}if(this.upper[2]<b.upper[2]){this.upper[2]=b.upper[2]}}else{var a=b;if(this.lower[0]>a[0]){this.lower[0]=a[0]}if(this.lower[1]>a[1]){this.lower[1]=a[1]}if(this.lower[2]>a[2]){this.lower[2]=a[2]}if(this.upper[0]<a[0]){this.upper[0]=a[0]}if(this.upper[1]<a[1]){this.upper[1]=a[1]}if(this.upper[2]<a[2]){this.upper[2]=a[2]}}};BoundingBox3D.prototype.intersect=function(a){return !this.isEmpty()&&a[0]>=this.lower[0]&&a[0]<=this.upper[0]&&a[1]>=this.lower[1]&&a[1]<=this.upper[1]&&a[2]>=this.lower[2]&&a[2]<=this.upper[2]};BoundingBox3D.prototype.transform=function(g){if(!this.isEmpty()){var f=this.upper[0];var e=this.upper[1];var d=this.upper[2];var c=this.lower[0];var a=this.lower[1];var h=this.lower[2];var b=vec3.fromValues(f,e,d);vec3.transformMat4(b,b,g);this.upper[0]=b[0];this.upper[1]=b[1];this.upper[2]=b[2];this.lower[0]=b[0];this.lower[1]=b[1];this.lower[2]=b[2];vec3.set(b,c,e,d);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,c,a,d);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,f,a,d);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,c,e,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,f,e,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,c,a,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}vec3.set(b,f,a,h);vec3.transformMat4(b,b,g);if(b[0]>this.upper[0]){this.upper[0]=b[0]}if(b[1]>this.upper[1]){this.upper[1]=b[1]}if(b[2]>this.upper[2]){this.upper[2]=b[2]}if(b[0]<this.lower[0]){this.lower[0]=b[0]}if(b[1]<this.lower[1]){this.lower[1]=b[1]}if(b[2]<this.lower[2]){this.lower[2]=b[2]}}};BoundingBox3D.prototype.clone=function(){return new BoundingBox3D(this.lower,this.upper)};function Box3D(a,d,c,b){Shape3D.call(this,new IndexedTriangleArray3D([vec3.fromValues(-a,-d,-c),vec3.fromValues(a,-d,-c),vec3.fromValues(a,-d,c),vec3.fromValues(-a,-d,c),vec3.fromValues(-a,d,-c),vec3.fromValues(-a,d,c),vec3.fromValues(a,d,c),vec3.fromValues(a,d,-c)],[0,1,2,0,2,3,4,5,6,4,6,7,0,3,5,0,5,4,1,7,6,1,6,2,0,4,7,0,7,1,2,6,5,2,5,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[0,1,2,0,2,3,3,0,1,3,1,2,0,1,2,0,2,3,1,2,3,1,3,0,1,2,3,1,3,0,1,2,3,1,3,0],[vec3.fromValues(0,-1,0),vec3.fromValues(0,1,0),vec3.fromValues(-1,0,0),vec3.fromValues(1,0,0),vec3.fromValues(0,0,-1),vec3.fromValues(0,0,1)],[0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5]),b);this.bounds=new BoundingBox3D(vec3.fromValues(-a,-d,-c),vec3.fromValues(a,d,c))}Box3D.prototype=Object.create(Shape3D.prototype);Box3D.prototype.constructor=Box3D;function GeometryInfo3D(a){this.type=a}GeometryInfo3D.TRIANGLE_ARRAY=0;GeometryInfo3D.TRIANGLE_STRIP_ARRAY=1;GeometryInfo3D.TRIANGLE_FAN_ARRAY=2;GeometryInfo3D.QUAD_ARRAY=10;GeometryInfo3D.POLYGON_ARRAY=20;GeometryInfo3D.prototype.setCoordinates=function(a){this.vertices=a};GeometryInfo3D.prototype.setCoordinateIndices=function(a){this.coordinatesIndices=a};GeometryInfo3D.prototype.setNormals=function(a){this.normals=a};GeometryInfo3D.prototype.setNormalIndices=function(a){this.normalIndices=a};GeometryInfo3D.prototype.setTextureCoordinates=function(a){this.textureCoordinates=a};GeometryInfo3D.prototype.setTextureCoordinateIndices=function(a){this.textureCoordinateIndices=a};GeometryInfo3D.prototype.setStripCounts=function(a){this.stripCounts=a};GeometryInfo3D.prototype.setContourCounts=function(a){this.contourCounts=a};GeometryInfo3D.prototype.setCreaseAngle=function(a){this.creaseAngle=a};GeometryInfo3D.prototype.setGeneratedNormals=function(a){this.generatedNormals=a};GeometryInfo3D.prototype.computeNormals=function(c,a,k,e){var b;if(this.creaseAngle===undefined){b=44*Math.PI/180}else{b=this.creaseAngle}var n=vec3.create();var m=vec3.create();if(b>0){var g=[];for(var p=0;p<a.length;p+=3){var q=c[a[p+1]];vec3.sub(n,c[a[p+2]],q);vec3.sub(m,c[a[p]],q);var u=vec3.cross(vec3.create(),n,m);for(var o=0;o<3;o++){var t={normal:u};var f=a[p+o];t.nextVertex=g[f];g[f]=t;k.push(u);e.push(k.length-1)}}var l=vec3.create();for(var p=0;p<a.length;p+=3){for(var o=0;o<3;o++){var f=a[p+o];var s=e[p+o];var h=k[s];var u=vec3.create();for(var t=g[f];t!==undefined;t=t.nextVertex){if(t.normal===h){vec3.add(u,u,t.normal)}else{var d=vec3.dot(t.normal,h);if(d>0||b>Math.PI/2){var r=Math.abs(Math.atan2(vec3.length(vec3.cross(l,t.normal,h)),d));if(r<b-0.001){vec3.add(u,u,t.normal)}}}}if(vec3.squaredLength(u)!==0){vec3.normalize(u,u)}else{vec3.copy(u,h);vec3.normalize(u,u)}k[s]=u}}}else{for(var p=0;p<a.length;p+=3){var q=c[a[p+1]];vec3.sub(n,c[a[p+2]],q);vec3.sub(m,c[a[p]],q);var u=vec3.cross(vec3.create(),n,m);vec3.normalize(u,u);var s=k.length-1;if(k.length===0||!vec3.exactEquals(k[s],u)){k.push(u);s++}for(var o=0;o<3;o++){e.push(s)}}}};GeometryInfo3D.prototype.getIndexedGeometryArray=function(){if(this.vertices&&!this.coordinatesIndices){this.coordinatesIndices=new Array(this.vertices.length);if(this.generatedNormals&&(this.creaseAngle===undefined||this.creaseAngle>0)){for(var g=0;g<this.coordinatesIndices.length;g++){for(var f=0;f<this.vertices.length;f++){if(vec3.exactEquals(this.vertices[g],this.vertices[f])){this.coordinatesIndices[g]=f;break}}}}else{for(var g=0;g<this.coordinatesIndices.length;g++){this.coordinatesIndices[g]=g}}}if(this.textureCoordinates&&!this.textureCoordinateIndices){this.textureCoordinateIndices=new Array(this.textureCoordinates.length);for(var g=0;g<this.textureCoordinateIndices.length;g++){this.textureCoordinateIndices[g]=g}}if(this.normals&&!this.normalIndices&&!this.generatedNormals){this.normalIndices=new Array(this.normals.length);for(var g=0;g<this.normalIndices.length;g++){this.normalIndices[g]=g}}var b;var m;var c;if(this.type===GeometryInfo3D.POLYGON_ARRAY){b=[];m=[];c=[];new Triangulator().triangulate(this.vertices,this.coordinatesIndices,this.textureCoordinates?this.textureCoordinateIndices:[],this.normals?this.normalIndices:[],this.stripCounts,b,m,c)}else{if(this.type===GeometryInfo3D.QUAD_ARRAY){b=[];m=[];c=[];for(var g=0;g<this.coordinatesIndices.length;g+=4){b.push(this.coordinatesIndices[g]);b.push(this.coordinatesIndices[g+1]);b.push(this.coordinatesIndices[g+2]);b.push(this.coordinatesIndices[g+2]);b.push(this.coordinatesIndices[g+3]);b.push(this.coordinatesIndices[g]);if(this.textureCoordinateIndices){m.push(this.textureCoordinateIndices[g]);m.push(this.textureCoordinateIndices[g+1]);m.push(this.textureCoordinateIndices[g+2]);m.push(this.textureCoordinateIndices[g+2]);m.push(this.textureCoordinateIndices[g+3]);m.push(this.textureCoordinateIndices[g])}if(this.normalIndices){c.push(this.normalIndices[g]);c.push(this.normalIndices[g+1]);c.push(this.normalIndices[g+2]);c.push(this.normalIndices[g+2]);c.push(this.normalIndices[g+3]);c.push(this.normalIndices[g])}}}else{if(this.type===GeometryInfo3D.TRIANGLE_STRIP_ARRAY){b=[];m=[];c=[];for(var g=0,h=0;g<this.stripCounts.length;g++){var l=this.stripCounts[g];for(var d=0;d<l-2;d++){var e=h+(d%2===0?d+1:d+2);var a=h+(d%2===0?d+2:d+1);b.push(this.coordinatesIndices[h+d]);b.push(this.coordinatesIndices[e]);b.push(this.coordinatesIndices[a]);if(this.textureCoordinateIndices){m.push(this.textureCoordinateIndices[h+d]);m.push(this.textureCoordinateIndices[e]);m.push(this.textureCoordinateIndices[a])}if(this.normalIndices){c.push(this.normalIndices[h+d]);c.push(this.normalIndices[e]);c.push(this.normalIndices[a])}}h+=l}}else{if(this.type===GeometryInfo3D.TRIANGLE_FAN_ARRAY){b=[];m=[];c=[];for(var g=0,h=0;g<this.stripCounts.length;g++){var l=this.stripCounts[g];for(var d=0;d<l-2;d++){b.push(this.coordinatesIndices[h]);b.push(this.coordinatesIndices[h+d+1]);b.push(this.coordinatesIndices[h+d+2]);if(this.textureCoordinateIndices){m.push(this.textureCoordinateIndices[h]);m.push(this.textureCoordinateIndices[h+d+1]);m.push(this.textureCoordinateIndices[h+d+2])}if(this.normalIndices){c.push(this.normalIndices[h]);c.push(this.normalIndices[h+d+1]);c.push(this.normalIndices[h+d+2])}}h+=l}}else{b=this.vertices?this.coordinatesIndices:[];m=this.textureCoordinates?this.textureCoordinateIndices:[];c=this.normals?this.normalIndices:[]}}}}var n;if(this.generatedNormals){n=[];c=[];this.computeNormals(this.vertices,b,n,c)}else{n=this.normals}return new IndexedTriangleArray3D(this.vertices,b,this.textureCoordinates,m,n,c)};function IncorrectFormat3DException(a){this.message=a}function HTMLCanvas3D(d,b){this.scene=null;this.textures=[];this.sharedGeometries=[];this.sceneGeometries=[];this.backgroundGeometries=[];this.lights=[];this.fieldOfView=Math.PI*45/180;this.frontClipDistance=0.1;this.backClipDistance=100;this.projectionPolicy=HTMLCanvas3D.PERSPECTIVE_PROJECTION;this.offscreen=b===true;this.canvas=typeof d==="string"?document.getElementById(d):d;this.gl=this.canvas.getContext("webgl");if(!this.gl){this.gl=this.canvas.getContext("experimental-webgl");if(!this.gl){throw"No WebGL"}}this.updateViewportSize();this.shaderProgram=this.gl.createProgram();var c=this.createShader(this.gl.VERTEX_SHADER,"attribute vec3 vertexPosition;attribute vec3 vertexNormal;attribute vec2 vertexTextureCoord;uniform mat4 modelViewTransform;uniform mat4 projectionTransform;uniform bool textureCoordinatesGenerated;uniform vec4 planeS;uniform vec4 planeT;uniform mat3 textureCoordTransform;uniform mat3 normalTransform;uniform bool ignoreNormal;uniform bool backFaceNormalFlip;uniform bool lightingEnabled;uniform bool useTextures;varying vec2 varTextureCoord;varying vec4 varVertexPosition;varying vec3 varTransformedNormal;void main(void) {  varVertexPosition = modelViewTransform * vec4(vertexPosition, 1.0);  gl_Position = projectionTransform * varVertexPosition;  if (useTextures) {    if (textureCoordinatesGenerated) {      varTextureCoord = vec2(vertexPosition.x * planeS.x + vertexPosition.y * planeS.y          + vertexPosition.z * planeS.z + planeS.w,            vertexPosition.x * planeT.x + vertexPosition.y * planeT.y          + vertexPosition.z * planeT.z + planeT.w);    } else {      varTextureCoord = vec2(vertexTextureCoord);    }    varTextureCoord = vec2(textureCoordTransform * vec3(varTextureCoord, 1));  }  if (lightingEnabled) {    vec3 normal;    if (ignoreNormal) {      normal = vec3(1., 1., 1.);    } else {      normal = vertexNormal;      if (backFaceNormalFlip) {        normal = -normal;      }    }    varTransformedNormal = normalize(normalTransform * normal);  }}");this.gl.attachShader(this.shaderProgram,c);var a=this.createShader(this.gl.FRAGMENT_SHADER,"precision mediump float;uniform vec3  vertexDiffuseColor;uniform vec3  vertexSpecularColor;uniform float shininess;uniform sampler2D sampler;uniform float alpha;uniform bool  useTextures;uniform bool  lightingEnabled;uniform vec3  ambientColor;uniform int   directionalLightCount;uniform vec3  lightDirections["+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"];uniform vec3  directionalLightColors["+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"];varying vec2  varTextureCoord;varying vec4  varVertexPosition;varying vec3  varTransformedNormal;void main(void) {  vec3 lightWeight;  if (lightingEnabled) {    lightWeight = ambientColor;    if (directionalLightCount > 0) {      vec3 diffuseLightWeight = vec3(0., 0., 0.);      vec3 specularLightWeight = vec3(0., 0., 0.);      vec3 eyeDirection = vec3(0., 0., 0.);      bool computeSpecularLightWeight = false;      if (vertexSpecularColor.r > 0.          && vertexSpecularColor.g > 0.          && vertexSpecularColor.b > 0.) {        eyeDirection = normalize(-varVertexPosition.xyz);        computeSpecularLightWeight = length(eyeDirection) <= 1.0001;      }      for (int i = 0; i < "+HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT+"; i++) {        if (i >= directionalLightCount) {          break;        }        float directionalLightWeight = max(dot(varTransformedNormal, lightDirections[i]), 0.);        diffuseLightWeight += directionalLightColors[i] * directionalLightWeight;        if (computeSpecularLightWeight) {          vec3 reflectionDirection = reflect(-lightDirections[i], varTransformedNormal);          specularLightWeight += directionalLightColors[i] * pow(max(dot(reflectionDirection, eyeDirection), 0.), shininess);        }      }      lightWeight += vertexDiffuseColor * diffuseLightWeight;      if (computeSpecularLightWeight) {        lightWeight += vertexSpecularColor * specularLightWeight;      }    }  } else {    lightWeight = vertexDiffuseColor;  }  vec4 fragmentColor;  if (useTextures) {    fragmentColor = texture2D(sampler, vec2(varTextureCoord.s, varTextureCoord.t));  } else {    fragmentColor = vec4(1., 1., 1., 1.);  }  gl_FragColor = vec4(fragmentColor.rgb * lightWeight * alpha, fragmentColor.a * alpha);}");this.gl.attachShader(this.shaderProgram,a);this.gl.linkProgram(this.shaderProgram);this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexPosition");this.shaderProgram.normalAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexNormal");this.shaderProgram.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"vertexTextureCoord");this.shaderProgram.projectionTransform=this.gl.getUniformLocation(this.shaderProgram,"projectionTransform");this.shaderProgram.modelViewTransform=this.gl.getUniformLocation(this.shaderProgram,"modelViewTransform");this.shaderProgram.textureCoordinatesGenerated=this.gl.getUniformLocation(this.shaderProgram,"textureCoordinatesGenerated");this.shaderProgram.planeS=this.gl.getUniformLocation(this.shaderProgram,"planeS");this.shaderProgram.planeT=this.gl.getUniformLocation(this.shaderProgram,"planeT");this.shaderProgram.textureCoordTransform=this.gl.getUniformLocation(this.shaderProgram,"textureCoordTransform");this.shaderProgram.normalTransform=this.gl.getUniformLocation(this.shaderProgram,"normalTransform");this.shaderProgram.ignoreNormal=this.gl.getUniformLocation(this.shaderProgram,"ignoreNormal");this.shaderProgram.backFaceNormalFlip=this.gl.getUniformLocation(this.shaderProgram,"backFaceNormalFlip");this.shaderProgram.ambientColor=this.gl.getUniformLocation(this.shaderProgram,"ambientColor");this.shaderProgram.lightingEnabled=this.gl.getUniformLocation(this.shaderProgram,"lightingEnabled");this.shaderProgram.directionalLightCount=this.gl.getUniformLocation(this.shaderProgram,"directionalLightCount");this.shaderProgram.lightDirections=this.gl.getUniformLocation(this.shaderProgram,"lightDirections");this.shaderProgram.directionalLightColors=this.gl.getUniformLocation(this.shaderProgram,"directionalLightColors");this.shaderProgram.vertexDiffuseColor=this.gl.getUniformLocation(this.shaderProgram,"vertexDiffuseColor");this.shaderProgram.vertexSpecularColor=this.gl.getUniformLocation(this.shaderProgram,"vertexSpecularColor");this.shaderProgram.shininess=this.gl.getUniformLocation(this.shaderProgram,"shininess");this.shaderProgram.alpha=this.gl.getUniformLocation(this.shaderProgram,"alpha");this.shaderProgram.useTextures=this.gl.getUniformLocation(this.shaderProgram,"useTextures");this.gl.useProgram(this.shaderProgram);this.viewPlatformTransform=mat4.create();mat4.translate(this.viewPlatformTransform,this.viewPlatformTransform,[0,0,-2.4]);this.geometryAmbientColor=vec3.create();this.geometrySpecularColor=vec3.create();this.geometryModelViewTransform=mat4.create();this.geometryNormalTransform=mat3.create();this.shaderAmbientColor=vec3.create();this.gl.uniform3fv(this.shaderProgram.ambientColor,this.shaderAmbientColor);this.shaderSpecularColor=vec3.create();this.gl.uniform3fv(this.shaderProgram.vertexSpecularColor,this.shaderSpecularColor);this.geometryDiffuseColor=vec3.create();this.shaderDiffuseColor=vec3.fromValues(1,1,1);this.gl.uniform3fv(this.shaderProgram.vertexDiffuseColor,this.shaderDiffuseColor);this.shaderModelViewTransform=mat4.create();this.gl.uniformMatrix4fv(this.shaderProgram.modelViewTransform,false,this.shaderModelViewTransform);this.shaderNormalTransform=mat3.create();this.gl.uniformMatrix3fv(this.shaderProgram.normalTransform,false,this.shaderNormalTransform);this.shaderTextureTransform=mat3.create();this.gl.uniformMatrix3fv(this.shaderProgram.textureCoordTransform,false,this.shaderTextureTransform);this.shaderLightingEnabled=true;this.gl.uniform1i(this.shaderProgram.lightingEnabled,this.shaderLightingEnabled);this.shaderShininess=1;this.gl.uniform1f(this.shaderProgram.shininess,this.shaderShininess);this.shaderIgnoreNormal=false;this.gl.uniform1i(this.shaderProgram.ignoreNormal,this.shaderIgnoreNormal);this.shaderBackFaceNormalFlip=false;this.gl.uniform1i(this.shaderProgram.backFaceNormalFlip,this.shaderBackFaceNormalFlip);this.shaderTextureCoordinatesGenerated=false;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,false);this.shaderUseTextures=false;this.gl.uniform1i(this.shaderProgram.useTextures,false);this.shaderAlpha=1;this.gl.uniform1f(this.shaderProgram.alpha,this.shaderAlpha);this.gl.enable(this.gl.CULL_FACE);this.gl.cullFace(this.gl.BACK);this.canvasNeededRepaint=false;this.pickingFrameBufferNeededRepaint=true;this.errorTexture=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,this.errorTexture);var e=new Uint8Array([255,0,0,255]);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR);this.gl.bindTexture(this.gl.TEXTURE_2D,null)}HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT=16;HTMLCanvas3D.VEC4_DEFAULT_PLANE_S=vec4.fromValues(1,0,0,0);HTMLCanvas3D.VEC4_DEFAULT_PLANE_T=vec4.fromValues(0,1,0,0);HTMLCanvas3D.MAT3_IDENTITY=mat3.create();HTMLCanvas3D.PARALLEL_PROJECTION=0;HTMLCanvas3D.PERSPECTIVE_PROJECTION=1;HTMLCanvas3D.prototype.createShader=function(a,c){var b=this.gl.createShader(a);this.gl.shaderSource(b,c);this.gl.compileShader(b);if(!this.gl.getShaderParameter(b,this.gl.COMPILE_STATUS)){throw"Invalid shader: "+c}return b};HTMLCanvas3D.prototype.getCanvas=function(){return this.canvas};HTMLCanvas3D.prototype.getHTMLElement=function(){return this.getCanvas()};HTMLCanvas3D.prototype.getDepthBits=function(){return this.gl.getParameter(this.gl.DEPTH_BITS)};HTMLCanvas3D.prototype.setFieldOfView=function(a){if(this.fieldOfView!=a){this.fieldOfView=a;this.repaint()}};HTMLCanvas3D.prototype.setFrontClipDistance=function(a){if(this.frontClipDistance!=a){this.frontClipDistance=a;this.repaint()}};HTMLCanvas3D.prototype.setBackClipDistance=function(a){if(this.backClipDistance!=a){this.backClipDistance=a;this.repaint()}};HTMLCanvas3D.prototype.getViewPlatformTransform=function(a){return mat4.copy(a,this.viewPlatformTransform)};HTMLCanvas3D.prototype.setViewPlatformTransform=function(a){if(this.viewPlatformTransform!=a){this.viewPlatformTransform=a;this.repaint()}};HTMLCanvas3D.prototype.updateViewportSize=function(){var c;try{c=this.canvas.getBoundingClientRect()}catch(a){c={width:this.canvas.width,height:this.canvas.height}}var b=c.width!==0&&c.height!==0;if(!b){c={width:this.canvas.width,height:this.canvas.height}}if(this.viewportWidth!=c.width||this.viewportHeight!=c.height){this.viewportWidth=c.width;this.viewportHeight=c.height;this.canvas.width=this.viewportWidth;this.canvas.height=this.viewportHeight;if(this.pickingFrameBuffer!==undefined){this.gl.deleteFramebuffer(this.pickingFrameBuffer);delete this.pickingFrameBuffer}if(b){this.repaint()}}};HTMLCanvas3D.prototype.setScene=function(f,c){var a=[];var d=[];var g=[];var b=[];var h=this.countDisplayedGeometries(f);this.prepareScene(f,a,d,g,false,[],b,mat4.create(),c,h);this.scene=f;this.sharedGeometries=a;this.sceneGeometries=d;this.backgroundGeometries=g;this.lights=b;if(this.offscreen){this.canvasNeededRepaint=true;if(c!==undefined){c(ModelLoader.BINDING_MODEL,"",1)}}else{var e=this;setTimeout(function(){if(c!==undefined){c(ModelLoader.BINDING_MODEL,"",1)}e.drawScene()},0)}};HTMLCanvas3D.prototype.getScene=function(){return this.scene};HTMLCanvas3D.prototype.countDisplayedGeometries=function(c){if(c instanceof Group3D){var d=0;var b=c.getChildren();for(var a=0;a<b.length;a++){d+=this.countDisplayedGeometries(b[a])}return d}else{if(c instanceof Link3D){return this.countDisplayedGeometries(c.getSharedGroup())}else{if(c instanceof Shape3D){return c.getGeometries().length}else{return 0}}}};HTMLCanvas3D.DEFAULT_APPEARANCE=new Appearance3D();HTMLCanvas3D.prototype.prepareScene=function(l,c,j,e,o,p,q,f,k,d){var s=this;if(l instanceof Group3D){if(l instanceof TransformGroup3D){var m=mat4.create();l.getTransform(m);f=mat4.mul(mat4.create(),f,m);if(l.getCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE)){l.addPropertyChangeListener("TRANSFORM",{propertyChange:function(v){var u=l.getChildren();for(var t=0;t<u.length;t++){s.updateChildrenTransformation(u[t],o?e:j,p,q,s.getTransformFromRoot(l))}s.repaint()}})}}var b=l.getChildren();for(var n=0;n<b.length;n++){this.prepareScene(b[n],c,j,e,o,p,q,f,k,d)}if(l.getCapability(Group3D.ALLOW_CHILDREN_EXTEND)){l.addChildrenListener({childAdded:function(t){s.prepareScene(t.child,c,j,e,o,p,q,s.getTransformFromRoot(l));s.repaint()},childRemoved:function(t){s.removeDisplayedItems(t.child,c,o?e:j,q);s.removeNodeListeners(t.child);s.repaint()}})}}else{if(l instanceof Link3D){p=p.slice(0);p.push(l);this.prepareScene(l.getSharedGroup(),c,j,e,o,p,q,f,k,d)}else{if(l instanceof Shape3D){if(k!==undefined&&!o&&Math.floor((j.length-1)/d*10)<Math.floor(j.length/d*10)){k(ModelLoader.BINDING_MODEL,"",j.length/d)}var r=l.getAppearance();if(!r){r=HTMLCanvas3D.DEFAULT_APPEARANCE}var h=null;if(r.getTextureImage()){h=this.prepareTexture(r.getTextureImage())}var g=l.getGeometries();for(var n=0;n<g.length;n++){this.prepareGeometry(g[n],r,h,l,c,j,e,o,p,f)}if(l.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){l.addPropertyChangeListener("GEOMETRY",{propertyChange:function(w){if(w.getOldValue()){removedGeometry=w.getOldValue();for(var u=0;u<j.length;u++){var x=j[u];if(x.nodeGeometry===removedGeometry){s.clearGeometryBuffers(x);j.splice(u,1);break}}}if(w.getNewValue()){addedGeometry=w.getNewValue();var t=l.getAppearance();if(!t){t=HTMLCanvas3D.DEFAULT_APPEARANCE}var v=null;if(t.getTextureImage()){v=s.prepareTexture(t.getTextureImage())}s.prepareGeometry(addedGeometry,t,v,l,c,j,e,o,p,s.getTransformFromRoot(l))}}})}if(r!==HTMLCanvas3D.DEFAULT_APPEARANCE){r.addPropertyChangeListener({propertyChange:function(w){var v=o?e:j;for(var u=0;u<v.length;u++){var y=v[u];if(y.node===l){var x=w.getNewValue();switch(w.getPropertyName()){case"AMBIENT_COLOR":y.ambientColor=x;break;case"DIFFUSE_COLOR":y.diffuseColor=x;break;case"SPECULAR_COLOR":y.specularColor=x;break;case"SHININESS":y.shininess=x;break;case"TRANSPARENCY":y.transparency=x!=null?1-x:1;break;case"ILLUMINATION":y.lightingEnabled=(x==null||x>=1)&&y.mode===s.gl.TRIANGLES;break;case"TEXTURE_IMAGE":y.texture=x!=null?s.prepareTexture(x):undefined;break;case"TEXTURE_COORDINATES_GENERATION":var t=x;y.textureCoordinatesGeneration=t;break;case"TEXTURE_TRANSFORM":y.textureTransform=x;break;case"VISIBLE":y.visible=x!==false;break;case"CULL_FACE":y.cullFace=x;break;case"BACK_FACE_NORMAL_FLIP":y.backFaceNormalFlip=x===true;break}}}s.repaint()}})}}else{if(l instanceof Background3D){this.prepareScene(l.getGeometry(),c,j,e,true,p,q,f)}else{if(l instanceof Light3D){var a={node:l,color:l.getColor()};if(l instanceof DirectionalLight3D){a.direction=l.getDirection();a.transform=f}q.push(a);l.addPropertyChangeListener("COLOR",{canvas3D:s,propertyChange:function(v){for(var u=0;u<q.length;u++){var t=q[u];if(q[u].node===l){t.color=v.getNewValue();break}}s.repaint()}})}}}}}};HTMLCanvas3D.prototype.getTransformFromRoot=function(c){var b=mat4.create();if(c instanceof TransformGroup3D){c.getTransform(b)}if(c!==null){var a=c.getParent();if(a instanceof Group3D){mat4.mul(b,this.getTransformFromRoot(a),b)}}return b};HTMLCanvas3D.prototype.prepareGeometry=function(f,y,n,q,d,o,g,u,w,j){var b=null;if(!q.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){for(var s=0;s<d.length;s++){if(d[s].nodeGeometry===f){b={node:q,center:d[s].center,nodeGeometry:f,vertexCount:d[s].vertexCount,vertexBuffer:d[s].vertexBuffer,textureCoordinatesBuffer:d[s].textureCoordinatesBuffer,normalBuffer:d[s].normalBuffer,mode:d[s].mode};d[s].referenceCount++;break}}}if(b===null){var e=q.getBounds();var x=vec3.create();e.getLower(x);var t=vec3.create();e.getUpper(t);var v=vec3.fromValues((x[0]+t[0])/2,(x[1]+t[1])/2,(x[2]+t[2])/2);b={node:q,center:v,nodeGeometry:f,vertexCount:f.vertexIndices.length};b.vertexBuffer=this.prepareBuffer(f.vertices,f.vertexIndices);if(f.hasTextureCoordinates()){b.textureCoordinatesBuffer=this.prepareBuffer(f.textureCoordinates,f.textureCoordinateIndices)}else{b.textureCoordinatesBuffer=null}if(f instanceof IndexedTriangleArray3D){b.mode=this.gl.TRIANGLES;b.normalBuffer=this.prepareBuffer(f.normals,f.normalIndices)}else{b.mode=this.gl.LINES}if(!q.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){d.push({nodeGeometry:f,center:v,vertexCount:b.vertexCount,vertexBuffer:b.vertexBuffer,textureCoordinatesBuffer:b.textureCoordinatesBuffer,normalBuffer:b.normalBuffer,mode:b.mode,referenceCount:1})}}b.transform=j;if(w.length>0){b.parentLinks=w}var c=y.getAmbientColor();if(c!==undefined){b.ambientColor=c}var m=y.getDiffuseColor();if(m!==undefined){b.diffuseColor=m}var h=y.getSpecularColor();if(h!==undefined){b.specularColor=h}var r=y.getShininess();if(r!==undefined){b.shininess=r}var p=y.getTextureCoordinatesGeneration();if(p!==undefined){b.textureCoordinatesGeneration=p}var l=y.getTextureTransform();if(l!==undefined){b.textureTransform=l}if(n!==null){b.texture=n}b.backFaceNormalFlip=y.isBackFaceNormalFlip();if(y.getCullFace()!==undefined){b.cullFace=y.getCullFace()}var a=y.getIllumination();b.lightingEnabled=(a==null||a>=1)&&b.normalBuffer!==null;b.transparency=y.getTransparency()!=null?1-y.getTransparency():1;b.visible=y.isVisible();var k=u?g:o;k.push(b)};HTMLCanvas3D.prototype.updateChildrenTransformation=function(d,a,l,f,k){var c=this;if(d instanceof Group3D){if(d instanceof TransformGroup3D){var m=mat4.create();d.getTransform(m);k=mat4.mul(mat4.create(),k,m)}var b=d.getChildren();for(var g=0;g<b.length;g++){this.updateChildrenTransformation(b[g],a,l,f,k)}}else{if(d instanceof Link3D){l=l.slice(0);l.push(d);this.updateChildrenTransformation(d.getSharedGroup(),a,l,f,k)}else{if(d instanceof Shape3D){for(var g=0;g<a.length;g++){if(a[g].node===d){var h=a[g].parentLinks===undefined;if(!h){if(a[g].parentLinks.length===l.length){var e;for(e=0;e<l.length;e++){if(a[g].parentLinks[e]!==l[e]){break}}h=e===l.length}}if(h){a[g].transform=k;break}}}}else{if(d instanceof Light3D){for(var g=0;g<f.length;g++){if(f[g].node===d){f[g].transform=k;break}}}}}}};HTMLCanvas3D.prototype.removeDisplayedItems=function(c,h,a,f){if(c instanceof Group3D){var b=c.getChildren();for(var g=0;g<b.length;g++){this.removeDisplayedItems(b[g],h,a,f)}}else{if(c instanceof Link3D){this.removeDisplayedItems(c.getSharedGroup(),h,a,f)}else{if(c instanceof Shape3D){var k=c.getGeometries().length;for(var g=a.length-1;k>0&&g>=0;g--){var l=a[g];if(l.node===c){if(c.getCapability(Shape3D.ALLOW_GEOMETRY_WRITE)){this.clearGeometryBuffers(l)}else{for(var e=0;e<h.length;e++){var d=h[e];if(d.nodeGeometry===l.nodeGeometry){if(--d.referenceCount===0){this.clearGeometryBuffers(l);h.splice(e,1)}break}}}a.splice(g,1);k--}}}else{if(c instanceof Light3D){for(var g=0;g<f.length;g++){if(f[g].node===c){f.splice(g,1);break}}}}}}};HTMLCanvas3D.prototype.removeNodeListeners=function(d){var c=d.getPropertyChangeListeners();for(var b=0;b<c.length;b++){if(c[b].canvas3D===this){d.removePropertyChangeListener(c[b])}}if(d instanceof Group3D){c=d.getChildrenListeners();for(var b=0;b<c.length;b++){if(c[b].canvas3D===this){d.removeChildrenListener(c[b])}}var a=d.getChildren();for(var b=0;b<a.length;b++){this.removeNodeListeners(a[b])}}else{if(d instanceof Link3D){this.removeNodeListeners(d.getSharedGroup())}}};HTMLCanvas3D.prototype.prepareTexture=function(a){if(a.url!==undefined){for(var b=0;b<this.textures.length;b++){if(this.textures[b].image.url==a.url){return this.textures[b]}}}var c=this.gl.createTexture();if(c!==null){c.image=a;if(a.width!==0){this.bindTextureAndRepaint(c,true)}else{var d=this;var e=function(){a.removeEventListener("load",e);d.bindTextureAndRepaint(c,false)};a.addEventListener("load",e)}this.textures.push(c);return c}else{console.log("Can't create texture");return this.errorTexture}};HTMLCanvas3D.resizeTransparentTextures=true;HTMLCanvas3D.prototype.bindTextureAndRepaint=function(d,c){if((!Appearance3D.isPowerOfTwo(d.image.naturalWidth)||!Appearance3D.isPowerOfTwo(d.image.naturalHeight))&&(!d.image.transparent||HTMLCanvas3D.resizeTransparentTextures)){var a=document.createElement("canvas");a.width=Appearance3D.getNextHighestPowerOfTwo(d.image.naturalWidth);a.height=Appearance3D.getNextHighestPowerOfTwo(d.image.naturalHeight);var b=a.getContext("2d");b.drawImage(d.image,0,0,d.image.naturalWidth,d.image.naturalHeight,0,0,a.width,a.height);var f=new Image();f.crossOrigin="anonymous";f.url=d.image.url;f.transparent=d.image.transparent;var e=this;var g=function(){f.removeEventListener("load",g);e.bindTexture(d);e.repaint()};f.addEventListener("load",g);f.src=a.toDataURL();d.image=f}else{this.bindTexture(d);if(!c){this.repaint()}}};HTMLCanvas3D.prototype.bindTexture=function(a){this.gl.bindTexture(this.gl.TEXTURE_2D,a);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,true);this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a.image);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);if(Appearance3D.isPowerOfTwo(a.image.naturalWidth)&&Appearance3D.isPowerOfTwo(a.image.naturalHeight)){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST);this.gl.generateMipmap(this.gl.TEXTURE_2D)}else{this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}this.gl.bindTexture(this.gl.TEXTURE_2D,null);delete a.image.src;a.image.bound=true};HTMLCanvas3D.prototype.prepareBuffer=function(e,g){if(g.length>0&&e.length>0){var b=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b);var f=e[0].length;var a=new Float32Array(g.length*f);for(var d=0,c=0;d<g.length;d++,c+=f){a.set(e[g[d]],c)}this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);return b}else{return null}};HTMLCanvas3D.prototype.drawScene=function(){this.gl.viewport(0,0,this.viewportWidth,this.viewportHeight);var h=getComputedStyle(this.canvas).backgroundColor;if(h==""){h=this.canvas.style.backgroundColor}h=h.substring(4,h.length-1).replace(/ /g,"").split(",");this.gl.clearColor(h[0]/256,h[1]/256,h[2]/256,h.length===4?h[3]:1);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);if(this.scene!==null){var b=vec3.create();var g=0;var s=[];var p=[];var d=mat4.invert(mat4.create(),this.viewPlatformTransform);var m=mat4.create();for(var o=0;o<this.lights.length;o++){var f=this.lights[o];if(f.direction!==undefined){var a=vec3.transformMat3(vec3.create(),f.direction,mat3.fromMat4(mat3.create(),mat4.mul(m,d,f.transform)));vec3.normalize(a,a);vec3.negate(a,a);s.push.apply(s,f.color);p.push.apply(p,a);g++}else{vec3.add(b,b,f.color)}}this.gl.uniform1i(this.shaderProgram.directionalLightCount,g);if(g<HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT){s.push.apply(s,new Array((HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT-g)*3));p.push.apply(p,new Array((HTMLCanvas3D.MAX_DIRECTIONAL_LIGHT-g)*3))}this.gl.uniform3fv(this.shaderProgram.directionalLightColors,s);this.gl.uniform3fv(this.shaderProgram.lightDirections,p);var t=2*Math.atan(this.viewportHeight/this.viewportWidth*Math.tan(this.fieldOfView/2));var l=mat4.create();if(this.projectionPolicy===HTMLCanvas3D.PARALLEL_PROJECTION){mat4.ortho(l,-1,1,-1,1,0.001,1)}else{mat4.perspective(l,t,this.viewportWidth/this.viewportHeight,0.001,1)}this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,false,l);var k=mat4.clone(this.viewPlatformTransform);k[12]=0;k[13]=0;k[14]=0;var n=mat4.invert(mat4.create(),k);for(var o=0;o<this.backgroundGeometries.length;o++){var q=this.backgroundGeometries[o];this.drawGeometry(q,n,b,q.lightingEnabled,true,true)}this.gl.clear(this.gl.DEPTH_BUFFER_BIT);this.getVirtualWorldToImageTransform(l);this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,false,l);this.gl.enable(this.gl.DEPTH_TEST);var c=[];for(var o=0;o<this.sceneGeometries.length;o++){var j=this.sceneGeometries[o];if(j.visible){if((j.transparency===undefined||j.transparency===1)&&(j.texture===undefined||j.texture.image===undefined||!j.texture.image.transparent)){this.drawGeometry(j,d,b,j.lightingEnabled,true,true)}else{if(j.transparency>0){c.push(j)}}}}this.gl.enable(this.gl.BLEND);this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);var r=vec3.create();for(var o=0;o<c.length;o++){var j=c[o];vec3.transformMat4(r,j.center,j.transform);vec3.transformMat4(r,r,d);j.zOrder=r[2]}c.sort(function(v,u){return v.zOrder-u.zOrder});for(var o=0;o<c.length;o++){var j=c[o];this.drawGeometry(j,d,b,j.lightingEnabled,true,true)}}var e=Date.now();if(Math.floor(e/1000)>Math.floor(this.lastDrawSceneTime/1000)){this.framesPerSecond=Math.round(this.drawnFrameCount/(e-this.previousFramesPerSecondTime)*10000)/10;this.previousFramesPerSecondTime=e;this.drawnFrameCount=0}if(this.drawnFrameCount===undefined){this.previousFramesPerSecondTime=e;this.drawnFrameCount=0}this.drawnFrameCount++;this.lastDrawSceneTime=e};HTMLCanvas3D.prototype.drawGeometry=function(h,d,b,f,a,c){if(h.cullFace!==this.shaderCullFace){this.shaderCullFace=h.cullFace;if(this.shaderCullFace!==undefined){if(this.shaderCullFace===Appearance3D.CULL_NONE){this.gl.disable(this.gl.CULL_FACE)}else{this.gl.enable(this.gl.CULL_FACE);this.gl.cullFace(this.shaderCullFace===Appearance3D.CULL_BACK?this.gl.BACK:this.gl.FRONT)}}else{this.gl.enable(this.gl.CULL_FACE);this.gl.cullFace(this.gl.BACK)}}mat4.copy(this.geometryModelViewTransform,d);mat4.mul(this.geometryModelViewTransform,this.geometryModelViewTransform,h.transform);if(!mat4.exactEquals(this.shaderModelViewTransform,this.geometryModelViewTransform)){mat4.copy(this.shaderModelViewTransform,this.geometryModelViewTransform);this.gl.uniformMatrix4fv(this.shaderProgram.modelViewTransform,false,this.shaderModelViewTransform)}if(this.shaderLightingEnabled!==f){this.shaderLightingEnabled=f;this.gl.uniform1i(this.shaderProgram.lightingEnabled,this.shaderLightingEnabled)}if(f){if(h.ambientColor!==undefined&&h.texture===undefined){vec3.mul(this.geometryAmbientColor,h.ambientColor,b)}else{vec3.set(this.geometryAmbientColor,0,0,0)}if(!vec3.exactEquals(this.shaderAmbientColor,this.geometryAmbientColor)){vec3.copy(this.shaderAmbientColor,this.geometryAmbientColor);this.gl.uniform3fv(this.shaderProgram.ambientColor,this.shaderAmbientColor)}if(!this.ignoreShininess&&h.specularColor!==undefined&&h.shininess!==undefined){if(this.shaderShininess!==h.shininess){this.shaderShininess=h.shininess;this.gl.uniform1f(this.shaderProgram.shininess,this.shaderShininess)}vec3.copy(this.geometrySpecularColor,h.specularColor)}else{vec3.set(this.geometrySpecularColor,0,0,0)}if(!vec3.exactEquals(this.shaderSpecularColor,this.geometrySpecularColor)){vec3.copy(this.shaderSpecularColor,this.geometrySpecularColor);this.gl.uniform3fv(this.shaderProgram.vertexSpecularColor,this.shaderSpecularColor)}mat3.fromMat4(this.geometryNormalTransform,this.geometryModelViewTransform);if(!mat3.exactEquals(this.shaderNormalTransform,this.geometryNormalTransform)){mat3.copy(this.shaderNormalTransform,this.geometryNormalTransform);this.gl.uniformMatrix3fv(this.shaderProgram.normalTransform,false,this.shaderNormalTransform)}if(this.shaderIgnoreNormal!==(h.mode===this.gl.LINES)){this.shaderIgnoreNormal=h.mode===this.gl.LINES;this.gl.uniform1i(this.shaderProgram.ignoreNormal,this.shaderIgnoreNormal)}if(this.shaderBackFaceNormalFlip!==h.backFaceNormalFlip){this.shaderBackFaceNormalFlip=h.backFaceNormalFlip;this.gl.uniform1i(this.shaderProgram.backFaceNormalFlip,this.shaderBackFaceNormalFlip)}}vec3.set(this.geometryDiffuseColor,1,1,1);if(a&&h.texture!==undefined&&(h.texture.image===undefined||h.texture.image.bound)){this.gl.activeTexture(this.gl.TEXTURE0);if(h.textureCoordinatesGeneration){this.gl.uniform4fv(this.shaderProgram.planeS,h.textureCoordinatesGeneration.planeS);this.gl.uniform4fv(this.shaderProgram.planeT,h.textureCoordinatesGeneration.planeT);if(!this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=true;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,true)}}else{if(h.textureCoordinatesBuffer===null){this.gl.uniform4fv(this.shaderProgram.planeS,HTMLCanvas3D.VEC4_DEFAULT_PLANE_S);this.gl.uniform4fv(this.shaderProgram.planeT,HTMLCanvas3D.VEC4_DEFAULT_PLANE_T);if(!this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=true;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,true)}}else{if(this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=false;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,false)}}}var e=h.textureTransform!==undefined?h.textureTransform:HTMLCanvas3D.MAT3_IDENTITY;if(!mat3.exactEquals(this.shaderTextureTransform,e)){mat3.copy(this.shaderTextureTransform,e);this.gl.uniformMatrix3fv(this.shaderProgram.textureCoordTransform,false,this.shaderTextureTransform)}this.gl.bindTexture(this.gl.TEXTURE_2D,h.texture);if(!this.shaderUseTextures){this.shaderUseTextures=true;this.gl.uniform1i(this.shaderProgram.useTextures,true)}}else{if(this.shaderTextureCoordinatesGenerated){this.shaderTextureCoordinatesGenerated=false;this.gl.uniform1i(this.shaderProgram.textureCoordinatesGenerated,false)}if(this.shaderUseTextures){this.shaderUseTextures=false;this.gl.uniform1i(this.shaderProgram.useTextures,false)}if(h.diffuseColor!==undefined){vec3.copy(this.geometryDiffuseColor,h.diffuseColor)}}if(!vec3.exactEquals(this.shaderDiffuseColor,this.geometryDiffuseColor)){vec3.copy(this.shaderDiffuseColor,this.geometryDiffuseColor);this.gl.uniform3fv(this.shaderProgram.vertexDiffuseColor,this.shaderDiffuseColor)}this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h.vertexBuffer);this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,false,0,0);if(f&&h.mode===this.gl.TRIANGLES){this.gl.enableVertexAttribArray(this.shaderProgram.normalAttribute);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h.normalBuffer);this.gl.vertexAttribPointer(this.shaderProgram.normalAttribute,3,this.gl.FLOAT,false,0,0)}else{this.gl.disableVertexAttribArray(this.shaderProgram.normalAttribute)}if(a&&h.textureCoordinatesBuffer!==null&&h.texture!==undefined){this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h.textureCoordinatesBuffer);this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute,2,this.gl.FLOAT,false,0,0)}else{this.gl.disableVertexAttribArray(this.shaderProgram.textureCoordAttribute)}var g=h.transparency&&c?h.transparency:1;if(this.shaderAlpha!==g){this.shaderAlpha=g;this.gl.uniform1f(this.shaderProgram.alpha,this.shaderAlpha)}this.gl.drawArrays(h.mode,0,h.vertexCount)};HTMLCanvas3D.prototype.getFramesPerSecond=function(){return this.framesPerSecond};HTMLCanvas3D.prototype.repaint=function(){if(!this.canvasNeededRepaint){this.canvasNeededRepaint=true;if(!this.offscreen){var a=this;requestAnimationFrame(function(){if(a.canvasNeededRepaint){a.drawScene();a.canvasNeededRepaint=false;a.pickingFrameBufferNeededRepaint=true}})}}};HTMLCanvas3D.prototype.getVirtualWorldToImageTransform=function(b,a){if(a===undefined){a=this.viewportWidth/this.viewportHeight}var c=2*Math.atan(Math.tan(this.fieldOfView/2)/a);if(this.projectionPolicy===HTMLCanvas3D.PARALLEL_PROJECTION){mat4.ortho(b,-1,1,-1,1,this.frontClipDistance,this.backClipDistance)}else{mat4.perspective(b,c,a,this.frontClipDistance,this.backClipDistance)}return b};HTMLCanvas3D.prototype.isLoadingCompleted=function(){return this.isTextureLoadingCompleted(this.backgroundGeometries)&&this.isTextureLoadingCompleted(this.sceneGeometries)};HTMLCanvas3D.prototype.isTextureLoadingCompleted=function(b){for(var a=0;a<b.length;a++){var c=b[a].texture;if(c!==undefined&&c.image!==undefined&&!c.image.bound){return false}}return true};HTMLCanvas3D.prototype.getImage=function(a){if(this.canvasNeededRepaint){this.drawScene();this.canvasNeededRepaint=false}var c=new Image();c.crossOrigin="anonymous";var b;if(a!==undefined){b=function(d){c.removeEventListener("load",b);a(c)};c.addEventListener("load",b)}c.src=this.canvas.toDataURL();if(c.width!==0&&a!==undefined){b()}return c};HTMLCanvas3D.prototype.clear=function(){for(var b=0;b<this.textures.length;b++){delete this.textures[b].src;this.gl.deleteTexture(this.textures[b])}this.textures=[];this.gl.deleteTexture(this.errorTexture);this.errorTexture=null;this.clearGeometries(this.sharedGeometries);this.clearGeometries(this.sceneGeometries);this.clearGeometries(this.backgroundGeometries);this.lights=[];if(this.pickingFrameBuffer!==undefined){this.gl.deleteFramebuffer(this.pickingFrameBuffer);delete this.pickingFrameBuffer}var a=this.gl.getAttachedShaders(this.shaderProgram);for(var b=0;b<a.length;b++){this.gl.detachShader(this.shaderProgram,a[b])}this.scene=null;this.repaint()};HTMLCanvas3D.prototype.clearGeometries=function(b){for(var a=0;a<b.length;a++){this.clearGeometryBuffers(b[a])}b.length=0};HTMLCanvas3D.prototype.clearGeometryBuffers=function(a){this.gl.deleteBuffer(a.vertexBuffer);if(a.textureCoordinatesBuffer!==null&&a.texture!==undefined){this.gl.deleteBuffer(a.textureCoordinatesBuffer)}if(a.normalBuffer!==undefined){this.gl.deleteBuffer(a.normalBuffer)}};HTMLCanvas3D.prototype.setProjectionPolicy=function(a){this.projectionPolicy=a};HTMLCanvas3D.prototype.setIgnoreShininess=function(a){this.ignoreShininess=a;this.repaint()};HTMLCanvas3D.prototype.getClosestShapeAt=function(k,j){if(this.pickingFrameBuffer===undefined){this.pickingFrameBuffer=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pickingFrameBuffer);this.pickingFrameBuffer.width=Appearance3D.isPowerOfTwo(this.canvas.width)?this.canvas.width:Appearance3D.getNextHighestPowerOfTwo(this.canvas.width);this.pickingFrameBuffer.height=Appearance3D.isPowerOfTwo(this.canvas.height)?this.canvas.height:Appearance3D.getNextHighestPowerOfTwo(this.canvas.height);this.pickingFrameBuffer.colorMap=new Uint8Array(this.pickingFrameBuffer.width*this.pickingFrameBuffer.height*4);var c=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,c);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);var e=this.gl.createRenderbuffer();this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,e);this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,c,0);this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height);this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,e);this.gl.bindTexture(this.gl.TEXTURE_2D,null)}if(this.pickingFrameBufferNeededRepaint){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pickingFrameBuffer);this.gl.viewport(0,0,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height);this.gl.clearColor(1,1,1,1);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var n=mat4.create();this.getVirtualWorldToImageTransform(n,this.canvas.width/this.canvas.height);this.gl.uniformMatrix4fv(this.shaderProgram.projectionTransform,false,n);this.gl.enable(this.gl.DEPTH_TEST);var m=mat4.invert(mat4.create(),this.viewPlatformTransform);var l=vec3.create();for(var f=0;f<this.sceneGeometries.length;f++){var h=this.sceneGeometries[f];if(h.visible&&h.node.isPickable()){var d=h.diffuseColor;vec3.set(l,((f>>>16)&255)/255,((f>>>8)&255)/255,(f&255)/255);h.diffuseColor=l;this.drawGeometry(h,m,null,false,false,false);if(d!==undefined){h.diffuseColor=d}}}this.gl.readPixels(0,0,this.pickingFrameBuffer.width,this.pickingFrameBuffer.height,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.pickingFrameBuffer.colorMap);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.pickingFrameBufferNeededRepaint=false}var g=this.canvas.getBoundingClientRect();if(k>=g.left&&j>=g.top&&k<g.right&&j<g.bottom){k-=g.left;j-=g.top;var b=(this.pickingFrameBuffer.height-1-Math.floor(j/g.height*this.pickingFrameBuffer.height))*this.pickingFrameBuffer.width+Math.floor(k/g.width*this.pickingFrameBuffer.width);b*=4;var a=this.pickingFrameBuffer.colorMap[b]*65536+this.pickingFrameBuffer.colorMap[b+1]*256+this.pickingFrameBuffer.colorMap[b+2];if(a!=16777215){return this.sceneGeometries[a].node}}return null};var CoreTools={};CoreTools.unavailableResources=[];CoreTools.loadJSON=function(b,a){if(b.indexOf("/")!==0&&b.indexOf("://")<0){b=ZIPTools.getScriptFolder()+b}if(CoreTools.unavailableResources.indexOf(b)<0){try{var d=new XMLHttpRequest();d.open("GET",b,a!==undefined);if(a!==undefined){d.addEventListener("load",function(){if(d.readyState===XMLHttpRequest.DONE){if(d.status===0||d.status===200){try{a.jsonLoaded(JSON.parse(d.responseText))}catch(e){CoreTools.unavailableResources.push(b);if(a!==undefined&&a.jsonError!==undefined){a.jsonError(e,e.message)}}}else{if(a.jsonError!==undefined){a.jsonError(d.status,d.statusText)}}}});d.addEventListener("error",function(){CoreTools.unavailableResources.push(b);if(a.jsonError!==undefined){a.jsonError(d.status,d.statusText)}})}d.send();if(a===undefined){return JSON.parse(d.responseText)}}catch(c){CoreTools.unavailableResources.push(b);if(a!==undefined&&a.jsonError!==undefined){a.jsonError(c,c.message)}}}else{if(a!==undefined&&a.jsonError!==undefined){a.jsonError(404,"No "+b)}}return undefined};CoreTools.format=function(e,j){if(j===undefined||j.length===0){return e}else{var f=/%%|%08X|%s|%d|%\d+\$s|%\d+\$d/g;var c;var o="";var h=0;var l=Array.isArray(j)?j:Array.prototype.slice.call(arguments,1);var d=0;f.lastIndex=0;while((c=f.exec(e))!==null){o+=e.slice(h,f.lastIndex-c[0].length);var a;if(c[0]=="%%"){o+="%"}if(c[0]=="%08X"){var b=l[0];if(b<0){b=4294967295+b+1}var m=b.toString(16).toUpperCase();for(var g=8-m.length;g>0;g--){o+="0"}o+=m}else{if((a=/%(\d+)\$s/g.exec(c[0]))!==null){var k=parseInt(a[1])-1;o+=l[k]}else{if((a=/%(\d+)\$d/g.exec(c[0]))!==null){var k=parseInt(a[1])-1;o+=l[k]}else{if(d<l.length){o+=l[d];d++}}}}h=f.lastIndex}o+=e.slice(h);return o}};CoreTools.removeAccents=function(a){return a!=null?(typeof a.normalize=="function"?a.normalize("NFD").replace(/[\u0300-\u036f]/g,""):a.replace(/[]/g,"a").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"o").replace(/[]/g,"u")):a};CoreTools.loadResourceBundles=function(c,e,a){var d=a?"?requestId="+UUID.randomUUID():"";var b=[];if(e){b.push(CoreTools.loadJSON(c+"_"+e+".json"+d));if(e.indexOf("_")>0){b.push(CoreTools.loadJSON(c+"_"+e.split("_")[0]+".json"+d))}}b.push(CoreTools.loadJSON(c+".json"+d));return b};CoreTools.getStringFromKey=function(c,b,d){for(var a=0;a<c.length;a++){if(c[a]!=null&&c[a][b]!==undefined){return CoreTools.format.apply(null,[c[a][b]].concat(Array.prototype.slice.call(arguments,2)))}}throw new IllegalArgumentException("Can't find resource bundle for "+b)};CoreTools.getKeys=function(b){var c={};for(var a=0;a<b.length;a++){if(b[a]!=null){CoreTools.merge(c,b[a])}}return Object.getOwnPropertyNames(c)};CoreTools.getFromMap=function(d,b){if(typeof b==="string"){return d[b]===undefined?null:d[b]}else{if(d.entries==null){d.entries=[]}var c=typeof b.hashCode==="function"?b.hashCode():undefined;for(var a=0;a<d.entries.length;a++){if((c===undefined||d.entries[a].keyHashCode===c)&&d.entries[a].key.equals!==undefined&&d.entries[a].key.equals(b)||d.entries[a].key===b){return d.entries[a].value}}return null}};CoreTools.putToMap=function(f,b,e){if(typeof b==="string"){f[b]=e}else{if(f.entries==null){f.entries=[]}var d=typeof b.hashCode==="function"?b.hashCode():undefined;for(var a=0;a<f.entries.length;a++){if((d===undefined||f.entries[a].keyHashCode===d)&&f.entries[a].key.equals!==undefined&&f.entries[a].key.equals(b)||f.entries[a].key===b){f.entries[a].value=e;return}}var c={key:b,value:e,getKey:function(){return this.key},getValue:function(){return this.value}};if(typeof b.hashCode==="function"){c.keyHashCode=b.hashCode()}f.entries.push(c)}};CoreTools.removeFromMap=function(e,b){if(typeof b==="string"){var d=e[b];if(d!==undefined){delete e[b]}return d!==undefined?d:null}else{var c=typeof b.hashCode==="function"?b.hashCode():undefined;for(var a=0;a<e.entries.length;a++){if((c===undefined||e.entries[a].keyHashCode===c)&&e.entries[a].key.equals!==undefined&&e.entries[a].key.equals(b)||e.entries[a].key===b){var d=e.entries[a].value;e.entries.splice(a,1);return d}}return null}};CoreTools.valuesFromMap=function(b){var a=[];if(b.entries===undefined){Object.getOwnPropertyNames(b).forEach(function(c){a.push(b[c])})}else{b.entries.forEach(function(c){a.push(c.value)})}return a};CoreTools.sortArray=function(b,a){if(a.compare){b.sort(function(d,c){return a.compare(d,c)})}else{b.sort(a)}};CoreTools.merge=function(a,c){for(var b in c){a[b]=c[b]}};CoreTools.intersection=function(b,a){return b.filter(function(c){return a.indexOf(c)!==-1})};CoreTools.loadAvailableFontNames=function(b){var a=["Arial","Arial Black","Bahnschrift","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Ebrima","Franklin Gothic Medium","Gabriola","Gadugi","Georgia","HoloLens MDL2 Assets","Impact","Ink Free","Javanese Text","Leelawadee UI","Lucida Console","Lucida Sans Unicode","Malgun Gothic","Marlett","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei","Microsoft Yi Baiti","MingLiU-ExtB","Mongolian Baiti","MS Gothic","MV Boli","Myanmar Text","Nirmala UI","Palatino Linotype","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Historic","Segoe UI Emoji","Segoe UI Symbol","SimSun","Sitka","Sylfaen","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings","Yu Gothic"];var d=["American Typewriter","Andale Mono","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Avenir","Avenir Next","Avenir Next Condensed","Baskerville","Big Caslon","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Comic Sans MS","Copperplate","Courier","Courier New","Didot","DIN Alternate","DIN Condensed","Futura","Geneva","Georgia","Gill Sans","Helvetica","Helvetica Neue","Herculanum","Hoefler Text","Impact","Lucida Grande","Luminari","Marker Felt","Menlo","Microsoft Sans Serif","Monaco","Noteworthy","Optima","Palatino","Papyrus","Phosphate","Rockwell","Savoye LET","SignPainter","Skia","Snell Roundhand","Tahoma","Times","Times New Roman","Trattatello","Trebuchet MS","Verdana","Zapfino"];var c=["Arial","Brush Script MT","Courier New","Garamond","Georgia","Helvetica","Tahoma","Times New Roman","Trebuchet MS","Verdana"];if(document.fonts&&!document.fonts.check("12px '@$#%#$@")){document.fonts.ready.then(function(){var e=[];var h=a.concat(d);for(var f=0;f<h.length;f++){var g=h[f];if(e.indexOf(g)<0&&document.fonts.check("12px '"+g+"'")){e.push(g)}}b(e.sort())})}else{if(OperatingSystem.isWindows()){b(a)}else{if(OperatingSystem.isMacOSX()){b(d)}else{b(c)}}}};var ColorTools={};ColorTools.integerToHexadecimalString=function(a){return"#"+("00000"+(a&16777215).toString(16).toUpperCase()).slice(-6)};ColorTools.styleToHexadecimalString=function(b){var c="rgb(";var a=b.indexOf(c);if(a<0){c="rgba(";a=b.indexOf(c)}if(a>=0){var d=b.slice(c.length,b.indexOf(")")).split(",");return ColorTools.integerToHexadecimalString((parseInt(d[0])<<16)+(parseInt(d[1])<<8)+parseInt(d[2]))}return""};ColorTools.styleToInteger=function(b){var c="rgb(";var a=b.indexOf(c);if(a<0){c="rgba(";a=b.indexOf(c)}if(a>=0){var d=b.slice(c.length,b.indexOf(")")).split(",");return(parseInt(d[0])<<16)+(parseInt(d[1])<<8)+parseInt(d[2])}return -1};ColorTools.isTransparent=function(b){var c="rgba(";var a=b.indexOf(c);if(a>=0){var d=b.slice(c.length,b.indexOf(")")).split(",");return parseFloat(d[3])===0}return false};ColorTools.hexadecimalStringToInteger=function(a){if(a.indexOf("#")===0&&(a.length===7||a.length===9)){a=a.slice(1);return(parseInt(a.slice(0,2),16)<<16)+(parseInt(a.slice(2,4),16)<<8)+parseInt(a.slice(4,6),16)}return -1};ColorTools.toRGBAStyle=function(a,b){var d=ColorTools.hexadecimalStringToInteger(a);return"rgba("+((d&16711680)>>16)+","+((d&65280)>>8)+","+(d&255)+","+b+")"};var ImageTools={};ImageTools.isImageWithAlpha=function(c){var a=document.createElement("canvas");var b=a.getContext("2d");a.width=c.width;a.height=c.height;b.drawImage(c,0,0,c.width,c.height);return ImageTools.isCanvasWithAlpha(a,b)};ImageTools.isCanvasWithAlpha=function(a,c){c=c?c:a.getContext("2d");var d=c.getImageData(0,0,a.width,a.height).data;var e=false;for(var b=3,f=d.length;b<f;b+=4){if(d[b]<255){e=true;break}}return e};ImageTools.resize=function(h,f,b,a,g){var d=document.createElement("canvas");d.width=f;d.height=b;var c=d.getContext("2d");c.drawImage(h,0,0,f,b);var e=new Image();e.addEventListener("load",function(){a(e)});e.src=d.toDataURL(g?g:"image/png")};function ModelLoader(a){this.modelExtension=a;this.parserBusy=false;this.waitingParsedEntries=[]}ModelLoader.READING_MODEL=Node3D.READING_MODEL;ModelLoader.PARSING_MODEL=Node3D.PARSING_MODEL;ModelLoader.BUILDING_MODEL=Node3D.BUILDING_MODEL;ModelLoader.BINDING_MODEL=Node3D.BINDING_MODEL;ModelLoader.prototype.load=function(e,c,d){if(d===undefined){d=c;c=false}var g=null;if(e.indexOf("jar:")===0){var f=e.indexOf("!/");g=e.substring(f+2);e=e.substring(4,f)}d.progression(ModelLoader.READING_MODEL,e,0);var b=this;var a={zipReady:function(l){try{if(g===null){var h=l.file(/.*/);for(var k=0;k<h.length;k++){if(h[k].name.toLowerCase().match(new RegExp("."+b.modelExtension.toLowerCase()+"$"))){b.parseModelEntry(h[k],l,e,c,d);return}}if(h.length>0){g=h[0].name}else{if(d.modelError!==undefined){d.modelError("Empty file")}return}}b.parseModelEntry(l.file(decodeURIComponent(g)),l,e,c,d)}catch(j){a.zipError(j)}},zipError:function(h){if(d.modelError!==undefined){d.modelError(h)}},progression:function(j,k,h){if(d.progression!==undefined){d.progression(ModelLoader.READING_MODEL,k,h)}}};ZIPTools.getZIP(e,c,a)};ModelLoader.prototype.clear=function(){this.waitingParsedEntries=[]};ModelLoader.prototype.parseModelEntry=function(g,d,f,a,b){if(a){var c=this.getModelContent(g);b.progression(ModelLoader.READING_MODEL,g.name,1);var j={};this.parseDependencies(c,g.name,d,j);var h=this.parseEntryScene(c,g.name,d,j,null,b.progression);this.loadTextureImages(h,{},d,f,true);b.modelLoaded(h)}else{var e={modelEntry:g,zip:d,zipUrl:f,loadingModelObserver:b};this.waitingParsedEntries.push(e);this.parseNextWaitingEntry()}};ModelLoader.prototype.parseNextWaitingEntry=function(){if(!this.parserBusy){for(var e in this.waitingParsedEntries){if(this.waitingParsedEntries.hasOwnProperty(e)){var c=this.waitingParsedEntries[e];var f=c.modelEntry.name;var d=this.getModelContent(c.modelEntry);c.loadingModelObserver.progression(ModelLoader.READING_MODEL,f,1);var b={};this.parseDependencies(d,f,c.zip,b);var a=this;setTimeout(function(){a.parseEntryScene(d,f,c.zip,b,function(g){a.loadTextureImages(g,{},c.zip,c.zipUrl,true);c.loadingModelObserver.modelLoaded(g);a.parserBusy=false;a.parseNextWaitingEntry()},c.loadingModelObserver.progression)},0);this.parserBusy=true;delete this.waitingParsedEntries[e];break}}}};ModelLoader.prototype.loadTextureImages=function(d,j,b,c,a){if(d instanceof Group3D){for(var g=0;g<d.children.length;g++){this.loadTextureImages(d.children[g],j,b,c,a)}}else{if(d instanceof Link3D){this.loadTextureImages(d.getSharedGroup(),j,b,c,a)}else{if(d instanceof Shape3D){var h=d.getAppearance();if(h){var f=h.imageEntryName;if(f!==undefined){delete h[f];if(f in j){h.setTextureImage(j[f])}else{var e=new Image();e.crossOrigin="anonymous";h.setTextureImage(e);e.url="jar:"+c+"!/"+f;j[f]=e;var k=function(){var l=b.file(decodeURIComponent(f));if(l!==null){var p=l.asBinary();var m=btoa(p);var o=f.substring(f.lastIndexOf(".")+1).toLowerCase();var n=ZIPTools.isJPEGImage(p)?"image/jpeg":(ZIPTools.isPNGImage(p)?"image/png":("image/"+o));e.transparent=ZIPTools.isTransparentImage(p);e.src="data:"+n+";base64,"+m}else{h.setTextureImage(null)}};if(a){k()}else{setTimeout(k,0)}}}}}}}};ModelLoader.prototype.getModelContent=function(a){return a.asBinary()};ModelLoader.prototype.parseDependencies=function(b,d,c,a){};ModelLoader.prototype.parseEntryScene=function(b,f,d,a,e,c){};function OBJLoader(){ModelLoader.call(this,"obj");if(OBJLoader.defaultAppearances===null){OBJLoader.defaultAppearances={};OBJLoader.parseMaterial("newmtl amber\nKa 0.0531 0.0531 0.0531\nKd 0.5755 0.2678 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl amber_trans\nKa 0.0531 0.0531 0.0531\nKd 0.5755 0.2678 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nd 0.1600\nNs 60.0000\n\nnewmtl charcoal\nKa 0.0082 0.0082 0.0082\nKd 0.0041 0.0041 0.0041\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl lavendar\nKa 0.1281 0.0857 0.2122\nKd 0.2187 0.0906 0.3469\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl navy_blue\nKa 0.0000 0.0000 0.0490\nKd 0.0000 0.0000 0.0531\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_green\nKa 0.0444 0.0898 0.0447\nKd 0.0712 0.3796 0.0490\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_pink\nKa 0.0898 0.0444 0.0444\nKd 0.6531 0.2053 0.4160\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl pale_yellow\nKa 0.3606 0.3755 0.0935\nKd 0.6898 0.6211 0.1999\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl peach\nKa 0.3143 0.1187 0.0167\nKd 0.6367 0.1829 0.0156\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl periwinkle\nKa 0.0000 0.0000 0.1184\nKd 0.0000 0.0396 0.8286\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl redwood\nKa 0.0204 0.0027 0.0000\nKd 0.2571 0.0330 0.0000\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl smoked_glass\nKa 0.0000 0.0000 0.0000\nKd 0.0041 0.0041 0.0041\nKs 0.1878 0.1878 0.1878\nillum 2\nd 0.0200\nNs 91.4700\n\nnewmtl aqua_filter\nKa 0.0000 0.0000 0.0000\nKd 0.3743 0.6694 0.5791\nKs 0.1878 0.1878 0.1878\nillum 2\nd 0.0200\nNs 91.4700\n\nnewmtl yellow_green\nKa 0.0000 0.0000 0.0000\nKd 0.1875 0.4082 0.0017\nKs 0.1878 0.1878 0.1878\nillum 2\nNs 91.4700\n\nnewmtl bluetint\nKa 0.1100 0.4238 0.5388\nKd 0.0468 0.7115 0.9551\nKs 0.3184 0.3184 0.3184\nillum 9\nd 0.4300\nNs 60.0000\nsharpness 60.0000\n\nnewmtl plasma\nKa 0.4082 0.0816 0.2129\nKd 1.0000 0.0776 0.4478\nKs 0.3000 0.3000 0.3000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl emerald\nKa 0.0470 1.0000 0.0000\nKd 0.0470 1.0000 0.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl ruby\nKa 1.0000 0.0000 0.0000\nKd 1.0000 0.0000 0.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl sapphire\nKa 0.0235 0.0000 1.0000\nKd 0.0235 0.0000 1.0000\nKs 0.2000 0.2000 0.2000\nillum 9\nd 0.2500\nNs 60.0000\nsharpness 60.0000\n\nnewmtl white\nKa 0.4000 0.4000 0.4000\nKd 1.0000 1.0000 1.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl red\nKa 0.4449 0.0000 0.0000\nKd 0.7714 0.0000 0.0000\nKs 0.8857 0.0000 0.0000\nillum 2\nNs 136.4300\n\nnewmtl blue_pure\nKa 0.0000 0.0000 0.5000\nKd 0.0000 0.0000 1.0000\nKs 0.0000 0.0000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl lime\nKa 0.0000 0.5000 0.0000\nKd 0.0000 1.0000 0.0000\nKs 0.0000 0.5000 0.0000\nillum 2\nNs 65.8900\n\nnewmtl green\nKa 0.0000 0.2500 0.0000\nKd 0.0000 0.2500 0.0000\nKs 0.0000 0.2500 0.0000\nillum 2\nNs 65.8900\n\nnewmtl yellow\nKa 1.0000 0.6667 0.0000\nKd 1.0000 0.6667 0.0000\nKs 1.0000 0.6667 0.0000\nillum 2\nNs 65.8900\n\nnewmtl purple\nKa 0.5000 0.0000 1.0000\nKd 0.5000 0.0000 1.0000\nKs 0.5000 0.0000 1.0000\nillum 2\nNs 65.8900\n\nnewmtl orange\nKa 1.0000 0.1667 0.0000\nKd 1.0000 0.1667 0.0000\nKs 1.0000 0.1667 0.0000\nillum 2\nNs 65.8900\n\nnewmtl grey\nKa 0.5000 0.5000 0.5000\nKd 0.1837 0.1837 0.1837\nKs 0.5000 0.5000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl rubber\nKa 0.0000 0.0000 0.0000\nKd 0.0100 0.0100 0.0100\nKs 0.1000 0.1000 0.1000\nillum 2\nNs 65.8900\n\nnewmtl flaqua\nKa 0.0000 0.4000 0.4000\nKd 0.0000 0.5000 0.5000\nillum 1\n\nnewmtl flblack\nKa 0.0000 0.0000 0.0000\nKd 0.0041 0.0041 0.0041\nillum 1\n\nnewmtl flblue_pure\nKa 0.0000 0.0000 0.5592\nKd 0.0000 0.0000 0.7102\nillum 1\n\nnewmtl flgrey\nKa 0.2163 0.2163 0.2163\nKd 0.5000 0.5000 0.5000\nillum 1\n\nnewmtl fllime\nKa 0.0000 0.3673 0.0000\nKd 0.0000 1.0000 0.0000\nillum 1\n\nnewmtl florange\nKa 0.6857 0.1143 0.0000\nKd 1.0000 0.1667 0.0000\nillum 1\n\nnewmtl flpurple\nKa 0.2368 0.0000 0.4735\nKd 0.3755 0.0000 0.7510\nillum 1\n\nnewmtl flred\nKa 0.4000 0.0000 0.0000\nKd 1.0000 0.0000 0.0000\nillum 1\n\nnewmtl flyellow\nKa 0.7388 0.4925 0.0000\nKd 1.0000 0.6667 0.0000\nillum 1\n\nnewmtl pink\nKa 0.9469 0.0078 0.2845\nKd 0.9878 0.1695 0.6702\nKs 0.7429 0.2972 0.2972\nillum 2\nNs 106.2000\n\nnewmtl flbrown\nKa 0.0571 0.0066 0.0011\nKd 0.1102 0.0120 0.0013\nillum 1\n\nnewmtl brown\nKa 0.1020 0.0185 0.0013\nKd 0.0857 0.0147 0.0000\nKs 0.1633 0.0240 0.0000\nillum 2\nNs 65.8900\n\nnewmtl glass\nKa 1.0000 1.0000 1.0000\nKd 0.4873 0.4919 0.5306\nKs 0.6406 0.6939 0.9020\nillum 2\nNs 200.0000\n\nnewmtl flesh\nKa 0.4612 0.3638 0.2993\nKd 0.5265 0.4127 0.3374\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl aqua\nKa 0.0000 0.4000 0.4000\nKd 0.0000 0.5000 0.5000\nKs 0.5673 0.5673 0.5673\nillum 2\nNs 60.0000\n\nnewmtl black\nKa 0.0000 0.0000 0.0000\nKd 0.0020 0.0020 0.0020\nKs 0.5184 0.5184 0.5184\nillum 2\nNs 157.3600\n\nnewmtl silver\nKa 0.9551 0.9551 0.9551\nKd 0.6163 0.6163 0.6163\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl dkblue_pure\nKa 0.0000 0.0000 0.0449\nKd 0.0000 0.0000 0.1347\nKs 0.0000 0.0000 0.5673\nillum 2\nNs 65.8900\n\nnewmtl fldkblue_pure\nKa 0.0000 0.0000 0.0449\nKd 0.0000 0.0000 0.1347\nillum 1\n\nnewmtl dkgreen\nKa 0.0000 0.0122 0.0000\nKd 0.0058 0.0245 0.0000\nKs 0.0000 0.0490 0.0000\nillum 2\nNs 60.0000\n\nnewmtl dkgrey\nKa 0.0490 0.0490 0.0490\nKd 0.0490 0.0490 0.0490\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl ltbrown\nKa 0.1306 0.0538 0.0250\nKd 0.2776 0.1143 0.0531\nKs 0.3000 0.1235 0.0574\nillum 2\nNs 60.0000\n\nnewmtl fldkgreen\nKa 0.0000 0.0122 0.0000\nKd 0.0058 0.0245 0.0000\nillum 1\n\nnewmtl flltbrown\nKa 0.1306 0.0538 0.0250\nKd 0.2776 0.1143 0.0531\nillum 1\n\nnewmtl tan\nKa 0.4000 0.3121 0.1202\nKd 0.6612 0.5221 0.2186\nKs 0.5020 0.4118 0.2152\nillum 2\nNs 60.0000\n\nnewmtl fltan\nKa 0.4000 0.3121 0.1202\nKd 0.6612 0.4567 0.1295\nillum 1\n\nnewmtl brzskin\nKa 0.4408 0.2694 0.1592\nKd 0.3796 0.2898 0.2122\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl lips\nKa 0.4408 0.2694 0.1592\nKd 0.9265 0.2612 0.2898\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl redorange\nKa 0.3918 0.0576 0.0000\nKd 0.7551 0.0185 0.0000\nKs 0.4694 0.3224 0.1667\nillum 2\nNs 132.5600\n\nnewmtl blutan\nKa 0.4408 0.2694 0.1592\nKd 0.0776 0.2571 0.2041\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl bluteal\nKa 0.0041 0.1123 0.1224\nKd 0.0776 0.2571 0.2041\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl pinktan\nKa 0.4408 0.2694 0.1592\nKd 0.6857 0.2571 0.2163\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl brnhair\nKa 0.0612 0.0174 0.0066\nKd 0.0898 0.0302 0.0110\nKs 0.1306 0.0819 0.0352\nillum 2\nNs 60.4700\n\nnewmtl blondhair\nKa 0.4449 0.2632 0.0509\nKd 0.5714 0.3283 0.0443\nKs 0.7755 0.4602 0.0918\nillum 2\nNs 4.6500\n\nnewmtl flblonde\nKa 0.4449 0.2632 0.0509\nKd 0.5714 0.3283 0.0443\nillum 1\n\nnewmtl yelloworng\nKa 0.5837 0.1715 0.0000\nKd 0.8857 0.2490 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl bone\nKa 0.3061 0.1654 0.0650\nKd 0.9000 0.7626 0.4261\nKs 0.8939 0.7609 0.5509\nillum 2\nNs 200.0000\n\nnewmtl teeth\nKa 0.6408 0.5554 0.3845\nKd 0.9837 0.7959 0.4694\nillum 1\n\nnewmtl brass\nKa 0.2490 0.1102 0.0000\nKd 0.4776 0.1959 0.0000\nKs 0.5796 0.5796 0.5796\nillum 2\nNs 134.8800\n\nnewmtl dkred\nKa 0.0939 0.0000 0.0000\nKd 0.2286 0.0000 0.0000\nKs 0.2490 0.0000 0.0000\nillum 2\nNs 60.0000\n\nnewmtl taupe\nKa 0.1061 0.0709 0.0637\nKd 0.2041 0.1227 0.1058\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 84.5000\n\nnewmtl dkteal\nKa 0.0000 0.0245 0.0163\nKd 0.0000 0.0653 0.0449\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 55.0400\n\nnewmtl dkdkgrey\nKa 0.0000 0.0000 0.0000\nKd 0.0122 0.0122 0.0122\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl dkblue\nKa 0.0000 0.0029 0.0408\nKd 0.0000 0.0041 0.0571\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl gold\nKa 0.7224 0.1416 0.0000\nKd 1.0000 0.4898 0.0000\nKs 0.7184 0.3695 0.3695\nillum 2\nNs 123.2600\n\nnewmtl redbrick\nKa 0.1102 0.0067 0.0067\nKd 0.3306 0.0398 0.0081\nillum 1\n\nnewmtl flmustard\nKa 0.4245 0.2508 0.0000\nKd 0.8898 0.3531 0.0073\nillum 1\n\nnewmtl flpinegreen\nKa 0.0367 0.0612 0.0204\nKd 0.1061 0.2163 0.0857\nillum 1\n\nnewmtl fldkred\nKa 0.0939 0.0000 0.0000\nKd 0.2286 0.0082 0.0082\nillum 1\n\nnewmtl fldkgreen2\nKa 0.0025 0.0122 0.0014\nKd 0.0245 0.0694 0.0041\nillum 1\n\nnewmtl flmintgreen\nKa 0.0408 0.1429 0.0571\nKd 0.1306 0.2898 0.1673\nillum 1\n\nnewmtl olivegreen\nKa 0.0167 0.0245 0.0000\nKd 0.0250 0.0367 0.0000\nKs 0.2257 0.2776 0.1167\nillum 2\nNs 97.6700\n\nnewmtl skin\nKa 0.2286 0.0187 0.0187\nKd 0.1102 0.0328 0.0139\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 17.8300\n\nnewmtl redbrown\nKa 0.1469 0.0031 0.0000\nKd 0.2816 0.0060 0.0000\nKs 0.3714 0.3714 0.3714\nillum 2\nNs 141.0900\n\nnewmtl deepgreen\nKa 0.0000 0.0050 0.0000\nKd 0.0000 0.0204 0.0050\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 113.1800\n\nnewmtl flltolivegreen\nKa 0.0167 0.0245 0.0000\nKd 0.0393 0.0531 0.0100\nillum 1\n\nnewmtl jetflame\nKa 0.7714 0.0000 0.0000\nKd 0.9510 0.4939 0.0980\nKs 0.8531 0.5222 0.0000\nillum 2\nNs 132.5600\n\nnewmtl brownskn\nKa 0.0122 0.0041 0.0000\nKd 0.0204 0.0082 0.0000\nKs 0.0735 0.0508 0.0321\nillum 2\nNs 20.1600\n\nnewmtl greenskn\nKa 0.0816 0.0449 0.0000\nKd 0.0000 0.0735 0.0000\nKs 0.0490 0.1224 0.0898\nillum 3\nNs 46.5100\nsharpness 146.5100\n\nnewmtl ltgrey\nKa 0.5000 0.5000 0.5000\nKd 0.3837 0.3837 0.3837\nKs 0.5000 0.5000 0.5000\nillum 2\nNs 65.8900\n\nnewmtl bronze\nKa 0.0449 0.0204 0.0000\nKd 0.0653 0.0367 0.0122\nKs 0.0776 0.0408 0.0000\nillum 3\nNs 137.2100\nsharpness 125.5800\n\nnewmtl bone1\nKa 0.6408 0.5554 0.3845\nKd 0.9837 0.7959 0.4694\nillum 1\n\nnewmtl flwhite1\nKa 0.9306 0.9306 0.9306\nKd 1.0000 1.0000 1.0000\nillum 1\n\nnewmtl flwhite\nKa 0.6449 0.6116 0.5447\nKd 0.9837 0.9309 0.8392\nKs 0.8082 0.7290 0.5708\nillum 2\nNs 200.0000\n\nnewmtl shadow\nKd 0.0350 0.0248 0.0194\nillum 0\nd 0.2500\n\nnewmtl fldkolivegreen\nKa 0.0056 0.0082 0.0000\nKd 0.0151 0.0204 0.0038\nillum 1\n\nnewmtl fldkdkgrey\nKa 0.0000 0.0000 0.0000\nKd 0.0122 0.0122 0.0122\nillum 1\n\nnewmtl lcdgreen\nKa 0.4000 0.4000 0.4000\nKd 0.5878 1.0000 0.5061\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl brownlips\nKa 0.1143 0.0694 0.0245\nKd 0.1429 0.0653 0.0408\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 25.0000\n\nnewmtl muscle\nKa 0.2122 0.0077 0.0154\nKd 0.4204 0.0721 0.0856\nKs 0.1184 0.1184 0.1184\nillum 2\nNs 25.5800\n\nnewmtl flltgrey\nKa 0.5224 0.5224 0.5224\nKd 0.8245 0.8245 0.8245\nillum 1\n\nnewmtl offwhite.warm\nKa 0.5184 0.4501 0.3703\nKd 0.8367 0.6898 0.4490\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl offwhite.cool\nKa 0.5184 0.4501 0.3703\nKd 0.8367 0.6812 0.5703\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl yellowbrt\nKa 0.4000 0.4000 0.4000\nKd 1.0000 0.7837 0.0000\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl chappie\nKa 0.4000 0.4000 0.4000\nKd 0.5837 0.1796 0.0367\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 60.0000\n\nnewmtl archwhite\nKa 0.2816 0.2816 0.2816\nKd 0.9959 0.9959 0.9959\nillum 1\n\nnewmtl archwhite2\nKa 0.2816 0.2816 0.2816\nKd 0.8408 0.8408 0.8408\nillum 1\n\nnewmtl lighttan\nKa 0.0980 0.0536 0.0220\nKd 0.7020 0.4210 0.2206\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lighttan2\nKa 0.0980 0.0492 0.0144\nKd 0.3143 0.1870 0.0962\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lighttan3\nKa 0.0980 0.0492 0.0144\nKd 0.1796 0.0829 0.0139\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl lightyellow\nKa 0.5061 0.1983 0.0000\nKd 1.0000 0.9542 0.3388\nKs 1.0000 0.9060 0.0000\nillum 2\nNs 177.5200\n\nnewmtl lighttannew\nKa 0.0980 0.0492 0.0144\nKd 0.7878 0.6070 0.3216\nKs 0.8286 0.8057 0.5851\nillum 2\nNs 177.5200\n\nnewmtl default\nKa 0.4000 0.4000 0.4000\nKd 0.7102 0.7020 0.6531\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 128.0000\n\nnewmtl ship2\nKa 0.0000 0.0000 0.0000\nKd 1.0000 1.0000 1.0000\nKs 0.1143 0.1143 0.1143\nillum 2\nNs 60.0000\n\nnewmtl dkpurple\nKa 0.0082 0.0000 0.0163\nKd 0.0245 0.0000 0.0490\nKs 0.1266 0.0000 0.2531\nillum 2\nNs 65.8900\n\nnewmtl dkorange\nKa 0.4041 0.0123 0.0000\nKd 0.7143 0.0350 0.0000\nKs 0.7102 0.0870 0.0000\nillum 2\nNs 65.8900\n\nnewmtl mintgrn\nKa 0.0101 0.1959 0.0335\nKd 0.0245 0.4776 0.0816\nKs 0.0245 0.4776 0.0816\nillum 2\nNs 65.8900\n\nnewmtl fgreen\nKa 0.0000 0.0449 0.0000\nKd 0.0000 0.0449 0.0004\nKs 0.0062 0.0694 0.0000\nillum 2\nNs 106.2000\n\nnewmtl glassblutint\nKa 0.4000 0.4000 0.4000\nKd 0.5551 0.8000 0.7730\nKs 0.7969 0.9714 0.9223\nillum 4\nd 0.6700\nNs 60.0000\nsharpness 60.0000\n\nnewmtl bflesh\nKa 0.0122 0.0122 0.0122\nKd 0.0245 0.0081 0.0021\nKs 0.0531 0.0460 0.0153\nillum 2\nNs 20.1600\n\nnewmtl meh\nKa 0.4000 0.4000 0.4000\nKd 0.5551 0.8000 0.7730\nKs 0.7969 0.9714 0.9223\nillum 4\nd 0.2500\nNs 183.7200\nsharpness 60.0000\n\nnewmtl violet\nKa 0.0083 0.0000 0.1265\nKd 0.0287 0.0269 0.1347\nKs 0.2267 0.4537 0.6612\nillum 2\nNs 96.9000\n\nnewmtl iris\nKa 0.3061 0.0556 0.0037\nKd 0.0000 0.0572 0.3184\nKs 0.8041 0.6782 0.1477\nillum 2\nNs 188.3700\n\nnewmtl blugrn\nKa 0.4408 0.4144 0.1592\nKd 0.0811 0.6408 0.2775\nKs 0.1467 0.1469 0.0965\nillum 2\nNs 25.0000\n\nnewmtl glasstransparent\nKa 0.2163 0.2163 0.2163\nKd 0.4694 0.4694 0.4694\nKs 0.6082 0.6082 0.6082\nillum 4\nd 0.2500\nNs 200.0000\nsharpness 60.0000\n\nnewmtl fleshtransparent\nKa 0.4000 0.2253 0.2253\nKd 0.6898 0.2942 0.1295\nKs 0.7388 0.4614 0.4614\nillum 4\nd 0.2500\nNs 6.2000\nsharpness 60.0000\n\nnewmtl fldkgrey\nKa 0.0449 0.0449 0.0449\nKd 0.0939 0.0939 0.0939\nillum 1\n\nnewmtl sky_blue\nKa 0.1363 0.2264 0.4122\nKd 0.1241 0.5931 0.8000\nKs 0.0490 0.0490 0.0490\nillum 2\nNs 13.9500\n\nnewmtl fldkpurple\nKa 0.0443 0.0257 0.0776\nKd 0.1612 0.0000 0.3347\nKs 0.0000 0.0000 0.0000\nillum 2\nNs 13.9500\n\nnewmtl dkbrown\nKa 0.0143 0.0062 0.0027\nKd 0.0087 0.0038 0.0016\nKs 0.2370 0.2147 0.1821\nillum 3\nNs 60.0000\nsharpness 60.0000\n\nnewmtl bone2\nKa 0.6408 0.5388 0.3348\nKd 0.9837 0.8620 0.6504\nillum 1\n\nnewmtl bluegrey\nKa 0.4000 0.4000 0.4000\nKd 0.1881 0.2786 0.2898\nKs 0.3000 0.3000 0.3000\nillum 2\nNs 14.7300\n\nnewmtl metal\nKa 0.9102 0.8956 0.1932\nKd 0.9000 0.7626 0.4261\nKs 0.8939 0.8840 0.8683\nillum 2\nNs 200.0000\n\nnewmtl sand_stone\nKa 0.1299 0.1177 0.0998\nKd 0.1256 0.1138 0.0965\nKs 0.2370 0.2147 0.1821\nillum 3\nNs 60.0000\nsharpness 60.0000\n\nnewmtl hair\nKa 0.0013 0.0012 0.0010\nKd 0.0008 0.0007 0.0006\nKs 0.0000 0.0000 0.0000\nillum 3\nNs 60.0000\nsharpness 60.0000\n",OBJLoader.defaultAppearances,null,null)}}OBJLoader.prototype=Object.create(ModelLoader.prototype);OBJLoader.prototype.constructor=OBJLoader;OBJLoader.defaultAppearances=null;OBJLoader.prototype.createScene=function(d,c,j,b,e,m,f){var h=new Group3D();if(m===null){f(ModelLoader.BUILDING_MODEL,"",0);for(var l in b){this.createGroupShapes(d,c,j,b[l],e,h)}f(ModelLoader.BUILDING_MODEL,"",1);return h}else{var a=0;for(var l in b){a+=b[l].geometries.length}var g=0;var k=this;var n=function(){f(ModelLoader.BUILDING_MODEL,"",a!==0?g/a:0);var p=Date.now();for(var o in b){k.createGroupShapes(d,c,j,b[o],e,h);g+=b[o].geometries.length;delete b[o];if(g<a&&Date.now()-p>10){setTimeout(n,0);return}}setTimeout(function(){f(ModelLoader.BUILDING_MODEL,"",1);m(h)},0)};n()}};OBJLoader.prototype.createGroupShapes=function(o,g,y,r,x,t){var w=r.geometries;if(w.length>0){var F=0;while(F<w.length){var d=w[F];var G=d.textureCoordinateIndices.length>0;var H=(d instanceof OBJLoader.OBJFace)&&d.normalIndices.length>0;var I=(d instanceof OBJLoader.OBJFace)&&d.smooth;var f=d.material;var v=OBJLoader.getAppearance(x,f);var E=F;while(++E<w.length){var m=w[E];var u=m.material;if((m.constructor!==d.constructor)||u===null&&f!==null||u!==null&&OBJLoader.getAppearance(x,u)!==v||(I^((m instanceof OBJLoader.OBJFace)&&m.smooth))||(G^m.textureCoordinateIndices.length>0)||(H^((m instanceof OBJLoader.OBJFace)&&m.normalIndices.length>0))){break}}if(v!==null){v=v.clone()}var z=E-F;var h=[];var q=[];var e=true;for(var D=0;D<z;D++){var b=w[F+D].vertexIndices;h.push.apply(h,b);q.push(b.length);if(e&&b.length!==3){e=false}}var l=[];if(G){for(var D=0;D<z;D++){l.push.apply(l,w[F+D].textureCoordinateIndices)}}var A;if(d instanceof OBJLoader.OBJFace){var s=[];if(H){for(var D=0;D<z;D++){s.push.apply(s,w[F+D].normalIndices)}}var B=new GeometryInfo3D(e?GeometryInfo3D.TRIANGLE_ARRAY:GeometryInfo3D.POLYGON_ARRAY);B.setCoordinates(o);B.setCoordinateIndices(h);B.setNormals(y);B.setNormalIndices(s);B.setTextureCoordinates(g);B.setTextureCoordinateIndices(l);B.setStripCounts(q);if(!H){B.setCreaseAngle(I?Math.PI/2:0);B.setGeneratedNormals(true)}A=B.getIndexedGeometryArray()}else{var n=[];var a=[];for(var D=0,p=0;D<z;p+=q[D],D++){for(var C=0;C<q[D]-1;C++){n.push(h[p+C]);n.push(h[p+C+1]);if(l.length>0){a.push(l[p+C]);a.push(l[p+C+1])}}}A=new IndexedLineArray3D(o,n,g,a)}var c=new Shape3D(A,v);t.addChild(c);c.setName(r.name+(F===0?"":"_"+F));F=E}}};OBJLoader.getAppearance=function(c,b){var a=undefined;if(b!==null){a=c[b]}if(a===undefined){a=OBJLoader.defaultAppearances["default"]}return a};OBJLoader.prototype.parseDependencies=function(c,a,b,f){f.appearances={};for(var d in OBJLoader.defaultAppearances){var e=OBJLoader.defaultAppearances[d];f.appearances[e.getName()]=e}try{var h=c.indexOf("mtllib");while(h!==-1){var j=h+6;while(j<c.length&&c.charAt(j)!="\n"&&c.charAt(j)!="\r"){j++}var m=c.substring(h,j).trim();var l=m.substring(7,m.length).trim();this.parseMaterialEntry(l,f.appearances,a,b);h=c.indexOf("mtllib",j)}}catch(g){f.appearances={}}};OBJLoader.prototype.parseEntryScene=function(f,c,e,k,r,m){var j=[];var h=[];var p=[];var n=new OBJLoader.OBJGroup("default");var g={"default":n};var b={};var a={group:n,material:"default",smooth:false};if(r===null){try{m(ModelLoader.PARSING_MODEL,c,0);for(var o=0;o<=f.length;){o=this.parseObjectLine(f,o,j,h,p,g,b,a)}m(ModelLoader.PARSING_MODEL,c,1);return this.createScene(j,h,p,g,k.appearances,null,m)}catch(l){m(ModelLoader.PARSING_MODEL,c,1);return this.createScene([],[],[],{},k.appearances,null,m)}}else{var o=0;var q=this;var d=function(){try{m(ModelLoader.PARSING_MODEL,c,o/f.length);var t=o+200000;var u=Date.now();while(o<=f.length){o=q.parseObjectLine(f,o,j,h,p,g,b,a);if(o<=f.length&&o>t&&Date.now()-u>10){setTimeout(d,0);return}}setTimeout(function(){m(ModelLoader.PARSING_MODEL,c,1);q.createScene(j,h,p,g,k.appearances,function(v){r(v)},m)},0)}catch(s){m(ModelLoader.PARSING_MODEL,c,1);q.createScene([],[],[],{},k.appearances,r,m)}};d()}};OBJLoader.prototype.parseObjectLine=function(f,m,k,h,n,g,b,a){var o=m+1;while(o<f.length&&f.charAt(o)!="\n"&&f.charAt(o)!="\r"){o++}var q=f.substring(m,o);if(q.indexOf("v")===0||q.indexOf("f ")===0||q.indexOf("l ")===0){while(q.charAt(q.length-1)==="\\"){q=q.substring(0,q.length-1)+" ";m=o+1;if(m<f.length&&f.charAt(o)=="\r"&&f.charAt(m)=="\n"){m++}o=m+1;while(o<f.length&&f.charAt(o)!="\n"&&f.charAt(o)!="\r"){o++}q+=f.substring(m,o)}}q=q.trim();var p=q.split(/\s+/);var d=p[0];if(d==="v"){k.push(OBJLoader.parseVector3f(p))}else{if(d==="vt"){h.push(OBJLoader.parseVector2f(p))}else{if(d==="vn"){try{n.push(OBJLoader.parseVector3f(p))}catch(j){console.log(f+" "+q)}}else{if(d==="l"){var q=this.parseLine(p,a.material);if(q.vertexIndices.length>1){a.group.addGeometry(q)}}else{if(d==="f"){var l=this.parseFace(p,a.smooth,a.material);if(l.vertexIndices.length>2){if(l.normalIndices.length===0||a.group.name.indexOf("sweethome3d_")===0){a.group.addGeometry(l)}else{if(!(l.material in b)){b[l.material]=a.group}b[l.material].addGeometry(l)}}}else{if(d==="g"||d==="o"){if(p.length>1){var c=p[1];a.group=g[c];if(a.group===undefined){a.group=new OBJLoader.OBJGroup(c);g[c]=a.group}}else{a.group=g["default"]}}else{if(d==="s"){a.smooth=p[1]!="off"}else{if(d==="usemtl"){a.material=q.substring(7,q.length).trim()}}}}}}}}m=o+1;if(m<f.length&&f.charAt(o)=="\r"&&f.charAt(m)=="\n"){m++}return m};OBJLoader.prototype.parseLine=function(a,e){var d=[];var g=[];for(var c=0;c<a.length;c++){var f=a[c];if(c>0&&f.length>0){var b=f.indexOf("/");if(b===-1){d.push(OBJLoader.parseInteger(f)-1)}else{d.push(OBJLoader.parseInteger(f.substring(0,b))-1);g.push(OBJLoader.parseInteger(f.substring(b+1))-1)}}}if(d.length!==g.length){g=[]}return new OBJLoader.OBJLine(d,g,e)};OBJLoader.prototype.parseFace=function(h,a,g){var e=[];var c=[];var k=[];for(var f=0;f<h.length;f++){var j=h[f];if(f>0&&j.length>0){var b=j.indexOf("/");if(b===-1){e.push(OBJLoader.parseInteger(j)-1)}else{e.push(OBJLoader.parseInteger(j.substring(0,b))-1);var d=j.lastIndexOf("/");if(b===d){c.push(OBJLoader.parseInteger(j.substring(b+1))-1)}else{if(b+1!==d){c.push(OBJLoader.parseInteger(j.substring(b+1,d))-1)}k.push(OBJLoader.parseInteger(j.substring(d+1))-1)}}}}if(e.length!==c.length){c=[]}if(e.length!==k.length){k=[]}return new OBJLoader.OBJFace(e,c,k,a,g)};OBJLoader.prototype.parseMaterialEntry=function(d,f,e,c){var a=e.lastIndexOf("/");if(a>=0){d=e.substring(0,a+1)+d}var b=c.file(d);if(b!==null){OBJLoader.parseMaterial(b.asBinary(),f,e,c)}};OBJLoader.parseVector3f=function(a){return vec3.fromValues(OBJLoader.parseNumber(a[1]),OBJLoader.parseNumber(a[2]),OBJLoader.parseNumber(a[3]))};OBJLoader.parseVector2f=function(a){return vec2.fromValues(OBJLoader.parseNumber(a[1]),OBJLoader.parseNumber(a[2]))};OBJLoader.parseInteger=function(a){var b=parseInt(a);if(isNaN(b)){throw new IncorrectFormat3DException("Incorrect integer "+a)}return b};OBJLoader.parseNumber=function(b){var a=parseFloat(b);if(isNaN(a)){if(b=="NaN"){return NaN}throw new IncorrectFormat3DException("Incorrect number "+b)}return a};OBJLoader.parseMaterial=function(l,j,a,c){var d=null;var m=l.match(/^.*$/mg);for(var h=0;h<m.length;h++){var n=m[h].trim();var k=n.split(/\s+/);var b=k[0];if(b=="newmtl"){d=new Appearance3D(n.substring(7,n.length).trim());j[d.getName()]=d}else{if(d!==null){if(b=="Ka"){d.setAmbientColor(OBJLoader.parseVector3f(k))}else{if(b=="Kd"){d.setDiffuseColor(OBJLoader.parseVector3f(k))}else{if(b=="Ks"){d.setSpecularColor(OBJLoader.parseVector3f(k))}else{if(b=="Ns"){d.setShininess(Math.max(1,Math.min(OBJLoader.parseNumber(k[1]),128)))}else{if(b=="d"){d.setTransparency(1-Math.max(0,OBJLoader.parseNumber(k[1]=="-halo"?k[2]:k[1])))}else{if(b=="illum"){d.setIllumination(OBJLoader.parseInteger(k[1]))}else{if(b=="map_Kd"){var e=k[k.length-1];var f=a.lastIndexOf("/");if(f>=0){e=a.substring(0,f+1)+e}var g=c.file(e);if(g===null&&k.length>2){e=n.substring(7,n.length).trim();if(f>=0){e=a.substring(0,f+1)+e}g=c.file(e)}if(g!==null){d.imageEntryName=e}}}}}}}}}}}};OBJLoader.OBJGroup=function(a){this.name=a;this.geometries=[]};OBJLoader.OBJGroup.prototype.addGeometry=function(a){this.geometries.push(a)};OBJLoader.OBJLine=function(b,c,a){this.vertexIndices=b;this.textureCoordinateIndices=c;this.material=a};OBJLoader.OBJFace=function(d,e,b,a,c){this.vertexIndices=d;this.textureCoordinateIndices=e;this.normalIndices=b;this.smooth=a;this.material=c};function DAELoader(){ModelLoader.call(this,"dae")}DAELoader.prototype=Object.create(ModelLoader.prototype);DAELoader.prototype.constructor=DAELoader;DAELoader.prototype.parseEntryScene=function(b,c,a,d,j,g){var h=new Group3D();var k=new DAEHandler(h,c);var f=new SAXParser(k,k,k,k,k);g(ModelLoader.PARSING_MODEL,c,0);try{f.parseString(b)}catch(e){h.removeAllChildren()}if(j===null){g(ModelLoader.PARSING_MODEL,c,1);return h}else{setTimeout(function(){g(ModelLoader.PARSING_MODEL,c,1);j(h)},0)}};function DAEHandler(a,b){DefaultHandler.call(this);this.sceneRoot=a;this.daeEntryName=b;this.parentGroups=[];this.parentElements=[];this.buffer="";this.postProcessingBinders=[];this.textures={};this.effectAppearances={};this.materialEffects={};this.materialNames={};this.surface2DIds={};this.sampler2DIds={};this.geometries={};this.sources={};this.positions={};this.normals={};this.textureCoordinates={};this.floatArrays={};this.sourceAccessorStrides=[];this.appearanceGeometries={};this.facesAndLinesPrimitives=[];this.polygonsPrimitives=[];this.polygonsHoles=[];this.nodes={};this.controllersSkinMeshes={};this.instantiatedNodes={};this.visualScenes={};this.visualScene=null;this.floats=null;this.geometryVertices=[];this.geometryNormals=[];this.geometryTextureCoordinates=[];this.vcount=[];this.transparentColor=[];this.transparency=null;this.inRootAsset=false;this.reverseTransparency=false;this.imageId=null;this.materialId=null;this.effectId=null;this.newParamSid=null;this.inSurface2D=false;this.inPhongBlinnOrLambert=false;this.techniqueProfile=null;this.inConstant=false;this.geometryId=null;this.meshSourceId=null;this.verticesId=null;this.floatArrayId=null;this.controllerId=null;this.geometryAppearance=null;this.geometryVertexOffset=0;this.geometryNormalOffset=0;this.geometryTextureCoordinatesOffset=0;this.axis=null;this.meterScale=1;this.floatValue=0;this.opaque=null;this.inputCount=0}DAEHandler.prototype=Object.create(DefaultHandler.prototype);DAEHandler.prototype.constructor=DAEHandler;DAEHandler.prototype.startElement=function(e,v,j,z){this.buffer="";var f=this.parentElements.length===0?null:this.parentElements[this.parentElements.length-1];if(f===null&&!("COLLADA"==j)){throw new SAXException("Expected COLLADA element")}else{if("COLLADA"==j){var I=z.getValue("version");if(I.indexOf("1.4")!==0){throw new SAXException("Version "+I+" not supported")}}else{if("COLLADA"==f&&"asset"==j){this.inRootAsset=true}else{if("asset"==f&&"unit"==j){var C=z.getValue("meter");if(C!==null){this.meterScale=parseFloat(C)}}else{if("image"==j){this.imageId=z.getValue("id")}else{if("material"==j){this.materialId=z.getValue("id");this.materialNames[this.materialId]=z.getValue("name")}else{if("material"==f&&"instance_effect"==j){var t=z.getValue("url");if(t.indexOf("#")===0){var u=t.substring(1);this.materialEffects[this.materialId]=u}}else{if("effect"==j){this.effectId=z.getValue("id");this.effectAppearances[this.effectId]=new Appearance3D()}else{if(this.effectId!==null){if("profile_COMMON"==f&&"newparam"==j){this.newParamSid=z.getValue("sid")}else{if("newparam"==f&&"surface"==j&&"2D"==z.getValue("type")){this.inSurface2D=true}else{if("extra"==f&&"technique"==j){this.techniqueProfile=z.getValue("profile")}else{if("phong"==j||"blinn"==j){this.inPhongBlinnOrLambert=true}else{if("lambert"==j){this.inPhongBlinnOrLambert=true;this.effectAppearances[this.effectId].setSpecularColor(vec3.fromValues(0,0,0));this.effectAppearances[this.effectId].setShininess(1)}else{if("constant"==j){this.inConstant=true}else{if(this.inConstant||this.inPhongBlinnOrLambert&&("transparent"==j)){this.opaque=z.getValue("opaque");if(this.opaque===null){this.opaque="A_ONE"}}else{if("texture"==j&&"diffuse"==f){var y=this.surface2DIds[this.sampler2DIds[z.getValue("texture")]];var p=this.effectAppearances[this.effectId];var w=this;this.postProcessingBinders.push(function(){p.imageEntryName=w.textures[y]})}}}}}}}}}else{if("geometry"==j){this.geometryId=z.getValue("id");this.geometries[this.geometryId]=[]}else{if(this.geometryId!==null){if("mesh"==f&&"source"==j){this.meshSourceId=z.getValue("id")}else{if("mesh"==f&&"vertices"==j){this.verticesId=z.getValue("id")}else{if(this.meshSourceId!==null){if("float_array"==j){this.floatArrayId=z.getValue("id")}else{if("technique_common"==f&&"accessor"==j){var x=z.getValue("source").substring(1);var s=z.getValue("stride");s=s!==null?parseInt(s):1;this.sourceAccessorStrides.push({floatArray:this.floatArrays[x],stride:s})}}}else{if(this.verticesId!==null&&"input"==j){var J=z.getValue("source").substring(1);var o=this.sources[J];if(o!==undefined){if("POSITION"==z.getValue("semantic")){this.positions[this.verticesId]=new Array(o.length/3);for(var H=0,F=0;F<o.length;H++,F+=3){this.positions[this.verticesId][H]=vec3.fromValues(o[F],o[F+1],o[F+2])}}else{if("NORMAL"==z.getValue("semantic")){this.normals[this.verticesId]=new Array(o.length/3);for(var H=0,F=0;F<o.length;H++,F+=3){this.normals[this.verticesId][H]=vec3.fromValues(o[F],o[F+1],o[F+2])}}else{if("TEXCOORD"==z.getValue("semantic")){this.textureCoordinates[this.verticesId]=new Array(o.length/2);for(var H=0,F=0;F<o.length;H++,F+=2){this.textureCoordinates[this.verticesId][H]=vec2.fromValues(o[F],o[F+1])}}}}}}else{if(this.verticesId===null&&"input"==j){var J=z.getValue("source").substring(1);var A=parseInt(z.getValue("offset"));if(this.inputCount<A+1){this.inputCount=A+1}if("VERTEX"==z.getValue("semantic")){this.geometryVertices=this.positions[J];if(this.geometryVertices===undefined){this.geometryVertices=null}this.geometryVertexOffset=A;if(this.geometryNormals===null){this.geometryNormals=this.normals[J];this.geometryNormalOffset=A}if(this.geometryTextureCoordinates===null){this.geometryTextureCoordinates=this.textureCoordinates[J];this.geometryTextureCoordinatesOffset=A}}else{if("NORMAL"==z.getValue("semantic")){var o=this.sources[J];if(o!==undefined){this.geometryNormals=new Array(o.length/3);for(var H=0,F=0;F<o.length;H++,F+=3){this.geometryNormals[H]=vec3.fromValues(o[F],o[F+1],o[F+2])}this.geometryNormalOffset=A}}else{if("TEXCOORD"==z.getValue("semantic")){var o=this.sources[J];if(o!==undefined){this.geometryTextureCoordinates=new Array(o.length/2);for(var H=0,F=0;F<o.length;H++,F+=2){this.geometryTextureCoordinates[H]=vec2.fromValues(o[F],o[F+1])}this.geometryTextureCoordinatesOffset=A}}}}}else{if("triangles"==j||"trifans"==j||"tristrips"==j||"polylist"==j||"polygons"==j||"lines"==j||"linestrips"==j){this.geometryAppearance=z.getValue("material");this.inputCount=0;this.facesAndLinesPrimitives=[];this.polygonsPrimitives=[];this.polygonsHoles=[];this.vcount=null}}}}}}}else{if("controller"==j){this.controllerId=z.getValue("id")}else{if("skin"==j){var G=z.getValue("source");if(G.indexOf("#")===0){var l=G.substring(1);this.controllersSkinMeshes[this.controllerId]=l}}else{if("visual_scene"==j){var D=new TransformGroup3D();this.parentGroups.push(D);this.visualScenes[z.getValue("id")]=D}else{if("node"==j){var b=new TransformGroup3D();if(this.parentGroups.length>0){this.parentGroups[this.parentGroups.length-1].addChild(b)}this.parentGroups.push(b);this.nodes[z.getValue("id")]=b;var a=z.getValue("name");if(a!==null){b.setName(a)}}else{if("node"==f&&("instance_geometry"==j||"instance_controller"==j)){var M=z.getValue("url");if(M.indexOf("#")===0){var q="instance_controller"==j;var L=M.substring(1);var a=z.getValue("name");var E=new Group3D();this.parentGroups[this.parentGroups.length-1].addChild(E);this.parentGroups.push(E);var w=this;this.postProcessingBinders.push(function(){var P=0;var O=q?w.geometries[w.controllersSkinMeshes[L]]:w.geometries[L];for(var N=0;N<O.length;N++){var k=new Shape3D(O[N]);E.addChild(k);if(a!==null){if(P===0){k.setName(a)}else{k.setName(a+"_"+P)}P++}}})}}else{if("instance_node"==j){var B=z.getValue("url");if(B.indexOf("#")===0){var d=B.substring(1);var K=this.parentGroups[this.parentGroups.length-1];var w=this;this.postProcessingBinders.push(function(){var k=w.instantiatedNodes[d];if(k===undefined){k=new SharedGroup3D();k.addChild(w.nodes[d]);w.instantiatedNodes[d]=k}K.addChild(new Link3D(k))})}}else{if("instance_material"==j&&this.parentGroups.length>0){var g=z.getValue("target");if(g.indexOf("#")==0){var m=g.substring(1);var r=z.getValue("symbol");var n=this.parentGroups[this.parentGroups.length-1];var w=this;this.postProcessingBinders.push(function(){var k=w.effectAppearances[w.materialEffects[m]];var N=function(U,P,Q){if(U instanceof Group3D){var O=false;var S=U.getChildren();for(var R=0;R<S.length;R++){O|=N(S[R],P,Q)}return O}else{if(U instanceof Link3D){return N(U.getSharedGroup(),P,Q)}else{if(U instanceof Shape3D){var T=Q?U.getGeometries():w.appearanceGeometries[r];if(T!==undefined){for(var R=0;R<T.length;R++){if(T[R]===U.getGeometries()[0]){U.setAppearance(P);return true}}}}}}return false};if(!N(n,k,false)){N(n,k,true)}k.setName(w.materialNames[m])})}}else{if("instance_visual_scene"==j){var h=z.getValue("url");if(h.indexOf("#")===0){var c=h.substring(1);var w=this;this.postProcessingBinders.push(function(){w.visualScene=w.visualScenes[c]})}}}}}}}}}}}}}}}}}}}}this.parentElements.push(j)};DAEHandler.prototype.characters=function(a,c,b){this.buffer+=a.substring(c,c+b)};DAEHandler.prototype.endElement=function(c,f,b){this.parentElements.pop();var l=this.parentElements.length===0?null:this.parentElements[this.parentElements.length-1];if("color"==b||"float_array"==b||"matrix"==b||"rotate"==b||"scale"==b||"translate"==b){var g=this.getCharacters().split(/\s/);this.floats=new Array(g.length);var d=0;for(var h=0;h<g.length;h++){if(g[h].length>0){var j=parseFloat(g[h]);if(isNaN(j)){j=0}this.floats[d++]=j}}if(d!==g.length){this.floats.splice(d,this.floats.length-d)}if(this.floatArrayId!==null){this.floatArrays[this.floatArrayId]=this.floats;this.floatArrayId=null}}else{if("float"==b){this.floatValue=parseFloat(this.getCharacters())}}if(this.inRootAsset){this.handleRootAssetElementsEnd(b)}else{if("image"==b){this.imageId=null}else{if(this.imageId!==null){this.handleImageElementsEnd(b)}else{if("material"==b){this.materialId=null}else{if("effect"==b){this.effectId=null}else{if(this.effectId!==null){this.handleEffectElementsEnd(b,l)}else{if("geometry"==b){this.geometryId=null}else{if(this.geometryId!==null){this.handleGeometryElementsEnd(b,l)}else{if("controller"==b){this.controllerId=null}else{if("visual_scene"==b||"node"==b||"node"==l&&"instance_geometry"==b){this.parentGroups.pop()}else{if("matrix"==b){var k=mat4.fromValues(this.floats[0],this.floats[4],this.floats[8],this.floats[12],this.floats[1],this.floats[5],this.floats[9],this.floats[13],this.floats[2],this.floats[6],this.floats[10],this.floats[14],this.floats[3],this.floats[7],this.floats[11],this.floats[15]);this.mulTransformGroup(k)}else{if("node"==l&&"rotate"==b){var m=mat4.create();mat4.fromRotation(m,this.floats[3]*Math.PI/180,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]));this.mulTransformGroup(m)}else{if("scale"==b){var e=mat4.create();mat4.scale(e,e,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]));this.mulTransformGroup(e)}else{if("node"==l&&"translate"==b){var a=mat4.create();mat4.translate(a,a,vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]));this.mulTransformGroup(a)}}}}}}}}}}}}}}};DAEHandler.prototype.getCharacters=function(){return this.buffer.trim()};DAEHandler.prototype.handleRootAssetElementsEnd=function(c){if("asset"==c){this.inRootAsset=false}else{if("up_axis"==c){this.axis=this.getCharacters()}else{if("subject"==c){this.scene.setName(this.getCharacters())}else{if("authoring_tool"==c){var b=this.getCharacters();if(b.indexOf("Google SketchUp")===0){var d=b.substring("Google SketchUp".length).trim();if(d.length>0){var f=d.indexOf(".");var e=f===-1?d:d.substring(0,f);var a=parseInt(e);if(a<7||(a==7&&(f>=d.length-1||d[f+1]<"1"))){this.reverseTransparency=true}}}}}}}};DAEHandler.prototype.handleImageElementsEnd=function(c){if("init_from"==c){var f=this.getCharacters();if(f.indexOf("./")===0){f=f.substring(2)}var a=this.daeEntryName.lastIndexOf("/");if(a>=0){var e=this.daeEntryName.split("/");var b=f.split("/");e.splice(e.length-1,1);while(b[0]==".."||b[0]=="."){if(b[0]==".."){e.splice(e.length-1,1)}b.splice(0,1)}f="";for(var d=0;d<e.length;d++){f+=e[d]+"/"}for(var d=0;d<b.length;d++){f+=b[d]+"/"}f=f.substring(0,f.length-1)}this.textures[this.imageId]=f}else{if("data"==c){throw new SAXException("<data> not supported")}}};DAEHandler.prototype.handleEffectElementsEnd=function(b,c){if("profile_COMMON"==c&&"newparam"==b){this.newParamSid=null}else{if("newparam"==c&&"surface"==b){this.inSurface2D=false}else{if(this.newParamSid!==null){if(this.inSurface2D&&"init_from"==b){this.surface2DIds[this.newParamSid]=this.getCharacters()}else{if("sampler2D"==c&&"source"==b){this.sampler2DIds[this.newParamSid]=this.getCharacters()}}}else{if("extra"==c&&"technique"==b){this.techniqueProfile=null}else{if("phong"==b||"blinn"==b||"lambert"==b||"constant"==b){var e;if(this.transparentColor!==null){if("RGB_ZERO"==this.opaque){e=this.transparentColor[0]*0.212671+this.transparentColor[1]*0.71516+this.transparentColor[2]*0.072169;if(this.transparency!==null){e*=this.transparency}}else{if(this.transparency!==null){e=1-this.transparentColor[3]*this.transparency}else{e=1-this.transparentColor[3]}if(this.reverseTransparency){e=1-e}}}else{e=0}var a=this.effectAppearances[this.effectId];if(e>0){a.setTransparency(e)}var d=this.transparentColor!=null?vec3.fromValues(this.transparentColor[0],this.transparentColor[1],this.transparentColor[2]):vec3.fromValues(0,0,0);if(!a.getAmbientColor()&&!a.getDiffuseColor()&&!a.getSpecularColor()){if(!a.getAmbientColor()){a.setAmbientColor(d)}if(!a.getDiffuseColor()){a.setDiffuseColor(d)}if(!a.getSpecularColor()){a.setSpecularColor(d)}if(!a.getShininess()){a.setShininess(1)}if("constant"==b){this.effectAppearances[this.effectId].setIllumination(0)}}this.transparentColor=null;this.transparency=null;this.inPhongBlinnOrLambert=false;this.inConstant=false}else{if(this.inConstant||this.inPhongBlinnOrLambert){if("color"==b){if("emission"==c){if(this.inPhongBlinnOrLambert){this.effectAppearances[this.effectId].setEmissiveColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{this.effectAppearances[this.effectId].setDiffuseColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]));this.effectAppearances[this.effectId].setIllumination(0)}}else{if("ambient"==c){this.effectAppearances[this.effectId].setAmbientColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{if("diffuse"==c){this.effectAppearances[this.effectId].setDiffuseColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{if("specular"==c){this.effectAppearances[this.effectId].setSpecularColor(vec3.fromValues(this.floats[0],this.floats[1],this.floats[2]))}else{if("transparent"==c){this.transparentColor=this.floats}}}}}}else{if("float"==b){if("shininess"==c){this.effectAppearances[this.effectId].setShininess(this.floatValue)}else{if("transparency"==c){this.transparency=this.floatValue}}}}}else{if("double_sided"==b&&"1"==this.getCharacters()&&("GOOGLEEARTH"==this.techniqueProfile||"MAX3D"==this.techniqueProfile||"MAYA"==this.techniqueProfile)){this.effectAppearances[this.effectId].setCullFace(Appearance3D.CULL_NONE)}}}}}}}};DAEHandler.prototype.handleGeometryElementsEnd=function(a,e){if("mesh"==e&&"source"==a){if(this.floats!==null){this.sources[this.meshSourceId]=this.floats;this.floats=null}this.meshSourceId=null}else{if("mesh"==e&&"vertices"==a){this.verticesId=null}else{if("p"==a||"h"==a||"vcount"==a){var f=this.getCharacters().split(/\s/);var h=new Array(f.length);var d=0;for(var b=0;b<f.length;b++){if(f[b].length>0){h[d++]=parseInt(f[b])}}if(d!==f.length){h.splice(d,h.length-d)}if("ph"!=e&&"p"==a){this.facesAndLinesPrimitives.push(h)}else{if("vcount"==a){this.vcount=h}else{if("ph"==e){if("p"==a){this.polygonsPrimitives.push(h)}else{if("h"==a){if(this.polygonsPrimitives.length>this.polygonsHoles.length){this.polygonsHoles.push([])}this.polygonsHoles[this.polygonsPrimitives.length-1].push(h)}}}}}}else{if(("triangles"==a||"trifans"==a||"tristrips"==a||"polylist"==a||"polygons"==a||"lines"==a||"linestrips"==a)&&this.geometryVertices!==null){var g;if("lines"==a||"linestrips"==a){g=this.getLinesGeometry(a)}else{g=this.getFacesGeometry(a)}if(g!==null){this.geometries[this.geometryId].push(g);if(this.geometryAppearance!==null){var c=this.appearanceGeometries[this.geometryAppearance];if(c===undefined){c=[];this.appearanceGeometries[this.geometryAppearance]=c}c.push(g)}}this.geometryAppearance=null;this.geometryVertices=null;this.geometryNormals=null;this.geometryTextureCoordinates=null;this.facesAndLinesPrimitives=[];this.polygonsPrimitives=[];this.polygonsHoles=[];this.vcount=null}}}}};DAEHandler.prototype.getFacesGeometry=function(b){var o;if("triangles"==b){o=GeometryInfo3D.TRIANGLE_ARRAY}else{if("trifans"==b){o=GeometryInfo3D.TRIANGLE_FAN_ARRAY}else{if("tristrips"==b){o=GeometryInfo3D.TRIANGLE_STRIP_ARRAY}else{o=GeometryInfo3D.POLYGON_ARRAY}}}var d=new GeometryInfo3D(o);d.setCoordinates(this.geometryVertices);d.setCoordinateIndices(this.getIndices(this.geometryVertexOffset));if(this.geometryNormals){d.setNormals(this.geometryNormals);d.setNormalIndices(this.getIndices(this.geometryNormalOffset))}if(this.geometryTextureCoordinates){var a;for(var f=0;f<this.sourceAccessorStrides.length;f++){var p=this.sourceAccessorStrides[f];if(p.floatArray===this.geometryTextureCoordinates){a=p.stride;break}}var c;if(a>2){c=new Array(this.geometryTextureCoordinates.length/a*2);for(var f=0,e=0;e<this.geometryTextureCoordinates.length;e+=a){c[f++]=this.geometryTextureCoordinates[e];c[f++]=this.geometryTextureCoordinates[e+1]}}else{c=this.geometryTextureCoordinates}d.setTextureCoordinates(c);d.setTextureCoordinateIndices(this.getIndices(this.geometryTextureCoordinatesOffset))}if("tristrips"==b||"trifans"==b){var h=new Array(this.facesAndLinesPrimitives.length);for(var f=0;f<h.length;f++){h[f]=this.facesAndLinesPrimitives[f].length/this.inputCount}d.setStripCounts(h)}else{if("polylist"==b){d.setStripCounts(this.vcount)}else{if("polygons"==b){var m=0;for(var f=0;f<this.polygonsHoles.length;f++){m+=this.polygonsHoles[f].length}var h=new Array(this.facesAndLinesPrimitives.length+this.polygonsPrimitives.length+m);var n=new Array(this.facesAndLinesPrimitives.length+this.polygonsPrimitives.length);var l=0;var k=0;for(var f=0;f<this.facesAndLinesPrimitives.length;f++){h[l++]=this.facesAndLinesPrimitives[f].length/this.inputCount;n[k++]=1}for(var f=0;f<this.polygonsPrimitives.length;f++){h[l++]=this.polygonsPrimitives[f].length/this.inputCount;var g=this.polygonsHoles[f];for(var e=0;e<g.length;e++){h[l++]=g[e].length/this.inputCount}n[k++]=1+g.length}d.setStripCounts(h);d.setContourCounts(n)}}}if(!this.geometryNormals){d.setCreaseAngle(Math.PI/2);d.setGeneratedNormals(true)}return d.getIndexedGeometryArray()};DAEHandler.prototype.getLinesGeometry=function(a){var h=this.getIndices(this.geometryVertexOffset);if(h.length!==0){var f=this.geometryTextureCoordinates?this.getIndices(this.geometryTextureCoordinatesOffset):[];if("linestrips"==a){var j=[];var b=[];for(var d=0,e=0;d<this.facesAndLinesPrimitives.length;d++){var g=this.facesAndLinesPrimitives[d].length/this.inputCount;for(var c=0;c<g-1;c++){j.push(h[e+c]);j.push(h[e+c+1]);if(textureCoordinateIndices.length>0){b.push(textureCoordinateIndices[e+c]);b.push(textureCoordinateIndices[e+c+1])}}e+=g}h=j;f=b}return new IndexedLineArray3D(this.geometryVertices,h,this.geometryTextureCoordinates,f)}else{return null}};DAEHandler.prototype.getIndices=function(f){if(this.facesAndLinesPrimitives.length===1&&this.polygonsPrimitives.length===1&&this.inputCount===1){return facesAndLinesPrimitives[0]}else{var m=this.getIndexCount(this.facesAndLinesPrimitives);m+=this.getIndexCount(this.polygonsPrimitives);for(var e=0;e<this.polygonsHoles.length;e++){m+=this.getIndexCount(this.polygonsHoles[e])}var o=new Array(m/this.inputCount);var e=0;for(var d=0;d<this.facesAndLinesPrimitives.length;d++){var n=this.facesAndLinesPrimitives[d];for(var c=f;c<n.length;c+=this.inputCount){o[e++]=n[c]}}for(var d=0;d<this.polygonsPrimitives.length;d++){var h=this.polygonsPrimitives[d];for(var c=f;c<h.length;c+=this.inputCount){o[e++]=h[c]}var g=this.polygonsHoles[d];for(var c=0;c<g.length;c++){var a=g[c];for(var b=f;b<a.length;b+=this.inputCount){o[e++]=a[b]}}}return o}};DAEHandler.prototype.getIndexCount=function(a){var c=0;for(var b=0;b<a.length;b++){c+=a[b].length}return c};DAEHandler.prototype.mulTransformGroup=function(b){var c=this.parentGroups[this.parentGroups.length-1];var a=mat4.create();c.getTransform(a);mat4.mul(a,a,b);c.setTransform(a)};DAEHandler.prototype.endDocument=function(){for(var b=0;b<this.postProcessingBinders.length;b++){this.postProcessingBinders[b]()}if(this.visualScene!==null){var g=mat4.create();this.visualScene.getTransform(g);var e=new BoundingBox3D(vec3.fromValues(Infinity,Infinity,Infinity),vec3.fromValues(-Infinity,-Infinity,-Infinity));this.computeBounds(this.visualScene,e,mat4.create());var a=vec3.create();e.getLower(a);if(a[0]!==Infinity){var d=vec3.create();e.getUpper(d);var h=mat4.create();mat4.translate(h,h,vec3.fromValues(-a[0]-(d[0]-a[0])/2,-a[1]-(d[1]-a[1])/2,-a[2]-(d[2]-a[2])/2));mat4.mul(h,h,g);g=h}var c=mat4.create();mat4.scale(c,c,vec3.fromValues(this.meterScale*100,this.meterScale*100,this.meterScale*100));mat4.mul(c,c,g);var f=mat4.create();if("Z_UP"==this.axis){mat4.fromXRotation(f,-Math.PI/2)}else{if("X_UP"==this.axis){mat4.fromZRotation(f,Math.PI/2)}}mat4.mul(f,f,c);this.visualScene.setTransform(f);this.sceneRoot.addChild(this.visualScene)}};DAEHandler.prototype.computeBounds=function(g,f,e){if(g instanceof Group3D){if(g instanceof TransformGroup3D){e=mat4.clone(e);var b=mat4.create();g.getTransform(b);mat4.mul(e,e,b)}var d=g.getChildren();for(var c=0;c<d.length;c++){this.computeBounds(d[c],f,e)}}else{if(g instanceof Link3D){this.computeBounds(g.getSharedGroup(),f,e)}else{if(g instanceof Shape3D){var a=g.getBounds();a.transform(e);f.combine(a)}}}};function Max3DSLoader(){ModelLoader.call(this,"3ds");if(Max3DSLoader.DEFAULT_APPEARANCE===null){Max3DSLoader.DEFAULT_APPEARANCE=new Appearance3D("Default");Max3DSLoader.DEFAULT_APPEARANCE.setAmbientColor(vec3.fromValues(0.4,0.4,0.4));Max3DSLoader.DEFAULT_APPEARANCE.setDiffuseColor(vec3.fromValues(0.7102,0.702,0.6531));Max3DSLoader.DEFAULT_APPEARANCE.setSpecularColor(vec3.fromValues(0.3,0.3,0.3));Max3DSLoader.DEFAULT_APPEARANCE.setShininess(128)}}Max3DSLoader.prototype=Object.create(ModelLoader.prototype);Max3DSLoader.prototype.constructor=Max3DSLoader;Max3DSLoader.NULL_CHUNK=0;Max3DSLoader.M3DMAGIC=19789;Max3DSLoader.MLIBMAGIC=15786;Max3DSLoader.CMAGIC=49725;Max3DSLoader.M3D_VERSION=2;Max3DSLoader.COLOR_FLOAT=16;Max3DSLoader.COLOR_24=17;Max3DSLoader.LINEAR_COLOR_24=18;Max3DSLoader.LINEAR_COLOR_FLOAT=19;Max3DSLoader.PERCENTAGE_INT=48;Max3DSLoader.PERCENTAGE_FLOAT=49;Max3DSLoader.EDITOR_DATA=15677;Max3DSLoader.MESH_VERSION=15678;Max3DSLoader.MASTER_SCALE=256;Max3DSLoader.MATERIAL_ENTRY=45055;Max3DSLoader.MATERIAL_NAME=40960;Max3DSLoader.MATERIAL_AMBIENT=40976;Max3DSLoader.MATERIAL_DIFFUSE=40992;Max3DSLoader.MATERIAL_SPECULAR=41008;Max3DSLoader.MATERIAL_SHININESS=41024;Max3DSLoader.MATERIAL_TRANSPARENCY=41040;Max3DSLoader.MATERIAL_TWO_SIDED=41089;Max3DSLoader.MATERIAL_TEXMAP=41472;Max3DSLoader.MATERIAL_MAPNAME=41728;Max3DSLoader.NAMED_OBJECT=16384;Max3DSLoader.TRIANGLE_MESH_OBJECT=16640;Max3DSLoader.POINT_ARRAY=16656;Max3DSLoader.FACE_ARRAY=16672;Max3DSLoader.MESH_MATERIAL_GROUP=16688;Max3DSLoader.SMOOTHING_GROUP=16720;Max3DSLoader.MESH_BOXMAP=16784;Max3DSLoader.TEXTURE_COORDINATES=16704;Max3DSLoader.MESH_MATRIX=16736;Max3DSLoader.MESH_COLOR=16741;Max3DSLoader.KEY_FRAMER_DATA=45056;Max3DSLoader.OBJECT_NODE_TAG=45058;Max3DSLoader.NODE_ID=45104;Max3DSLoader.NODE_HIERARCHY=45072;Max3DSLoader.PIVOT=45075;Max3DSLoader.POSITION_TRACK_TAG=45088;Max3DSLoader.ROTATION_TRACK_TAG=45089;Max3DSLoader.SCALE_TRACK_TAG=45090;Max3DSLoader.TRACK_KEY_USE_TENS=1;Max3DSLoader.TRACK_KEY_USE_CONT=2;Max3DSLoader.TRACK_KEY_USE_BIAS=4;Max3DSLoader.TRACK_KEY_USE_EASE_TO=8;Max3DSLoader.TRACK_KEY_USE_EASE_FROM=16;Max3DSLoader.DEFAULT_APPEARANCE=null;Max3DSLoader.prototype.createScene=function(j,b,d,s,c,l,r){var m=new Group3D();var n=mat4.create();mat4.fromXRotation(n,-Math.PI/2);mat4.scale(n,n,vec3.fromValues(c,c,c));var g=new TransformGroup3D(n);m.addChild(g);if(s.getChildren().length>0){g.addChild(s);g=s}var q={};for(var u in d){var o=d[u];var p=new Appearance3D(u);if(o.ambientColor!==null){p.setAmbientColor(o.ambientColor)}if(o.diffuseColor!==null){p.setDiffuseColor(o.diffuseColor)}if(o.shininess!==null){p.setShininess(o.shininess*128*0.6)}if(o.specularColor!==null){if(o.shininess!==null){var a=vec3.clone(o.specularColor);vec3.scale(a,a,o.shininess);p.setSpecularColor(a)}else{p.setSpecularColor(o.specularColor)}}if(o.transparency!==null&&o.transparency>0){p.setTransparency(Math.min(1,o.transparency))}if(o.texture){p.imageEntryName=o.texture}q[u]=p}if(l===null){r(ModelLoader.BUILDING_MODEL,"",0);for(var t=0;t<j.length;t++){this.createShapes(j[t],b,q,m,g)}r(ModelLoader.BUILDING_MODEL,"",1);return m}else{var e=j.length;var h=0;var k=this;var f=function(){r(ModelLoader.BUILDING_MODEL,"",e!==0?h/e:0);var v=Date.now();while(j.length>0){k.createShapes(j[0],b,q,m,g);h++;j.splice(0,1);if(h<e&&Date.now()-v>10){setTimeout(f,0);return}}setTimeout(function(){r(ModelLoader.BUILDING_MODEL,"",1);l(m)},0)};f()}};Max3DSLoader.prototype.createShapes=function(s,R,h,w,e){var J=mat4.create();var g=s.faces;if(g!==null&&g.length>0){var a=s.vertices;var S=new Array(a.length);for(var Q=0;Q<S.length;Q++){S[Q]=null}var F=new Array(3*g.length);var p=vec3.create();var m=vec3.create();for(var Q=0,O=0;Q<g.length;Q++){var f=g[Q];var x=f.vertexIndices;for(var P=0;P<3;P++,O++){var C=x[P];vec3.subtract(p,a[x[P<2?P+1:0]],a[C]);vec3.subtract(m,a[x[P>0?P-1:2]],a[C]);var G=vec3.create();vec3.cross(G,p,m);var n=vec3.length(G);if(n>0){var I=Math.atan2(n,vec3.dot(p,m));vec3.scale(G,G,I/n)}var c=new Max3DSLoader.Mesh3DSSharedVertex(Q,G);c.nextVertex=S[C];S[C]=c;F[O]=G}}var q=new Array(3*g.length);for(var Q=0,O=0;Q<g.length;Q++){var f=g[Q];var x=f.vertexIndices;var d=new Array(3);for(var P=0;P<3;P++,O++){var C=x[P];var G=vec3.create();if(f.smoothingGroup===null){for(var c=S[C];c!==null;c=c.nextVertex){if(g[c.faceIndex].smoothingGroup===null&&(c.normal===F[O]||vec3.dot(c.normal,F[O])>0)){vec3.add(G,G,c.normal)}}}else{var E=f.smoothingGroup;for(var c=S[C];c!==null;c=c.nextVertex){var L=g[c.faceIndex];if(L.smoothingGroup!==null&&(f.smoothingGroup&L.smoothingGroup)!==0){E|=L.smoothingGroup}}for(var c=S[C];c!==null;c=c.nextVertex){var L=g[c.faceIndex];if(L.smoothingGroup!==null&&(E&L.smoothingGroup)!==0){vec3.add(G,G,c.normal)}}}if(vec3.squaredLength(G)!==0){vec3.normalize(G,G)}else{vec3.copy(G,F[O]);if(vec3.squaredLength(G)!==0){vec3.normalize(G,G)}}q[O]=G;d[P]=O}f.normalIndices=d}g.sort(function(k,V){var l=k.material;var j=V.material;if(l===null){if(j===null){return k.index-V.index}else{return -1}}else{if(j===null){return 1}else{return 0}}});var K;var B=R[s.name];if(B===undefined){K=e}else{if(B.length===1){K=B[0]}else{var b=new SharedGroup3D();for(var Q=0;Q<B.length;Q++){B[Q].addChild(new Link3D(b))}K=b}}var z=s.transform;if(z!==null){if(!mat4.exactEquals(z,J)){var y=new TransformGroup3D(z);K.addChild(y);K=y}}var r=s.textureCoordinates;var Q=0;var o=null;var N=null;while(Q<g.length){var D=g[Q];var v=D.material;var u=Q;while(++u<g.length){if(v!==g[u].material){break}}var U=u-Q;var T=new Array(U*3);var d=new Array(U*3);for(var P=0,O=0;P<U;P++){var f=g[Q+P];var x=f.vertexIndices;var A=f.normalIndices;for(var M=0;M<3;M++,O++){T[O]=x[M];d[O]=A[M]}}var H=new GeometryInfo3D(GeometryInfo3D.TRIANGLE_ARRAY);H.setCoordinates(a);H.setCoordinateIndices(T);H.setNormals(q);H.setNormalIndices(d);if(r!==null){H.setTextureCoordinates(r);H.setTextureCoordinateIndices(T)}geometryArray=H.getIndexedGeometryArray();if(o===null||N!==v){N=v;var t=Max3DSLoader.DEFAULT_APPEARANCE;if(v!==null&&h[v.name]!==undefined){t=h[v.name]}t=t.clone();if(v!==null&&v.twoSided){t.setCullFace(Appearance3D.CULL_NONE)}o=new Shape3D(geometryArray,t);K.addChild(o);o.setName(s.name+(Q===0?"":"_"+Q))}else{o.addGeometry(geometryArray)}Q=u}}};Max3DSLoader.prototype.getModelContent=function(a){return a.asUint8Array()};Max3DSLoader.prototype.parseEntryScene=function(f,a,c,g,l,h){var d=[];var n={};var m={};var b;var j=new TransformGroup3D();if(l===null){h(ModelLoader.PARSING_MODEL,a,0);b=this.parse3DSStream(new Max3DSLoader.ChunksInputStream(f),a,c,d,n,m,j);h(ModelLoader.PARSING_MODEL,a,1);return this.createScene(d,n,m,j,b,null,h)}else{var k=this;b=this.parse3DSStream(new Max3DSLoader.ChunksInputStream(f),a,c,d,n,m,j);var e=function(){setTimeout(function(){h(ModelLoader.PARSING_MODEL,a,1);k.createScene(d,n,m,j,b,function(o){l(o)},h)},0)};e()}};Max3DSLoader.prototype.parse3DSStream=function(h,a,c,d,j,k,g){var b=1;try{var e=false;switch(h.readChunkHeader().id){case Max3DSLoader.M3DMAGIC:case Max3DSLoader.MLIBMAGIC:case Max3DSLoader.CMAGIC:e=true;while(!h.isChunckEndReached()){switch(h.readChunkHeader().id){case Max3DSLoader.M3D_VERSION:h.readLittleEndianUnsignedInt();break;case Max3DSLoader.EDITOR_DATA:this.parseEditorData(h,a,c,d,k);break;case Max3DSLoader.KEY_FRAMER_DATA:this.parseKeyFramerData(h,j,g);break;default:h.readUntilChunkEnd();break}h.releaseChunk()}break;case Max3DSLoader.EDITOR_DATA:b=this.parseEditorData(h,a,c,d,k);break;default:if(e){h.readUntilChunkEnd()}else{throw new IncorrectFormat3DException("Bad magic number")}}h.releaseChunk()}catch(f){d.length=0}return b};Max3DSLoader.prototype.parseEditorData=function(e,b,g,a,c){var d=1;while(!e.isChunckEndReached()){switch(e.readChunkHeader().id){case Max3DSLoader.MESH_VERSION:e.readLittleEndianInt();break;case Max3DSLoader.MASTER_SCALE:d=e.readLittleEndianFloat();break;case Max3DSLoader.NAMED_OBJECT:this.parseNamedObject(e,a,c);break;case Max3DSLoader.MATERIAL_ENTRY:var f=this.parseMaterial(e,b,g);c[f.name]=f;break;default:e.readUntilChunkEnd();break}e.releaseChunk()}return d};Max3DSLoader.prototype.parseNamedObject=function(c,a,b){var d=c.readString();while(!c.isChunckEndReached()){switch(c.readChunkHeader().id){case Max3DSLoader.TRIANGLE_MESH_OBJECT:a.push(this.parseMeshData(c,d,b));break;default:c.readUntilChunkEnd();break}c.releaseChunk()}};Max3DSLoader.prototype.parseMeshData=function(l,a,o){var k=null;var e=null;var c=null;var f=null;var d=null;while(!l.isChunckEndReached()){switch(l.readChunkHeader().id){case Max3DSLoader.MESH_MATRIX:c=this.parseMatrix(l);c=mat4.invert(c,c);break;case Max3DSLoader.MESH_COLOR:f=l.readUnsignedByte();break;case Max3DSLoader.POINT_ARRAY:k=new Array(l.readLittleEndianUnsignedShort());for(var g=0;g<k.length;g++){k[g]=vec3.fromValues(l.readLittleEndianFloat(),l.readLittleEndianFloat(),l.readLittleEndianFloat())}break;case Max3DSLoader.FACE_ARRAY:d=this.parseFacesData(l);while(!l.isChunckEndReached()){switch(l.readChunkHeader().id){case Max3DSLoader.MESH_MATERIAL_GROUP:var m=l.readString();var j=null;if(o!==null){j=o[m]}for(var g=0,b=l.readLittleEndianUnsignedShort();g<b;g++){var h=l.readLittleEndianUnsignedShort();if(h<d.length){d[h].material=j}}break;case Max3DSLoader.SMOOTHING_GROUP:for(var g=0;g<d.length;g++){d[g].smoothingGroup=l.readLittleEndianUnsignedInt()}break;case Max3DSLoader.MESH_BOXMAP:default:l.readUntilChunkEnd();break}l.releaseChunk()}break;case Max3DSLoader.TEXTURE_COORDINATES:e=new Array(l.readLittleEndianUnsignedShort());for(var g=0;g<e.length;g++){e[g]=vec2.fromValues(l.readLittleEndianFloat(),l.readLittleEndianFloat())}break;default:l.readUntilChunkEnd();break}l.releaseChunk()}return new Max3DSLoader.Mesh3DS(a,k,e,d,f,c)};Max3DSLoader.prototype.parseKeyFramerData=function(p,b,s){var l=[];var k=[];var j=null;while(!p.isChunckEndReached()){switch(p.readChunkHeader().id){case Max3DSLoader.OBJECT_NODE_TAG:var v=true;var h=null;var y=null;var f=0;var x=null;var z=null;var n=-1;while(!p.isChunckEndReached()){switch(p.readChunkHeader().id){case Max3DSLoader.NODE_ID:n=p.readLittleEndianShort();break;case Max3DSLoader.NODE_HIERARCHY:var w=p.readString();v="$$$DUMMY"!=w;p.readLittleEndianUnsignedShort();p.readLittleEndianUnsignedShort();var u=p.readLittleEndianShort();var m=new TransformGroup3D();if(u===-1){s.addChild(m)}else{var q=false;for(var t=0;t<k.length;t++){if(u===k[t]){l[t].addChild(m);q=true;break}}if(!q){throw new IncorrectFormat3DException("Inconsistent nodes hierarchy")}}k.push(n);l.push(m);if(v){var e=b[w];if(e===undefined){e=[];b[w]=e}e.push(m)}j=m;break;case Max3DSLoader.PIVOT:h=this.parseVector(p);break;case Max3DSLoader.POSITION_TRACK_TAG:this.parseKeyFramerTrackStart(p);y=this.parseVector(p);p.readUntilChunkEnd();break;case Max3DSLoader.ROTATION_TRACK_TAG:this.parseKeyFramerTrackStart(p);f=p.readLittleEndianFloat();x=this.parseVector(p);p.readUntilChunkEnd();break;case Max3DSLoader.SCALE_TRACK_TAG:this.parseKeyFramerTrackStart(p);z=this.parseVector(p);p.readUntilChunkEnd();break;default:p.readUntilChunkEnd();break}p.releaseChunk()}var o=mat4.create();if(y!==null){mat4.translate(o,o,y)}if(x!==null&&f!==0){var d=vec3.length(x);if(d>0){var r=-f/2;var a=Math.sin(r)/d;var c=Math.cos(r);var g=mat4.create();mat4.fromQuat(g,quat.fromValues(x[0]*a,x[1]*a,x[2]*a,c));mat4.mul(o,o,g)}}if(z!==null){mat4.scale(o,o,z)}if(h!==null&&v){vec3.negate(h,h);mat4.translate(o,o,h)}j.setTransform(o);break;default:p.readUntilChunkEnd();break}p.releaseChunk()}};Max3DSLoader.prototype.parseKeyFramerTrackStart=function(b){b.readLittleEndianUnsignedShort();b.readLittleEndianUnsignedInt();b.readLittleEndianUnsignedInt();b.readLittleEndianInt();b.readLittleEndianInt();var a=b.readLittleEndianUnsignedShort();if((a&Max3DSLoader.TRACK_KEY_USE_TENS)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_CONT)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_BIAS)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_EASE_TO)!==0){b.readLittleEndianFloat()}if((a&Max3DSLoader.TRACK_KEY_USE_EASE_FROM)!==0){b.readLittleEndianFloat()}};Max3DSLoader.prototype.parseFacesData=function(b){var a=new Array(b.readLittleEndianUnsignedShort());for(var c=0;c<a.length;c++){a[c]=new Max3DSLoader.Face3DS(c,b.readLittleEndianUnsignedShort(),b.readLittleEndianUnsignedShort(),b.readLittleEndianUnsignedShort(),b.readLittleEndianUnsignedShort())}return a};Max3DSLoader.prototype.parseMaterial=function(k,a,c){var b=null;var g=null;var h=null;var e=null;var l=null;var d=null;var f=false;var j=null;while(!k.isChunckEndReached()){switch(k.readChunkHeader().id){case Max3DSLoader.MATERIAL_NAME:b=k.readString();break;case Max3DSLoader.MATERIAL_AMBIENT:g=this.parseColor(k);break;case Max3DSLoader.MATERIAL_DIFFUSE:h=this.parseColor(k);break;case Max3DSLoader.MATERIAL_SPECULAR:e=this.parseColor(k);break;case Max3DSLoader.MATERIAL_SHININESS:l=this.parsePercentage(k);break;case Max3DSLoader.MATERIAL_TRANSPARENCY:d=this.parsePercentage(k);break;case Max3DSLoader.MATERIAL_TWO_SIDED:f=true;break;case Max3DSLoader.MATERIAL_TEXMAP:j=this.parseTextureMap(k,a,c);break;default:k.readUntilChunkEnd();break}k.releaseChunk()}return new Max3DSLoader.Material3DS(b,g,h,e,l,d,j,f)};Max3DSLoader.prototype.parseColor=function(c){var d=false;var b=null;var a;while(!c.isChunckEndReached()){switch(c.readChunkHeader().id){case Max3DSLoader.LINEAR_COLOR_24:d=true;b=vec3.fromValues(c.readUnsignedByte()/255,c.readUnsignedByte()/255,c.readUnsignedByte()/255);break;case Max3DSLoader.COLOR_24:a=vec3.fromValues(c.readUnsignedByte()/255,c.readUnsignedByte()/255,c.readUnsignedByte()/255);if(!d){b=a}break;case Max3DSLoader.LINEAR_COLOR_FLOAT:d=true;b=vec3.fromValues(c.readLittleEndianFloat(),c.readLittleEndianFloat(),c.readLittleEndianFloat());break;case Max3DSLoader.COLOR_FLOAT:a=vec3.fromValues(c.readLittleEndianFloat(),c.readLittleEndianFloat(),c.readLittleEndianFloat());if(!d){b=a}break;default:c.readUntilChunkEnd();break}c.releaseChunk()}if(b!==null){return b}else{throw new IncorrectFormat3DException("Expected color value")}};Max3DSLoader.prototype.parsePercentage=function(b){var a=null;while(!b.isChunckEndReached()){switch(b.readChunkHeader().id){case Max3DSLoader.PERCENTAGE_INT:a=b.readLittleEndianShort()/100;break;case Max3DSLoader.PERCENTAGE_FLOAT:a=b.readLittleEndianFloat();break;default:b.readUntilChunkEnd();break}b.releaseChunk()}if(a!==null){return a}else{throw new IncorrectFormat3DException("Expected percentage value")}};Max3DSLoader.prototype.parseTextureMap=function(c,b,f){var e=null;while(!c.isChunckEndReached()){switch(c.readChunkHeader().id){case Max3DSLoader.MATERIAL_MAPNAME:e=c.readString();break;case Max3DSLoader.PERCENTAGE_INT:default:c.readUntilChunkEnd();break}c.releaseChunk()}if(e!==null){var a=b.lastIndexOf("/");if(a>=0){e=b.substring(0,a+1)+e}var d=f.file(e);if(d!==null){return e}else{return this.getEntryNameIgnoreCase(f,e)}}return null};Max3DSLoader.prototype.getEntryNameIgnoreCase=function(c,d){d=d.toUpperCase();var a=c.file(/.*/);for(var b=0;b<a.length;b++){if(a[b].name.toUpperCase()==d){return a[b].name}}return null};Max3DSLoader.prototype.parseMatrix=function(a){return mat4.fromValues(a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),0,a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),0,a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),0,a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat(),1)};Max3DSLoader.prototype.parseVector=function(a){return vec3.fromValues(a.readLittleEndianFloat(),a.readLittleEndianFloat(),a.readLittleEndianFloat())};Max3DSLoader.Chunk3DS=function(b,a){if(a<6){throw new IncorrectFormat3DException("Invalid chunk "+b+" length "+a)}this.id=b;this.length=a;this.readLength=6};Max3DSLoader.Chunk3DS.prototype.incrementReadLength=function(a){this.readLength+=a};Max3DSLoader.Chunk3DS.prototype.toString=function(){return this.id+" "+this.length};Max3DSLoader.ChunksInputStream=function(a){this.input=a;this.index=0;this.stack=[]};Max3DSLoader.ChunksInputStream.prototype.read=function(){if(this.index>=this.input.length){return -1}else{return this.input[this.index++]}};Max3DSLoader.ChunksInputStream.prototype.readChunkHeader=function(){var a=this.readLittleEndianUnsignedShort(false);var b=new Max3DSLoader.Chunk3DS(a,this.readLittleEndianUnsignedInt(false));this.stack.push(b);return b};Max3DSLoader.ChunksInputStream.prototype.releaseChunk=function(){var a=this.stack.pop();if(a.length!==a.readLength){throw new IncorrectFormat3DException("Chunk "+a.id+" invalid length. Expected to read "+a.length+" bytes, but actually read "+a.readLength+" bytes")}if(this.stack.length!==0){this.stack[this.stack.length-1].incrementReadLength(a.length)}};Max3DSLoader.ChunksInputStream.prototype.isChunckEndReached=function(){var a=this.stack[this.stack.length-1];return a.length===a.readLength};Max3DSLoader.ChunksInputStream.prototype.readUntilChunkEnd=function(){var a=this.stack[this.stack.length-1];var c=a.length-a.readLength;for(var b=c;b>0;b--){if(this.read()<0){throw new IncorrectFormat3DException("Chunk "+a.id+" too short")}}a.incrementReadLength(c)};Max3DSLoader.ChunksInputStream.prototype.readUnsignedByte=function(){var a=this.read();if(a===-1){throw new IncorrectFormat3DException("Unexpected EOF")}else{this.stack[this.stack.length-1].incrementReadLength(1);return a}};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianUnsignedShort=function(c){if(c===undefined){c=true}var b=this.read();if(b===-1){throw new IncorrectFormat3DException("Unexpected EOF")}var a=this.read();if(a===-1){throw new IncorrectFormat3DException("Can't read short")}if(c){this.stack[this.stack.length-1].incrementReadLength(2)}return(a<<8)|b};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianShort=function(b){var a=this.readLittleEndianUnsignedShort(b);if(a&32768){a=(-1&~32767)|a}return a};Max3DSLoader.ChunksInputStream.converter=new Int8Array(4);Max3DSLoader.ChunksInputStream.int32Converter=new Int32Array(Max3DSLoader.ChunksInputStream.converter.buffer,0,1);Max3DSLoader.ChunksInputStream.float32Converter=new Float32Array(Max3DSLoader.ChunksInputStream.converter.buffer,0,1);Max3DSLoader.ChunksInputStream.prototype.readLittleEndianFloat=function(){Max3DSLoader.ChunksInputStream.int32Converter[0]=this.readLittleEndianUnsignedInt(true);return Max3DSLoader.ChunksInputStream.float32Converter[0]};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianUnsignedInt=function(e){if(e===undefined){e=true}var d=this.read();if(d===-1){throw new IncorrectFormat3DException("Unexpected EOF")}var c=this.read();var b=this.read();var a=this.read();if(c===-1||b===-1||a===-1){throw new IncorrectFormat3DException("Can't read int")}if(e){this.stack[this.stack.length-1].incrementReadLength(4)}return(a<<24)|(b<<16)|(c<<8)|d};Max3DSLoader.ChunksInputStream.prototype.readLittleEndianInt=function(b){var a=this.readLittleEndianUnsignedInt(b);if(a&2147483648){a=(-1&~2147483647)|a}return a};Max3DSLoader.ChunksInputStream.prototype.readString=function(){var c="";var a;while((a=this.read())!==-1&&a!==0){c+=String.fromCharCode(a)}if(a===-1){throw new IncorrectFormat3DException("Unexpected end of file")}this.stack[this.stack.length-1].incrementReadLength(c.length+1);return c};Max3DSLoader.Mesh3DS=function(f,e,b,a,c,d){this.name=f;this.vertices=e;this.textureCoordinates=b;this.faces=a;this.color=c;this.transform=d};Max3DSLoader.Face3DS=function(e,d,b,c,a){this.index=e;this.vertexIndices=[d,b,c];this.normalIndices=null;this.material=null;this.smoothingGroup=null};Max3DSLoader.Material3DS=function(d,c,g,h,e,b,f,a){this.name=d;this.ambientColor=c;this.diffuseColor=g;this.specularColor=h;this.shininess=e;this.transparency=b;this.texture=f;this.twoSided=a};Max3DSLoader.Mesh3DSSharedVertex=function(a,b){this.faceIndex=a;this.normal=b;this.nextVertex=null};function ModelManager(){this.loadedModelNodes={};this.loadingModelObservers={}}ModelManager.SPECIAL_SHAPE_PREFIX="sweethome3d_";ModelManager.WINDOW_PANE_SHAPE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"window_pane";ModelManager.MIRROR_SHAPE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"window_mirror";ModelManager.LIGHT_SHAPE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"light";ModelManager.MANNEQUIN_ABDOMEN_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_abdomen";ModelManager.MANNEQUIN_CHEST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_chest";ModelManager.MANNEQUIN_PELVIS_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_pelvis";ModelManager.MANNEQUIN_NECK_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_neck";ModelManager.MANNEQUIN_HEAD_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_head";ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_shoulder";ModelManager.MANNEQUIN_LEFT_ARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_arm";ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_elbow";ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_forearm";ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_wrist";ModelManager.MANNEQUIN_LEFT_HAND_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_hand";ModelManager.MANNEQUIN_LEFT_HIP_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_hip";ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_thigh";ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_knee";ModelManager.MANNEQUIN_LEFT_LEG_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_leg";ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_ankle";ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_left_foot";ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_shoulder";ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_arm";ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_elbow";ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_forearm";ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_wrist";ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_hand";ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_hip";ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_thigh";ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_knee";ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_leg";ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_ankle";ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_right_foot";ModelManager.MANNEQUIN_ABDOMEN_CHEST_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_abdomen_chest";ModelManager.MANNEQUIN_ABDOMEN_PELVIS_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"mannequin_abdomen_pelvis";ModelManager.BALL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"ball_";ModelManager.ARM_ON_BALL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"arm_on_ball_";ModelManager.HINGE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"hinge_";ModelManager.OPENING_ON_HINGE_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"opening_on_hinge_";ModelManager.WINDOW_PANE_ON_HINGE_PREFIX=ModelManager.WINDOW_PANE_SHAPE_PREFIX+"_on_hinge_";ModelManager.MIRROR_ON_HINGE_PREFIX=ModelManager.MIRROR_SHAPE_PREFIX+"_on_hinge_";ModelManager.UNIQUE_RAIL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"unique_rail";ModelManager.RAIL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"rail_";ModelManager.OPENING_ON_RAIL_PREFIX=ModelManager.SPECIAL_SHAPE_PREFIX+"opening_on_rail_";ModelManager.WINDOW_PANE_ON_RAIL_PREFIX=ModelManager.WINDOW_PANE_SHAPE_PREFIX+"_on_rail_";ModelManager.MIRROR_ON_RAIL_PREFIX=ModelManager.MIRROR_SHAPE_PREFIX+"_on_rail_";ModelManager.SUB_TRANSFORMATION_SEPARATOR="_and_";ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX="_transformation";ModelManager.EDGE_COLOR_MATERIAL_PREFIX="edge_color";ModelManager.instance=null;ModelManager.getInstance=function(){if(ModelManager.instance==null){ModelManager.instance=new ModelManager()}return ModelManager.instance};ModelManager.prototype.clear=function(){this.loadedModelNodes={};this.loadingModelObservers={};if(this.modelLoaders){for(var a=0;a<this.modelLoaders.length;a++){this.modelLoaders[a].clear()}}};ModelManager.prototype.getMinimumSize=function(){return 0.001};ModelManager.prototype.getSize=function(e,d){if(d===undefined){d=mat4.create()}var c=this.getBounds(e,d);var a=vec3.create();c.getLower(a);var b=vec3.create();c.getUpper(b);return vec3.fromValues(Math.max(this.getMinimumSize(),b[0]-a[0]),Math.max(this.getMinimumSize(),b[1]-a[1]),Math.max(this.getMinimumSize(),b[2]-a[2]))};ModelManager.prototype.getCenter=function(d){var c=this.getBounds(d);var a=vec3.create();c.getLower(a);var b=vec3.create();c.getUpper(b);return vec3.fromValues((a[0]+b[0])/2,(a[1]+b[1])/2,(a[2]+b[2])/2)};ModelManager.prototype.getBounds=function(b,a){if(a===undefined){a=mat4.create()}var c=new BoundingBox3D(vec3.fromValues(Infinity,Infinity,Infinity),vec3.fromValues(-Infinity,-Infinity,-Infinity));this.computeBounds(b,c,a,!this.isOrthogonalRotation(a),this.isDeformed(b));return c};ModelManager.prototype.isOrthogonalRotation=function(c){for(var b=0;b<3;b++){for(var a=0;a<3;a++){if(Math.abs(c[b*4+a])>0.000001&&Math.abs(c[b*4+a]-1)>0.000001&&Math.abs(c[b*4+a]+1)>0.000001){return false}}}return true};ModelManager.prototype.computeBounds=function(f,e,g,c,b){if(f instanceof Group3D){if(f instanceof TransformGroup3D){g=mat4.clone(g);mat4.mul(g,g,f.transform)}for(var d=0;d<f.children.length;d++){this.computeBounds(f.children[d],e,g,c,b)}}else{if(f instanceof Link3D){this.computeBounds(f.getSharedGroup(),e,g,c,b)}else{if(f instanceof Shape3D){var a;if(c||b&&!this.isOrthogonalRotation(g)){a=this.computeTransformedGeometryBounds(f,g)}else{a=f.getBounds();a.transform(g)}e.combine(a)}}}};ModelManager.prototype.computeTransformedGeometryBounds=function(a,f){var c=vec3.fromValues(Infinity,Infinity,Infinity);var e=vec3.fromValues(-Infinity,-Infinity,-Infinity);for(var d=0;d<a.geometries.length;d++){var h=a.geometries[d];var g=vec3.create();for(var b=0;b<h.vertexIndices.length;b++){vec3.copy(g,h.vertices[h.vertexIndices[b]]);this.updateBounds(g,f,c,e)}}return new BoundingBox3D(c,e)};ModelManager.prototype.updateBounds=function(d,c,a,b){if(c!==null){vec3.transformMat4(d,d,c)}vec3.min(a,a,d);vec3.max(b,b,d)};ModelManager.prototype.getNormalizedTransformGroup=function(c,d,b,a){return new TransformGroup3D(this.getNormalizedTransform(c,d,b,a!==false))};ModelManager.prototype.getNormalizedTransform=function(d,c,b,g){var k=this.getBounds(d);var f=vec3.create();k.getLower(f);var m=vec3.create();k.getUpper(m);var a=mat4.create();mat4.translate(a,a,vec3.fromValues(-f[0]-(m[0]-f[0])/2,-f[1]-(m[1]-f[1])/2,-f[2]-(m[2]-f[2])/2));var j;if(c!==undefined&&c!==null){var e=this.getRotationTransformation(c);mat4.mul(e,e,a);var h=this.getBounds(d,e);h.getLower(f);h.getUpper(m);j=mat4.create();if(g){mat4.translate(j,j,vec3.fromValues(-f[0]-(m[0]-f[0])/2,-f[1]-(m[1]-f[1])/2,-f[2]-(m[2]-f[2])/2))}mat4.mul(j,j,e)}else{j=a}var l=mat4.create();mat4.scale(l,l,vec3.fromValues(b/Math.max(this.getMinimumSize(),m[0]-f[0]),b/Math.max(this.getMinimumSize(),m[1]-f[1]),b/Math.max(this.getMinimumSize(),m[2]-f[2])));mat4.mul(l,l,j);return l};ModelManager.prototype.getRotationTransformation=function(b){var a=mat4.create();a[0]=b[0][0];a[4]=b[0][1];a[8]=b[0][2];a[1]=b[1][0];a[5]=b[1][1];a[9]=b[1][2];a[2]=b[2][0];a[6]=b[2][1];a[10]=b[2][2];return a};ModelManager.prototype.getPieceOfFurnitureNormalizedModelTransformation=function(o,b){var d=mat4.create();var l=o.getWidth();if(o.isModelMirrored()){l*=-1}mat4.scale(d,d,vec3.fromValues(l,o.getHeight(),o.getDepth()));var h;var n;if(o.isHorizontallyRotated()&&b!==undefined&&b!==null){var j=mat4.create();if(o.getPitch()!=0){mat4.fromXRotation(j,-o.getPitch())}if(o.getRoll()!=0){var m=mat4.create();mat4.fromZRotation(m,-o.getRoll());mat4.mul(j,m,j)}mat4.mul(j,j,d);var g=this.getBounds(b,j);var e=vec3.create();g.getLower(e);var k=vec3.create();g.getUpper(k);h=mat4.create();mat4.translate(h,h,vec3.fromValues(-e[0]-(k[0]-e[0])/2,-e[1]-(k[1]-e[1])/2,-e[2]-(k[2]-e[2])/2));mat4.mul(h,h,j);n=Math.max(this.getMinimumSize(),k[1]-e[1])}else{h=d;n=o.getHeight()}var a=mat4.create();mat4.fromYRotation(a,-o.getAngle());mat4.mul(a,a,h);var f=mat4.create();var c;if(o.getLevel()!==null){c=o.getLevel().getElevation()}else{c=0}mat4.translate(f,f,vec3.fromValues(o.getX(),o.getElevation()+n/2+c,o.getY()));mat4.mul(f,f,a);return f};ModelManager.prototype.getPieceOFFurnitureNormalizedModelTransformation=ModelManager.prototype.getPieceOfFurnitureNormalizedModelTransformation;ModelManager.prototype.loadModel=function(e,b,d){if(d===undefined){d=b;b=false}var a=this;var g=e.getURL();if(g in this.loadedModelNodes){var c=this.loadedModelNodes[g];if(d.modelUpdated!==undefined){d.modelUpdated(this.cloneNode(c))}}else{if(b){this.load(e,b,{modelLoaded:function(h){a.loadedModelNodes[g]=h;if(d.modelUpdated!==undefined){d.modelUpdated(a.cloneNode(h))}},modelError:function(h){if(d.modelError!==undefined){d.modelError(h)}},progression:function(j,k,h){if(d.progression!==undefined){d.progression(j,k,h)}}})}else{if(g in this.loadingModelObservers){this.loadingModelObservers[g].push(d)}else{var f=[];f.push(d);this.loadingModelObservers[g]=f;this.load(e,b,{modelLoaded:function(j){a.loadedModelNodes[g]=j;var k=a.loadingModelObservers[g];if(k){for(var h=0;h<k.length;h++){if(k[h].modelUpdated!==undefined){k[h].modelUpdated(a.cloneNode(j))}}}},modelError:function(j){var k=a.loadingModelObservers[g];if(k){delete a.loadingModelObservers[g];for(var h=0;h<k.length;h++){if(k[h].modelError!==undefined){k[h].modelError(j)}}}},progression:function(j,l,h){var m=a.loadingModelObservers[g];if(m){for(var k=0;k<m.length;k++){if(m[k].progression!==undefined){m[k].progression(j,l,h)}}}}})}}}};ModelManager.prototype.unloadModel=function(b,a){var c=b.getURL();var d=this.loadedModelNodes[c];delete this.loadedModelNodes[c];delete this.loadingModelObservers[c];if(a){this.disposeGeometries(d)}};ModelManager.prototype.disposeGeometries=function(c){if(c instanceof Group3D){for(var a=0;a<c.children.length;a++){this.disposeGeometries(c.children[a])}}else{if(c instanceof Link3D){this.disposeGeometries(c.getSharedGroup())}else{if(c instanceof Shape3D){var b=c.getGeometries();for(var a=0;a<b.length;a++){b[a].disposeCoordinates()}}}}};ModelManager.prototype.cloneNode=function(d,k){if(k===undefined){return this.cloneNode(d,[])}else{var j=d.clone();if(d instanceof Shape3D){var h;if(d.getAppearance()){j.setAppearance(d.getAppearance().clone())}}else{if(d instanceof Link3D){var f=d.clone();var e=f.getSharedGroup();if(e!==null){var a=null;for(var g=0;g<k.length;g++){if(k[g].sharedGroup===e){a=k[g].clonedSharedGroup;break}}if(a===null){a=this.cloneNode(e,k);k.push({sharedGroup:e,clonedSharedGroup:a})}f.setSharedGroup(a)}return f}else{j=d.clone();if(d instanceof Group3D){var b=d.getChildren();for(var g=0;g<b.length;g++){var c=this.cloneNode(b[g],k);j.addChild(c)}}}}return j}};ModelManager.prototype.load=function(d,b,c){if(c===undefined){c=b;b=false}var e=d.getURL();if(!this.modelLoaders){this.modelLoaders=[new OBJLoader()];if(typeof DAELoader!=="undefined"){this.modelLoaders.push(new DAELoader())}if(typeof Max3DSLoader!=="undefined"){this.modelLoaders.push(new Max3DSLoader())}}var a=this;var f={modelLoaderIndex:0,modelLoaded:function(g){var h=a.getBounds(g);if(!h.isEmpty()){a.updateWindowPanesTransparency(g);a.updateDeformableModelHierarchy(g);a.replaceMultipleSharedShapes(g);g.setUserData(d);c.modelLoaded(g)}else{if(++this.modelLoaderIndex<a.modelLoaders.length){a.modelLoaders[this.modelLoaderIndex].load(e,b,this)}else{this.modelError("Unsupported 3D format")}}},modelError:function(g){c.modelError(g)},progression:function(h,j,g){c.progression(h,j,g)}};a.modelLoaders[0].load(e,b,f)};ModelManager.prototype.updateWindowPanesTransparency=function(d){if(d instanceof Group3D){for(var c=0;c<d.children.length;c++){this.updateWindowPanesTransparency(d.children[c])}}else{if(d instanceof Link3D){this.updateWindowPanesTransparency(d.getSharedGroup())}else{if(d instanceof Shape3D){var b=d.getName();if(b&&b.indexOf(ModelManager.WINDOW_PANE_SHAPE_PREFIX)===0){var a=d.getAppearance();if(a===null){a=new Appearance3D();d.setAppearance(a)}if(a.getTransparency()===undefined){a.setTransparency(0.5)}}}}}};ModelManager.prototype.updateDeformableModelHierarchy=function(z){if(this.containsNode(z,ModelManager.MANNEQUIN_ABDOMEN_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_CHEST_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_PELVIS_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_NECK_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_HEAD_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_ARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_HAND_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_HIP_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_LEG_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX)&&this.containsNode(z,ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX)){var v=this.extractNodes(z,ModelManager.MANNEQUIN_HEAD_PREFIX,null);var m=this.createPickableTransformGroup(ModelManager.MANNEQUIN_NECK_PREFIX,[v]);var T=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_HAND_PREFIX,null);var d=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX,[T]);var Q=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_FOREARM_PREFIX,null);var h=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_WRIST_PREFIX,null);var D=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX,[Q,h,d]);var p=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_ARM_PREFIX,null);var L=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_ELBOW_PREFIX,null);var M=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX,[p,L,D]);var y=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_HAND_PREFIX,null);var e=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX,[y]);var l=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_FOREARM_PREFIX,null);var N=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_WRIST_PREFIX,null);var j=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX,[l,N,e]);var J=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_ARM_PREFIX,null);var o=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_ELBOW_PREFIX,null);var q=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX,[J,o,j]);var k=this.extractNodes(z,ModelManager.MANNEQUIN_CHEST_PREFIX,null);var F=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_SHOULDER_PREFIX,null);var g=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_SHOULDER_PREFIX,null);var b=this.extractNodes(z,ModelManager.MANNEQUIN_NECK_PREFIX,null);var f=this.createPickableTransformGroup(ModelManager.MANNEQUIN_ABDOMEN_CHEST_PREFIX,[k,F,M,g,q,b,m]);var c=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_FOOT_PREFIX,null);var H=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX,[c]);var t=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_LEG_PREFIX,null);var O=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_ANKLE_PREFIX,null);var A=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX,[t,O,H]);var R=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_THIGH_PREFIX,null);var I=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_KNEE_PREFIX,null);var n=this.createPickableTransformGroup(ModelManager.MANNEQUIN_LEFT_HIP_PREFIX,[R,I,A]);var B=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_FOOT_PREFIX,null);var G=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX,[B]);var K=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_LEG_PREFIX,null);var s=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_ANKLE_PREFIX,null);var U=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX,[K,s,G]);var C=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_THIGH_PREFIX,null);var a=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_KNEE_PREFIX,null);var r=this.createPickableTransformGroup(ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX,[C,a,U]);var x=this.extractNodes(z,ModelManager.MANNEQUIN_PELVIS_PREFIX,null);var w=this.extractNodes(z,ModelManager.MANNEQUIN_LEFT_HIP_PREFIX,null);var P=this.extractNodes(z,ModelManager.MANNEQUIN_RIGHT_HIP_PREFIX,null);var S=this.createPickableTransformGroup(ModelManager.MANNEQUIN_ABDOMEN_PELVIS_PREFIX,[x,w,n,P,r]);var u=this.extractNodes(z,ModelManager.MANNEQUIN_ABDOMEN_PREFIX,null);z.addChild(u);z.addChild(f);z.addChild(S)}else{this.updateSimpleDeformableModelHierarchy(z,null,ModelManager.HINGE_PREFIX,ModelManager.OPENING_ON_HINGE_PREFIX,ModelManager.WINDOW_PANE_ON_HINGE_PREFIX,ModelManager.MIRROR_ON_HINGE_PREFIX);this.updateSimpleDeformableModelHierarchy(z,null,ModelManager.BALL_PREFIX,ModelManager.ARM_ON_BALL_PREFIX,null,null);this.updateSimpleDeformableModelHierarchy(z,ModelManager.UNIQUE_RAIL_PREFIX,ModelManager.RAIL_PREFIX,ModelManager.OPENING_ON_RAIL_PREFIX,ModelManager.WINDOW_PANE_ON_RAIL_PREFIX,ModelManager.MIRROR_ON_RAIL_PREFIX);var E=[];while(this.updateDeformableModelSubTransformedHierarchy(z,z,[ModelManager.HINGE_PREFIX,ModelManager.BALL_PREFIX,ModelManager.RAIL_PREFIX],[ModelManager.OPENING_ON_HINGE_PREFIX,ModelManager.ARM_ON_BALL_PREFIX,ModelManager.OPENING_ON_RAIL_PREFIX],E)){}}};ModelManager.prototype.updateSimpleDeformableModelHierarchy=function(k,g,j,c,m,l){if(this.containsNode(k,c+1)||(m!==null&&this.containsNode(k,m+1))||(l!==null&&this.containsNode(k,l+1))){if(this.containsNode(k,j+1)){var e=1;do{var h=this.extractNodes(k,j+e,null);var b=this.extractNodes(k,c+e,null);var d=m!==null?this.extractNodes(k,m+e,null):null;var f=l!==null?this.extractNodes(k,l+e,null):null;var a=this.createPickableTransformGroup(j+e,[b,d,f]);k.addChild(h);k.addChild(a);e++}while(this.containsNode(k,j+e)&&(this.containsNode(k,c+e)||(m!==null&&this.containsNode(k,m+e))||(l!==null&&this.containsNode(k,l+e))))}else{if(g!==null&&this.containsNode(k,g)){var h=this.extractNodes(k,g,null);k.addChild(h);var e=1;do{var b=this.extractNodes(k,c+e,null);var d=this.extractNodes(k,m+e,null);var f=this.extractNodes(k,l+e,null);k.addChild(this.createPickableTransformGroup(j+e,[b,d,f]));e++}while(this.containsNode(k,c+e)||this.containsNode(k,m+e)||this.containsNode(k,l+e))}}}};ModelManager.prototype.containsNode=function(c,d){var a=c.getName();if(a!==null&&a.indexOf(d)===0){return true}if(c instanceof Group3D){for(var b=c.getChildren().length-1;b>=0;b--){if(this.containsNode(c.getChild(b),d)){return true}}}return false};ModelManager.prototype.extractNodes=function(d,a,c){if(d.getName()!==null&&d.getName().indexOf(a)===0){d.getParent().removeChild(d);if(c===null){c=new Group3D()}c.addChild(d)}if(d instanceof Group3D){for(var b=d.getChildren().length-1;b>=0;b--){c=this.extractNodes(d.getChild(b),a,c)}}return c};ModelManager.prototype.createPickableTransformGroup=function(d,b){var c=new TransformGroup3D();c.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);c.setName(d+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX);for(var a=0;a<b.length;a++){if(b[a]!==null){c.addChild(b[a])}}return c};ModelManager.prototype.updateDeformableModelSubTransformedHierarchy=function(r,f,a,k,s){if(r!==f&&s.indexOf(f)<0){var b=f.getName();if(b!==null){for(var l=0;l<a.length;l++){var n=a[l];if(b.indexOf(n)===0){var o=b.indexOf(ModelManager.SUB_TRANSFORMATION_SEPARATOR);if(o>0){for(var h=0;h<k.length;h++){var m=b.indexOf(k[h],o+ModelManager.SUB_TRANSFORMATION_SEPARATOR.length);if(m>=0){if(s.indexOf(f)<0){s.push(f)}var p=f.getParent();var q=p.getParent();var g=q.getChildren().indexOf(p);var e=q.getChild(++g);while(!(e instanceof TransformGroup3D)){e=q.getChild(++g)}var c=m+k[h].length;while(c<b.length&&b.charAt(c)>="0"&&b.charAt(c)<="9"){c++}if(this.attachNodesToPickableTransformGroup(r,a[h]+b.substring(m+k[h].length,c),[p,e])){return true}}}}}}}}if(f instanceof Group3D){var d=f.getChildren();for(var l=d.length-1;l>=0;l--){if(this.updateDeformableModelSubTransformedHierarchy(r,d[l],a,k,s)){return true}}}return false};ModelManager.prototype.attachNodesToPickableTransformGroup=function(e,a,g){if(e instanceof TransformGroup3D&&(a+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)==e.getName()){var f=e;for(var c=0;c<g.length;c++){var d=g[c];d.getParent().removeChild(d);f.addChild(d)}return true}else{if(e instanceof Group3D){var b=e.getChildren();for(var c=0;c<b.length;c++){if(this.attachNodesToPickableTransformGroup(b[c],a,g)){return true}}}}return false};ModelManager.prototype.containsDeformableNode=function(c){if(c instanceof TransformGroup3D&&c.getName()!==null&&c.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&c.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===(c.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length)){return true}else{if(c instanceof Group3D){var b=c.getChildren();for(var a=0;a<b.length;a++){if(this.containsDeformableNode(b[a])){return true}}}}return false};ModelManager.prototype.isDeformed=function(d){if(d instanceof TransformGroup3D&&d.getName()!==null&&d.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&d.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===(d.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length)){var a=mat4.create();d.getTransform(a);return !TransformGroup3D.isIdentity(a)}else{if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){if(this.isDeformed(c[b])){return true}}}}return false};ModelManager.prototype.getMaterials=function(n,g,f){if(f===undefined){if(g===undefined){g=false;f=null}else{f=g}}var l=[];this.searchAppearances(n,g,l);var b=[];for(var r=0;r<l.length;r++){var h=l[r];var p=null;var o=null;var k=h.getDiffuseColor();if(k!=null){p=4278190080|(Math.round(k[0]*255)<<16)|(Math.round(k[1]*255)<<8)|Math.round(k[2]*255);o=h.getShininess()!=null?h.getShininess()/128:null}var e=h.getTextureImage();var m=null;if(e!=null){var a=e.url;if(a!=null){var u=new SimpleURLContent(a);var t=a.substring(a.lastIndexOf("/")+1);var c=t.lastIndexOf(".");if(c!==-1){t=t.substring(0,c)}m=new HomeTexture(new CatalogTexture(null,t,u,-1,-1,f))}}var s=h.getName();if(s===undefined){s=null}var d=new HomeMaterial(s,p,m,o);for(var q=0;q<b.length;q++){if(b[q].getName()==d.getName()){d=null;break}}if(d!=null){b.push(d)}}b.sort(function(v,j){var x=v.getName();var w=j.getName();if(x!=null){if(w!=null){return x.localeCompare(w)}else{return 1}}else{if(w!=null){return -1}else{return 0}}});return b};ModelManager.prototype.searchAppearances=function(e,b,f){if(e instanceof Group3D){var d=e.getChildren();for(var c=0;c<d.length;c++){this.searchAppearances(d[c],b,f)}}else{if(e instanceof Link3D){this.searchAppearances(e.getSharedGroup(),b,f)}else{if(e instanceof Shape3D){var a=e.getAppearance();if(a!==null&&(!b||!(a.getName().indexOf(ModelManager.EDGE_COLOR_MATERIAL_PREFIX)===0))&&f.indexOf(a)===-1){f.push(a)}}}}};ModelManager.prototype.replaceMultipleSharedShapes=function(c){var a=[];this.searchSharedShapes(c,a,false);for(var e=0;e<a.length;e++){if(a[e].value>1){var f=[];var g=a[e].key;this.searchShapeTransformations(c,g,f,mat4.create());var k=g.clone();var b=k.getGeometries();for(var d=0;d<b.length;d++){var h=this.getTransformedGeometry(b[d],f);if(h===null){return}k.setGeometry(h,d)}this.removeSharedShape(c,g);c.addChild(k)}}};ModelManager.prototype.searchSharedShapes=function(d,e,a){if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){this.searchSharedShapes(c[b],e,a)}}else{if(d instanceof Link3D){this.searchSharedShapes(d.getSharedGroup(),e,true)}else{if(d instanceof Shape3D){if(a){for(var b=0;b<e.length;b++){if(e[b].key===d){e[b].value++;return}}e.push({key:d,value:1})}}}}};ModelManager.prototype.searchShapeTransformations=function(g,a,c,f){if(g instanceof Group3D){if(!(g instanceof TransformGroup3D)||!this.isDeformed(g)){if(g instanceof TransformGroup3D){f=mat4.clone(f);var b=mat4.create();g.getTransform(b);mat4.mul(f,f,b)}var e=g.getChildren();for(var d=0;d<e.length;d++){this.searchShapeTransformations(e[d],a,c,f)}}}else{if(g instanceof Link3D){this.searchShapeTransformations(g.getSharedGroup(),a,c,f)}else{if(g===a){c.push(f)}}}};ModelManager.prototype.getTransformedGeometry=function(p,h){var a=0;var q=0;var o=new Array(h.length*p.vertexIndices.length);for(var f=0;f<h.length;f++){for(var e=0,c=p.vertexIndices.length;e<c;e++){o[a+e]=q+p.vertexIndices[e]}a+=p.vertexIndices.length;q+=p.vertices.length}var l=new Array(h.length*p.textureCoordinateIndices.length);a=0;for(var f=0;f<h.length;f++){for(var e=0,c=p.textureCoordinateIndices.length;e<c;e++){l[a+e]=p.textureCoordinateIndices[e]}a+=p.textureCoordinateIndices.length}q=0;var d=new Array(h.length*p.vertices.length);for(var f=0;f<h.length;f++){for(var e=0,c=p.vertices.length;e<c;e++){var k=vec3.clone(p.vertices[e]);vec3.transformMat4(k,k,h[f]);d[q+e]=k}q+=p.vertices.length}if(p instanceof IndexedLineArray3D){return new IndexedLineArray3D(d,o,p.textureCoordinates,l)}else{if(p instanceof IndexedTriangleArray3D){var g=new Array(h.length*p.normalIndices.length);a=0;var r=0;for(var f=0;f<h.length;f++){for(var e=0,c=p.normalIndices.length;e<c;e++){g[a+e]=r+p.normalIndices[e]}a+=p.normalIndices.length;r+=p.normals.length}var r=0;var b=new Array(h.length*p.normals.length);for(var f=0;f<h.length;f++){for(var e=0,c=p.normals.length;e<c;e++){var m=vec3.clone(p.normals[e]);vec3.transformMat4(m,m,h[f]);vec3.normalize(m,m);b[r+e]=m}r+=p.normals.length}return new IndexedTriangleArray3D(d,o,p.textureCoordinates,l,b,g)}else{return null}}};ModelManager.prototype.removeSharedShape=function(d,a){if(d instanceof Group3D){if(!(d instanceof TransformGroup3D)||!this.isDeformed(d)){var c=d.getChildren();for(var b=c.length-1;b>=0;b--){this.removeSharedShape(c[b],a)}if(c.length===0&&d.getParent() instanceof Group3D){d.getParent().removeChild(d)}}}else{if(d instanceof Link3D){var e=d.getSharedGroup();this.removeSharedShape(e,a);if(e.children.length==0){d.getParent().removeChild(d)}}else{if(d===a){d.getParent().removeChild(d)}}}};ModelManager.prototype.getFrontArea=function(k,e){var c;if(k!==null){c=new java.awt.geom.Area(this.getShape(k));c.transform(java.awt.geom.AffineTransform.getScaleInstance(1,-1));c.transform(java.awt.geom.AffineTransform.getTranslateInstance(-0.5,0.5))}else{var b=this.getVertexCount(e);if(b<1000000){var f=new java.awt.geom.Area();this.computeBottomOrFrontArea(e,f,mat4.create(),false,false);c=new java.awt.geom.Area();var o=[];var l=null;for(var h=f.getPathIterator(null,1);!h.isDone();h.next()){var j=[0,0];switch(h.currentSegment(j)){case java.awt.geom.PathIterator.SEG_MOVETO:case java.awt.geom.PathIterator.SEG_LINETO:if(l===null||j[0]!==l[0]||j[1]!==l[1]){o.push(j)}l=j;break;case java.awt.geom.PathIterator.SEG_CLOSE:if(o[0][0]===l[0]&&o[0][1]===l[1]){o.splice(o.length-1,1)}if(o.length>2){var m=o.slice(0);var d=new Room(m);if(d.getArea()>0){if(!d.isClockwise()){var n=new java.awt.geom.GeneralPath();n.moveTo(m[0][0],m[0][1]);for(var g=1;g<m.length;g++){n.lineTo(m[g][0],m[g][1])}n.closePath();c.add(new java.awt.geom.Area(n))}}}o.length=0;l=null;break}}var a=f.getBounds2D();c.transform(java.awt.geom.AffineTransform.getTranslateInstance(-a.getCenterX(),-a.getCenterY()));c.transform(java.awt.geom.AffineTransform.getScaleInstance(1/a.getWidth(),1/a.getHeight()))}else{c=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(-0.5,-0.5,1,1))}}return c};ModelManager.prototype.getAreaOnFloor=function(b){if(b instanceof Node3D){var j;var a=this.getVertexCount(b);if(a<10000){j=new java.awt.geom.Area();this.computeBottomOrFrontArea(b,j,mat4.create(),true,true)}else{var h=[];this.computeVerticesOnFloor(b,h,mat4.create());if(h.length>0){var k=this.getSurroundingPolygon(h.slice(0));var e=new java.awt.geom.GeneralPath(java.awt.geom.Path2D.WIND_NON_ZERO,k.length);e.moveTo(k[0][0],k[0][1]);for(var c=0;c<k.length;c++){e.lineTo(k[c][0],k[c][1])}e.closePath();j=new java.awt.geom.Area(e)}else{j=new java.awt.geom.Area()}}return j}else{var g=b;if(g.getStaircaseCutOutShape()===null){throw new IllegalArgumentException("No cut out shape associated to piece")}var f=this.getShape(g.getStaircaseCutOutShape());var d=new java.awt.geom.Area(f);if(g.isModelMirrored()){d=this.getMirroredArea(d)}var l=java.awt.geom.AffineTransform.getTranslateInstance(g.getX()-g.getWidth()/2,g.getY()-g.getDepth()/2);l.concatenate(java.awt.geom.AffineTransform.getRotateInstance(g.getAngle(),g.getWidth()/2,g.getDepth()/2));l.concatenate(java.awt.geom.AffineTransform.getScaleInstance(g.getWidth(),g.getDepth()));d.transform(l);return d}};ModelManager.prototype.getVertexCount=function(f){var e=0;if(f instanceof Group3D){var c=f.getChildren();for(var b=0;b<c.length;b++){e+=this.getVertexCount(c[b])}}else{if(f instanceof Link3D){e=this.getVertexCount(f.getSharedGroup())}else{if(f instanceof Shape3D){var a=f.getAppearance();if(a.isVisible()){var d=f.getGeometries();for(var b=0,h=d.length;b<h;b++){var g=d[b];e+=g.vertices.length}}}}}return e};ModelManager.prototype.computeBottomOrFrontArea=function(f,m,l,h,a){if(f instanceof Group3D){if(f instanceof TransformGroup3D){l=mat4.clone(l);var e=mat4.create();f.getTransform(e);mat4.mul(l,l,e)}var c=f.getChildren();for(var g=0;g<c.length;g++){this.computeBottomOrFrontArea(c[g],m,l,h,a)}}else{if(f instanceof Link3D){this.computeBottomOrFrontArea(f.getSharedGroup(),m,l,h,a)}else{if(f instanceof Shape3D){var j=f.getAppearance();if(j.isVisible()&&(!h||j.getTransparency()===undefined||j.getTransparency()<1)){var b=f.getGeometries();for(var g=0,d=b.length;g<d;g++){var k=b[g];this.computeBottomOrFrontGeometryArea(k,m,l,a)}}}}}};ModelManager.prototype.computeBottomOrFrontGeometryArea=function(c,l,k,b){if(c instanceof IndexedTriangleArray3D){var a=c.vertices.length;var h=new Array(a*2);var f=vec3.create();for(var g=0,e=0;g<h.length;e++){vec3.copy(f,c.vertices[e]);vec3.transformMat4(f,f,k);h[g++]=f[0];if(b){h[g++]=f[2]}else{h[g++]=f[1]}}geometryPath=new java.awt.geom.GeneralPath(java.awt.geom.Path2D.WIND_NON_ZERO,1000);for(var e=0,j=0,d=c.vertexIndices.length;e<d;e+=3){this.addTriangleToPath(c,c.vertexIndices[e],c.vertexIndices[e+1],c.vertexIndices[e+2],h,geometryPath,j++,l)}l.add(new java.awt.geom.Area(geometryPath))}};ModelManager.prototype.addTriangleToPath=function(b,m,k,h,d,c,e,g){var a=d[2*m];var l=d[2*m+1];var o=d[2*k];var j=d[2*k+1];var n=d[2*h];var f=d[2*h+1];if((o-a)*(f-j)-(j-l)*(n-o)>0){if(e>0&&e%1000===0){g.add(new java.awt.geom.Area(c));c.reset()}c.moveTo(a,l);c.lineTo(o,j);c.lineTo(n,f);c.closePath()}};ModelManager.prototype.computeVerticesOnFloor=function(g,p,q){if(g instanceof Group3D){if(g instanceof TransformGroup3D){q=mat4.clone(q);var f=mat4.create();g.getTransform(f);mat4.mul(q,q,f)}var d=g.getChildren();for(var k=0;k<d.length;k++){this.computeVerticesOnFloor(d[k],p,q)}}else{if(g instanceof Link3D){this.computeVerticesOnFloor(g.getSharedGroup(),p,q)}else{if(g instanceof Shape3D){var m=g.getAppearance();if(m.isVisible()&&(m.getTransparency()===undefined||m.getTransparency()<1)){var c=g.getGeometries();for(var k=0,e=c.length;k<e;k++){var b=c[k];var a=b.vertices.length;var l=vec3.create();for(var o=0,h=0;o<a;h++,o++){vec3.copy(l,b.vertices[h]);vec3.transformMat4(l,l,q);p.push([l[0],l[2]])}}}}}}};ModelManager.prototype.getSurroundingPolygon=function(k){k.sort(function(o,n){var p;if(o[0]===n[0]){p=n[1]-o[1]}else{p=n[0]-o[0]}if(p>0){return 1}else{if(p<0){return -1}else{return 0}}});var m=new Array(k.length);var b=0;var l=-1;var f;var a=0;var e;var c=k[0][0];for(f=1;f<k.length;f++){if(k[f][0]!==c){break}}e=f-1;if(e===k.length-1){m[++l]=k[a];if(k[e][1]!==k[a][1]){m[++l]=k[e]}m[++l]=k[a];var j=new Array(l+1);System.arraycopy(m,0,j,0,j.length);return j}var d;var h=k.length-1;var g=k[k.length-1][0];for(f=k.length-2;f>=0;f--){if(k[f][0]!==g){break}}d=f+1;m[++l]=k[a];f=e;while(++f<=d){if(this.isLeft(k[a],k[d],k[f])>=0&&f<d){continue}while(l>0){if(this.isLeft(m[l-1],m[l],k[f])>0){break}else{l--}}m[++l]=k[f]}if(h!==d){m[++l]=k[h]}b=l;f=d;while(--f>=e){if(this.isLeft(k[h],k[e],k[f])>=0&&f>e){continue}while(l>b){if(this.isLeft(m[l-1],m[l],k[f])>0){break}else{l--}}m[++l]=k[f]}if(e!==a){m[++l]=k[a]}var j=new Array(l+1);System.arraycopy(m,0,j,0,j.length);return j};ModelManager.prototype.isLeft=function(c,b,a){return(b[0]-c[0])*(a[1]-c[1])-(a[0]-c[0])*(b[1]-c[1])};ModelManager.prototype.getMirroredArea=function(c){var d=new java.awt.geom.GeneralPath();var a=[0,0,0,0,0,0];for(var b=c.getPathIterator(null);!b.isDone();b.next()){switch(b.currentSegment(a)){case java.awt.geom.PathIterator.SEG_MOVETO:d.moveTo(1-a[0],a[1]);break;case java.awt.geom.PathIterator.SEG_LINETO:d.lineTo(1-a[0],a[1]);break;case java.awt.geom.PathIterator.SEG_QUADTO:d.quadTo(1-a[0],a[1],1-a[2],a[3]);break;case java.awt.geom.PathIterator.SEG_CUBICTO:d.curveTo(1-a[0],a[1],1-a[2],a[3],1-a[4],a[5]);break;case java.awt.geom.PathIterator.SEG_CLOSE:d.closePath();break}}return new java.awt.geom.Area(d)};ModelManager.prototype.getShape=function(a){return ShapeTools.getShape(a)};function ModelPreviewComponent(f,g,d){if(d===undefined){d=false}this.canvas3D=new HTMLCanvas3D(f);this.pickedMaterial=null;this.setDefaultTransform();if(g){var e=0.02;var a=0.02;var c=this;var b={pointerTouches:{},boundedPitch:false,pickedTransformGroup:null,pivotCenterPixel:null,translationFromOrigin:null,translationToOrigin:null,modelBounds:null,mousePressed:function(j){b.mousePressedInCanvas=true;c.stopRotationAnimation();var h=c.getHTMLElement().getBoundingClientRect();b.updatePickedMaterial(j.clientX-h.left,j.clientY-h.top);j.stopPropagation()},windowMouseMoved:function(j){if(b.mousePressedInCanvas){var h=c.getHTMLElement().getBoundingClientRect();b.mouseDragged(j.clientX-h.left,j.clientY-h.top,j.altKey)}},windowMouseReleased:function(h){b.mousePressedInCanvas=false},pointerPressed:function(h){if(h.pointerType=="mouse"){b.mousePressed(h)}else{b.copyPointerToTargetTouches(h);b.touchStarted(h)}},pointerMousePressed:function(h){h.stopPropagation()},windowPointerMoved:function(h){if(h.pointerType=="mouse"){b.windowMouseMoved(h)}else{b.copyPointerToTargetTouches(h);b.touchMoved(h)}},windowPointerReleased:function(h){if(h.pointerType=="mouse"){b.windowMouseReleased(h)}else{delete b.pointerTouches[h.pointerId];b.touchEnded(h)}},touchStarted:function(j){j.preventDefault();if(j.targetTouches.length==1){b.mousePressedInCanvas=true;var h=c.getHTMLElement().getBoundingClientRect();b.updatePickedMaterial(j.targetTouches[0].clientX-h.left,j.targetTouches[0].clientY-h.top)}else{if(j.targetTouches.length==2){b.distanceLastPinch=b.distance(j.targetTouches[0].clientX,j.targetTouches[0].clientY,j.targetTouches[1].clientX,j.targetTouches[1].clientY)}}c.stopRotationAnimation()},touchMoved:function(k){k.preventDefault();if(k.targetTouches.length==1){var j=c.getHTMLElement().getBoundingClientRect();b.mouseDragged(k.targetTouches[0].clientX-j.left,k.targetTouches[0].clientY-j.top,false)}else{if(k.targetTouches.length==2){var h=b.distance(k.targetTouches[0].clientX,k.targetTouches[0].clientY,k.targetTouches[1].clientX,k.targetTouches[1].clientY);var l=b.distanceLastPinch/h;c.setViewScale(Math.max(0.5,Math.min(1.3,c.viewScale*l)));b.distanceLastPinch=h}}},touchEnded:function(h){b.mousePressedInCanvas=false},copyPointerToTargetTouches:function(j){b.pointerTouches[j.pointerId]={clientX:j.clientX,clientY:j.clientY};j.targetTouches=[];for(var h in b.pointerTouches){if(b.pointerTouches.hasOwnProperty(h)){j.targetTouches.push(b.pointerTouches[h])}}},distance:function(j,l,h,k){return Math.sqrt(Math.pow(h-j,2)+Math.pow(k-l,2))},mouseScrolled:function(h){h.preventDefault();b.zoomUpdater(h.detail)},mouseWheelMoved:function(h){h.preventDefault();b.zoomUpdater(h.deltaY!==undefined?h.deltaY/2:-h.wheelDelta/3)},visibilityChanged:function(h){if(document.visibilityState=="hidden"){c.stopRotationAnimation()}},updatePickedMaterial:function(t,s){b.xLastMove=t;b.yLastMove=s;b.pickedTransformGroup=null;b.pivotCenterPixel=null;b.boundedPitch=true;c.pickedMaterial=null;if(typeof HomeMaterial!=="undefined"&&c.getModelNode()!==null){var u=ModelManager.getInstance();if(d){b.boundedPitch=!u.containsDeformableNode(c.getModelNode())}var l=c.getHTMLElement().getBoundingClientRect();var m=c.canvas3D.getClosestShapeAt(t+l.left,s+l.top);if(m!==null){var n=u.getMaterials(m);if(n.length>0){c.pickedMaterial=n[0]}for(var C=m;(C=C.getParent())!==null;){if(C instanceof TransformGroup3D){b.pickedTransformGroup=C;break}}if(d&&b.pickedTransformGroup!=null){var r=b.pickedTransformGroup.getParent();var F=r.getChildren().indexOf(b.pickedTransformGroup)-1;while(F>=0&&(r.getChild(F) instanceof TransformGroup3D)){F--}if(F>=0){var w=r.getChild(F);var B=u.getCenter(w);var k=vec3.clone(B);var J=b.getTransformBetweenNodes(w.getParent(),c.canvas3D.getScene(),false);vec3.transformMat4(k,k,J);var z=c.canvas3D.getVirtualWorldToImageTransform(mat4.create());var v=c.canvas3D.getViewPlatformTransform(mat4.create());mat4.invert(v,v);mat4.mul(z,z,v);vec3.transformMat4(k,k,z);b.pivotCenterPixel=[(k[0]/2+0.5)*l.width,l.height*(0.5-k[1]/2)];var j=b.pickedTransformGroup.getName();b.translationFromOrigin=mat4.create();b.translationFromOrigin[12]=B[0];b.translationFromOrigin[13]=B[1];b.translationFromOrigin[14]=B[2];var G=mat4.create();mat4.fromXRotation(G,c.viewPitch);var E=mat4.create();mat4.fromYRotation(E,c.viewYaw);if(j.indexOf(ModelManager.HINGE_PREFIX)===0||j.indexOf(ModelManager.RAIL_PREFIX)===0){var D=mat4.create();var A=u.getSize(w);var p=b.getModelRoot(w);var q=b.getTransformBetweenNodes(p,c.getModelNode(),true);vec3.transformMat4(A,A,q);A[0]=Math.abs(A[0]);A[1]=Math.abs(A[1]);A[2]=Math.abs(A[2]);var I=mat4.clone(E);mat4.mul(I,I,G);mat4.invert(I,I);if(A[1]>A[0]&&A[1]>A[2]){var h=vec3.fromValues(0,1,0);vec3.transformMat4(h,h,I);if(j.indexOf(ModelManager.RAIL_PREFIX)===0?h[1]>0:h[2]<0){mat4.fromXRotation(D,Math.PI/2)}else{mat4.fromXRotation(D,-Math.PI/2)}}else{if(A[2]>A[0]&&A[2]>A[1]){var o=vec3.fromValues(0,0,1);vec3.transformMat4(o,o,I);if(j.indexOf(ModelManager.RAIL_PREFIX)===0?o[0]>0:o[2]<0){mat4.fromXRotation(D,Math.PI)}}else{var H=vec3.fromValues(1,0,0);vec3.transformMat4(H,H,I);if(j.indexOf(ModelManager.RAIL_PREFIX)===0?H[0]>0:H[2]<0){mat4.fromYRotation(D,-Math.PI/2)}else{mat4.fromYRotation(D,Math.PI/2)}}}mat4.invert(q,q);mat4.mul(b.translationFromOrigin,b.translationFromOrigin,q);mat4.mul(b.translationFromOrigin,b.translationFromOrigin,D)}else{mat4.mul(b.translationFromOrigin,b.translationFromOrigin,mat4.invert(mat4.create(),b.getTransformBetweenNodes(w.getParent(),c.getModelNode(),true)));mat4.mul(b.translationFromOrigin,b.translationFromOrigin,E);mat4.mul(b.translationFromOrigin,b.translationFromOrigin,G)}b.translationToOrigin=mat4.invert(mat4.create(),b.translationFromOrigin);b.modelBounds=u.getBounds(c.getModelNode())}}}}},getTransformBetweenNodes:function(l,k,m){var j=mat4.create();if(l instanceof TransformGroup3D){l.getTransform(j);if(m){j[12]=0;j[13]=0;j[14]=0}}if(l!==k){var h=l.getParent();if(h instanceof Group3D){mat4.mul(j,b.getTransformBetweenNodes(h,k,m),j)}else{throw new IllegalStateException("Can't retrieve node transform")}}return j},getModelRoot:function(h){if(h instanceof Group3D&&h.getUserData() instanceof URLContent){return h}else{if(h.getParent()!=null){return b.getModelRoot(h.getParent())}else{return null}}},mouseDragged:function(q,n,m){if(c.getModelNode()!==null){if(b.pivotCenterPixel!==null){var h=b.pickedTransformGroup.getName();var B=mat4.create();if(h.indexOf(ModelManager.RAIL_PREFIX)===0){mat4.translate(B,B,vec3.fromValues(0,0,b.distance(q,n,b.xLastMove,b.yLastMove)*(b.xLastMove-q<0?-1:(b.xLastMove-q===0?0:1))))}else{var z=Math.atan2(b.pivotCenterPixel[1]-n,q-b.pivotCenterPixel[0])-Math.atan2(b.pivotCenterPixel[1]-b.yLastMove,b.xLastMove-b.pivotCenterPixel[0]);mat4.fromZRotation(B,z)}mat4.mul(B,B,b.translationToOrigin);mat4.mul(B,b.translationFromOrigin,B);var k=mat4.create();b.pickedTransformGroup.getTransform(k);mat4.mul(k,B,k);b.pickedTransformGroup.setTransform(k);var A=vec3.create();b.modelBounds.getLower(A);var u=vec3.create();b.modelBounds.getUpper(u);var s=ModelManager.getInstance();var o=s.getBounds(c.getModelNode());var v=vec3.create();o.getLower(v);var t=vec3.create();o.getUpper(t);var r=c.previewedPiece;r.setX(r.getX()+(t[0]+v[0])/2-(u[0]+A[0])/2);r.setY(r.getY()+(t[2]+v[2])/2-(u[2]+A[2])/2);r.setElevation(r.getElevation()+(v[1]-A[1]));r.setWidth(t[0]-v[0]);r.setDepth(t[2]-v[2]);r.setHeight(t[1]-v[1]);b.modelBounds=o;var j=c.previewedPiece.getModelTransformations();var l=[];if(j!==null){l.push.apply(l,j)}h=h.substring(0,h.length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length);for(var w=0;w<l.length;w++){if(h==l[w].getName()){l.splice(w,1);break}}l.push(new Transformation(h,[[k[0],k[4],k[8],k[12]],[k[1],k[5],k[9],k[13]],[k[2],k[6],k[10],k[14]]]));c.previewedPiece.setModelTransformations(l)}else{if(!m){c.setViewYaw(c.viewYaw-e*(q-b.xLastMove))}if(g&&m){b.zoomUpdater(n-b.yLastMove)}else{if(g&&!m){var p=c.viewPitch-e*(n-b.yLastMove);if(b.boundedPitch){c.setViewPitch(Math.max(-Math.PI/4,Math.min(0,p)))}else{c.setViewPitch(p)}}}}}b.xLastMove=q;b.yLastMove=n},zoomUpdater:function(h){c.setViewScale(Math.max(0.5,Math.min(1.3,c.viewScale*Math.exp(h*a))));c.stopRotationAnimation()}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){this.canvas3D.getHTMLElement().addEventListener("pointerdown",b.pointerPressed);this.canvas3D.getHTMLElement().addEventListener("mousedown",b.pointerMousePressed);window.addEventListener("pointermove",b.windowPointerMoved);window.addEventListener("pointerup",b.windowPointerReleased)}else{this.canvas3D.getHTMLElement().addEventListener("touchstart",b.touchStarted);this.canvas3D.getHTMLElement().addEventListener("touchmove",b.touchMoved);this.canvas3D.getHTMLElement().addEventListener("touchend",b.touchEnded);this.canvas3D.getHTMLElement().addEventListener("mousedown",b.mousePressed);window.addEventListener("mousemove",b.windowMouseMoved);window.addEventListener("mouseup",b.windowMouseReleased)}this.canvas3D.getHTMLElement().addEventListener("DOMMouseScroll",b.mouseScrolled);this.canvas3D.getHTMLElement().addEventListener("mousewheel",b.mouseWheelMoved);document.addEventListener("visibilitychange",b.visibilityChanged);this.userActionsListener=b}}ModelPreviewComponent.prototype.getHTMLElement=function(){return this.canvas3D.getHTMLElement()};ModelPreviewComponent.prototype.setDefaultTransform=function(){this.viewYaw=Math.PI/8;this.viewPitch=-Math.PI/16;this.viewScale=1;this.updateViewPlatformTransform()};ModelPreviewComponent.prototype.getViewYaw=function(){return this.viewYaw};ModelPreviewComponent.prototype.setViewYaw=function(a){this.viewYaw=a;this.updateViewPlatformTransform()};ModelPreviewComponent.prototype.getViewScale=function(){return this.viewScale};ModelPreviewComponent.prototype.setViewScale=function(a){this.viewScale=a;this.updateViewPlatformTransform()};ModelPreviewComponent.prototype.getViewPitch=function(){return this.viewPitch};ModelPreviewComponent.prototype.setViewPitch=function(a){this.viewPitch=a;this.updateViewPlatformTransform()};ModelPreviewComponent.prototype.updateViewPlatformTransform=function(){var b=1.4/Math.tan(Math.PI/8);var e=mat4.create();mat4.translate(e,e,vec3.fromValues(0,0,b));var a=mat4.create();mat4.rotateX(a,a,this.viewPitch);var d=mat4.create();mat4.rotateY(d,d,this.viewYaw);var c=mat4.create();mat4.scale(c,c,vec3.fromValues(this.viewScale,this.viewScale,this.viewScale));mat4.mul(a,a,e);mat4.mul(d,d,a);mat4.mul(c,c,d);this.canvas3D.setViewPlatformTransform(c)};ModelPreviewComponent.prototype.setModel=function(d,f,b,a,c,j,h,g){if(c===undefined&&j===undefined&&h===undefined&&g===undefined){g=a;h=b;b=f;f=0;a=-1;c=-1;j=-1}this.model=d;this.canvas3D.clear();if(typeof HomePieceOfFurniture!=="undefined"){this.previewedPiece=null}if(d!==null){var e=this;ModelManager.getInstance().loadModel(d,{modelUpdated:function(r){if(d===e.model){var k=ModelManager.getInstance();var m=a<0?k.getSize(r):vec3.fromValues(a,j,c);var o=1.8/Math.max(Math.max(m[0],m[2]),m[1]);var l;if(typeof HomePieceOfFurniture!=="undefined"){if(typeof f==="boolean"){f=f?PieceOfFurniture.SHOW_BACK_FACE:0}e.previewedPiece=new HomePieceOfFurniture(new CatalogPieceOfFurniture(null,null,d,m[0],m[2],m[1],0,false,null,null,b,f,null,null,0,0,1,false));e.previewedPiece.setX(0);e.previewedPiece.setY(0);e.previewedPiece.setElevation(-e.previewedPiece.getHeight()/2);var n=mat4.create();mat4.scale(n,n,vec3.fromValues(o,o,o));l=new TransformGroup3D(n);var q=new HomePieceOfFurniture3D(e.previewedPiece,null,true);l.addChild(q)}else{var n=b?k.getRotationTransformation(b):mat4.create();mat4.scale(n,n,vec3.fromValues(o,o,o));mat4.scale(n,n,m);mat4.mul(n,n,k.getNormalizedTransform(r,null,1));l=new TransformGroup3D(n);l.addChild(r)}var p=new BranchGroup3D();p.addChild(l);p.addChild(new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(1.732,-0.8,-1)));p.addChild(new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(-1.732,-0.8,-1)));p.addChild(new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(0,-0.8,1)));p.addChild(new DirectionalLight3D(vec3.fromValues(0.66,0.66,0.66),vec3.fromValues(0,1,0)));p.addChild(new AmbientLight3D(vec3.fromValues(0.2,0.2,0.2)));e.setDefaultTransform();e.canvas3D.setScene(p,g);e.canvas3D.updateViewportSize()}},modelError:function(k){if(d===e.model&&h!==undefined){h(k)}},progression:function(l,m,k){if(d===e.model&&g!==undefined){g(l,m,k)}}})}};ModelPreviewComponent.prototype.getModelNode=function(){var a=this.canvas3D.getScene().getChild(0);if(a.getChildren().length>0){return a.getChild(0)}else{return null}};ModelPreviewComponent.prototype.setModelMaterials=function(a){if(this.previewedPiece!=null){this.previewedPiece.setModelMaterials(a);this.getModelNode().update()}};ModelPreviewComponent.prototype.setModelTransformations=function(a){if(this.previewedPiece!=null){this.previewedPiece.setModelTransformations(a);this.getModelNode().update()}};ModelPreviewComponent.prototype.setPresetModelTransformations=function(c){if(this.previewedPiece!=null){var a=ModelManager.getInstance();var e=a.getBounds(this.getModelNode());var h=vec3.create();e.getLower(h);var b=vec3.create();e.getUpper(b);this.setNodeTransformations(this.getModelNode(),c);var g=a.getBounds(this.getModelNode());var d=vec3.create();g.getLower(d);var f=vec3.create();g.getUpper(f);this.previewedPiece.setX(this.previewedPiece.getX()+(f[0]+d[0])/2-(b[0]+h[0])/2);this.previewedPiece.setY(this.previewedPiece.getY()+(f[2]+d[2])/2-(b[2]+h[2])/2);this.previewedPiece.setElevation(this.previewedPiece.getElevation()+(d[1]-h[1]));this.previewedPiece.setWidth(f[0]-d[0]);this.previewedPiece.setDepth(f[2]-d[2]);this.previewedPiece.setHeight(f[1]-d[1]);this.previewedPiece.setModelTransformations(c)}};ModelPreviewComponent.prototype.resetModelTransformations=function(){this.setPresetModelTransformations(null)};ModelPreviewComponent.prototype.setNodeTransformations=function(g,c){if(g instanceof Group3D){if(g instanceof TransformGroup3D&&g.getName()!==null&&g.getName().lastIndexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===g.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length){g.setTransform(mat4.create());if(c!=null){var h=g.getName();h=h.substring(0,h.length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length);for(var e=0;e<c.length;e++){var f=c[e];if(h==f.getName()){var a=f.getMatrix();var b=mat4.create();mat4.set(b,a[0][0],a[1][0],a[2][0],0,a[0][1],a[1][1],a[2][1],0,a[0][2],a[1][2],a[2][2],0,a[0][3],a[1][3],a[2][3],1);g.setTransform(b)}}}}var d=g.getChildren();for(var e=0;e<d.length;e++){this.setNodeTransformations(d[e],c)}}};ModelPreviewComponent.prototype.getModelTransformations=function(){if(this.previewedPiece!=null){return this.previewedPiece.getModelTransformations()}else{return null}};ModelPreviewComponent.prototype.getModelX=function(){return this.previewedPiece.getX()};ModelPreviewComponent.prototype.getModelY=function(){return this.previewedPiece.getY()};ModelPreviewComponent.prototype.getModelElevation=function(){return this.previewedPiece.getElevation()};ModelPreviewComponent.prototype.getModelWidth=function(){return this.previewedPiece.getWidth()};ModelPreviewComponent.prototype.getModelDepth=function(){return this.previewedPiece.getDepth()};ModelPreviewComponent.prototype.getModelHeight=function(){return this.previewedPiece.getHeight()};ModelPreviewComponent.prototype.getPickedMaterial=function(){return this.pickedMaterial};ModelPreviewComponent.prototype.clear=function(){this.stopRotationAnimation();this.canvas3D.clear()};ModelPreviewComponent.prototype.dispose=function(){if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){window.removeEventListener("pointermove",this.userActionsListener.windowPointerMoved);window.removeEventListener("pointerup",this.userActionsListener.windowPointerReleased)}else{window.removeEventListener("mousemove",this.userActionsListener.windowMouseMoved);window.removeEventListener("mouseup",this.userActionsListener.windowMouseReleased)}document.removeEventListener("visibilitychange",this.userActionsListener.visibilityChanged);this.clear()};ModelPreviewComponent.prototype.startRotationAnimation=function(a){this.roundsPerMinute=a!==undefined?a:5;if(!this.rotationAnimationStarted){this.rotationAnimationStarted=true;this.animate()}};ModelPreviewComponent.prototype.animate=function(){if(this.rotationAnimationStarted){var b=Date.now();if(this.lastRotationAnimationTime!==undefined){var a=this.roundsPerMinute*2*Math.PI/60000;this.viewYaw+=((b-this.lastRotationAnimationTime)*a)%(2*Math.PI);this.updateViewPlatformTransform()}this.lastRotationAnimationTime=b;var c=this;requestAnimationFrame(function(){c.animate()})}};ModelPreviewComponent.prototype.stopRotationAnimation=function(){delete this.lastRotationAnimationTime;delete this.rotationAnimationStarted};var ShapeTools={parsedShapes:{}};ShapeTools.getStroke=function(h,j,d,a,b){var f;switch(j){case Polyline.CapStyle.ROUND:f=java.awt.BasicStroke.CAP_ROUND;break;case Polyline.CapStyle.SQUARE:f=java.awt.BasicStroke.CAP_SQUARE;break;default:f=java.awt.BasicStroke.CAP_BUTT;break}var e;switch(d){case Polyline.JoinStyle.ROUND:case Polyline.JoinStyle.CURVED:e=java.awt.BasicStroke.JOIN_ROUND;break;case Polyline.JoinStyle.BEVEL:e=java.awt.BasicStroke.JOIN_BEVEL;break;default:e=java.awt.BasicStroke.JOIN_MITER;break}var g=0;if(a!=null){if(!Array.isArray(a)){a=undefined;g=undefined}else{a=a.slice(0);for(var c=0;c<a.length;c++){a[c]*=h;g+=a[c]}g*=b}}return new java.awt.BasicStroke(h,f,e,10,a,g)};ShapeTools.getPolylineShape=function(o,j,h){if(j){var c=new java.awt.geom.GeneralPath();for(var f=0,a=h?o.length:o.length-1;f<a;f++){var g=new java.awt.geom.CubicCurve2D.Float();var d=o[f===0?o.length-1:f-1];var m=o[f];var k=o[f===o.length-1?0:f+1];var l=[k[0]-d[0],k[1]-d[1]];var b=o[(f+2)%o.length];var e=[m[0]-b[0],m[1]-b[1]];g.setCurve(m[0],m[1],m[0]+(f!==0||h?l[0]/3.625:0),m[1]+(f!==0||h?l[1]/3.625:0),k[0]+(f!==o.length-2||h?e[0]/3.625:0),k[1]+(f!==o.length-2||h?e[1]/3.625:0),k[0],k[1]);c.append(g,true)}return c}else{return ShapeTools.getShape(o,h,null)}};ShapeTools.getShape=function(j,e,c){if(j instanceof Array){var k=new java.awt.geom.GeneralPath();k.moveTo(Math.fround(j[0][0]),Math.fround(j[0][1]));for(var d=1;d<j.length;d++){k.lineTo(Math.fround(j[d][0]),Math.fround(j[d][1]))}if(e){k.closePath()}if(c!=null){k.transform(c)}return k}else{var g=j;var b=ShapeTools.parsedShapes[g];if(!b){b=new java.awt.geom.Rectangle2D.Float(0,0,1,1);try{var a=new org.apache.batik.parser.AWTPathProducer();var h=new org.apache.batik.parser.PathParser();h.setPathHandler(a);h.parse(g);b=a.getShape()}catch(f){}ShapeTools.parsedShapes[g]=b}return b}};function HomeComponent3D(e,d,c,b,a){this.home=d;this.preferences=c;this.object3dFactory=b!==null?b:new Object3DBranchFactory(c);this.homeObjects=[];this.homeObjects3D=[];this.sceneLights=[];this.camera=null;this.windowResizeListener=null;this.preferencesChangeListener=null;this.cameraChangeListener=null;this.homeCameraListener=null;this.groundChangeListener=null;this.backgroundChangeListener=null;this.lightColorListener=null;this.elevationChangeListener=null;this.wallsAlphaListener=null;this.selectionListener=null;this.levelListener=null;this.levelChangeListener=null;this.wallListener=null;this.wallChangeListener=null;this.furnitureListener=null;this.furnitureChangeListener=null;this.roomListener=null;this.roomChangeListener=null;this.polylineChangeListener=null;this.polylineListener=null;this.dimensionLineChangeListener=null;this.dimensionLineListener=null;this.labelChangeListener=null;this.labelListener=null;this.approximateHomeBoundsCache=null;this.homeHeightCache=null;this.createComponent3D(e,c,a)}HomeComponent3D.__interfaces=["com.eteks.sweethome3d.viewcontroller.View3D","com.eteks.sweethome3d.viewcontroller.View"];HomeComponent3D.LONG_TOUCH_DELAY=200;HomeComponent3D.LONG_TOUCH_DELAY_WHEN_DRAGGING=400;HomeComponent3D.LONG_TOUCH_DURATION_AFTER_DELAY=800;HomeComponent3D.DOUBLE_TOUCH_DELAY=500;HomeComponent3D.prototype.createComponent3D=function(d,c,a){this.canvas3D=new HTMLCanvas3D(d);var b=this;if(a){this.addMouseListeners(a,c,this.canvas3D);if(c!==null){this.navigationPanelId=this.createNavigationPanel(this.home,c,a);this.setNavigationPanelVisible(c.isNavigationPanelVisible());this.preferencesChangeListener=function(e){b.setNavigationPanelVisible(e.getNewValue())};c.addPropertyChangeListener("NAVIGATION_PANEL_VISIBLE",this.preferencesChangeListener);this.editingIn3DViewChangeListener=function(e){b.updateObjectsAndFurnitureGroups(b.home.getSelectedItems())};c.addPropertyChangeListener("EDITING_IN_3D_VIEW_ENABLED",this.editingIn3DViewChangeListener)}this.createActions(a);this.installKeyboardActions()}this.updateView(this.home.getCamera());this.updateViewPlatformTransform(this.home.getCamera(),false);this.addCameraListeners();this.canvas3D.setScene(this.createSceneTree(true,false));this.unitChangeListener=function(e){b.updateObjects(b.home.getDimensionLines())};c.addPropertyChangeListener("UNIT",this.unitChangeListener)};HomeComponent3D.prototype.getHTMLElement=function(){return this.canvas3D.getHTMLElement()};HomeComponent3D.prototype.disposeGeometries=function(){if(this.home.structure){ModelManager.getInstance().unloadModel(this.home.structure,true)}ModelManager.getInstance().disposeGeometries(this.canvas3D.getScene())};HomeComponent3D.prototype.revalidate=function(){var a=this.canvas3D.getHTMLElement();var b=a.getBoundingClientRect();if(this.navigationPanelId!=null){navigationPanelDiv=document.getElementById(this.navigationPanelId);if(navigationPanelDiv!==undefined&&navigationPanelDiv.style!==undefined){navigationPanelDiv.style.left=(b.left+window.pageXOffset)+"px";navigationPanelDiv.style.top=(b.top+window.pageYOffset)+"px"}}this.canvas3D.updateViewportSize()};HomeComponent3D.prototype.createNavigationPanel=function(l,g,h){var a=this.getSimulatedKeyElements(document.getElementsByTagName("body")[0]);var j=null;var b;try{b=g.getLocalizedString("HomeComponent3D","navigationPanel.innerHTML")}catch(k){b='<img src="'+ZIPTools.getScriptFolder("gl-matrix-min.js")+'navigationPanel.png"     style="width: 56px; height:59px; margin:5px; user-drag: none; user-select: none; -moz-user-select: none; -webkit-user-drag: none; -webkit-user-select: none; -ms-user-select: none;"     usemap="#navigationPanelMap"/><map name="navigationPanelMap" id="navigationPanelMap">  <area shape="poly" coords="28,4,33,8,33,19,22,19,22,8,29,4" data-simulated-key="UP" />  <area shape="poly" coords="4,28,8,23,19,23,19,34,8,34,4,29" data-simulated-key="LEFT" />  <area shape="poly" coords="28,54,33,50,33,39,22,39,22,50,29,54" data-simulated-key="DOWN" />  <area shape="poly" coords="51,28,47,23,36,23,36,34,47,34,51,29" data-simulated-key="RIGHT" />  <area shape="poly" coords="28,22,33,26,33,28,22,28,22,26,29,22" data-simulated-key="PAGE_UP" />  <area shape="poly" coords="28,36,33,32,33,30,22,30,22,32,29,36" data-simulated-key="PAGE_DOWN" /></map>'}var m=this;if(b!==null){j=document.createElement("div");j.setAttribute("id","div"+Math.floor(Math.random()*10000000000));j.style.position="absolute";this.windowResizeListener=function(n){m.revalidate()};window.addEventListener("resize",this.windowResizeListener);var d=0;for(var f=this.canvas3D.getHTMLElement();f&&f.style&&isNaN(d=parseInt(f.style.zIndex));f=f.parentElement){}j.style.zIndex=isNaN(d)?"1":(d+1).toString();j.style.visibility="hidden";j.innerHTML=b;a.push.apply(a,this.getSimulatedKeyElements(j));var c=document.getElementsByTagName("body")[0];c.insertBefore(j,c.firstChild);j.addEventListener("mousedown",function(n){m.mouseListener.mousePressed(n)})}this.simulatedEventListener={mousePressed:function(p){var r=p.target;var n=function(){var t=r.getAttribute("data-simulated-key");var s=t.substring(t.indexOf(":")+1);var u="";if(p.ctrlKey||s.indexOf("control ")!=-1){u+="control "}if(p.altKey||s.indexOf("alt ")!=-1){u+="alt "}if(p.metaKey||s.indexOf("meta ")!=-1){u+="meta "}if(p.shiftKey||s.indexOf("shift ")!=-1){u+="shift "}u+="pressed "+s;m.callAction(p,u)};var q=function(s){window.clearInterval(o);if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){r.removeEventListener("pointerup",q);r.removeEventListener("pointerleave",q)}else{r.removeEventListener("touchend",q);r.removeEventListener("mouseup",q);r.removeEventListener("mouseleave",q)}m.mouseListener.windowMouseReleased(s);s.stopPropagation()};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){r.addEventListener("pointerup",q);r.addEventListener("pointerleave",q)}else{r.addEventListener("touchend",q);r.addEventListener("mouseup",q);r.addEventListener("mouseleave",q)}n();var o=window.setInterval(n,80)},pointerMousePressed:function(n){n.stopPropagation()},touchStarted:function(n){n.preventDefault();m.simulatedEventListener.mousePressed(n)}};for(var e=0;e<a.length;e++){if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){a[e].addEventListener("pointerdown",this.simulatedEventListener.mousePressed);a[e].addEventListener("mousedown",this.simulatedEventListener.pointerMousePressed)}else{a[e].addEventListener("touchstart",this.simulatedEventListener.touchStarted);a[e].addEventListener("mousedown",this.simulatedEventListener.mousePressed)}}if(j!==null){return j.getAttribute("id")}else{return null}};HomeComponent3D.prototype.getSimulatedKeyElements=function(c){var e=[];if(c.hasChildNodes()){for(var b=0;b<c.childNodes.length;b++){var d=c.childNodes[b];if(d.hasAttribute&&d.hasAttribute("data-simulated-key")){var a=d.getAttribute("data-simulated-key");if(a.indexOf(":")===-1||a.indexOf(this.canvas3D.getHTMLElement().getAttribute("id")+":")===0){e.push(d)}}e.push.apply(e,this.getSimulatedKeyElements(d))}}return e};HomeComponent3D.prototype.setNavigationPanelVisible=function(a){if(this.navigationPanelId!=null){document.getElementById(this.navigationPanelId).style.visibility=a?"visible":"hidden";if(a){this.revalidate()}}};HomeComponent3D.prototype.removeHomeListeners=function(){this.home.removePropertyChangeListener("CAMERA",this.homeCameraListener);var h=this.home.getEnvironment();h.removePropertyChangeListener("SKY_COLOR",this.backgroundChangeListener);h.removePropertyChangeListener("SKY_TEXTURE",this.backgroundChangeListener);h.removePropertyChangeListener("GROUND_COLOR",this.backgroundChangeListener);h.removePropertyChangeListener("GROUND_TEXTURE",this.backgroundChangeListener);h.removePropertyChangeListener("GROUND_COLOR",this.groundChangeListener);h.removePropertyChangeListener("GROUND_TEXTURE",this.groundChangeListener);h.removePropertyChangeListener("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",this.groundChangeListener);this.home.removePropertyChangeListener("BACKGROUND_IMAGE",this.groundChangeListener);h.removePropertyChangeListener("LIGHT_COLOR",this.lightColorListener);h.removePropertyChangeListener("WALLS_ALPHA",this.wallsAlphaListener);this.home.getCamera().removePropertyChangeListener(this.cameraChangeListener);this.home.removePropertyChangeListener("CAMERA",this.elevationChangeListener);this.home.getCamera().removePropertyChangeListener(this.elevationChangeListener);this.home.removeSelectionListener(this.selectionListener);this.home.removeLevelsListener(this.levelListener);var j=this.home.getLevels();for(var e=0;e<j.length;e++){j[e].removePropertyChangeListener(this.levelChangeListener)}this.home.removeWallsListener(this.wallListener);var a=this.home.getWalls();for(var e=0;e<a.length;e++){a[e].removePropertyChangeListener(this.wallChangeListener)}this.home.removeFurnitureListener(this.furnitureListener);var g=this.home.getFurniture();for(var e=0;e<g.length;e++){this.removePropertyChangeListener(g[e],this.furnitureChangeListener)}this.home.removeRoomsListener(this.roomListener);var b=this.home.getRooms();for(var e=0;e<b.length;e++){b[e].removePropertyChangeListener(this.roomChangeListener)}this.home.removePolylinesListener(this.polylineListener);var c=this.home.getPolylines();for(var e=0;e<c.length;e++){c[e].removePropertyChangeListener(this.polylineChangeListener)}this.home.removeDimensionLinesListener(this.dimensionLineListener);var d=this.home.getDimensionLines();for(var e=0;e<d.length;e++){d[e].removePropertyChangeListener(this.dimensionLineChangeListener)}this.home.removeLabelsListener(this.labelListener);var f=this.home.getLabels();for(var e=0;e<f.length;e++){f[e].removePropertyChangeListener(this.labelChangeListener)}};HomeComponent3D.prototype.removeMouseListeners=function(a){if(this.mouseListener){if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){a.getHTMLElement().removeEventListener("pointerdown",this.mouseListener.pointerPressed);a.getHTMLElement().removeEventListener("mousedown",this.mouseListener.pointerMousePressed);a.getHTMLElement().removeEventListener("dblclick",this.mouseListener.mouseDoubleClicked);window.removeEventListener("pointermove",this.mouseListener.windowPointerMoved);window.removeEventListener("pointerup",this.mouseListener.windowPointerReleased)}else{a.getHTMLElement().removeEventListener("touchstart",this.mouseListener.touchStarted);a.getHTMLElement().removeEventListener("touchmove",this.mouseListener.touchMoved);a.getHTMLElement().removeEventListener("touchend",this.mouseListener.touchEnded);a.getHTMLElement().removeEventListener("mousedown",this.mouseListener.mousePressed);a.getHTMLElement().removeEventListener("dblclick",this.mouseListener.mouseDoubleClicked);window.removeEventListener("mousemove",this.mouseListener.windowMouseMoved);window.removeEventListener("mouseup",this.mouseListener.windowMouseReleased)}a.getHTMLElement().removeEventListener("contextmenu",this.mouseListener.contextMenuDisplayed);a.getHTMLElement().removeEventListener("DOMMouseScroll",this.mouseListener.mouseScrolled);a.getHTMLElement().removeEventListener("mousewheel",this.mouseListener.mouseWheelMoved)}};HomeComponent3D.prototype.dispose=function(){this.removeHomeListeners();this.removeMouseListeners(this.canvas3D);if(this.navigationPanelId!=null){this.preferences.removePropertyChangeListener("NAVIGATION_PANEL_VISIBLE",this.preferencesChangeListener);window.removeEventListener("resize",this.windowResizeListener);var c=this.getSimulatedKeyElements(document.getElementsByTagName("body")[0]);for(var b=0;b<c.length;b++){if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){c[b].removeEventListener("pointerdown",this.simulatedEventListener.mousePressed);c[b].removeEventListener("mousedown",this.simulatedEventListener.pointerMousePressed)}else{c[b].removeEventListener("touchstart",this.simulatedEventListener.touchStarted);c[b].removeEventListener("mousedown",this.simulatedEventListener.mousePressed)}}var a=document.getElementById(this.navigationPanelId);a.parentElement.removeChild(a);this.navigationPanelId=null}this.preferences.removePropertyChangeListener("EDITING_IN_3D_VIEW_ENABLED",this.editingIn3DViewChangeListener);this.preferences.removePropertyChangeListener("UNIT",this.unitChangeListener);this.canvas3D.clear()};HomeComponent3D.prototype.addCameraListeners=function(){var a=this;var b=this.home;this.cameraChangeListener=function(c){if(!a.cameraChangeListener.updater){a.cameraChangeListener.updater=function(){if(a.canvas3D){a.updateView(b.getCamera());a.updateViewPlatformTransform(b.getCamera(),true)}delete a.cameraChangeListener.updater};setTimeout(a.cameraChangeListener.updater,0)}};b.getCamera().addPropertyChangeListener(this.cameraChangeListener);this.homeCameraListener=function(c){a.updateView(b.getCamera());a.updateViewPlatformTransform(b.getCamera(),false);c.getOldValue().removePropertyChangeListener(a.cameraChangeListener);b.getCamera().addPropertyChangeListener(a.cameraChangeListener)};this.home.addPropertyChangeListener("CAMERA",this.homeCameraListener)};HomeComponent3D.prototype.updateView=function(k){var g=k.getFieldOfView();if(g===0){g=Math.PI*63/180}this.canvas3D.setFieldOfView(g);var l=2.5;var d=500000;if(this.canvas3D.getDepthBits()<=16){var d=3000;var e=this.getApproximateHomeBounds();if(e!=null&&!e.intersect(vec3.fromValues(k.getX(),k.getY(),k.getZ()))){var a=this.getDistanceToBox(k.getX(),k.getY(),k.getZ(),e);if(!isNaN(a)){l=Math.max(l,0.1*a)}}}else{var b=this.getHomeHeight();if(k.getZ()>b){l=Math.max(l,(k.getZ()-b)/10)}}var j=this.canvas3D.getHTMLElement().getBoundingClientRect();if(k.getZ()>0&&j.width!==0&&j.height!==0){var f=Math.atan(Math.tan(g/2)*j.height/j.width);var h=k.getPitch()+f;if(h>0){var c=(k.getZ()/Math.sin(h));l=Math.min(l,0.35*c);if(l*d<c){l=c/d}}}this.canvas3D.setFrontClipDistance(l);this.canvas3D.setBackClipDistance(l*d)};HomeComponent3D.prototype.getApproximateHomeBounds=function(){if(this.approximateHomeBoundsCache===null){var b=null;var h=this.home.getFurniture();for(var q=0;q<h.length;q++){var a=h[q];if(a.isVisible()&&(a.getLevel()===null||a.getLevel().isViewable())){var x=Math.max(a.getWidthInPlan(),a.getDepthInPlan())/2;var m=a.getGroundElevation();var g=vec3.fromValues(a.getX()-x,a.getY()-x,m);if(b===null){b=new BoundingBox3D(g,g)}else{b.combine(g)}b.combine(vec3.fromValues(a.getX()+x,a.getY()+x,m+a.getHeightInPlan()))}}var w=this.home.getWalls();for(var q=0;q<w.length;q++){var r=w[q];if(r.getLevel()===null||r.getLevel().isViewable()){var l=vec3.fromValues(r.getXStart(),r.getYStart(),r.getLevel()!==null?r.getLevel().getElevation():0);if(b===null){b=new BoundingBox3D(l,l)}else{b.combine(l)}b.combine(vec3.fromValues(r.getXEnd(),r.getYEnd(),l.z+(r.getHeight()!==null?r.getHeight():this.home.getWallHeight())))}}var v=this.home.getRooms();for(var q=0;q<v.length;q++){var s=v[q];if(s.getLevel()===null||s.getLevel().isViewable()){var u=vec3.fromValues(s.getXCenter(),s.getYCenter(),s.getLevel()!==null?s.getLevel().getElevation():0);if(b===null){b=new BoundingBox3D(u,u)}else{b.combine(u)}}}var f=this.home.getDimensionLines();for(var q=0;q<f.length;q++){var d=f[q];if((d.getLevel()==null||d.getLevel().isViewable())&&d.isVisibleIn3D()){var o=d.getLevel()!=null?d.getLevel().getElevation():0;var l=vec3.fromValues(d.getXStart(),d.getYStart(),o+d.getElevationStart());if(b==null){b=new BoundingBox3D(l,l)}else{b.combine(l)}b.combine(vec3.fromValues(d.getXEnd(),d.getYEnd(),o+d.getElevationEnd()))}}var t=this.home.getLabels();for(var q=0;q<t.length;q++){var e=t[q];if((e.getLevel()===null||e.getLevel().isViewable())&&e.getPitch()!==null){var u=vec3.fromValues(e.getX(),e.getY(),e.getGroundElevation());if(b==null){b=new BoundingBox3D(u,u)}else{b.combine(u)}}}var c=this.home.getPolylines();for(var q=0;q<c.length;q++){var k=c[q];if((k.getLevel()==null||k.getLevel().isViewable())&&k.isVisibleIn3D()){var p=k.getPoints();for(var n=0;n<p.length;n++){var y=vec3.fromValues(p[n][0],p[n][1],k.getGroundElevation());if(b==null){b=new BoundingBox3D(y,y)}else{b.combine(y)}}}}this.approximateHomeBoundsCache=b}return this.approximateHomeBoundsCache};HomeComponent3D.prototype.getDistanceToBox=function(h,g,f,d){var j=vec3.fromValues(h,g,f);var c=vec3.create();d.getLower(c);var k=vec3.create();d.getUpper(k);var m=[vec3.fromValues(c[0],c[1],c[2]),vec3.fromValues(k[0],c[1],c[2]),vec3.fromValues(c[0],k[1],c[2]),vec3.fromValues(k[0],k[1],c[2]),vec3.fromValues(c[0],c[1],k[2]),vec3.fromValues(k[0],c[1],k[2]),vec3.fromValues(c[0],k[1],k[2]),vec3.fromValues(k[0],k[1],k[2])];var e=new Array(m.length);for(var b=0;b<e.length;b++){e[b]=vec3.squaredDistance(j,m[b])}var l=[this.getDistanceToSide(j,m,e,0,1,3,2,2),this.getDistanceToSide(j,m,e,0,1,5,4,1),this.getDistanceToSide(j,m,e,0,2,6,4,0),this.getDistanceToSide(j,m,e,4,5,7,6,2),this.getDistanceToSide(j,m,e,2,3,7,6,1),this.getDistanceToSide(j,m,e,1,3,7,5,0)];var a=l[0];for(var b=1;b<l.length;b++){a=Math.min(a,l[b])}return a};HomeComponent3D.prototype.getDistanceToSide=function(j,k,l,h,g,e,c,a){switch(a){case 0:if(j[1]<=k[h][1]){if(j[2]<=k[h][2]){return Math.sqrt(l[h])}else{if(j[2]>=k[c][2]){return Math.sqrt(l[c])}else{return this.getDistanceToLine(j,k[h],k[c])}}}else{if(j[1]>=k[g][1]){if(j[2]<=k[g][2]){return Math.sqrt(l[g])}else{if(j[2]>=k[e][2]){return Math.sqrt(l[e])}else{return this.getDistanceToLine(j,k[g],k[e])}}}else{if(j[2]<=k[h][2]){return this.getDistanceToLine(j,k[h],k[g])}else{if(j[2]>=k[c][2]){return this.getDistanceToLine(j,k[e],k[c])}}}}break;case 1:if(j[0]<=k[h][0]){if(j[2]<=k[h][2]){return Math.sqrt(l[h])}else{if(j[2]>=k[c][2]){return Math.sqrt(l[c])}else{return this.getDistanceToLine(j,k[h],k[c])}}}else{if(j[0]>=k[g][0]){if(j[2]<=k[g][2]){return Math.sqrt(l[g])}else{if(j[2]>=k[e][2]){return Math.sqrt(l[e])}else{return this.getDistanceToLine(j,k[g],k[e])}}}else{if(j[2]<=k[h][2]){return this.getDistanceToLine(j,k[h],k[g])}else{if(j[2]>=k[c][2]){return this.getDistanceToLine(j,k[e],k[c])}}}}break;case 2:if(j[0]<=k[h][0]){if(j[1]<=k[h][1]){return Math.sqrt(l[h])}else{if(j[1]>=k[c][1]){return Math.sqrt(l[c])}else{return this.getDistanceToLine(j,k[h],k[c])}}}else{if(j[0]>=k[g][0]){if(j[1]<=k[g][1]){return Math.sqrt(l[g])}else{if(j[1]>=k[e][1]){return Math.sqrt(l[e])}else{return this.getDistanceToLine(j,k[g],k[e])}}}else{if(j[1]<=k[h][1]){return this.getDistanceToLine(j,k[h],k[g])}else{if(j[1]>=k[c][1]){return this.getDistanceToLine(j,k[e],k[c])}}}}break}var d=vec3.fromValues(k[g][0]-k[h][0],k[g][1]-k[h][1],k[g][2]-k[h][2]);var b=vec3.fromValues(k[e][0]-k[h][0],k[e][1]-k[h][1],k[e][2]-k[h][2]);var f=vec3.create();vec3.cross(f,d,b);return Math.abs(vec3.dot(f,vec3.fromValues(k[h][0]-j[0],k[h][1]-j[1],k[h][2]-j[2])))/vec3.length(f)};HomeComponent3D.prototype.getDistanceToLine=function(a,e,d){var f=vec3.fromValues(d[0]-e[0],d[1]-e[1],d[2]-e[2]);var b=vec3.fromValues(a[0]-e[0],a[1]-e[1],a[2]-e[2]);var c=vec3.create();vec3.cross(c,f,b);return vec3.length(c)/vec3.length(f)};HomeComponent3D.prototype.getHomeHeight=function(){if(this.homeHeightCache===null){var b=0;var k=this.home.getFurniture();for(var h=0;h<k.length;h++){var q=k[h];if(q.isVisible()&&(q.getLevel()==null||q.getLevel().isViewable())){b=Math.max(b,q.getGroundElevation()+q.getHeight())}}var d=this.home.getWalls();for(var h=0;h<d.length;h++){var n=d[h];if(n.getLevel()==null||n.getLevel().isViewable()){var p=n.getLevel()!=null?n.getLevel().getElevation():0;if(n.getHeight()!=null){b=Math.max(b,p+n.getHeight());if(n.getHeightAtEnd()!=null){b=Math.max(b,p+n.getHeightAtEnd())}}else{b=Math.max(b,p+this.home.getWallHeight())}}}var f=this.home.getRooms();for(var h=0;h<f.length;h++){var a=f[h];if(a.getLevel()!=null&&a.getLevel().isViewable()){b=Math.max(b,a.getLevel().getElevation())}}var e=this.home.getPolylines();for(var h=0;h<e.length;h++){var m=e[h];if(m.isVisibleIn3D()&&(m.getLevel()==null||m.getLevel().isViewable())){b=Math.max(b,m.getGroundElevation())}}var g=this.home.getDimensionLines();for(var h=0;h<g.length;h++){var o=g[h];if(o.isVisibleIn3D()&&(o.getLevel()==null||o.getLevel().isViewable())){var c=o.getLevel()!=null?o.getLevel().getElevation():0;b=Math.max(b,c+Math.max(o.getElevationStart(),o.getElevationEnd()))}}var j=this.home.getLabels();for(var h=0;h<j.length;h++){var l=j[h];if(l.getPitch()!=null&&(l.getLevel()==null||l.getLevel().isViewable())){b=Math.max(b,l.getGroundElevation())}}this.homeHeightCache=b}return this.homeHeightCache};HomeComponent3D.prototype.updateViewPlatformTransform=function(b,a){if(a){this.moveCameraWithAnimation(b)}else{delete this.cameraInterpolator;var c=mat4.create();this.computeViewPlatformTransform(c,b.getX(),b.getY(),b.getZ(),b.getYaw(),b.getPitch());this.canvas3D.setViewPlatformTransform(c)}};HomeComponent3D.prototype.moveCameraWithAnimation=function(c){if(this.cameraInterpolator===undefined){this.cameraInterpolator={initialCamera:null,finalCamera:null,alpha:null}}if(this.cameraInterpolator.finalCamera===null||this.cameraInterpolator.finalCamera.getX()!==c.getX()||this.cameraInterpolator.finalCamera.getY()!==c.getY()||this.cameraInterpolator.finalCamera.getZ()!==c.getZ()||this.cameraInterpolator.finalCamera.getYaw()!==c.getYaw()||this.cameraInterpolator.finalCamera.getPitch()!==c.getPitch()){if(this.cameraInterpolator.alpha===null||this.cameraInterpolator.alpha===1){this.cameraInterpolator.initialCamera=new Camera(this.camera.getX(),this.camera.getY(),this.camera.getZ(),this.camera.getYaw(),this.camera.getPitch(),this.camera.getFieldOfView())}else{if(this.cameraInterpolator.alpha<0.3){var b=mat4.create();this.computeViewPlatformTransform(b,this.cameraInterpolator.finalCamera.getX(),this.cameraInterpolator.finalCamera.getY(),this.cameraInterpolator.finalCamera.getZ(),this.cameraInterpolator.finalCamera.getYaw(),this.cameraInterpolator.finalCamera.getPitch());this.canvas3D.setViewPlatformTransform(b);this.cameraInterpolator.initialCamera=this.cameraInterpolator.finalCamera}else{this.cameraInterpolator.initialCamera=new Camera(this.cameraInterpolator.initialCamera.getX()+(this.cameraInterpolator.finalCamera.getX()-this.cameraInterpolator.initialCamera.getX())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getY()+(this.cameraInterpolator.finalCamera.getY()-this.cameraInterpolator.initialCamera.getY())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getZ()+(this.cameraInterpolator.finalCamera.getZ()-this.cameraInterpolator.initialCamera.getZ())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getYaw()+(this.cameraInterpolator.finalCamera.getYaw()-this.cameraInterpolator.initialCamera.getYaw())*this.cameraInterpolator.alpha,this.cameraInterpolator.initialCamera.getPitch()+(this.cameraInterpolator.finalCamera.getPitch()-this.cameraInterpolator.initialCamera.getPitch())*this.cameraInterpolator.alpha,c.getFieldOfView())}}this.cameraInterpolator.finalCamera=new Camera(c.getX(),c.getY(),c.getZ(),c.getYaw(),c.getPitch(),c.getFieldOfView());if(this.cameraInterpolator.alpha===null){this.cameraInterpolator.animationDuration=75}this.cameraInterpolator.startTime=Date.now();this.cameraInterpolator.alpha=0;var a=this;requestAnimationFrame(function(){a.interpolateUntilAlphaEquals1()})}};HomeComponent3D.prototype.interpolateUntilAlphaEquals1=function(){if(this.cameraInterpolator){var c=Date.now();var d=Math.min(1,(c-this.cameraInterpolator.startTime)/this.cameraInterpolator.animationDuration);if(this.cameraInterpolator.alpha!==d){var b=mat4.create();this.computeTransform(d,b);this.canvas3D.setViewPlatformTransform(b);this.cameraInterpolator.alpha=d}if(this.cameraInterpolator.alpha<1){var a=this;requestAnimationFrame(function(){a.interpolateUntilAlphaEquals1()})}}};HomeComponent3D.prototype.computeTransform=function(b,a){this.computeViewPlatformTransform(a,this.cameraInterpolator.initialCamera.getX()+(this.cameraInterpolator.finalCamera.getX()-this.cameraInterpolator.initialCamera.getX())*b,this.cameraInterpolator.initialCamera.getY()+(this.cameraInterpolator.finalCamera.getY()-this.cameraInterpolator.initialCamera.getY())*b,this.cameraInterpolator.initialCamera.getZ()+(this.cameraInterpolator.finalCamera.getZ()-this.cameraInterpolator.initialCamera.getZ())*b,this.cameraInterpolator.initialCamera.getYaw()+(this.cameraInterpolator.finalCamera.getYaw()-this.cameraInterpolator.initialCamera.getYaw())*b,this.cameraInterpolator.initialCamera.getPitch()+(this.cameraInterpolator.finalCamera.getPitch()-this.cameraInterpolator.initialCamera.getPitch())*b)};HomeComponent3D.prototype.computeViewPlatformTransform=function(a,g,f,d,c,e){var h=mat4.create();mat4.fromYRotation(h,-c+Math.PI);var b=mat4.create();mat4.fromXRotation(b,-e);mat4.mul(h,h,b);mat4.identity(a);mat4.translate(a,a,vec3.fromValues(g,d,f));mat4.mul(a,a,h);this.camera=new Camera(g,f,d,c,e,0)};HomeComponent3D.prototype.addMouseListeners=function(a,c,e){var b=this;var d={initialPointerLocation:null,lastPointerLocation:null,touchEventType:false,buttonPressed:-1,pointerTouches:{},lastEventType:null,lastTargetTouches:[],distanceLastPinch:-1,firstTouchStartedTimeStamp:0,longTouchActivated:false,doubleLongTouchActivated:false,longTouchStartTime:0,actionStartedInComponent3D:false,contextMenuEventType:false,mousePressed:function(f){if(!d.touchEventType&&!d.contextMenuEventType&&f.button===0){d.updateCoordinates(f,"mousePressed");d.initialPointerLocation=[f.canvasX,f.canvasY];d.lastPointerLocation=[f.canvasX,f.canvasY];d.actionStartedInComponent3D=true;a.pressMouse(f.canvasX,f.canvasY,f.clickCount,d.isShiftDown(f),d.isAlignmentActivated(f),d.isDuplicationActivated(f),d.isMagnetismToggled(f),View.PointerType.MOUSE)}f.stopPropagation()},isShiftDown:function(f){return f.shiftKey&&!f.altKey&&!f.ctrlKey&&!f.metaKey},isAlignmentActivated:function(f){return OperatingSystem.isWindows()||OperatingSystem.isMacOSX()?f.shiftKey:f.shiftKey&&!f.altKey},isDuplicationActivated:function(f){return OperatingSystem.isMacOSX()?f.altKey:f.ctrlKey},isMagnetismToggled:function(f){return OperatingSystem.isWindows()?f.altKey:(OperatingSystem.isMacOSX()?f.metaKey:f.shiftKey&&f.altKey)},mouseDoubleClicked:function(f){d.updateCoordinates(f,"mouseDoubleClicked");d.mousePressed(f);actionStartedInComponent3D=false},windowMouseMoved:function(f){if(!d.touchEventType&&!d.contextMenuEventType){d.updateCoordinates(f,"mouseMoved");if(d.initialPointerLocation!=null&&!(d.initialPointerLocation[0]===f.canvasX&&d.initialPointerLocation[1]===f.canvasY)){d.initialPointerLocation=null}if(d.initialPointerLocation==null&&(f.buttons===0&&d.isInCanvas(f)||d.actionStartedInComponent3D)){if(a.isEditingState()){a.moveMouse(f.canvasX,f.canvasY)}else{if(d.actionStartedInComponent3D&&document.activeElement===b.canvas3D.getHTMLElement()){d.moveCamera(f.canvasX,f.canvasY,d.lastPointerLocation[0],d.lastPointerLocation[1],f.button,f.altKey,f.shiftKey)}}}d.lastPointerLocation=[f.canvasX,f.canvasY]}},windowMouseReleased:function(f){if(!d.touchEventType){if(d.lastPointerLocation!=null){if(d.actionStartedInComponent3D&&document.activeElement===b.canvas3D.getHTMLElement()&&f.button===0){if(d.contextMenuEventType){a.releaseMouse(d.initialPointerLocation[0],d.initialPointerLocation[1])}else{d.updateCoordinates(f,"mouseReleased");a.releaseMouse(f.canvasX,f.canvasY)}}d.initialPointerLocation=null;d.lastPointerLocation=null;d.actionStartedInComponent3D=false}}d.contextMenuEventType=false},pointerPressed:function(f){if(f.pointerType=="mouse"){d.mousePressed(f)}else{d.copyPointerToTargetTouches(f,false);d.touchStarted(f)}},pointerMousePressed:function(f){f.stopPropagation()},windowPointerMoved:function(f){if(f.pointerType=="mouse"){d.windowMouseMoved(f)}else{d.copyPointerToTargetTouches(f,false);d.touchMoved(f)}},windowPointerReleased:function(f){if(f.pointerType=="mouse"){d.windowMouseReleased(f)}else{f.preventDefault();d.copyPointerToTargetTouches(f,true);d.touchEnded(f)}},contextMenuDisplayed:function(f){d.contextMenuEventType=true},touchStarted:function(g){d.touchEventType=g.pointerType===undefined;g.preventDefault();if(document.activeElement!==b.canvas3D.getHTMLElement()){b.canvas3D.getHTMLElement().focus()}d.updateCoordinates(g,"touchStarted");if(d.longTouch!=null){clearTimeout(d.longTouch);d.longTouch=null;b.stopLongTouchAnimation()}if(g.targetTouches.length===1){var f=1;if(d.initialPointerLocation!=null&&d.distance(g.canvasX,g.canvasY,d.initialPointerLocation[0],d.initialPointerLocation[1])<5&&g.timeStamp-d.firstTouchStartedTimeStamp<=HomeComponent3D.DOUBLE_TOUCH_DELAY){f=2;d.firstTouchStartedTimeStamp=0;d.initialPointerLocation=null}else{d.firstTouchStartedTimeStamp=g.timeStamp;d.initialPointerLocation=[g.canvasX,g.canvasY]}d.longTouchActivated=false;d.doubleLongTouchActivated=false;d.distanceLastPinch=null;d.lastPointerLocation=[g.canvasX,g.canvasY];d.actionStartedInComponent3D=true;d.longTouchWhenDragged=false;if(c.isEditingIn3DViewEnabled()&&f==1&&b.getClosestSelectableItemAt(g.canvasX,g.canvasY)!==null){d.longTouch=setTimeout(function(){b.startLongTouchAnimation(g.canvasX,g.canvasY,function(){d.longTouchActivated=true;a.setAlignmentActivated(true)})},HomeComponent3D.LONG_TOUCH_DELAY);d.longTouchStartTime=Date.now()}a.pressMouse(g.canvasX,g.canvasY,f,d.isShiftDown(g),d.isAlignmentActivated(g),d.isDuplicationActivated(g),d.isMagnetismToggled(g),View.PointerType.TOUCH)}else{if(d.longTouchActivated&&g.targetTouches.length===2){d.doubleLongTouchActivated=true;a.setDuplicationActivated(true)}else{a.escape()}if(g.targetTouches.length===2){d.actionStartedInComponent3D=true;d.initialPointerLocation=null;d.distanceLastPinch=d.distance(g.targetTouches[0].clientX,g.targetTouches[0].clientY,g.targetTouches[1].clientX,g.targetTouches[1].clientY)}}},touchMoved:function(h){if(d.actionStartedInComponent3D){h.preventDefault();h.stopPropagation();if(d.updateCoordinates(h,"touchMoved")){d.initialPointerLocation=null;if(h.targetTouches.length==1){if(d.longTouch!=null){clearTimeout(d.longTouch);d.longTouch=null;b.stopLongTouchAnimation()}if(a.isEditingState()){if(!d.doubleLongTouchActivated){a.moveMouse(h.canvasX,h.canvasY)}}else{if(b.home.getCamera()===b.home.getObserverCamera()){d.moveCamera(-h.canvasX,-h.canvasY,-d.lastPointerLocation[0],-d.lastPointerLocation[1],h.button,false,false)}else{d.moveCamera(h.canvasX,h.canvasY,d.lastPointerLocation[0],d.lastPointerLocation[1],h.button,false,false)}}d.lastPointerLocation=[h.canvasX,h.canvasY]}else{if(h.targetTouches.length==2&&d.distanceLastPinch!=null){if(a.isEditingState()){a.moveMouse(h.targetTouches[1].clientX,h.targetTouches[1].clientY)}else{var g=d.distance(h.targetTouches[0].clientX,h.targetTouches[0].clientY,h.targetTouches[1].clientX,h.targetTouches[1].clientY);var f=g/d.distanceLastPinch;d.zoomCamera((1-f)*50,false);d.distanceLastPinch=g}}}}}},touchEnded:function(f){if(d.actionStartedInComponent3D){d.updateCoordinates(f,"touchEnded");if(f.targetTouches.length==0){if(d.longTouch!=null){clearTimeout(d.longTouch);d.longTouch=null;b.stopLongTouchAnimation()}a.releaseMouse(d.lastPointerLocation[0],d.lastPointerLocation[1]);if(d.isLongTouch()){f.preventDefault()}d.actionStartedInComponent3D=false}else{if(f.targetTouches.length==1){d.lastPointerLocation=[f.canvasX,f.canvasY]}else{if(f.targetTouches.length==2&&d.distanceLastPinch!=null){d.distanceLastPinch=d.distance(f.targetTouches[0].clientX,f.targetTouches[0].clientY,f.targetTouches[1].clientX,f.targetTouches[1].clientY)}}}}},copyPointerToTargetTouches:function(h,f){if(f){h.changedTouches=[d.pointerTouches[h.pointerId]];delete d.pointerTouches[h.pointerId]}else{d.pointerTouches[h.pointerId]={clientX:h.clientX,clientY:h.clientY}}h.targetTouches=[];for(var g in d.pointerTouches){if(d.pointerTouches.hasOwnProperty(g)){h.targetTouches.push(d.pointerTouches[g])}}},updateCoordinates:function(k,h){var j=b.canvas3D.getHTMLElement().getBoundingClientRect();var f=true;if(h.indexOf("touch")===0){var m=d.lastEventType=="touchStarted"?5:1.5;var l;if(k.targetTouches.length===1&&h=="touchMoved"&&d.distance(d.lastTargetTouches[0].clientX,d.lastTargetTouches[0].clientY,k.targetTouches[0].clientX,k.targetTouches[0].clientY)<m||k.targetTouches.length===0&&h=="touchEnded"&&d.distance(d.lastTargetTouches[0].clientX,d.lastTargetTouches[0].clientY,k.changedTouches[0].clientX,k.changedTouches[0].clientY)<m){l=d.lastTargetTouches;f=false}else{if(k.targetTouches.length==0){l=k.changedTouches}else{l=k.targetTouches}d.lastEventType=h}if(l.length==1){k.canvasX=l[0].clientX-j.left;k.canvasY=l[0].clientY-j.top;var j=b.canvas3D.getHTMLElement().getBoundingClientRect();k.clientX=l[0].clientX;k.clientY=l[0].clientY;k.button=0}k.clickCount=1;if(f){d.lastTargetTouches=[];for(var g=0;l[g]!==undefined;g++){d.lastTargetTouches.push({clientX:l[g].clientX,clientY:l[g].clientY})}}}else{k.canvasX=k.clientX-j.left;k.canvasY=k.clientY-j.top}if(k.clickCount===undefined){if(h=="mouseDoubleClicked"){k.clickCount=2}else{if(h=="mousePressed"||h=="mouseReleased"){k.clickCount=1}else{k.clickCount=0}}}if(h=="mouseWheelMoved"){k.wheelRotation=(k.deltaY!==undefined?k.deltaX+k.deltaY:-k.wheelDelta)/4}return f},isLongTouch:function(f){return Date.now()-d.longTouchStartTime>((f?HomeComponent3D.LONG_TOUCH_DELAY_WHEN_DRAGGING:HomeComponent3D.LONG_TOUCH_DELAY)+HomeComponent3D.LONG_TOUCH_DURATION_AFTER_DELAY)},distance:function(g,j,f,h){return Math.sqrt(Math.pow(f-g,2)+Math.pow(h-j,2))},isInCanvas:function(f){return f.canvasX>=0&&f.canvasX<b.canvas3D.getHTMLElement().clientWidth&&f.canvasY>=0&&f.canvasY<b.canvas3D.getHTMLElement().clientHeight},mouseScrolled:function(f){d.zoomCamera(f.detail,f.shiftKey)},mouseWheelMoved:function(f){f.preventDefault();if(!a.isEditingState()){d.zoomCamera((f.deltaY!==undefined?f.deltaY:-f.wheelDelta)/4,f.shiftKey)}},zoomCamera:function(g,f){var g=-2.5*g;if(f){g*=5}a.moveCamera(g)},moveCamera:function(n,l,h,g,j,f,k){if((d.lastPointerLocation[0]!==n||d.lastPointerLocation[1]!==l)&&j===0){if(f){var p=1.25*(g-l);if(k){p*=5}a.moveCamera(p)}else{var o=0.005;var q=o*(n-h);if(k){q*=5}a.rotateCameraYaw(q);var m=o*(l-g);a.rotateCameraPitch(m)}}}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){e.getHTMLElement().addEventListener("pointerdown",d.pointerPressed);e.getHTMLElement().addEventListener("mousedown",d.pointerMousePressed);e.getHTMLElement().addEventListener("dblclick",d.mouseDoubleClicked);window.addEventListener("pointermove",d.windowPointerMoved);window.addEventListener("pointerup",d.windowPointerReleased)}else{e.getHTMLElement().addEventListener("touchstart",d.touchStarted);e.getHTMLElement().addEventListener("touchmove",d.touchMoved);e.getHTMLElement().addEventListener("touchend",d.touchEnded);e.getHTMLElement().addEventListener("mousedown",d.mousePressed);e.getHTMLElement().addEventListener("dblclick",d.mouseDoubleClicked);window.addEventListener("mousemove",d.windowMouseMoved);window.addEventListener("mouseup",d.windowMouseReleased)}e.getHTMLElement().addEventListener("contextmenu",d.contextMenuDisplayed);e.getHTMLElement().addEventListener("DOMMouseScroll",d.mouseScrolled);e.getHTMLElement().addEventListener("mousewheel",d.mouseWheelMoved);this.mouseListener=d};HomeComponent3D.prototype.startLongTouchAnimation=function(a,e,d){if(this.touchOverlay===undefined){this.touchOverlay=document.createElement("div");this.touchOverlay.id="touch-overlay-timer";this.touchOverlay.classList.add("touch-overlay-timer");this.touchOverlay.style.position="absolute";this.touchOverlay.style.top="0px";this.touchOverlay.style.left="0px";this.touchOverlay.innerHTML='<div class="touch-overlay-timer-content"></div><div class="touch-overlay-timer-bg"></div><div class="touch-overlay-timer-hidder"></div><div class="touch-overlay-timer-loader1"></div><div class="touch-overlay-timer-loader2"></div>';document.body.appendChild(this.touchOverlay);for(var b=0;b<this.touchOverlay.children.length;b++){var c=this.touchOverlay.children.item(b);if(c.classList.contains("overlay-timer-loader1")||c.classList.contains("overlay-timer-loader2")){c.style.borderTopColor="#0000B5";c.style.borderRightColor="#0000B5"}if(c.classList.contains("touch-overlay-timer-content")){c.style.color="#000000";c.innerHTML="<span style='font-weight: bold; font-family: sans-serif; font-size: 140%; line-height: 90%'>&#x21EA;</span>"}c.style.animationDuration=(PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY)+"ms"}}this.touchOverlay.style.visibility="visible";this.touchOverlay.style.left=(this.getHTMLElement().getBoundingClientRect().left+a-this.touchOverlay.clientWidth/2)+"px";this.touchOverlay.style.top=(this.getHTMLElement().getBoundingClientRect().top+e-this.touchOverlay.clientHeight-40)+"px";for(var b=0;b<this.touchOverlay.children.length;b++){this.touchOverlay.children.item(b).classList.add("animated")}if(d!==undefined){this.longTouchAnimationPostTask=setTimeout(d,HomeComponent3D.LONG_TOUCH_DURATION_AFTER_DELAY)}};HomeComponent3D.prototype.stopLongTouchAnimation=function(a,c){if(this.touchOverlay!==undefined){this.touchOverlay.style.visibility="hidden";for(var b=0;b<this.touchOverlay.children.length;b++){this.touchOverlay.children.item(b).classList.remove("animated")}if(this.longTouchAnimationPostTask!==undefined){clearTimeout(this.longTouchAnimationPostTask);delete this.longTouchAnimationPostTask}}};HomeComponent3D.prototype.installKeyboardActions=function(){this.inputMap={"shift pressed UP":"MOVE_CAMERA_FAST_FORWARD","alt shift pressed UP":"MOVE_CAMERA_FAST_FORWARD","shift pressed W":"MOVE_CAMERA_FAST_FORWARD","pressed UP":"MOVE_CAMERA_FORWARD","alt pressed UP":"MOVE_CAMERA_FORWARD","pressed W":"MOVE_CAMERA_FORWARD","shift pressed DOWN":"MOVE_CAMERA_FAST_BACKWARD","alt shift pressed DOWN":"MOVE_CAMERA_FAST_BACKWARD","shift pressed S":"MOVE_CAMERA_FAST_BACKWARD","pressed DOWN":"MOVE_CAMERA_BACKWARD","alt pressed DOWN":"MOVE_CAMERA_BACKWARD","pressed S":"MOVE_CAMERA_BACKWARD","alt shift pressed LEFT":"MOVE_CAMERA_FAST_LEFT","alt pressed LEFT":"MOVE_CAMERA_LEFT","alt shift pressed RIGHT":"MOVE_CAMERA_FAST_RIGHT","alt pressed RIGHT":"MOVE_CAMERA_RIGHT","shift pressed LEFT":"ROTATE_CAMERA_YAW_FAST_LEFT","shift pressed A":"ROTATE_CAMERA_YAW_FAST_LEFT","pressed LEFT":"ROTATE_CAMERA_YAW_LEFT","pressed A":"ROTATE_CAMERA_YAW_LEFT","shift pressed RIGHT":"ROTATE_CAMERA_YAW_FAST_RIGHT","shift pressed D":"ROTATE_CAMERA_YAW_FAST_RIGHT","pressed RIGHT":"ROTATE_CAMERA_YAW_RIGHT","pressed D":"ROTATE_CAMERA_YAW_RIGHT","shift pressed PAGE_UP":"ROTATE_CAMERA_PITCH_FAST_UP","pressed PAGE_UP":"ROTATE_CAMERA_PITCH_UP","shift pressed PAGE_DOWN":"ROTATE_CAMERA_PITCH_FAST_DOWN","pressed PAGE_DOWN":"ROTATE_CAMERA_PITCH_DOWN","shift pressed HOME":"ELEVATE_CAMERA_FAST_UP","pressed HOME":"ELEVATE_CAMERA_UP","shift pressed END":"ELEVATE_CAMERA_FAST_DOWN","pressed END":"ELEVATE_CAMERA_DOWN","pressed ESCAPE":"ESCAPE","shift pressed ESCAPE":"ESCAPE"};if(OperatingSystem.isMacOSX()){this.inputMap["alt pressed ALT"]="ACTIVATE_DUPLICATION";this.inputMap["released ALT"]="DEACTIVATE_DUPLICATION";this.inputMap["shift alt pressed ALT"]="ACTIVATE_DUPLICATION";this.inputMap["shift released ALT"]="DEACTIVATE_DUPLICATION";this.inputMap["meta alt pressed ALT"]="ACTIVATE_DUPLICATION";this.inputMap["meta released ALT"]="DEACTIVATE_DUPLICATION";this.inputMap["shift meta alt pressed ALT"]="ACTIVATE_DUPLICATION";this.inputMap["shift meta released ALT"]="DEACTIVATE_DUPLICATION";this.inputMap["alt pressed ESCAPE"]="ESCAPE"}else{this.inputMap["control pressed CONTROL"]="ACTIVATE_DUPLICATION";this.inputMap["released CONTROL"]="DEACTIVATE_DUPLICATION";this.inputMap["shift control pressed CONTROL"]="ACTIVATE_DUPLICATION";this.inputMap["shift released CONTROL"]="DEACTIVATE_DUPLICATION";this.inputMap["meta control pressed CONTROL"]="ACTIVATE_DUPLICATION";this.inputMap["meta released CONTROL"]="DEACTIVATE_DUPLICATION";this.inputMap["shift meta control pressed CONTROL"]="ACTIVATE_DUPLICATION";this.inputMap["shift meta released CONTROL"]="DEACTIVATE_DUPLICATION";this.inputMap["control pressed ESCAPE"]="ESCAPE"}if(OperatingSystem.isWindows()){this.inputMap["alt pressed ALT"]="TOGGLE_MAGNETISM_ON";this.inputMap["released ALT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["shift alt pressed ALT"]="TOGGLE_MAGNETISM_ON";this.inputMap["shift released ALT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["control alt pressed ALT"]="TOGGLE_MAGNETISM_ON";this.inputMap["control released ALT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["shift control alt pressed ALT"]="TOGGLE_MAGNETISM_ON";this.inputMap["shift control released ALT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["alt pressed ESCAPE"]="ESCAPE"}else{if(OperatingSystem.isMacOSX()){this.inputMap["meta pressed META"]="TOGGLE_MAGNETISM_ON";this.inputMap["released META"]="TOGGLE_MAGNETISM_OFF";this.inputMap["shift meta pressed META"]="TOGGLE_MAGNETISM_ON";this.inputMap["shift released META"]="TOGGLE_MAGNETISM_OFF";this.inputMap["alt meta pressed META"]="TOGGLE_MAGNETISM_ON";this.inputMap["alt released META"]="TOGGLE_MAGNETISM_OFF";this.inputMap["shift alt meta pressed META"]="TOGGLE_MAGNETISM_ON";this.inputMap["shift alt released META"]="TOGGLE_MAGNETISM_OFF";this.inputMap["meta pressed ESCAPE"]="ESCAPE"}else{this.inputMap["shift alt pressed ALT"]="TOGGLE_MAGNETISM_ON";this.inputMap["alt shift pressed SHIFT"]="TOGGLE_MAGNETISM_ON";this.inputMap["alt released SHIFT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["shift released ALT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["control shift alt pressed ALT"]="TOGGLE_MAGNETISM_ON";this.inputMap["control alt shift pressed SHIFT"]="TOGGLE_MAGNETISM_ON";this.inputMap["control alt released SHIFT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["control shift released ALT"]="TOGGLE_MAGNETISM_OFF";this.inputMap["alt shift ESCAPE"]="ESCAPE";this.inputMap["control alt shift pressed ESCAPE"]="ESCAPE"}}this.inputMap["shift pressed SHIFT"]="ACTIVATE_ALIGNMENT";this.inputMap["released SHIFT"]="DEACTIVATE_ALIGNMENT";if(OperatingSystem.isWindows()){this.inputMap["control shift pressed SHIFT"]="ACTIVATE_ALIGNMENT";this.inputMap["control released SHIFT"]="DEACTIVATE_ALIGNMENT";this.inputMap["alt shift pressed SHIFT"]="ACTIVATE_ALIGNMENT";this.inputMap["alt released SHIFT"]="DEACTIVATE_ALIGNMENT"}else{if(OperatingSystem.isMacOSX()){this.inputMap["alt shift pressed SHIFT"]="ACTIVATE_ALIGNMENT";this.inputMap["alt released SHIFT"]="DEACTIVATE_ALIGNMENT";this.inputMap["meta shift pressed SHIFT"]="ACTIVATE_ALIGNMENT";this.inputMap["meta released SHIFT"]="DEACTIVATE_ALIGNMENT"}else{this.inputMap["control shift pressed SHIFT"]="ACTIVATE_ALIGNMENT";this.inputMap["control released SHIFT"]="DEACTIVATE_ALIGNMENT";this.inputMap["shift released ALT"]="ACTIVATE_ALIGNMENT";this.inputMap["control shift released ALT"]="ACTIVATE_ALIGNMENT"}}var a=this;this.canvas3D.getHTMLElement().addEventListener("keydown",function(b){a.callAction(b,KeyStroke.getKeyStrokeForEvent(b,"keydown"))},false);this.canvas3D.getHTMLElement().addEventListener("keyup",function(b){a.callAction(b,KeyStroke.getKeyStrokeForEvent(b,"keyup"))},false)};HomeComponent3D.prototype.callAction=function(a,d){if(d!==undefined){var c=this.inputMap[d];if(c!==undefined){var b=this.actionMap[c];if(b!==undefined){b.actionPerformed(a)}a.stopPropagation()}}};HomeComponent3D.prototype.createActions=function(a){function f(g){this.delta=g}f.prototype.actionPerformed=function(g){a.moveCamera(this.delta)};function b(g){this.delta=g}b.prototype.actionPerformed=function(g){a.moveCameraSideways(this.delta)};function e(g){this.delta=g}e.prototype.actionPerformed=function(g){a.elevateCamera(this.delta)};function d(g){this.delta=g}d.prototype.actionPerformed=function(g){a.rotateCameraYaw(this.delta)};function c(g){this.delta=g}c.prototype.actionPerformed=function(g){a.rotateCameraPitch(this.delta)};this.actionMap={MOVE_CAMERA_FORWARD:new f(6.5),MOVE_CAMERA_FAST_FORWARD:new f(32.5),MOVE_CAMERA_BACKWARD:new f(-6.5),MOVE_CAMERA_FAST_BACKWARD:new f(-32.5),MOVE_CAMERA_LEFT:new b(-2.5),MOVE_CAMERA_FAST_LEFT:new b(-10),MOVE_CAMERA_RIGHT:new b(2.5),MOVE_CAMERA_FAST_RIGHT:new b(10),ELEVATE_CAMERA_DOWN:new e(-2.5),ELEVATE_CAMERA_FAST_DOWN:new e(-10),ELEVATE_CAMERA_UP:new e(2.5),ELEVATE_CAMERA_FAST_UP:new e(10),ROTATE_CAMERA_YAW_LEFT:new d(-Math.PI/60),ROTATE_CAMERA_YAW_FAST_LEFT:new d(-Math.PI/12),ROTATE_CAMERA_YAW_RIGHT:new d(Math.PI/60),ROTATE_CAMERA_YAW_FAST_RIGHT:new d(Math.PI/12),ROTATE_CAMERA_PITCH_UP:new c(-Math.PI/120),ROTATE_CAMERA_PITCH_FAST_UP:new c(-Math.PI/24),ROTATE_CAMERA_PITCH_DOWN:new c(Math.PI/120),ROTATE_CAMERA_PITCH_FAST_DOWN:new c(Math.PI/24),ESCAPE:{actionPerformed:function(g){a.escape()}},ACTIVATE_ALIGNMENT:{actionPerformed:function(g){a.setAlignmentActivated(true)}},DEACTIVATE_ALIGNMENT:{actionPerformed:function(g){a.setAlignmentActivated(false)}},TOGGLE_MAGNETISM_ON:{actionPerformed:function(g){a.toggleMagnetism(true)}},TOGGLE_MAGNETISM_OFF:{actionPerformed:function(g){a.toggleMagnetism(false)}},ACTIVATE_DUPLICATION:{actionPerformed:function(g){a.setDuplicationActivated(true)}},DEACTIVATE_DUPLICATION:{actionPerformed:function(g){a.setDuplicationActivated(false)}}}};HomeComponent3D.prototype.getActionMap=function(){return this.actionMap};HomeComponent3D.prototype.getInputMap=function(){return this.inputMap};HomeComponent3D.prototype.getClosestItemAt=function(a,d){var b=this.canvas3D.getClosestShapeAt(a,d);var c=-1;while(b!==null&&(c=this.homeObjects3D.indexOf(b))<0){b=b.getParent()}if(b!=null){return this.homeObjects[c]}else{return null}};HomeComponent3D.prototype.getClosestSelectableItemAt=function(a,c){var b=component3D.canvas3D.getHTMLElement().getBoundingClientRect();return this.getClosestItemAt(a+b.left,c+b.top)};HomeComponent3D.prototype.convertPixelLocationToVirtualWorldPoint=function(b,e){var c=this.canvas3D.getVirtualWorldToImageTransform(mat4.create());mat4.invert(c,c);mat4.mul(c,this.canvas3D.getViewPlatformTransform(mat4.create()),c);var d=this.getHTMLElement().getBoundingClientRect();var a=vec3.fromValues((b/d.width-0.5)*2,(0.5-e/d.height)*2,0);vec3.transformMat4(a,a,c);return a};HomeComponent3D.prototype.convertPixelLocationToVirtualWorld=function(b,c){var a=this.convertPixelLocationToVirtualWorldPoint(b,c);return[a[0],a[2],a[1]]};HomeComponent3D.prototype.getVirtualWorldPointAt=function(g,f,j){var h=this.convertPixelLocationToVirtualWorldPoint(g,f);var d=this.home.getCamera();var c=vec3.fromValues(d.getX(),d.getZ(),d.getY());var a=vec3.sub(vec3.fromValues(0,0,0),h,c);if(a[1]>0){a[1]=-a[1]}var k=(j-h[1])/a[1];var b=(h[0]+k*a[0]);var e=(h[2]+k*a[2]);return[b,e,j]};HomeComponent3D.prototype.createSceneTree=function(b,d){var a=new Group3D();a.addChild(this.createBackgroundNode(b,d));var e=this.createGroundNode(-50000,-50000,100000,100000,b,d);a.addChild(e);a.addChild(this.createHomeTree(b,d));this.sceneLights=this.createLights(b);for(var c=0;c<this.sceneLights.length;c++){a.addChild(this.sceneLights[c])}return a};HomeComponent3D.prototype.createBackgroundNode=function(e,f){var k=new Appearance3D();var d=this.createHalfSphereGeometry(true);var b=new Shape3D(d,k);var c=new BranchGroup3D();c.addChild(b);c.addChild(new Shape3D(this.createHalfSphereGeometry(false)));var h=new Appearance3D();var g=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-1,-0.01,-1),vec3.fromValues(-1,-0.01,1),vec3.fromValues(1,-0.01,1),vec3.fromValues(1,-0.01,-1)],[0,1,2,0,2,3],[],[],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),h);c.addChild(g);var a=new Background3D(c);this.updateBackgroundColorAndTexture(k,h,this.home,f);h.setVisible(this.home.getCamera().getZ()>=0);if(e){var j=this;this.backgroundChangeListener=function(l){j.updateBackgroundColorAndTexture(k,h,j.home,f)};j.home.getEnvironment().addPropertyChangeListener("SKY_COLOR",this.backgroundChangeListener);j.home.getEnvironment().addPropertyChangeListener("SKY_TEXTURE",this.backgroundChangeListener);j.home.getEnvironment().addPropertyChangeListener("GROUND_COLOR",this.backgroundChangeListener);j.home.getEnvironment().addPropertyChangeListener("GROUND_TEXTURE",this.backgroundChangeListener);this.elevationChangeListener=function(l){if(l.getSource()===j.home){l.getOldValue().removePropertyChangeListener(j.elevationChangeListener);j.home.getCamera().addPropertyChangeListener(j.elevationChangeListener)}if(l.getSource()===j.home||l.getPropertyName()==="Z"){h.setVisible(j.home.getCamera().getZ()>=0)}};this.home.getCamera().addPropertyChangeListener(this.elevationChangeListener);this.home.addPropertyChangeListener("CAMERA",this.elevationChangeListener)}return a};HomeComponent3D.prototype.createHalfSphereGeometry=function(l){var x=48;var q=[];var e=[];var r=[];for(var t=0,n=0;t<x;t++){var b=t*2*Math.PI/x;var g=Math.cos(b);var m=Math.sin(b);var d=(t+1)*2*Math.PI/x;var c=Math.cos(d);var v=Math.sin(d);for(var o=0,s=x/4;o<s;o++,n+=4){var w=2*o*Math.PI/x;var u=Math.cos(w);var z=Math.sin(w);var h=o!==0?(l?z:-z):-0.01;var f=2*(o+1)*Math.PI/x;if(!l){f=-f}var a=Math.cos(f);var p=Math.sin(f);q.push(vec3.fromValues(g*u,h,m*u));q.push(vec3.fromValues(c*u,h,v*u));q.push(vec3.fromValues(c*a,p,v*a));q.push(vec3.fromValues(g*a,p,m*a));if(l){e.push(n);e.push(n+1);e.push(n+2);e.push(n);e.push(n+2);e.push(n+3);r.push(vec2.fromValues(t/x,o/s));r.push(vec2.fromValues((t+1)/x,o/s));r.push(vec2.fromValues((t+1)/x,(o+1)/s));r.push(vec2.fromValues(t/x,(o+1)/s))}else{e.push(n);e.push(n+2);e.push(n+1);e.push(n);e.push(n+3);e.push(n+2)}}}return new IndexedTriangleArray3D(q,e,r,e,[],[])};HomeComponent3D.prototype.updateBackgroundColorAndTexture=function(j,g,f,e){var h=f.getEnvironment().getSkyColor();j.setDiffuseColor(vec3.fromValues(((h>>>16)&255)/255,((h>>>8)&255)/255,(h&255)/255));var k=f.getEnvironment().getSkyTexture();if(k!==null){var a=mat3.create();mat3.fromTranslation(a,vec2.fromValues(-k.getXOffset(),0));TextureManager.getInstance().loadTexture(k.getImage(),0,e,{textureUpdated:function(l){j.setTextureImage(l);j.setTextureTransform(a)},textureError:function(l){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}else{j.setTextureImage(null)}var c=f.getEnvironment().getGroundColor();var d=vec3.fromValues(((c>>>16)&255)/255,((c>>>8)&255)/255,(c&255)/255);g.setDiffuseColor(d);g.setAmbientColor(d);var b=f.getEnvironment().getGroundTexture();if(b!==null){TextureManager.getInstance().loadTexture(b.getImage(),0,e,{textureUpdated:function(l){g.setTextureImage(l);g.setTextureCoordinatesGeneration({planeS:vec4.fromValues(100000,0,0,0),planeT:vec4.fromValues(0,0,100000,0)})},textureError:function(l){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}else{g.setTextureImage(null)}};HomeComponent3D.prototype.createGroundNode=function(g,f,b,c,d,e){if(this.home.structure){var m=new BranchGroup3D();m.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);ModelManager.getInstance().loadModel(this.home.structure,e,{modelUpdated:function(n){m.addChild(n)},modelError:function(n){var o=new Appearance3D();o.setDiffuseColor(vec3.fromValues(1,0,0));m.addChild(new Box3D(10000000,0,10000000,o))}});this.groundChangeListener=function(n){};return m}else{var k=typeof Ground3D!=="undefined"?new Ground3D(this.home,g,f,b,c,e):new Box3D(10000000,0,10000000,new Appearance3D());var a=mat4.create();mat4.translate(a,a,vec3.fromValues(0,-0.2,0));var j=new TransformGroup3D(a);j.addChild(k);if(d){var l=this;this.groundChangeListener=function(n){if(!l.groundChangeListener.updater){l.groundChangeListener.updater=function(){k.update();delete l.groundChangeListener.updater};setTimeout(l.groundChangeListener.updater,0)}};var h=this.home.getEnvironment();h.addPropertyChangeListener("GROUND_COLOR",this.groundChangeListener);h.addPropertyChangeListener("BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",this.groundChangeListener);h.addPropertyChangeListener("GROUND_TEXTURE",this.groundChangeListener);this.home.addPropertyChangeListener("BACKGROUND_IMAGE",this.groundChangeListener)}return j}};HomeComponent3D.prototype.createLights=function(b){var c=[new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(-1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.9,0.9,0.9),vec3.fromValues(0,-0.8,1)),new DirectionalLight3D(vec3.fromValues(0.7,0.7,0.7),vec3.fromValues(0,1,0)),new AmbientLight3D(vec3.fromValues(0.2,0.2,0.2))];for(var d=0;d<c.length-1;d++){c[d].defaultColor=c[d].getColor();this.updateLightColor(c[d])}if(b){var a=this;this.lightColorListener=function(f){for(var e=0;e<c.length-1;e++){a.updateLightColor(c[e])}};this.home.getEnvironment().addPropertyChangeListener("LIGHT_COLOR",this.lightColorListener)}return c};HomeComponent3D.prototype.updateLightColor=function(b){var c=b.defaultColor;var a=this.home.getEnvironment().getLightColor();b.setColor(vec3.fromValues(((a>>>16)&255)/255*c[0],((a>>>8)&255)/255*c[1],(a&255)/255*c[2]))};HomeComponent3D.prototype.createHomeTree=function(k,l){var a=new BranchGroup3D();a.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);var m=this.home.getLabels();for(var h=0;h<m.length;h++){this.addObject(a,m[h],k,l)}var g=this.home.getDimensionLines();for(var h=0;h<g.length;h++){this.addObject(a,g[h],k,l)}var e=this.home.getPolylines();for(var h=0;h<e.length;h++){this.addObject(a,e[h],k,l)}var d=this.home.getRooms();for(var h=0;h<d.length;h++){this.addObject(a,d[h],k,l)}var b=this.home.getWalls();for(var h=0;h<b.length;h++){this.addObject(a,b[h],k,l)}var n=this.home.getFurniture();for(var h=0;h<n.length;h++){var p=n[h];if(p instanceof HomeFurnitureGroup){var c=p.getAllFurniture();for(var f=0;f<c.length;f++){var o=c[f];if(!(o instanceof HomeFurnitureGroup)){this.addObject(a,o,k,l)}}}else{this.addObject(a,p,k,l)}}if(k){this.addLevelListener(a);this.addWallListener(a);this.addFurnitureListener(a);this.addRoomListener(a);this.addPolylineListener(a);this.addDimensionLineListener(a);this.addLabelListener(a);this.addEnvironmentListeners();component3D=this;this.selectionListener={selectionChanged:function(j){component3D.updateObjectsAndFurnitureGroups(j.getOldSelectedItems());component3D.updateObjectsAndFurnitureGroups(j.getSelectedItems())}};this.home.addSelectionListener(this.selectionListener)}return a};HomeComponent3D.prototype.addLevelListener=function(d){var a=this;this.levelChangeListener=function(h){var e=h.getPropertyName();if("VISIBLE"==e||"VIEWABLE"==e){var j=a.homeObjects;var k=[];for(var f=0;f<j.length;f++){var g=j[f];if(g instanceof Room||g.isAtLevel!==undefined||g.isAtLevel(h.getSource())){k.push(g)}}a.updateObjects(k);a.groundChangeListener(null)}else{if("ELEVATION"==e){a.updateObjects(a.homeObjects.slice(0));a.groundChangeListener(null)}else{if("BACKGROUND_IMAGE"==e){a.groundChangeListener(null)}else{if("FLOOR_THICKNESS"==e){a.updateObjects(a.home.getWalls());a.updateObjects(a.home.getRooms())}else{if("HEIGHT"==e){a.updateObjects(a.home.getRooms())}}}}}};var c=this.home.getLevels();for(var b=0;b<c.length;b++){c[b].addPropertyChangeListener(this.levelChangeListener)}this.levelListener=function(e){var f=e.getItem();switch((e.getType())){case CollectionEvent.Type.ADD:f.addPropertyChangeListener(a.levelChangeListener);break;case CollectionEvent.Type.DELETE:f.removePropertyChangeListener(a.levelChangeListener);break}a.updateObjects(a.home.getRooms())};this.home.addLevelsListener(this.levelListener)};HomeComponent3D.prototype.addWallListener=function(d){var a=this;this.wallChangeListener=function(g){var f=g.getPropertyName();if("PATTERN"!=f){var e=g.getSource();a.updateWall(e);var h=a.home.getLevels();if(e.getLevel()===null||e.isAtLevel(h[h.length-1])){a.updateObjects(a.home.getRooms())}if(e.getLevel()!=null&&e.getLevel().getElevation()<0){a.groundChangeListener(null)}}};var b=this.home.getWalls();for(var c=0;c<b.length;c++){b[c].addPropertyChangeListener(this.wallChangeListener)}this.wallListener=function(f){var e=f.getItem();switch((f.getType())){case CollectionEvent.Type.ADD:a.addObject(d,e,true,false);e.addPropertyChangeListener(a.wallChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(e);e.removePropertyChangeListener(a.wallChangeListener);break}a.updateObjects(a.home.getRooms());a.groundChangeListener(null)};this.home.addWallsListener(this.wallListener)};HomeComponent3D.prototype.addFurnitureListener=function(e){var a=this;var c=function(j,g,h){a.updateObjects([j]);if(a.containsDoorsAndWindows(j)){if(h!==null){var f=j.clone();if("X"==g){f.setX(h)}else{if("Y"==g){f.setY(h)}else{if("ANGLE"==g){f.setAngle(h)}else{if("WIDTH"==g){f.setWidth(h)}else{if("DEPTH"==g){f.setDepth(h)}}}}}a.updateIntersectingWalls([f,j])}else{a.updateIntersectingWalls([j])}a.updateObjects(a.home.getWalls())}else{if(a.containsStaircases(j)){a.updateObjects(a.home.getRooms())}}if(j.getLevel()!==null&&j.getLevel().getElevation()<0){a.groundChangeListener(null)}};this.furnitureChangeListener=function(h){var f=h.getSource();var g=h.getPropertyName();if("X"==g||"Y"==g||"ANGLE"==g||"ROLL"==g||"PITCH"==g||"WIDTH"==g||"DEPTH"==g){c(f,g,h.getOldValue())}else{if("HEIGHT"==g||"ELEVATION"==g||"MODEL"==g||"MODEL_ROTATION"==g||"MODEL_MIRRORED"==g||"MODEL_FLAGS"==g||"MODEL_TRANSFORMATIONS"==g||"STAIRCASE_CUT_OUT_SHAPE"==g||"VISIBLE"==g||"LEVEL"==g){c(f,null,null)}else{if("CUT_OUT_SHAPE"==g||"WALL_CUT_OUT_ON_BOTH_SIDES"==g||"WALL_WIDTH"==g||"WALL_LEFT"==g||"WALL_HEIGHT"==g||"WALL_TOP"==g){if(a.containsDoorsAndWindows(f)){a.updateIntersectingWalls([f])}}else{if("COLOR"==g||"TEXTURE"==g||"MODEL_MATERIALS"==g||"SHININESS"==g||("POWER"==g&&a.home.getEnvironment().getSubpartSizeUnderLight()>0)){a.updateObjects([f])}}}}};var d=this.home.getFurniture();for(var b=0;b<d.length;b++){this.addPropertyChangeListener(d[b],this.furnitureChangeListener)}this.furnitureListener=function(g){var f=g.getItem();switch(g.getType()){case CollectionEvent.Type.ADD:a.addPieceOfFurniture(e,f,true,false);a.addPropertyChangeListener(f,a.furnitureChangeListener);break;case CollectionEvent.Type.DELETE:a.deletePieceOfFurniture(f);a.removePropertyChangeListener(f,a.furnitureChangeListener);break}if(a.containsDoorsAndWindows(f)){a.updateIntersectingWalls([f])}else{if(a.containsStaircases(f)){a.updateObjects(a.home.getRooms())}else{a.approximateHomeBoundsCache=null;a.homeHeightCache=null}}a.groundChangeListener(null)};this.home.addFurnitureListener(this.furnitureListener)};HomeComponent3D.prototype.addPropertyChangeListener=function(b,d){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){this.addPropertyChangeListener(c[a],d)}}else{b.addPropertyChangeListener(d)}};HomeComponent3D.prototype.removePropertyChangeListener=function(b,d){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){this.removePropertyChangeListener(c[a],d)}}else{b.removePropertyChangeListener(d)}};HomeComponent3D.prototype.containsDoorsAndWindows=function(b){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){if(this.containsDoorsAndWindows(c[a])){return true}}return false}else{return b.isDoorOrWindow()}};HomeComponent3D.prototype.containsStaircases=function(b){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){if(this.containsStaircases(c[a])){return true}}return false}else{return b.getStaircaseCutOutShape()!==null}};HomeComponent3D.prototype.addRoomListener=function(c){var a=this;this.roomChangeListener=function(o){var p=o.getSource();var m=o.getPropertyName();if("FLOOR_COLOR"==m||"FLOOR_TEXTURE"==m||"FLOOR_SHININESS"==m||"CEILING_COLOR"==m||"CEILING_TEXTURE"==m||"CEILING_SHININESS"==m||"CEILING_FLAT"==m){a.updateObjects([p])}else{if("FLOOR_VISIBLE"==m||"CEILING_VISIBLE"==m||"LEVEL"==m){a.updateObjects(a.home.getRooms());a.groundChangeListener(null)}else{if("POINTS"==m){if(a.homeObjectsToUpdate){a.updateObjects(a.home.getRooms())}else{a.updateObjects([p]);var f=new java.awt.geom.Area(a.getShape(o.getOldValue()));var n=new java.awt.geom.Area(a.getShape(o.getNewValue()));var j=p.getLevel();var h=a.home.getRooms();for(var k=0;k<h.length;k++){var e=h[k];var q=e.getLevel();if(e!=p&&(q==null||Math.abs(j.getElevation()+j.getHeight()-(q.getElevation()+q.getHeight()))<0.00001||Math.abs(j.getElevation()+j.getHeight()-(q.getElevation()-q.getFloorThickness()))<0.00001)){var l=new java.awt.geom.Area(a.getShape(e.getPoints()));var g=new java.awt.geom.Area(l);g.intersect(n);if(!g.isEmpty()){a.updateObjects([e])}else{l.intersect(f);if(!l.isEmpty()){a.updateObjects([e])}}}}}a.groundChangeListener(null)}}}};var d=this.home.getRooms();for(var b=0;b<d.length;b++){d[b].addPropertyChangeListener(this.roomChangeListener)}this.roomListener=function(e){var f=e.getItem();switch(e.getType()){case CollectionEvent.Type.ADD:a.addObject(c,f,e.getIndex(),true,false);f.addPropertyChangeListener(a.roomChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(f);f.removePropertyChangeListener(a.roomChangeListener);break}a.updateObjects(a.home.getRooms());a.groundChangeListener(null)};this.home.addRoomsListener(this.roomListener)};HomeComponent3D.prototype.getShape=function(b){var c=new java.awt.geom.GeneralPath();c.moveTo(b[0][0],b[0][1]);for(var a=1;a<b.length;a++){c.lineTo(b[a][0],b[a][1])}c.closePath();return c};HomeComponent3D.prototype.addPolylineListener=function(d){var a=this;this.polylineChangeListener=function(f){var e=f.getSource();a.updateObjects([e])};var c=this.home.getPolylines();for(var b=0;b<c.length;b++){c[b].addPropertyChangeListener(this.polylineChangeListener)}this.polylineListener=function(f){var e=f.getItem();switch(f.getType()){case CollectionEvent.Type.ADD:a.addObject(d,e,true,false);e.addPropertyChangeListener(a.polylineChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(e);e.removePropertyChangeListener(a.polylineChangeListener);break}};this.home.addPolylinesListener(this.polylineListener)};HomeComponent3D.prototype.addDimensionLineListener=function(d){var b=this;this.dimensionLineChangeListener=function(e){var f=e.getSource();b.updateObjects([f])};var a=this.home.getDimensionLines();for(var c=0;c<a.length;c++){a[c].addPropertyChangeListener(this.dimensionLineChangeListener)}this.dimensionLineListener=function(f){var e=f.getItem();switch(f.getType()){case CollectionEvent.Type.ADD:b.addObject(d,e,true,false);e.addPropertyChangeListener(b.dimensionLineChangeListener);break;case CollectionEvent.Type.DELETE:b.deleteObject(e);e.removePropertyChangeListener(b.dimensionLineChangeListener);break}};this.home.addDimensionLinesListener(this.dimensionLineListener)};HomeComponent3D.prototype.addLabelListener=function(c){var a=this;this.labelChangeListener=function(f){var e=f.getSource();a.updateObjects([e])};var d=this.home.getLabels();for(var b=0;b<d.length;b++){d[b].addPropertyChangeListener(this.labelChangeListener)}this.labelListener=function(f){var e=f.getItem();switch(f.getType()){case CollectionEvent.Type.ADD:a.addObject(c,e,true,false);e.addPropertyChangeListener(a.labelChangeListener);break;case CollectionEvent.Type.DELETE:a.deleteObject(e);e.removePropertyChangeListener(a.labelChangeListener);break}};this.home.addLabelsListener(this.labelListener)};HomeComponent3D.prototype.addEnvironmentListeners=function(){var a=this;this.wallsAlphaListener=function(b){a.updateObjects(a.home.getWalls());a.updateObjects(a.home.getRooms())};this.home.getEnvironment().addPropertyChangeListener("WALLS_ALPHA",this.wallsAlphaListener)};HomeComponent3D.prototype.addObject=function(e,b,c,a,d){if(d===undefined){d=a;a=c;c=-1}var f=this.object3dFactory.createObject3D(this.home,b,d);if(a){b.object3D=f;this.homeObjects.push(b);this.homeObjects3D.push(f)}if(c===-1){e.addChild(f)}else{e.insertChild(f,c)}return f};HomeComponent3D.prototype.addPieceOfFurniture=function(f,c,a,e){if(c instanceof HomeFurnitureGroup){var d=c.getFurniture();for(var b=0;b<d.length;b++){this.addPieceOfFurniture(f,d[b],a,e)}}else{this.addObject(f,c,a,e)}};HomeComponent3D.prototype.deleteObject=function(a){if(a.object3D){a.object3D.detach();delete a.object3D;var c=this.homeObjects.indexOf(a);this.homeObjects.splice(c,1);this.homeObjects3D.splice(c,1);if(this.homeObjectsToUpdate){var b=this.homeObjectsToUpdate.indexOf(a);if(b>=0){this.homeObjectsToUpdate.splice(b,1)}}}};HomeComponent3D.prototype.deletePieceOfFurniture=function(b){if(b instanceof HomeFurnitureGroup){var c=b.getFurniture();for(var a=0;a<c.length;a++){this.deletePieceOfFurniture(c[a])}}else{this.deleteObject(b)}};HomeComponent3D.prototype.updateObjects=function(c){if(this.homeObjectsToUpdate){for(var b=0;b<c.length;b++){var a=c[b];if(this.homeObjectsToUpdate.indexOf(a)<=-1){this.homeObjectsToUpdate.push(a)}}}else{this.homeObjectsToUpdate=c.slice(0);setTimeout(function(e){for(var f=0;f<e.homeObjectsToUpdate.length;f++){var d=e.homeObjectsToUpdate[f];if(d.object3D){d.object3D.update()}}delete e.homeObjectsToUpdate},0,this)}this.approximateHomeBoundsCache=null;this.homeHeightCache=null};HomeComponent3D.prototype.updateObjectsAndFurnitureGroups=function(c){this.updateObjects(c);for(var a=0;a<c.length;a++){var b=c[a];if(b instanceof HomeFurnitureGroup){this.updateObjects(b.getAllFurniture())}}};HomeComponent3D.prototype.updateIntersectingWalls=function(e){var b=this.home.getWalls();var a=0;if(this.homeObjectsToUpdate){for(var d=0;d<this.homeObjectsToUpdate.length;d++){if(this.homeObjectsToUpdate[d] instanceof Wall){a++}}}if(a!==b.length){var l=[];var g=null;for(var d=0;d<e.length;d++){var k=e[d];var h=k.getPoints();if(g===null){g=new java.awt.geom.Rectangle2D.Float(h[0][0],h[0][1],0,0)}else{g.add(h[0][0],h[0][1])}for(var c=1;c<h.length;c++){g.add(h[c][0],h[c][1])}}for(var d=0;d<b.length;d++){var f=b[d];if(f.intersectsRectangle(g.getX(),g.getY(),g.getX()+g.getWidth(),g.getY()+g.getHeight())){l.push(f)}}this.updateObjects(l)}};HomeComponent3D.prototype.updateWall=function(b){var a=[];a.push(b);if(b.getWallAtStart()!=null){a.push(b.getWallAtStart())}if(b.getWallAtEnd()!=null){a.push(b.getWallAtEnd())}this.updateObjects(a)};function Object3DBranchFactory(a){if(a!==undefined){this.preferences=a}}Object3DBranchFactory.prototype.createObject3D=function(c,a,b){if(a instanceof HomePieceOfFurniture){return new HomePieceOfFurniture3D(a,c,this.preferences,b)}else{if(a instanceof Wall){return new Wall3D(a,c,this.preferences,b)}else{if(a instanceof Room){return new Room3D(a,c,this.preferences,false,b)}else{if(a instanceof Polyline){return new Polyline3D(a,c,this.preferences,b)}else{if(a instanceof DimensionLine){return new DimensionLine3D(a,c,this.preferences,b)}else{if(a instanceof Label){return new Label3D(a,c,this.preferences,b)}else{return new Group3D()}}}}}}};function Object3DBranch(a,c,b){BranchGroup3D.call(this);if(a!==undefined){this.setUserData(a);this.home=c;this.userPreferences=b}}Object3DBranch.prototype=Object.create(BranchGroup3D.prototype);Object3DBranch.prototype.constructor=Object3DBranch;Object3DBranch.DEFAULT_COLOR=16777215;Object3DBranch.DEFAULT_AMBIENT_COLOR=3355443;Object3DBranch.prototype.getHome=function(){return this.home!==undefined?this.home:null};Object3DBranch.prototype.getUserPreferences=function(){return this.userPreferences!==undefined?this.userPreferences:null};Object3DBranch.prototype.getShape=function(a){return ShapeTools.getShape(a,true,null)};Object3DBranch.prototype.updateAppearanceMaterial=function(a,d,b,c){if(d!==null){a.setAmbientColor(vec3.fromValues(((b>>>16)&255)/255,((b>>>8)&255)/255,(b&255)/255));a.setDiffuseColor(vec3.fromValues(((d>>>16)&255)/255,((d>>>8)&255)/255,(d&255)/255));a.setSpecularColor(vec3.fromValues(c,c,c));a.setShininess(Math.max(1,c*128))}else{a.setAmbientColor(vec3.fromValues(0.2,0.2,0.2));a.setDiffuseColor(vec3.fromValues(1,1,1));a.setSpecularColor(vec3.fromValues(c,c,c));a.setShininess(Math.max(1,c*128))}};Object3DBranch.prototype.updateTextureTransform=function(e,g,c){var f=g.getWidth();var k=g.getHeight();if(f===-1||k===-1){f=100;k=100}var j=g.getXOffset();var d=g.getYOffset();var h=1/g.getScale();var l=mat3.create();mat3.rotate(l,l,g.getAngle());var a=mat3.create();var b=mat3.create();if(c){mat3.fromTranslation(a,vec2.fromValues(-j/h*f,-d/h*k));mat3.scale(b,b,vec2.fromValues(h/f,h/k))}else{mat3.fromTranslation(a,vec2.fromValues(-j/h,-d/h));mat3.multiplyScalar(b,b,h)}mat3.mul(l,l,a);mat3.mul(b,b,l);e.setTextureTransform(b)};Object3DBranch.prototype.updateTextureTransformFittingArea=function(h,k,l,j){var f=Number.POSITIVE_INFINITY;var e=Number.POSITIVE_INFINITY;var c=Number.NEGATIVE_INFINITY;var b=Number.NEGATIVE_INFINITY;for(var g=0;g<l.length;g++){f=Math.min(f,l[g][0]);e=Math.min(e,l[g][1]);c=Math.max(c,l[g][0]);b=Math.max(b,l[g][1])}if(c-f<=0||b-e<=0){this.updateTextureTransform(h,k,true)}var a=mat3.create();mat3.fromTranslation(a,vec2.fromValues(-f,j?e:-e));var d=mat3.create();mat3.scale(d,d,vec2.fromValues(1/(c-f),1/(b-e)));mat3.mul(d,d,a);h.setTextureTransform(d)};Object3DBranch.prototype.getSelectionAppearance=function(){var a=new Appearance3D();a.setCullFace(Appearance3D.CULL_NONE);a.setIllumination(0);a.setDiffuseColor(vec3.fromValues(0,0,0.7102));return a};Object3DBranch.prototype.getAreaPoints=function(t,a,C,e,M){if(e===undefined&&M===undefined){e=a;M=C;a=null;C=null}var p=[];var x=[];var s=null;var Q=null;for(var r=t.getPathIterator(null,e);!r.isDone();r.next()){var u=[0,0];switch((r.currentSegment(u))){case java.awt.geom.PathIterator.SEG_MOVETO:s=[];s.push(u);Q=u;break;case java.awt.geom.PathIterator.SEG_LINETO:if(u[0]!==Q[0]||u[1]!==Q[1]){s.push(u)}Q=u;break;case java.awt.geom.PathIterator.SEG_CLOSE:var n=s[0];if(n[0]===Q[0]&&n[1]===Q[1]){s.splice(s.length-1,1)}if(s.length>2){var G=s;var f=new Room(G);if(f.getArea()>0){var P=f.isClockwise();if(P){x.push(s)}else{p.push(s)}if(a!==null||C!==null){if(P!==M){G=s.slice(0);G.reverse()}if(P){if(C!=null){C.push(G)}}else{if(a!=null){a.push(G)}}}}}break}}var J=[];if((x.length===0)&&a!==null){J.push.apply(J,a)}else{if((p.length===0)&&!(x.length===0)){if(C!==null){C.length=0}}else{var m;var g=[];if(p.length>1){m=[];for(var L=0;p.length!==0;){var y=p[L];var K=0;for(;K<p.length;K++){if(L!==K){var O=p[K];var h=null;for(var I=0;I<g.length;I++){if(g[I].key===O){h=g[I].value;break}}if(h==null){h=new java.awt.geom.Area(this.getShape(O.slice(0)));g.push({key:O,value:h})}if(h.contains(y[0][0],y[0][1])){break}}}if(K===p.length){p.splice(L,1);m.push(y);L=0}else{if(L<p.length){L++}else{L=0}}}}else{m=p}for(var L=m.length-1;L>=0;L--){var D=m[L];var h=null;for(var I=0;I<g.length;I++){if(g[I].key===D){h=g[I].value;break}}if(h===null){h=new java.awt.geom.Area(this.getShape(D.slice(0)))}var E=[];for(var I=0;I<x.length;I++){var F=x[I];if(h.contains(F[0][0],F[0][1])){E.push(F)}}var v=null;while(E.length!==0){var c=Number.MAX_VALUE;var z=0;var w=0;var N=0;for(var K=0;K<E.length&&c>0;K++){var F=E[K];for(var I=0;I<F.length&&c>0;I++){for(var H=0;H<D.length&&c>0;H++){var q=D[H];var o=java.awt.geom.Point2D.distanceSq(F[I][0],F[I][1],q[0],q[1]);if(o<c&&v!==q){c=o;z=K;w=I;N=H}}}}var d=E[z];if(c!==0){v=D[N];D.splice(N,0,v);D.splice(++N,0,d[w])}var B=d.slice(w,d.length);for(var I=0;I<B.length;I++,N++){D.splice(N,0,B[I])}var A=d.slice(0,w);for(var I=0;I<A.length;I++,N++){D.splice(N,0,A[I])}E.splice(z,1);x.splice(d,1)}}for(var I=0;I<m.length;I++){var b=m[I];if(M){b.reverse()}J.push(b.slice(0))}}}return J};Object3DBranch.areModelRotationsEqual=function(a,d){if(a===d){return true}else{if(a==null||d==null){return false}else{for(var c=0;c<a.length;c++){for(var b=0;b<d.length;b++){if(a[c][b]!==d[c][b]){return false}}}return true}}};function HomePieceOfFurniture3D(b,d,a,c){if(c===undefined){c=a;a=null}Object3DBranch.call(this,b,d,a);this.createPieceOfFurnitureNode(b,c)}HomePieceOfFurniture3D.prototype=Object.create(Object3DBranch.prototype);HomePieceOfFurniture3D.prototype.constructor=HomePieceOfFurniture3D;HomePieceOfFurniture3D.DEFAULT_BOX=new Object();HomePieceOfFurniture3D.SELECTION_BOX_GEOMETRY=new IndexedLineArray3D([vec3.fromValues(-0.5,-0.5,-0.5),vec3.fromValues(0.5,-0.5,-0.5),vec3.fromValues(0.5,0.5,-0.5),vec3.fromValues(-0.5,0.5,-0.5),vec3.fromValues(-0.5,-0.5,0.5),vec3.fromValues(0.5,-0.5,0.5),vec3.fromValues(0.5,0.5,0.5),vec3.fromValues(-0.5,0.5,0.5)],[0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7,4,6,5,7]);HomePieceOfFurniture3D.prototype.createPieceOfFurnitureNode=function(b,c){var a=new TransformGroup3D();a.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);a.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);this.addChild(a);this.loadPieceOfFurnitureModel(c)};HomePieceOfFurniture3D.prototype.loadPieceOfFurnitureModel=function(f){var c=new BranchGroup3D();var a=new TransformGroup3D();a.addChild(this.getModelBox(vec3.fromValues(1,1,1)));a.setUserData(PieceOfFurniture.IDENTITY_ROTATION);c.addChild(a);var e=this.getChild(0);e.removeAllChildren();e.addChild(c);this.updatePieceOfFurnitureTransform();var d=this.getUserData();var b=d.getModel();e.setUserData(b);var g=this;ModelManager.getInstance().loadModel(b,typeof f=="function"?false:f,{modelUpdated:function(k){g.updateModelTransformations(k);var j=d.getModelRotation();var h=ModelManager.getInstance().getNormalizedTransformGroup(k,j,1,d.isModelCenteredAtOrigin());h.setUserData(j);g.updatePieceOfFurnitureModelNode(k,h,f)},modelError:function(h){g.updatePieceOfFurnitureModelNode(g.getModelBox(vec3.fromValues(1,0,0)),new TransformGroup3D(),f)}})};HomePieceOfFurniture3D.prototype.update=function(){if(this.isVisible()){var b=this.getUserData();var c=this.getChild(0);var a=c.getChild(0).getChild(0);if(b.getModel().equals(c.getUserData())&&Object3DBranch.areModelRotationsEqual(b.getModelRotation(),a.getUserData())){this.updatePieceOfFurnitureModelTransformations();this.updatePieceOfFurnitureTransform();this.updatePieceOfFurnitureColorAndTexture(false)}else{this.loadPieceOfFurnitureModel(false)}}this.updatePieceOfFurnitureVisibility()};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureTransform=function(){var a=this.getChild(0);var b=ModelManager.getInstance().getPieceOfFurnitureNormalizedModelTransformation(this.getUserData(),a.getChild(0));a.setTransform(b)};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureColorAndTexture=function(d){var c=this.getUserData();var a=this.getModelNode();var b=a.getChild(0);if(b.getUserData()!==HomePieceOfFurniture3D.DEFAULT_BOX){if(c.getColor()!==null){this.setColorAndTexture(a,c.getColor(),null,c.getShininess(),null,c.isModelMirrored(),c.getModelFlags(),false,null,null,[])}else{if(c.getTexture()!==null){this.setColorAndTexture(a,null,c.getTexture(),c.getShininess(),null,c.isModelMirrored(),c.getModelFlags(),d,vec3.fromValues(c.getWidth(),c.getHeight(),c.getDepth()),ModelManager.getInstance().getBounds(b),[])}else{if(c.getModelMaterials()!==null){this.setColorAndTexture(a,null,null,null,c.getModelMaterials(),c.isModelMirrored(),c.getModelFlags(),d,vec3.fromValues(c.getWidth(),c.getHeight(),c.getDepth()),ModelManager.getInstance().getBounds(b),[])}else{this.setColorAndTexture(a,null,null,c.getShininess(),null,c.isModelMirrored(),c.getModelFlags(),false,null,null,[])}}}}};HomePieceOfFurniture3D.prototype.getModelNode=function(){var a=this.getChild(0);var b=a.getChild(0);return b.getChild(0)};HomePieceOfFurniture3D.prototype.getSelectionNode=function(){var a=this.getChild(0);var b=a.getChild(0);if(b.getChildren().length>1&&b.getChild(1) instanceof Shape3D){return b.getChild(1)}else{return null}};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureVisibility=function(){var b=this.getUserData();var d=this.isVisible();var a=b.getColor()===null&&b.getTexture()===null?b.getModelMaterials():null;this.setVisible(this.getModelNode(),d,b.getModelFlags(),a);var c=this.getSelectionNode();if(c!=null){this.setVisible(c,this.getUserPreferences()!=null&&this.getUserPreferences().isEditingIn3DViewEnabled()&&d&&this.getHome()!=null&&this.isSelected(this.getHome().getSelectedItems()),0,null)}};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureModelTransformations=function(){var b=this.getUserData();var a=this.getModelNode();if(a.getChild(0).getUserData()!==HomePieceOfFurniture3D.DEFAULT_BOX&&this.updateModelTransformations(this)){var c=ModelManager.getInstance().getNormalizedTransform(a.getChild(0),b.getModelRotation(),1,b.isModelCenteredAtOrigin());a.setTransform(c)}};HomePieceOfFurniture3D.prototype.updateModelTransformations=function(g){var e=false;var b=this.getUserData().getModelTransformations();var a=null;if(b!==null){for(var d=0;d<b.length;d++){var f=b[d];var c=f.getName()+ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX;if(a===null){a=[]}a.push(c);e|=this.updateTransformation(g,c,f.getMatrix())}}e|=this.setNotUpdatedTranformationsToIdentity(g,a);return e};HomePieceOfFurniture3D.prototype.updateTransformation=function(f,g,a){var e=false;if(f instanceof Group3D){if(f instanceof TransformGroup3D&&g==f.getName()){var b=mat4.create();f.getTransform(b);if(a[0][0]!==b[0]||a[0][1]!==b[4]||a[0][2]!==b[8]||a[0][3]!==b[12]||a[1][0]!==b[1]||a[1][1]!==b[5]||a[1][2]!==b[9]||a[1][3]!==b[13]||a[2][0]!==b[2]||a[2][1]!==b[6]||a[2][2]!==b[10]||a[2][3]!==b[14]){mat4.set(b,a[0][0],a[1][0],a[2][0],0,a[0][1],a[1][1],a[2][1],0,a[0][2],a[1][2],a[2][2],0,a[0][3],a[1][3],a[2][3],1);f.setTransform(b);e=true}}else{var d=f.getChildren();for(var c=0;c<d.length;c++){e|=this.updateTransformation(d[c],g,a)}}}return e};HomePieceOfFurniture3D.prototype.setNotUpdatedTranformationsToIdentity=function(f,a){var e=false;if(f instanceof Group3D){if(f instanceof TransformGroup3D&&f.getName()!==null&&f.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)>=0&&f.getName().indexOf(ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX)===f.getName().length-ModelManager.DEFORMABLE_TRANSFORM_GROUP_SUFFIX.length&&(a===null||a.indexOf(f.getName())<0)){var g=f;var b=mat4.create();g.getTransform(b);if(!TransformGroup3D.isIdentity(b)){mat4.identity(b);g.setTransform(b);e=true}}var d=f.getChildren();for(var c=0;c<d.length;c++){e|=this.setNotUpdatedTranformationsToIdentity(d[c],a)}}return e};HomePieceOfFurniture3D.prototype.updatePieceOfFurnitureModelNode=function(c,a,g){a.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);a.addChild(c);var e=new BranchGroup3D();e.addChild(a);if(this.getHome()!=null){var b=new Shape3D(HomePieceOfFurniture3D.SELECTION_BOX_GEOMETRY,this.getSelectionAppearance());b.setPickable(false);e.addChild(b)}var d=this.getUserData();if(d.isDoorOrWindow()){this.setTransparentShapeNotPickable(c)}var f=this.getChild(0);f.removeAllChildren();f.addChild(e);if(d.isHorizontallyRotated()){this.updatePieceOfFurnitureTransform()}if(d.isBackFaceShown()){this.setBackFaceNormalFlip(this.getModelNode(),true)}this.modifiedTexturesCount=0;this.updatePieceOfFurnitureColorAndTexture(g);this.updatePieceOfFurnitureVisibility();if(this.modifiedTexturesCount===0&&typeof g=="function"){g(this)}};HomePieceOfFurniture3D.prototype.getModelBox=function(a){var c=new Appearance3D();c.setDiffuseColor(a);c.setAmbientColor(vec3.scale(vec3.create(),a,0.7));var b=new Box3D(0.5,0.5,0.5,c);b.setUserData(HomePieceOfFurniture3D.DEFAULT_BOX);return b};HomePieceOfFurniture3D.prototype.setColorAndTexture=function(t,v,p,u,c,j,e,m,A,d,z){if(t instanceof Group3D){var f=t.getChildren();for(var x=0;x<f.length;x++){this.setColorAndTexture(f[x],v,p,u,c,j,e,m,A,d,z)}}else{if(t instanceof Link3D){this.setColorAndTexture(t.getSharedGroup(),v,p,u,c,j,e,m,A,d,z)}else{if(t instanceof Shape3D){var b=t;var w=b.getName();var o=b.getAppearance();if(o===null){o=new Appearance3D();t.setAppearance(o)}if(z.indexOf(o)===-1){var a=null;var y=v!==null;var r=!y&&p!==null;var h=!y&&!r&&c!==null&&c.length>0;var l=y||r||h||u!==null||j||e!=0;var s=w!==null&&w.indexOf(ModelManager.WINDOW_PANE_SHAPE_PREFIX)===0;if(!s&&l||s&&h){if(o.defaultAppearance===undefined){o.defaultAppearance=o.clone()}a=o.defaultAppearance}var g=0;if(l){g=u!==null?u:(o.getSpecularColor()!==undefined&&o.getShininess()!==undefined?o.getShininess()/128:0)}if(y){if(s){this.restoreDefaultAppearance(o,null)}else{this.updateAppearanceMaterial(o,v,v,g);if(a.getTransparency()!==undefined){o.setTransparency(a.getTransparency())}if(a.getCullFace()!==undefined){o.setCullFace(a.getCullFace())}o.setTextureCoordinatesGeneration(a.getTextureCoordinatesGeneration());o.setTextureImage(null)}}else{if(r){if(s){this.restoreDefaultAppearance(o,null)}else{o.setTextureCoordinatesGeneration(this.getTextureCoordinates(o,p,A,d));this.updateTextureTransform(o,p,true);this.updateAppearanceMaterial(o,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,g);TextureManager.getInstance().loadTexture(p.getImage(),0,typeof m=="function"?false:m,this.getTextureObserver(o,j,e,m))}}else{if(h){var q=false;for(var x=0;x<c.length;x++){var n=c[x];if(n!==null&&(n.getKey()!=null&&n.getKey()==o.getName()||n.getKey()==null&&n.getName()==o.getName())){if(n.getShininess()!==null){g=n.getShininess()}v=n.getColor();if(v!==null&&(v&4278190080)!=0){this.updateAppearanceMaterial(o,v,v,g);if(a.getTransparency()!==undefined){o.setTransparency(a.getTransparency())}if(a.getCullFace()!==undefined){o.setCullFace(a.getCullFace())}o.setTextureImage(null)}else{if(v===null&&n.getTexture()!==null){var k=n.getTexture();if(this.isTexturesCoordinatesDefined(b)){this.restoreDefaultTextureCoordinatesGeneration(o);this.updateTextureTransform(o,k)}else{o.setTextureCoordinatesGeneration(this.getTextureCoordinates(o,n.getTexture(),A,d));this.updateTextureTransform(o,k,true)}this.updateAppearanceMaterial(o,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,g);var k=n.getTexture();TextureManager.getInstance().loadTexture(k.getImage(),0,typeof m=="function"?false:m,this.getTextureObserver(o,j,e,m))}else{this.restoreDefaultAppearance(o,n.getShininess())}}q=true;break}}if(!q){this.restoreDefaultAppearance(o,null)}}else{this.restoreDefaultAppearance(o,u)}}}this.setCullFace(o,j,(e&PieceOfFurniture.SHOW_BACK_FACE)!=0);z.push(o)}}}}};HomePieceOfFurniture3D.prototype.getTextureObserver=function(a,e,b,d){var c=this;this.modifiedTexturesCount++;return{textureUpdated:function(f){if(TextureManager.getInstance().isTextureTransparent(f)){a.setCullFace(Appearance3D.CULL_NONE)}else{var g=a.defaultAppearance;if(g!==null&&g.getCullFace()!==null){a.setCullFace(g.getCullFace())}}if(a.getTextureImage()!==f){a.setTextureImage(f)}c.setCullFace(a,e,(b&PieceOfFurniture.SHOW_BACK_FACE)!=0);if(--c.modifiedTexturesCount===0&&typeof d=="function"){d(c)}},textureError:function(f){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}}};HomePieceOfFurniture3D.prototype.getTextureCoordinates=function(g,h,d,l){var e=vec3.create();l.getLower(e);var m=vec3.create();l.getUpper(m);var a=ModelManager.getInstance().getMinimumSize();var j=d[0]/Math.max(m[0]-e[0],a);var k=-e[0]*j;var c=d[1]/Math.max(m[1]-e[1],a);var b=d[2]/Math.max(m[2]-e[2],a);var f=-e[1]*c+m[2]*b;return{planeS:vec4.fromValues(j,0,0,k),planeT:vec4.fromValues(0,c,-b,f)}};HomePieceOfFurniture3D.prototype.isTexturesCoordinatesDefined=function(a){var c=a.getGeometries();for(var b=0,d=c.length;b<d;b++){if(!c[b].hasTextureCoordinates()){return false}}return true};HomePieceOfFurniture3D.prototype.setCullFace=function(a,d,e){if(a.getCullFace()!==Appearance3D.CULL_NONE){var c=a.getCullFace()!==undefined?a.getCullFace():Appearance3D.CULL_BACK;var b=a.defaultCullFace;if(b===undefined){a.defaultCullFace=(b=c)}a.setCullFace((d^e^b===Appearance3D.CULL_FRONT)?Appearance3D.CULL_FRONT:Appearance3D.CULL_BACK)}};HomePieceOfFurniture3D.prototype.restoreDefaultAppearance=function(a,b){if(a.defaultAppearance!==undefined){var c=a.defaultAppearance;if(c.getAmbientColor()!==undefined){a.setAmbientColor(c.getAmbientColor())}if(c.getDiffuseColor()!==undefined){a.setDiffuseColor(c.getDiffuseColor());if(b!==null){a.setSpecularColor(vec3.fromValues(b,b,b));a.setShininess(b*128)}else{a.setSpecularColor(c.getSpecularColor());a.setShininess(c.getShininess())}}if(c.getTransparency()!==undefined){a.setTransparency(c.getTransparency())}if(a.getCullFace()!==undefined){a.setCullFace(c.getCullFace())}if(c.getTextureCoordinatesGeneration()!==undefined){a.setTextureCoordinatesGeneration(c.getTextureCoordinatesGeneration())}if(a.getTextureImage()!==undefined){a.setTextureImage(c.getTextureImage())}}};HomePieceOfFurniture3D.prototype.restoreDefaultTextureCoordinatesGeneration=function(a){if(a.defaultAppearance!==undefined){var b=a.defaultAppearance;if(b.getTextureCoordinatesGeneration()!==undefined){a.setTextureCoordinatesGeneration(b.getTextureCoordinatesGeneration())}}};HomePieceOfFurniture3D.prototype.setVisible=function(c,b,k,m){if(c instanceof Group3D){var a=c.getChildren();for(var e=0;e<a.length;e++){this.setVisible(a[e],b,k,m)}}else{if(c instanceof Link3D){this.setVisible(c.getSharedGroup(),b,k,m)}else{if(c instanceof Shape3D){var j=c;var f=j.getAppearance();if(f===null){f=new Appearance3D();c.setAppearance(f)}var l=j.getName();if(b&&l!==null&&l.indexOf(ModelManager.LIGHT_SHAPE_PREFIX)===0&&this.getHome()!==null&&!this.isSelected(this.getHome().getSelectedItems())&&(typeof HomeLight==="undefined"||this.getUserData() instanceof HomeLight)){b=false}if(b){var h=f.getName();if(h!=null){if((k&PieceOfFurniture.HIDE_EDGE_COLOR_MATERIAL)!=0&&h.indexOf(ModelManager.EDGE_COLOR_MATERIAL_PREFIX)===0){b=false}else{if(m!=null){for(var e=0;e<m.length;e++){var g=m[e];if(g!==null&&g.getName()==h){var d=g.getColor();b=d===null||(d&4278190080)!==0;break}}}}}}f.setVisible(b)}}}};HomePieceOfFurniture3D.prototype.isVisible=function(){var a=this.getUserData();return a.isVisible()&&(a.getLevel()===null||a.getLevel().isViewableAndVisible())};HomePieceOfFurniture3D.prototype.isSelected=function(c){for(var a=0;a<c.length;a++){var b=c[a];if(b===this.getUserData()||(b instanceof HomeFurnitureGroup&&this.isSelected(b.getFurniture()))){return true}}return false};HomePieceOfFurniture3D.prototype.setBackFaceNormalFlip=function(d,e){if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){this.setBackFaceNormalFlip(c[b],e)}}else{if(d instanceof Link3D){this.setBackFaceNormalFlip(d.getSharedGroup(),e)}else{if(d instanceof Shape3D){var a=d.getAppearance();if(a===null){a=new Appearance3D();d.setAppearance(a)}a.setBackFaceNormalFlip(e^a.getCullFace()===Appearance3D.CULL_FRONT)}}}};HomePieceOfFurniture3D.prototype.setTransparentShapeNotPickable=function(d){if(d instanceof Group3D){var c=d.getChildren();for(var b=0;b<c.length;b++){this.setTransparentShapeNotPickable(c[b])}}else{if(d instanceof Link3D){this.setTransparentShapeNotPickable(d.getSharedGroup())}else{if(d instanceof Shape3D){var a=d.getAppearance();if(a!==null&&a.getTransparency()>0){d.setPickable(false)}}}}};function Room3D(e,f,b,c,d){if(d===undefined){waitModelAndTextureLoadingEnd=c;c=b;b=null}Object3DBranch.call(this,e,f,b);if(c===undefined){c=false;d=false}this.addChild(this.createRoomPartShape());this.addChild(this.createRoomPartShape());var a=new Shape3D();a.setAppearance(this.getSelectionAppearance());a.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);a.setPickable(false);this.addChild(a);this.updateRoomGeometry();this.updateRoomAppearance(d);if(c){this.removeChild(Room3D.CEILING_PART)}}Room3D.prototype=Object.create(Object3DBranch.prototype);Room3D.prototype.constructor=Room3D;Room3D.FLOOR_PART=0;Room3D.CEILING_PART=1;Room3D.prototype.createRoomPartShape=function(){var b=new Shape3D();b.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);var a=new Appearance3D();b.setAppearance(a);this.updateAppearanceMaterial(a,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);return b};Room3D.prototype.update=function(){this.updateRoomGeometry();this.updateRoomAppearance(false)};Room3D.prototype.updateRoomGeometry=function(){this.updateRoomPartGeometry(Room3D.FLOOR_PART,this.getUserData().getFloorTexture());this.updateRoomPartGeometry(Room3D.CEILING_PART,this.getUserData().getCeilingTexture());var a=this.getUserData();this.setPickable(this.getHome().getEnvironment().getWallsAlpha()==0||a.getLevel()==null||a.getLevel().getElevation()<=0)};Room3D.prototype.updateRoomPartGeometry=function(a,f){var g=this.getChild(a);var e=g.getGeometries().length;var h=this.getUserData();if(h.getLevel()==null||h.getLevel().isViewableAndVisible()){var d=this.createRoomGeometries(a,f);for(var c=0;c<d.length;c++){g.addGeometry(d[c])}}for(var c=e-1;c>=0;c--){g.removeGeometry(c)}var b=this.getChild(2);b.addGeometry(this.createRoomSelectionGeometry());if(b.getGeometries().length>1){b.removeGeometry(0)}};Room3D.prototype.createRoomGeometries=function(P,n){var A=this.getUserData();var H=A.getPoints();if((P===Room3D.FLOOR_PART&&A.isFloorVisible()||P===Room3D.CEILING_PART&&A.isCeilingVisible())&&H.length>2){var G=A.getLevel();var o=this.getHome().getLevels();var D=this.isLastLevel(G,o);var q;var m;if(G!=null){m=G.getElevation();q=m-G.getFloorThickness()}else{m=0;q=0}var c;if(o.length===0){c=0}else{c=o[0].getElevation()}var x=P===Room3D.FLOOR_PART&&G!==null&&m!==c;var k=[];var f=[];var J=this.getHome().getRooms();for(var S=0;S<J.length;S++){var v=J[S];var l=v.getLevel();if(l===null||l.isViewableAndVisible()){if(A===v||G===l&&(P===Room3D.FLOOR_PART&&v.isFloorVisible()||P===Room3D.CEILING_PART&&v.isCeilingVisible())||G!=null&&l!=null&&(P===Room3D.FLOOR_PART&&v.isFloorVisible()&&Math.abs(m-l.getElevation())<0.0001||P===Room3D.CEILING_PART&&v.isCeilingVisible()&&!D&&!this.isLastLevel(l,o)&&Math.abs(m+G.getHeight()-(l.getElevation()+l.getHeight()))<0.0001)){k.push(v)}else{if(x&&l!=null&&v.isCeilingVisible()&&!this.isLastLevel(l,o)&&Math.abs(q-(l.getElevation()+l.getHeight()))<0.0001){f.push(v)}}}}if(G!=null){k.sort(function(Z,Y){var j=(Z.getLevel().getElevation()-Y.getLevel().getElevation());if(j!==0){return j}else{return Z.getLevel().getElevationIndex()-Y.getLevel().getElevationIndex()}})}var s;if(G===null||P===Room3D.CEILING_PART&&D){s=[]}else{s=this.getVisibleStaircases(this.getHome().getFurniture(),P,G,G.getElevation()===c)}var X=true;if(P===Room3D.CEILING_PART&&(G===null||D)){var z=this.getRoomHeightAt(H[0][0],H[0][1]);for(var S=1;S<H.length&&X;S++){X=this.getRoomHeightAt(H[S][0],H[S][1])===z}}var d;var W;var e;var E;if(!A.isSingular()||X&&(k[k.length-1]!==A||s.length>0)){E=new java.awt.geom.Area(this.getShape(H));if((k.indexOf(A)>=0)){for(var S=k.length-1;S>0&&k[S]!==A;S--){var a=k[S];E.subtract(new java.awt.geom.Area(this.getShape(a.getPoints())))}}this.removeStaircasesFromArea(s,E);d=[];W=[];e=this.getAreaPoints(E,d,W,1,P===Room3D.CEILING_PART)}else{var O=A.isClockwise();if(O&&P===Room3D.FLOOR_PART||!O&&P===Room3D.CEILING_PART){H=this.getReversedArray(H)}e=d=[H];W=[];E=null}var g=[];var r=this.getHome().getEnvironment().getSubpartSizeUnderLight();if(e.length!==0){var b=[];var y=true;for(var S=0;S<e.length;S++){var K=e[S];var u=new Array(K.length);for(var R=0;R<K.length;R++){u[R]=P===Room3D.FLOOR_PART?m:this.getRoomHeightAt(K[R][0],K[R][1]);if(y&&R>0){y=u[R]===u[R-1]}}b.push(u)}if(y&&r>0){for(var R=0;R<e.length;R++){var K=e[R];var U=Number.MAX_VALUE;var t=Number.MIN_VALUE;var N=Number.MAX_VALUE;var h=Number.MIN_VALUE;for(var S=0;S<K.length;S++){var C=K[S];U=Math.min(U,C[0]);t=Math.max(t,C[0]);N=Math.min(N,C[1]);h=Math.max(h,C[1])}var w=new java.awt.geom.Area(this.getShape(K));for(var I=U;I<t;I+=r){for(var M=N;M<h;M+=r){var V=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(I,M,r,r));V.intersect(w);if(!V.isEmpty()){var B=this.getAreaPoints(V,1,P===Room3D.CEILING_PART);if(!(B.length==0)){g.push(this.computeRoomPartGeometry(B,null,G,b[S][0],q,P===Room3D.FLOOR_PART,false,n))}}}}}}else{g.push(this.computeRoomPartGeometry(e,b,G,m,q,P===Room3D.FLOOR_PART,false,n))}if(G!=null&&P===Room3D.FLOOR_PART&&G.getElevation()!==c){g.push(this.computeRoomBorderGeometry(d,W,G,m,n))}}if(x){var p;if(E!=null||f.length>0){var Q=E!=null?E:new java.awt.geom.Area(this.getShape(H));for(var S=0;S<f.length;S++){var a=f[S];Q.subtract(new java.awt.geom.Area(this.getShape(a.getPoints())))}p=this.getAreaPoints(Q,1,true)}else{p=[this.getReversedArray(H)]}if(p.length!==0){if(r>0){for(var S=0;S<p.length;S++){var F=p[S];var U=Number.MAX_VALUE;var t=Number.MIN_VALUE;var N=Number.MAX_VALUE;var h=Number.MIN_VALUE;for(var R=0;R<F.length;R++){var C=F[R];U=Math.min(U,C[0]);t=Math.max(t,C[0]);N=Math.min(N,C[1]);h=Math.max(h,C[1])}var L=new java.awt.geom.Area(this.getShape(F));for(var I=U;I<t;I+=r){for(var M=N;M<h;M+=r){var T=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(I,M,r,r));T.intersect(L);if(!T.isEmpty()){var B=this.getAreaPoints(T,1,true);if(B.length!==0){g.push(this.computeRoomPartGeometry(B,null,G,m,q,true,true,n))}}}}}}else{g.push(this.computeRoomPartGeometry(p,null,G,m,q,true,true,n))}}}return g.slice(0)}else{return[]}};Room3D.prototype.computeRoomPartGeometry=function(v,t,b,g,u,m,s,h){var c=new Array(v.length);var f=0;for(var r=0;r<v.length;r++){var d=v[r];c[r]=d.length;f+=c[r]}var q=new Array(f);var r=0;for(var o=0;o<v.length;o++){var d=v[o];var a=t!=null?t[o]:null;for(var n=0;n<d.length;n++){var e=s?u:(a!=null?a[n]:g);q[r++]=vec3.fromValues(d[n][0],e,d[n][1])}}var l=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);l.setCoordinates(q);l.setStripCounts(c);if(h!=null){var p=new Array(f);r=0;for(var o=0;o<v.length;o++){var d=v[o];for(var n=0;n<d.length;n++){p[r++]=vec2.fromValues(d[n][0],m?-d[n][1]:d[n][1])}}l.setTextureCoordinates(p)}l.setGeneratedNormals(true);return l.getIndexedGeometryArray()};Room3D.prototype.computeRoomBorderGeometry=function(q,p,r,n,h){var a=0;for(var e=0;e<q.length;e++){a+=q[e].length}for(var e=0;e<p.length;e++){a+=p[e].length}a=a*4;var e=0;var o=new Array(a);var g=n-r.getFloorThickness();for(var f=0;f<q.length;f++){var k=q[f];for(var d=0;d<k.length;d++){o[e++]=vec3.fromValues(k[d][0],n,k[d][1]);o[e++]=vec3.fromValues(k[d][0],g,k[d][1]);var m=d<k.length-1?d+1:0;o[e++]=vec3.fromValues(k[m][0],g,k[m][1]);o[e++]=vec3.fromValues(k[m][0],n,k[m][1])}}for(var f=0;f<p.length;f++){var b=p[f];for(var d=0;d<b.length;d++){o[e++]=vec3.fromValues(b[d][0],n,b[d][1]);var m=d<b.length-1?d+1:0;o[e++]=vec3.fromValues(b[m][0],n,b[m][1]);o[e++]=vec3.fromValues(b[m][0],g,b[m][1]);o[e++]=vec3.fromValues(b[d][0],g,b[d][1])}}var c=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);c.setCoordinates(o);if(h!=null){var l=new Array(a);e=0;if(h.isFittingArea()){for(var f=0;f<q.length;f++){var k=q[f];for(var d=0;d<k.length;d++){l[e++]=l[e++]=vec2.fromValues(k[d][0],-k[d][1]);var m=d<k.length-1?d+1:0;l[e++]=l[e++]=vec2.fromValues(k[m][0],-k[m][1])}}for(var f=0;f<p.length;f++){var b=p[f];for(var d=0;d<b.length;d++){l[e]=vec2.fromValues(b[d][0],-b[d][1]);var m=d<b.length-1?d+1:0;l[e+1]=vec2.fromValues(b[m][0],-b[m][1]);l[e+2]=l[e+1];l[e+3]=l[e];e+=4}}}else{for(var f=0;f<q.length;f++){var k=q[f];for(var d=0;d<k.length;d++){l[e++]=vec2.fromValues(0,r.getFloorThickness());l[e++]=vec2.fromValues(0,0);var m=d<k.length-1?d+1:0;var s=java.awt.geom.Point2D.distance(k[d][0],k[d][1],k[m][0],k[m][1]);l[e++]=vec2.fromValues(s,0);l[e++]=vec2.fromValues(s,r.getFloorThickness())}}for(var f=0;f<p.length;f++){var b=p[f];for(var d=0;d<b.length;d++){l[e++]=vec2.fromValues(0,0);var m=d<b.length-1?d+1:0;var s=java.awt.geom.Point2D.distance(b[d][0],b[d][1],b[m][0],b[m][1]);l[e++]=vec2.fromValues(s,0);l[e++]=vec2.fromValues(s,r.getFloorThickness());l[e++]=vec2.fromValues(0,r.getFloorThickness())}}}c.setTextureCoordinates(l)}c.setCreaseAngle(Math.PI/8);c.setGeneratedNormals(true);return c.getIndexedGeometryArray()};Room3D.prototype.removeStaircasesFromArea=function(b,d){var a=ModelManager.getInstance();for(var c=0;c<b.length;c++){var e=b[c];d.subtract(a.getAreaOnFloor(e))}};Room3D.prototype.getVisibleStaircases=function(f,b,d,g){var a=[];for(var c=0;c<f.length;c++){var e=f[c];if(e.isVisible()&&(e.getLevel()===null||e.getLevel().isViewableAndVisible())){if(e instanceof HomeFurnitureGroup){a.push.apply(a,this.getVisibleStaircases(e.getFurniture(),b,d,g))}else{if(e.getStaircaseCutOutShape()!=null&&"false"!=e.getStaircaseCutOutShape().toLowerCase()&&((b===Room3D.FLOOR_PART&&e.getGroundElevation()<d.getElevation()&&e.getGroundElevation()+e.getHeight()>=d.getElevation()-(g?0:d.getFloorThickness())||b===Room3D.CEILING_PART&&e.getGroundElevation()<d.getElevation()+d.getHeight()&&e.getGroundElevation()+e.getHeight()>=d.getElevation()+d.getHeight()))){a.push(e)}}}}return a};Room3D.prototype.getReversedArray=function(a){a=a.slice(0);return a.reverse()};Room3D.prototype.getRoomHeightAt=function(q,p){var J=Infinity;var F=this.getUserData();var E=this.getHome();var g=F.getLevel();var o=g!==null?g.getElevation():0;var r=o+(g==null?E.getWallHeight():g.getHeight());var h=E.getLevels();if(g==null||this.isLastLevel(g,h)){var H=E.getWalls();if(F.isCeilingFlat()){var j=false;for(var k=0;k<H.length;k++){var D=H[k];if((D.getLevel()===null||D.getLevel().isViewable())&&D.isAtLevel(g)){if(D.getHeight()!==null){var G=D.getHeight();if(D.getLevel()!==null){G+=D.getLevel().getElevation()}if(j){r=Math.max(r,G)}else{r=G;j=true}}if(D.getHeightAtEnd()!==null){var v=D.getHeightAtEnd();if(D.getLevel()!==null){v+=D.getLevel().getElevation()}if(j){r=Math.max(r,v)}else{r=v;j=true}}}}}else{var m=null;var I=null;var C=-1;for(var k=0;k<H.length;k++){var D=H[k];if((D.getLevel()===null||D.getLevel().isViewable())&&D.isAtLevel(g)){var B=D.getPoints();for(var A=0;A<B.length;A++){var d=java.awt.geom.Point2D.distanceSq(B[A][0],B[A][1],q,p);if(d<J){m=D;I=B;C=A;J=d}}}}if(m!=null){r=m.getLevel()==null?0:m.getLevel().getElevation();var t=m.getHeight();if(C===0||C===I.length-1){r+=t!=null?t:E.getWallHeight()}else{if(m.isTrapezoidal()){var u=m.getArcExtent();if(u==null||u===0||C===Math.floor(I.length/2)||C===Math.floor(I.length/2)-1){r+=m.getHeightAtEnd()}else{var f=m.getXArcCircleCenter();var s=m.getYArcCircleCenter();var c=I[C][0];var l=I[C][1];var w=java.awt.geom.Point2D.distance(f,s,c,l);var e=m.getXStart();var n=m.getYStart();var b=java.awt.geom.Point2D.distance(f,s,e,n);var a=(c-f)*(e-f)+(l-s)*(n-s);a/=(w*b);var z=Math.acos(a)*(u>0?1:(u<0?-1:0));r+=t+(m.getHeightAtEnd()-t)*z/u}}else{r+=(t!=null?t:E.getWallHeight())}}}}}return r};Room3D.prototype.isLastLevel=function(b,a){return a.indexOf(b)===a.length-1};Room3D.prototype.createRoomSelectionGeometry=function(){var a=this.getUserData();var o=a.getLevel();var r=this.getHome().getLevels();var h;var l;if(o!=null){l=o.getElevation();h=l-o.getFloorThickness()}else{l=0;h=0}var f;if(r.length==0){f=0}else{f=r[0].getElevation()}var q=a.isFloorVisible();var p=q&&o!=null&&l!=f;var b=a.getPoints();var n=a.isCeilingVisible();if(!q&&!n){q=true}var g=new Array(b.length*((q?(p?2:1):0)+(n?1:0)));var m=new Array((q?(p?b.length*6:b.length*2):0)+(n?(b.length*2):0));var d=0,c=0;if(q){for(var e=0;e<b.length;e++,d++){g[d]=vec3.fromValues(b[e][0],l,b[e][1]);m[c++]=d;if(e>0){m[c++]=d}}m[c++]=0;if(p){for(var e=0;e<b.length;e++,d++){g[d]=vec3.fromValues(b[e][0],h,b[e][1]);m[c++]=d;if(e>0){m[c++]=d}}m[c++]=b.length;for(var e=0;e<b.length;e++){m[c++]=e;m[c++]=e+b.length}}}if(n){for(var e=0;e<b.length;e++,d++){g[d]=vec3.fromValues(b[e][0],this.getRoomHeightAt(b[e][0],b[e][1]),b[e][1]);m[c++]=d;if(e>0){m[c++]=d}}m[c++]=g.length-b.length}return new IndexedLineArray3D(g,m)};Room3D.prototype.updateRoomAppearance=function(e){var d=this.getUserData();var f=d.getLevel()==null||d.getLevel().getElevation()<=0;this.updateRoomPartAppearance(this.getChild(Room3D.FLOOR_PART).getAppearance(),d.getFloorTexture(),e,d.getFloorColor(),d.getFloorShininess(),d.isFloorVisible(),f,true);var c=this.getChildren().length;if(c>2){var a=d.getLevel()==null;this.updateRoomPartAppearance(this.getChild(Room3D.CEILING_PART).getAppearance(),d.getCeilingTexture(),e,d.getCeilingColor(),d.getCeilingShininess(),d.isCeilingVisible(),a,false)}var b=this.getChild(c>2?2:1).getAppearance();b.setVisible(this.getUserPreferences()!=null&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(d))};Room3D.prototype.updateRoomPartAppearance=function(f,k,d,c,j,b,h,e){if(k==null){this.updateAppearanceMaterial(f,c,c,j);f.setTextureImage(null)}else{this.updateAppearanceMaterial(f,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,j);var a=this.getUserData();if(k.isFittingArea()){this.updateTextureTransformFittingArea(f,k,a.getPoints(),e)}else{this.updateTextureTransform(f,k,true)}TextureManager.getInstance().loadTexture(k.getImage(),d,{textureUpdated:function(l){f.setTextureImage(l)},textureError:function(l){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}var g=this.getHome().getEnvironment().getWallsAlpha();if(h||g===0){f.setTransparency(0)}else{f.setTransparency(g)}f.setVisible(b)};function Wall3D(b,g,c,f){if(f===undefined){f=c;c=null}Object3DBranch.call(this,b,g,c);for(var d=0;d<8;d++){var a=new Group3D();a.addChild(this.createWallPartShape());this.addChild(a)}var e=new Shape3D();e.setAppearance(this.getSelectionAppearance());e.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);e.setPickable(false);this.addChild(e);this.updateWallGeometry(f);this.updateWallAppearance(f)}Wall3D.prototype=Object.create(Object3DBranch.prototype);Wall3D.prototype.constructor=Wall3D;Wall3D.LEVEL_ELEVATION_SHIFT=0.1;Wall3D.FULL_FACE_CUT_OUT_AREA=new java.awt.geom.Area(new java.awt.geom.Rectangle2D.Float(-0.5,0.5,1,1));Wall3D.WALL_LEFT_SIDE=0;Wall3D.WALL_RIGHT_SIDE=1;Wall3D.rotatedModelsFrontAreas=[];Wall3D.prototype.createWallPartShape=function(){var b=new Shape3D();b.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);var a=new Appearance3D();b.setAppearance(a);this.updateAppearanceMaterial(a,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);return b};Wall3D.prototype.update=function(){this.updateWallGeometry(false);this.updateWallAppearance(false)};Wall3D.prototype.updateWallGeometry=function(a){this.updateWallSideGeometry(Wall3D.WALL_LEFT_SIDE,a);this.updateWallSideGeometry(Wall3D.WALL_RIGHT_SIDE,a);this.setPickable(this.getHome().getEnvironment().getWallsAlpha()==0);var b=this.getChild(8);b.addGeometry(this.createWallSelectionGeometry());if(b.getGeometries().length>1){b.removeGeometry(0)}};Wall3D.prototype.updateWallSideGeometry=function(b,l){var n=this.getUserData();var d;var a;if(b===Wall3D.WALL_LEFT_SIDE){d=n.getLeftSideTexture();a=n.getLeftSideBaseboard()}else{d=n.getRightSideTexture();a=n.getRightSideBaseboard()}var m=[this.getChild(b),this.getChild(b+2),this.getChild(b+4),this.getChild(b+6)];var g=new Array(m.length);var h=new Array(m.length);for(var f=0;f<m.length;f++){g[f]=m[f].getChild(0);h[f]=g[f].getGeometries().length}if(n.getLevel()==null||n.getLevel().isViewableAndVisible()){var o=[[],[],[],[]];this.createWallGeometries(o[0],o[2],o[3],b,null,d,l);if(a!=null){var c=a.getTexture();if(c===null&&a.getColor()===null){c=d}this.createWallGeometries(o[1],o[1],o[1],b,a,c,l)}for(var f=0;f<m.length;f++){for(var e=0;e<o[f].length;e++){var k=o[f][e];if(k!==null){g[f].addGeometry(k)}}}}for(var f=0;f<m.length;f++){for(var e=h[f]-1;e>=0;e--){g[f].removeGeometry(e)}}};Wall3D.prototype.createWallGeometries=function(x,W,N,ai,ag,ae,av){var aw=this.getUserData();var at=this.getShape(aw.getPoints());var af=this.getWallSidePoints(ai);var y=this.getShape(af);var K=ag==null?af:this.getWallBaseboardPoints(ai);var aq=this.getShape(K);var a=new java.awt.geom.Area(aq);var V=ai===Wall3D.WALL_LEFT_SIDE?K[0].slice(0):K[K.length-1].slice(0);var k=this.getWallElevation(ag!==null);var ab;var j;if(ag===null){ab=this.getWallTopElevationAtStart();j=this.getWallTopElevationAtEnd()}else{ab=j=this.getBaseboardTopElevation(ag)}var s=Math.max(ab,j);var O=Math.atan2(aw.getYEnd()-aw.getYStart(),aw.getXEnd()-aw.getXStart());var J=Math.cos(O);var P=Math.sin(O);var ak=J*aw.getXStart()+P*aw.getYStart();var g=J*aw.getXEnd()+P*aw.getYEnd();var R=aw.getArcExtent();var am=R!==null&&R!==0;var u;var b;if(ab===j){u=0;b=ab}else{u=(j-ab)/(g-ak);b=ab-u*ak}var z=[];var t=[];var o=this.getVisibleDoorsAndWindows(this.getHome().getFurniture());for(var H=0;H<o.length;H++){var an=o[H];var q=an.getGroundElevation();if(q+an.getHeight()>k&&q<s){var d=new java.awt.geom.Area(this.getShape(an.getPoints()));var S=new java.awt.geom.Area(at);S.intersect(d);if(!S.isEmpty()){var l=null;if(an.isParallelToWall(aw)){if(ag!==null){l=an.clone();l.setDepthInPlan(l.getDepth()+2*ag.getThickness())}if(typeof HomeDoorOrWindow!=="undefined"&&an instanceof HomeDoorOrWindow){if(an.isWallCutOutOnBothSides()){if(l===null){l=an.clone()}l.setDepthInPlan(l.getDepth()+4*aw.getThickness())}}}if(l!==null){d=new java.awt.geom.Area(this.getShape(l.getPoints()));S=new java.awt.geom.Area(aq);S.intersect(d)}else{S=new java.awt.geom.Area(y);S.intersect(d)}if(!S.isEmpty()&&(!aw.isTrapezoidal()||q<this.getMaxElevationAtWallIntersection(S,J,P,u,b))){z.push(new Wall3D.DoorOrWindowArea(S,[an]));t.push(an);a.subtract(d)}}}}if(z.length>1){for(var L=0;L<z.length;L++){var X=z[L];var ar=[];var p=0;for(var H=0;H<z.length;H++){var ac=z[H];if(X.getArea().isEmpty()){break}else{if(p>L){var aj=new java.awt.geom.Area(ac.getArea());aj.intersect(X.getArea());if(!aj.isEmpty()){ac.getArea().subtract(aj);X.getArea().subtract(aj);var m=(X.getDoorsOrWindows().slice(0));m.push.apply(m,ac.getDoorsOrWindows());ar.push(new Wall3D.DoorOrWindowArea(aj,m))}}}p++}z.push.apply(z,ar)}}var G=[];var e=null;for(var B=a.getPathIterator(null);!B.isDone();B.next()){var aa=[0,0];if(B.currentSegment(aa)===java.awt.geom.PathIterator.SEG_CLOSE){if(G.length>2){if(G[0][0]===G[G.length-1][0]&&G[0][1]===G[G.length-1][1]){G.splice(G.length-1,1)}if(G.length>2){var r=G.slice(0);W.push(this.createVerticalPartGeometry(aw,r,k,J,P,u,b,ag,ae,V,ai));x.push(this.createHorizontalPartGeometry(r,k,true,am));N.push(this.createTopPartGeometry(r,J,P,u,b,am))}}G.length=0;e=null}else{if(e===null||aa[0]!==e[0]||aa[1]!==e[1]){G.push(aa);e=aa}}}var U=aw.getLevel();e=null;for(var ap=0;ap<z.length;ap++){var X=z[ap];if(!X.getArea().isEmpty()){for(var B=X.getArea().getPathIterator(null);!B.isDone();B.next()){var aa=[0,0];if(B.currentSegment(aa)===java.awt.geom.PathIterator.SEG_CLOSE){if(G[0][0]===G[G.length-1][0]&&G[0][1]===G[G.length-1][1]){G.splice(G.length-1,1)}if(G.length>2){var r=G.slice(0);var m=X.getDoorsOrWindows();if(m.length>1){m.sort(function(aA,ay){var ax=aA.getGroundElevation();var az=ay.getGroundElevation();if(ax<az){return -1}else{if(ax>az){return 1}else{return 0}}})}var n=m[0];var C=n.getGroundElevation();if(C>k){if(U!=null&&U.getElevation()!==k&&n.getElevation()<Wall3D.LEVEL_ELEVATION_SHIFT){C-=Wall3D.LEVEL_ELEVATION_SHIFT}W.push(this.createVerticalPartGeometry(aw,r,k,J,P,0,C,ag,ae,V,ai));x.push(this.createHorizontalPartGeometry(r,k,true,am));W.push(this.createHorizontalPartGeometry(r,C,false,am))}for(var H=0;H<m.length-1;){var A=m[H];var T=A.getGroundElevation();var E=m[++H];var Z=E.getGroundElevation();while((T+A.getHeight()>=Z+E.getHeight()&&++H<m.length)){E=m[H]}if(H<m.length&&T+A.getHeight()<Z){W.push(this.createVerticalPartGeometry(aw,r,T+A.getHeight(),J,P,0,Z,ag,ae,V,ai));W.push(this.createHorizontalPartGeometry(r,T+A.getHeight(),true,am));W.push(this.createHorizontalPartGeometry(r,Z,false,am))}}var Q=m[m.length-1];var f=Q.getGroundElevation();for(var H=m.length-2;H>=0;H--){var v=m[H];if(v.getGroundElevation()+v.getHeight()>f+Q.getHeight()){Q=v}}var ad=f+Q.getHeight();var ah=true;for(var H=0;H<r.length;H++){var D=J*r[H][0]+P*r[H][1];var F=u*D+b;if(ad>F){if(u===0||am){ah=false;break}var c=(ad-F)/u;r[H][0]+=(c*J);r[H][1]+=(c*P)}}if(ah){W.push(this.createVerticalPartGeometry(aw,r,ad,J,P,u,b,ag,ae,V,ai));W.push(this.createHorizontalPartGeometry(r,ad,true,am));N.push(this.createTopPartGeometry(r,J,P,u,b,am))}}G.length=0;e=null}else{if(e==null||aa[0]!==e[0]||aa[1]!==e[1]){G.push(aa);e=aa}}}}}if(!am&&t.length>0){var M=Math.PI/720;var au=[];for(var H=0;H<t.length;H++){var an=t[H];if(typeof HomeDoorOrWindow!=="undefined"&&an instanceof HomeDoorOrWindow&&(PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE!=an.getCutOutShape()||an.getWallWidth()!==1||an.getWallLeft()!==0||an.getWallHeight()!==1||an.getWallTop()!==0)){var al=Math.abs(O-an.getAngle())%(2*Math.PI);if(al<M||al>2*Math.PI-M||Math.abs(al-Math.PI)<M){var h=Math.abs(al-Math.PI)<M?1:-1;var w=Wall3D.getRotatedModelFrontArea(an);if(w!==null&&(au.length===0||!av)){this.createGeometriesSurroundingDoorOrWindow(an,w,h,aw,W,N,K,k,J,P,u,b,ae,V,ai)}else{au.push(an)}}}}if(au.length>0){var I=ModelManager.getInstance();au=au.slice(0);var ao=this;for(var H=0;H<au.length;H++){var Y={doorOrWindow:au[H],modelUpdated:function(aC){var az=Wall3D.getRotatedModelFrontArea(this.doorOrWindow);var ay;if(az===null){var aA=new TransformGroup3D(I.getRotationTransformation(this.doorOrWindow.getModelRotation()));aA.addChild(aC);ay=I.getFrontArea(this.doorOrWindow.getCutOutShape(),aA);Wall3D.rotatedModelsFrontAreas.push({model:this.doorOrWindow.getModel(),modelRotation:this.doorOrWindow.getModelRotation(),cutOutShape:this.doorOrWindow.getCutOutShape(),frontArea:ay})}var ax=Math.abs(O-this.doorOrWindow.getAngle())%(2*Math.PI);var aB=Math.abs(ax-Math.PI)<M?1:-1;if(av){ao.createGeometriesSurroundingDoorOrWindow(this.doorOrWindow,ay,aB,aw,W,N,K,k,J,P,u,b,ae,V,ai)}else{au.splice(au.indexOf(this.doorOrWindow),1);if(au.length===0&&this.baseboard==null){setTimeout(function(){ao.updateWallSideGeometry(ai,av)},0)}}},modelError:function(ax){if(Wall3D.getRotatedModelFrontArea(this.doorOrWindow)===null){Wall3D.rotatedModelsFrontAreas.push({model:this.doorOrWindow.getModel(),modelRotation:this.doorOrWindow.getModelRotation(),cutOutShape:this.doorOrWindow.getCutOutShape(),frontArea:Wall3D.FULL_FACE_CUT_OUT_AREA})}if(!av){au.splice(au.indexOf(this.doorOrWindow),1)}}};I.loadModel(au[H].getModel(),av,Y)}}}};Wall3D.getRotatedModelFrontArea=function(c){var a=null;for(var b=0;b<Wall3D.rotatedModelsFrontAreas.length;b++){if(Wall3D.rotatedModelsFrontAreas[b].model.equals(c.getModel())&&Object3DBranch.areModelRotationsEqual(Wall3D.rotatedModelsFrontAreas[b].modelRotation,c.getModelRotation())&&Wall3D.rotatedModelsFrontAreas[b].cutOutShape==c.getCutOutShape()){return Wall3D.rotatedModelsFrontAreas[b].frontArea}}return null};Wall3D.prototype.getVisibleDoorsAndWindows=function(d){var c=[];for(var a=0;a<d.length;a++){var b=d[a];if(b.isVisible()&&(b.getLevel()==null||b.getLevel().isViewableAndVisible())){if(b instanceof HomeFurnitureGroup){c.push.apply(c,this.getVisibleDoorsAndWindows(b.getFurniture()))}else{if(b.isDoorOrWindow()){c.push(b)}}}}return c};Wall3D.prototype.getWallSidePoints=function(c){var a=this.getUserData();var b=a.getPoints();if(c===Wall3D.WALL_LEFT_SIDE){for(var d=(b.length/2|0);d<b.length;d++){b[d][0]=(b[d][0]+b[b.length-d-1][0])/2;b[d][1]=(b[d][1]+b[b.length-d-1][1])/2}}else{for(var d=0,e=(b.length/2|0);d<e;d++){b[d][0]=(b[d][0]+b[b.length-d-1][0])/2;b[d][1]=(b[d][1]+b[b.length-d-1][1])/2}}return b};Wall3D.prototype.getWallBaseboardPoints=function(c){var a=this.getUserData();var e=a.getPoints$boolean(true);var b=a.getPoints();if(c===Wall3D.WALL_LEFT_SIDE){for(var d=Math.floor(e.length/2);d<e.length;d++){e[d]=b[b.length-d-1]}}else{for(var d=0,f=Math.floor(b.length/2);d<f;d++){e[d]=b[b.length-d-1]}}return e};Wall3D.prototype.createVerticalPartGeometry=function(m,L,ab,D,B,T,q,b,u,ad,ac){var x=this.getHome().getEnvironment().getSubpartSizeUnderLight();var e=m.getArcExtent();if((e===null||e===0)&&x>0){var M=[];M.push(L[0]);for(var X=1;X<L.length;X++){var z=java.awt.geom.Point2D.distance(L[X-1][0],L[X-1][1],L[X][0],L[X][1])-x/2;var t=Math.atan2(L[X][1]-L[X-1][1],L[X][0]-L[X-1][0]);var C=Math.cos(t);var l=Math.sin(t);for(var aa=0;aa<z;aa+=x){M.push([(L[X-1][0]+aa*C),(L[X-1][1]+aa*l)])}M.push(L[X])}L=M.slice(0)}var a=new Array(L.length);var g=new Array(L.length);var E=new Array(L.length);var k=m.getXStart();var I=m.getYStart();var s=m.getXEnd();var O=m.getYEnd();var W=null;var H=0;var S=0;if(e!==null&&e!==0){W=[m.getXArcCircleCenter(),m.getYArcCircleCenter()];H=java.awt.geom.Point2D.distance(W[0],W[1],k,I);S=Math.fround(Math.atan2(ad[1]-W[1],ad[0]-W[0]))}for(var X=0;X<L.length;X++){a[X]=vec3.fromValues(L[X][0],ab,L[X][1]);var o=this.getWallPointElevation(L[X][0],L[X][1],D,B,T,q);g[X]=vec3.fromValues(L[X][0],o,L[X][1])}var p=new Array(L.length);for(var X=0;X<L.length;X++){if(W===null){p[X]=java.awt.geom.Line2D.ptLineDistSq(k,I,s,O,a[X][0],a[X][2])}else{p[X]=H-java.awt.geom.Point2D.distance(W[0],W[1],a[X][0],a[X][2]);p[X]*=p[X]}}var ae=L.length;var h=new Array(L.length);if(b===null){for(var X=0;X<L.length-1;X++){h[X]=p[X]>0.001||p[X+1]>0.001;if(!h[X]){ae--}}h[h.length-1]=p[0]>0.001||p[L.length-1]>0.001;if(!h[h.length-1]){ae--}if(ae===0){return null}}else{for(var X=0;X<h.length;X++){h[X]=true}}var n=[];for(var G=0;G<L.length;G++){if(h[G]){var K=ab;var w=a[G];var r=(G+1)%L.length;var v=a[r];if(x>0){for(var U=Math.min(g[G][1],g[r][1])-x/2;K<U;K+=x){n.push(w);n.push(v);w=vec3.fromValues(a[G][0],K,a[G][2]);v=vec3.fromValues(a[r][0],K,a[r][2]);n.push(v);n.push(w)}}n.push(w);n.push(v);n.push(g[r]);n.push(g[G])}}var P=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);P.setCoordinates(n.slice(0));if(u!==null){var Q;if(b!==null){Q=m.getThickness()/2+b.getThickness();Q*=Q}else{Q=(m.getThickness()*m.getThickness())/4}var Z=new Array(n.length);var A=vec2.fromValues(0,ab);var V=0;var R=W===null?m.getThickness()/10000:Q/4;for(var G=0;G<L.length;G++){if(h[G]){var r=(G+1)%L.length;var N;var J;if(Math.abs(p[G]-Q)<R&&Math.abs(p[r]-Q)<R){var f;var F;if(W===null){f=java.awt.geom.Point2D.distance(ad[0],ad[1],L[G][0],L[G][1]);F=java.awt.geom.Point2D.distance(ad[0],ad[1],L[r][0],L[r][1])}else{if(E[G]===undefined){var c=Math.fround(Math.atan2(L[G][1]-W[1],L[G][0]-W[0]));c=this.adjustAngleOnReferencePointAngle(c,S,e);E[G]=(c-S)*H}if(E[r]===undefined){var c=Math.fround(Math.atan2(L[r][1]-W[1],L[r][0]-W[0]));c=this.adjustAngleOnReferencePointAngle(c,S,e);E[r]=(c-S)*H}f=E[G];F=E[r]}if(ac===Wall3D.WALL_LEFT_SIDE&&u.isLeftToRightOriented()){f=-f;F=-F}N=vec2.fromValues(f,ab);J=vec2.fromValues(F,ab)}else{N=A;var Y=java.awt.geom.Point2D.distance(L[G][0],L[G][1],L[r][0],L[r][1]);J=vec2.fromValues(Y,ab)}if(x>0){var K=ab;for(var U=Math.min(g[G][1],g[r][1])-x/2;K<U;K+=x){Z[V++]=N;Z[V++]=J;N=vec2.fromValues(N[0],K);J=vec2.fromValues(J[0],K);Z[V++]=J;Z[V++]=N}}Z[V++]=N;Z[V++]=J;Z[V++]=vec2.fromValues(J[0],g[r][1]);Z[V++]=vec2.fromValues(N[0],g[G][1])}}P.setTextureCoordinates(Z)}if(W===null){P.setCreaseAngle(0)}P.setGeneratedNormals(true);return P.getIndexedGeometryArray()};Wall3D.prototype.getMaxElevationAtWallIntersection=function(b,a,c,e,f){var g=-Infinity;for(var d=b.getPathIterator(null);!d.isDone();d.next()){var h=[0,0];if(d.currentSegment(h)!==java.awt.geom.PathIterator.SEG_CLOSE){g=Math.max(g,this.getWallPointElevation(h[0],h[1],a,c,e,f))}}return g};Wall3D.prototype.getWallPointElevation=function(e,g,a,b,c,d){var f=a*e+b*g;return(c*f+d)};Wall3D.prototype.adjustAngleOnReferencePointAngle=function(a,b,c){if(c>0){if((b>0&&(a<0||a<b))||(b<0&&a<b)){a+=2*Math.PI}}else{if((b<0&&(a>0||b<a))||(b>0&&b<a)){a-=2*Math.PI}}return a};Wall3D.prototype.createHorizontalPartGeometry=function(c,g,f,d){var e=new Array(c.length);for(var b=0;b<c.length;b++){e[b]=vec3.fromValues(c[b][0],g,c[b][1])}var a=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);a.setCoordinates(f?e.reverse():e);a.setStripCounts([e.length]);if(d){a.setCreaseAngle(0)}a.setGeneratedNormals(true);return a.getIndexedGeometryArray()};Wall3D.prototype.createTopPartGeometry=function(k,b,g,d,c,l){var j=new Array(k.length);for(var f=0;f<k.length;f++){var h=b*k[f][0]+g*k[f][1];var a=(d*h+c);j[f]=vec3.fromValues(k[f][0],a,k[f][1])}var e=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);e.setCoordinates(j);e.setStripCounts([j.length]);if(l){e.setCreaseAngle(0)}e.setGeneratedNormals(true);return e.getIndexedGeometryArray()};Wall3D.prototype.createGeometriesSurroundingDoorOrWindow=function(N,b,L,n,O,c,v,X,C,A,Y,r,u,ai,ah){if(N.getModelTransformations()!==null){b=new java.awt.geom.Area(b);b.transform(java.awt.geom.AffineTransform.getTranslateInstance(0.5,0.5));b.transform(java.awt.geom.AffineTransform.getScaleInstance(N.getWidth()*N.getWallWidth(),N.getHeight()*N.getWallHeight()));b.transform(java.awt.geom.AffineTransform.getTranslateInstance(N.getWallLeft()*N.getWidth(),(1-N.getWallHeight()-N.getWallTop())*N.getHeight()));b.transform(java.awt.geom.AffineTransform.getScaleInstance(1/N.getWidth(),1/N.getHeight()));b.transform(java.awt.geom.AffineTransform.getTranslateInstance(-0.5,-0.5))}var h=new java.awt.geom.Area(Wall3D.FULL_FACE_CUT_OUT_AREA);h.subtract(b);if(!h.isEmpty()){var y=N.getDepth();var k=(N.getX()-L*y/2*Math.sin(N.getAngle()));var t=(N.getY()+L*y/2*Math.cos(N.getAngle()));var aa=ah===Wall3D.WALL_LEFT_SIDE?v[0]:v[v.length-1];var W=ah===Wall3D.WALL_LEFT_SIDE?v[(v.length/2|0)-1]:v[(v.length/2|0)];var I=java.awt.geom.Line2D.ptLineDist(aa[0],aa[1],W[0],W[1],k,t);var R=java.awt.geom.Line2D.relativeCCW(aa[0],aa[1],W[0],W[1],k,t);var S=L*(0.5-R*I/y);var p=ModelManager.getInstance().getPieceOfFurnitureNormalizedModelTransformation(N,null);var e=mat4.create();mat4.fromTranslation(e,vec3.fromValues(0,0,S));mat4.mul(p,p,e);var E=mat4.create();mat4.invert(E,p);var w=new java.awt.geom.GeneralPath();var M=vec3.fromValues(aa[0],X,aa[1]);vec3.transformMat4(M,M,E);w.moveTo(M[0],M[1]);M=vec3.fromValues(W[0],X,W[1]);vec3.transformMat4(M,M,E);w.lineTo(M[0],M[1]);var d=vec3.fromValues(W[0],this.getWallPointElevation(W[0],W[1],C,A,Y,r),W[1]);vec3.transformMat4(d,d,E);w.lineTo(d[0],d[1]);var a=vec3.fromValues(aa[0],this.getWallPointElevation(aa[0],aa[1],C,A,Y,r),aa[1]);vec3.transformMat4(a,a,E);w.lineTo(a[0],a[1]);w.closePath();var T=new java.awt.geom.GeneralPath();T.moveTo(-0.5,-0.5);T.lineTo(-0.5,0.5);T.lineTo(0.5,0.5);T.lineTo(0.5,-0.5);T.closePath();var H=new java.awt.geom.Area(T);H.intersect(new java.awt.geom.Area(w));H.subtract(b);var q=0.5/(Math.max(N.getWidth(),N.getHeight()));if(!H.isEmpty()){var ac=L>0!==(ah===Wall3D.WALL_RIGHT_SIDE)!==N.isModelMirrored();var x=this.getAreaPoints(H,q,ac);if(!(x.length===0)){var V=new Array(x.length);var ae=0;for(var ab=0;ab<x.length;ab++){var f=x[ab];V[ab]=f.length+1;ae+=V[ab]}var l=n.getThickness()/2;var F=l*A;var aj=-l*C;if(ah===Wall3D.WALL_LEFT_SIDE){F*=-1;aj*=-1}var m=new Array(ae);var z=([]);var B=([]);var af;var D;if(u!=null){af=new Array(m.length);D=[]}else{af=null;D=null}var ab=0;for(var G=0;G<x.length;G++){var f=x[G];var K=vec3.fromValues(f[0][0],f[0][1],0);vec3.transformMat4(K,K,p);var J=null;if(u!=null){var ad=java.awt.geom.Point2D.distance(ai[0],ai[1],K[0],K[2]);if(ah===Wall3D.WALL_LEFT_SIDE&&u.isLeftToRightOriented()){ad=-ad}J=vec2.fromValues(ad,K[1])}var Q=java.awt.geom.Line2D.ptLineDistSq(d[0],d[1],a[0],a[1],f[0][0],f[0][1]);for(var Z=0;Z<f.length;Z++,ab++){m[ab]=K;if(u!=null){af[ab]=J}var ag=Z<f.length-1?Z+1:0;var o;var g=java.awt.geom.Line2D.ptLineDistSq(d[0],d[1],a[0],a[1],f[ag][0],f[ag][1]);if(Q<1e-10&&g<1e-10){o=B}else{o=z}var s=vec3.fromValues(f[ag][0],f[ag][1],0);vec3.transformMat4(s,s,p);o.push(K);o.push(vec3.fromValues(K[0]+F,K[1],K[2]+aj));o.push(vec3.fromValues(s[0]+F,s[1],s[2]+aj));o.push(s);var P=null;if(u!=null){var ad=java.awt.geom.Point2D.distance(ai[0],ai[1],s[0],s[2]);if(ah===Wall3D.WALL_LEFT_SIDE&&u.isLeftToRightOriented()){ad=-ad}P=vec2.fromValues(ad,s[1]);if(o===z){D.push(J);D.push(J);D.push(P);D.push(P)}}Q=g;K=s;J=P}m[ab]=K;if(u!=null){af[ab]=J}ab++}var U=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);U.setStripCounts(V);U.setCoordinates(m);if(u!==null){U.setTextureCoordinates(af)}U.setGeneratedNormals(true);O.push(U.getIndexedGeometryArray());if(z.length>0){U=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);U.setCoordinates(z.slice(0));if(u!==null){U.setTextureCoordinates(D.slice(0))}U.setCreaseAngle(Math.PI/2);U.setGeneratedNormals(true);O.push(U.getIndexedGeometryArray())}if(B.length>0){U=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);U.setCoordinates(B.slice(0));U.setGeneratedNormals(true);c.push(U.getIndexedGeometryArray())}}}}};Wall3D.prototype.getWallElevation=function(b){var a=this.getUserData();var d=a.getLevel();if(d===null){return 0}else{if(b){return d.getElevation()}else{var c=this.getFloorThicknessBottomWall();if(c>0){c-=Wall3D.LEVEL_ELEVATION_SHIFT}return d.getElevation()-c}}};Wall3D.prototype.getFloorThicknessBottomWall=function(){var a=this.getUserData();var c=a.getLevel();if(c==null){return 0}else{var b=this.getHome().getLevels();if(!(b.length===0)&&b[0].getElevation()===c.getElevation()){return 0}else{return c.getFloorThickness()}}};Wall3D.prototype.getWallTopElevationAtStart=function(){var a=this.getUserData().getHeight();var b;if(a!==null){b=a+this.getWallElevation(false)+this.getFloorThicknessBottomWall()}else{b=this.getHome().getWallHeight()+this.getWallElevation(false)+this.getFloorThicknessBottomWall()}return b+this.getTopElevationShift()};Wall3D.prototype.getTopElevationShift=function(){var b=this.getUserData().getLevel();if(b!==null){var a=this.getHome().getLevels();if(a[a.length-1]!==b){return Wall3D.LEVEL_ELEVATION_SHIFT}}return 0};Wall3D.prototype.getWallTopElevationAtEnd=function(){var a=this.getUserData();if(a.isTrapezoidal()){return a.getHeightAtEnd()+this.getWallElevation(false)+this.getFloorThicknessBottomWall()+this.getTopElevationShift()}else{return this.getWallTopElevationAtStart()}};Wall3D.prototype.getBaseboardTopElevation=function(a){return a.getHeight()+this.getWallElevation(true)};Wall3D.prototype.createWallSelectionGeometry=function(){var x=this.getUserData();var A=this.getWallElevation(true);var n=x.getLeftSideBaseboard();var w=x.getRightSideBaseboard();var a=x.getPoints();var f=x.getPoints(true);var p=new Array(a.length*2+(n!=null?4:0)+(w!=null?4:0));var g=new Array(a.length*4+(n!=null?12:4)+(w!=null?12:4));var u=0,s=0;for(var v=0;v<a.length;v++,u++){p[u]=vec3.fromValues(f[v][0],A,f[v][1]);g[s++]=u;if(v>0){g[s++]=u}}g[s++]=0;var z=this.getWallTopElevationAtStart();var o=this.getWallTopElevationAtEnd();var r=Math.atan2(x.getYEnd()-x.getYStart(),x.getXEnd()-x.getXStart());var d=Math.cos(r);var c=Math.sin(r);var l=d*x.getXStart()+c*x.getYStart();var h=d*x.getXEnd()+c*x.getYEnd();var e;var q;if(z==o){e=0;q=z}else{e=(o-z)/(h-l);q=z-e*l}for(var v=0;v<a.length;v++,u++){var b=d*a[v][0]+c*a[v][1];var y=e*b+q;p[u]=vec3.fromValues(a[v][0],y,a[v][1]);g[s++]=u;if(v>0){g[s++]=u}}g[s++]=a.length;g[s++]=0;if(n!=null){var t=this.getBaseboardTopElevation(n);p[u]=vec3.fromValues(f[0][0],Math.min(t,z),f[0][1]);g[s++]=u;g[s++]=u++;p[u]=vec3.fromValues(a[0][0],Math.min(t,z),a[0][1]);g[s++]=u;g[s++]=u++}g[s++]=a.length;g[s++]=a.length/2-1;if(n!=null){var t=this.getBaseboardTopElevation(n);p[u]=vec3.fromValues(f[a.length/2-1][0],Math.min(t,o),f[a.length/2-1][1]);g[s++]=u;g[s++]=u++;p[u]=vec3.fromValues(a[a.length/2-1][0],Math.min(t,o),a[a.length/2-1][1]);g[s++]=u;g[s++]=u++}g[s++]=a.length+a.length/2-1;g[s++]=a.length-1;if(w!=null){var m=this.getBaseboardTopElevation(w);p[u]=vec3.fromValues(f[a.length-1][0],Math.min(m,z),f[a.length-1][1]);g[s++]=u;g[s++]=u++;p[u]=vec3.fromValues(a[a.length-1][0],Math.min(m,z),a[a.length-1][1]);g[s++]=u;g[s++]=u++}g[s++]=2*a.length-1;g[s++]=a.length/2;if(w!=null){var m=this.getBaseboardTopElevation(w);p[u]=vec3.fromValues(f[a.length/2][0],Math.min(m,o),f[a.length/2][1]);g[s++]=u;g[s++]=u++;p[u]=vec3.fromValues(a[a.length/2][0],Math.min(m,o),a[a.length/2][1]);g[s++]=u;g[s++]=u++}g[s++]=a.length+a.length/2;return new IndexedLineArray3D(p,g)};Wall3D.prototype.updateWallAppearance=function(e){var j=this.getUserData();var b=j.getTopColor();var l=[this.getChild(0),this.getChild(2),this.getChild(4),this.getChild(6)];var a=[this.getChild(1),this.getChild(3),this.getChild(5),this.getChild(7)];for(var f=0;f<l.length;f++){if(f===1){var c=j.getLeftSideBaseboard();if(c!=null){var h=c.getTexture();var d=c.getColor();if(d===null&&h===null){h=j.getLeftSideTexture();d=j.getLeftSideColor()}this.updateFilledWallSideAppearance(l[f].getChild(0).getAppearance(),h,e,d,j.getLeftSideShininess())}var k=j.getRightSideBaseboard();if(k!=null){var h=k.getTexture();var d=k.getColor();if(d==null&&h==null){h=j.getRightSideTexture();d=j.getRightSideColor()}this.updateFilledWallSideAppearance(a[f].getChild(0).getAppearance(),h,e,d,j.getRightSideShininess())}}else{if(f!==3||b==null){this.updateFilledWallSideAppearance(l[f].getChild(0).getAppearance(),j.getLeftSideTexture(),e,j.getLeftSideColor(),j.getLeftSideShininess());this.updateFilledWallSideAppearance(a[f].getChild(0).getAppearance(),j.getRightSideTexture(),e,j.getRightSideColor(),j.getRightSideShininess())}else{this.updateFilledWallSideAppearance(l[f].getChild(0).getAppearance(),null,e,b,0);this.updateFilledWallSideAppearance(a[f].getChild(0).getAppearance(),null,e,b,0)}}}var g=this.getChild(8).getAppearance();g.setVisible(this.getUserPreferences()!=null&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(j))};Wall3D.prototype.updateFilledWallSideAppearance=function(f,a,d,c,b){if(a==null){this.updateAppearanceMaterial(f,c,c,b);f.setTextureImage(null)}else{this.updateAppearanceMaterial(f,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,b);this.updateTextureTransform(f,a,true);TextureManager.getInstance().loadTexture(a.getImage(),d,{textureUpdated:function(g){f.setTextureImage(g)},textureError:function(g){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}var e=this.getHome().getEnvironment().getWallsAlpha();f.setTransparency(e)};Wall3D.DoorOrWindowArea=function(a,b){this.area=a;this.doorsOrWindows=b};Wall3D.DoorOrWindowArea.prototype.getArea=function(){return this.area};Wall3D.DoorOrWindowArea.prototype.getDoorsOrWindows=function(){return this.doorsOrWindows};function Ground3D(h,l,k,a,e,b){Object3DBranch.call(this);this.setUserData(h);this.originX=l;this.originY=k;this.width=a;this.depth=e;var c=new Appearance3D();var f=new Shape3D();f.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);f.setAppearance(c);this.addChild(f);var j=new Appearance3D();this.updateAppearanceMaterial(j,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_COLOR,0);j.setCullFace(Appearance3D.CULL_NONE);var g=new TransformGroup3D();g.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);var d=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-0.5,0,-0.5),vec3.fromValues(-0.5,0,0.5),vec3.fromValues(0.5,0,0.5),vec3.fromValues(0.5,0,-0.5)],[0,1,2,0,2,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[3,0,1,3,1,2],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),j);g.addChild(d);this.addChild(g);this.update(b)}Ground3D.prototype=Object.create(Object3DBranch.prototype);Ground3D.prototype.constructor=Ground3D;Ground3D.prototype.update=function(c){if(c===undefined){c=false}var g=this.getUserData();var f=this.getChild(1);var d=f.getChild(0);var j=d.getAppearance();var h=null;if(g.getEnvironment().isBackgroundImageVisibleOnGround3D()){var k=g.getLevels();if(k.length>0){for(var e=k.length-1;e>=0;e--){var a=k[e];if(a.getElevation()==0&&a.isViewableAndVisible()&&a.getBackgroundImage()!==null&&a.getBackgroundImage().isVisible()){h=a.getBackgroundImage();break}}}else{if(g.getBackgroundImage()!==null&&g.getBackgroundImage().isVisible()){h=g.getBackgroundImage()}}}if(h!==null){var b=this;TextureManager.getInstance().loadTexture(h.getImage(),c,{textureUpdated:function(p){var q=h.getScale();var n=q*p.width;var l=q*p.height;var m=mat4.create();mat4.scale(m,m,vec3.fromValues(n,1,l));var o=mat4.create();mat4.fromTranslation(o,vec3.fromValues(n/2-h.getXOrigin(),0,l/2-h.getYOrigin()));mat4.mul(m,o,m);j.setTextureImage(p);f.setTransform(m);b.updateGround(c,new java.awt.geom.Rectangle2D.Float(-h.getXOrigin(),-h.getYOrigin(),n,l))},textureError:function(l){return this.textureUpdated(TextureManager.getInstance().getErrorImage())},progression:function(m,n,l){}});j.setVisible(true)}else{j.setVisible(false);this.updateGround(c,null)}};Ground3D.prototype.updateGround=function(r,K){var p=this.getUserData();var e=this.getChild(0);var d=e.getGeometries().length;var w=e.getAppearance();var v=p.getEnvironment().getGroundTexture();if(v===null){var s=p.getEnvironment().getGroundColor();this.updateAppearanceMaterial(w,s,s,0);w.setTextureImage(null)}else{this.updateAppearanceMaterial(w,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_COLOR,0);this.updateTextureTransform(w,v,true);TextureManager.getInstance().loadTexture(v.getImage(),r,{textureUpdated:function(j){w.setTextureImage(j)},textureError:function(j){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}var n=new java.awt.geom.Area();if(K!==null){n.add(new java.awt.geom.Area(K))}var a=[];var D=p.getRooms();for(var H=0;H<D.length;H++){var y=D[H];var B=y.getLevel();if((B===null||B.isViewable())&&y.isFloorVisible()){var f=y.getPoints();if(f.length>2){var h=new java.awt.geom.Area(this.getShape(f));var g=B!==null&&B.getElevation()<0?this.getUndergroundAreas(a,B):null;if(B===null||(B.getElevation()<=0&&B.isViewableAndVisible())){n.add(h);if(g!==null){g.roomArea.add(h)}}if(g!==null){g.undergroundArea.add(h)}}}}this.updateUndergroundAreasDugByFurniture(a,p.getFurniture());var t=p.getWalls();for(var H=0;H<t.length;H++){var q=t[H];var o=q.getLevel();if(o!==null&&o.isViewable()&&o.getElevation()<0){var g=this.getUndergroundAreas(a,o);g.wallArea.add(new java.awt.geom.Area(this.getShape(q.getPoints())))}}var u=a;for(var H=0;H<u.length;H++){var g=u[H];var b=this.getPoints(g.wallArea);for(var G=0;G<b.length;G++){var C=b[G];if(!new Room(C).isClockwise()){g.undergroundArea.add(new java.awt.geom.Area(this.getShape(C)))}}}u.sort(function(j,k){return -(j.level.getElevation()-k.level.getElevation())});for(var H=0;H<u.length;H++){var g=u[H];var l=g.level;var z=g.undergroundArea;var J=z.clone();g.undergroundSideArea.add(z.clone());for(var G=0;G<u.length;G++){var c=u[G];if(c.level.getElevation()<l.getElevation()){var b=this.getPoints(c.undergroundArea);for(var F=0;F<b.length;F++){var C=b[F];if(!new Room(C).isClockwise()){var L=new java.awt.geom.Area(this.getShape(C));z.subtract(L);g.undergroundSideArea.add(L)}}}}var b=this.getPoints(z);for(var G=0;G<b.length;G++){var C=b[G];if(new Room(C).isClockwise()){var I=new java.awt.geom.Area(this.getShape(C));I.exclusiveOr(J);I.subtract(J);g.upperLevelArea.add(I)}else{n.add(new java.awt.geom.Area(this.getShape(C)))}}}for(var H=0;H<u.length;H++){var g=u[H];var h=g.roomArea;if(h!==null){g.undergroundArea.subtract(h)}}var E=new java.awt.geom.Area(this.getShape([[this.originX,this.originY],[this.originX,this.originY+this.depth],[this.originX+this.width,this.originY+this.depth],[this.originX+this.width,this.originY]]));var A=n.getBounds2D();if(!E.getBounds2D().equals(A)){var x=E;if(n.isEmpty()){A=new java.awt.geom.Rectangle2D.Float(Math.max(-5000,this.originX),Math.max(-5000,this.originY),0,0);A.add(Math.min(5000,this.originX+this.width),Math.min(5000,this.originY+this.depth))}else{A.add(Math.max(A.getMinX()-5000,this.originX),Math.max(A.getMinY()-5000,this.originY));A.add(Math.min(A.getMaxX()+5000,this.originX+this.width),Math.min(A.getMaxY()+5000,this.originY+this.depth))}E=new java.awt.geom.Area(A);x.subtract(E);this.addAreaGeometry(e,v,x,0)}E.subtract(n);u.splice(0,0,new Ground3D.LevelAreas(new Level("Ground",0,0,0),E));var M=0;for(var H=0;H<u.length;H++){var g=u[H];var m=g.level.getElevation();this.addAreaGeometry(e,v,g.undergroundArea,m);if(M-m>0){var b=this.getPoints(g.undergroundSideArea);for(var G=0;G<b.length;G++){var C=b[G];this.addAreaSidesGeometry(e,v,C,m,M-m)}this.addAreaGeometry(e,v,g.upperLevelArea,M)}M=m}for(var H=d-1;H>=0;H--){e.removeGeometry(H)}};Ground3D.prototype.getPoints=function(d){var f=[];var e=[];var a=null;for(var c=d.getPathIterator(null,1);!c.isDone();c.next()){var b=[0,0];if(c.currentSegment(b)===java.awt.geom.PathIterator.SEG_CLOSE){if(e[0][0]===a[0]&&e[0][1]===a[1]){e.splice(e.length-1,1)}if(e.length>2){f.push(e.slice(0))}e.length=0;a=null}else{if(a===null||b[0]!==a[0]||b[1]!==a[1]){e.push(b)}a=b}}return f};Ground3D.prototype.getUndergroundAreas=function(a,d){var c=null;for(var b=0;b<a.length;b++){if(a[b].level===d){c=a[b];break}}if(c===null){a.push(c=new Ground3D.LevelAreas(d))}return c};Ground3D.prototype.updateUndergroundAreasDugByFurniture=function(a,e){for(var c=0;c<e.length;c++){var d=e[c];var b=d.getLevel();if(d.getGroundElevation()<0&&d.isVisible()&&b!==null&&b.isViewable()&&b.getElevation()<0){if(d instanceof HomeFurnitureGroup){this.updateUndergroundAreasDugByFurniture(a,d.getFurniture())}else{var f=this.getUndergroundAreas(a,b);if(d.getStaircaseCutOutShape()===null){f.undergroundArea.add(new java.awt.geom.Area(this.getShape(d.getPoints())))}else{f.undergroundArea.add(ModelManager.getInstance().getAreaOnFloor(d))}}}}};Ground3D.prototype.addAreaGeometry=function(h,c,b,q){var n=this.getAreaPoints(b,1,false);if(n.length!==0){var a=0;var l=new Array(n.length);for(var f=0;f<l.length;f++){l[f]=n[f].length;a+=l[f]}var k=new Array(a);var m=c!==null?new Array(a):null;var e=0;for(var g=0;g<n.length;g++){var p=n[g];for(var f=0;f<p.length;f++,e++){var o=p[f];k[e]=vec3.fromValues(o[0],q,o[1]);if(c!==null){m[e]=vec2.fromValues(o[0]-this.originX,this.originY-o[1])}}}var d=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);d.setCoordinates(k);if(c!==null){d.setTextureCoordinates(m)}d.setStripCounts(l);d.setCreaseAngle(0);d.setGeneratedNormals(true);h.addGeometry(d.getIndexedGeometryArray())}};Ground3D.prototype.addAreaSidesGeometry=function(f,b,m,o,h){var g=new Array(m.length*4);var k=b!==null?new Array(g.length):null;for(var e=0,d=0;e<m.length;e++){var n=m[e];var l=m[e<m.length-1?e+1:0];g[d++]=vec3.fromValues(n[0],o,n[1]);g[d++]=vec3.fromValues(n[0],o+h,n[1]);g[d++]=vec3.fromValues(l[0],o+h,l[1]);g[d++]=vec3.fromValues(l[0],o,l[1]);if(b!==null){var a=java.awt.geom.Point2D.distance(n[0],n[1],l[0],l[1]);k[d-4]=vec2.fromValues(n[0],o);k[d-3]=vec2.fromValues(n[0],o+h);k[d-2]=vec2.fromValues(n[0]-a,o+h);k[d-1]=vec2.fromValues(n[0]-a,o)}}var c=new GeometryInfo3D(GeometryInfo3D.QUAD_ARRAY);c.setCoordinates(g);if(b!==null){c.setTextureCoordinates(k)}c.setCreaseAngle(0);c.setGeneratedNormals(true);f.addGeometry(c.getIndexedGeometryArray())};Ground3D.LevelAreas=function(b,a){if(a===undefined){a=new java.awt.geom.Area()}this.level=b;this.undergroundArea=a;this.roomArea=new java.awt.geom.Area();this.wallArea=new java.awt.geom.Area();this.undergroundSideArea=new java.awt.geom.Area();this.upperLevelArea=new java.awt.geom.Area()};function Polyline3D(b,d,a,c){if(c===undefined){c=a;a=null}Object3DBranch.call(this,b,d,a);if(Polyline3D.ARROW===null){Polyline3D.ARROW=new java.awt.geom.GeneralPath();Polyline3D.ARROW.moveTo(-5,-2);Polyline3D.ARROW.lineTo(0,0);Polyline3D.ARROW.lineTo(-5,2)}this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);this.update()}Polyline3D.prototype=Object.create(Object3DBranch.prototype);Polyline3D.prototype.constructor=Polyline3D;Polyline3D.ARROW=null;Polyline3D.prototype.update=function(){var O=this.getUserData();if(O.isVisibleIn3D()&&(O.getLevel()==null||O.getLevel().isViewableAndVisible())){var y=ShapeTools.getStroke(O.getThickness(),O.getCapStyle(),O.getJoinStyle(),O.getDashStyle()!==Polyline.DashStyle.SOLID?O.getDashPattern():null,O.getDashOffset());var o=ShapeTools.getPolylineShape(O.getPoints(),O.getJoinStyle()===Polyline.JoinStyle.CURVED,O.isClosedPath());var n=null;var h=null;var d=null;var c=null;for(var v=o.getPathIterator(null,0.5);!v.isDone();v.next()){var C=[0,0];if(v.currentSegment(C)!==java.awt.geom.PathIterator.SEG_CLOSE){if(n===null){n=C}else{if(h===null){h=C}}d=c;c=C}}var K=Math.atan2(n[1]-h[1],n[0]-h[0]);var m=Math.atan2(c[1]-d[1],c[0]-d[0]);var I=O.getCapStyle()!==Polyline.CapStyle.BUTT?O.getThickness()/2:0;var z=[this.getArrowShape(n,K,O.getStartArrowStyle(),O.getThickness(),I),this.getArrowShape(c,m,O.getEndArrowStyle(),O.getThickness(),I),y.createStrokedShape(o)];var b=new java.awt.geom.Area();for(var N=0;N<z.length;N++){var p=z[N];if(p!=null){b.add(new java.awt.geom.Area(p))}}var E=this.getAreaPoints(b,0.5,false);var u=0;for(var N=0;N<E.length;N++){u+=E[N].length}var a=new Array(u);var H=new Array(E.length);var A=new Array(u*2);for(var N=0,M=0,L=0;N<E.length;N++){var D=E[N];var q=M;for(var J=0;J<D.length;J++){var B=D[J];A[L++]=M;if(J>0){A[L++]=M}a[M++]=vec3.fromValues(B[0],0,B[1])}A[L++]=q;H[N]=D.length}var G=new GeometryInfo3D(GeometryInfo3D.POLYGON_ARRAY);G.setCoordinates(a);var s=new Array(a.length);var F=vec3.fromValues(0,1,0);for(var N=0;N<a.length;N++){s[N]=F}G.setNormals(s);G.setStripCounts(H);var g=G.getIndexedGeometryArray();var P=new IndexedLineArray3D(a,A);var w;var e;if(this.getChildren().length===0){var r=new BranchGroup3D();w=new TransformGroup3D();w.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);r.addChild(w);var t=new Appearance3D();this.updateAppearanceMaterial(t,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);t.setCullFace(Appearance3D.CULL_NONE);var p=new Shape3D(g,t);p.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);w.addChild(p);this.addChild(r);var e=this.getSelectionAppearance();var f=new Shape3D(P,e);f.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);f.setPickable(false);w.addChild(f)}else{w=this.getChild(0).getChild(0);var p=w.getChild(0);p.setGeometry(g,0);f=w.getChild(1);f.setGeometry(P,0);e=f.getAppearance()}var x=mat4.create();mat4.fromTranslation(x,vec3.fromValues(0,O.getGroundElevation()+(O.getElevation()<0.05?0.05:0),0));w.setTransform(x);this.updateAppearanceMaterial(w.getChild(0).getAppearance(),O.getColor(),O.getColor(),0);e.setVisible(this.getUserPreferences()!=null&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(O))}else{this.removeAllChildren()}};Polyline3D.prototype.getArrowShape=function(k,c,g,j,a){if(g!=null&&g!==Polyline.ArrowStyle.NONE){var b=java.awt.geom.AffineTransform.getTranslateInstance(k[0],k[1]);b.rotate(c);b.translate(a,0);var d=Math.pow(j,0.66)*2;b.scale(d,d);var f=new java.awt.geom.GeneralPath();switch(g){case Polyline.ArrowStyle.DISC:f.append(new java.awt.geom.Ellipse2D.Float(-3.5,-2,4,4),false);break;case Polyline.ArrowStyle.OPEN:var h=new java.awt.BasicStroke((j/d/0.9),java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER);f.append(h.createStrokedShape(Polyline3D.ARROW).getPathIterator(java.awt.geom.AffineTransform.getScaleInstance(0.9,0.9),0),false);break;case Polyline.ArrowStyle.DELTA:var e=new java.awt.geom.GeneralPath(Polyline3D.ARROW);e.closePath();f.append(e.getPathIterator(java.awt.geom.AffineTransform.getTranslateInstance(1.65,0),0),false);break;default:return null}return f.createTransformedShape(b)}return null};function DimensionLine3D(a,d,b,c){Object3DBranch.call(this,a,d,b);this.dimensionLineRotations=null;this.cameraChangeListener=null;this.homeCameraListener=null;this.dimensionLinesListener=null;this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);this.update()}DimensionLine3D.prototype=Object.create(Object3DBranch.prototype);DimensionLine3D.prototype.constructor=DimensionLine3D;DimensionLine3D.prototype.update=function(){var l=this.getUserData();if(l.isVisibleIn3D()&&(l.getLevel()==null||l.getLevel().isViewableAndVisible())){var g=l.getLength();var f=this.getUserPreferences().getLengthUnit().getFormat().format(g);var z=l.getLengthStyle();if(z==null){z=this.getUserPreferences().getDefaultTextStyle(DimensionLine)}var e="";if(z.isBold()){e="bold "}if(z.isItalic()){e+="italic "}var t=z.getFontName();if(t===null){t="sans-serif"}var u=e+" "+z.getFontSize()+"px "+t;var n=new FontMetrics(u);var o=n.getAscent();var h=l.getOffset();var E=h<=0?-n.getDescent()-1:o+1;var q;var s;var C;var j;var x;if(this.getChildren().length===0){var p=new BranchGroup3D();q=new TransformGroup3D();q.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);labelTransformGroup=new TransformGroup3D();labelTransformGroup.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);q.addChild(labelTransformGroup);var k=new Label(f,0,E);k.setColor(l.getColor());k.setStyle(z);k.setPitch(0);var c=new Label3D(k,null,false);labelTransformGroup.addChild(c);var s=new Shape3D();C=new Appearance3D();C.setIllumination(0);s.setAppearance(C);s.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);q.addChild(s);j=new Shape3D();x=this.getSelectionAppearance();j.setAppearance(this.getSelectionAppearance());j.setCapability(Shape3D.ALLOW_GEOMETRY_WRITE);j.setPickable(false);q.addChild(j);p.addChild(q);this.addChild(p)}else{q=this.getChild(0).getChild(0);var c=q.getChild(0).getChild(0);var k=c.getUserData();k.setText(f);k.setY(E);k.setColor(l.getColor());k.setStyle(z);c.update();s=q.getChild(1);C=s.getAppearance();j=q.getChild(2);x=j.getAppearance()}var a=l.getElevationStart();var d=mat4.create();mat4.fromTranslation(d,vec3.fromValues(l.getXStart(),l.getLevel()!=null?l.getLevel().getElevation()+a:a,l.getYStart()));if(this.dimensionLineRotations==null){this.dimensionLineRotations=mat4.create()}var w=Math.atan2(l.getElevationEnd()-a,l.getXEnd()-l.getXStart());mat4.fromZRotation(this.dimensionLineRotations,w);var y=mat4.create();var A=Math.atan2(l.getYStart()-l.getYEnd(),l.getXEnd()-l.getXStart());mat4.fromYRotation(y,A);mat4.mul(this.dimensionLineRotations,this.dimensionLineRotations,y);y=mat4.create();mat4.fromXRotation(y,-l.getPitch());mat4.mul(this.dimensionLineRotations,this.dimensionLineRotations,y);mat4.mul(d,d,this.dimensionLineRotations);var r=mat4.create();mat4.fromTranslation(r,vec3.fromValues(0,0,h));mat4.mul(d,d,r);q.setTransform(d);var v=l.getEndMarkSize()/2;var B=new Array(7*2);B[0]=vec3.fromValues(0,0,0);B[1]=vec3.fromValues(g,0,0);B[2]=vec3.fromValues(-v,0,v);B[3]=vec3.fromValues(v,0,-v);B[4]=vec3.fromValues(0,0,v);B[5]=vec3.fromValues(0,0,-v);B[6]=vec3.fromValues(g-v,0,v);B[7]=vec3.fromValues(g+v,0,-v);B[8]=vec3.fromValues(g,0,v);B[9]=vec3.fromValues(g,0,-v);B[10]=vec3.fromValues(0,0,-h);B[11]=vec3.fromValues(0,0,-v);B[12]=vec3.fromValues(g,0,-h);B[13]=vec3.fromValues(g,0,-v);var b=new IndexedLineArray3D(B,[0,1,2,3,4,5,6,7,8,9,10,11,12,13]);s.setGeometry(b,0);j.setGeometry(b,0);this.updateAppearanceMaterial(C,l.getColor()!=null?l.getColor():0,0,0);var D=this.getHome();var F=this.getUserPreferences()!=null&&this.getUserPreferences().isEditingIn3DViewEnabled()&&D.isItemSelected(l);x.setVisible(F);C.setVisible(!F);this.updateLengthLabelDirection(D.getCamera());var m=this;if(this.cameraChangeListener==null){this.cameraChangeListener=function(I){var G=m.getUserData();if(m.getChildren().length>0&&G.isVisibleIn3D()&&(G.getLevel()==null||G.getLevel().isViewableAndVisible())){var H=I.getPropertyName();if("X"==H||"Y"==H||"Z"==H){m.updateLengthLabelDirection(I.getSource())}}};this.homeCameraListener=function(G){G.getOldValue().removePropertyChangeListener(m.cameraChangeListener);G.getNewValue().addPropertyChangeListener(m.cameraChangeListener);m.updateLengthLabelDirection(D.getCamera())};this.dimensionLinesListener=function(G){if(G.getType()===CollectionEvent.Type.DELETE&&G.getItem()===l){D.getCamera().removePropertyChangeListener(m.cameraChangeListener);D.removePropertyChangeListener("CAMERA",m.homeCameraListener);D.removeDimensionLinesListener(m.dimensionLinesListener)}};D.getCamera().addPropertyChangeListener(this.cameraChangeListener);D.addPropertyChangeListener("CAMERA",this.homeCameraListener);D.addDimensionLinesListener(this.dimensionLinesListener)}}else{this.removeAllChildren();this.dimensionLineRotations=null;if(this.cameraChangeListener!=null){this.getHome().getCamera().removePropertyChangeListener(this.cameraChangeListener);this.getHome().removePropertyChangeListener("CAMERA",this.homeCameraListener);this.getHome().removeDimensionLinesListener(this.dimensionLinesListener);this.cameraChangeListener=null;this.homeCameraListener=null;this.dimensionLinesListener=null}}};DimensionLine3D.prototype.updateLengthLabelDirection=function(f){var a=this.getUserData();var e=vec3.fromValues(0,1,0);vec3.transformMat4(e,e,this.dimensionLineRotations);var g=vec3.fromValues((a.getXEnd()+a.getXStart())/2-f.getX(),(a.getElevationEnd()+a.getElevationStart())/2-f.getZ(),(a.getYEnd()+a.getYStart())/2-f.getY());var b=this.getChild(0).getChild(0).getChild(0);var d=mat4.create();mat4.fromTranslation(d,vec3.fromValues(a.getLength()/2,0,0));var c=mat4.create();mat4.fromZRotation(c,vec3.dot(e,g)>0?Math.PI:0);mat4.mul(d,d,c);b.setTransform(d)};function Label3D(b,d,a,c){if(c===undefined){c=a;a=null}Object3DBranch.call(this,b,d,a);this.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);this.update()}Label3D.prototype=Object.create(Object3DBranch.prototype);Label3D.prototype.constructor=Label3D;Label3D.dummyContext=document.createElement("canvas").getContext("2d");Label3D.prototype.update=function(){var F=this.getUserData();var y=F.getPitch();var G=F.getStyle();if(y!=null&&G!=null&&(F.getLevel()==null||F.getLevel().isViewableAndVisible())){var u=F.getText();var t=F.getColor();var L=F.getOutlineColor();if(u!=this.text||(G==null&&this.style!=null)||(G!=null&&!G.equals(this.style))||(t==null&&this.color!=null)||(t!=null&&t!==this.color)){var H="";if(G.isBold()){H="bold "}if(G.isItalic()){H+="italic "}var r=G.getFontName();if(r===null){r="sans-serif"}var m=50;var J=m;if(["Times","Serif","Helvetica"].indexOf(r)===-1){J*=1.18}var C=m/G.getFontSize();var E=0.23*J;var K=H+" "+m+"px "+r;Label3D.dummyContext.font=K;var B=u.replace(/\n*$/,"").split("\n");var A=new Array(B.length);var h=-Infinity;var s=-E+J*B.length;for(var I=0;I<B.length;I++){A[I]=Label3D.dummyContext.measureText(B[I]).width;if(G.isItalic()){A[I]+=J*0.154}h=Math.max(A[I],h)}var l=J*B.length;var a=Math.sqrt(h/l);var a=Math.sqrt(h/l);var b;var c;var z;if(a>1){b=Math.ceil(Math.max(255*a,Math.min(h,511*a)));z=b/h;c=Math.ceil(z*l)}else{c=Math.ceil(Math.max(255*a,Math.min(l,511/a)));z=c/l;b=Math.ceil(z*h)}if(b>0&&c>0){var n=document.createElement("canvas");n.width=Appearance3D.getNextHighestPowerOfTwo(b)/2;n.height=Appearance3D.getNextHighestPowerOfTwo(c)/2;n.transparent=true;var N=n.getContext("2d");N.scale(z/b*n.width,z/c*n.height);N.translate(0,s);N.font=K;if(t!==null){N.fillStyle="rgb("+((t>>>16)&255)+","+((t>>>8)&255)+","+(t&255)+")"}if(L!==null){N.strokeStyle="rgb("+((L>>>16)&255)+","+((L>>>8)&255)+","+(L&255)+")"}for(var I=B.length-1;I>=0;I--){var e=B[I];var k;if(G.getAlignment()===TextStyle.Alignment.LEFT){k=0}else{if(G.getAlignment()===TextStyle.Alignment.RIGHT){k=h-A[I]}else{k=(h-A[I])/2}}N.translate(k,0);N.fillText(e,0,0);if(L!==null){N.strokeText(e,0,0)}N.translate(-k,-J)}var x=mat4.create();mat4.scale(x,x,vec3.fromValues(h/C,1,l/C));this.baseLineTransform=mat4.create();var k;if(G.getAlignment()==TextStyle.Alignment.LEFT){k=h/2}else{if(G.getAlignment()==TextStyle.Alignment.RIGHT){k=-h/2}else{k=0}}mat4.fromTranslation(this.baseLineTransform,vec3.fromValues(k/C,0,(l/2-s)/C));mat4.mul(this.baseLineTransform,this.baseLineTransform,x);this.texture=n;this.text=u;this.style=G;this.color=t}else{this.clear()}}if(this.texture!==null){var v;var d;if(this.getChildren().length===0){var p=new BranchGroup3D();v=new TransformGroup3D();v.setCapability(TransformGroup3D.ALLOW_TRANSFORM_WRITE);p.addChild(v);var q=new Appearance3D();this.updateAppearanceMaterial(q,Object3DBranch.DEFAULT_COLOR,Object3DBranch.DEFAULT_AMBIENT_COLOR,0);q.setCullFace(Appearance3D.CULL_NONE);var o=new Shape3D(new IndexedTriangleArray3D([vec3.fromValues(-0.5,0,-0.5),vec3.fromValues(-0.5,0,0.5),vec3.fromValues(0.5,0,0.5),vec3.fromValues(0.5,0,-0.5)],[0,1,2,0,2,3],[vec2.fromValues(0,0),vec2.fromValues(1,0),vec2.fromValues(1,1),vec2.fromValues(0,1)],[3,0,1,3,1,2],[vec3.fromValues(0,1,0)],[0,0,0,0,0,0]),q);v.addChild(o);var f=[vec3.fromValues(-0.5,0,-0.5),vec3.fromValues(0.5,0,-0.5),vec3.fromValues(0.5,0,0.5),vec3.fromValues(-0.5,0,0.5)];var M=new IndexedLineArray3D(f,[0,1,1,2,2,3,3,0]);d=this.getSelectionAppearance();var g=new Shape3D(M,d);g.setPickable(false);v.addChild(g);this.addChild(p)}else{v=this.getChild(0).getChild(0);var g=v.getChild(1);d=g.getAppearance()}var v=this.getChild(0).getChild(0);var D=mat4.create();mat4.fromXRotation(D,y);mat4.mul(D,D,this.baseLineTransform);var j=mat4.create();mat4.fromYRotation(j,-F.getAngle());mat4.mul(j,j,D);var w=mat4.create();mat4.fromTranslation(w,vec3.fromValues(F.getX(),F.getGroundElevation()+(y==0&&F.getElevation()<0.1?0.1:0),F.getY()));mat4.mul(w,w,j);v.setTransform(w);v.getChild(0).getAppearance().setTextureImage(this.texture);d.setVisible(this.getUserPreferences()!=null&&this.getUserPreferences().isEditingIn3DViewEnabled()&&this.getHome().isItemSelected(F))}}else{this.clear()}};Label3D.prototype.clear=function(){this.removeAllChildren();this.text=null;this.style=null;this.color=null;this.texture=null;this.baseLineTransform=null};function TextureManager(){this.loadedTextureImages={};this.loadingTextureObservers={}}TextureManager.READING_TEXTURE="Reading texture";TextureManager.instance=null;TextureManager.getInstance=function(){if(TextureManager.instance==null){TextureManager.instance=new TextureManager()}return TextureManager.instance};TextureManager.prototype.clear=function(){this.loadedTextureImages={};this.loadingTextureObservers={}};TextureManager.prototype.loadTexture=function(d,f,b,c){if(b===undefined){c=f;f=0;b=false}else{if(c===undefined){c=b;b=false}}if(b&&!d.isStreamURLReady()){throw new IllegalStateException("Can't run synchronously with unavailable URL")}var a=this;var e=d.getURL();d.getStreamURL({urlReady:function(g){if(e in a.loadedTextureImages){if(c.textureUpdated!==undefined){c.textureUpdated(a.loadedTextureImages[e])}}else{if(b){a.load(g,b,{textureLoaded:function(j){a.loadedTextureImages[e]=j;if(c.textureUpdated!==undefined){c.textureUpdated(j)}},textureError:function(j){if(c.textureError!==undefined){c.textureError(j)}},progression:function(k,l,j){if(c.progression!==undefined){c.progression(k,l,j)}}})}else{if(e in a.loadingTextureObservers){a.loadingTextureObservers[e].push(c)}else{var h=[];h.push(c);a.loadingTextureObservers[e]=h;a.load(g,b,{textureLoaded:function(j){var l=a.loadingTextureObservers[e];if(l){delete a.loadingTextureObservers[e];a.loadedTextureImages[e]=j;for(var k=0;k<l.length;k++){if(l[k].textureUpdated!==undefined){l[k].textureUpdated(j)}}}},textureError:function(j){var l=a.loadingTextureObservers[e];if(l){delete a.loadingTextureObservers[e];for(var k=0;k<l.length;k++){if(l[k].textureError!==undefined){l[k].textureError(j)}}}},progression:function(k,m,j){var n=a.loadingTextureObservers[e];if(n){for(var l=0;l<n.length;l++){if(n[l].progression!==undefined){n[l].progression(k,m,j)}}}}})}}}},urlError:function(g,h){c.textureError(g)}})};TextureManager.prototype.load=function(b,a,d){d.progression(TextureManager.READING_TEXTURE,b,0);var h=new Image();h.crossOrigin="anonymous";h.url=b;var e=function(k){h.removeEventListener("load",j);h.removeEventListener("error",e);d.textureError("Can't load "+b)};var j=function(){h.removeEventListener("load",j);h.removeEventListener("error",e);d.progression(TextureManager.READING_TEXTURE,b,1);d.textureLoaded(h)};if(b.indexOf("jar:")===0){var g=b.indexOf("!/");var c=decodeURIComponent(b.substring(g+2));var f=b.substring(4,g);ZIPTools.getZIP(f,a,{zipReady:function(m){try{h.addEventListener("load",j);h.addEventListener("error",e);var k=m.file(c);var o=k.asBinary();var n=btoa(o);h.transparent=ZIPTools.isTransparentImage(o);h.src="data:image;base64,"+n;if(h.width!==0||a){j()}}catch(l){this.zipError(l)}},zipError:function(k){d.textureError("Can't load "+f)},progression:function(l,m,k){d.progression(l,m,k)}})}else{h.addEventListener("load",j);h.addEventListener("error",e);h.src=b;if(h.width!==0){h.removeEventListener("load",j);h.removeEventListener("error",e);d.progression(TextureManager.READING_TEXTURE,b,1);d.textureLoaded(h)}}};TextureManager.prototype.isTextureTransparent=function(a){return a.transparent===true};TextureManager.prototype.getRotatedTextureWidth=function(a){var b=a.getAngle();if(b!==0){return Math.round(Math.abs(a.getWidth()*Math.cos(b))+Math.abs(a.getHeight()*Math.sin(b)))}else{return a.getWidth()}};TextureManager.prototype.getRotatedTextureHeight=function(a){var b=a.getAngle();if(b!==0){return Math.round(Math.abs(a.getWidth()*Math.sin(b))+Math.abs(a.getHeight()*Math.cos(b)))}else{return a.getHeight()}};TextureManager.prototype.getErrorImage=function(){if(TextureManager.errorImage===undefined){TextureManager.errorImage=this.getColoredImage("#FF0000")}return TextureManager.errorImage};TextureManager.prototype.getWaitImage=function(){if(TextureManager.waitImage===undefined){TextureManager.waitImage=this.getColoredImage("#FFFFFF")}return TextureManager.waitImage};TextureManager.prototype.getColoredImage=function(b){var c=document.createElement("canvas");c.width=2;c.height=2;var d=c.getContext("2d");d.fillStyle=b;d.fillRect(0,0,2,2);var e=c.toDataURL();var a=new Image();a.url=e;a.src=e;return a};var LengthUnit={};LengthUnit.getMagnetizedMeterLength=function(d,a){a*=2;var b=1/10;if(a>100){b=100}else{if(a>10){b=10}else{if(a>5){b=5}else{if(a>1){b=1}else{if(a>0.5){b=0.5}}}}}var c=Math.round(d/b)*b;if(c===0&&d>0){return d}else{return c}};LengthUnit.getMagnetizedInchLength=function(d,a){a=LengthUnit.centimeterToInch(a)*2;var b=1/8;if(a>6){b=6}else{if(a>3){b=3}else{if(a>1){b=1}else{if(a>0.5){b=0.5}else{if(a>0.25){b=0.25}}}}}var c=LengthUnit.inchToCentimeter(Math.round(LengthUnit.centimeterToInch(d)/b)*b);if(c===0&&d>0){return d}else{return c}};LengthUnit.skipWhiteSpaces=function(b,a){while(a.getIndex()<b.length&&/\s/.test(b.charAt(a.getIndex()))){a.setIndex(a.getIndex()+1)}};LengthUnit.centimeterToInch=function(a){return a/2.54};LengthUnit.centimeterToFoot=function(a){return a/2.54/12};LengthUnit.inchToCentimeter=function(a){return a*2.54};LengthUnit.footToCentimeter=function(a){return a*2.54*12};LengthUnit.nameOf=function(c){if(c!=null){var d=Object.keys(LengthUnit);for(var a=0;a<d.length;a++){var b=d[a];if(LengthUnit[b]==c){return b}}}return null};LengthUnit.valueOf=function(a){return LengthUnit[a]};LengthUnit.MILLIMETER={formatLocale:null};LengthUnit.MILLIMETER.name=function(){return LengthUnit.nameOf(this)};LengthUnit.MILLIMETER.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.MILLIMETER.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.MILLIMETER.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.MILLIMETER.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.MILLIMETER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"millimeterUnit");this.lengthFormatWithUnit=new MeterFamilyFormat("0",10,this.unitName);this.lengthFormat=new MeterFamilyFormat("0",10);var a=CoreTools.getStringFromKey(b,"squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(a)}};LengthUnit.MILLIMETER.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedMeterLength(b,a)};LengthUnit.MILLIMETER.getMinimumLength=function(){return 0.1};LengthUnit.MILLIMETER.getMaximumLength=function(){return 100000};LengthUnit.MILLIMETER.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.MILLIMETER.getStepSize=function(){return 0.5};LengthUnit.MILLIMETER.centimeterToUnit=function(a){return a*10};LengthUnit.MILLIMETER.unitToCentimeter=function(a){return a/10};LengthUnit.MILLIMETER.isMetric=function(){return true};LengthUnit.CENTIMETER={formatLocale:null};LengthUnit.CENTIMETER.name=function(){return LengthUnit.nameOf(this)};LengthUnit.CENTIMETER.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.CENTIMETER.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.CENTIMETER.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.CENTIMETER.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.CENTIMETER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"centimeterUnit");this.lengthFormatWithUnit=new MeterFamilyFormat("0.#",1,this.unitName);this.lengthFormat=new MeterFamilyFormat("0.#",1);var a=CoreTools.getStringFromKey(b,"squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(a)}};LengthUnit.CENTIMETER.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedMeterLength(b,a)};LengthUnit.CENTIMETER.getMinimumLength=function(){return 0.1};LengthUnit.CENTIMETER.getMaximumLength=function(){return 100000};LengthUnit.CENTIMETER.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.CENTIMETER.getStepSize=function(){return 0.5};LengthUnit.CENTIMETER.centimeterToUnit=function(a){return a};LengthUnit.CENTIMETER.unitToCentimeter=function(a){return a};LengthUnit.CENTIMETER.isMetric=function(){return true};LengthUnit.METER={formatLocale:null};LengthUnit.METER.name=function(){return LengthUnit.nameOf(this)};LengthUnit.METER.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.METER.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.METER.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.METER.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.METER.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"meterUnit");this.lengthFormatWithUnit=new MeterFamilyFormat("0.00#",0.01,this.unitName);this.lengthFormat=new MeterFamilyFormat("0.00#",0.01);var a=CoreTools.getStringFromKey(b,"squareMeterUnit");this.areaFormatWithUnit=new SquareMeterAreaFormatWithUnit(a)}};LengthUnit.METER.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedMeterLength(b,a)};LengthUnit.METER.getMinimumLength=function(){return 0.1};LengthUnit.METER.getMaximumLength=function(){return 100000};LengthUnit.METER.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.METER.getStepSize=function(){return 0.5};LengthUnit.METER.centimeterToUnit=function(a){return a/100};LengthUnit.METER.unitToCentimeter=function(a){return a*100};LengthUnit.METER.isMetric=function(){return true};LengthUnit.INCH={formatLocale:null};LengthUnit.INCH.name=function(){return LengthUnit.nameOf(this)};LengthUnit.INCH.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.INCH.getFormat=function(){return this.getFormatWithUnit()};LengthUnit.INCH.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.INCH.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.INCH.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var c=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(c,"inchUnit");var a=CoreTools.getStringFromKey(c,"footInchSeparator");this.lengthFormat=new InchFractionFormat(true,a);var b=CoreTools.getStringFromKey(c,"squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0",b)}};LengthUnit.INCH.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedInchLength(b,a)};LengthUnit.INCH.getMinimumLength=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH.getMaximumLength=function(){return LengthUnit.inchToCentimeter(99974.4)};LengthUnit.INCH.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.INCH.getStepSize=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH.centimeterToUnit=function(a){return LengthUnit.centimeterToInch(a)};LengthUnit.INCH.unitToCentimeter=function(a){return LengthUnit.inchToCentimeter(a)};LengthUnit.INCH.isMetric=function(){return false};LengthUnit.INCH_FRACTION={formatLocale:null};LengthUnit.INCH_FRACTION.name=function(){return LengthUnit.nameOf(this)};LengthUnit.INCH_FRACTION.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.INCH_FRACTION.getFormat=function(){return this.getFormatWithUnit()};LengthUnit.INCH_FRACTION.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.INCH_FRACTION.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.INCH_FRACTION.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var c=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(c,"inchUnit");var a=CoreTools.getStringFromKey(c,"footInchSeparator");this.lengthFormat=new InchFractionFormat(false,a);var b=CoreTools.getStringFromKey(c,"squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0",b)}};LengthUnit.INCH_FRACTION.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedInchLength(b,a)};LengthUnit.INCH_FRACTION.getMinimumLength=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH_FRACTION.getMaximumLength=function(){return LengthUnit.inchToCentimeter(99974.4)};LengthUnit.INCH_FRACTION.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.INCH_FRACTION.getStepSize=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH_FRACTION.centimeterToUnit=function(a){return LengthUnit.centimeterToInch(a)};LengthUnit.INCH_FRACTION.unitToCentimeter=function(a){return LengthUnit.inchToCentimeter(a)};LengthUnit.INCH_FRACTION.isMetric=function(){return false};LengthUnit.INCH_DECIMALS={formatLocale:null};LengthUnit.INCH_DECIMALS.name=function(){return LengthUnit.nameOf(this)};LengthUnit.INCH_DECIMALS.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.INCH_DECIMALS.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.INCH_DECIMALS.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.INCH_DECIMALS.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.INCH_DECIMALS.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"inchUnit");this.lengthFormat=new InchDecimalsFormat("0.###");this.lengthFormatWithUnit=new InchDecimalsFormat("0.###",'"');var a=CoreTools.getStringFromKey(b,"squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0.##",a)}};LengthUnit.INCH_DECIMALS.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedInchLength(b,a)};LengthUnit.INCH_DECIMALS.getMinimumLength=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH_DECIMALS.getMaximumLength=function(){return LengthUnit.inchToCentimeter(99974.4)};LengthUnit.INCH_DECIMALS.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.INCH_DECIMALS.getStepSize=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.INCH_DECIMALS.centimeterToUnit=function(a){return LengthUnit.centimeterToInch(a)};LengthUnit.INCH_DECIMALS.unitToCentimeter=function(a){return LengthUnit.inchToCentimeter(a)};LengthUnit.INCH_DECIMALS.isMetric=function(){return false};LengthUnit.FOOT_DECIMALS={formatLocale:null};LengthUnit.FOOT_DECIMALS.name=function(){return LengthUnit.nameOf(this)};LengthUnit.FOOT_DECIMALS.getFormatWithUnit=function(){this.checkLocaleChange();return this.lengthFormatWithUnit};LengthUnit.FOOT_DECIMALS.getFormat=function(){this.checkLocaleChange();return this.lengthFormat};LengthUnit.FOOT_DECIMALS.getAreaFormatWithUnit=function(){this.checkLocaleChange();return this.areaFormatWithUnit};LengthUnit.FOOT_DECIMALS.getName=function(){this.checkLocaleChange();return this.unitName};LengthUnit.FOOT_DECIMALS.checkLocaleChange=function(){if(Locale.getDefault()!=this.formatLocale){this.formatLocale=Locale.getDefault();var b=CoreTools.loadResourceBundles("resources/LengthUnit",this.formatLocale);this.unitName=CoreTools.getStringFromKey(b,"footUnit");this.lengthFormat=new FootDecimalsFormat("0.###");this.lengthFormatWithUnit=new FootDecimalsFormat("0.###","'");var a=CoreTools.getStringFromKey(b,"squareFootUnit");this.areaFormatWithUnit=new SquareFootAreaFormatWithUnit("0.##",a)}};LengthUnit.FOOT_DECIMALS.getMagnetizedLength=function(b,a){return LengthUnit.getMagnetizedInchLength(b,a)};LengthUnit.FOOT_DECIMALS.getMinimumLength=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.FOOT_DECIMALS.getMaximumLength=function(){return LengthUnit.footToCentimeter(3280)};LengthUnit.FOOT_DECIMALS.getMaximumElevation=function(){return this.getMaximumLength()/10};LengthUnit.FOOT_DECIMALS.getStepSize=function(){return LengthUnit.inchToCentimeter(0.125)};LengthUnit.FOOT_DECIMALS.centimeterToUnit=function(a){return LengthUnit.centimeterToFoot(a)};LengthUnit.FOOT_DECIMALS.unitToCentimeter=function(a){return LengthUnit.footToCentimeter(a)};LengthUnit.FOOT_DECIMALS.isMetric=function(){return false};function MeterFamilyFormat(c,a,b){DecimalFormat.call(this,c);this.setGroupingUsed(true);this.unitMultiplier=a;this.unit=b}MeterFamilyFormat.prototype=Object.create(DecimalFormat.prototype);MeterFamilyFormat.prototype.constructor=MeterFamilyFormat;MeterFamilyFormat.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,a*this.unitMultiplier);return b+(this.unit?" "+this.unit:"")};MeterFamilyFormat.prototype.parse=function(c,b){var a=DecimalFormat.prototype.parse.call(this,c,b);if(a===null){return null}else{return a/this.unitMultiplier}};function SquareMeterAreaFormatWithUnit(a){DecimalFormat.call(this,"0.##");this.setGroupingUsed(true);this.squareMeterUnit=a}SquareMeterAreaFormatWithUnit.prototype=Object.create(DecimalFormat.prototype);SquareMeterAreaFormatWithUnit.prototype.constructor=SquareMeterAreaFormatWithUnit;SquareMeterAreaFormatWithUnit.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,a/10000);return b+(this.squareMeterUnit?" "+this.squareMeterUnit:"")};function InchFractionFormat(b,a){DecimalFormat.call(this,"0.###");this.setGroupingUsed(true);this.footInch=b;this.footInchSeparator=a}InchFractionFormat.prototype=Object.create(DecimalFormat.prototype);InchFractionFormat.prototype.constructor=InchFractionFormat;InchFractionFormat.INCH_FRACTION_CHARACTERS=["\u215b","\u00bc","\u215c","\u00bd","\u215d","\u00be","\u215e"];InchFractionFormat.INCH_FRACTION_STRINGS=["1/8","1/4","3/8","1/2","5/8","3/4","7/8"];InchFractionFormat.prototype.format=function(f){var g=Math.abs(f);var b=Math.floor(LengthUnit.centimeterToFoot(g));var e=LengthUnit.centimeterToInch(g-LengthUnit.footToCentimeter(b));if(e>=11.9375){b++;e-=12}var j=f>=0?"":"-";var a=DecimalFormat.prototype.format.call(this,b);if(e>=0.0005){var c=Math.floor(e);var d=e-c;var h=Math.round(d*8);if(this.footInch){j+=a;if(h===0||h===8){j+="'";j+=Math.round(e*8)/8}else{j+="'";j+=c;j+=InchFractionFormat.INCH_FRACTION_CHARACTERS[h-1]}}else{if(h===0||h===8){j+=b*12+Math.round(e*8)/8}else{j+=b*12+c;j+=InchFractionFormat.INCH_FRACTION_CHARACTERS[h-1]}}j+='"'}else{if(this.footInch){j+=a;j+="'"}else{j+=DecimalFormat.prototype.format.call(this,b*12);j+='"'}}return j};InchFractionFormat.prototype.parse=function(o,k){var m=0;var n=new ParsePosition(k.getIndex());LengthUnit.skipWhiteSpaces(o,n);var f=NumberFormat.getIntegerInstance();var d=o.indexOf("'",k.getIndex());var e=n.getIndex()<o.length&&o.charAt(n.getIndex())==="-";var h=false;if(d!==-1){var b=f.parse(o,n);if(b===null){k.setErrorIndex(n.getErrorIndex());return null}LengthUnit.skipWhiteSpaces(o,n);if(n.getIndex()===d){m=LengthUnit.footToCentimeter(b);h=true;n=new ParsePosition(d+1);LengthUnit.skipWhiteSpaces(o,n);if(n.getIndex()<o.length&&this.footInchSeparator.indexOf(o.charAt(n.getIndex()))>=0){n.setIndex(n.getIndex()+1);LengthUnit.skipWhiteSpaces(o,n)}if(n.getIndex()===o.length){k.setIndex(o.length);return m}}else{if(this.decimalSeparator===o.charAt(n.getIndex())){var p=new ParsePosition(k.getIndex());if(DecimalFormat.prototype.parse.call(this,o,p)!==null&&p.getIndex()===d){k.setErrorIndex(n.getErrorIndex());return null}}n.setIndex(k.getIndex())}}var c=DecimalFormat.prototype.parse.call(this,o,n);if(c===null){if(h){k.setIndex(n.getIndex());return m}else{k.setErrorIndex(n.getErrorIndex());return null}}if(e){if(d===-1){m=LengthUnit.inchToCentimeter(c)}else{m-=LengthUnit.inchToCentimeter(c)}}else{m+=LengthUnit.inchToCentimeter(c)}LengthUnit.skipWhiteSpaces(o,n);if(n.getIndex()===o.length){k.setIndex(o.length);return m}if(o.charAt(n.getIndex())==='"'){k.setIndex(n.getIndex()+1);return m}var a=o.charAt(n.getIndex());var j=o.length-n.getIndex()>=3?o.substring(n.getIndex(),n.getIndex()+3):null;for(var g=0;g<InchFractionFormat.INCH_FRACTION_CHARACTERS.length;g++){if(InchFractionFormat.INCH_FRACTION_CHARACTERS[g]===a||InchFractionFormat.INCH_FRACTION_STRINGS[g]==j){var l=o.lastIndexOf(this.decimalSeparator,n.getIndex()-1);if(l>d){return null}else{if(e){m-=LengthUnit.inchToCentimeter((g+1)/8)}else{m+=LengthUnit.inchToCentimeter((g+1)/8)}k.setIndex(n.getIndex()+(InchFractionFormat.INCH_FRACTION_CHARACTERS[g]===a?1:3));LengthUnit.skipWhiteSpaces(o,k);if(k.getIndex()<o.length&&o.charAt(k.getIndex())==='"'){k.setIndex(k.getIndex()+1)}return m}}}k.setIndex(n.getIndex());return m};function SquareFootAreaFormatWithUnit(b,a){DecimalFormat.call(this,b);this.setGroupingUsed(true);this.unit=a}SquareFootAreaFormatWithUnit.prototype=Object.create(DecimalFormat.prototype);SquareFootAreaFormatWithUnit.prototype.constructor=SquareFootAreaFormatWithUnit;SquareFootAreaFormatWithUnit.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,a/929.0304);return b+(this.unit?" "+this.unit:"")};function InchDecimalsFormat(b,a){DecimalFormat.call(this,b);this.setGroupingUsed(true);this.unit=a}InchDecimalsFormat.prototype=Object.create(DecimalFormat.prototype);InchDecimalsFormat.prototype.constructor=InchDecimalsFormat;InchDecimalsFormat.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,LengthUnit.centimeterToInch(a));return b+(this.unit?this.unit:"")};InchDecimalsFormat.prototype.parse=function(e,a){var d=new ParsePosition(a.getIndex());LengthUnit.skipWhiteSpaces(e,d);var c=DecimalFormat.prototype.parse.call(this,e,d);if(c===null){a.setErrorIndex(d.getErrorIndex());return null}var b=LengthUnit.inchToCentimeter(c);LengthUnit.skipWhiteSpaces(e,d);if(d.getIndex()<e.length&&e.charAt(d.getIndex())==='"'){a.setIndex(d.getIndex()+1)}else{a.setIndex(d.getIndex())}return b};function FootDecimalsFormat(b,a){DecimalFormat.call(this,b);this.setGroupingUsed(true);this.unit=a}FootDecimalsFormat.prototype=Object.create(DecimalFormat.prototype);FootDecimalsFormat.prototype.constructor=FootDecimalsFormat;FootDecimalsFormat.prototype.format=function(a){var b=DecimalFormat.prototype.format.call(this,LengthUnit.centimeterToFoot(a));return b+(this.unit?this.unit:"")};FootDecimalsFormat.prototype.parse=function(e,b){var d=new ParsePosition(b.getIndex());LengthUnit.skipWhiteSpaces(e,d);var a=DecimalFormat.prototype.parse.call(this,e,d);if(a===null){b.setErrorIndex(d.getErrorIndex());return null}var c=LengthUnit.footToCentimeter(a);LengthUnit.skipWhiteSpaces(e,d);if(d.getIndex()<e.length&&e.charAt(d.getIndex())==="'"){b.setIndex(d.getIndex()+1)}else{b.setIndex(d.getIndex())}return c};function UserPreferences(){this.propertyChangeSupport=new PropertyChangeSupport(this);this.initSupportedLanguages(UserPreferences.DEFAULT_SUPPORTED_LANGUAGES);this.resourceBundles=[];this.furnitureCatalogResourceBundles=[];this.texturesCatalogResourceBundles=[];this.furnitureCatalog=null;this.texturesCatalog=null;this.patternsCatalog=null;this.currency=null;this.valueAddedTaxEnabled=false;this.defaultValueAddedTaxPercentage=null;this.unit=null;this.furnitureCatalogViewedInTree=false;this.navigationPanelVisible=true;this.editingIn3DViewEnabled=false;this.aerialViewCenteredOnSelectionEnabled=false;this.observerCameraSelectedAtChange=true;this.magnetismEnabled=true;this.rulersVisible=true;this.gridVisible=true;this.defaultFontName=null;this.furnitureViewedFromTop=true;this.furnitureModelIconSize=128;this.roomFloorColoredOrTextured=true;this.wallPattern=null;this.newWallPattern=null;this.newWallThickness=7.5;this.newWallHeight=250;this.newWallBaseboardThickness=1;this.newWallBaseboardHeight=7;this.newRoomFloorColor=null;this.newFloorThickness=12;this.autoSaveDelayForRecovery=0;this.recentHomes=[];this.autoCompletionStrings={};this.recentColors=[];this.recentTextures=[];this.homeExamples=[];this.ignoredActionTips={}}UserPreferences.DEFAULT_SUPPORTED_LANGUAGES=["bg","cs","de","el","en","es","fr","it","ja","hu","nl","pl","pt","pt_BR","ru","sv","vi","zh_CN","zh_TW"];UserPreferences.DEFAULT_TEXT_STYLE=new TextStyle(18);UserPreferences.DEFAULT_ROOM_TEXT_STYLE=new TextStyle(24);UserPreferences.prototype.initSupportedLanguages=function(a){this.supportedLanguages=a;if(!this.language||this.supportedLanguages.indexOf(this.language)===-1){var d=Locale.getDefault();if(d===null){d="en"}this.defaultCountry="";var e=d;if(d.indexOf("_")>0){this.defaultCountry=d.substring(d.indexOf("_")+1,d.length);e=this.language?this.language.substring(0,this.language.indexOf("_")):d.substring(0,d.indexOf("_"))}for(var b=0;b<this.supportedLanguages.length;b++){var c=this.supportedLanguages[b];if(this.defaultCountry!=""&&c==e+"_"+this.defaultCountry||this.defaultCountry==""&&c==e){this.language=c;break}else{if(this.language===undefined&&c.indexOf(e)===0){this.language=c}}}if(this.language===undefined){this.language="en"}this.updateDefaultLocale()}};UserPreferences.prototype.updateDefaultLocale=function(){if(this.language.indexOf("_")!==-1||this.defaultCountry==""){Locale.setDefault(this.language)}else{Locale.setDefault(this.language+"_"+this.defaultCountry)}};UserPreferences.prototype.write=function(){};UserPreferences.prototype.addPropertyChangeListener=function(a){this.propertyChangeSupport.addPropertyChangeListener(a)};UserPreferences.prototype.removePropertyChangeListener=function(a){this.propertyChangeSupport.removePropertyChangeListener(a)};UserPreferences.prototype.addPropertyChangeListener=function(b,a){this.propertyChangeSupport.addPropertyChangeListener(b,a)};UserPreferences.prototype.removePropertyChangeListener=function(b,a){this.propertyChangeSupport.removePropertyChangeListener(b,a)};UserPreferences.prototype.getFurnitureCatalog=function(){return this.furnitureCatalog};UserPreferences.prototype.setFurnitureCatalog=function(a){this.furnitureCatalog=a};UserPreferences.prototype.getTexturesCatalog=function(){return this.texturesCatalog};UserPreferences.prototype.setTexturesCatalog=function(a){this.texturesCatalog=a};UserPreferences.prototype.getPatternsCatalog=function(){return this.patternsCatalog};UserPreferences.prototype.setPatternsCatalog=function(a){this.patternsCatalog=a};UserPreferences.prototype.getLengthUnit=function(){return this.unit};UserPreferences.prototype.setUnit=function(a){if(this.unit!==a){var b=this.unit;this.unit=a;this.propertyChangeSupport.firePropertyChange("UNIT",b,a)}};UserPreferences.prototype.getLanguage=function(){return this.language};UserPreferences.prototype.setLanguage=function(b){if(b!=this.language&&this.isLanguageEditable()){var a=this.language;this.language=b;this.updateDefaultLocale();this.resourceBundles=[];this.furnitureCatalogResourceBundles=[];this.texturesCatalogResourceBundles=[];this.propertyChangeSupport.firePropertyChange("LANGUAGE",a,b)}};UserPreferences.prototype.isLanguageEditable=function(){return true};UserPreferences.prototype.getDefaultSupportedLanguages=function(){return UserPreferences.DEFAULT_SUPPORTED_LANGUAGES.slice(0)};UserPreferences.prototype.getSupportedLanguages=function(){return this.supportedLanguages.slice(0)};UserPreferences.prototype.setSupportedLanguages=function(a){if(this.supportedLanguages!=a){var c=this.supportedLanguages;var b=this.language;this.initSupportedLanguages(a.slice(0));this.propertyChangeSupport.firePropertyChange("SUPPORTED_LANGUAGES",c,a);if(b!=this.language){this.propertyChangeSupport.firePropertyChange("LANGUAGE",b,language)}}};UserPreferences.prototype.getLocalizedString=function(a,c,e){this.getResourceBundles(a);if(a=="DefaultFurnitureCatalog"){return CoreTools.getStringFromKey.apply(null,[this.furnitureCatalogResourceBundles,c].concat(Array.prototype.slice.call(arguments,2)))}else{if(a=="DefaultTexturesCatalog"){return CoreTools.getStringFromKey.apply(null,[this.texturesCatalogResourceBundles,c].concat(Array.prototype.slice.call(arguments,2)))}else{if(a.__class){var d=a.__class.split(".");a=d[d.length-1]}var b=a+"."+c;return CoreTools.getStringFromKey.apply(null,[this.resourceBundles,b].concat(Array.prototype.slice.call(arguments,2)))}}};UserPreferences.prototype.getLocalizedStringKeys=function(c){if(resourceClass=="DefaultFurnitureCatalog"){var b={};for(var a=0;a<resourceBundles.length;a++){if(resourceBundles[a]!=null){CoreTools.merge(b,resourceBundles[a])}}return Object.getOwnPropertyNames(b)}else{throw new IllegalArgumentException("unsupported family")}};UserPreferences.prototype.getResourceBundles=function(a){if(a=="DefaultFurnitureCatalog"){if(this.furnitureCatalogResourceBundles.length==0){this.furnitureCatalogResourceBundles=CoreTools.loadResourceBundles("resources/DefaultFurnitureCatalog",Locale.getDefault())}return this.furnitureCatalogResourceBundles}else{if(a=="DefaultTexturesCatalog"){if(this.texturesCatalogResourceBundles.length==0){this.texturesCatalogResourceBundles=CoreTools.loadResourceBundles("resources/DefaultTexturesCatalog",Locale.getDefault())}return this.texturesCatalogResourceBundles}else{if(this.resourceBundles.length==0){this.resourceBundles=CoreTools.loadResourceBundles("resources/localization",Locale.getDefault())}return this.resourceBundles}}};UserPreferences.prototype.getCurrency=function(){return this.currency};UserPreferences.prototype.setCurrency=function(a){if(a!=this.currency){var b=this.currency;this.currency=a;this.propertyChangeSupport.firePropertyChange("CURRENCY",b,a)}};UserPreferences.prototype.isValueAddedTaxEnabled=function(){return this.valueAddedTaxEnabled};UserPreferences.prototype.setValueAddedTaxEnabled=function(a){if(this.valueAddedTaxEnabled!==a){this.valueAddedTaxEnabled=a;this.propertyChangeSupport.firePropertyChange("VALUE_ADDED_TAX_ENABLED",!a,a)}};UserPreferences.prototype.getDefaultValueAddedTaxPercentage=function(){return this.defaultValueAddedTaxPercentage};UserPreferences.prototype.setDefaultValueAddedTaxPercentage=function(b){if(b!==this.defaultValueAddedTaxPercentage&&(b==null||this.defaultValueAddedTaxPercentage==null||!b.eq(this.defaultValueAddedTaxPercentage))){var a=this.defaultValueAddedTaxPercentage;this.defaultValueAddedTaxPercentage=b;this.propertyChangeSupport.firePropertyChange("DEFAULT_VALUE_ADDED_TAX_PERCENTAGE",a,b)}};UserPreferences.prototype.isFurnitureCatalogViewedInTree=function(){return this.furnitureCatalogViewedInTree};UserPreferences.prototype.setFurnitureCatalogViewedInTree=function(a){if(this.furnitureCatalogViewedInTree!==a){this.furnitureCatalogViewedInTree=a;this.propertyChangeSupport.firePropertyChange("FURNITURE_CATALOG_VIEWED_IN_TREE",!a,a)}};UserPreferences.prototype.isNavigationPanelVisible=function(){return this.navigationPanelVisible};UserPreferences.prototype.setNavigationPanelVisible=function(a){if(this.navigationPanelVisible!==a){this.navigationPanelVisible=a;this.propertyChangeSupport.firePropertyChange("NAVIGATION_PANEL_VISIBLE",!a,a)}};UserPreferences.prototype.isEditingIn3DViewEnabled=function(){return this.editingIn3DViewEnabled};UserPreferences.prototype.setEditingIn3DViewEnabled=function(a){if(a!=this.editingIn3DViewEnabled){this.editingIn3DViewEnabled=a;this.propertyChangeSupport.firePropertyChange("EDITING_IN_3D_VIEW_ENABLED",!a,a)}};UserPreferences.prototype.isAerialViewCenteredOnSelectionEnabled=function(){return this.aerialViewCenteredOnSelectionEnabled};UserPreferences.prototype.setAerialViewCenteredOnSelectionEnabled=function(a){if(a!==this.aerialViewCenteredOnSelectionEnabled){this.aerialViewCenteredOnSelectionEnabled=a;this.propertyChangeSupport.firePropertyChange("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED",!a,a)}};UserPreferences.prototype.isObserverCameraSelectedAtChange=function(){return this.observerCameraSelectedAtChange};UserPreferences.prototype.setObserverCameraSelectedAtChange=function(a){if(a!==this.observerCameraSelectedAtChange){this.observerCameraSelectedAtChange=a;this.propertyChangeSupport.firePropertyChange("OBSERVER_CAMERA_SELECTED_AT_CHANGE",!a,a)}};UserPreferences.prototype.isMagnetismEnabled=function(){return this.magnetismEnabled};UserPreferences.prototype.setMagnetismEnabled=function(a){if(this.magnetismEnabled!==a){this.magnetismEnabled=a;this.propertyChangeSupport.firePropertyChange("MAGNETISM_ENABLED",!a,a)}};UserPreferences.prototype.isRulersVisible=function(){return this.rulersVisible};UserPreferences.prototype.setRulersVisible=function(a){if(this.rulersVisible!==a){this.rulersVisible=a;this.propertyChangeSupport.firePropertyChange("RULERS_VISIBLE",!a,a)}};UserPreferences.prototype.isGridVisible=function(){return this.gridVisible};UserPreferences.prototype.setGridVisible=function(a){if(this.gridVisible!==a){this.gridVisible=a;this.propertyChangeSupport.firePropertyChange("GRID_VISIBLE",!a,a)}};UserPreferences.prototype.getDefaultFontName=function(){return this.defaultFontName};UserPreferences.prototype.setDefaultFontName=function(b){if(b!=this.defaultFontName){var a=this.defaultFontName;this.defaultFontName=b;this.propertyChangeSupport.firePropertyChange("DEFAULT_FONT_NAME",a,b)}};UserPreferences.prototype.isFurnitureViewedFromTop=function(){return this.furnitureViewedFromTop};UserPreferences.prototype.setFurnitureViewedFromTop=function(a){if(this.furnitureViewedFromTop!==a){this.furnitureViewedFromTop=a;this.propertyChangeSupport.firePropertyChange("FURNITURE_VIEWED_FROM_TOP",!a,a)}};UserPreferences.prototype.getFurnitureModelIconSize=function(){return this.furnitureModelIconSize};UserPreferences.prototype.setFurnitureModelIconSize=function(a){if(a!==this.furnitureModelIconSize){var b=this.furnitureModelIconSize;this.furnitureModelIconSize=a;this.propertyChangeSupport.firePropertyChange("FURNITURE_MODEL_ICON_SIZE",b,a)}};UserPreferences.prototype.isRoomFloorColoredOrTextured=function(){return this.roomFloorColoredOrTextured};UserPreferences.prototype.setFloorColoredOrTextured=function(a){if(this.roomFloorColoredOrTextured!==a){this.roomFloorColoredOrTextured=a;this.propertyChangeSupport.firePropertyChange("ROOM_FLOOR_COLORED_OR_TEXTURED",!a,a)}};UserPreferences.prototype.getWallPattern=function(){return this.wallPattern};UserPreferences.prototype.setWallPattern=function(a){if(this.wallPattern!==a){var b=this.wallPattern;this.wallPattern=a;this.propertyChangeSupport.firePropertyChange("WALL_PATTERN",b,a)}};UserPreferences.prototype.getNewWallPattern=function(){return this.newWallPattern};UserPreferences.prototype.setNewWallPattern=function(a){if(this.newWallPattern!==a){var b=this.newWallPattern;this.newWallPattern=a;this.propertyChangeSupport.firePropertyChange("NEW_WALL_PATTERN",b,a)}};UserPreferences.prototype.getNewWallThickness=function(){return this.newWallThickness};UserPreferences.prototype.setNewWallThickness=function(b){if(this.newWallThickness!==b){var a=this.newWallThickness;this.newWallThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_THICKNESS",a,b)}};UserPreferences.prototype.getNewWallHeight=function(){return this.newWallHeight};UserPreferences.prototype.setNewWallHeight=function(a){if(this.newWallHeight!==a){var b=this.newWallHeight;this.newWallHeight=a;this.propertyChangeSupport.firePropertyChange("NEW_WALL_HEIGHT",b,a)}};UserPreferences.prototype.getNewWallBaseboardThickness=function(){return this.newWallBaseboardThickness};UserPreferences.prototype.setNewWallBaseboardThickness=function(b){if(this.newWallBaseboardThickness!==b){var a=this.newWallBaseboardThickness;this.newWallBaseboardThickness=b;this.propertyChangeSupport.firePropertyChange("NEW_WALL_SIDEBOARD_THICKNESS",a,b)}};UserPreferences.prototype.getNewWallBaseboardHeight=function(){return this.newWallBaseboardHeight};UserPreferences.prototype.setNewWallBaseboardHeight=function(a){if(this.newWallBaseboardHeight!==a){var b=this.newWallBaseboardHeight;this.newWallBaseboardHeight=a;this.propertyChangeSupport.firePropertyChange("NEW_WALL_SIDEBOARD_HEIGHT",b,a)}};UserPreferences.prototype.getNewRoomFloorColor=function(){return this.newRoomFloorColor};UserPreferences.prototype.setNewRoomFloorColor=function(b){if(this.newRoomFloorColor!==b){var a=this.newRoomFloorColor;this.newRoomFloorColor=b;this.propertyChangeSupport.firePropertyChange("NEW_ROOM_FLOOR_COLOR",a,b)}};UserPreferences.prototype.getNewFloorThickness=function(){return this.newFloorThickness};UserPreferences.prototype.setNewFloorThickness=function(a){if(this.newFloorThickness!==a){var b=this.newFloorThickness;this.newFloorThickness=a;this.propertyChangeSupport.firePropertyChange("NEW_FLOOR_THICKNESS",b,a)}};UserPreferences.prototype.getAutoSaveDelayForRecovery=function(){return this.autoSaveDelayForRecovery};UserPreferences.prototype.setAutoSaveDelayForRecovery=function(b){if(this.autoSaveDelayForRecovery!==b){var a=this.autoSaveDelayForRecovery;this.autoSaveDelayForRecovery=b;this.propertyChangeSupport.firePropertyChange("AUTO_SAVE_DELAY_FOR_RECOVERY",a,b)}};UserPreferences.prototype.getRecentHomes=function(){return this.recentHomes.slice(0)};UserPreferences.prototype.setRecentHomes=function(b){if(b!=this.recentHomes){var a=this.recentHomes;this.recentHomes=b.slice(0);this.propertyChangeSupport.firePropertyChange("RECENT_HOMES",a,this.getRecentHomes())}};UserPreferences.prototype.getRecentHomesMaxCount=function(){return 10};UserPreferences.prototype.getStoredCamerasMaxCount=function(){return 50};UserPreferences.prototype.setActionTipIgnored=function(a){this.propertyChangeSupport.firePropertyChange("IGNORED_ACTION_TIP",null,a)};UserPreferences.prototype.isActionTipIgnored=function(a){return true};UserPreferences.prototype.resetIgnoredActionTips=function(){this.propertyChangeSupport.firePropertyChange("IGNORED_ACTION_TIP",null,null)};UserPreferences.prototype.getDefaultTextStyle=function(a){if(a.name=="Room"){return UserPreferences.DEFAULT_ROOM_TEXT_STYLE}else{return UserPreferences.DEFAULT_TEXT_STYLE}};UserPreferences.prototype.getAutoCompletionStrings=function(b){var a=this.autoCompletionStrings.get(b);if(a!==undefined){return a.slice(0)}else{return[]}};UserPreferences.prototype.addAutoCompletionString=function(c,b){if(b!==null&&b.length>0){var a=this.autoCompletionStrings[c];if(a===undefined){a=[]}else{if(a.indexOf(b)<0){a=a.slice(0)}else{return}}a.splice(0,0,b);this.setAutoCompletionStrings(c,a)}};UserPreferences.prototype.setAutoCompletionStrings=function(b,c){var a=this.autoCompletionStrings[b];if(c!=a){this.autoCompletionStrings[b]=c.slice(0);this.propertyChangeSupport.firePropertyChange("AUTO_COMPLETION_STRINGS",null,b)}};UserPreferences.prototype.getAutoCompletedProperties=function(){if(this.autoCompletionStrings!==null){return Object.keys(this.autoCompletionStrings)}else{return[]}};UserPreferences.prototype.getRecentColors=function(){return this.recentColors};UserPreferences.prototype.setRecentColors=function(a){if(a!=this.recentColors){var b=this.recentColors;this.recentColors=a.slice(0);this.propertyChangeSupport.firePropertyChange("RECENT_COLORS",b,this.getRecentColors())}};UserPreferences.prototype.getRecentTextures=function(){return this.recentTextures};UserPreferences.prototype.setRecentTextures=function(b){if(b!=this.recentTextures){var a=this.recentTextures;this.recentTextures=b.slice(0);this.propertyChangeSupport.firePropertyChange("RECENT_TEXTURES",a,this.getRecentTextures())}};UserPreferences.prototype.setHomeExamples=function(a){if(a!=this.homeExamples){var b=this.homeExamples;this.homeExamples=a.slice(0);this.propertyChangeSupport.firePropertyChange("HOME_EXAMPLES",b,this.getHomeExamples())}};UserPreferences.prototype.getHomeExamples=function(){return this.homeExamples};UserPreferences.prototype.isCheckUpdatesEnabled=function(){};UserPreferences.prototype.setCheckUpdatesEnabled=function(a){};UserPreferences.prototype.isImportedImageResizedWithoutPrompting=function(){return true};function DefaultUserPreferences(b,a,f,d){UserPreferences.call(this);var g;var h;if(b!==undefined&&(typeof b==="boolean")){g=b;h=a;this.furnitureCatalogUrls=undefined;this.furnitureResourcesUrlBase=undefined;this.texturesCatalogUrls=undefined;this.texturesResourcesUrlBase=undefined}else{g=true;h=Locale.getDefault();this.furnitureCatalogUrls=b;this.furnitureResourcesUrlBase=a;this.texturesCatalogUrls=f;this.texturesResourcesUrlBase=d}var c=[];c.push(new DefaultPatternTexture("foreground"));c.push(new DefaultPatternTexture("reversedHatchUp"));c.push(new DefaultPatternTexture("reversedHatchDown"));c.push(new DefaultPatternTexture("reversedCrossHatch"));c.push(new DefaultPatternTexture("background"));c.push(new DefaultPatternTexture("hatchUp"));c.push(new DefaultPatternTexture("hatchDown"));c.push(new DefaultPatternTexture("crossHatch"));var e=new PatternsCatalog(c);this.setPatternsCatalog(e);this.setFurnitureCatalog(g&&(typeof DefaultFurnitureCatalog==="function")?(Array.isArray(b)?new DefaultFurnitureCatalog(b,a):new DefaultFurnitureCatalog(this)):new FurnitureCatalog());this.setTexturesCatalog(g&&(typeof DefaultTexturesCatalog==="function")?(Array.isArray(f)?new DefaultTexturesCatalog(f,d):new DefaultTexturesCatalog(this)):new TexturesCatalog());if(h=="en_US"){this.setUnit(LengthUnit.INCH);this.setNewWallThickness(7.62);this.setNewWallHeight(243.84);this.setNewWallBaseboardThickness(0.9525);this.setNewWallBaseboardHeight(6.35)}else{this.setUnit(LengthUnit.CENTIMETER);this.setNewWallThickness(7.5);this.setNewWallHeight(250);this.setNewWallBaseboardThickness(1);this.setNewWallBaseboardHeight(7)}this.setNewFloorThickness(12);this.setNavigationPanelVisible(false);this.setWallPattern(e.getPattern("hatchUp"));this.setNewWallPattern(this.getWallPattern());this.setAerialViewCenteredOnSelectionEnabled(true);this.setAutoSaveDelayForRecovery(60000)}DefaultUserPreferences.prototype=Object.create(UserPreferences.prototype);DefaultUserPreferences.prototype.constructor=DefaultUserPreferences;DefaultUserPreferences.prototype.write=function(){UserPreferences.prototype.write.call(this)};function DefaultPatternTexture(a){this.name=a;this.image=new URLContent(ZIPTools.getScriptFolder()+"resources/patterns/"+this.name+".png")}DefaultPatternTexture.__class="com.eteks.sweethome3d.io.DefaultPatternTexture";DefaultPatternTexture.__interfaces=["com.eteks.sweethome3d.model.TextureImage"];DefaultPatternTexture.__transients=["image"];DefaultPatternTexture.prototype.getName=function(){return this.name};DefaultPatternTexture.prototype.getCreator=function(){return null};DefaultPatternTexture.prototype.getImage=function(){return this.image};DefaultPatternTexture.prototype.getWidth=function(){return 10};DefaultPatternTexture.prototype.getHeight=function(){return 10};DefaultPatternTexture.prototype.equals=function(b){if(b===this){return true}else{if(b instanceof DefaultPatternTexture){var a=b;return a.name==this.name}else{return false}}};function RecordedUserPreferences(b){UserPreferences.call(this);if(b!==undefined){this.furnitureCatalogUrls=b.furnitureCatalogURLs;this.furnitureResourcesUrlBase=b.furnitureResourcesURLBase;this.texturesCatalogUrls=b.texturesCatalogURLs;this.texturesResourcesUrlBase=b.texturesResourcesURLBase;this.writePreferencesUrl=b.writePreferencesURL;this.readPreferencesUrl=b.readPreferencesURL;this.writeResourceUrl=b.writePreferencesResourceURL!==undefined?b.writePreferencesResourceURL:b.writeResourceURL;this.readResourceUrl=b.readPreferencesResourceURL!==undefined?b.readPreferencesResourceURL:b.readResourceURL;this.writingObserver=b.writingObserver}var a;if(b!==undefined&&b.defaultUserLanguage!==undefined){a=b.defaultUserLanguage}else{a=this.getLanguage()}this.uploadingBlobs={};this.properties={};this.setFurnitureCatalog(new FurnitureCatalog());this.setTexturesCatalog(new TexturesCatalog());if(this.readPreferencesUrl){this.updatePreferencesFromProperties(this.properties,a,false);this.readPreferences(this.properties,a)}else{this.updatePreferencesFromProperties(this.properties,a,true);this.addListeners()}}RecordedUserPreferences.prototype=Object.create(UserPreferences.prototype);RecordedUserPreferences.prototype.constructor=RecordedUserPreferences;RecordedUserPreferences.LANGUAGE="language";RecordedUserPreferences.UNIT="unit";RecordedUserPreferences.CURRENCY="currency";RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED="valueAddedTaxEnabled";RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE="defaultValueAddedTaxPercentage";RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE="furnitureCatalogViewedInTree";RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE="navigationPanelVisible";RecordedUserPreferences.EDITING_IN_3D_VIEW_ENABLED="editingIn3DViewEnabled";RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED="aerialViewCenteredOnSelectionEnabled";RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE="observerCameraSelectedAtChange";RecordedUserPreferences.MAGNETISM_ENABLED="magnetismEnabled";RecordedUserPreferences.RULERS_VISIBLE="rulersVisible";RecordedUserPreferences.GRID_VISIBLE="gridVisible";RecordedUserPreferences.DEFAULT_FONT_NAME="defaultFontName";RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP="furnitureViewedFromTop";RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE="furnitureModelIconSize";RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED="roomFloorColoredOrTextured";RecordedUserPreferences.WALL_PATTERN="wallPattern";RecordedUserPreferences.NEW_WALL_PATTERN="newWallPattern";RecordedUserPreferences.NEW_WALL_THICKNESS="newWallThickness";RecordedUserPreferences.NEW_WALL_HEIGHT="newHomeWallHeight";RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS="newWallBaseboardThickness";RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT="newWallBaseboardHeight";RecordedUserPreferences.NEW_FLOOR_THICKNESS="newFloorThickness";RecordedUserPreferences.AUTO_SAVE_DELAY_FOR_RECOVERY="autoSaveDelayForRecovery";RecordedUserPreferences.RECENT_HOMES="recentHomes#";RecordedUserPreferences.IGNORED_ACTION_TIP="ignoredActionTip#";RecordedUserPreferences.TEXTURE_NAME="textureName#";RecordedUserPreferences.TEXTURE_CREATOR="textureCreator#";RecordedUserPreferences.TEXTURE_CATEGORY="textureCategory#";RecordedUserPreferences.TEXTURE_IMAGE="textureImage#";RecordedUserPreferences.TEXTURE_WIDTH="textureWidth#";RecordedUserPreferences.TEXTURE_HEIGHT="textureHeight#";RecordedUserPreferences.prototype.getProperty=function(b,c,a){if(b[c]===undefined||b[c]===null){return a}return b[c]};RecordedUserPreferences.prototype.getProperties=function(){return this.properties};RecordedUserPreferences.prototype.setProperty=function(b,c,a){b[c]=a};RecordedUserPreferences.prototype.removeProperty=function(a,b){delete a[b]};RecordedUserPreferences.prototype.updatePreferencesFromProperties=function(j,k,e){this.setLanguage(this.getProperty(j,RecordedUserPreferences.LANGUAGE,k));if(e){this.updateDefaultCatalogs()}this.readModifiableTexturesCatalog(j);var g=new DefaultUserPreferences(false,k);g.setLanguage(this.getLanguage());var c=g.getPatternsCatalog();this.setPatternsCatalog(c);var l=LengthUnit[this.getProperty(j,RecordedUserPreferences.UNIT)];if(!l){l=g.getLengthUnit()}this.setUnit(l);this.setCurrency(this.getProperty(j,RecordedUserPreferences.CURRENCY,g.getCurrency()));this.setValueAddedTaxEnabled(this.getProperty(j,RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED,""+g.isValueAddedTaxEnabled())=="true");var m=this.getProperty(j,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE);var d=g.getDefaultValueAddedTaxPercentage();if(m!==null){try{d=new Big(m)}catch(h){}}this.setDefaultValueAddedTaxPercentage(d);this.setFurnitureCatalogViewedInTree(this.getProperty(j,RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE,""+g.isFurnitureCatalogViewedInTree())=="true");this.setNavigationPanelVisible(this.getProperty(j,RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE,""+g.isNavigationPanelVisible())=="true");this.setEditingIn3DViewEnabled(this.getProperty(j,RecordedUserPreferences.EDITING_IN_3D_VIEW_ENABLED,""+g.isEditingIn3DViewEnabled())=="true");this.setAerialViewCenteredOnSelectionEnabled(this.getProperty(j,RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED,""+g.isAerialViewCenteredOnSelectionEnabled())=="true");this.setObserverCameraSelectedAtChange(this.getProperty(j,RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE,""+g.isObserverCameraSelectedAtChange())=="true");this.setMagnetismEnabled(this.getProperty(j,RecordedUserPreferences.MAGNETISM_ENABLED,"true")=="true");this.setRulersVisible(this.getProperty(j,RecordedUserPreferences.RULERS_VISIBLE,""+g.isMagnetismEnabled())=="true");this.setGridVisible(this.getProperty(j,RecordedUserPreferences.GRID_VISIBLE,""+g.isGridVisible())=="true");this.setDefaultFontName(this.getProperty(j,RecordedUserPreferences.DEFAULT_FONT_NAME,g.getDefaultFontName()));this.setFurnitureViewedFromTop(this.getProperty(j,RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP,""+g.isFurnitureViewedFromTop())=="true");this.setFurnitureModelIconSize(parseInt(this.getProperty(j,RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE,""+g.getFurnitureModelIconSize())));this.setFloorColoredOrTextured(this.getProperty(j,RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED,""+g.isRoomFloorColoredOrTextured())=="true");try{this.setWallPattern(c.getPattern(this.getProperty(j,RecordedUserPreferences.WALL_PATTERN,g.getWallPattern().getName())))}catch(h){this.setWallPattern(g.getWallPattern())}try{if(g.getNewWallPattern()!=null){this.setNewWallPattern(c.getPattern(this.getProperty(j,RecordedUserPreferences.NEW_WALL_PATTERN,g.getNewWallPattern().getName())))}}catch(h){}this.setNewWallThickness(parseFloat(this.getProperty(j,RecordedUserPreferences.NEW_WALL_THICKNESS,""+g.getNewWallThickness())));this.setNewWallHeight(parseFloat(this.getProperty(j,RecordedUserPreferences.NEW_WALL_HEIGHT,""+g.getNewWallHeight())));this.setNewWallBaseboardThickness(g.getNewWallBaseboardThickness());this.setNewWallBaseboardHeight(g.getNewWallBaseboardHeight());this.setNewWallBaseboardThickness(parseFloat(this.getProperty(j,RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS,""+g.getNewWallBaseboardThickness())));this.setNewWallBaseboardHeight(parseFloat(this.getProperty(j,RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT,""+g.getNewWallBaseboardHeight())));this.setNewFloorThickness(parseFloat(this.getProperty(j,RecordedUserPreferences.NEW_FLOOR_THICKNESS,""+g.getNewFloorThickness())));this.setAutoSaveDelayForRecovery(parseInt(this.getProperty(j,RecordedUserPreferences.AUTO_SAVE_DELAY_FOR_RECOVERY,""+g.getAutoSaveDelayForRecovery())));var a=[];for(var f=1;f<=this.getRecentHomesMaxCount();f++){var b=this.getProperty(j,RecordedUserPreferences.RECENT_HOMES+f);if(b!=null){a.push(b)}}this.setRecentHomes(a);for(var f=1;;f++){var n=this.getProperty(j,RecordedUserPreferences.IGNORED_ACTION_TIP+f,"");if(n.length==0){break}else{this.ignoredActionTips[n]=true}}};RecordedUserPreferences.prototype.addListeners=function(){var a=this;this.addPropertyChangeListener("LANGUAGE",function(){a.updateDefaultCatalogs()});var e=function(){a.writtenPropertiesUpdated=true};var d=["LANGUAGE","UNIT","CURRENCY","VALUE_ADDED_TAX_ENABLED","DEFAULT_VALUE_ADDED_TAX_PERCENTAGE","FURNITURE_CATALOG_VIEWED_IN_TREE","NAVIGATION_PANEL_VISIBLE","EDITING_IN_3D_VIEW_ENABLED","AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED","OBSERVER_CAMERA_SELECTED_AT_CHANGE","MAGNETISM_ENABLED","GRID_VISIBLE","DEFAULT_FONT_NAME","FURNITURE_VIEWED_FROM_TOP","FURNITURE_MODEL_ICON_SIZE","ROOM_FLOOR_COLORED_OR_TEXTURED","NEW_WALL_PATTERN","NEW_WALL_THICKNESS","NEW_WALL_HEIGHT","NEW_WALL_BASEBOARD_THICKNESS","NEW_WALL_BASEBOARD_HEIGHT","NEW_FLOOR_THICKNESS"];for(var b=0;b<d.length;b++){var c=d[b];this.addPropertyChangeListener(c,e)}this.getTexturesCatalog().addTexturesListener(e)};RecordedUserPreferences.prototype.readPreferences=function(e,g){try{var c=this;var f=function(k){if(k!=null){var m=JSON.parse(k);for(var l in m){e[l]=m[l]}}c.updatePreferencesFromProperties(e,g,true);c.addListeners()};if(this.readPreferencesUrl.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)===0){var j=this.readPreferencesUrl.substring(LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length);f(localStorage.getItem(j))}else{if(this.readPreferencesUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)===0){new IndexedDBURLContent(this.readPreferencesUrl).getBlob({blobReady:function(l){var k=new FileReader();k.onload=function(){f(k.result)};k.readAsText(l)},blobError:function(k,l){c.updateDefaultCatalogs();c.addListeners();if(k!=-1){console.log("Can't read preferences from indexedDB "+k+" "+l)}}})}else{var b=new XMLHttpRequest();var a=this.readPreferencesUrl.indexOf("?")!=-1?"&":"?";b.open("GET",this.readPreferencesUrl+a+"requestId="+UUID.randomUUID(),true);b.addEventListener("load",function(){if(b.readyState===XMLHttpRequest.DONE&&b.status===200){f(b.responseText)}else{c.updateDefaultCatalogs();c.addListeners()}});var h=function(k){console.log("Can't read preferences from server");c.updateDefaultCatalogs();c.addListeners()};b.addEventListener("error",h);b.addEventListener("timeout",h);b.timeout=10000;b.send()}}}catch(d){console.log(d);c.updateDefaultCatalogs();c.addListeners()}};RecordedUserPreferences.prototype.updateDefaultCatalogs=function(){var g=this.getFurnitureCatalog();for(var e=g.getCategories().length-1;e>=0;e--){var b=g.getCategory(e);for(var d=b.getFurniture().length-1;d>=0;d--){var k=b.getPieceOfFurniture(d);if(!k.isModifiable()){g["delete"](k)}}}var c=typeof DefaultFurnitureCatalog==="function"?(Array.isArray(this.furnitureCatalogUrls)?this.readFurnitureCatalogFromResource(this.furnitureCatalogUrls,this.furnitureResourcesUrlBase):new DefaultFurnitureCatalog(this)):new FurnitureCatalog();for(var e=0;e<c.getCategories().length;e++){var b=c.getCategory(e);for(var d=0;d<b.getFurniture().length;d++){var k=b.getPieceOfFurniture(d);g.add(b,k)}}var f=this.getTexturesCatalog();for(var e=f.getCategories().length-1;e>=0;e--){var b=f.getCategory(e);for(var d=b.getTextures().length-1;d>=0;d--){var h=b.getTexture(d);if(!h.isModifiable()){f["delete"](h)}}}var a=typeof DefaultTexturesCatalog==="function"?(Array.isArray(this.texturesCatalogUrls)?this.readTexturesCatalogFromResource(this.texturesCatalogUrls,this.texturesResourcesUrlBase):new DefaultTexturesCatalog(this)):new TexturesCatalog();for(var e=0;e<a.getCategories().length;e++){var b=a.getCategory(e);for(var d=0;d<b.getTextures().length;d++){var h=b.getTexture(d);f.add(b,h)}}};RecordedUserPreferences.prototype.readFurnitureCatalogFromResource=function(b,a){return new DefaultFurnitureCatalog(b,a)};RecordedUserPreferences.prototype.readTexturesCatalogFromResource=function(b,a){return new DefaultTexturesCatalog(b,a)};RecordedUserPreferences.prototype.readModifiableTexturesCatalog=function(b){var c;for(var a=1;(c=this.readModifiableTexture(b,a))!=null;a++){if(c.getImage().getURL()!=""){var d=this.readModifiableTextureCategory(b,a);this.getTexturesCatalog().add(d,c)}}};RecordedUserPreferences.prototype.readModifiableTexture=function(d,c){var b=this.getProperty(d,RecordedUserPreferences.TEXTURE_NAME+c,null);if(b==null){return null}var g=URLContent.fromURL(this.getProperty(d,RecordedUserPreferences.TEXTURE_IMAGE+c,""));var f=parseFloat(this.getProperty(d,RecordedUserPreferences.TEXTURE_WIDTH+c,"0.1"));var a=parseFloat(this.getProperty(d,RecordedUserPreferences.TEXTURE_HEIGHT+c,"0.1"));var e=this.getProperty(d,RecordedUserPreferences.TEXTURE_CREATOR+c,null);return new CatalogTexture(null,b,g,f,a,e,true)};RecordedUserPreferences.prototype.readModifiableTextureCategory=function(b,a){var c=this.getProperty(b,RecordedUserPreferences.TEXTURE_CATEGORY+a,"");return new TexturesCategory(c)};RecordedUserPreferences.prototype.write=function(){UserPreferences.prototype.write.call(this);if(this.writtenPropertiesUpdated){var g=this.getProperties();this.writeModifiableTexturesCatalog(g);this.setProperty(g,RecordedUserPreferences.LANGUAGE,this.getLanguage());this.setProperty(g,RecordedUserPreferences.UNIT,this.getLengthUnit().name());var h=this.getCurrency();if(h===null){this.removeProperty(g,RecordedUserPreferences.CURRENCY)}else{this.setProperty(g,RecordedUserPreferences.CURRENCY,h)}this.setProperty(g,RecordedUserPreferences.VALUE_ADDED_TAX_ENABLED,""+this.isValueAddedTaxEnabled());var c=this.getDefaultValueAddedTaxPercentage();if(c===null){this.removeProperty(g,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE)}else{this.setProperty(g,RecordedUserPreferences.DEFAULT_VALUE_ADDED_TAX_PERCENTAGE,c.toString())}this.setProperty(g,RecordedUserPreferences.FURNITURE_CATALOG_VIEWED_IN_TREE,""+this.isFurnitureCatalogViewedInTree());this.setProperty(g,RecordedUserPreferences.NAVIGATION_PANEL_VISIBLE,""+this.isNavigationPanelVisible());this.setProperty(g,RecordedUserPreferences.EDITING_IN_3D_VIEW_ENABLED,""+this.isEditingIn3DViewEnabled());this.setProperty(g,RecordedUserPreferences.AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED,""+this.isAerialViewCenteredOnSelectionEnabled());this.setProperty(g,RecordedUserPreferences.OBSERVER_CAMERA_SELECTED_AT_CHANGE,""+this.isObserverCameraSelectedAtChange());this.setProperty(g,RecordedUserPreferences.MAGNETISM_ENABLED,""+this.isMagnetismEnabled());this.setProperty(g,RecordedUserPreferences.RULERS_VISIBLE,""+this.isRulersVisible());this.setProperty(g,RecordedUserPreferences.GRID_VISIBLE,""+this.isGridVisible());var b=this.getDefaultFontName();if(b==null){this.removeProperty(g,RecordedUserPreferences.DEFAULT_FONT_NAME)}else{this.setProperty(g,RecordedUserPreferences.DEFAULT_FONT_NAME,b)}this.setProperty(g,RecordedUserPreferences.FURNITURE_VIEWED_FROM_TOP,""+this.isFurnitureViewedFromTop());this.setProperty(g,RecordedUserPreferences.FURNITURE_MODEL_ICON_SIZE,""+this.getFurnitureModelIconSize());this.setProperty(g,RecordedUserPreferences.ROOM_FLOOR_COLORED_OR_TEXTURED,""+this.isRoomFloorColoredOrTextured());this.setProperty(g,RecordedUserPreferences.WALL_PATTERN,this.getWallPattern().getName());var k=this.getNewWallPattern();if(k!=null){this.setProperty(g,RecordedUserPreferences.NEW_WALL_PATTERN,k.getName())}this.setProperty(g,RecordedUserPreferences.NEW_WALL_THICKNESS,""+this.getNewWallThickness());this.setProperty(g,RecordedUserPreferences.NEW_WALL_HEIGHT,""+this.getNewWallHeight());this.setProperty(g,RecordedUserPreferences.NEW_WALL_BASEBOARD_THICKNESS,""+this.getNewWallBaseboardThickness());this.setProperty(g,RecordedUserPreferences.NEW_WALL_BASEBOARD_HEIGHT,""+this.getNewWallBaseboardHeight());this.setProperty(g,RecordedUserPreferences.NEW_FLOOR_THICKNESS,""+this.getNewFloorThickness());this.setProperty(g,RecordedUserPreferences.AUTO_SAVE_DELAY_FOR_RECOVERY,""+this.getAutoSaveDelayForRecovery());var a=this.getRecentHomes();for(var d=0;d<a.length&&d<this.getRecentHomesMaxCount();d++){this.setProperty(g,RecordedUserPreferences.RECENT_HOMES+(d+1),a[d])}var f=Object.keys(this.ignoredActionTips);for(var d=0;d<f.length;d++){var j=f[d];if(this.ignoredActionTips[j]){this.setProperty(g,RecordedUserPreferences.IGNORED_ACTION_TIP+(d+1),j)}}if(Object.keys(this.uploadingBlobs).length>0){var e=this;setTimeout(function(){e.write()},1000)}else{this.writtenPropertiesUpdated=false;this.writePreferences(g)}}};RecordedUserPreferences.prototype.writePreferences=function(g){if(this.writePreferencesUrl){var d=this;if(this.writingPreferences){setTimeout(function(){d.writePreferences(g)},100)}else{this.writingPreferences=true;var b=JSON.stringify(g);var f=function(){if(d.writingObserver!==undefined&&d.writingObserver.writeSucceeded){d.writingObserver.writeSucceeded(g)}setTimeout(function(){delete d.writingPreferences},500)};var e=function(m,n){if(d.writingObserver!==undefined&&d.writingObserver.writeFailed){d.writingObserver.writeFailed(g,m,n)}setTimeout(function(){delete d.writingPreferences;d.writePreferences(g)},10000)};if(this.writePreferencesUrl.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)===0){try{var l=this.writePreferencesUrl.substring(LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length);localStorage.setItem(l,b);f();delete d.writingPreferences}catch(h){e(h,h.message)}}else{if(this.writePreferencesUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)===0){var k=new BlobURLContent(new Blob([b],{type:"application/json"}));k.writeBlob(this.writePreferencesUrl,"",{blobSaved:function(n,m){URL.revokeObjectURL(k.getURL());f()},blobError:function(m,n){URL.revokeObjectURL(k.getURL());e(m,n)}})}else{var c=new XMLHttpRequest();var a=this.writePreferencesUrl.indexOf("?")!=-1?"&":"?";c.open("POST",this.writePreferencesUrl+a+"updateId="+UUID.randomUUID(),true);c.addEventListener("load",function(m){if(c.readyState===XMLHttpRequest.DONE){if(c.status===200){f()}else{e(c.status,c.responseText)}}});var j=function(m){e(0,"Can't post "+d.writePreferencesUrl)};c.addEventListener("error",j);c.addEventListener("timeout",j);c.send(b)}}}}};RecordedUserPreferences.prototype.setActionTipIgnored=function(a){this.ignoredActionTips[a]=true;UserPreferences.prototype.setActionTipIgnored.call(this,a)};RecordedUserPreferences.prototype.isActionTipIgnored=function(a){var b=this.ignoredActionTips[a];return b===true};RecordedUserPreferences.prototype.resetIgnoredActionTips=function(){var b=Object.keys(this.ignoredActionTips);for(var a=0;a<b.length;a++){this.ignoredActionTips[b[a]]=false}UserPreferences.prototype.resetIgnoredActionTips.call(this)};RecordedUserPreferences.prototype.addLanguageLibrary=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.languageLibraryExists=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.furnitureLibraryExists=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.addFurnitureLibrary=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.texturesLibraryExists=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.addTexturesLibrary=function(a){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.getLibraries=function(){throw new UnsupportedOperationException()};RecordedUserPreferences.prototype.writeModifiableTexturesCatalog=function(g){if(this.writeResourceUrl&&this.readResourceUrl){var e=1;var d=this.getTexturesCatalog();var c=this;for(var b=0;b<d.getCategoriesCount();b++){var f=d.getCategory(b);for(var a=0;a<f.getTexturesCount();a++){var k=f.getTexture(a);var h=k.getImage();if(k.isModifiable()&&h instanceof URLContent){this.setProperty(g,RecordedUserPreferences.TEXTURE_NAME+e,k.getName());this.setProperty(g,RecordedUserPreferences.TEXTURE_CATEGORY+e,f.getName());this.setProperty(g,RecordedUserPreferences.TEXTURE_WIDTH+e,k.getWidth());this.setProperty(g,RecordedUserPreferences.TEXTURE_HEIGHT+e,k.getHeight());if(k.getCreator()!=null){this.setProperty(g,RecordedUserPreferences.TEXTURE_CREATOR+e,k.getCreator())}else{this.removeProperty(g,RecordedUserPreferences.TEXTURE_CREATOR+e)}if(h instanceof LocalURLContent&&(!(h instanceof LocalStorageURLContent)||this.writeResourceUrl.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0)&&(!(h instanceof IndexedDBURLContent)||this.writeResourceUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0)){if(!this.isSavedContentInResourceScope(h)){var l=this.uploadingBlobs[h.getURL()];if(l===undefined){h.getBlob({textureImage:h,blobReady:function(m){l=UUID.randomUUID();c.uploadingBlobs[this.textureImage.getURL()]=l;var j=m.type=="image/png"?".png":".jpg";var n=function(o,r,q){if(!c.isSavedContentInResourceScope(o)){var p=URLContent.fromURL(CoreTools.format(c.readResourceUrl.replace(/(%[^s])/g,"%$1"),encodeURIComponent(r)));o.setSavedContent(p)}delete c.uploadingBlobs[o.getURL()];c.setProperty(g,RecordedUserPreferences.TEXTURE_IMAGE+q,o.getSavedContent().getURL())};c.writeResource(h,l+j,e,n)},blobError:function(j,m){contentsObserver.resourcesError(j,m)}})}}else{delete c.uploadingBlobs[h.getURL()];this.setProperty(g,RecordedUserPreferences.TEXTURE_IMAGE+e,h.getSavedContent().getURL())}}else{if(h instanceof URLContent){this.setProperty(g,RecordedUserPreferences.TEXTURE_IMAGE+e,h.getURL())}}e++}}}for(;this.getProperty(g,RecordedUserPreferences.TEXTURE_NAME+e,null)!=null;e++){this.removeProperty(g,RecordedUserPreferences.TEXTURE_NAME+e);this.removeProperty(g,RecordedUserPreferences.TEXTURE_IMAGE+e);this.removeProperty(g,RecordedUserPreferences.TEXTURE_CATEGORY+e);this.removeProperty(g,RecordedUserPreferences.TEXTURE_WIDTH+e);this.removeProperty(g,RecordedUserPreferences.TEXTURE_HEIGHT+e);this.removeProperty(g,RecordedUserPreferences.TEXTURE_CREATOR+e)}}};RecordedUserPreferences.prototype.isSavedContentInResourceScope=function(a){var b=a.getSavedContent();return b!==null&&(!(b instanceof IndexedDBURLContent)||this.writeResourceUrl.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||b.getURL().indexOf(this.writeResourceUrl.substring(0,this.writeResourceUrl.indexOf("?")))===0)};RecordedUserPreferences.prototype.writeResource=function(c,d,b,e){var a=this;c.writeBlob(this.writeResourceUrl,d,{blobSaved:function(g,f){if(a.writingObserver!==undefined&&a.writingObserver.writeSucceeded){a.writingObserver.writeSucceeded(g.getBlob())}e(g,d,b)},blobError:function(f,g){if(a.writingObserver!==undefined&&a.writingObserver.writeFailed){a.writingObserver.writeFailed(c.getBlob(),f,g)}setTimeout(function(){if(c.getSavedContent()===null){a.writeResource(c,d,b,e)}else{e(c,b)}},10000)}})};function ResourceAction(d,a,f,e,c,h,g){AbstractAction.call(this);if(e===undefined){g=h;h=c;c=e;e=false}this.putValue(ResourceAction.RESOURCE_CLASS,a);this.putValue(ResourceAction.RESOURCE_PREFIX,f);this.putValue(ResourceAction.VISIBLE,true);this.readActionProperties(d,a,f);this.setEnabled(e);this.controller=c;this.controllerMethod=h;this.parameters=g;var b=this;d.addPropertyChangeListener("LANGUAGE",{propertyChange:function(j){if(b==null){(j.getSource()).removePropertyChangeListener("LANGUAGE",this)}else{b.readActionProperties(j.getSource(),b.getValue(ResourceAction.RESOURCE_CLASS),b.getValue(ResourceAction.RESOURCE_PREFIX))}}});return this}ResourceAction.prototype=Object.create(AbstractAction.prototype);ResourceAction.prototype.constructor=ResourceAction;ResourceAction.RESOURCE_CLASS="ResourceClass";ResourceAction.RESOURCE_PREFIX="ResourcePrefix";ResourceAction.VISIBLE="Visible";ResourceAction.POPUP="Popup";ResourceAction.TOGGLE_BUTTON_GROUP="ToggleButtonGroup";ResourceAction.TOOL_BAR_ICON="ToolBarIcon";ResourceAction.prototype.readActionProperties=function(e,a,d){var g=d+".";this.putValue(AbstractAction.NAME,this.getOptionalString(e,a,g+AbstractAction.NAME,true));this.putValue(AbstractAction.DEFAULT,this.getValue(AbstractAction.NAME));this.putValue(ResourceAction.POPUP,this.getOptionalString(e,a,g+ResourceAction.POPUP,true));this.putValue(AbstractAction.SHORT_DESCRIPTION,this.getOptionalString(e,a,g+AbstractAction.SHORT_DESCRIPTION,false));this.putValue(AbstractAction.LONG_DESCRIPTION,this.getOptionalString(e,a,g+AbstractAction.LONG_DESCRIPTION,false));var j=this.getOptionalString(e,a,g+AbstractAction.SMALL_ICON,false);if(j!=null){this.putValue(AbstractAction.SMALL_ICON,j)}var f=this.getOptionalString(e,a,g+ResourceAction.TOOL_BAR_ICON,false);if(f!=null){this.putValue(ResourceAction.TOOL_BAR_ICON,f)}var c=g+AbstractAction.ACCELERATOR_KEY;var b=this.getOptionalString(e,a,c+"."+OperatingSystem.getName(),false);if(b==null){b=this.getOptionalString(e,a,c,false)}if(b!=null){this.putValue(AbstractAction.ACCELERATOR_KEY,b)}var h=this.getOptionalString(e,a,g+AbstractAction.MNEMONIC_KEY,false);if(h!=null){this.putValue(AbstractAction.MNEMONIC_KEY,h)}};ResourceAction.prototype.getOptionalString=function(b,a,e,c){try{var f=c?ResourceAction.getLocalizedLabelText(b,a,e):b.getLocalizedString(a,e);if(f!=null&&f.length>0){return f}else{return null}}catch(d){return null}};ResourceAction.getLocalizedLabelText=function(f,d,k,h){var j=f.getLocalizedString(d,k,h);var e=Locale.getDefault();if((e.indexOf("zh")==0||e.indexOf("ja")==0||e.indexOf("ko")==0||e.indexOf("uk")==0)){var b=j.indexOf("(");if(b!==-1){var a=j.indexOf(")");if(b===a-2){var g=j.charAt(b+1);if(g>="A"&&g<="Z"){j=j.substring(0,b)+j.substring(a+1)}}}}return j};ResourceAction.prototype.getURL=function(b){var a=this.getValue(b);if(a!=null&&a.indexOf("://")===-1){a=ZIPTools.getScriptFolder()+a}return a};ResourceAction.prototype.actionPerformed=function(a){if(this.controller!=null&&this.controllerMethod!=null){return this.controller[this.controllerMethod].apply(this.controller,this.parameters)}else{AbstractAction.prototype.actionPerformed.call(this,a)}};function PlanComponent(h,e,b,d,c){this.home=e;this.preferences=b;if(c==null){c=d;d=new Object3DBranchFactory()}this.object3dFactory=d;var g=this;this.pointerType=View.PointerType.MOUSE;this.canvasNeededRepaint=false;this.container=document.getElementById(h);var f=window.getComputedStyle(this.container);this.font=[f.fontStyle,f.fontSize,f.fontFamily].join(" ");if(f.position!="absolute"){this.container.style.position="relative"}if(this.container instanceof HTMLCanvasElement){this.canvas=this.view=this.container;this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight}else{this.canvas=document.createElement("canvas");this.canvas.setAttribute("id",h+".canvas");this.canvas.style.width="100%";this.canvas.style.height="100%";if(PlanComponent.initialBackgroundColor===undefined){PlanComponent.initialBackgroundColor=f.backgroundColor;PlanComponent.initialForegroundColor=f.color}this.canvas.style.backgroundColor=PlanComponent.initialBackgroundColor;this.canvas.style.color=PlanComponent.initialForegroundColor;this.canvas.style.font=f.font;this.scrollPane=document.createElement("div");this.scrollPane.setAttribute("id",h+".scrollPane");this.scrollPane.style.width="100%";this.scrollPane.style.height="100%";if(this.container.style.overflow){this.scrollPane.style.overflow=this.container.style.overflow}else{this.scrollPane.style.overflow="scroll"}this.view=document.createElement("div");this.view.setAttribute("id",h+".view");this.container.appendChild(this.scrollPane);this.container.appendChild(this.canvas);this.scrollPane.appendChild(this.view);this.canvas.style.position="absolute";this.canvas.style.left="0px";this.canvas.style.top="0px";this.scrollPane.style.position="absolute";this.scrollPane.style.left="0px";this.scrollPane.style.top="0px";this.scrollPane.addEventListener("scroll",function(k){g.repaint()})}this.windowResizeListener=function(){g.revalidate()};window.addEventListener("resize",this.windowResizeListener);this.tooltip=document.createElement("div");this.tooltip.style.position="absolute";this.tooltip.style.visibility="hidden";this.tooltip.style.backgroundColor=ColorTools.toRGBAStyle(this.getBackground(),0.7);this.tooltip.style.borderWidth="2px";this.tooltip.style.paddingLeft="2px";this.tooltip.style.borderStyle="solid";this.tooltip.style.whiteSpace="nowrap";this.tooltip.style.borderColor=ColorTools.toRGBAStyle(this.getForeground(),0.7);this.tooltip.style.font=this.font;this.tooltip.style.color=this.canvas.style.color;this.tooltip.style.zIndex=101;document.body.appendChild(this.tooltip);this.touchOverlay=document.createElement("div");this.touchOverlay.classList.add("touch-overlay-timer");this.touchOverlay.style.position="absolute";this.touchOverlay.style.top="0px";this.touchOverlay.style.left="0px";this.touchOverlay.innerHTML='<div id="plan-touch-overlay-timer-content" class="touch-overlay-timer-content"></div><div class="touch-overlay-timer-bg"></div><div class="touch-overlay-timer-hidder"></div><div class="touch-overlay-timer-loader1"></div><div class="touch-overlay-timer-loader2"></div>';document.body.appendChild(this.touchOverlay);for(var a=0;a<this.touchOverlay.children.length;a++){var j=this.touchOverlay.children.item(a);if(j.classList.contains("overlay-timer-loader1")||j.classList.contains("overlay-timer-loader2")){j.style.borderTopColor=this.getSelectionColor();j.style.borderRightColor=this.getSelectionColor()}if(j.classList.contains("touch-overlay-timer-content")){j.style.color=this.getForeground()}j.style.animationDuration=(PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY)+"ms"}this.resolutionScale=this.scrollPane?PlanComponent.HIDPI_SCALE_FACTOR:1;this.selectedItemsOutlinePainted=true;this.backgroundPainted=true;this.planBoundsCacheValid=false;this.setOpaque(true);this.addModelListeners(e,b,c);if(c!=null){this.addMouseListeners(c);this.addFocusListener(c);this.addControllerListener(c);this.createActions(c);this.installDefaultKeyboardActions()}this.rotationCursor=PlanComponent.createCustomCursor("rotation","alias");this.elevationCursor=PlanComponent.createCustomCursor("elevation","row-resize");this.heightCursor=PlanComponent.createCustomCursor("height","ns-resize");this.powerCursor=PlanComponent.createCustomCursor("power","cell");this.resizeCursor=PlanComponent.createCustomCursor("resize","ew-resize");this.moveCursor=PlanComponent.createCustomCursor("move","move");this.panningCursor=PlanComponent.createCustomCursor("panning","move");this.duplicationCursor="copy";this.patternImagesCache={};this.setScale(0.5);setTimeout(this.windowResizeListener)}PlanComponent.__interfaces=["com.eteks.sweethome3d.viewcontroller.PlanView","com.eteks.sweethome3d.viewcontroller.View","com.eteks.sweethome3d.viewcontroller.ExportableView","com.eteks.sweethome3d.viewcontroller.TransferableView"];PlanComponent.initStatics=function(){PlanComponent.MARGIN=40;PlanComponent.INDICATOR_STROKE=new java.awt.BasicStroke(1.5);PlanComponent.POINT_STROKE=new java.awt.BasicStroke(2);PlanComponent.WALL_STROKE_WIDTH=1.5;PlanComponent.BORDER_STROKE_WIDTH=1;PlanComponent.ALIGNMENT_LINE_OFFSET=25;PlanComponent.ERROR_TEXTURE_IMAGE=null;PlanComponent.WAIT_TEXTURE_IMAGE=null;PlanComponent.HIDPI_SCALE_FACTOR=2;PlanComponent.POINT_INDICATOR=new java.awt.geom.Ellipse2D.Float(-1.5,-1.5,3,3);PlanComponent.FURNITURE_ROTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,false);PlanComponent.FURNITURE_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-8,16,16,45,180,java.awt.geom.Arc2D.OPEN),false);PlanComponent.FURNITURE_ROTATION_INDICATOR.moveTo(2.66,-5.66);PlanComponent.FURNITURE_ROTATION_INDICATOR.lineTo(5.66,-5.66);PlanComponent.FURNITURE_ROTATION_INDICATOR.lineTo(4,-8.3);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,false);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-4.5,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-5.2,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-9,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-10,0);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-12,-8,5,16,200,320,java.awt.geom.Arc2D.OPEN),false);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.moveTo(-10,-4.5);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-12.3,-2);PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.lineTo(-12.8,-5.8);var c=java.awt.geom.AffineTransform.getRotateInstance(-Math.PI/2);c.concatenate(java.awt.geom.AffineTransform.getScaleInstance(1,-1));PlanComponent.FURNITURE_ROLL_ROTATION_INDICATOR=PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.createTransformedShape(c);PlanComponent.ELEVATION_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3);PlanComponent.ELEVATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.ELEVATION_INDICATOR.moveTo(0,-5);PlanComponent.ELEVATION_INDICATOR.lineTo(0,5);PlanComponent.ELEVATION_INDICATOR.moveTo(-2.5,5);PlanComponent.ELEVATION_INDICATOR.lineTo(2.5,5);PlanComponent.ELEVATION_INDICATOR.moveTo(-1.2,1.5);PlanComponent.ELEVATION_INDICATOR.lineTo(0,4.5);PlanComponent.ELEVATION_INDICATOR.lineTo(1.2,1.5);PlanComponent.HEIGHT_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3);PlanComponent.FURNITURE_HEIGHT_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(0,-6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-2.5,-6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(2.5,-6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-2.5,6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(2.5,6);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-1.2,-2.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,-5.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(1.2,-2.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.moveTo(-1.2,2.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(0,5.5);PlanComponent.FURNITURE_HEIGHT_INDICATOR.lineTo(1.2,2.5);PlanComponent.LIGHT_POWER_POINT_INDICATOR=new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3);PlanComponent.LIGHT_POWER_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.LIGHT_POWER_INDICATOR.moveTo(-8,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-6,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-6,-1);PlanComponent.LIGHT_POWER_INDICATOR.closePath();PlanComponent.LIGHT_POWER_INDICATOR.moveTo(-3,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-1,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-1,-2.5);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(-3,-1.8);PlanComponent.LIGHT_POWER_INDICATOR.closePath();PlanComponent.LIGHT_POWER_INDICATOR.moveTo(2,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(4,0);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(4,-3.5);PlanComponent.LIGHT_POWER_INDICATOR.lineTo(2,-2.8);PlanComponent.LIGHT_POWER_INDICATOR.closePath();PlanComponent.FURNITURE_RESIZE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.FURNITURE_RESIZE_INDICATOR.append(new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),false);PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(5,-4);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(7,-4);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(7,7);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(-4,7);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(-4,5);PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(3.5,3.5);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(9,9);PlanComponent.FURNITURE_RESIZE_INDICATOR.moveTo(7,9.5);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(10,10);PlanComponent.FURNITURE_RESIZE_INDICATOR.lineTo(9.5,7);PlanComponent.WALL_ORIENTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.WALL_ORIENTATION_INDICATOR.moveTo(-4,-4);PlanComponent.WALL_ORIENTATION_INDICATOR.lineTo(4,0);PlanComponent.WALL_ORIENTATION_INDICATOR.lineTo(-4,4);PlanComponent.WALL_POINT=new java.awt.geom.Ellipse2D.Float(-3,-3,6,6);PlanComponent.WALL_ARC_EXTENT_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.WALL_ARC_EXTENT_INDICATOR.append(new java.awt.geom.Arc2D.Float(-4,1,8,5,210,120,java.awt.geom.Arc2D.OPEN),false);PlanComponent.WALL_ARC_EXTENT_INDICATOR.moveTo(0,6);PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(0,11);PlanComponent.WALL_ARC_EXTENT_INDICATOR.moveTo(-1.8,8.7);PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(0,12);PlanComponent.WALL_ARC_EXTENT_INDICATOR.lineTo(1.8,8.7);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(5,-2);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(5,2);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(6,0);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(11,0);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.moveTo(8.7,-1.8);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(12,0);PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR.lineTo(8.7,1.8);c=java.awt.geom.AffineTransform.getRotateInstance(-Math.PI/4);PlanComponent.CAMERA_YAW_ROTATION_INDICATOR=PlanComponent.FURNITURE_ROTATION_INDICATOR.createTransformedShape(c);c=java.awt.geom.AffineTransform.getRotateInstance(Math.PI);PlanComponent.CAMERA_PITCH_ROTATION_INDICATOR=PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR.createTransformedShape(c);PlanComponent.CAMERA_ELEVATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(0,-4);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(0,4);PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(-2.5,4);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(2.5,4);PlanComponent.CAMERA_ELEVATION_INDICATOR.moveTo(-1.2,0.5);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(0,3.5);PlanComponent.CAMERA_ELEVATION_INDICATOR.lineTo(1.2,0.5);var b=new java.awt.geom.GeneralPath();b.append(new java.awt.geom.Ellipse2D.Float(-0.5,-0.425,1,0.85),false);b.append(new java.awt.geom.Ellipse2D.Float(-0.5,-0.3,0.24,0.6),false);b.append(new java.awt.geom.Ellipse2D.Float(0.26,-0.3,0.24,0.6),false);PlanComponent.CAMERA_HUMAN_BODY=new java.awt.geom.Area(b);var g=new java.awt.geom.GeneralPath();g.append(new java.awt.geom.Ellipse2D.Float(-0.18,-0.45,0.36,1),false);g.moveTo(-0.04,0.55);g.lineTo(0,0.65);g.lineTo(0.04,0.55);g.closePath();PlanComponent.CAMERA_HUMAN_HEAD=new java.awt.geom.Area(g);var d=new java.awt.geom.GeneralPath();d.moveTo(0.5,0.3);d.lineTo(0.45,0.35);d.lineTo(0.2,0.35);d.lineTo(0.2,0.5);d.lineTo(-0.2,0.5);d.lineTo(-0.2,0.35);d.lineTo(-0.3,0.35);d.lineTo(-0.35,0.5);d.lineTo(-0.5,0.3);d.lineTo(-0.5,-0.45);d.lineTo(-0.45,-0.5);d.lineTo(0.45,-0.5);d.lineTo(0.5,-0.45);d.closePath();PlanComponent.CAMERA_BODY=new java.awt.geom.Area(d);PlanComponent.CAMERA_BUTTON=new java.awt.geom.Ellipse2D.Float(-0.37,-0.2,0.15,0.32);PlanComponent.DIMENSION_LINE_MARK_END=new java.awt.geom.GeneralPath();PlanComponent.DIMENSION_LINE_MARK_END.moveTo(-5,5);PlanComponent.DIMENSION_LINE_MARK_END.lineTo(5,-5);PlanComponent.DIMENSION_LINE_MARK_END.moveTo(0,5);PlanComponent.DIMENSION_LINE_MARK_END.lineTo(0,-5);PlanComponent.VERTICAL_DIMENSION_LINE_DISC=new java.awt.geom.Ellipse2D.Float(-1.5,-1.5,3,3);PlanComponent.VERTICAL_DIMENSION_LINE=new java.awt.geom.GeneralPath();PlanComponent.VERTICAL_DIMENSION_LINE.append(new java.awt.geom.Ellipse2D.Float(-5,-5,10,10),false);PlanComponent.DIMENSION_LINE_HEIGHT_INDICATOR=PlanComponent.FURNITURE_HEIGHT_INDICATOR;PlanComponent.TEXT_LOCATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.TEXT_LOCATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-2,0,4,4,190,160,java.awt.geom.Arc2D.CHORD),false);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(0,4);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(0,12);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-1.2,8.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(0,11.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(1.2,8.5);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(2,3);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(9,6);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(6,6.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(10,7);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(7.5,3.5);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-2,3);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-9,6);PlanComponent.TEXT_LOCATION_INDICATOR.moveTo(-6,6.5);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-10,7);PlanComponent.TEXT_LOCATION_INDICATOR.lineTo(-7.5,3.5);PlanComponent.TEXT_ANGLE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.TEXT_ANGLE_INDICATOR.append(new java.awt.geom.Arc2D.Float(-1.25,-1.25,2.5,2.5,10,160,java.awt.geom.Arc2D.CHORD),false);PlanComponent.TEXT_ANGLE_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-8,16,16,30,120,java.awt.geom.Arc2D.OPEN),false);PlanComponent.TEXT_ANGLE_INDICATOR.moveTo(4,-5.2);PlanComponent.TEXT_ANGLE_INDICATOR.lineTo(6.9,-4);PlanComponent.TEXT_ANGLE_INDICATOR.lineTo(5.8,-7);PlanComponent.LABEL_CENTER_INDICATOR=new java.awt.geom.Ellipse2D.Float(-1,-1,2,2);PlanComponent.COMPASS_DISC=new java.awt.geom.Ellipse2D.Float(-0.5,-0.5,1,1);var h=new java.awt.BasicStroke(0.01);PlanComponent.COMPASS=new java.awt.geom.GeneralPath(h.createStrokedShape(PlanComponent.COMPASS_DISC));PlanComponent.COMPASS.append(h.createStrokedShape(new java.awt.geom.Line2D.Float(-0.6,0,-0.5,0)),false);PlanComponent.COMPASS.append(h.createStrokedShape(new java.awt.geom.Line2D.Float(0.6,0,0.5,0)),false);PlanComponent.COMPASS.append(h.createStrokedShape(new java.awt.geom.Line2D.Float(0,0.6,0,0.5)),false);h=new java.awt.BasicStroke(0.04,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);PlanComponent.COMPASS.append(h.createStrokedShape(new java.awt.geom.Line2D.Float(0,0,0,0)),false);var f=new java.awt.geom.GeneralPath();f.moveTo(0,-0.47);f.lineTo(0.15,0.46);f.lineTo(0,0.32);f.lineTo(-0.15,0.46);f.closePath();h=new java.awt.BasicStroke(0.03);PlanComponent.COMPASS.append(h.createStrokedShape(f),false);var j=new java.awt.geom.GeneralPath();j.moveTo(-0.07,-0.55);j.lineTo(-0.07,-0.69);j.lineTo(0.07,-0.56);j.lineTo(0.07,-0.7);PlanComponent.COMPASS.append(h.createStrokedShape(j),false);PlanComponent.COMPASS_ROTATION_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.COMPASS_ROTATION_INDICATOR.append(PlanComponent.POINT_INDICATOR,false);PlanComponent.COMPASS_ROTATION_INDICATOR.append(new java.awt.geom.Arc2D.Float(-8,-7,16,16,210,120,java.awt.geom.Arc2D.OPEN),false);PlanComponent.COMPASS_ROTATION_INDICATOR.moveTo(4,5.66);PlanComponent.COMPASS_ROTATION_INDICATOR.lineTo(7,5.66);PlanComponent.COMPASS_ROTATION_INDICATOR.lineTo(5.6,8.3);c=java.awt.geom.AffineTransform.getRotateInstance(Math.PI/2);PlanComponent.DIMENSION_LINE_HEIGHT_ROTATION_INDICATOR=PlanComponent.COMPASS_ROTATION_INDICATOR.createTransformedShape(c);PlanComponent.COMPASS_RESIZE_INDICATOR=new java.awt.geom.GeneralPath();PlanComponent.COMPASS_RESIZE_INDICATOR.append(new java.awt.geom.Rectangle2D.Float(-1.5,-1.5,3,3),false);PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(4,-6);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(6,-6);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(6,6);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(4,6);PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(5,0);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(9,0);PlanComponent.COMPASS_RESIZE_INDICATOR.moveTo(9,-1.5);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(12,0);PlanComponent.COMPASS_RESIZE_INDICATOR.lineTo(9,1.5);PlanComponent.ARROW=new java.awt.geom.GeneralPath();PlanComponent.ARROW.moveTo(-5,-2);PlanComponent.ARROW.lineTo(0,0);PlanComponent.ARROW.lineTo(-5,2);PlanComponent.ERROR_TEXTURE_IMAGE=TextureManager.getInstance().getErrorImage();PlanComponent.WAIT_TEXTURE_IMAGE=TextureManager.getInstance().getWaitImage();PlanComponent.WEBGL_AVAILABLE=true;var a=document.createElement("canvas");var e=a.getContext("webgl");if(!e){e=a.getContext("experimental-webgl");if(!e){PlanComponent.WEBGL_AVAILABLE=false}}PlanComponent.LONG_TOUCH_DELAY=200;PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING=400;PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY=800;PlanComponent.DOUBLE_TOUCH_DELAY=500};PlanComponent.initStatics();PlanComponent.PaintMode={};PlanComponent.PaintMode[PlanComponent.PaintMode.PAINT=0]="PAINT";PlanComponent.PaintMode[PlanComponent.PaintMode.PRINT=1]="PRINT";PlanComponent.PaintMode[PlanComponent.PaintMode.CLIPBOARD=2]="CLIPBOARD";PlanComponent.PaintMode[PlanComponent.PaintMode.EXPORT=3]="EXPORT";PlanComponent.ActionType={};PlanComponent.ActionType[PlanComponent.ActionType.DELETE_SELECTION=0]="DELETE_SELECTION";PlanComponent.ActionType[PlanComponent.ActionType.ESCAPE=1]="ESCAPE";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_LEFT=2]="MOVE_SELECTION_LEFT";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_UP=3]="MOVE_SELECTION_UP";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_DOWN=4]="MOVE_SELECTION_DOWN";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_RIGHT=5]="MOVE_SELECTION_RIGHT";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_LEFT=6]="MOVE_SELECTION_FAST_LEFT";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_UP=7]="MOVE_SELECTION_FAST_UP";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_DOWN=8]="MOVE_SELECTION_FAST_DOWN";PlanComponent.ActionType[PlanComponent.ActionType.MOVE_SELECTION_FAST_RIGHT=9]="MOVE_SELECTION_FAST_RIGHT";PlanComponent.ActionType[PlanComponent.ActionType.TOGGLE_MAGNETISM_ON=10]="TOGGLE_MAGNETISM_ON";PlanComponent.ActionType[PlanComponent.ActionType.TOGGLE_MAGNETISM_OFF=11]="TOGGLE_MAGNETISM_OFF";PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_ALIGNMENT=12]="ACTIVATE_ALIGNMENT";PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_ALIGNMENT=13]="DEACTIVATE_ALIGNMENT";PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_DUPLICATION=14]="ACTIVATE_DUPLICATION";PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_DUPLICATION=15]="DEACTIVATE_DUPLICATION";PlanComponent.ActionType[PlanComponent.ActionType.ACTIVATE_EDITIION=16]="ACTIVATE_EDITIION";PlanComponent.ActionType[PlanComponent.ActionType.DEACTIVATE_EDITIION=17]="DEACTIVATE_EDITIION";PlanComponent.IndicatorType=function(a){this.name=a};PlanComponent.IndicatorType.prototype.name=function(){return this.name};PlanComponent.IndicatorType.prototype.toString=function(){return this.name};PlanComponent.IndicatorType.ROTATE=new PlanComponent.IndicatorType("ROTATE");PlanComponent.IndicatorType.RESIZE=new PlanComponent.IndicatorType("RESIZE");PlanComponent.IndicatorType.ELEVATE=new PlanComponent.IndicatorType("ELEVATE");PlanComponent.IndicatorType.RESIZE_HEIGHT=new PlanComponent.IndicatorType("RESIZE_HEIGHT");PlanComponent.IndicatorType.CHANGE_POWER=new PlanComponent.IndicatorType("CHANGE_POWER");PlanComponent.IndicatorType.MOVE_TEXT=new PlanComponent.IndicatorType("MOVE_TEXT");PlanComponent.IndicatorType.ROTATE_TEXT=new PlanComponent.IndicatorType("ROTATE_TEXT");PlanComponent.IndicatorType.ROTATE_PITCH=new PlanComponent.IndicatorType("ROTATE_PITCH");PlanComponent.IndicatorType.ROTATE_ROLL=new PlanComponent.IndicatorType("ROTATE_ROLL");PlanComponent.IndicatorType.ARC_EXTENT=new PlanComponent.IndicatorType("ARC_EXTENT");PlanComponent.prototype.getHTMLElement=function(){return this.container};PlanComponent.prototype.addModelListeners=function(k,e,f){var l=this;var j=function(o){if(l.furnitureTopViewIconKeys!=null&&("MODEL"==o.getPropertyName()||"MODEL_ROTATION"==o.getPropertyName()||"MODEL_FLAGS"==o.getPropertyName()||"MODEL_TRANSFORMATIONS"==o.getPropertyName()||"ROLL"==o.getPropertyName()||"PITCH"==o.getPropertyName()||("WIDTH_IN_PLAN"==o.getPropertyName()||"DEPTH_IN_PLAN"==o.getPropertyName()||"HEIGHT_IN_PLAN"==o.getPropertyName())&&(o.getSource().isHorizontallyRotated()||o.getSource().getTexture()!=null)||"MODEL_MIRRORED"==o.getPropertyName()&&o.getSource().getRoll()!=0)){if("HEIGHT_IN_PLAN"==o.getPropertyName()){l.sortedLevelFurniture=null}if(!(o.getSource() instanceof HomeFurnitureGroup)){if(f==null||!f.isModificationState()){l.removeTopViewIconFromCache(o.getSource())}else{if(l.invalidFurnitureTopViewIcons==null){l.invalidFurnitureTopViewIcons=[];var n=function(p){for(var q=0;q<l.invalidFurnitureTopViewIcons.length;q++){l.removeTopViewIconFromCache(l.invalidFurnitureTopViewIcons[q])}l.invalidFurnitureTopViewIcons=null;l.repaint();f.removePropertyChangeListener("MODIFICATION_STATE",n)};f.addPropertyChangeListener("MODIFICATION_STATE",n)}if(l.invalidFurnitureTopViewIcons.indexOf(o.getSource())<0){l.invalidFurnitureTopViewIcons.push(o.getSource())}}}l.revalidate()}else{if(l.furnitureTopViewIconKeys!=null&&("PLAN_ICON"==o.getPropertyName()||"COLOR"==o.getPropertyName()||"TEXTURE"==o.getPropertyName()||"MODEL_MATERIALS"==o.getPropertyName()||"SHININESS"==o.getPropertyName())){l.removeTopViewIconFromCache(o.getSource());l.repaint()}else{if("ELEVATION"==o.getPropertyName()||"LEVEL"==o.getPropertyName()||"HEIGHT_IN_PLAN"==o.getPropertyName()){l.sortedLevelFurniture=null;l.repaint()}else{if("ICON"==o.getPropertyName()||"WALL_CUT_OUT_ON_BOTH_SIDES"==o.getPropertyName()){l.repaint()}else{if(l.doorOrWindowWallThicknessAreasCache!=null&&("WIDTH"==o.getPropertyName()||"DEPTH"==o.getPropertyName()||"ANGLE"==o.getPropertyName()||"MODEL_MIRRORED"==o.getPropertyName()||"X"==o.getPropertyName()||"Y"==o.getPropertyName()||"LEVEL"==o.getPropertyName()||"WALL_THICKNESS"==o.getPropertyName()||"WALL_DISTANCE"==o.getPropertyName()||"WALL_WIDTH"==o.getPropertyName()||"WALL_LEFT"==o.getPropertyName()||"CUT_OUT_SHAPE"==o.getPropertyName())&&CoreTools.removeFromMap(l.doorOrWindowWallThicknessAreasCache,o.getSource())!=null){l.revalidate()}else{l.revalidate()}}}}}};if(k.getFurniture()!=null){k.getFurniture().forEach(function(n){n.addPropertyChangeListener(j);if(n instanceof HomeFurnitureGroup){n.getAllFurniture().forEach(function(o){o.addPropertyChangeListener(j)})}})}var b=function(n){n.removePropertyChangeListener(j);l.removeTopViewIconFromCache(n);if(n instanceof HomeDoorOrWindow&&l.doorOrWindowWallThicknessAreasCache!=null){CoreTools.removeFromMap(l.doorOrWindowWallThicknessAreasCache,n)}};k.addFurnitureListener(function(o){var n=o.getItem();if(o.getType()===CollectionEvent.Type.ADD){n.addPropertyChangeListener(j);if(n instanceof HomeFurnitureGroup){n.getAllFurniture().forEach(function(p){p.addPropertyChangeListener(j)})}}else{if(o.getType()===CollectionEvent.Type.DELETE){b(n);if(n instanceof HomeFurnitureGroup){n.getAllFurniture().forEach(function(p){b(p)})}}}l.sortedLevelFurniture=null;l.revalidate()});var c=function(o){var n=o.getPropertyName();if("X_START"==n||"X_END"==n||"Y_START"==n||"Y_END"==n||"WALL_AT_START"==n||"WALL_AT_END"==n||"THICKNESS"==n||"ARC_EXTENT"==n||"PATTERN"==n){if(l.home.isAllLevelsSelection()){l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null}l.wallAreasCache=null;l.doorOrWindowWallThicknessAreasCache=null;l.revalidate()}else{if("LEVEL"==n||"HEIGHT"==n||"HEIGHT_AT_END"==n){l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null;l.wallAreasCache=null;l.repaint()}}};if(k.getWalls()!=null){k.getWalls().forEach(function(n){n.addPropertyChangeListener(c)})}k.addWallsListener(function(n){if(n.getType()===CollectionEvent.Type.ADD){n.getItem().addPropertyChangeListener(c)}else{if(n.getType()===CollectionEvent.Type.DELETE){n.getItem().removePropertyChangeListener(c)}}l.otherLevelsWallAreaCache=null;l.otherLevelsWallsCache=null;l.wallAreasCache=null;l.doorOrWindowWallThicknessAreasCache=null;l.revalidate()});var m=function(o){var n=o.getPropertyName();if("POINTS"==n||"NAME"==n||"NAME_X_OFFSET"==n||"NAME_Y_OFFSET"==n||"NAME_STYLE"==n||"NAME_ANGLE"==n||"AREA_VISIBLE"==n||"AREA_X_OFFSET"==n||"AREA_Y_OFFSET"==n||"AREA_STYLE"==n||"AREA_ANGLE"==n||"FLOOR_VISIBLE"==n||"CEILING_VISIBLE"==n){l.sortedLevelRooms=null;l.otherLevelsRoomAreaCache=null;l.otherLevelsRoomsCache=null;l.revalidate()}else{if(l.preferences.isRoomFloorColoredOrTextured()&&("FLOOR_COLOR"==n||"FLOOR_TEXTURE"==n||"FLOOR_VISIBLE"==n)){l.repaint()}}};if(k.getRooms()!=null){k.getRooms().forEach(function(n){return n.addPropertyChangeListener(m)})}k.addRoomsListener(function(n){if(n.getType()===CollectionEvent.Type.ADD){n.getItem().addPropertyChangeListener(m)}else{if(n.getType()===CollectionEvent.Type.DELETE){n.getItem().removePropertyChangeListener(m)}}l.sortedLevelRooms=null;l.otherLevelsRoomAreaCache=null;l.otherLevelsRoomsCache=null;l.revalidate()});var h=function(o){var n=o.getPropertyName();if("COLOR"==n||"DASH_STYLE"==n){l.repaint()}else{l.revalidate()}};if(k.getPolylines()!=null){k.getPolylines().forEach(function(n){return n.addPropertyChangeListener(h)})}k.addPolylinesListener(function(n){if(n.getType()===CollectionEvent.Type.ADD){n.getItem().addPropertyChangeListener(h)}else{if(n.getType()===CollectionEvent.Type.DELETE){n.getItem().removePropertyChangeListener(h)}}l.revalidate()});var g=function(o){var n=o.getPropertyName();if("X_START"==n||"X_END"==n||"Y_START"==n||"Y_END"==n||"ELEVATION_START"==n||"ELEVATION_END"==n||"OFFSET"==n||"END_MARK_SIZE"==n||"PITCH"==n||"LENGTH_STYLE"==n){return l.revalidate()}else{if("COLOR"==n){l.repaint()}}};if(k.getDimensionLines()!=null){k.getDimensionLines().forEach(function(n){return n.addPropertyChangeListener(g)})}k.addDimensionLinesListener(function(n){if(n.getType()===CollectionEvent.Type.ADD){n.getItem().addPropertyChangeListener(g)}else{if(n.getType()===CollectionEvent.Type.DELETE){n.getItem().removePropertyChangeListener(g)}}l.revalidate()});var a=function(n){return l.revalidate()};if(k.getLabels()!=null){k.getLabels().forEach(function(n){return n.addPropertyChangeListener(a)})}k.addLabelsListener(function(n){if(n.getType()===CollectionEvent.Type.ADD){n.getItem().addPropertyChangeListener(a)}else{if(n.getType()===CollectionEvent.Type.DELETE){n.getItem().removePropertyChangeListener(a)}}l.revalidate()});var d=function(o){var n=o.getPropertyName();if("BACKGROUND_IMAGE"==n){l.backgroundImageCache=null;l.revalidate()}else{if("ELEVATION"==n||"ELEVATION_INDEX"==n||"VIEWABLE"==n){l.clearLevelCache();l.repaint()}}};if(k.getLevels()!=null){k.getLevels().forEach(function(n){return n.addPropertyChangeListener(d)})}k.addLevelsListener(function(n){var o=n.getItem();if(n.getType()===CollectionEvent.Type.ADD){o.addPropertyChangeListener(d)}else{if(n.getType()===CollectionEvent.Type.DELETE){o.removePropertyChangeListener(d)}}l.revalidate()});k.addPropertyChangeListener("CAMERA",function(n){return l.revalidate()});k.getObserverCamera().addPropertyChangeListener(function(o){var n=o.getPropertyName();if("X"==n||"Y"==n||"FIELD_OF_VIEW"==n||"YAW"==n||"WIDTH"==n||"DEPTH"==n||"HEIGHT"==n){l.revalidate()}});k.getCompass().addPropertyChangeListener(function(o){var n=o.getPropertyName();if("X"==n||"Y"==n||"NORTH_DIRECTION"==n||"DIAMETER"==n||"VISIBLE"==n){l.revalidate()}});k.addSelectionListener({selectionChanged:function(n){return l.repaint()}});k.addPropertyChangeListener("BACKGROUND_IMAGE",function(n){l.backgroundImageCache=null;l.repaint()});k.addPropertyChangeListener("SELECTED_LEVEL",function(n){l.clearLevelCache();l.repaint()});this.preferencesListener=new PlanComponent.UserPreferencesChangeListener(this);e.addPropertyChangeListener("UNIT",this.preferencesListener);e.addPropertyChangeListener("LANGUAGE",this.preferencesListener);e.addPropertyChangeListener("GRID_VISIBLE",this.preferencesListener);e.addPropertyChangeListener("DEFAULT_FONT_NAME",this.preferencesListener);e.addPropertyChangeListener("FURNITURE_VIEWED_FROM_TOP",this.preferencesListener);e.addPropertyChangeListener("FURNITURE_MODEL_ICON_SIZE",this.preferencesListener);e.addPropertyChangeListener("ROOM_FLOOR_COLORED_OR_TEXTURED",this.preferencesListener);e.addPropertyChangeListener("WALL_PATTERN",this.preferencesListener)};PlanComponent.UserPreferencesChangeListener=function(a){this.planComponent=a};PlanComponent.UserPreferencesChangeListener.prototype.propertyChange=function(b){var d=this.planComponent;var a=b.getSource();var c=b.getPropertyName();if(d==null){a.removePropertyChangeListener(c,this)}else{switch((c)){case"LANGUAGE":case"UNIT":if(d.horizontalRuler!=null){d.horizontalRuler.repaint()}if(d.verticalRuler!=null){d.verticalRuler.repaint()}break;case"DEFAULT_FONT_NAME":d.fonts=null;d.fontsMetrics=null;d.revalidate();break;case"WALL_PATTERN":d.wallAreasCache=null;break;case"FURNITURE_VIEWED_FROM_TOP":if(d.furnitureTopViewIconKeys!=null&&!a.isFurnitureViewedFromTop()){d.furnitureTopViewIconKeys=null;d.furnitureTopViewIconsCache=null}break;case"FURNITURE_MODEL_ICON_SIZE":d.furnitureTopViewIconKeys=null;d.furnitureTopViewIconsCache=null;break;default:break}d.repaint()}};PlanComponent.prototype.removeTopViewIconFromCache=function(c){if(this.furnitureTopViewIconKeys!=null){var e=CoreTools.removeFromMap(this.furnitureTopViewIconKeys,c);if(e!=null){var d=CoreTools.valuesFromMap(this.furnitureTopViewIconKeys);var b=false;for(var a=0;a<d.length;a++){if(d[a].hashCode===e.hashCode&&d[a].equals(e)){b=true}}if(!b){CoreTools.removeFromMap(this.furnitureTopViewIconsCache,e)}}}};PlanComponent.prototype.clearLevelCache=function(){this.backgroundImageCache=null;this.otherLevelsWallAreaCache=null;this.otherLevelsWallsCache=null;this.otherLevelsRoomAreaCache=null;this.otherLevelsRoomsCache=null;this.wallAreasCache=null;this.doorOrWindowWallThicknessAreasCache=null;this.sortedLevelRooms=null;this.sortedLevelFurniture=null};PlanComponent.prototype.isEnabled=function(){return true};PlanComponent.prototype.revalidate=function(){this.invalidate(true);this.validate();this.repaint()};PlanComponent.prototype.invalidate=function(a){if(a){var b=this.planBoundsCacheValid;if(!this.invalidPlanBounds){this.invalidPlanBounds=this.getPlanBounds().getBounds2D()}if(b){this.planBoundsCacheValid=false}}};PlanComponent.prototype.validate=function(){if(this.invalidPlanBounds!=null){var e=this.getPreferredSize();if(this.isScrolled()){this.view.style.width=e.width+"px";this.view.style.height=e.height+"px";if(this.canvas.width!==this.scrollPane.clientWidth*this.resolutionScale||this.canvas.height!==this.scrollPane.clientHeight*this.resolutionScale){this.canvas.width=this.scrollPane.clientWidth*this.resolutionScale;this.canvas.height=this.scrollPane.clientHeight*this.resolutionScale;this.canvas.style.width=this.scrollPane.clientWidth+"px";this.canvas.style.height=this.scrollPane.clientHeight+"px"}var d=this.getPlanBounds().getMinX();var c=this.getPlanBounds().getMinY();if(d<this.invalidPlanBounds.getMinX()||c<this.invalidPlanBounds.getMinY()){if(this.scrollPane.clientWidth<this.view.clientWidth||this.scrollPane.clientHeight<this.view.clientHeight.height){var b=this.convertLengthToPixel(this.invalidPlanBounds.getMinX()-d);var a=this.convertLengthToPixel(this.invalidPlanBounds.getMinY()-c);this.scrollPane.scrollLeft+=b;this.scrollPane.scrollTop+=a}}}else{if(this.canvas.width!==this.canvas.clientWidth||this.canvas.height!==this.canvas.clientHeight){this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight}}}delete this.invalidPlanBounds};PlanComponent.prototype.isScrolled=function(){return this.scrollPane!==undefined};PlanComponent.prototype.addMouseListeners=function(a){var c=this;var b={initialPointerLocation:null,lastPointerLocation:null,touchEventType:false,pointerTouches:{},lastEventType:null,lastTargetTouches:[],distanceLastPinch:null,panningAfterPinch:false,firstTouchStartedTimeStamp:0,longTouchStartTime:0,autoScroll:null,longTouch:null,longTouchWhenDragged:false,actionStartedInPlanComponent:false,contextMenuEventType:false,mousePressed:function(d){if(!b.touchEventType&&!b.contextMenuEventType&&c.isEnabled()&&d.button===0){b.updateCoordinates(d,"mousePressed");b.autoScroll=null;b.initialPointerLocation=[d.canvasX,d.canvasY];b.lastPointerLocation=[d.canvasX,d.canvasY];b.actionStartedInPlanComponent=true;a.pressMouse(c.convertXPixelToModel(d.canvasX),c.convertYPixelToModel(d.canvasY),d.clickCount,b.isShiftDown(d),b.isAlignmentActivated(d),b.isDuplicationActivated(d),b.isMagnetismToggled(d))}d.stopPropagation()},isShiftDown:function(d){return d.shiftKey&&!d.altKey&&!d.ctrlKey&&!d.metaKey},isAlignmentActivated:function(d){return OperatingSystem.isWindows()||OperatingSystem.isMacOSX()?d.shiftKey:d.shiftKey&&!d.altKey},isDuplicationActivated:function(d){return OperatingSystem.isMacOSX()?d.altKey:d.ctrlKey},isMagnetismToggled:function(d){return OperatingSystem.isWindows()?d.altKey:(OperatingSystem.isMacOSX()?d.metaKey:d.shiftKey&&d.altKey)},mouseDoubleClicked:function(d){b.updateCoordinates(d,"mouseDoubleClicked");b.mousePressed(d)},windowMouseMoved:function(d){if(!b.touchEventType&&!b.contextMenuEventType){b.updateCoordinates(d,"mouseMoved");if(b.lastPointerLocation!=null){if(b.autoScroll==null&&!b.isInCanvas(d)){b.autoScroll=setInterval(function(){if(b.actionStartedInPlanComponent){var e=document.createEvent("Event");e.initEvent("mousemove",true,true);e.clientX=d.clientX;e.clientY=d.clientY;window.dispatchEvent(e)}else{clearInterval(b.autoScroll);b.autoScroll=null}},10)}if(b.autoScroll!=null&&b.isInCanvas(d)){clearInterval(b.autoScroll);b.autoScroll=null}b.lastPointerLocation=[d.canvasX,d.canvasY]}if(b.initialPointerLocation!=null&&!(b.initialPointerLocation[0]===d.canvasX&&b.initialPointerLocation[1]===d.canvasY)){b.initialPointerLocation=null}if(b.initialPointerLocation==null&&(d.buttons===0&&b.isInCanvas(d)||b.actionStartedInPlanComponent)){if(c.isEnabled()){a.moveMouse(c.convertXPixelToModel(d.canvasX),c.convertYPixelToModel(d.canvasY))}}}},windowMouseReleased:function(d){if(!b.touchEventType){if(b.lastPointerLocation!=null){if(b.autoScroll!=null){clearInterval(b.autoScroll);b.autoScroll=null}if(b.actionStartedInPlanComponent&&c.isEnabled()&&d.button===0){if(b.contextMenuEventType){a.releaseMouse(c.convertXPixelToModel(b.initialPointerLocation[0]),c.convertYPixelToModel(b.initialPointerLocation[1]))}else{b.updateCoordinates(d,"mouseReleased");a.releaseMouse(c.convertXPixelToModel(d.canvasX),c.convertYPixelToModel(d.canvasY))}}b.initialPointerLocation=null;b.lastPointerLocation=null;b.actionStartedInPlanComponent=false}}b.contextMenuEventType=false},pointerPressed:function(d){if(d.pointerType=="mouse"){b.mousePressed(d)}else{b.copyPointerToTargetTouches(d,false);b.touchStarted(d)}},pointerMousePressed:function(d){d.stopPropagation()},windowPointerMoved:function(d){if(d.pointerType=="mouse"){b.windowMouseMoved(d)}else{b.copyPointerToTargetTouches(d,false);b.touchMoved(d)}},windowPointerReleased:function(d){if(d.pointerType=="mouse"){b.windowMouseReleased(d)}else{d.preventDefault();b.copyPointerToTargetTouches(d,true);b.touchEnded(d)}},contextMenuDisplayed:function(d){b.contextMenuEventType=true},touchStarted:function(e){b.touchEventType=e.pointerType===undefined;c.lastTouchEndX=undefined;c.lastTouchEndY=undefined;if(c.isEnabled()){e.preventDefault();if(document.activeElement!=c.container){c.container.focus()}b.updateCoordinates(e,"touchStarted");b.autoScroll=null;if(b.longTouch!=null){clearTimeout(b.longTouch);b.longTouch=null;c.stopLongTouchAnimation()}if(e.targetTouches.length===1){var d=1;if(b.initialPointerLocation!=null&&b.distance(e.canvasX,e.canvasY,b.initialPointerLocation[0],b.initialPointerLocation[1])<5&&e.timeStamp-b.firstTouchStartedTimeStamp<=PlanComponent.DOUBLE_TOUCH_DELAY){d=2;b.firstTouchStartedTimeStamp=0;b.initialPointerLocation=null}else{b.firstTouchStartedTimeStamp=e.timeStamp;b.initialPointerLocation=[e.canvasX,e.canvasY]}b.distanceLastPinch=null;b.lastPointerLocation=[e.canvasX,e.canvasY];b.actionStartedInPlanComponent=true;b.longTouchWhenDragged=false;if(a.getMode()!==PlanController.Mode.PANNING&&d==1){var f=a.getMode()===PlanController.Mode.SELECTION?"&#x21EA;":(a.getMode()===PlanController.Mode.POLYLINE_CREATION&&!a.isModificationState()?"S":"2");b.longTouch=setTimeout(function(){c.startLongTouchAnimation(e.canvasX,e.canvasY,f,function(){if(a.getMode()===PlanController.Mode.SELECTION){a.setAlignmentActivated(true)}else{if(a.getMode()===PlanController.Mode.POLYLINE_CREATION){a.setDuplicationActivated(true)}}})},PlanComponent.LONG_TOUCH_DELAY);b.longTouchStartTime=Date.now()}a.pressMouse(c.convertXPixelToModel(e.canvasX),c.convertYPixelToModel(e.canvasY),d,b.isShiftDown(e),b.isAlignmentActivated(e),b.isDuplicationActivated(e),b.isMagnetismToggled(e),View.PointerType.TOUCH)}else{if(b.autoScroll!=null){clearInterval(b.autoScroll);b.autoScroll=null}a.escape();if(e.targetTouches.length===2){b.actionStartedInPlanComponent=true;b.initialPointerLocation=null;b.distanceLastPinch=b.distance(e.targetTouches[0].clientX,e.targetTouches[0].clientY,e.targetTouches[1].clientX,e.targetTouches[1].clientY)}}}},touchMoved:function(j){if(b.actionStartedInPlanComponent&&c.isEnabled()){j.preventDefault();j.stopPropagation();if(b.updateCoordinates(j,"touchMoved")){c.stopIndicatorAnimation();b.initialPointerLocation=null;if(j.targetTouches.length==1){if(b.lastPointerLocation!=null){if(b.autoScroll!=null&&b.isInCanvas(j)){clearInterval(b.autoScroll);b.autoScroll=null}if(b.autoScroll==null&&!b.isInCanvas(j)&&a.getMode()!==PlanController.Mode.PANNING&&b.lastPointerLocation!=null){b.autoScroll=setInterval(function(){if(b.actionStartedInPlanComponent){b.touchMoved(j)}else{clearInterval(b.autoScroll);b.autoScroll=null}},10)}}if(b.longTouch!=null){clearTimeout(b.longTouch);b.longTouch=null;c.stopLongTouchAnimation()}b.lastPointerLocation=[j.canvasX,j.canvasY];a.moveMouse(c.convertXPixelToModel(j.canvasX),c.convertYPixelToModel(j.canvasY));if(!b.autoScroll&&a.getMode()!==PlanController.Mode.PANNING&&a.getMode()!==PlanController.Mode.SELECTION){b.longTouch=setTimeout(function(){b.longTouchWhenDragged=true;c.startLongTouchAnimation(j.canvasX,j.canvasY,"2")},PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING);b.longTouchStartTime=Date.now()}}else{if(j.targetTouches.length==2&&b.distanceLastPinch!=null){var m=b.distance(j.targetTouches[0].clientX,j.targetTouches[0].clientY,j.targetTouches[1].clientX,j.targetTouches[1].clientY);var g=m/b.distanceLastPinch;var k=c.canvas.getBoundingClientRect();var l=c.convertXPixelToModel((j.targetTouches[0].clientX+j.targetTouches[1].clientX)/2-k.left);var h=c.convertYPixelToModel((j.targetTouches[0].clientY+j.targetTouches[1].clientY)/2-k.top);var f=c.getScale();a.zoom(g);b.distanceLastPinch=m;if(c.isScrolled()&&c.getScale()!==f){c.scrollPane.scrollLeft=0;c.scrollPane.scrollTop=0;var e=(j.targetTouches[0].clientX+j.targetTouches[1].clientX)/2-k.left-c.convertXModelToPixel(l);var d=(j.targetTouches[0].clientY+j.targetTouches[1].clientY)/2-k.top-c.convertYModelToPixel(h);c.moveView(-c.convertPixelToLength(e),-c.convertPixelToLength(d))}}}}}},touchEnded:function(f){if(b.actionStartedInPlanComponent&&c.isEnabled()){b.updateCoordinates(f,"touchEnded");if(b.panningAfterPinch){a.setMode(PlanController.Mode.SELECTION);b.panningAfterPinch=false}if(f.targetTouches.length==0){if(b.autoScroll!=null){clearInterval(b.autoScroll);b.autoScroll=null}if(b.longTouch!=null){clearTimeout(b.longTouch);b.longTouch=null;c.stopLongTouchAnimation()}var e=c.convertXPixelToModel(b.lastPointerLocation[0]);var d=c.convertYPixelToModel(b.lastPointerLocation[1]);a.releaseMouse(e,d);if(a.getMode()!==PlanController.Mode.SELECTION){if(b.isLongTouch(true)&&b.longTouchWhenDragged){a.pressMouse(e,d,1,false,false,false,false,View.PointerType.TOUCH);a.releaseMouse(e,d);a.pressMouse(e,d,2,false,false,false,false,View.PointerType.TOUCH);a.releaseMouse(e,d)}else{if(b.isLongTouch()&&b.initialPointerLocation!=null){a.pressMouse(e,d,2,false,false,false,false,View.PointerType.TOUCH);a.releaseMouse(e,d)}}}if(b.isLongTouch()){f.preventDefault()}c.stopIndicatorAnimation();b.actionStartedInPlanComponent=false}else{if(f.targetTouches.length==1){if(a.getMode()===PlanController.Mode.SELECTION){a.setMode(PlanController.Mode.PANNING);a.pressMouse(c.convertXPixelToModel(f.canvasX),c.convertYPixelToModel(f.canvasY),1,false,false,false,false,View.PointerType.TOUCH);b.panningAfterPinch=true}}else{if(f.targetTouches.length==2&&b.distanceLastPinch!=null){b.distanceLastPinch=b.distance(f.targetTouches[0].clientX,f.targetTouches[0].clientY,f.targetTouches[1].clientX,f.targetTouches[1].clientY)}}}c.lastTouchEndX=c.lastTouchX;c.lastTouchEndY=c.lastTouchY;c.lastTouchX=undefined;c.lastTouchY=undefined}},copyPointerToTargetTouches:function(f,d){if(d){f.changedTouches=[b.pointerTouches[f.pointerId]];delete b.pointerTouches[f.pointerId]}else{b.pointerTouches[f.pointerId]={clientX:f.clientX,clientY:f.clientY}}f.targetTouches=[];for(var e in b.pointerTouches){if(b.pointerTouches.hasOwnProperty(e)){f.targetTouches.push(b.pointerTouches[e])}}},updateCoordinates:function(h,f){c.lastTouchX=undefined;c.lastTouchY=undefined;var g=c.canvas.getBoundingClientRect();var d=true;if(f.indexOf("touch")===0){c.pointerType=View.PointerType.TOUCH;var k=b.lastEventType=="touchStarted"?5:1.5;var j;if(h.targetTouches.length===1&&f=="touchMoved"&&b.distance(b.lastTargetTouches[0].clientX,b.lastTargetTouches[0].clientY,h.targetTouches[0].clientX,h.targetTouches[0].clientY)<k||h.targetTouches.length===0&&f=="touchEnded"&&b.distance(b.lastTargetTouches[0].clientX,b.lastTargetTouches[0].clientY,h.changedTouches[0].clientX,h.changedTouches[0].clientY)<k){j=b.lastTargetTouches;d=false}else{if(h.targetTouches.length==0){j=h.changedTouches}else{j=h.targetTouches}b.lastEventType=f}if(j.length==1){h.canvasX=j[0].clientX-g.left;h.canvasY=j[0].clientY-g.top;c.lastTouchX=h.canvasX;c.lastTouchY=h.canvasY}h.clickCount=1;if(d){b.lastTargetTouches=[];for(var e=0;j[e]!==undefined;e++){b.lastTargetTouches.push({clientX:j[e].clientX,clientY:j[e].clientY})}}}else{c.pointerType=View.PointerType.MOUSE;h.canvasX=h.clientX-g.left;h.canvasY=h.clientY-g.top}if(h.clickCount===undefined){if(f=="mouseDoubleClicked"){h.clickCount=2}else{if(f=="mousePressed"||f=="mouseReleased"){h.clickCount=1}else{h.clickCount=0}}}if(f=="mouseWheelMoved"){h.wheelRotation=(h.deltaY!==undefined?h.deltaX+h.deltaY:-h.wheelDelta)/4}return d},isLongTouch:function(d){return Date.now()-b.longTouchStartTime>((d?PlanComponent.LONG_TOUCH_DELAY_WHEN_DRAGGING:PlanComponent.LONG_TOUCH_DELAY)+PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY)},distance:function(e,g,d,f){return Math.sqrt(Math.pow(d-e,2)+Math.pow(f-g,2))},isInCanvas:function(d){return d.canvasX>=0&&d.canvasX<c.canvas.clientWidth&&d.canvasY>=0&&d.canvasY<c.canvas.clientHeight},mouseWheelMoved:function(f){f.preventDefault();b.updateCoordinates(f,"mouseWheelMoved");var g=OperatingSystem.isMacOSX()?f.metaKey:f.ctrlKey;if(g){var d=c.convertXPixelToModel(f.canvasX);var k=c.convertYPixelToModel(f.canvasY);var e=c.getScale();a.zoom(f.wheelRotation<0?Math.pow(1.05,-f.wheelRotation):Math.pow(0.95,f.wheelRotation));if(c.isScrolled()&&c.getScale()!==e){c.scrollPane.scrollLeft=0;c.scrollPane.scrollTop=0;var j=f.canvasX-c.convertXModelToPixel(d);var h=f.canvasY-c.convertYModelToPixel(k);c.moveView(-c.convertPixelToLength(j),-c.convertPixelToLength(h))}}else{c.moveView(f.shiftKey?c.convertPixelToLength(f.wheelRotation):0,f.shiftKey?0:c.convertPixelToLength(f.wheelRotation))}}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){this.canvas.addEventListener("pointerdown",b.pointerPressed);this.canvas.addEventListener("mousedown",b.pointerMousePressed);this.canvas.addEventListener("dblclick",b.mouseDoubleClicked);window.addEventListener("pointermove",b.windowPointerMoved);window.addEventListener("pointerup",b.windowPointerReleased)}else{this.canvas.addEventListener("touchstart",b.touchStarted);this.canvas.addEventListener("touchmove",b.touchMoved);this.canvas.addEventListener("touchend",b.touchEnded);this.canvas.addEventListener("mousedown",b.mousePressed);this.canvas.addEventListener("dblclick",b.mouseDoubleClicked);window.addEventListener("mousemove",b.windowMouseMoved);window.addEventListener("mouseup",b.windowMouseReleased)}this.canvas.addEventListener("contextmenu",b.contextMenuDisplayed);this.canvas.addEventListener("mousewheel",b.mouseWheelMoved);this.mouseListener=b};PlanComponent.prototype.startLongTouchAnimation=function(a,e,d,c){this.touchOverlay.style.visibility="visible";if(d=="&#x21EA;"){document.getElementById("plan-touch-overlay-timer-content").innerHTML="<span style='font-weight: bold; font-family: sans-serif; font-size: 140%; line-height: 90%'>&#x21EA;</span>"}else{document.getElementById("plan-touch-overlay-timer-content").innerHTML="<span style='font-weight: bold; font-family: sans-serif'>"+d+"</span>"}this.touchOverlay.style.left=(this.canvas.getBoundingClientRect().left+a-this.touchOverlay.clientWidth/2)+"px";this.touchOverlay.style.top=(this.canvas.getBoundingClientRect().top+e-this.touchOverlay.clientHeight-40)+"px";if(this.tooltip.style.visibility=="visible"&&this.tooltip.getBoundingClientRect().top<this.canvas.getBoundingClientRect().top+e){this.tooltip.style.marginTop=-(this.tooltip.clientHeight+70)+"px"}for(var b=0;b<this.touchOverlay.children.length;b++){this.touchOverlay.children.item(b).classList.remove("indicator");this.touchOverlay.children.item(b).classList.add("animated")}if(c!==undefined){this.longTouchAnimationPostTask=setTimeout(c,PlanComponent.LONG_TOUCH_DURATION_AFTER_DELAY)}};PlanComponent.prototype.startIndicatorAnimation=function(a,d,b){if(b=="default"||b=="selection"){this.touchOverlay.style.visibility="hidden"}else{this.touchOverlay.style.visibility="visible";document.getElementById("plan-touch-overlay-timer-content").innerHTML='<img src="'+ZIPTools.getScriptFolder()+"resources/cursors/"+b+'32x32.png"/>';this.touchOverlay.style.left=(this.canvas.getBoundingClientRect().left+a-this.touchOverlay.clientWidth/2)+"px";this.touchOverlay.style.top=(this.canvas.getBoundingClientRect().top+d-this.touchOverlay.clientHeight-40)+"px";if(this.tooltip.style.visibility=="visible"&&this.tooltip.getBoundingClientRect().top<this.canvas.getBoundingClientRect().top+d){this.tooltip.style.marginTop=-(this.tooltip.clientHeight+70)+"px"}for(var c=0;c<this.touchOverlay.children.length;c++){this.touchOverlay.children.item(c).classList.remove("animated");this.touchOverlay.children.item(c).classList.add("indicator")}}};PlanComponent.prototype.stopLongTouchAnimation=function(a,c){this.touchOverlay.style.visibility="hidden";for(var b=0;b<this.touchOverlay.children.length;b++){this.touchOverlay.children.item(b).classList.remove("animated");this.touchOverlay.children.item(b).classList.remove("indicator")}if(this.longTouchAnimationPostTask!==undefined){clearTimeout(this.longTouchAnimationPostTask);delete this.longTouchAnimationPostTask}};PlanComponent.prototype.stopIndicatorAnimation=function(){this.touchOverlay.style.visibility="hidden";for(var a=0;a<this.touchOverlay.children.length;a++){this.touchOverlay.children.item(a).classList.remove("animated");this.touchOverlay.children.item(a).classList.remove("indicator")}};PlanComponent.prototype.addFocusListener=function(a){var b=this;this.focusOutListener=function(){if(b.pointerType===View.PointerType.TOUCH&&b.lastTouchEndX&&b.lastTouchEndY&&a.isModificationState()&&(a.getMode()===PlanController.Mode.WALL_CREATION||a.getMode()===PlanController.Mode.ROOM_CREATION||a.getMode()===PlanController.Mode.POLYLINE_CREATION||a.getMode()===PlanController.Mode.DIMENSION_LINE_CREATION)){a.pressMouse(b.convertXPixelToModel(b.lastTouchEndX),b.convertYPixelToModel(b.lastTouchEndY),1,false,false,false,false,View.PointerType.TOUCH);a.releaseMouse(b.convertXPixelToModel(b.lastTouchEndX),b.convertYPixelToModel(b.lastTouchEndY))}b.mouseListener.lastPointerLocation=null;b.mouseListener.actionStartedInPlanComponent=false;a.escape()};this.container.addEventListener("focusout",this.focusOutListener)};PlanComponent.prototype.addControllerListener=function(a){var b=this;a.addPropertyChangeListener("BASE_PLAN_MODIFICATION_STATE",function(g){var e=a.isBasePlanModificationState();if(e){if(a.getMode()!==PlanController.Mode.WALL_CREATION){var c=b.draggedItemsFeedback!=null?b.draggedItemsFeedback:b.home.getSelectedItems();for(var d=0;d<c.length;d++){var f=c[d];if(!(f instanceof Wall)&&!((f instanceof HomePieceOfFurniture)&&f.isDoorOrWindow())){e=false}}}}if(b.wallsDoorsOrWindowsModification!==e){b.wallsDoorsOrWindowsModification=e;b.repaint()}})};PlanComponent.prototype.installDefaultKeyboardActions=function(){var a=this;this.inputMap={"pressed DELETE":"DELETE_SELECTION","pressed BACK_SPACE":"DELETE_SELECTION","pressed ESCAPE":"ESCAPE","shift pressed ESCAPE":"ESCAPE","pressed LEFT":"MOVE_SELECTION_LEFT","shift pressed LEFT":"MOVE_SELECTION_FAST_LEFT","pressed UP":"MOVE_SELECTION_UP","shift pressed UP":"MOVE_SELECTION_FAST_UP","pressed DOWN":"MOVE_SELECTION_DOWN","shift pressed DOWN":"MOVE_SELECTION_FAST_DOWN","pressed RIGHT":"MOVE_SELECTION_RIGHT","shift pressed RIGHT":"MOVE_SELECTION_FAST_RIGHT","pressed ENTER":"ACTIVATE_EDITIION","shift pressed ENTER":"ACTIVATE_EDITIION"};if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"alt pressed ALT":"ACTIVATE_DUPLICATION","released ALT":"DEACTIVATE_DUPLICATION","shift alt pressed ALT":"ACTIVATE_DUPLICATION","shift released ALT":"DEACTIVATE_DUPLICATION","meta alt pressed ALT":"ACTIVATE_DUPLICATION","meta released ALT":"DEACTIVATE_DUPLICATION","shift meta alt pressed ALT":"ACTIVATE_DUPLICATION","shift meta released ALT":"DEACTIVATE_DUPLICATION","alt pressed ESCAPE":"ESCAPE","alt pressed ENTER":"ACTIVATE_EDITIION"})}else{CoreTools.merge(this.inputMap,{"control pressed CONTROL":"ACTIVATE_DUPLICATION","released CONTROL":"DEACTIVATE_DUPLICATION","shift control pressed CONTROL":"ACTIVATE_DUPLICATION","shift released CONTROL":"DEACTIVATE_DUPLICATION","meta control pressed CONTROL":"ACTIVATE_DUPLICATION","meta released CONTROL":"DEACTIVATE_DUPLICATION","shift meta control pressed CONTROL":"ACTIVATE_DUPLICATION","shift meta released CONTROL":"DEACTIVATE_DUPLICATION","control pressed ESCAPE":"ESCAPE","control pressed ENTER":"ACTIVATE_EDITIION"})}if(OperatingSystem.isWindows()){CoreTools.merge(this.inputMap,{"alt pressed ALT":"TOGGLE_MAGNETISM_ON","released ALT":"TOGGLE_MAGNETISM_OFF","shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","shift released ALT":"TOGGLE_MAGNETISM_OFF","control alt pressed ALT":"TOGGLE_MAGNETISM_ON","control released ALT":"TOGGLE_MAGNETISM_OFF","shift control alt pressed ALT":"TOGGLE_MAGNETISM_ON","shift control released ALT":"TOGGLE_MAGNETISM_OFF","alt pressed ESCAPE":"ESCAPE","alt pressed ENTER":"ACTIVATE_EDITIION"})}else{if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"meta pressed META":"TOGGLE_MAGNETISM_ON","released META":"TOGGLE_MAGNETISM_OFF","shift meta pressed META":"TOGGLE_MAGNETISM_ON","shift released META":"TOGGLE_MAGNETISM_OFF","alt meta pressed META":"TOGGLE_MAGNETISM_ON","alt released META":"TOGGLE_MAGNETISM_OFF","shift alt meta pressed META":"TOGGLE_MAGNETISM_ON","shift alt released META":"TOGGLE_MAGNETISM_OFF","meta pressed ESCAPE":"ESCAPE","meta pressed ENTER":"ACTIVATE_EDITIION"})}else{CoreTools.merge(this.inputMap,{"shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","alt shift pressed SHIFT":"TOGGLE_MAGNETISM_ON","alt released SHIFT":"TOGGLE_MAGNETISM_OFF","shift released ALT":"TOGGLE_MAGNETISM_OFF","control shift alt pressed ALT":"TOGGLE_MAGNETISM_ON","control alt shift pressed SHIFT":"TOGGLE_MAGNETISM_ON","control alt released SHIFT":"TOGGLE_MAGNETISM_OFF","control shift released ALT":"TOGGLE_MAGNETISM_OFF","alt shift pressed ESCAPE":"ESCAPE","alt shift  pressed ENTER":"ACTIVATE_EDITIION","control alt shift pressed ESCAPE":"ESCAPE","control alt shift pressed ENTER":"ACTIVATE_EDITIION"})}}CoreTools.merge(this.inputMap,{"shift pressed SHIFT":"ACTIVATE_ALIGNMENT","released SHIFT":"DEACTIVATE_ALIGNMENT"});if(OperatingSystem.isWindows()){CoreTools.merge(this.inputMap,{"control shift pressed SHIFT":"ACTIVATE_ALIGNMENT","control released SHIFT":"DEACTIVATE_ALIGNMENT","alt shift pressed SHIFT":"ACTIVATE_ALIGNMENT","alt released SHIFT":"DEACTIVATE_ALIGNMENT"})}else{if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"alt shift pressed SHIFT":"ACTIVATE_ALIGNMENT","alt released SHIFT":"DEACTIVATE_ALIGNMENT","meta shift pressed SHIFT":"ACTIVATE_ALIGNMENT","meta released SHIFT":"DEACTIVATE_ALIGNMENT"})}else{CoreTools.merge(this.inputMap,{"control shift pressed SHIFT":"ACTIVATE_ALIGNMENT","control released SHIFT":"DEACTIVATE_ALIGNMENT","shift released ALT":"ACTIVATE_ALIGNMENT","control shift released ALT":"ACTIVATE_ALIGNMENT"})}}this.keyDownListener=function(b){return a.callAction(b,"keydown")};this.container.addEventListener("keydown",this.keyDownListener,false);this.keyUpListener=function(b){return a.callAction(b,"keyup")};this.container.addEventListener("keyup",this.keyUpListener,false)};PlanComponent.prototype.callAction=function(a,e){var d=KeyStroke.getKeyStrokeForEvent(a,e);if(d!==undefined){var c=this.inputMap[d];if(c!==undefined){var b=this.actionMap[c];if(b!==undefined){b.actionPerformed(a)}a.stopPropagation()}}};PlanComponent.prototype.installEditionKeyboardActions=function(){this.inputMap={ESCAPE:"ESCAPE","shift ESCAPE":"ESCAPE",ENTER:"DEACTIVATE_EDITIION","shift ENTER":"DEACTIVATE_EDITIION"};if(OperatingSystem.isMacOSX()){CoreTools.merge(this.inputMap,{"alt ESCAPE":"ESCAPE","alt ENTER":"DEACTIVATE_EDITIION","alt shift ENTER":"DEACTIVATE_EDITIION","alt pressed ALT":"ACTIVATE_DUPLICATION","released ALT":"DEACTIVATE_DUPLICATION","shift alt pressed ALT":"ACTIVATE_DUPLICATION","shift released ALT":"DEACTIVATE_DUPLICATION"})}else{CoreTools.merge(this.inputMap,{"control ESCAPE":"ESCAPE","control ENTER":"DEACTIVATE_EDITIION","control shift ENTER":"DEACTIVATE_EDITIION","control pressed CONTROL":"ACTIVATE_DUPLICATION","released CONTROL":"DEACTIVATE_DUPLICATION","shift control pressed CONTROL":"ACTIVATE_DUPLICATION","shift released CONTROL":"DEACTIVATE_DUPLICATION"})}};PlanComponent.prototype.createActions=function(a){var g=this;function f(j,h){this.dx=j;this.dy=h}f.prototype.actionPerformed=function(h){a.moveSelection(this.dx/g.getScale(),this.dy/g.getScale())};function c(h){this.toggle=h}c.prototype.actionPerformed=function(h){a.toggleMagnetism(this.toggle)};function e(h){this.alignmentActivated=h}e.prototype.actionPerformed=function(h){a.setAlignmentActivated(this.alignmentActivated)};function b(h){this.duplicationActivated=h}b.prototype.actionPerformed=function(h){a.setDuplicationActivated(this.duplicationActivated)};function d(h){this.editionActivated=h}d.prototype.actionPerformed=function(h){a.setEditionActivated(this.editionActivated)};this.actionMap={DELETE_SELECTION:{actionPerformed:function(){a.deleteSelection()}},ESCAPE:{actionPerformed:function(){a.escape()}},MOVE_SELECTION_LEFT:new f(-1,0),MOVE_SELECTION_FAST_LEFT:new f(-10,0),MOVE_SELECTION_UP:new f(0,-1),MOVE_SELECTION_FAST_UP:new f(0,-10),MOVE_SELECTION_DOWN:new f(0,1),MOVE_SELECTION_FAST_DOWN:new f(0,10),MOVE_SELECTION_RIGHT:new f(1,0),MOVE_SELECTION_FAST_RIGHT:new f(10,0),TOGGLE_MAGNETISM_ON:new c(true),TOGGLE_MAGNETISM_OFF:new c(false),ACTIVATE_ALIGNMENT:new e(true),DEACTIVATE_ALIGNMENT:new e(false),ACTIVATE_DUPLICATION:new b(true),DEACTIVATE_DUPLICATION:new b(false),ACTIVATE_EDITIION:new d(true),DEACTIVATE_EDITIION:new d(false)}};PlanComponent.createCustomCursor=function(a,b){if(OperatingSystem.isInternetExplorer()){return b}else{return'url("'+ZIPTools.getScriptFolder()+"/resources/cursors/"+a+"16x16"+(OperatingSystem.isMacOSX()?"-macosx":"")+'.png") 8 8, '+b}};PlanComponent.prototype.getPreferredSize=function(){var a=this.getInsets();var b=this.getPlanBounds();return{width:this.convertLengthToPixel(b.getWidth()+PlanComponent.MARGIN*2)+a.left+a.right,height:this.convertLengthToPixel(b.getHeight()+PlanComponent.MARGIN*2)+a.top+a.bottom}};PlanComponent.prototype.getInsets=function(){return{top:0,bottom:0,left:0,right:0}};PlanComponent.prototype.getWidth=function(){return this.view.clientWidth};PlanComponent.prototype.getHeight=function(){return this.view.clientHeight};PlanComponent.prototype.getPlanBounds=function(){var d=this;if(!this.planBoundsCacheValid){if(this.planBoundsCache==null){this.planBoundsCache=new java.awt.geom.Rectangle2D.Float(0,0,1000,1000)}if(this.backgroundImageCache!=null){var c=this.home.getBackgroundImage();if(c!=null){this.planBoundsCache.add(-c.getXOrigin(),-c.getYOrigin());this.planBoundsCache.add(this.backgroundImageCache.width*c.getScale()-c.getXOrigin(),this.backgroundImageCache.height*c.getScale()-c.getYOrigin())}this.home.getLevels().forEach(function(f){var e=f.getBackgroundImage();if(e!=null){d.planBoundsCache.add(-e.getXOrigin(),-e.getYOrigin());d.planBoundsCache.add(d.backgroundImageCache.width*e.getScale()-e.getXOrigin(),d.backgroundImageCache.height*e.getScale()-e.getYOrigin())}})}var b=this.getGraphics();if(b!=null){this.setRenderingHints(b)}var a=this.getItemsBounds(b,this.getPaintedItems());if(a!=null){this.planBoundsCache.add(a)}this.home.getObserverCamera().getPoints().forEach(function(e){return d.planBoundsCache.add(e[0],e[1])});this.planBoundsCacheValid=true}return this.planBoundsCache};PlanComponent.prototype.getPaintedItems=function(){return this.home.getSelectableViewableItems()};PlanComponent.prototype.getItemsBounds=function(f,a){var b=null;for(var c=0;c<a.length;c++){var e=a[c];var d=this.getItemBounds(f,e);if(b==null){b=d}else{b.add(d)}}return b};PlanComponent.prototype.getItemBounds=function(y,D){var d=this;var w=D.getPoints();var o=new java.awt.geom.Rectangle2D.Float(w[0][0],w[0][1],0,0);for(var x=1;x<w.length;x++){o.add(w[x][0],w[x][1])}var c;if(y!=null){c=y.getFont()}else{c=this.getFont()}if(D instanceof Room){var C=D;var t=C.getXCenter();var A=C.getYCenter();var E=C.getName();if(E!=null&&E.length>0){this.addTextBounds(C.constructor,E,C.getNameStyle(),t+C.getNameXOffset(),A+C.getNameYOffset(),C.getNameAngle(),o)}if(C.isAreaVisible()){var B=C.getArea();if(B>0.01){var r=this.preferences.getLengthUnit().getAreaFormatWithUnit().format(B);this.addTextBounds(C.constructor,r,C.getAreaStyle(),t+C.getAreaXOffset(),A+C.getAreaYOffset(),C.getAreaAngle(),o)}}}else{if(D instanceof Polyline){var s=D;return ShapeTools.getPolylineShape(s.getPoints(),s.getJoinStyle()===Polyline.JoinStyle.CURVED,s.isClosedPath()).getBounds2D()}else{if(D instanceof HomePieceOfFurniture){if(D!=null&&D instanceof HomeDoorOrWindow){var F=D;F.getSashes().forEach(function(g){o.add(d.getDoorOrWindowSashShape(F,g).getBounds2D())})}else{if(D instanceof HomeFurnitureGroup){o.add(this.getItemsBounds(y,D.getFurniture()))}}var e=D;var n=e.getName();if(e.isVisible()&&e.isNameVisible()&&n.length>0){this.addTextBounds(e.constructor,n,e.getNameStyle(),e.getX()+e.getNameXOffset(),e.getY()+e.getNameYOffset(),e.getNameAngle(),o)}}else{if(D instanceof DimensionLine){var k=D;var j=k.getLength();var f=this.preferences.getLengthUnit().getFormat().format(j);var u=k.getLengthStyle();if(u==null){u=this.preferences.getDefaultTextStyle(k.constructor)}var q=java.awt.geom.AffineTransform.getTranslateInstance(k.getXStart(),k.getYStart());var z=k.isElevationDimensionLine()?(k.getPitch()+2*Math.PI)%(2*Math.PI):Math.atan2(k.getYEnd()-k.getYStart(),k.getXEnd()-k.getXStart());if(k.getElevationStart()==k.getElevationEnd()){var l=this.getFontMetrics(c,u);var p=l.getStringBounds(f);q.rotate(z);q.translate(0,k.getOffset());q.translate((j-p.getWidth())/2,k.getOffset()<=0?-l.getDescent()-1:l.getAscent()+1);var v=new java.awt.geom.GeneralPath(p);for(var h=v.getPathIterator(q);!h.isDone();h.next()){var b=[0,0];if(h.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){o.add(b[0],b[1])}}}q.setToTranslation(k.getXStart(),k.getYStart());q.rotate(z);q.translate(0,k.getOffset());for(var h=PlanComponent.DIMENSION_LINE_MARK_END.getPathIterator(q);!h.isDone();h.next()){var b=[0,0];if(h.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){o.add(b[0],b[1])}}q.translate(j,0);for(var h=PlanComponent.DIMENSION_LINE_MARK_END.getPathIterator(q);!h.isDone();h.next()){var b=[0,0];if(h.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){o.add(b[0],b[1])}}}else{if(D instanceof Label){var m=D;this.addTextBounds(m.constructor,m.getText(),m.getStyle(),m.getX(),m.getY(),m.getAngle(),o)}else{if(D instanceof Compass){var a=D;var q=java.awt.geom.AffineTransform.getTranslateInstance(a.getX(),a.getY());q.scale(a.getDiameter(),a.getDiameter());q.rotate(a.getNorthDirection());return PlanComponent.COMPASS.createTransformedShape(q).getBounds2D()}}}}}}return o};PlanComponent.prototype.addTextBounds=function(b,f,c,a,g,e,d){if(c==null){c=this.preferences.getDefaultTextStyle(b)}this.getTextBounds(f,c,a,g,e).forEach(function(h){return d.add(h[0],h[1])})};PlanComponent.prototype.getTextBounds=function(m,p,k,j,r){var e=this.getFontMetrics(this.getFont(),p);var n=null;var b=m.replace(/\n*$/,"").split("\n");var q=this.getGraphics();if(q!=null){this.setRenderingHints(q)}for(var o=0;o<b.length;o++){var t=e.getStringBounds(b[o]);if(n==null||n.getWidth()<t.getWidth()){n=t}}var d=n.getWidth();var v;if(p.getAlignment()===TextStyle.Alignment.LEFT){v=0}else{if(p.getAlignment()===TextStyle.Alignment.RIGHT){v=-d}else{v=-d/2}}if(r===0){var u=(j+n.getY());var s=(u+n.getHeight());u-=(n.getHeight()*(b.length-1));return[[k+v,u],[k+v+d,u],[k+v+d,s],[k+v,s]]}else{n.add(n.getX(),n.getY()-n.getHeight()*(b.length-1));var l=new java.awt.geom.AffineTransform();l.translate(k,j);l.rotate(r);l.translate(v,0);var c=new java.awt.geom.GeneralPath(n);var f=[];for(var h=c.getPathIterator(l);!h.isDone();h.next()){var a=[0,0];if(h.currentSegment(a)!==java.awt.geom.PathIterator.SEG_CLOSE){f.push(a)}}return f.slice(0)}};PlanComponent.prototype.getFont=function(d,f){if(d==null&&f==null){return this.font}if(this.fonts==null){this.fonts={}}var b=CoreTools.getFromMap(this.fonts,f);if(b==null){var e="normal";var a="normal";if(f.isBold()){a="bold"}if(f.isItalic()){e="italic"}if(d==null||this.preferences.getDefaultFontName()!=null||f.getFontName()!=null){var c=f.getFontName();if(c==null){c=this.preferences.getDefaultFontName()}if(c==null){c=new Font(this.font).family}d=new Font({style:e,weight:a,size:"10px",family:c}).toString()}b=new Font({style:e,weight:a,size:f.getFontSize()+"px",family:new Font(d).family}).toString();CoreTools.putToMap(this.fonts,f,b)}return b};PlanComponent.prototype.setFont=function(a){this.font=a};PlanComponent.prototype.getFontMetrics=function(b,c){if(c==null){return new FontMetrics(b)}if(this.fontsMetrics==null){this.fontsMetrics={}}var a=CoreTools.getFromMap(this.fontsMetrics,c);if(a==null){a=this.getFontMetrics(this.getFont(b,c));CoreTools.putToMap(this.fontsMetrics,c,a)}return a};PlanComponent.prototype.setBackgroundPainted=function(a){if(this.backgroundPainted!==a){this.backgroundPainted=a;this.repaint()}};PlanComponent.prototype.isBackgroundPainted=function(){return this.backgroundPainted};PlanComponent.prototype.setSelectedItemsOutlinePainted=function(a){if(this.selectedItemsOutlinePainted!==a){this.selectedItemsOutlinePainted=a;this.repaint()}};PlanComponent.prototype.isSelectedItemsOutlinePainted=function(){return this.selectedItemsOutlinePainted};PlanComponent.prototype.repaint=function(){var a=this;if(!this.canvasNeededRepaint){this.canvasNeededRepaint=true;requestAnimationFrame(function(){if(a.canvasNeededRepaint){a.canvasNeededRepaint=false;a.paintComponent(a.getGraphics())}})}};PlanComponent.prototype.getGraphics=function(){if(!this.graphics){this.graphics=new Graphics2D(this.canvas)}return this.graphics};PlanComponent.prototype.paintComponent=function(b){b.setTransform(new java.awt.geom.AffineTransform());b.clear();if(this.backgroundPainted){this.paintBackground(b,this.getBackgroundColor(PlanComponent.PaintMode.PAINT))}var a=this.getInsets();var d=this.getPlanBounds();var c=this.getScale()*this.resolutionScale;if(this.isScrolled()){b.translate(-this.scrollPane.scrollLeft*this.resolutionScale,-this.scrollPane.scrollTop*this.resolutionScale)}b.translate(a.left*this.resolutionScale+(PlanComponent.MARGIN-d.getMinX())*c,a.top*this.resolutionScale+(PlanComponent.MARGIN-d.getMinY())*c);b.scale(c,c);this.setRenderingHints(b);if(this.drawPlanBounds){b.setColor("#FF0000");b.draw(d)}this.paintContent(b,this.home.getSelectedLevel(),this.getScale(),PlanComponent.PaintMode.PAINT);b.dispose()};PlanComponent.prototype.getPrintPreferredScale=function(b,a){return 1};PlanComponent.prototype.getStrokeWidth=function(b,a){var c;if(Wall===b||Room===b){c=PlanComponent.WALL_STROKE_WIDTH}else{c=PlanComponent.BORDER_STROKE_WIDTH}if(a===PlanComponent.PaintMode.PRINT){c*=0.5}return c};PlanComponent.prototype.createTransferData=function(a){if(a===TransferableView.DataType.PLAN_IMAGE){return this.getClipboardImage()}else{return null}};PlanComponent.prototype.getClipboardImage=function(){throw new UnsupportedOperationException("Not implemented")};PlanComponent.prototype.isFormatTypeSupported=function(a){return false};PlanComponent.prototype.exportData=function(a,c,b){throw new UnsupportedOperationException("Unsupported format "+c)};PlanComponent.prototype.setRenderingHints=function(a){};PlanComponent.prototype.paintBackground=function(b,a){if(this.isOpaque()){b.setColor(a);b.fillRect(0,0,this.canvas.width,this.canvas.height)}};PlanComponent.prototype.isOpaque=function(){return this.opaque===true};PlanComponent.prototype.setOpaque=function(a){this.opaque=a};PlanComponent.prototype.paintBackgroundImage=function(a,c,g){var j=this.home.getSelectedLevel();var k=null;if(c!=null){var m=this.home.getLevels();for(var e=m.length-1;e>=0;e--){var l=m[e];if(l.getElevation()===c.getElevation()&&l.getElevationIndex()<=c.getElevationIndex()&&l.isViewable()&&l.getBackgroundImage()!=null&&l.getBackgroundImage().isVisible()){k=l;break}}}var h=k==null?this.home.getBackgroundImage():k.getBackgroundImage();if(h!=null&&h.isVisible()){var d=a.getTransform();a.translate(-h.getXOrigin(),-h.getYOrigin());var b=h.getScale();a.scale(b,b);var f=this.setTransparency(a,0.7);a.drawImage(this.backgroundImageCache!=null?this.backgroundImageCache:this.readBackgroundImage(h.getImage()),0,0);a.setAlpha(f);a.setTransform(d);return true}return false};PlanComponent.prototype.getForegroundColor=function(a){if(a===PlanComponent.PaintMode.PAINT){return this.getForeground()}else{return"#000000"}};PlanComponent.prototype.getForeground=function(){if(this.foreground==null){this.foreground=ColorTools.styleToHexadecimalString(this.canvas.style.color)}return this.foreground};PlanComponent.prototype.getBackgroundColor=function(a){if(a===PlanComponent.PaintMode.PAINT){return this.getBackground()}else{return"#FFFFFF"}};PlanComponent.prototype.getBackground=function(){if(this.background==null){this.background=ColorTools.styleToHexadecimalString(this.canvas.style.backgroundColor)}return this.background};PlanComponent.prototype.readBackgroundImage=function(b){var a=this;if(this.backgroundImageCache!=PlanComponent.WAIT_TEXTURE_IMAGE&&this.backgroundImageCache!=PlanComponent.ERROR_TEXTURE_IMAGE){this.backgroundImageCache=PlanComponent.WAIT_TEXTURE_IMAGE;TextureManager.getInstance().loadTexture(b,{textureUpdated:function(c){a.backgroundImageCache=c;a.repaint()},textureError:function(){a.backgroundImageCache=PlanComponent.ERROR_TEXTURE_IMAGE;a.repaint()}})}return this.backgroundImageCache};PlanComponent.prototype.paintOtherLevels=function(k,b,q,f,n){var d=this;var g=this.home.getLevels();if(g.length&&b!=null){var p=g[0].getElevation()===b.getElevation();var c=null;if(this.otherLevelsRoomsCache==null||this.otherLevelsWallsCache==null){var r=g.indexOf(b);c=[];if(p){var a=r;while(++a<g.length&&g[a].getElevation()===b.getElevation()){}if(a<g.length){var e=g[a];var l=e.getElevation();do{if(e.isViewable()){c.push(e)}}while(++a<g.length&&(e=g[a]).getElevation()===l)}}else{var s=r;while(--s>=0&&g[s].getElevation()===b.getElevation()){}if(s>=0){var t=g[s];var j=t.getElevation();do{if(t.isViewable()){c.push(t)}}while(--s>=0&&(t=g[s]).getElevation()===j)}}if(this.otherLevelsRoomsCache==null){if(c.length!==0){var o=[];this.home.getRooms().forEach(function(u){c.forEach(function(v){if(u.getLevel()===v&&(p&&u.isFloorVisible()||!p&&u.isCeilingVisible())){o.push(u)}})});if(o.length>0){this.otherLevelsRoomAreaCache=this.getItemsArea(o);this.otherLevelsRoomsCache=o}}if(this.otherLevelsRoomsCache==null){this.otherLevelsRoomsCache=[]}}if(this.otherLevelsWallsCache==null){if(c.length!==0){var h=[];this.home.getWalls().forEach(function(u){if(!d.isViewableAtLevel(u,b)){c.forEach(function(v){if(u.getLevel()===v){h.push(u)}})}});if(h.length>0){this.otherLevelsWallAreaCache=this.getItemsArea(h);this.otherLevelsWallsCache=h}}}if(this.otherLevelsWallsCache==null){this.otherLevelsWallsCache=[]}}if(this.otherLevelsRoomsCache.length!==0){var m=this.setTransparency(k,this.preferences.isGridVisible()?0.2:0.1);k.setPaint("#808080");k.fill(this.otherLevelsRoomAreaCache);k.setAlpha(m)}if(this.otherLevelsWallsCache.length!==0){var m=this.setTransparency(k,this.preferences.isGridVisible()?0.2:0.1);this.fillAndDrawWallsArea(k,this.otherLevelsWallAreaCache,q,this.getWallPaint(k,q,f,n,this.preferences.getNewWallPattern()),n,PlanComponent.PaintMode.PAINT);k.setAlpha(m)}}};PlanComponent.prototype.setTransparency=function(b,c){var a=b.getAlpha();b.setAlpha(c);return a};PlanComponent.prototype.paintGrid=function(b,g){var e=this.getGridSize(g);var h=this.getMainGridSize(g);var a=this.getPlanBounds();var c=a.getMinX()-PlanComponent.MARGIN;var j=a.getMinY()-PlanComponent.MARGIN;var f=this.convertXPixelToModel(Math.max(this.getWidth(),this.canvas.clientWidth));var d=this.convertYPixelToModel(Math.max(this.getHeight(),this.canvas.clientHeight));this.paintGridLines(b,g,c,f,j,d,e,h)};PlanComponent.prototype.paintGridLines=function(a,h,b,e,k,c,d,j){a.setColor(this.getGridColor());a.setStroke(new java.awt.BasicStroke(0.5/h));for(var g=((b/d)|0)*d;g<e;g+=d){a.draw(new java.awt.geom.Line2D.Double(g,k,g,c))}for(var f=((k/d)|0)*d;f<c;f+=d){a.draw(new java.awt.geom.Line2D.Double(b,f,e,f))}if(j!==d){a.setStroke(new java.awt.BasicStroke(1.5/h,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));for(var g=((b/j)|0)*j;g<e;g+=j){a.draw(new java.awt.geom.Line2D.Double(g,k,g,c))}for(var f=((k/j)|0)*j;f<c;f+=j){a.draw(new java.awt.geom.Line2D.Double(b,f,e,f))}}};PlanComponent.prototype.getGridColor=function(){if(this.gridColor==null){var a=ColorTools.styleToInteger(this.canvas.style.backgroundColor);var b=ColorTools.styleToInteger(this.canvas.style.color);var c=((((a&255)+(b&255)+(a&65280)+(b&65280)+(a&16711680)+(b&16711680))/6)|0)&255;this.gridColor=ColorTools.integerToHexadecimalString(c+(c<<8)+(c<<16))}return this.gridColor};PlanComponent.prototype.getMainGridSize=function(b){var e;var a=this.preferences.getLengthUnit();if(a.isMetric()){e=[100,200,500,1000,2000,5000,10000]}else{var f=2.54*12;e=[f,3*f,6*f,12*f,24*f,48*f,96*f,192*f,384*f]}var c=e[0];for(var d=1;d<e.length&&c*b<50;d++){c=e[d]}return c};PlanComponent.prototype.getGridSize=function(c){var e;var b=this.preferences.getLengthUnit();if(b.isMetric()){e=[1,2,5,10,20,50,100,200,500,1000,2000,5000,10000]}else{var f=2.54*12;e=[2.54,5.08,7.62,15.24,f,3*f,6*f,12*f,24*f,48*f,96*f,192*f,384*f]}var a=e[0];for(var d=1;d<e.length&&a*c<10;d++){a=e[d]}return a};PlanComponent.prototype.paintContent=function(a,b,e,h){var n=this.getBackgroundColor(h);var k=this.getForegroundColor(h);if(this.backgroundPainted){this.paintBackgroundImage(a,b,h);if(h===PlanComponent.PaintMode.PAINT){this.paintOtherLevels(a,b,e,n,k);if(this.preferences.isGridVisible()){this.paintGrid(a,e)}}}if(b==this.home.getSelectedLevel()){this.paintHomeItems(a,e,n,k,h)}else{this.paintHomeItems(a,b,e,n,k,h)}if(h===PlanComponent.PaintMode.PAINT){var d=this.home.getSelectedItems();var m=this.getSelectionColor();var f=this.getFurnitureOutlineColor();var o=ColorTools.toRGBAStyle(m,0.5);var c=new java.awt.BasicStroke(6/e,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var g=new java.awt.BasicStroke(4/e,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var l=new java.awt.BasicStroke(1/e,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_BEVEL,0,[20/e,5/e,5/e,5/e],4/e);this.paintCamera(a,d,o,c,m,e,n,k);if(this.alignedObjectClass!=null){if(Wall===this.alignedObjectClass){this.paintWallAlignmentFeedback(a,this.alignedObjectFeedback,b,this.locationFeeback,this.showPointFeedback,m,l,e,o,c)}else{if(Room===this.alignedObjectClass){this.paintRoomAlignmentFeedback(a,this.alignedObjectFeedback,b,this.locationFeeback,this.showPointFeedback,m,l,e,o,c)}else{if(Polyline===this.alignedObjectClass){if(this.showPointFeedback){this.paintPointFeedback(a,this.locationFeeback,m,e,o,c)}}else{if(DimensionLine===this.alignedObjectClass){this.paintDimensionLineAlignmentFeedback(a,this.alignedObjectFeedback,b,this.locationFeeback,this.showPointFeedback,m,l,e,o,c)}}}}}if(this.centerAngleFeedback!=null){this.paintAngleFeedback(a,this.centerAngleFeedback,this.point1AngleFeedback,this.point2AngleFeedback,e,m)}if(this.dimensionLinesFeedback!=null){var j=[];this.paintDimensionLines(a,this.dimensionLinesFeedback,j,b,null,null,null,l,e,n,m,h,true)}if(this.draggedItemsFeedback!=null){this.paintDimensionLines(a,Home.getDimensionLinesSubList(this.draggedItemsFeedback),this.draggedItemsFeedback,b,o,g,null,l,e,n,k,h,false);this.paintLabels(a,Home.getLabelsSubList(this.draggedItemsFeedback),this.draggedItemsFeedback,b,o,g,null,e,k,h);this.paintRoomsOutline(a,this.draggedItemsFeedback,b,o,c,null,e,k);this.paintWallsOutline(a,this.draggedItemsFeedback,b,o,c,null,e,k);this.paintFurniture(a,Home.getFurnitureSubList(this.draggedItemsFeedback),d,b,e,null,k,f,h,false);this.paintFurnitureOutline(a,this.draggedItemsFeedback,b,o,c,null,e,k)}this.paintRectangleFeedback(a,m,e)}};PlanComponent.prototype.paintHomeItems=function(a,b,e,m,h,g){if(g===undefined){g=h;h=m;m=e;e=b;b=this.home.getSelectedLevel()}var j=this;var d=this.home.getSelectedItems();if(this.sortedLevelFurniture==null){this.sortedLevelFurniture=[];this.home.getFurniture().forEach(function(o){if(j.isViewableAtLevel(o,b)){j.sortedLevelFurniture.push(o)}});CoreTools.sortArray(this.sortedLevelFurniture,{compare:function(p,o){return(p.getGroundElevation()-o.getGroundElevation())}})}var l=this.getSelectionColor();var n=ColorTools.toRGBAStyle(l,0.5);var c=new java.awt.BasicStroke(6/e,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var f=new java.awt.BasicStroke(4/e,java.awt.BasicStroke.CAP_ROUND,java.awt.BasicStroke.JOIN_ROUND);var k=new java.awt.BasicStroke(1/e,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_BEVEL,0,[20/e,5/e,5/e,5/e],4/e);this.paintCompass(a,d,e,h,g);this.paintRooms(a,d,b,e,h,g);this.paintWalls(a,d,b,e,m,h,g);this.paintFurniture(a,this.sortedLevelFurniture,d,b,e,m,h,this.getFurnitureOutlineColor(),g,true);this.paintPolylines(a,this.home.getPolylines(),d,b,n,l,e,h,g);this.paintDimensionLines(a,this.home.getDimensionLines(),d,b,n,f,l,k,e,m,h,g,false);this.paintRoomsNameAndArea(a,d,e,h,g);this.paintFurnitureName(a,this.sortedLevelFurniture,d,e,h,g);this.paintLabels(a,this.home.getLabels(),d,b,n,f,l,e,h,g);if(g===PlanComponent.PaintMode.PAINT&&this.selectedItemsOutlinePainted){this.paintCompassOutline(a,d,n,c,l,e,h);this.paintRoomsOutline(a,d,b,n,c,l,e,h);this.paintWallsOutline(a,d,b,n,c,l,e,h);this.paintFurnitureOutline(a,d,b,n,c,l,e,h)}};PlanComponent.prototype.getSelectionColor=function(){return PlanComponent.getDefaultSelectionColor(this)};PlanComponent.getDefaultSelectionColor=function(b){if(PlanComponent.DEFAULT_SELECTION_COLOR==null){var a=window.getComputedStyle(b.container,"::selection").backgroundColor;if(a.indexOf("rgb")===-1||ColorTools.isTransparent(a)||a==window.getComputedStyle(b.container).backgroundColor){b.container.style.color="Highlight";a=window.getComputedStyle(b.container).color}if(a.indexOf("rgb")===-1||ColorTools.isTransparent(a)||a==window.getComputedStyle(b.container).backgroundColor){PlanComponent.DEFAULT_SELECTION_COLOR="#0042E0"}else{PlanComponent.DEFAULT_SELECTION_COLOR=ColorTools.styleToHexadecimalString(a)}}return PlanComponent.DEFAULT_SELECTION_COLOR};PlanComponent.prototype.getFurnitureOutlineColor=function(){return ColorTools.toRGBAStyle(this.getForeground(),0.33)};PlanComponent.prototype.paintRooms=function(q,o,b,x,t,z){var c=this;if(this.sortedLevelRooms==null){this.sortedLevelRooms=[];this.home.getRooms().forEach(function(E){if(c.isViewableAtLevel(E,b)){c.sortedLevelRooms.push(E)}});CoreTools.sortArray(this.sortedLevelRooms,{compare:function(F,E){if(F.isFloorVisible()===E.isFloorVisible()&&F.isCeilingVisible()===E.isCeilingVisible()){return 0}else{if(!F.isFloorVisible()&&!F.isCeilingVisible()||F.isFloorVisible()&&E.isCeilingVisible()){return -1}else{return 1}}}})}var y=z===PlanComponent.PaintMode.PRINT?"#000000":"#808080";q.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Room,z)/x));for(var w=0;w<this.sortedLevelRooms.length;w++){var A=c.sortedLevelRooms[w];var D=o.indexOf(A)>=0;if(z!==PlanComponent.PaintMode.CLIPBOARD||D){q.setPaint(y);var f=0;var l=1;var j=1;var n=0;var m=0;var d=null;if(c.preferences.isRoomFloorColoredOrTextured()&&A.isFloorVisible()){if(A.getFloorColor()!=null){q.setPaint(ColorTools.integerToHexadecimalString(A.getFloorColor()))}else{d=A.getFloorTexture();if(d!=null){if(c.floorTextureImagesCache==null){c.floorTextureImagesCache={}}var B=c.floorTextureImagesCache[d.getImage().getURL()];if(B==null){B=PlanComponent.WAIT_TEXTURE_IMAGE;c.floorTextureImagesCache[d.getImage().getURL()]=B;var g=z!==PlanComponent.PaintMode.PAINT;TextureManager.getInstance().loadTexture(d.getImage(),g,{floorTexture:d,textureUpdated:function(E){c.floorTextureImagesCache[this.floorTexture.getImage().getURL()]=E;if(!g){c.repaint()}},textureError:function(){c.floorTextureImagesCache[this.floorTexture.getImage().getURL()]=PlanComponent.ERROR_TEXTURE_IMAGE},progression:function(){}})}if(A.getFloorTexture().isFittingArea()){var u=A.getBoundsMinimumCoordinates();var v=A.getBoundsMaximumCoordinates();l=(v[0]-u[0])/B.naturalWidth;j=(v[1]-u[1])/B.naturalHeight;n=u[0]/l;m=u[1]/j}else{var a=d.getWidth();var s=d.getHeight();if(a===-1||s===-1){a=100;s=100}var k=d.getScale();l=(a*k)/B.naturalWidth;j=(s*k)/B.naturalHeight;f=d.getAngle();var C=Math.cos(f);var e=Math.sin(f);n=(d.getXOffset()*B.naturalWidth*C-d.getYOffset()*B.height*e);m=(-d.getXOffset()*B.naturalWidth*e-d.getYOffset()*B.height*C)}q.setPaint(q.createPattern(B))}}}var r=c.setTransparency(q,A.isFloorVisible()?0.75:0.5);var p=null;if(d!=null){q.scale(l,j);q.rotate(f,0,0);q.translate(n,m);p=java.awt.geom.AffineTransform.getTranslateInstance(-n,-m);p.rotate(-f,0,0);p.scale(1/l,1/j)}var h=ShapeTools.getShape(A.getPoints(),true,p);c.fillShape(q,h,z);if(d!=null){q.translate(-n,-m);q.rotate(-f,0,0);q.scale(1/l,1/j);h=ShapeTools.getShape(A.getPoints(),true)}q.setAlpha(r);q.setPaint(t);q.draw(h)}}};PlanComponent.prototype.fillShape=function(b,a,c){b.fill(a)};PlanComponent.isTextureManagerAvailable=function(){return true};PlanComponent.prototype.paintRoomsNameAndArea=function(b,g,f,a,e){var d=this;b.setPaint(a);var c=b.getFont();this.sortedLevelRooms.forEach(function(n){var o=(g.indexOf(n)>=0);if(e!==PlanComponent.PaintMode.CLIPBOARD||o){var k=n.getXCenter();var m=n.getYCenter();var h=n.getName();if(h!=null){h=h.trim();if(h.length>0){d.paintText(b,n.constructor,h,n.getNameStyle(),null,k+n.getNameXOffset(),m+n.getNameYOffset(),n.getNameAngle(),c)}}if(n.isAreaVisible()){var l=n.getArea();if(l>0.01){var j=d.preferences.getLengthUnit().getAreaFormatWithUnit().format(l);d.paintText(b,n.constructor,j,n.getAreaStyle(),null,k+n.getAreaXOffset(),m+n.getAreaYOffset(),n.getAreaAngle(),c)}}}});b.setFont(c)};PlanComponent.prototype.paintText=function(k,o,j,r,u,g,f,s,m){var t=k.getTransform();k.translate(g,f);k.rotate(s);if(r==null){r=this.preferences.getDefaultTextStyle(o)}var d=this.getFontMetrics(m,r);var b=j.replace(/\n*$/,"").split("\n");var v=new Array(b.length);var c=-3.4028235e+38;for(var p=0;p<b.length;p++){v[p]=d.getStringBounds(b[p]).getWidth();c=Math.max(v[p],c)}var e=null;var l;if(u!=null){e=new java.awt.BasicStroke(r.getFontSize()*0.05);var a=r.deriveStyle$float(r.getFontSize()-e.getLineWidth());l=this.getFont(m,a);k.setStroke(e)}else{l=this.getFont(m,r)}k.setFont(l);for(var p=b.length-1;p>=0;p--){var h=b[p];var q=void 0;if(r.getAlignment()===TextStyle.Alignment.LEFT){q=0}else{if(r.getAlignment()===TextStyle.Alignment.RIGHT){q=-v[p]}else{q=-v[p]/2}}if(u!=null){q+=e.getLineWidth()/2}k.translate(q,0);if(u!=null){var n=k.getColor();k.setColor(ColorTools.integerToHexadecimalString(u));k.drawStringOutline(h,0,0);k.setColor(n)}k.drawString(h,0,0);k.translate(-q,-d.getHeight())}k.setTransform(t)};PlanComponent.prototype.paintRoomsOutline=function(b,l,c,o,e,n,j,m){var h=Home.getRoomsSubList(l);var d=b.getTransform();var g=1/j;for(var k=0;k<h.length;k++){var a=h[k];if(this.isViewableAtLevel(a,c)){b.setPaint(o);b.setStroke(e);b.draw(ShapeTools.getShape(a.getPoints(),true,null));if(n!=null){b.setPaint(n);a.getPoints().forEach(function(p){b.translate(p[0],p[1]);b.scale(g,g);b.setStroke(PlanComponent.POINT_STROKE);b.fill(PlanComponent.WALL_POINT);b.setTransform(d)})}}}b.setPaint(m);b.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Room,PlanComponent.PaintMode.PAINT)/j));for(var k=0;k<h.length;k++){var a=h[k];if(this.isViewableAtLevel(a,c)){b.draw(ShapeTools.getShape(a.getPoints(),true,null))}}if(l.length===1&&h.length===1&&n!=null){var f=h[0];if(this.isViewableAtLevel(a,c)){b.setPaint(n);this.paintPointsResizeIndicators(b,f,n,j,true,0,0,true);this.paintRoomNameOffsetIndicator(b,f,n,j);this.paintRoomAreaOffsetIndicator(b,f,n,j)}}};PlanComponent.prototype.paintPointsResizeIndicators=function(j,u,w,q,s,x,b,g){if(this.resizeIndicatorVisible){j.setPaint(w);j.setStroke(PlanComponent.INDICATOR_STROKE);var v=j.getTransform();var a=1/q;var o=u.getPoints();var c=this.getIndicator(u,PlanComponent.IndicatorType.RESIZE);for(var p=0;p<o.length;p++){var n=o[p];j.translate(n[0],n[1]);j.scale(a,a);var k=p===0?o[o.length-1]:o[p-1];var r=p===o.length-1?o[0]:o[p+1];var t=void 0;if(s||(p>0&&p<o.length-1)){var m=java.awt.geom.Point2D.distance(k[0],k[1],n[0],n[1]);var e=(n[1]-k[1])/m;var h=(k[0]-n[0])/m;var l=java.awt.geom.Point2D.distance(r[0],r[1],n[0],n[1]);var d=(r[1]-n[1])/l;var f=(n[0]-r[0])/l;t=Math.atan2(h+f,e+d);if(g&&u.containsPoint(n[0]+Math.cos(t),n[1]+Math.sin(t),0.001)||!g&&(e*f-h*d)<0){t+=Math.PI}}else{if(p===0){t=x}else{t=b}}j.rotate(t);j.draw(c);j.setTransform(v)}}};PlanComponent.prototype.getIndicator=function(b,a){if(PlanComponent.IndicatorType.RESIZE===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_RESIZE_INDICATOR}else{if(b instanceof Compass){return PlanComponent.COMPASS_RESIZE_INDICATOR}else{return PlanComponent.WALL_AND_LINE_RESIZE_INDICATOR}}}else{if(PlanComponent.IndicatorType.ROTATE===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_ROTATION_INDICATOR}else{if(b instanceof Compass){return PlanComponent.COMPASS_ROTATION_INDICATOR}else{if(b instanceof Camera){return PlanComponent.CAMERA_YAW_ROTATION_INDICATOR}else{if(b instanceof DimensionLine){return PlanComponent.DIMENSION_LINE_HEIGHT_ROTATION_INDICATOR}}}}}else{if(PlanComponent.IndicatorType.ELEVATE===a){if(b instanceof Camera){return PlanComponent.CAMERA_ELEVATION_INDICATOR}else{return PlanComponent.ELEVATION_INDICATOR}}else{if(PlanComponent.IndicatorType.RESIZE_HEIGHT===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_HEIGHT_INDICATOR}else{if(b instanceof DimensionLine){return PlanComponent.DIMENSION_LINE_HEIGHT_INDICATOR}}}else{if(PlanComponent.IndicatorType.CHANGE_POWER===a){if(b instanceof HomeLight){return PlanComponent.LIGHT_POWER_INDICATOR}}else{if(PlanComponent.IndicatorType.MOVE_TEXT===a){return PlanComponent.TEXT_LOCATION_INDICATOR}else{if(PlanComponent.IndicatorType.ROTATE_TEXT===a){return PlanComponent.TEXT_ANGLE_INDICATOR}else{if(PlanComponent.IndicatorType.ROTATE_PITCH===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_PITCH_ROTATION_INDICATOR}else{if(b instanceof Camera){return PlanComponent.CAMERA_PITCH_ROTATION_INDICATOR}}}else{if(PlanComponent.IndicatorType.ROTATE_ROLL===a){if(b instanceof HomePieceOfFurniture){return PlanComponent.FURNITURE_ROLL_ROTATION_INDICATOR}}else{if(PlanComponent.IndicatorType.ARC_EXTENT===a){if(b instanceof Wall){return PlanComponent.WALL_ARC_EXTENT_INDICATOR}}}}}}}}}}}return null};PlanComponent.prototype.paintRoomNameOffsetIndicator=function(c,f,b,e){if(this.resizeIndicatorVisible&&f.getName()!=null&&f.getName().trim().length>0){var d=f.getXCenter()+f.getNameXOffset();var a=f.getYCenter()+f.getNameYOffset();this.paintTextIndicators(c,f,this.getLineCount(f.getName()),f.getNameStyle(),d,a,f.getNameAngle(),b,e)}};PlanComponent.prototype.paintRoomAreaOffsetIndicator=function(c,f,a,e){if(this.resizeIndicatorVisible&&f.isAreaVisible()&&f.getArea()>0.01){var d=f.getXCenter()+f.getAreaXOffset();var b=f.getYCenter()+f.getAreaYOffset();this.paintTextIndicators(c,f,1,f.getAreaStyle(),d,b,f.getAreaAngle(),a,e)}};PlanComponent.prototype.paintTextIndicators=function(b,m,l,c,k,h,e,j,g){if(this.resizeIndicatorVisible){b.setPaint(j);b.setStroke(PlanComponent.INDICATOR_STROKE);var d=b.getTransform();var f=1/g;b.translate(k,h);b.rotate(e);b.scale(f,f);if(m instanceof Label){b.draw(PlanComponent.LABEL_CENTER_INDICATOR)}else{b.draw(this.getIndicator(null,PlanComponent.IndicatorType.MOVE_TEXT))}if(c==null){c=this.preferences.getDefaultTextStyle(m)}var a=this.getFontMetrics(b.getFont(),c);b.setTransform(d);b.translate(k,h);b.rotate(e);b.translate(0,-a.getHeight()*(l-1)-a.getAscent()*(m instanceof Label?1:0.85));b.scale(f,f);b.draw(this.getIndicator(null,PlanComponent.IndicatorType.ROTATE_TEXT));b.setTransform(d)}};PlanComponent.prototype.getLineCount=function(c){var a=1;var b=c.length-1;while(b>=0&&c.charAt(b)=="\n"){b--}for(;b>=0;b--){if(c.charAt(b)=="\n"){a++}}return a};PlanComponent.prototype.paintWalls=function(a,f,c,g,o,n,m){var d;var l;if(m!==PlanComponent.PaintMode.CLIPBOARD){l=this.getWallAreasAtLevel(c)}else{d=Home.getWallsSubList(f);l=this.getWallAreas(this.getDrawableWallsAtLevel(d,c))}var k=m===PlanComponent.PaintMode.PRINT?g/72*150:g;var b=null;if(m===PlanComponent.PaintMode.PAINT&&this.backgroundPainted&&this.backgroundImageCache!=null&&this.wallsDoorsOrWindowsModification){b=this.setTransparency(a,0.5)}var p=l.entries==null?[]:l.entries;for(var h=0;h<p.length;h++){var j=p[h];var e=j.getKey()[0].getPattern();this.fillAndDrawWallsArea(a,j.getValue(),g,this.getWallPaint(a,k,o,n,e!=null?e:this.preferences.getWallPattern()),n,m)}if(b!=null){a.setAlpha(b)}};PlanComponent.prototype.fillAndDrawWallsArea=function(b,d,g,c,e,f){b.setPaint(c);var a=1/g;b.scale(a,a);var h=d.clone();h.transform(java.awt.geom.AffineTransform.getScaleInstance(1/a,1/a));this.fillShape(b,h,f);b.scale(1/a,1/a);b.setPaint(e);b.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Wall,f)/g));b.draw(d)};PlanComponent.prototype.paintWallsOutline=function(m,o,a,n,j,x,u,r){var b=1/u;var y=Home.getWallsSubList(o);var w=m.getTransform();for(var t=0;t<y.length;t++){var v=y[t];if(this.isViewableAtLevel(v,a)){m.setPaint(n);m.setStroke(j);m.draw(ShapeTools.getShape(v.getPoints(),true,null));if(x!=null){m.translate(v.getXStart(),v.getYStart());m.scale(b,b);m.setPaint(x);m.setStroke(PlanComponent.POINT_STROKE);m.fill(PlanComponent.WALL_POINT);var s=v.getArcExtent();var c=void 0;var g=void 0;var e=0;var l=0;var q=0;var d=v.getStartPointToEndPointDistance();var k=Math.atan2(v.getYEnd()-v.getYStart(),v.getXEnd()-v.getXStart());if(s!=null&&s!==0){e=v.getXArcCircleCenter();l=v.getYArcCircleCenter();q=java.awt.geom.Point2D.distance(v.getXStart(),v.getYStart(),e,l);g=q*Math.abs(s)*u;c=Math.atan2(l-v.getYStart(),e-v.getXStart())+(s>0?-Math.PI/2:Math.PI/2)}else{g=d*u;c=k}if(g<30){m.rotate(k);if(s!=null){var p=Math.abs(s)>Math.PI?-(Math.PI+s)/2:(Math.PI-s)/2;var h=(Math.tan(p)*d/2);m.translate(d*u/2,(h-q*(Math.abs(k)>Math.PI/2?-1:1))*u)}else{m.translate(g/2,0)}}else{m.rotate(c);m.translate(8,0)}m.draw(PlanComponent.WALL_ORIENTATION_INDICATOR);m.setTransform(w);m.translate(v.getXEnd(),v.getYEnd());m.scale(b,b);m.fill(PlanComponent.WALL_POINT);if(g>=30){if(s!=null){c+=s}m.rotate(c);m.translate(-10,0);m.draw(PlanComponent.WALL_ORIENTATION_INDICATOR)}m.setTransform(w)}}}m.setPaint(r);m.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(Wall,PlanComponent.PaintMode.PAINT)/u));var f=CoreTools.valuesFromMap(this.getWallAreas(this.getDrawableWallsAtLevel(y,a)));for(var t=0;t<f.length;t++){m.draw(f[t])}if(o.length===1&&y.length===1&&x!=null){var v=y[0];if(this.isViewableAtLevel(v,a)){this.paintWallResizeIndicators(m,v,x,u)}}};PlanComponent.prototype.isViewableAtLevel=function(b,c){var a=b.getLevel();return a==null||(a.isViewable()&&b.isAtLevel(c))};PlanComponent.prototype.isViewableAtSelectedLevel=function(a){return this.isViewableAtLevel(a,this.home.getSelectedLevel())};PlanComponent.prototype.paintWallResizeIndicators=function(a,j,h,f){if(this.resizeIndicatorVisible){a.setPaint(h);a.setStroke(PlanComponent.INDICATOR_STROKE);var b=a.getTransform();var e=1/f;var l=j.getPoints();var d=(l.length/4|0);var k=Math.atan2(j.getYEnd()-j.getYStart(),j.getXEnd()-j.getXStart());if(l.length%4===0){a.translate((l[d-1][0]+l[d][0])/2,(l[d-1][1]+l[d][1])/2)}else{a.translate(l[d][0],l[d][1])}a.scale(e,e);a.rotate(k+Math.PI);a.draw(this.getIndicator(j,PlanComponent.IndicatorType.ARC_EXTENT));a.setTransform(b);var c=j.getArcExtent();var g=void 0;if(c!=null&&c!==0){g=Math.atan2(j.getYArcCircleCenter()-j.getYEnd(),j.getXArcCircleCenter()-j.getXEnd())+(c>0?-Math.PI/2:Math.PI/2)}else{g=k}a.translate(j.getXEnd(),j.getYEnd());a.scale(e,e);a.rotate(g);a.draw(this.getIndicator(j,PlanComponent.IndicatorType.RESIZE));a.setTransform(b);if(c!=null){g+=Math.PI-c}else{g+=Math.PI}a.translate(j.getXStart(),j.getYStart());a.scale(e,e);a.rotate(g);a.draw(this.getIndicator(j,PlanComponent.IndicatorType.RESIZE));a.setTransform(b)}};PlanComponent.prototype.getWallAreasAtLevel=function(a){if(this.wallAreasCache==null){this.wallAreasCache=this.getWallAreas(this.getDrawableWallsAtLevel(this.home.getWalls(),a))}return this.wallAreasCache};PlanComponent.prototype.getDrawableWallsAtLevel=function(c,e){var b=[];for(var d=0;d<c.length;d++){var a=c[d];if(this.isViewableAtLevel(a,e)){b.push(a)}}return b};PlanComponent.prototype.getWallAreas=function(c){var h=this;if(c.length===0){return{}}var f=c[0].getPattern();var b=true;for(var d=0;d<c.length;d++){if(f!==c[d].getPattern()){b=false;break}}var a={};if(b){CoreTools.putToMap(a,c,this.getItemsArea(c))}else{var g={};c.forEach(function(j){var k=j.getPattern();if(k==null){k=h.preferences.getWallPattern()}var l=CoreTools.getFromMap(g,k);if(l==null){l=[];CoreTools.putToMap(g,k,l)}l.push(j)});var c=CoreTools.valuesFromMap(g);for(var d=0;d<c.length;d++){var e=c[d];CoreTools.putToMap(a,e,this.getItemsArea(e))}}return a};PlanComponent.prototype.getItemsArea=function(a){var b=new java.awt.geom.Area();a.forEach(function(c){b.add(new java.awt.geom.Area(ShapeTools.getShape(c.getPoints(),true,null)))});return b};PlanComponent.prototype.makePatternImage=function(e,j,l){var d=document.createElement("canvas");d.width=e.naturalWidth;d.height=e.naturalHeight;var c=d.getContext("2d");c.fillStyle="#FFFFFF";c.fillRect(0,0,d.width,d.height);c.drawImage(e,0,0);var a=c.getImageData(0,0,e.naturalWidth,e.height).data;var k=ColorTools.hexadecimalStringToInteger(l);var b=ColorTools.hexadecimalStringToInteger(j);var g=c.createImageData(e.naturalWidth,e.height);for(var f=0;f<a.length;f+=4){g.data[f+3]=255;if(a[f]===255&&a[f+1]===255&&a[f+2]===255){g.data[f]=(k&16711680)>>16;g.data[f+1]=(k&65280)>>8;g.data[f+2]=k&255}else{if(a[f]===0&&a[f+1]===0&&a[f+2]===0){g.data[f]=(b&16711680)>>16;g.data[f+1]=(b&65280)>>8;g.data[f+2]=b&255}else{var h=1-(a[f]+a[f+1]+a[f+2])/3/255;g.data[f]=Math.min(255,((b&16711680)>>16)*h+((k&16711680)>>16)*(1-h));g.data[f+1]=Math.min(255,((b&65280)>>8)*h+((k&65280)>>8)*(1-h));g.data[f+2]=Math.min(255,(b&255)*h+(k&255)*(1-h))}}}c.putImageData(g,0,0);e.src=d.toDataURL();return e};PlanComponent.prototype.getWallPaint=function(d,f,c,b,a){var e=this;var g=this.patternImagesCache[a.getImage().getURL()];if(g==null||c!=this.wallsPatternBackgroundCache||b!=this.wallsPatternForegroundCache){g=TextureManager.getInstance().getWaitImage();this.patternImagesCache[a.getImage().getURL()]=g;TextureManager.getInstance().loadTexture(a.getImage(),false,{textureUpdated:function(h){e.patternImagesCache[a.getImage().getURL()]=e.makePatternImage(h,e.getForeground(),e.getBackground());e.repaint()},textureError:function(){e.patternImagesCache[a.getImage().getURL()]=PlanComponent.ERROR_TEXTURE_IMAGE},progression:function(){}});this.wallsPatternBackgroundCache=c;this.wallsPatternForegroundCache=b}return d.createPattern(g)};PlanComponent.prototype.paintFurniture=function(m,n,l,b,u,j,r,h,v,f){if(!(n.length==0)){var q=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,v)/u);var d=null;for(var t=0;t<n.length;t++){var e=n[t];if(e.isVisible()){var a=(l.indexOf((e))>=0);if(e instanceof HomeFurnitureGroup){var k=(e).getFurniture();var s=[];this.paintFurniture(m,k,a?k:s,b,u,j,r,h,v,f)}else{if(v!==PlanComponent.PaintMode.CLIPBOARD||a){var c=ShapeTools.getShape(e.getPoints(),true,null);var o=void 0;if(e instanceof HomeDoorOrWindow){var p=e;o=this.getDoorOrWindowWallPartShape(p);if(this.draggedItemsFeedback==null||!(this.draggedItemsFeedback.indexOf((e))>=0)){this.paintDoorOrWindowWallThicknessArea(m,p,u,j,r,v)}this.paintDoorOrWindowSashes(m,p,u,r,v)}else{o=c}var g=void 0;if(this.preferences.isFurnitureViewedFromTop()){if(e.getPlanIcon()!=null||(e instanceof HomeDoorOrWindow)){g=true}else{d=PlanComponent.WEBGL_AVAILABLE;g=d}}else{g=false}if(f&&g){if(e instanceof HomeDoorOrWindow){m.setPaint(j);m.fill(o);m.setPaint(r);m.setStroke(q);m.draw(o)}else{this.paintPieceOfFurnitureTop(m,e,o,q,u,j,r,v)}if(v===PlanComponent.PaintMode.PAINT){m.setStroke(q);m.setPaint(h);m.draw(c)}}else{if(f){this.paintPieceOfFurnitureIcon(m,e,null,o,u,j,v)}m.setPaint(r);m.setStroke(q);m.draw(o);if((e instanceof HomeDoorOrWindow)&&v===PlanComponent.PaintMode.PAINT){m.setPaint(h);m.draw(c)}}}}}}}};PlanComponent.prototype.getDoorOrWindowWallPartShape=function(a){var e=this.getDoorOrWindowRectangle(a,true);var b=java.awt.geom.AffineTransform.getRotateInstance(a.getAngle(),a.getX(),a.getY());var c=e.getPathIterator(b);var d=new java.awt.geom.GeneralPath();d.append(c,false);return d};PlanComponent.prototype.getDoorOrWindowRectangle=function(l,f){var d=l.getDepth()*(f?l.getWallThickness():1);var k=l.getDepth()*(f?l.getWallDistance():0);var e=l.getCutOutShape();var b=l.getWidth();var h=l.getWallWidth()*b;var j=l.getX()-b/2;j+=l.isModelMirrored()?(1-l.getWallLeft()-l.getWallWidth())*b:l.getWallLeft()*b;if(e!=null&&PieceOfFurniture.DEFAULT_CUT_OUT_SHAPE!=e){var g=ShapeTools.getShape(e);var a=g.getBounds2D();if(l.isModelMirrored()){j+=(1-a.getX()-a.getWidth())*h}else{j+=a.getX()*h}h*=a.getWidth()}var c=new java.awt.geom.Rectangle2D.Float(j,l.getY()-l.getDepth()/2+k,h,d);return c};PlanComponent.prototype.paintDoorOrWindowWallThicknessArea=function(j,l,p,d,m,s){if(l.isWallCutOutOnBothSides()){var h=null;if(this.doorOrWindowWallThicknessAreasCache!=null){h=CoreTools.getFromMap(this.doorOrWindowWallThicknessAreasCache,l)}if(h==null){var c=this.getDoorOrWindowRectangle(l,false);var n=java.awt.geom.AffineTransform.getRotateInstance(l.getAngle(),l.getX(),l.getY());var e=c.getPathIterator(n);var g=new java.awt.geom.GeneralPath();g.append(e,false);var b=new java.awt.geom.Area(g);h=new java.awt.geom.Area();var t=this.home.getWalls();for(var o=0;o<t.length;o++){var r=t[o];if(r.isAtLevel(l.getLevel())&&l.isParallelToWall(r)){var q=ShapeTools.getShape(r.getPoints(),true,null);var a=new java.awt.geom.Area(q);a.intersect(b);if(!a.isEmpty()){var f=new java.awt.geom.Rectangle2D.Float(c.getX(),c.getY()-2*r.getThickness(),c.getWidth(),c.getWidth()+4*r.getThickness());e=f.getPathIterator(n);var k=new java.awt.geom.GeneralPath();k.append(e,false);a=new java.awt.geom.Area(q);a.intersect(new java.awt.geom.Area(k));h.add(a)}}}}if(this.doorOrWindowWallThicknessAreasCache==null){this.doorOrWindowWallThicknessAreasCache={}}CoreTools.putToMap(this.doorOrWindowWallThicknessAreasCache,l,h);j.setPaint(d);j.fill(h);j.setPaint(m);j.setStroke(new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,s)/p));j.draw(h)}};PlanComponent.prototype.paintDoorOrWindowSashes=function(e,b,h,a,g){var f=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,g)/h);e.setPaint(a);e.setStroke(f);var c=b.getSashes();for(var d=0;d<c.length;d++){e.draw(this.getDoorOrWindowSashShape(b,c[d]))}};PlanComponent.prototype.getDoorOrWindowSashShape=function(l,g){var h=l.isModelMirrored()?-1:1;var c=h*g.getXAxis()*l.getWidth();var a=g.getYAxis()*l.getDepth();var f=g.getWidth()*l.getWidth();var j=g.getStartAngle()*180/Math.PI;if(l.isModelMirrored()){j=180-j}var d=h*((g.getEndAngle()-g.getStartAngle())*180/Math.PI);var b=new java.awt.geom.Arc2D.Float(c-f,a-f,2*f,2*f,j,d,java.awt.geom.Arc2D.PIE);var k=java.awt.geom.AffineTransform.getTranslateInstance(l.getX(),l.getY());k.rotate(l.getAngle());k.translate(h*-l.getWidth()/2,-l.getDepth()/2);var e=b.getPathIterator(k);var m=new java.awt.geom.GeneralPath();m.append(e,false);return m};PlanComponent.prototype.paintFurnitureName=function(a,h,d,e,j,g){var k=a.getFont();a.setPaint(j);for(var f=0;f<h.length;f++){var n=h[f];if(n.isVisible()){var l=(d.indexOf((n))>=0);if(n instanceof HomeFurnitureGroup){var c=(n).getFurniture();var m=[];this.paintFurnitureName(a,c,l?c:m,e,j,g)}if(n.isNameVisible()&&(g!==PlanComponent.PaintMode.CLIPBOARD||l)){var b=n.getName().trim();if(b.length>0){this.paintText(a,n.constructor,b,n.getNameStyle(),null,n.getX()+n.getNameXOffset(),n.getY()+n.getNameYOffset(),n.getNameAngle(),k)}}}}a.setFont(k)};PlanComponent.prototype.paintFurnitureOutline=function(l,q,a,o,k,w,u,s){var b=this;var r=new java.awt.BasicStroke(this.getStrokeWidth(HomePieceOfFurniture,PlanComponent.PaintMode.PAINT)/u);var f=new java.awt.BasicStroke(4*this.getStrokeWidth(HomePieceOfFurniture,PlanComponent.PaintMode.PAINT)/u,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER);var m=Home.getFurnitureSubList(q);var p=[];var z=null;var g=new java.awt.BasicStroke(15/u,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.JOIN_ROUND);var v=null;var x=null;var j=this.home.getFurniture();for(var t=0;t<m.length;t++){var d=m[t];if(d.isVisible()&&this.isViewableAtLevel(d,a)){var c=this.getPieceOfFurnitureInHomeFurniture(d,j);if(c!==d){var h=null;if(v!==c){var y=ShapeTools.getShape(c.getPoints(),true,null);h=new java.awt.geom.Area(y);h.add(new java.awt.geom.Area(g.createStrokedShape(y)))}var e=new java.awt.geom.Area(ShapeTools.getShape(d.getPoints(),true,null));if(z==null){z=h;x=e}else{if(v!==c){z.add(h)}x.add(e)}v=c}p.push(d)}}if(z!=null){z.subtract(x);var n=this.setTransparency(l,0.6);l.setPaint(o);l.fill(z);l.setAlpha(n)}p.forEach(function(C){var B=C.getPoints();var A=ShapeTools.getShape(B,true,null);l.setPaint(o);l.setStroke(k);l.draw(A);l.setPaint(s);l.setStroke(r);l.draw(A);l.setStroke(f);l.draw(new java.awt.geom.Line2D.Float(B[2][0],B[2][1],B[3][0],B[3][1]));if(q.length===1&&w!=null){b.paintPieceOfFurnitureIndicators(l,C,w,u)}})};PlanComponent.prototype.getPieceOfFurnitureInHomeFurniture=function(c,a){if(!(a.indexOf((c))>=0)){for(var b=0;b<a.length;b++){var d=a[b];if((d instanceof HomeFurnitureGroup)&&((d).getAllFurniture().indexOf((c))>=0)){return d}}}return c};PlanComponent.prototype.paintPieceOfFurnitureIcon=function(b,o,k,n,f,l){var j=this;if(k==null){if(this.furnitureIconsCache==null){this.furnitureIconsCache={}}var e=this.furnitureIconsCache[o.icon.getURL()];if(e==null){e=TextureManager.getInstance().getWaitImage();TextureManager.getInstance().loadTexture(o.icon,{textureUpdated:function(p){j.furnitureIconsCache[o.icon.getURL()]=p;j.repaint()},textureError:function(){j.furnitureIconsCache[o.icon.getURL()]=TextureManager.getInstance().getErrorImage();j.repaint()}})}k=new PlanComponent.PieceOfFurnitureTopViewIcon(e)}b.setPaint(l);b.fill(n);var h=b.getClip();b.clip(n);var c=b.getTransform();var a=n.getBounds2D();b.translate(a.getCenterX(),a.getCenterY());var d=o.getDepthInPlan();if(o instanceof HomeDoorOrWindow){d*=o.getWallThickness()}var m=Math.min(o.getWidthInPlan(),d);var g=Math.min(1/f,m/k.getIconHeight());if(o.isModelMirrored()){b.scale(-g,g)}else{b.scale(g,g)}k.paintIcon(b,-k.getIconWidth()/2|0,-k.getIconHeight()/2|0);b.setTransform(c);b.setClip(h)};PlanComponent.prototype.paintPieceOfFurnitureTop=function(b,q,p,f,h,n,l,k){if(this.furnitureTopViewIconKeys==null){this.furnitureTopViewIconKeys={};this.furnitureTopViewIconsCache={}}var g=CoreTools.getFromMap(this.furnitureTopViewIconKeys,q);var m;if(g==null){g=new PlanComponent.HomePieceOfFurnitureTopViewIconKey(q.clone());m=CoreTools.getFromMap(this.furnitureTopViewIconsCache,g);if(m==null||m.isWaitIcon()&&k!==PlanComponent.PaintMode.PAINT){var e=k===PlanComponent.PaintMode.PAINT?this:null;if(q.getPlanIcon()!=null){m=new PlanComponent.PieceOfFurniturePlanIcon(q,e)}else{m=new PlanComponent.PieceOfFurnitureModelIcon(q,this.object3dFactory,e,this.preferences.getFurnitureModelIconSize())}CoreTools.putToMap(this.furnitureTopViewIconsCache,g,m)}else{for(var j=0;j<this.furnitureTopViewIconsCache.entries.length;j++){var o=this.furnitureTopViewIconsCache.entries[j].key;if(o.equals(g)){g=o;break}}}CoreTools.putToMap(this.furnitureTopViewIconKeys,q,g)}else{m=CoreTools.getFromMap(this.furnitureTopViewIconsCache,g)}if(m.isWaitIcon()||m.isErrorIcon()){this.paintPieceOfFurnitureIcon(b,q,m,p,h,n);b.setPaint(l);b.setStroke(f);b.draw(p)}else{var c=b.getTransform();var a=p.getBounds2D();b.translate(a.getCenterX(),a.getCenterY());b.rotate(q.getAngle());var d=q.getDepthInPlan();if(q.isModelMirrored()&&q.getRoll()==0){b.scale(-q.getWidthInPlan()/m.getIconWidth(),d/m.getIconHeight())}else{b.scale(q.getWidthInPlan()/m.getIconWidth(),d/m.getIconHeight())}m.paintIcon(b,(-m.getIconWidth()/2|0),(-m.getIconHeight()/2|0));b.setTransform(c)}};PlanComponent.prototype.paintPieceOfFurnitureIndicators=function(a,r,n,j){if(this.resizeIndicatorVisible){a.setPaint(n);a.setStroke(PlanComponent.INDICATOR_STROKE);var d=a.getTransform();var k=r.getPoints();var h=1/j;var b=r.getAngle();var g=this.getIndicator(r,PlanComponent.IndicatorType.ROTATE);if(g!=null){a.translate(k[0][0],k[0][1]);a.scale(h,h);a.rotate(b);a.draw(g);a.setTransform(d)}var e=this.getIndicator(r,PlanComponent.IndicatorType.ELEVATE);if(e!=null){a.translate(k[1][0],k[1][1]);a.scale(h,h);a.rotate(b);a.draw(PlanComponent.ELEVATION_POINT_INDICATOR);a.translate(6.5,-6.5);a.rotate(-b);a.draw(e);a.setTransform(d)}a.translate(k[3][0],k[3][1]);a.scale(h,h);a.rotate(b);if(r.getPitch()!==0&&this.isFurnitureSizeInPlanSupported()){var m=this.getIndicator(r,PlanComponent.IndicatorType.ROTATE_PITCH);if(m!=null){a.draw(m)}}else{if(r.getRoll()!==0&&this.isFurnitureSizeInPlanSupported()){var o=this.getIndicator(r,PlanComponent.IndicatorType.ROTATE_ROLL);if(o!=null){a.draw(o)}}else{if(r instanceof HomeLight){var l=this.getIndicator(r,PlanComponent.IndicatorType.CHANGE_POWER);if(l!=null){a.draw(PlanComponent.LIGHT_POWER_POINT_INDICATOR);a.translate(-7.5,7.5);a.rotate(-b);a.draw(l)}}else{if(r.isResizable()&&!r.isHorizontallyRotated()){var f=this.getIndicator(r,PlanComponent.IndicatorType.RESIZE_HEIGHT);if(f!=null){a.draw(PlanComponent.HEIGHT_POINT_INDICATOR);a.translate(-7.5,7.5);a.rotate(-b);a.draw(f)}}}}}a.setTransform(d);if(r.isResizable()){var c=this.getIndicator(r,PlanComponent.IndicatorType.RESIZE);if(c!=null){a.translate(k[2][0],k[2][1]);a.scale(h,h);a.rotate(b);a.draw(c);a.setTransform(d)}}if(r.isNameVisible()&&r.getName().trim().length>0){var q=r.getX()+r.getNameXOffset();var p=r.getY()+r.getNameYOffset();this.paintTextIndicators(a,r,this.getLineCount(r.getName()),r.getNameStyle(),q,p,r.getNameAngle(),n,j)}}};PlanComponent.prototype.paintPolylines=function(p,k,m,e,q,y,v,t,w){for(var u=0;u<k.length;u++){var r=k[u];if(this.isViewableAtLevel(r,e)){var s=(m.indexOf((r))>=0);if(w!==PlanComponent.PaintMode.CLIPBOARD||s){p.setPaint(ColorTools.integerToHexadecimalString(r.getColor()));var d=r.getThickness();p.setStroke(ShapeTools.getStroke(d,r.getCapStyle(),r.getJoinStyle(),r.getDashStyle()!==Polyline.DashStyle.SOLID?r.getDashPattern():null,r.getDashOffset()));var g=ShapeTools.getPolylineShape(r.getPoints(),r.getJoinStyle()===Polyline.JoinStyle.CURVED,r.isClosedPath());p.draw(g);var o=null;var n=null;var c=null;var h=null;for(var l=g.getPathIterator(null,0.5);!l.isDone();l.next()){var b=[0,0];if(l.currentSegment(b)!==java.awt.geom.PathIterator.SEG_CLOSE){if(o==null){o=b}else{if(n==null){n=b}}c=h;h=b}}var x=Math.atan2(o[1]-n[1],o[0]-n[0]);var j=Math.atan2(h[1]-c[1],h[0]-c[0]);var f=r.getCapStyle()!==Polyline.CapStyle.BUTT?d/2:0;this.paintArrow(p,o,x,r.getStartArrowStyle(),d,f);this.paintArrow(p,h,j,r.getEndArrowStyle(),d,f);if(s&&w===PlanComponent.PaintMode.PAINT){p.setPaint(q);p.setStroke(ShapeTools.getStroke(d+4/v,r.getCapStyle(),r.getJoinStyle(),null));p.draw(g);if(m.length===1&&y!=null){var a=m[0];if(this.isViewableAtLevel(r,e)){p.setPaint(y);this.paintPointsResizeIndicators(p,a,y,v,a.isClosedPath(),x,j,false)}}}}}}};PlanComponent.prototype.paintArrow=function(d,a,g,b,c,e){if(b!=null&&b!==Polyline.ArrowStyle.NONE){var h=d.getTransform();d.translate(a[0],a[1]);d.rotate(g);d.translate(e,0);var f=Math.pow(c,0.66)*2;d.scale(f,f);switch((b)){case Polyline.ArrowStyle.DISC:d.fill(new java.awt.geom.Ellipse2D.Float(-3.5,-2,4,4));break;case Polyline.ArrowStyle.OPEN:d.scale(0.9,0.9);d.setStroke(new java.awt.BasicStroke((c/f/0.9),java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_MITER));d.draw(PlanComponent.ARROW);break;case Polyline.ArrowStyle.DELTA:d.translate(1.65,0);d.fill(PlanComponent.ARROW);break;default:break}d.setTransform(h)}};PlanComponent.prototype.paintDimensionLines=function(v,o,q,a,y,t,G,c,C,g,z,E,e){var d=this;if(E===PlanComponent.PaintMode.CLIPBOARD){o=Home.getDimensionLinesSubList(q)}var b=PlanComponent.DIMENSION_LINE_MARK_END.getBounds2D().getWidth();var n=q.length==1&&q[0] instanceof DimensionLine&&E===PlanComponent.PaintMode.PAINT&&G!=null?q[0]:null;var u=v.getFont();for(var B=0;B<o.length;B++){var j=o[B];if(d.isViewableAtLevel(j,a)){var I=j.getColor();var m=j.getEndMarkSize()/b;var p=new java.awt.BasicStroke(d.getStrokeWidth(DimensionLine,E)/m/C);v.setPaint(I!=null?ColorTools.integerToHexadecimalString(I):z);var F=v.getTransform();var s=j.isElevationDimensionLine();var D=s?(j.getPitch()+2*Math.PI)%(2*Math.PI):Math.atan2(j.getYEnd()-j.getYStart(),j.getXEnd()-j.getXStart());var l=j.getOffset();var h=j.getLength();v.translate(j.getXStart(),j.getYStart());v.rotate(D);v.translate(0,l);var H=j.getElevationStart()==j.getElevationEnd();if(E===PlanComponent.PaintMode.PAINT&&d.selectedItemsOutlinePainted&&(q.indexOf((j))>=0)){v.setPaint(y);v.setStroke(t);if(H){v.draw(new java.awt.geom.Line2D.Float(0,0,h,0));v.scale(m,m);v.draw(PlanComponent.DIMENSION_LINE_MARK_END);v.translate(h/m,0);v.draw(PlanComponent.DIMENSION_LINE_MARK_END);v.scale(1/m,1/m);v.translate(-h,0);v.draw(new java.awt.geom.Line2D.Float(0,-l,0,0));v.draw(new java.awt.geom.Line2D.Float(h,-l,h,0))}else{v.scale(m,m);v.draw(PlanComponent.VERTICAL_DIMENSION_LINE);v.scale(1/m,1/m);if(Math.abs(l)>j.getEndMarkSize()/2){v.draw(new java.awt.geom.Line2D.Float(0,-l,0,-j.getEndMarkSize()/2*(l>=0?(l==0?0:1):-1)))}}v.setPaint(I!=null?ColorTools.integerToHexadecimalString(I):z)}v.setStroke(p);if(H){v.draw(new java.awt.geom.Line2D.Float(0,0,h,0));v.scale(m,m);v.draw(PlanComponent.DIMENSION_LINE_MARK_END);v.translate(h/m,0);v.draw(PlanComponent.DIMENSION_LINE_MARK_END);v.scale(1/m,1/m);v.translate(-h,0);v.setStroke(c);v.draw(new java.awt.geom.Line2D.Float(0,-l,0,0));v.draw(new java.awt.geom.Line2D.Float(h,-l,h,0))}else{v.scale(m,m);v.fill(PlanComponent.VERTICAL_DIMENSION_LINE_DISC);v.draw(PlanComponent.VERTICAL_DIMENSION_LINE);v.scale(1/m,1/m);v.setStroke(c);if(Math.abs(l)>j.getEndMarkSize()/2){v.draw(new java.awt.geom.Line2D.Float(0,-l,0,-j.getEndMarkSize()/2*(l>=0?(l==0?0:1):-1)))}}if(H||j===n){var f=d.preferences.getLengthUnit().getFormat().format(h);var A=j.getLengthStyle();if(A==null){A=d.preferences.getDefaultTextStyle(j.constructor)}if(e&&d.getFont()!=null||!H&&j==n){A=A.deriveStyle$float(parseInt(new Font(d.getFont()).size)/C)}var w=d.getFont(u,A);var k=d.getFontMetrics(w,A);var r=k.getStringBounds(f,v);v.setFont(w);if(!H&&j===n){v.rotate(D>Math.PI?Math.PI/2:-Math.PI/2);v.translate(l<=0^D<=Math.PI?-r.getWidth()-b/2-5/C:b/2+5/C,k.getAscent()/2);if(s&&this.resizeIndicatorVisible){v.translate((l<=0^D<=Math.PI?-1:1)*10/C,0)}}else{v.translate((h-r.getWidth())/2,l<=0?-k.getDescent()-1:k.getAscent()+1)}if(e||!H&&j===n){v.setColor(g);var x=d.setTransparency(v,0.7);v.setStroke(new java.awt.BasicStroke(4/C,java.awt.BasicStroke.CAP_SQUARE,java.awt.BasicStroke.CAP_ROUND));v.drawStringOutline(f,0,0);v.setAlpha(x);v.setColor(z);if(!e){v.setPaint(G)}}v.setFont(w);v.drawString(f,0,0)}v.setTransform(F)}}v.setFont(u);if(n!=null){this.paintDimensionLineResizeIndicators(v,n,G,C)}};PlanComponent.prototype.paintDimensionLineResizeIndicators=function(a,k,j,g){if(this.resizeIndicatorVisible){a.setPaint(j);a.setStroke(PlanComponent.INDICATOR_STROKE);var d=k.isElevationDimensionLine()?k.getPitch():Math.atan2(k.getYEnd()-k.getYStart(),k.getXEnd()-k.getXStart());var h=k.getElevationStart()===k.getElevationEnd();var c=a.getTransform();var f=1/g;var b=this.getIndicator(k,PlanComponent.IndicatorType.RESIZE);if(h){a.translate(k.getXStart(),k.getYStart());a.rotate(d);a.translate(0,k.getOffset());a.rotate(Math.PI);a.scale(f,f);a.draw(b);a.setTransform(c);a.translate(k.getXEnd(),k.getYEnd());a.rotate(d);a.translate(0,k.getOffset());a.scale(f,f);a.draw(b);a.setTransform(c);a.translate((k.getXStart()+k.getXEnd())/2,(k.getYStart()+k.getYEnd())/2)}else{a.translate(k.getXStart(),k.getYStart())}a.rotate(d);var e=a.getTransform();a.translate(0,k.getOffset()-(h?0:k.getEndMarkSize()/2*(k.getOffset()>0?1:-1)));a.rotate(k.getOffset()<=0?Math.PI/2:-Math.PI/2);a.scale(f,f);a.draw(b);if(!h){if(k.isElevationDimensionLine()){a.setTransform(e);a.translate(0,k.getOffset()+k.getEndMarkSize()/2*(k.getOffset()>0?1:-1));a.rotate(k.getOffset()<=0?Math.PI/2:-Math.PI/2);a.scale(f,f);a.draw(this.getIndicator(k,PlanComponent.IndicatorType.ROTATE))}a.setTransform(e);a.translate(-k.getEndMarkSize()/2,k.getOffset());a.scale(f,f);a.draw(PlanComponent.ELEVATION_POINT_INDICATOR);a.translate(-9,0);a.rotate(-d);a.draw(this.getIndicator(k,PlanComponent.IndicatorType.ELEVATE));a.setTransform(e);a.translate(5,k.getOffset());a.scale(f,f);a.draw(PlanComponent.HEIGHT_POINT_INDICATOR);a.translate(10,0);a.rotate(-d);a.draw(this.getIndicator(k,PlanComponent.IndicatorType.RESIZE_HEIGHT))}a.setTransform(c)}};PlanComponent.prototype.paintLabels=function(n,x,j,b,o,k,y,u,q,v){var l=n.getFont();for(var t=0;t<x.length;t++){var g=x[t];if(this.isViewableAtLevel(g,b)){var e=(j.indexOf((g))>=0);if(v!==PlanComponent.PaintMode.CLIPBOARD||e){var f=g.getText();var h=g.getX();var m=g.getY();var c=g.getAngle();var a=g.getStyle();if(a==null){a=this.preferences.getDefaultTextStyle(g.constructor)}if(a.getFontName()==null&&this.getFont()!=null){a=a.deriveStyle(new Font(this.getFont()).family)}var r=g.getColor();n.setPaint(r!=null?ColorTools.integerToHexadecimalString(r):q);this.paintText(n,g.constructor,f,a,g.getOutlineColor(),h,m,c,l);if(v===PlanComponent.PaintMode.PAINT&&this.selectedItemsOutlinePainted&&e){n.setPaint(o);n.setStroke(k);var s=this.getTextBounds(f,a,h,m,c);n.draw(ShapeTools.getShape(s,true,null));n.setPaint(q);if(y!=null&&j.length===1&&j[0]===g){this.paintTextIndicators(n,g,this.getLineCount(f),a,h,m,c,y,u);if(this.resizeIndicatorVisible&&g.getPitch()!=null){var p=this.getIndicator(g,PlanComponent.IndicatorType.ELEVATE);if(p!=null){var w=n.getTransform();if(a.getAlignment()===TextStyle.Alignment.LEFT){n.translate(s[3][0],s[3][1])}else{if(a.getAlignment()===TextStyle.Alignment.RIGHT){n.translate(s[2][0],s[2][1])}else{n.translate((s[2][0]+s[3][0])/2,(s[2][1]+s[3][1])/2)}}var d=1/u;n.scale(d,d);n.rotate(g.getAngle());n.draw(PlanComponent.ELEVATION_POINT_INDICATOR);n.translate(0,10);n.rotate(-g.getAngle());n.draw(p);n.setTransform(w)}}}}}}}n.setFont(l)};PlanComponent.prototype.paintCompass=function(b,h,f,a,e){var d=this.home.getCompass();if(d.isVisible()&&(e!==PlanComponent.PaintMode.CLIPBOARD||h.indexOf(d)>=0)){var g=b.getTransform();b.translate(d.getX(),d.getY());b.rotate(d.getNorthDirection());var c=d.getDiameter();b.scale(c,c);b.setColor(a);b.fill(PlanComponent.COMPASS);b.setTransform(g)}};PlanComponent.prototype.paintCompassOutline=function(a,f,k,d,h,e,g){var c=this.home.getCompass();if((f.indexOf(c)>=0)&&c.isVisible()){var b=a.getTransform();a.translate(c.getX(),c.getY());a.rotate(c.getNorthDirection());var j=c.getDiameter();a.scale(j,j);a.setPaint(k);a.setStroke(new java.awt.BasicStroke((5.5+e)/j/e));a.draw(PlanComponent.COMPASS_DISC);a.setColor(g);a.setStroke(new java.awt.BasicStroke(1/j/e));a.draw(PlanComponent.COMPASS_DISC);a.setTransform(b);if(f.length===1&&f[0]===c){a.setPaint(h);this.paintCompassIndicators(a,c,h,e)}}};PlanComponent.prototype.paintCompassIndicators=function(c,d,a,e){if(this.resizeIndicatorVisible){c.setPaint(a);c.setStroke(PlanComponent.INDICATOR_STROKE);var f=c.getTransform();var b=d.getPoints();var g=1/e;c.translate((b[2][0]+b[3][0])/2,(b[2][1]+b[3][1])/2);c.scale(g,g);c.rotate(d.getNorthDirection());c.draw(this.getIndicator(d,PlanComponent.IndicatorType.ROTATE));c.setTransform(f);c.translate((b[1][0]+b[2][0])/2,(b[1][1]+b[2][1])/2);c.scale(g,g);c.rotate(d.getNorthDirection());c.draw(this.getIndicator(d,PlanComponent.IndicatorType.RESIZE));c.setTransform(f)}};PlanComponent.prototype.paintWallAlignmentFeedback=function(a,f,b,p,q,d,c,j,k,e){var n=this;if(p!=null){var h=0.5/j;var o=p.getX();var m=p.getY();var l=Infinity;var g=Infinity;this.getViewedItems(this.home.getWalls(),b,this.otherLevelsWallsCache).forEach(function(s){if(s!==f){if(Math.abs(o-s.getXStart())<h&&(f==null||!n.equalsWallPoint(s.getXStart(),s.getYStart(),f))){if(Math.abs(g)>Math.abs(m-s.getYStart())){g=m-s.getYStart()}}else{if(Math.abs(o-s.getXEnd())<h&&(f==null||!n.equalsWallPoint(s.getXEnd(),s.getYEnd(),f))){if(Math.abs(g)>Math.abs(m-s.getYEnd())){g=m-s.getYEnd()}}}if(Math.abs(m-s.getYStart())<h&&(f==null||!n.equalsWallPoint(s.getXStart(),s.getYStart(),f))){if(Math.abs(l)>Math.abs(o-s.getXStart())){l=o-s.getXStart()}}else{if(Math.abs(m-s.getYEnd())<h&&(f==null||!n.equalsWallPoint(s.getXEnd(),s.getYEnd(),f))){if(Math.abs(l)>Math.abs(o-s.getXEnd())){l=o-s.getXEnd()}}}var t=s.getPoints();t=[t[0],t[(t.length/2|0)-1],t[(t.length/2|0)],t[t.length-1]];for(var u=0;u<t.length;u++){if(Math.abs(o-t[u][0])<h&&(f==null||!n.equalsWallPoint(t[u][0],t[u][1],f))){if(Math.abs(g)>Math.abs(m-t[u][1])){g=m-t[u][1]}}if(Math.abs(m-t[u][1])<h&&(f==null||!n.equalsWallPoint(t[u][0],t[u][1],f))){if(Math.abs(l)>Math.abs(o-t[u][0])){l=o-t[u][0]}}}}});a.setPaint(d);a.setStroke(c);var r=this.pointerType===View.PointerType.TOUCH?PlanComponent.ALIGNMENT_LINE_OFFSET*2:PlanComponent.ALIGNMENT_LINE_OFFSET;if(l!==Infinity){if(l>0){a.draw(new java.awt.geom.Line2D.Float(o+r/j,m,o-l-r/j,m))}else{a.draw(new java.awt.geom.Line2D.Float(o-r/j,m,o-l+r/j,m))}}if(g!==Infinity){if(g>0){a.draw(new java.awt.geom.Line2D.Float(o,m+r/j,o,m-g-r/j))}else{a.draw(new java.awt.geom.Line2D.Float(o,m-r/j,o,m-g+r/j))}}if(q){this.paintPointFeedback(a,p,d,j,k,e)}}};PlanComponent.prototype.getViewedItems=function(e,f,c){var b=[];if(c!=null){b.push.apply(b,c)}for(var d=0;d<e.length;d++){var a=e[d];if(this.isViewableAtLevel(a,f)){b.push(a)}}return b};PlanComponent.prototype.paintPointFeedback=function(f,e,c,h,b,d){f.setPaint(b);f.setStroke(d);var a=this.pointerType===View.PointerType.TOUCH?20:10;var g=new java.awt.geom.Ellipse2D.Float(e.getX()-a/h,e.getY()-a/h,2*a/h,2*a/h);f.fill(g);f.setPaint(c);f.setStroke(new java.awt.BasicStroke(1/h));f.draw(g);f.draw(new java.awt.geom.Line2D.Float(e.getX(),e.getY()-a/h,e.getX(),e.getY()+a/h));f.draw(new java.awt.geom.Line2D.Float(e.getX()-a/h,e.getY(),e.getX()+a/h,e.getY()))};PlanComponent.prototype.equalsWallPoint=function(b,c,a){return b===a.getXStart()&&c===a.getYStart()||b===a.getXEnd()&&c===a.getYEnd()};PlanComponent.prototype.paintRoomAlignmentFeedback=function(a,h,b,o,p,d,c,g,l,e){if(o!=null){var f=0.5/g;var n=o.getX();var m=o.getY();var j=Infinity;var k=Infinity;this.getViewedItems(this.home.getRooms(),b,this.otherLevelsRoomsCache).forEach(function(u){var r=u.getPoints();var t=-1;if(u===h){for(var s=0;s<r.length;s++){if(r[s][0]===n&&r[s][1]===m){t=s;break}}}for(var s=0;s<r.length;s++){if(t===-1||(s!==t&&r.length>2)){if(Math.abs(n-r[s][0])<f&&Math.abs(k)>Math.abs(m-r[s][1])){k=m-r[s][1]}if(Math.abs(m-r[s][1])<f&&Math.abs(j)>Math.abs(n-r[s][0])){j=n-r[s][0]}}}});this.getViewedItems(this.home.getWalls(),b,this.otherLevelsWallsCache).forEach(function(r){var s=r.getPoints();s=[s[0],s[(s.length/2|0)-1],s[(s.length/2|0)],s[s.length-1]];for(var t=0;t<s.length;t++){if(Math.abs(n-s[t][0])<f&&Math.abs(k)>Math.abs(m-s[t][1])){k=m-s[t][1]}if(Math.abs(m-s[t][1])<f&&Math.abs(j)>Math.abs(n-s[t][0])){j=n-s[t][0]}}});a.setPaint(d);a.setStroke(c);var q=this.pointerType===View.PointerType.TOUCH?PlanComponent.ALIGNMENT_LINE_OFFSET*2:PlanComponent.ALIGNMENT_LINE_OFFSET;if(j!==Infinity){if(j>0){a.draw(new java.awt.geom.Line2D.Float(n+q/g,m,n-j-q/g,m))}else{a.draw(new java.awt.geom.Line2D.Float(n-q/g,m,n-j+q/g,m))}}if(k!==Infinity){if(k>0){a.draw(new java.awt.geom.Line2D.Float(n,m+q/g,n,m-k-q/g))}else{a.draw(new java.awt.geom.Line2D.Float(n,m-q/g,n,m-k+q/g))}}if(p){this.paintPointFeedback(a,o,d,g,l,e)}}};PlanComponent.prototype.paintDimensionLineAlignmentFeedback=function(a,q,b,o,p,d,c,g,k,e){var m=this;if(o!=null){var f=0.5/g;var n=o.getX();var l=o.getY();var h=Infinity;var j=Infinity;this.getViewedItems(this.home.getRooms(),b,this.otherLevelsRoomsCache).forEach(function(u){var s=u.getPoints();for(var t=0;t<s.length;t++){if(Math.abs(n-s[t][0])<f&&Math.abs(j)>Math.abs(l-s[t][1])){j=l-s[t][1]}if(Math.abs(l-s[t][1])<f&&Math.abs(h)>Math.abs(n-s[t][0])){h=n-s[t][0]}}});this.home.getDimensionLines().forEach(function(s){if(m.isViewableAtLevel(s,b)&&s!==q){if(Math.abs(n-s.getXStart())<f&&(q==null||!m.equalsDimensionLinePoint(s.getXStart(),s.getYStart(),q))){if(Math.abs(j)>Math.abs(l-s.getYStart())){j=l-s.getYStart()}}else{if(Math.abs(n-s.getXEnd())<f&&(q==null||!m.equalsDimensionLinePoint(s.getXEnd(),s.getYEnd(),q))){if(Math.abs(j)>Math.abs(l-s.getYEnd())){j=l-s.getYEnd()}}}if(Math.abs(l-s.getYStart())<f&&(q==null||!m.equalsDimensionLinePoint(s.getXStart(),s.getYStart(),q))){if(Math.abs(h)>Math.abs(n-s.getXStart())){h=n-s.getXStart()}}else{if(Math.abs(l-s.getYEnd())<f&&(q==null||!m.equalsDimensionLinePoint(s.getXEnd(),s.getYEnd(),q))){if(Math.abs(h)>Math.abs(n-s.getXEnd())){h=n-s.getXEnd()}}}}});this.getViewedItems(this.home.getWalls(),b,this.otherLevelsWallsCache).forEach(function(s){var t=s.getPoints();t=[t[0],t[(t.length/2|0)-1],t[(t.length/2|0)],t[t.length-1]];for(var u=0;u<t.length;u++){if(Math.abs(n-t[u][0])<f&&Math.abs(j)>Math.abs(l-t[u][1])){j=l-t[u][1]}if(Math.abs(l-t[u][1])<f&&Math.abs(h)>Math.abs(n-t[u][0])){h=n-t[u][0]}}});this.home.getFurniture().forEach(function(u){if(u.isVisible()&&m.isViewableAtLevel(u,b)){var s=u.getPoints();for(var t=0;t<s.length;t++){if(Math.abs(n-s[t][0])<f&&Math.abs(j)>Math.abs(l-s[t][1])){j=l-s[t][1]}if(Math.abs(l-s[t][1])<f&&Math.abs(h)>Math.abs(n-s[t][0])){h=n-s[t][0]}}}});a.setPaint(d);a.setStroke(c);var r=this.pointerType===View.PointerType.TOUCH?PlanComponent.ALIGNMENT_LINE_OFFSET*2:PlanComponent.ALIGNMENT_LINE_OFFSET;if(h!==Infinity){if(h>0){a.draw(new java.awt.geom.Line2D.Float(n+r/g,l,n-h-r/g,l))}else{a.draw(new java.awt.geom.Line2D.Float(n-r/g,l,n-h+r/g,l))}}if(j!==Infinity){if(j>0){a.draw(new java.awt.geom.Line2D.Float(n,l+r/g,n,l-j-r/g))}else{a.draw(new java.awt.geom.Line2D.Float(n,l-r/g,n,l-j+r/g))}}if(p){this.paintPointFeedback(a,o,d,g,k,e)}}};PlanComponent.prototype.equalsDimensionLinePoint=function(b,c,a){return b===a.getXStart()&&c===a.getYStart()||b===a.getXEnd()&&c===a.getYEnd()};PlanComponent.prototype.paintAngleFeedback=function(a,b,j,h,d,k){if(!j.equals(b)&&!h.equals(b)){a.setColor(k);a.setStroke(new java.awt.BasicStroke(1/d));var g=Math.atan2(b.getY()-j.getY(),j.getX()-b.getX());if(g<0){g=2*Math.PI+g}var e=Math.atan2(b.getY()-h.getY(),h.getX()-b.getX());if(e<0){e=2*Math.PI+e}var l=e-g;if(g>e){l=2*Math.PI+l}var c=a.getTransform();a.translate(b.getX(),b.getY());var f=20/d;a.draw(new java.awt.geom.Arc2D.Double(-f,-f,f*2,f*2,g*180/Math.PI,l*180/Math.PI,java.awt.geom.Arc2D.OPEN));f+=5/d;a.draw(new java.awt.geom.Line2D.Double(0,0,f*Math.cos(g),-f*Math.sin(g)));a.draw(new java.awt.geom.Line2D.Double(0,0,f*Math.cos(g+l),-f*Math.sin(g+l)));a.setTransform(c)}};PlanComponent.prototype.paintCamera=function(n,l,o,m,z,t,f,q){var s=this.home.getObserverCamera();if(s===this.home.getCamera()){var x=n.getTransform();n.translate(s.getX(),s.getY());n.rotate(s.getYaw());var r=s.getPoints();var e=java.awt.geom.Point2D.distance(r[0][0],r[0][1],r[3][0],r[3][1]);var A=java.awt.geom.Point2D.distance(r[0][0],r[0][1],r[1][0],r[1][1]);var w=java.awt.geom.AffineTransform.getScaleInstance(A,e);var k=s.getPlanScale();var b=new java.awt.geom.Area(k<=1?PlanComponent.CAMERA_HUMAN_BODY:PlanComponent.CAMERA_BODY).createTransformedArea(w);var v=new java.awt.geom.Area(k<=1?PlanComponent.CAMERA_HUMAN_HEAD:PlanComponent.CAMERA_BUTTON).createTransformedArea(w);n.setPaint(f);n.fill(b);n.setPaint(q);var h=new java.awt.BasicStroke(this.getStrokeWidth(ObserverCamera,PlanComponent.PaintMode.PAINT)/t);n.setStroke(h);n.draw(b);if(l.indexOf(s)>=0&&this.selectedItemsOutlinePainted){n.setPaint(o);n.setStroke(m);var d=new java.awt.geom.Area(b);d.add(new java.awt.geom.Area(v));n.draw(d)}n.setPaint(f);n.fill(v);n.setPaint(q);n.setStroke(h);n.draw(v);var a=Math.sin(s.getFieldOfView()/2);var c=Math.cos(s.getFieldOfView()/2);var p=(0.9*e*a);var u=(0.9*e*c);var y=(2.2*e*a);var j=(2.2*e*c);var g=new java.awt.geom.GeneralPath();g.moveTo(p,u);g.lineTo(y,j);g.moveTo(-p,u);g.lineTo(-y,j);n.draw(g);n.setTransform(x);if(l.length===1&&l[0]===s){this.paintCameraRotationIndicators(n,s,z,t)}}};PlanComponent.prototype.paintCameraRotationIndicators=function(b,c,a,f){if(this.resizeIndicatorVisible){b.setPaint(a);b.setStroke(PlanComponent.INDICATOR_STROKE);var g=b.getTransform();var d=c.getPoints();var h=1/f;b.translate((d[0][0]+d[3][0])/2,(d[0][1]+d[3][1])/2);b.scale(h,h);b.rotate(c.getYaw());b.draw(this.getIndicator(c,PlanComponent.IndicatorType.ROTATE));b.setTransform(g);b.translate((d[1][0]+d[2][0])/2,(d[1][1]+d[2][1])/2);b.scale(h,h);b.rotate(c.getYaw());b.draw(this.getIndicator(c,PlanComponent.IndicatorType.ROTATE_PITCH));b.setTransform(g);var e=this.getIndicator(c,PlanComponent.IndicatorType.ELEVATE);if(e!=null){b.translate((d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2);b.scale(h,h);b.draw(PlanComponent.POINT_INDICATOR);b.translate(Math.sin(c.getYaw())*8,-Math.cos(c.getYaw())*8);b.draw(e);b.setTransform(g)}}};PlanComponent.prototype.paintRectangleFeedback=function(a,c,b){if(this.rectangleFeedback!=null){a.setPaint(ColorTools.toRGBAStyle(c,0.125));a.fill(this.rectangleFeedback);a.setPaint(c);a.setStroke(new java.awt.BasicStroke(1/b));a.draw(this.rectangleFeedback)}};PlanComponent.prototype.setRectangleFeedback=function(b,d,a,c){this.rectangleFeedback=new java.awt.geom.Rectangle2D.Float(b,d,0,0);this.rectangleFeedback.add(a,c);this.repaint()};PlanComponent.prototype.makeSelectionVisible=function(){if(this.isScrolled()&&!this.selectionScrollUpdated){this.selectionScrollUpdated=true;var a=this;setTimeout(function(){a.selectionScrollUpdated=false;var c=a.getSelectionBounds(true);if(c!=null){var d=a.getShapePixelBounds(c);d=new java.awt.geom.Rectangle2D.Float(d.getX()-5,d.getY()-5,d.getWidth()+10,d.getHeight()+10);var b=new java.awt.geom.Rectangle2D.Float(0,0,a.scrollPane.clientWidth,a.scrollPane.clientHeight);if(!d.intersects(b)){a.scrollRectToVisible(d)}}})}};PlanComponent.prototype.scrollRectToVisible=function(c){if(this.isScrolled()){var b=0;var a=0;if(c.x<0){b=c.x}else{if(c.getX()+c.getWidth()>this.scrollPane.clientWidth){b=c.getX()+c.getWidth()-this.scrollPane.clientWidth}}if(c.y<0){a=c.y}else{if(c.getY()+c.getHeight()>this.scrollPane.clientHeight){a=c.getY()+c.getHeight()-this.scrollPane.clientHeight}}this.moveView(this.convertPixelToLength(b),this.convertPixelToLength(a))}};PlanComponent.prototype.getSelectionBounds=function(c){var b=this.getGraphics();if(b!=null){this.setRenderingHints(b)}if(c){return this.getItemsBounds(b,this.home.getSelectedItems())}else{var d=this.home.getSelectedItems().slice(0);var a=d.indexOf(this.home.getCamera());if(a>=0){d.splice(a,1)}return this.getItemsBounds(b,d)}};PlanComponent.prototype.makePointVisible=function(a,b){this.scrollRectToVisible(this.getShapePixelBounds(new java.awt.geom.Rectangle2D.Float(a,b,this.getPixelLength(),this.getPixelLength())))};PlanComponent.prototype.moveView=function(b,a){if(this.isScrolled()&&(b!=0||a!=0)){this.scrollPane.scrollLeft+=this.convertLengthToPixel(b);this.scrollPane.scrollTop+=this.convertLengthToPixel(a);this.repaint()}};PlanComponent.prototype.getScale=function(){return this.scale};PlanComponent.prototype.setScale=function(e){if(this.scale!==e){var b=0;var c=0;if(this.isScrolled()){b=this.convertXPixelToModel(this.scrollPane.clientWidth/2);c=this.convertYPixelToModel(this.scrollPane.clientHeight/2)}this.scale=e;this.revalidate();if(this.isScrolled()&&!isNaN(b)){var d=this.convertPixelToLength(this.scrollPane.clientWidth);var a=this.convertPixelToLength(this.scrollPane.clientHeight);this.scrollPane.scrollLeft+=this.convertXModelToPixel(b-d/2);this.scrollPane.scrollTop+=this.convertYModelToPixel(c-a/2)}}};PlanComponent.prototype.convertXPixelToModel=function(a){var b=this.getInsets();var c=this.getPlanBounds();return this.convertPixelToLength(a-b.left+(this.isScrolled()?this.scrollPane.scrollLeft:0))-PlanComponent.MARGIN+c.getMinX()};PlanComponent.prototype.convertYPixelToModel=function(c){var a=this.getInsets();var b=this.getPlanBounds();return this.convertPixelToLength(c-a.top+(this.isScrolled()?this.scrollPane.scrollTop:0))-PlanComponent.MARGIN+b.getMinY()};PlanComponent.prototype.convertPixelToLength=function(a){return a*this.getPixelLength()};PlanComponent.prototype.convertXModelToPixel=function(a){var b=this.getInsets();var c=this.getPlanBounds();return this.convertLengthToPixel(a-c.getMinX()+PlanComponent.MARGIN)+b.left-(this.isScrolled()?this.scrollPane.scrollLeft:0)};PlanComponent.prototype.convertYModelToPixel=function(c){var a=this.getInsets();var b=this.getPlanBounds();return this.convertLengthToPixel(c-b.getMinY()+PlanComponent.MARGIN)+a.top-(this.isScrolled()?this.scrollPane.scrollTop:0)};PlanComponent.prototype.convertLengthToPixel=function(a){return Math.round(a/this.getPixelLength())};PlanComponent.prototype.convertXModelToScreen=function(a){return this.canvas.getBoundingClientRect().left+this.convertXModelToPixel(a)};PlanComponent.prototype.convertYModelToScreen=function(a){return this.canvas.getBoundingClientRect().top+this.convertYModelToPixel(a)};PlanComponent.prototype.getPixelLength=function(){return 1/this.getScale()};PlanComponent.prototype.getShapePixelBounds=function(b){var a=b.getBounds2D();return new java.awt.geom.Rectangle2D.Float(this.convertXModelToPixel(a.getMinX()),this.convertYModelToPixel(a.getMinY()),this.convertLengthToPixel(a.getWidth()),this.convertLengthToPixel(a.getHeight()))};PlanComponent.prototype.setCursor=function(a){if(typeof a==="string"){this.canvas.style.cursor=a}else{switch(a){case PlanView.CursorType.ROTATION:case PlanView.CursorType.HEIGHT:case PlanView.CursorType.POWER:case PlanView.CursorType.ELEVATION:case PlanView.CursorType.RESIZE:if(this.mouseListener.longTouch!=null){clearTimeout(this.mouseListener.longTouch);this.mouseListener.longTouch=null;this.stopLongTouchAnimation()}case PlanView.CursorType.MOVE:if(this.lastTouchX&&this.lastTouchY){this.startIndicatorAnimation(this.lastTouchX,this.lastTouchY,PlanView.CursorType[a].toLowerCase())}break}switch(a){case PlanView.CursorType.DRAW:this.setCursor("crosshair");break;case PlanView.CursorType.ROTATION:this.setCursor(this.rotationCursor);break;case PlanView.CursorType.HEIGHT:this.setCursor(this.heightCursor);break;case PlanView.CursorType.POWER:this.setCursor(this.powerCursor);break;case PlanView.CursorType.ELEVATION:this.setCursor(this.elevationCursor);break;case PlanView.CursorType.RESIZE:this.setCursor(this.resizeCursor);break;case PlanView.CursorType.PANNING:this.setCursor(this.panningCursor);break;case PlanView.CursorType.DUPLICATION:this.setCursor(this.duplicationCursor);break;case PlanView.CursorType.MOVE:this.setCursor(this.moveCursor);break;case PlanView.CursorType.SELECTION:default:this.setCursor("default");break}}};PlanComponent.prototype.setToolTipFeedback=function(c,b,g){this.tooltip.style.width="";this.tooltip.style.marginLeft="";if(c.indexOf("<html>")===0){this.tooltip.style.textAlign="left"}else{this.tooltip.style.textAlign="center"}this.tooltip.innerHTML=c.replace("<html>","").replace("</html>","");var e=-(this.tooltip.clientHeight+(this.pointerType===View.PointerType.TOUCH?55:20));this.tooltip.style.marginTop=(e-(this.pointerType===View.PointerType.TOUCH&&this.touchOverlay.style.visibility=="visible"?15:0))+"px";var d=this.tooltip.clientWidth+10;this.tooltip.style.width=d+"px";this.tooltip.style.marginLeft=-d/2+"px";var a=this.container.getBoundingClientRect();this.tooltip.style.left=Math.max(5+d/2,Math.min(window.innerWidth-d/2-10,a.left+this.convertXModelToPixel(b)))+"px";var f=a.top+this.convertYModelToPixel(g);this.tooltip.style.top=(f+e>15?f:f-e+(this.pointerType===View.PointerType.TOUCH?100:20))+"px";this.tooltip.style.visibility="visible"};PlanComponent.prototype.setToolTipEditedProperties=function(c,b,a,d){};PlanComponent.prototype.deleteToolTipFeedback=function(){this.tooltip.style.visibility="hidden";this.tooltip.style.width="";this.tooltip.style.marginLeft="";this.tooltip.style.marginTop=""};PlanComponent.prototype.setResizeIndicatorVisible=function(a){this.resizeIndicatorVisible=a;this.repaint()};PlanComponent.prototype.setAlignmentFeedback=function(b,c,a,e,d){this.alignedObjectClass=b;this.alignedObjectFeedback=c;this.locationFeeback=new java.awt.geom.Point2D.Float(a,e);this.showPointFeedback=d;this.repaint()};PlanComponent.prototype.setAngleFeedback=function(e,f,b,d,a,c){this.centerAngleFeedback=new java.awt.geom.Point2D.Float(e,f);this.point1AngleFeedback=new java.awt.geom.Point2D.Float(b,d);this.point2AngleFeedback=new java.awt.geom.Point2D.Float(a,c)};PlanComponent.prototype.setDraggedItemsFeedback=function(a){this.draggedItemsFeedback=a;this.repaint()};PlanComponent.prototype.setDimensionLinesFeedback=function(a){this.dimensionLinesFeedback=a;this.repaint()};PlanComponent.prototype.deleteFeedback=function(){this.deleteToolTipFeedback();this.rectangleFeedback=null;this.alignedObjectClass=null;this.alignedObjectFeedback=null;this.locationFeeback=null;this.centerAngleFeedback=null;this.point1AngleFeedback=null;this.point2AngleFeedback=null;this.draggedItemsFeedback=null;this.dimensionLinesFeedback=null;this.repaint()};PlanComponent.prototype.canImportDraggedItems=function(b,a,c){return true};PlanComponent.prototype.getPieceOfFurnitureSizeInPlan=function(a){if(a.getRoll()===0&&a.getPitch()===0){return[a.getWidth(),a.getDepth(),a.getHeight()]}else{if(!this.isFurnitureSizeInPlanSupported()){return null}else{return PlanComponent.PieceOfFurnitureModelIcon.computePieceOfFurnitureSizeInPlan(a,this.object3dFactory)}}};PlanComponent.prototype.isFurnitureSizeInPlanSupported=function(){return PlanComponent.WEBGL_AVAILABLE};PlanComponent.prototype.dispose=function(){this.container.removeEventListener("keydown",this.keyDownListener,false);this.container.removeEventListener("keyup",this.keyUpListener,false);this.container.removeEventListener("focusout",this.focusOutListener);if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){window.removeEventListener("pointermove",this.mouseListener.windowPointerMoved);window.removeEventListener("pointerup",this.mouseListener.windowPointerReleased)}else{window.removeEventListener("mousemove",this.mouseListener.windowMouseMoved);window.removeEventListener("mouseup",this.mouseListener.windowMouseReleased)}document.body.removeChild(this.touchOverlay);document.body.removeChild(this.tooltip);window.removeEventListener("resize",this.windowResizeListener);if(this.scrollPane!=null){this.container.removeChild(this.canvas);this.container.removeChild(this.scrollPane)}this.preferences.removePropertyChangeListener("UNIT",this.preferencesListener);this.preferences.removePropertyChangeListener("LANGUAGE",this.preferencesListener);this.preferences.removePropertyChangeListener("GRID_VISIBLE",this.preferencesListener);this.preferences.removePropertyChangeListener("DEFAULT_FONT_NAME",this.preferencesListener);this.preferences.removePropertyChangeListener("FURNITURE_VIEWED_FROM_TOP",this.preferencesListener);this.preferences.removePropertyChangeListener("FURNITURE_MODEL_ICON_SIZE",this.preferencesListener);this.preferences.removePropertyChangeListener("ROOM_FLOOR_COLORED_OR_TEXTURED",this.preferencesListener);this.preferences.removePropertyChangeListener("WALL_PATTERN",this.preferencesListener)};PlanComponent.prototype.getHorizontalRuler=function(){throw new UnsupportedOperationException("No rulers")};PlanComponent.prototype.getVerticalRuler=function(){throw new UnsupportedOperationException("No rulers")};PlanComponent.PieceOfFurnitureTopViewIcon=function(a){this.image=a};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.getIconWidth=function(){return this.image.naturalWidth};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.getIconHeight=function(){return this.image.naturalHeight};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.paintIcon=function(b,a,c){b.drawImage(this.image,a,c)};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.isWaitIcon=function(){return this.image===TextureManager.getInstance().getWaitImage()};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.isErrorIcon=function(){return this.image===TextureManager.getInstance().getErrorImage()};PlanComponent.PieceOfFurnitureTopViewIcon.prototype.setIcon=function(a){this.image=a};PlanComponent.PieceOfFurniturePlanIcon=function(c,a){PlanComponent.PieceOfFurnitureTopViewIcon.call(this,TextureManager.getInstance().getWaitImage());var b=this;TextureManager.getInstance().loadTexture(c.getPlanIcon(),false,{textureUpdated:function(d){b.setIcon(d);a.repaint()},textureError:function(d){b.setIcon(TextureManager.getInstance().getErrorImage());a.repaint()}})};PlanComponent.PieceOfFurniturePlanIcon.prototype=Object.create(PlanComponent.PieceOfFurnitureTopViewIcon.prototype);PlanComponent.PieceOfFurniturePlanIcon.prototype.constructor=PlanComponent.PieceOfFurniturePlanIcon;PlanComponent.PieceOfFurnitureModelIcon=function(e,b,d,a){PlanComponent.PieceOfFurnitureTopViewIcon.call(this,TextureManager.getInstance().getWaitImage());var c=this;ModelManager.getInstance().loadModel(e.getModel(),d===null,{modelUpdated:function(l){var g=e.clone();if(g.isResizable()&&e.getRoll()==0){g.setModelMirrored(false)}var j=g.getWidthInPlan();var f=g.getDepthInPlan();var h=g.getHeightInPlan();g.setX(0);g.setY(0);g.setElevation(-h/2);g.setLevel(null);g.setAngle(0);if(d!==null){var k=function(){b.createObject3D(null,g,function(m){c.createIcon(m,j,f,h,a,function(n){c.setIcon(n);d.repaint()})})};setTimeout(k,0)}else{c.setIcon(c.createIcon(b.createObject3D(null,g,true),j,f,h,a))}},modelError:function(f){c.setIcon(TextureManager.getInstance().getErrorImage());if(d!==null){d.repaint()}}})};PlanComponent.PieceOfFurnitureModelIcon.prototype=Object.create(PlanComponent.PieceOfFurnitureTopViewIcon.prototype);PlanComponent.PieceOfFurnitureModelIcon.prototype.constructor=PlanComponent.PieceOfFurnitureModelIcon;PlanComponent.PieceOfFurnitureModelIcon.prototype.getSceneRoot=function(a){if(!PlanComponent.PieceOfFurnitureModelIcon.canvas3D||!PlanComponent.PieceOfFurnitureModelIcon.canvas3D[a]){var c=document.createElement("canvas");c.width=a;c.height=a;c.style.backgroundColor="rgba(0, 0, 0, 0)";var h=new HTMLCanvas3D(c);var f=mat4.create();mat4.fromXRotation(f,-Math.PI/2);h.setViewPlatformTransform(f);h.setProjectionPolicy(HTMLCanvas3D.PARALLEL_PROJECTION);h.setFrontClipDistance(-1.1);h.setBackClipDistance(1.1);var g=new BranchGroup3D();g.setCapability(Group3D.ALLOW_CHILDREN_EXTEND);var b=[new DirectionalLight3D(vec3.fromValues(0.6,0.6,0.6),vec3.fromValues(1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.6,0.6,0.6),vec3.fromValues(-1.5,-0.8,-1)),new DirectionalLight3D(vec3.fromValues(0.6,0.6,0.6),vec3.fromValues(0,-0.8,1)),new AmbientLight3D(vec3.fromValues(0.2,0.2,0.2))];for(var e=0;e<b.length;e++){g.addChild(b[e])}h.setScene(g);if(!PlanComponent.PieceOfFurnitureModelIcon.canvas3D){PlanComponent.PieceOfFurnitureModelIcon.canvas3D={}}PlanComponent.PieceOfFurnitureModelIcon.canvas3D[a]=h}if(a!==128){for(var d in PlanComponent.PieceOfFurnitureModelIcon.canvas3D){if(d!=128&&d!=a&&PlanComponent.PieceOfFurnitureModelIcon.canvas3D.hasOwnProperty(d)){PlanComponent.PieceOfFurnitureModelIcon.canvas3D[d].clear();delete PlanComponent.PieceOfFurnitureModelIcon.canvas3D[d]}}}return PlanComponent.PieceOfFurnitureModelIcon.canvas3D[a].getScene()};PlanComponent.PieceOfFurnitureModelIcon.prototype.createIcon=function(k,n,b,g,j,e){var d=mat4.create();mat4.scale(d,d,vec3.fromValues(2/n,2/g,2/b));var c=new TransformGroup3D();c.setTransform(d);if(k.getParent()!=null){k.getParent().removeChild(k)}c.addChild(k);var f=new BranchGroup3D();f.addChild(c);var m=this.getSceneRoot(j);if(e){var a=Date.now();var h=function(){m.addChild(f);var o=PlanComponent.PieceOfFurnitureModelIcon.canvas3D[j].isLoadingCompleted();if(o||(Date.now()-a)>5000){PlanComponent.PieceOfFurnitureModelIcon.canvas3D[j].getImage(e)}m.removeChild(f);if(!o){setTimeout(h,0)}};h();return undefined}else{m.addChild(f);var l=PlanComponent.PieceOfFurnitureModelIcon.canvas3D[j].getImage();m.removeChild(f);return l}};PlanComponent.PieceOfFurnitureModelIcon.computePieceOfFurnitureSizeInPlan=function(f,b){var a=mat4.create();if(f.getPitch()!==0){mat4.fromXRotation(a,-f.getPitch())}if(f.getRoll()!==0){var c=mat4.create();mat4.fromZRotation(c,-f.getRoll());mat4.mul(a,a,c,a)}f=f.clone();f.setX(0);f.setY(0);f.setElevation(-f.getHeight()/2);f.setLevel(null);f.setAngle(0);f.setRoll(0);f.setPitch(0);f.setWidthInPlan(f.getWidth());f.setDepthInPlan(f.getDepth());f.setHeightInPlan(f.getHeight());var g=ModelManager.getInstance().getBounds(b.createObject3D(null,f,true),a);var d=vec3.create();g.getLower(d);var e=vec3.create();g.getUpper(e);return[Math.max(0.001,(e[0]-d[0])),Math.max(0.001,(e[2]-d[2])),Math.max(0.001,(e[1]-d[1]))]};PlanComponent.HomePieceOfFurnitureTopViewIconKey=function(a){this.piece=a;this.hashCode=(a.getPlanIcon()!=null?a.getPlanIcon().hashCode():a.getModel().hashCode())+(a.getColor()!=null?37*a.getColor():1234);if(a.isHorizontallyRotated()||a.getTexture()!=null){this.hashCode+=(a.getTexture()!=null?37*a.getTexture().hashCode():0)+37*(a.getWidthInPlan()|0)+37*(a.getDepthInPlan()|0)+37*(a.getHeightInPlan()|0)}if(a.getRoll()!=0){this.hashCode+=37*(a.isModelMirrored()?1231:1237)}if(a.getPlanIcon()!=null){this.hashCode+=37*(function(b){return(31*b[0][0]+31*b[0][1]+31*b[0][2]+37*b[1][0]+37*b[1][1]+37*b[1][2]+41*b[2][0]+41*b[2][1]+41*b[2][2])|0})(a.getModelRotation())+37*(a.isModelCenteredAtOrigin()?1:0)+37*(a.isBackFaceShown()?1:0)+37*((a.getPitch()*1000)|0)+37*((a.getRoll()*1000)|0)+37*(function(d){var b=0;if(d!=null){for(var c=0;c<d.length;c++){if(d[c]!=null){b+=37*d[c].hashCode()}}}return b|0})(a.getModelTransformations())+37*(function(d){var b=0;if(d!=null){for(var c=0;c<d.length;c++){if(d[c]!=null){b+=37*d[c].hashCode()}}}return b|0})(a.getModelMaterials())+(a.getShininess()!=null?37*((a.getShininess()*1000)|0):3456)}};PlanComponent.HomePieceOfFurnitureTopViewIconKey.prototype.equals=function(b){if(b instanceof PlanComponent.HomePieceOfFurnitureTopViewIconKey){var a=b.piece;return(this.piece.getPlanIcon()!=null?this.piece.getPlanIcon().equals(a.getPlanIcon()):this.piece.getModel().equals(a.getModel()))&&(this.piece.getColor()==a.getColor())&&(this.piece.getTexture()==a.getTexture()||this.piece.getTexture()!=null&&this.piece.getTexture().equals(a.getTexture()))&&(!this.piece.isHorizontallyRotated()&&!a.isHorizontallyRotated()&&this.piece.getTexture()==null&&a.getTexture()==null||this.piece.getWidthInPlan()==a.getWidthInPlan()&&this.piece.getDepthInPlan()==a.getDepthInPlan()&&this.piece.getHeightInPlan()==a.getHeightInPlan())&&(this.piece.getRoll()==0&&a.getRoll()==0||this.piece.isModelMirrored()==a.isModelMirrored())&&(this.piece.getPlanIcon()!=null||(function(d,c){return d[0][0]==c[0][0]&&d[0][1]==c[0][1]&&d[0][2]==c[0][2]&&d[1][0]==c[1][0]&&d[1][1]==c[1][1]&&d[1][2]==c[1][2]&&d[2][0]==c[2][0]&&d[2][1]==c[2][1]&&d[2][2]==c[2][2]})(this.piece.getModelRotation(),a.getModelRotation())&&this.piece.isModelCenteredAtOrigin()==a.isModelCenteredAtOrigin()&&this.piece.isBackFaceShown()==a.isBackFaceShown()&&this.piece.getPitch()==a.getPitch()&&this.piece.getRoll()==a.getRoll()&&(function(e,d){if(e===d){return true}if(e==null||d==null||e.length!==d.length){return false}for(var c=0;c<e.length;c++){if(e[c]!==d[c]&&(e[c]==null||!e[c].equals(d[c]))){return false}}return true})(this.piece.getModelTransformations(),a.getModelTransformations())&&(function(e,d){if(e===d){return true}if(e==null||d==null||e.length!==d.length){return false}for(var c=0;c<e.length;c++){if(e[c]!==d[c]&&(e[c]==null||!e[c].equals(d[c]))){return false}}return true})(this.piece.getModelMaterials(),a.getModelMaterials())&&this.piece.getShininess()==a.getShininess())}else{return false}};PlanComponent.HomePieceOfFurnitureTopViewIconKey.prototype.hashCode=function(){return this.hashCode};function HomePane(h,k,f,g){if(h!=null){this.container=document.getElementById(h)}if(!this.container){this.container=document.body}this.home=k;this.preferences=f;this.controller=g;this.clipboardEmpty=true;this.actionMap={};this.inputMap={};this.transferHandlerEnabled=false;this.createActions(k,f,g);this.initActions(f);this.addHomeListener(k);this.addLevelVisibilityListener(k);this.addUserPreferencesListener(f);this.addPlanControllerListener(g.getPlanController());this.addFocusListener();this.createToolBar(k,f,g);this.createPopupMenus(k,f);this.initSplitters();this.addOrientationChangeListener();var j=this;this.keydownListener=function(o){if(JSDialog.getTopMostDialog()!==null){return}var r=KeyStroke.getKeyStrokeForEvent(o);if(r!==undefined){for(var n in j.actionMap){var q=j.actionMap[n];if(q instanceof AbstractAction&&q.isEnabled()&&q.getValue(AbstractAction.ACCELERATOR_KEY)==r){q.actionPerformed();o.stopPropagation();return}}var p=j.inputMap[r];if(p!==undefined){var q=j.actionMap[p];if(q!==undefined){q.actionPerformed(o)}o.stopPropagation()}}};document.addEventListener("keydown",this.keydownListener,false);var l=g.getPlanController().getView();if(l!=null){var e=k.getNumericProperty(HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY);var c=k.getNumericProperty(HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY);if(e!=null&&c!=null){l.scrollPane.scrollLeft=e|0;l.scrollPane.scrollTop=c|0}l.scrollPane.addEventListener("scroll",function(n){g.setHomeProperty(HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY,l.scrollPane.scrollLeft.toString());g.setHomeProperty(HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY,l.scrollPane.scrollTop.toString())})}this.levelSelector=document.getElementById("level-selector");var a=function(){if(j.levelSelector){j.levelSelector.innerHTML="";if(k.getLevels().length<2){j.levelSelector.style.display="none"}else{for(var n=0;n<k.getLevels().length;n++){var o=document.createElement("option");o.value=n;o.innerHTML=k.getLevels()[n].getName();if(k.getLevels()[n]===k.getSelectedLevel()){o.selected="selected"}j.levelSelector.appendChild(o)}j.levelSelector.style.display="inline"}}};a();if(this.levelSelector){this.levelSelectorChangeListener=function(n){g.getPlanController().setSelectedLevel(k.getLevels()[parseInt(n.target.value)]);a()};this.levelSelector.addEventListener("change",this.levelSelectorChangeListener)}k.addPropertyChangeListener("SELECTED_LEVEL",a);var d=function(n){if("NAME"==n.getPropertyName()||"ELEVATION"==n.getPropertyName()||"ELEVATION_INDEX"==n.getPropertyName()){a()}};var m=k.getLevels();for(var b=0;b<m.length;b++){m[b].addPropertyChangeListener(d)}k.addLevelsListener(function(n){if(n.getType()===CollectionEvent.Type.ADD){n.getItem().addPropertyChangeListener(d)}else{if(n.getType()===CollectionEvent.Type.DELETE){n.getItem().removePropertyChangeListener(d)}}a()});setTimeout(function(){if(l!=null){l.getHTMLElement().focus()}else{if(g.getHomeController3D().getView()!=null){g.getHomeController3D().getView().getHTMLElement().focus()}}})}HomePane.__class="HomePane";HomePane.__interfaces=["com.eteks.sweethome3d.viewcontroller.HomeView","com.eteks.sweethome3d.viewcontroller.View"];HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.MainPaneDividerLocation";HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.CatalogPaneDividerLocation";HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanPaneDividerLocation";HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanViewportX";HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.PlanViewportY";HomePane.FURNITURE_VIEWPORT_Y_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.FurnitureViewportY";HomePane.DETACHED_VIEW_VISUAL_PROPERTY=".detachedView";HomePane.DETACHED_VIEW_DIVIDER_LOCATION_VISUAL_PROPERTY=".detachedViewDividerLocation";HomePane.DETACHED_VIEW_X_VISUAL_PROPERTY=".detachedViewX";HomePane.DETACHED_VIEW_Y_VISUAL_PROPERTY=".detachedViewY";HomePane.DETACHED_VIEW_WIDTH_VISUAL_PROPERTY=".detachedViewWidth";HomePane.DETACHED_VIEW_HEIGHT_VISUAL_PROPERTY=".detachedViewHeight";HomePane.MenuActionType={};HomePane.MenuActionType[HomePane.MenuActionType.FILE_MENU=0]="FILE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.EDIT_MENU=1]="EDIT_MENU";HomePane.MenuActionType[HomePane.MenuActionType.FURNITURE_MENU=2]="FURNITURE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.PLAN_MENU=3]="PLAN_MENU";HomePane.MenuActionType[HomePane.MenuActionType.VIEW_3D_MENU=4]="VIEW_3D_MENU";HomePane.MenuActionType[HomePane.MenuActionType.HELP_MENU=5]="HELP_MENU";HomePane.MenuActionType[HomePane.MenuActionType.OPEN_RECENT_HOME_MENU=6]="OPEN_RECENT_HOME_MENU";HomePane.MenuActionType[HomePane.MenuActionType.ALIGN_OR_DISTRIBUTE_MENU=7]="ALIGN_OR_DISTRIBUTE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.SORT_HOME_FURNITURE_MENU=8]="SORT_HOME_FURNITURE_MENU";HomePane.MenuActionType[HomePane.MenuActionType.DISPLAY_HOME_FURNITURE_PROPERTY_MENU=9]="DISPLAY_HOME_FURNITURE_PROPERTY_MENU";HomePane.MenuActionType[HomePane.MenuActionType.MODIFY_TEXT_STYLE=10]="MODIFY_TEXT_STYLE";HomePane.MenuActionType[HomePane.MenuActionType.GO_TO_POINT_OF_VIEW=11]="GO_TO_POINT_OF_VIEW";HomePane.MenuActionType[HomePane.MenuActionType.SELECT_OBJECT_MENU=12]="SELECT_OBJECT_MENU";HomePane.MenuActionType[HomePane.MenuActionType.TOGGLE_SELECTION_MENU=13]="TOGGLE_SELECTION_MENU";HomePane.prototype.getHTMLElement=function(){return this.container};HomePane.prototype.getActionMap=function(){return this.actionMap};HomePane.prototype.getAction=function(a){if(typeof a==="string"){return this.actionMap[a]}else{return this.actionMap[HomeView.ActionType[a]]}};HomePane.prototype.createActions=function(n,j,k){var d=HomeView.ActionType;this.createAction(d.NEW_HOME,j,k,"newHome");this.createAction(d.NEW_HOME_FROM_EXAMPLE,j,k,"newHomeFromExample");this.createAction(d.OPEN,j,k,"open");this.createAction(d.DELETE_RECENT_HOMES,j,k,"deleteRecentHomes");this.createAction(d.CLOSE,j,k,"close");this.createAction(d.SAVE,j,k,"save");this.createAction(d.SAVE_AS,j,k,"saveAs");this.createAction(d.SAVE_AND_COMPRESS,j,k,"saveAndCompress");this.createAction(d.PAGE_SETUP,j,k,"setupPage");this.createAction(d.PRINT_PREVIEW,j,k,"previewPrint");this.createAction(d.PRINT,j,k,"print");this.createAction(d.PRINT_TO_PDF,j,k,"printToPDF");this.createAction(d.PREFERENCES,j,k,"editPreferences");this.createAction(d.EXIT,j,k,"exit");this.createAction(d.UNDO,j,k,"undo");this.createAction(d.REDO,j,k,"redo");this.createClipboardAction(d.CUT,j,null,true);this.createClipboardAction(d.COPY,j,null,true);this.createClipboardAction(d.PASTE,j,null,false);this.createAction(d.PASTE_TO_GROUP,j,k,"pasteToGroup");this.createAction(d.PASTE_STYLE,j,k,"pasteStyle");this.createAction(d.DELETE,j,k,"delete");this.createAction(d.SELECT_ALL,j,k,"selectAll");this.createAction(d.ADD_HOME_FURNITURE,j,k,"addHomeFurniture");this.createAction(d.ADD_FURNITURE_TO_GROUP,j,k,"addFurnitureToGroup");var f=k.getFurnitureController();this.createAction(d.DELETE_HOME_FURNITURE,j,f,"deleteSelection");this.createAction(d.MODIFY_FURNITURE,j,k,"modifySelectedFurniture");this.createAction(d.GROUP_FURNITURE,j,f,"groupSelectedFurniture");this.createAction(d.UNGROUP_FURNITURE,j,f,"ungroupSelectedFurniture");this.createAction(d.ALIGN_FURNITURE_ON_TOP,j,f,"alignSelectedFurnitureOnTop");this.createAction(d.ALIGN_FURNITURE_ON_BOTTOM,j,f,"alignSelectedFurnitureOnBottom");this.createAction(d.ALIGN_FURNITURE_ON_LEFT,j,f,"alignSelectedFurnitureOnLeft");this.createAction(d.ALIGN_FURNITURE_ON_RIGHT,j,f,"alignSelectedFurnitureOnRight");this.createAction(d.ALIGN_FURNITURE_ON_FRONT_SIDE,j,f,"alignSelectedFurnitureOnFrontSide");this.createAction(d.ALIGN_FURNITURE_ON_BACK_SIDE,j,f,"alignSelectedFurnitureOnBackSide");this.createAction(d.ALIGN_FURNITURE_ON_LEFT_SIDE,j,f,"alignSelectedFurnitureOnLeftSide");this.createAction(d.ALIGN_FURNITURE_ON_RIGHT_SIDE,j,f,"alignSelectedFurnitureOnRightSide");this.createAction(d.ALIGN_FURNITURE_SIDE_BY_SIDE,j,f,"alignSelectedFurnitureSideBySide");this.createAction(d.DISTRIBUTE_FURNITURE_HORIZONTALLY,j,f,"distributeSelectedFurnitureHorizontally");this.createAction(d.DISTRIBUTE_FURNITURE_VERTICALLY,j,f,"distributeSelectedFurnitureVertically");this.createAction(d.RESET_FURNITURE_ELEVATION,j,f,"resetFurnitureElevation");var b=k.getHomeController3D();if(b.getView()!=null){this.createAction(d.IMPORT_FURNITURE,j,k,"importFurniture")}this.createAction(d.IMPORT_FURNITURE_LIBRARY,j,k,"importFurnitureLibrary");this.createAction(d.IMPORT_TEXTURE,j,k,"importTexture");this.createAction(d.IMPORT_TEXTURES_LIBRARY,j,k,"importTexturesLibrary");this.createAction(d.SORT_HOME_FURNITURE_BY_CATALOG_ID,j,f,"toggleFurnitureSort","CATALOG_ID");this.createAction(d.SORT_HOME_FURNITURE_BY_NAME,j,f,"toggleFurnitureSort","NAME");this.createAction(d.SORT_HOME_FURNITURE_BY_DESCRIPTION,j,f,"toggleFurnitureSort","DESCRIPTION");this.createAction(d.SORT_HOME_FURNITURE_BY_CREATOR,j,f,"toggleFurnitureSort","CREATOR");this.createAction(d.SORT_HOME_FURNITURE_BY_LICENSE,j,f,"toggleFurnitureSort","LICENSE");this.createAction(d.SORT_HOME_FURNITURE_BY_WIDTH,j,f,"toggleFurnitureSort","WIDTH");this.createAction(d.SORT_HOME_FURNITURE_BY_DEPTH,j,f,"toggleFurnitureSort","DEPTH");this.createAction(d.SORT_HOME_FURNITURE_BY_HEIGHT,j,f,"toggleFurnitureSort","HEIGHT");this.createAction(d.SORT_HOME_FURNITURE_BY_X,j,f,"toggleFurnitureSort","X");this.createAction(d.SORT_HOME_FURNITURE_BY_Y,j,f,"toggleFurnitureSort","Y");this.createAction(d.SORT_HOME_FURNITURE_BY_ELEVATION,j,f,"toggleFurnitureSort","ELEVATION");this.createAction(d.SORT_HOME_FURNITURE_BY_ANGLE,j,f,"toggleFurnitureSort","ANGLE");this.createAction(d.SORT_HOME_FURNITURE_BY_LEVEL,j,f,"toggleFurnitureSort","LEVEL");this.createAction(d.SORT_HOME_FURNITURE_BY_MODEL_SIZE,j,f,"toggleFurnitureSort","MODEL_SIZE");this.createAction(d.SORT_HOME_FURNITURE_BY_COLOR,j,f,"toggleFurnitureSort","COLOR");this.createAction(d.SORT_HOME_FURNITURE_BY_TEXTURE,j,f,"toggleFurnitureSort","TEXTURE");this.createAction(d.SORT_HOME_FURNITURE_BY_MOVABILITY,j,f,"toggleFurnitureSort","MOVABLE");this.createAction(d.SORT_HOME_FURNITURE_BY_TYPE,j,f,"toggleFurnitureSort","DOOR_OR_WINDOW");this.createAction(d.SORT_HOME_FURNITURE_BY_VISIBILITY,j,f,"toggleFurnitureSort","VISIBLE");this.createAction(d.SORT_HOME_FURNITURE_BY_PRICE,j,f,"toggleFurnitureSort","PRICE");this.createAction(d.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,j,f,"toggleFurnitureSort","VALUE_ADDED_TAX_PERCENTAGE");this.createAction(d.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,j,f,"toggleFurnitureSort","VALUE_ADDED_TAX");this.createAction(d.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,j,f,"toggleFurnitureSort","PRICE_VALUE_ADDED_TAX_INCLUDED");this.createAction(d.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER,j,f,"toggleFurnitureSortOrder");this.createAction(d.DISPLAY_HOME_FURNITURE_CATALOG_ID,j,f,"toggleFurnitureVisibleProperty","CATALOG_ID");this.createAction(d.DISPLAY_HOME_FURNITURE_NAME,j,f,"toggleFurnitureVisibleProperty","NAME");this.createAction(d.DISPLAY_HOME_FURNITURE_DESCRIPTION,j,f,"toggleFurnitureVisibleProperty","DESCRIPTION");this.createAction(d.DISPLAY_HOME_FURNITURE_CREATOR,j,f,"toggleFurnitureVisibleProperty","CREATOR");this.createAction(d.DISPLAY_HOME_FURNITURE_LICENSE,j,f,"toggleFurnitureVisibleProperty","LICENSE");this.createAction(d.DISPLAY_HOME_FURNITURE_WIDTH,j,f,"toggleFurnitureVisibleProperty","WIDTH");this.createAction(d.DISPLAY_HOME_FURNITURE_DEPTH,j,f,"toggleFurnitureVisibleProperty","DEPTH");this.createAction(d.DISPLAY_HOME_FURNITURE_HEIGHT,j,f,"toggleFurnitureVisibleProperty","HEIGHT");this.createAction(d.DISPLAY_HOME_FURNITURE_X,j,f,"toggleFurnitureVisibleProperty","X");this.createAction(d.DISPLAY_HOME_FURNITURE_Y,j,f,"toggleFurnitureVisibleProperty","Y");this.createAction(d.DISPLAY_HOME_FURNITURE_ELEVATION,j,f,"toggleFurnitureVisibleProperty","ELEVATION");this.createAction(d.DISPLAY_HOME_FURNITURE_ANGLE,j,f,"toggleFurnitureVisibleProperty","ANGLE");this.createAction(d.DISPLAY_HOME_FURNITURE_LEVEL,j,f,"toggleFurnitureVisibleProperty","LEVEL");this.createAction(d.DISPLAY_HOME_FURNITURE_MODEL_SIZE,j,f,"toggleFurnitureVisibleProperty","MODEL_SIZE");this.createAction(d.DISPLAY_HOME_FURNITURE_COLOR,j,f,"toggleFurnitureVisibleProperty","COLOR");this.createAction(d.DISPLAY_HOME_FURNITURE_TEXTURE,j,f,"toggleFurnitureVisibleProperty","TEXTURE");this.createAction(d.DISPLAY_HOME_FURNITURE_MOVABLE,j,f,"toggleFurnitureVisibleProperty","MOVABLE");this.createAction(d.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,j,f,"toggleFurnitureVisibleProperty","DOOR_OR_WINDOW");this.createAction(d.DISPLAY_HOME_FURNITURE_VISIBLE,j,f,"toggleFurnitureVisibleProperty","VISIBLE");this.createAction(d.DISPLAY_HOME_FURNITURE_PRICE,j,f,"toggleFurnitureVisibleProperty","PRICE");this.createAction(d.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,j,f,"toggleFurnitureVisibleProperty","VALUE_ADDED_TAX_PERCENTAGE");this.createAction(d.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,j,f,"toggleFurnitureVisibleProperty","VALUE_ADDED_TAX");this.createAction(d.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,j,f,"toggleFurnitureVisibleProperty","PRICE_VALUE_ADDED_TAX_INCLUDED");this.createAction(d.EXPORT_TO_CSV,j,k,"exportToCSV");var o=k.getPlanController();if(o.getView()!=null){this.createAction(d.SELECT_ALL_AT_ALL_LEVELS,j,o,"selectAllAtAllLevels");var g=[];this.createToggleAction(d.SELECT,o.getMode()==PlanController.Mode.SELECTION,g,j,k,"setMode",PlanController.Mode.SELECTION);this.createToggleAction(d.PAN,o.getMode()==PlanController.Mode.PANNING,g,j,k,"setMode",PlanController.Mode.PANNING);this.createToggleAction(d.CREATE_WALLS,o.getMode()==PlanController.Mode.WALL_CREATION,g,j,k,"setMode",PlanController.Mode.WALL_CREATION);this.createToggleAction(d.CREATE_ROOMS,o.getMode()==PlanController.Mode.ROOM_CREATION,g,j,k,"setMode",PlanController.Mode.ROOM_CREATION);this.createToggleAction(d.CREATE_POLYLINES,o.getMode()==PlanController.Mode.POLYLINE_CREATION,g,j,k,"setMode",PlanController.Mode.POLYLINE_CREATION);this.createToggleAction(d.CREATE_DIMENSION_LINES,o.getMode()==PlanController.Mode.DIMENSION_LINE_CREATION,g,j,k,"setMode",PlanController.Mode.DIMENSION_LINE_CREATION);this.createToggleAction(d.CREATE_LABELS,o.getMode()==PlanController.Mode.LABEL_CREATION,g,j,k,"setMode",PlanController.Mode.LABEL_CREATION);this.createAction(d.DELETE_SELECTION,j,o,"deleteSelection");this.createAction(d.LOCK_BASE_PLAN,j,o,"lockBasePlan");this.createAction(d.UNLOCK_BASE_PLAN,j,o,"unlockBasePlan");this.createAction(d.ENABLE_MAGNETISM,j,k,"enableMagnetism");this.createAction(d.DISABLE_MAGNETISM,j,k,"disableMagnetism");this.createAction(d.FLIP_HORIZONTALLY,j,o,"flipHorizontally");this.createAction(d.FLIP_VERTICALLY,j,o,"flipVertically");this.createAction(d.MODIFY_COMPASS,j,o,"modifyCompass");this.createAction(d.MODIFY_WALL,j,o,"modifySelectedWalls");this.createAction(d.MODIFY_ROOM,j,o,"modifySelectedRooms");this.createAction(d.JOIN_WALLS,j,o,"joinSelectedWalls");this.createAction(d.REVERSE_WALL_DIRECTION,j,o,"reverseSelectedWallsDirection");this.createAction(d.SPLIT_WALL,j,o,"splitSelectedWall");this.createAction(d.ADD_ROOM_POINT,j);this.createAction(d.DELETE_ROOM_POINT,j);this.createAction(d.MODIFY_POLYLINE,j,o,"modifySelectedPolylines");this.createAction(d.MODIFY_DIMENSION_LINE,j,o,"modifySelectedDimensionLines");this.createAction(d.MODIFY_LABEL,j,o,"modifySelectedLabels");this.createAction(d.INCREASE_TEXT_SIZE,j,o,"increaseTextSize");this.createAction(d.DECREASE_TEXT_SIZE,j,o,"decreaseTextSize");var c=this.createBoldStyleAction(d.TOGGLE_BOLD_STYLE,n,j,o,"toggleBoldStyle");var p=this.createItalicStyleToggleModel(d.TOGGLE_ITALIC_STYLE,n,j,o,"toggleItalicStyle");this.createAction(d.IMPORT_BACKGROUND_IMAGE,j,k,"importBackgroundImage");this.createAction(d.MODIFY_BACKGROUND_IMAGE,j,k,"modifyBackgroundImage");this.createAction(d.HIDE_BACKGROUND_IMAGE,j,k,"hideBackgroundImage");this.createAction(d.SHOW_BACKGROUND_IMAGE,j,k,"showBackgroundImage");this.createAction(d.DELETE_BACKGROUND_IMAGE,j,k,"deleteBackgroundImage");this.createAction(d.ADD_LEVEL,j,o,"addLevel");this.createAction(d.ADD_LEVEL_AT_SAME_ELEVATION,j,o,"addLevelAtSameElevation");this.createAction(d.MAKE_LEVEL_VIEWABLE,j,o,"toggleSelectedLevelViewability");this.createAction(d.MAKE_LEVEL_UNVIEWABLE,j,o,"toggleSelectedLevelViewability");this.createAction(d.MAKE_LEVEL_ONLY_VIEWABLE_ONE,j,o,"setSelectedLevelOnlyViewable");this.createAction(d.MAKE_ALL_LEVELS_VIEWABLE,j,o,"setAllLevelsViewable");this.createAction(d.MODIFY_LEVEL,j,o,"modifySelectedLevel");this.createAction(d.DELETE_LEVEL,j,o,"deleteSelectedLevel");this.createAction(d.ZOOM_IN,j,k,"zoomIn");this.createAction(d.ZOOM_OUT,j,k,"zoomOut");this.createAction(d.EXPORT_TO_SVG,j,k,"exportToSVG")}if(b.getView()!=null){this.createAction(d.SELECT_OBJECT,j);this.createAction(d.TOGGLE_SELECTION,j);var e=[];this.createToggleAction(d.VIEW_FROM_TOP,n.getCamera()==n.getTopCamera(),e,j,b,"viewFromTop");this.createToggleAction(d.VIEW_FROM_OBSERVER,n.getCamera()==n.getObserverCamera(),e,j,b,"viewFromObserver");this.createAction(d.MODIFY_OBSERVER,j,o,"modifyObserverCamera");this.createAction(d.STORE_POINT_OF_VIEW,j,k,"storeCamera");this.createAction(d.DELETE_POINTS_OF_VIEW,j,k,"deleteCameras");this.createAction(d.DETACH_3D_VIEW,j,k,"detachView",k.getHomeController3D().getView());this.createAction(d.ATTACH_3D_VIEW,j,k,"attachView",k.getHomeController3D().getView());var l=n.getEnvironment().isAllLevelsVisible();var h=[];this.createToggleAction(d.DISPLAY_ALL_LEVELS,l,h,j,b,"displayAllLevels");this.createToggleAction(d.DISPLAY_SELECTED_LEVEL,!l,h,j,b,"displaySelectedLevel");this.createAction(d.MODIFY_3D_ATTRIBUTES,j,b,"modifyAttributes");this.createAction(d.CREATE_PHOTO,j,k,"createPhoto");this.createAction(d.CREATE_PHOTOS_AT_POINTS_OF_VIEW,j,k,"createPhotos");this.createAction(d.CREATE_VIDEO,j,k,"createVideo");this.createAction(d.EXPORT_TO_OBJ,j,k,"exportToOBJ")}this.createAction(d.HELP,j,k,"help");this.createAction(d.ABOUT,j,k,"about");var a=new ResourceAction(j,"HomePane","SHOW_APPLICATION_MENU",true);if(a.getValue(AbstractAction.SMALL_ICON)==null){a.putValue(AbstractAction.NAME,"SHOW_APPLICATION_MENU");a.putValue(AbstractAction.SMALL_ICON,"menu.png")}var m=this;a.actionPerformed=function(s){s.stopPropagation();s.preventDefault();var r=k.getPlanController().getView().getHTMLElement();var q=document.createEvent("Event");q.initEvent("contextmenu",true,true);q.clientX=m.showApplicationMenuButton.clientX+m.showApplicationMenuButton.clientWidth/2;q.clientY=m.showApplicationMenuButton.clientY+m.showApplicationMenuButton.clientHeight/2;m.showApplicationMenuButton.dispatchEvent(q)};this.getActionMap()["SHOW_APPLICATION_MENU"]=a};HomePane.prototype.createAction=function(c,b,a,h){var f=[];for(var e=4;e<arguments.length;e++){f[e-4]=arguments[e]}try{var g=new ResourceAction(b,HomePane,HomeView.ActionType[c],false,a,h,f);this.getActionMap()[HomeView.ActionType[c]]=g;return g}catch(d){console.log(d)}};HomePane.prototype.createToggleAction=function(b,d,h,f,g,a){var j=[];for(var e=6;e<arguments.length;e++){j[e-6]=arguments[e]}var c=this.createAction.apply(this,[b,f,g,a].concat(j));if(h!=null){h.push(c);c.putValue(ResourceAction.TOGGLE_BUTTON_GROUP,h);c.putValue(AbstractAction.SELECTED_KEY,d);c.addPropertyChangeListener(function(l){if(l.getPropertyName()==AbstractAction.SELECTED_KEY){if(l.getNewValue()){var m=l.getSource().getValue(ResourceAction.TOGGLE_BUTTON_GROUP);for(var k=0;k<m.length;k++){if(c!==m[k]&&m[k].getValue(AbstractAction.SELECTED_KEY)){m[k].putValue(AbstractAction.SELECTED_KEY,false)}}}else{l.getSource().putValue(AbstractAction.SELECTED_KEY,false)}}})}return c};HomePane.prototype.createClipboardAction=function(d,b,c,a){var e=this.createAction(d,b);var f=this;e.actionPerformed=function(g){if(a){f.clipboard=Home.duplicate(f.home.getSelectedItems());f.clipboardEmpty=false;f.controller.enablePasteAction()}switch(d){case HomeView.ActionType.CUT:f.controller.cut(f.home.getSelectedItems());break;case HomeView.ActionType.COPY:break;case HomeView.ActionType.PASTE:f.controller.paste(Home.duplicate(f.clipboard));break}return e}};HomePane.prototype.getMenuAction=function(a){return new ResourceAction(this.preferences,HomePane,HomePane.MenuActionType[a],true)};HomePane.prototype.addHomeListener=function(a){var b=this;a.addPropertyChangeListener("CAMERA",function(c){b.setToggleButtonModelSelected(HomeView.ActionType.VIEW_FROM_TOP,a.getCamera()==a.getTopCamera());b.setToggleButtonModelSelected(HomeView.ActionType.VIEW_FROM_OBSERVER,a.getCamera()==a.getObserverCamera())})};HomePane.prototype.setToggleButtonModelSelected=function(a,b){this.getAction(a).putValue(AbstractAction.SELECTED_KEY,b)};HomePane.prototype.addLevelVisibilityListener=function(a){var b=this;a.getEnvironment().addPropertyChangeListener("ALL_LEVELS_VISIBLE",function(d){var c=a.getEnvironment().isAllLevelsVisible();b.setToggleButtonModelSelected(HomeView.ActionType.DISPLAY_ALL_LEVELS,c);b.setToggleButtonModelSelected(HomeView.ActionType.DISPLAY_SELECTED_LEVEL,!c)})};HomePane.prototype.addUserPreferencesListener=function(a){this.preferencesChangeListener=new HomePane.UserPreferencesChangeListener(this);a.addPropertyChangeListener("CURRENCY",this.preferencesChangeListener);a.addPropertyChangeListener("VALUE_ADDED_TAX_ENABLED",this.preferencesChangeListener)};HomePane.UserPreferencesChangeListener=function(a){this.homePane=a};HomePane.UserPreferencesChangeListener.prototype.propertyChange=function(b){var e=HomeView.ActionType;var d=this.homePane;var a=b.getSource();var c=b.getPropertyName();if(d==null){a.removePropertyChangeListener(c,this)}else{switch(c){case"CURRENCY":d.getAction(e.DISPLAY_HOME_FURNITURE_PRICE).putValue(ResourceAction.VISIBLE,b.getNewValue()!=null);d.getAction(e.SORT_HOME_FURNITURE_BY_PRICE).putValue(ResourceAction.VISIBLE,b.getNewValue()!=null);break;case"VALUE_ADDED_TAX_ENABLED":d.getAction(e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);d.getAction(e.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,b.getNewValue()==true);break}}};HomePane.prototype.initActions=function(a){this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_CATALOG_ID).putValue(ResourceAction.VISIBLE,false);this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_CATALOG_ID).putValue(ResourceAction.VISIBLE,false);this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE).putValue(ResourceAction.VISIBLE,a.getCurrency()!=null);this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE).putValue(ResourceAction.VISIBLE,a.getCurrency()!=null);this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled());this.getAction(HomeView.ActionType.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED).putValue(ResourceAction.VISIBLE,a.isValueAddedTaxEnabled())};HomePane.prototype.addPlanControllerListener=function(a){var b=this;a.addPropertyChangeListener("MODE",function(c){var d=a.getMode();b.setToggleButtonModelSelected(HomeView.ActionType.SELECT,d==PlanController.Mode.SELECTION);b.setToggleButtonModelSelected(HomeView.ActionType.PAN,d==PlanController.Mode.PANNING);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_WALLS,d==PlanController.Mode.WALL_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_ROOMS,d==PlanController.Mode.ROOM_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_POLYLINES,d==PlanController.Mode.POLYLINE_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_DIMENSION_LINES,d==PlanController.Mode.DIMENSION_LINE_CREATION);b.setToggleButtonModelSelected(HomeView.ActionType.CREATE_LABELS,d==PlanController.Mode.LABEL_CREATION)})};HomePane.prototype.addFocusListener=function(){var a=this;this.focusListener=function(e){var d=[a.controller.getPlanController().getView(),a.controller.getHomeController3D().getView()];for(var c=0;c<d.length;c++){for(var b=e.target;b!==null;b=b.parentElement){if(b===d[c].getHTMLElement()){a.controller.focusedViewChanged(d[c]);return}}}};this.getHTMLElement().addEventListener("focusin",this.focusListener)};HomePane.prototype.addActionToMenu=function(a,b){var c=this.getAction(a);if(c!=null&&c.getValue(AbstractAction.NAME)!=null){b.addMenuItem(c)}};HomePane.prototype.createAlignOrDistributeMenu=function(a){var c=HomeView.ActionType;var b=this;a.addSubMenu(b.getMenuAction(HomePane.MenuActionType.ALIGN_OR_DISTRIBUTE_MENU),function(d){b.addActionToMenu(c.ALIGN_FURNITURE_ON_TOP,d);b.addActionToMenu(c.ALIGN_FURNITURE_ON_BOTTOM,d);b.addActionToMenu(c.ALIGN_FURNITURE_ON_LEFT,d);b.addActionToMenu(c.ALIGN_FURNITURE_ON_RIGHT,d);b.addActionToMenu(c.ALIGN_FURNITURE_ON_FRONT_SIDE,d);b.addActionToMenu(c.ALIGN_FURNITURE_ON_BACK_SIDE,d);b.addActionToMenu(c.ALIGN_FURNITURE_ON_LEFT_SIDE,d);b.addActionToMenu(c.ALIGN_FURNITURE_ON_RIGHT_SIDE,d);b.addActionToMenu(c.ALIGN_FURNITURE_SIDE_BY_SIDE,d);b.addActionToMenu(c.DISTRIBUTE_FURNITURE_HORIZONTALLY,d);b.addActionToMenu(c.DISTRIBUTE_FURNITURE_VERTICALLY,d)})};HomePane.prototype.createFurnitureSortMenu=function(b,a){var d=HomeView.ActionType;var c=this;a.addSubMenu(c.getMenuAction(HomePane.MenuActionType.SORT_HOME_FURNITURE_MENU),function(f){var g=function(h,k){var j=c.getAction(h);if(j&&j.getValue(AbstractAction.NAME)&&j.getValue(ResourceAction.VISIBLE)){f.addRadioButtonItem(j.getValue(AbstractAction.NAME),function(){j.actionPerformed()},k==b.getFurnitureSortedProperty())}};g(d.SORT_HOME_FURNITURE_BY_CATALOG_ID,"CATALOG_ID");g(d.SORT_HOME_FURNITURE_BY_NAME,"NAME");g(d.SORT_HOME_FURNITURE_BY_DESCRIPTION,"DESCRIPTION");g(d.SORT_HOME_FURNITURE_BY_CREATOR,"CREATOR");g(d.SORT_HOME_FURNITURE_BY_LICENSE,"LICENSE");g(d.SORT_HOME_FURNITURE_BY_WIDTH,"WIDTH");g(d.SORT_HOME_FURNITURE_BY_DEPTH,"DEPTH");g(d.SORT_HOME_FURNITURE_BY_HEIGHT,"HEIGHT");g(d.SORT_HOME_FURNITURE_BY_X,"X");g(d.SORT_HOME_FURNITURE_BY_Y,"Y");g(d.SORT_HOME_FURNITURE_BY_ELEVATION,"ELEVATION");g(d.SORT_HOME_FURNITURE_BY_ANGLE,"ANGLE");g(d.SORT_HOME_FURNITURE_BY_LEVEL,"LEVEL");g(d.SORT_HOME_FURNITURE_BY_MODEL_SIZE,"MODEL_SIZE");g(d.SORT_HOME_FURNITURE_BY_COLOR,"COLOR");g(d.SORT_HOME_FURNITURE_BY_TEXTURE,"TEXTURE");g(d.SORT_HOME_FURNITURE_BY_MOVABILITY,"MOVABLE");g(d.SORT_HOME_FURNITURE_BY_TYPE,"DOOR_OR_WINDOW");g(d.SORT_HOME_FURNITURE_BY_VISIBILITY,"VISIBLE");g(d.SORT_HOME_FURNITURE_BY_PRICE,"PRICE");g(d.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX_PERCENTAGE,"VALUE_ADDED_TAX_PERCENTAGE");g(d.SORT_HOME_FURNITURE_BY_VALUE_ADDED_TAX,"VALUE_ADDED_TAX");g(d.SORT_HOME_FURNITURE_BY_PRICE_VALUE_ADDED_TAX_INCLUDED,"PRICE_VALUE_ADDED_TAX_INCLUDED");f.addSeparator();var e=c.getAction(d.SORT_HOME_FURNITURE_BY_DESCENDING_ORDER);if(e&&e.getValue(AbstractAction.NAME)&&e.getValue(ResourceAction.VISIBLE)){f.addCheckBoxItem(e.getValue(AbstractAction.NAME),function(){e.actionPerformed()},b.isFurnitureDescendingSorted())}})};HomePane.prototype.createFurnitureDisplayPropertyMenu=function(b,a){var d=HomeView.ActionType;var c=this;a.addSubMenu(c.getMenuAction(HomePane.MenuActionType.DISPLAY_HOME_FURNITURE_PROPERTY_MENU),function(e){var f=function(g,j){var h=c.getAction(g);if(h&&h.getValue(AbstractAction.NAME)&&h.getValue(ResourceAction.VISIBLE)){e.addCheckBoxItem(h.getValue(AbstractAction.NAME),function(){h.actionPerformed()},b.getFurnitureVisibleProperties().indexOf(j)>-1)}};f(d.DISPLAY_HOME_FURNITURE_CATALOG_ID,"CATALOG_ID");f(d.DISPLAY_HOME_FURNITURE_NAME,"NAME");f(d.DISPLAY_HOME_FURNITURE_DESCRIPTION,"DESCRIPTION");f(d.DISPLAY_HOME_FURNITURE_CREATOR,"CREATOR");f(d.DISPLAY_HOME_FURNITURE_LICENSE,"LICENSE");f(d.DISPLAY_HOME_FURNITURE_WIDTH,"WIDTH");f(d.DISPLAY_HOME_FURNITURE_DEPTH,"DEPTH");f(d.DISPLAY_HOME_FURNITURE_HEIGHT,"HEIGHT");f(d.DISPLAY_HOME_FURNITURE_X,"X");f(d.DISPLAY_HOME_FURNITURE_Y,"Y");f(d.DISPLAY_HOME_FURNITURE_ELEVATION,"ELEVATION");f(d.DISPLAY_HOME_FURNITURE_ANGLE,"ANGLE");f(d.DISPLAY_HOME_FURNITURE_LEVEL,"LEVEL");f(d.DISPLAY_HOME_FURNITURE_MODEL_SIZE,"MODEL_SIZE");f(d.DISPLAY_HOME_FURNITURE_COLOR,"COLOR");f(d.DISPLAY_HOME_FURNITURE_TEXTURE,"TEXTURE");f(d.DISPLAY_HOME_FURNITURE_MOVABLE,"MOVABLE");f(d.DISPLAY_HOME_FURNITURE_DOOR_OR_WINDOW,"DOOR_OR_WINDOW");f(d.DISPLAY_HOME_FURNITURE_VISIBLE,"VISIBLE");f(d.DISPLAY_HOME_FURNITURE_PRICE,"PRICE");f(d.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX_PERCENTAGE,"VALUE_ADDED_TAX_PERCENTAGE");f(d.DISPLAY_HOME_FURNITURE_VALUE_ADDED_TAX,"VALUE_ADDED_TAX");f(d.DISPLAY_HOME_FURNITURE_PRICE_VALUE_ADDED_TAX_INCLUDED,"PRICE_VALUE_ADDED_TAX_INCLUDED")})};HomePane.prototype.createLockUnlockBasePlanButton=function(e,c){var b=this.getAction(HomeView.ActionType.UNLOCK_BASE_PLAN);var d=this.getAction(HomeView.ActionType.LOCK_BASE_PLAN);if(b!=null&&b.getValue(AbstractAction.NAME)!=null&&d.getValue(AbstractAction.NAME)!=null){var a=this.createToolBarButton(e.isBasePlanLocked()?b:d,c);e.addPropertyChangeListener("BASE_PLAN_LOCKED",function(){a.setAction(e.isBasePlanLocked()?b:d)});return a}else{return null}};HomePane.prototype.createEnableDisableMagnetismButton=function(d,c){var e=this.getAction(HomeView.ActionType.DISABLE_MAGNETISM);var b=this.getAction(HomeView.ActionType.ENABLE_MAGNETISM);if(e!==null&&e.getValue(AbstractAction.NAME)!==null&&b.getValue(AbstractAction.NAME)!==null){var a=this.createToolBarButton(d.isMagnetismEnabled()?e:b,c);d.addPropertyChangeListener("MAGNETISM_ENABLED",new HomePane.MagnetismChangeListener(this,a));return a}else{return null}};HomePane.MagnetismChangeListener=function MagnetismChangeListener(b,a){this.enableDisableMagnetismButton=a;this.homePane=b};HomePane.MagnetismChangeListener.prototype.propertyChange=function(b){var d=this.homePane;var a=b.getSource();var c=b.getPropertyName();if(d==null){a.removePropertyChangeListener(c,this)}else{this.enableDisableMagnetismButton.setAction(a.isMagnetismEnabled()?d.getAction(HomeView.ActionType.DISABLE_MAGNETISM):d.getAction(HomeView.ActionType.ENABLE_MAGNETISM))}};HomePane.prototype.createBoldStyleAction=function(c,e,b,a,f){var d=this.createAction(c,b,a,f);e.addSelectionListener({selectionChanged:function(k){var j=null;var l=e.getSelectedItems();for(var h=0;h<l.length;h++){item=l[h];var g;if(item instanceof Label){g=this.isItemTextBold("Label",item.getStyle())}else{if(item instanceof HomePieceOfFurniture&&item.isVisible()){g=this.isItemTextBold("HomePieceOfFurniture",item.getNameStyle())}else{if(item instanceof Room){g=this.isItemTextBold("Room",item.getNameStyle());if(g!=this.isItemTextBold("Room",item.getAreaStyle())){g=null}}else{if(item instanceof DimensionLine){g=this.isItemTextBold("DimensionLine",item.getLengthStyle())}else{continue}}}}if(j==null){j=g}else{if(g==null||j!=g){j=null;break}}}d.putValue(AbstractAction.SELECTED_KEY,j!=null&&j)},isItemTextBold:function(h,g){if(g==null){g=b.getDefaultTextStyle(h)}return g.isBold()}});return d};HomePane.prototype.createItalicStyleToggleModel=function(c,e,b,a,f){var d=this.createAction(c,b,a,f);e.addSelectionListener({selectionChanged:function(k){var h=null;var l=e.getSelectedItems();for(var j=0;j<l.length;j++){item=l[j];var g;if(item instanceof Label){g=this.isItemTextItalic("Label",item.getStyle())}else{if(item instanceof HomePieceOfFurniture&&item.isVisible()){g=this.isItemTextItalic("HomePieceOfFurniture",item.getNameStyle())}else{if(item instanceof Room){g=this.isItemTextItalic("Room",item.getNameStyle());if(g!=this.isItemTextItalic("Room",item.getAreaStyle())){g=null}}else{if(item instanceof DimensionLine){g=this.isItemTextItalic("DimensionLine",item.getLengthStyle())}else{continue}}}}if(h==null){h=g}else{if(g==null||h!=g){h=null;break}}}d.putValue(AbstractAction.SELECTED_KEY,h!=null&&h)},isItemTextItalic:function(h,g){if(g==null){g=b.getDefaultTextStyle(h)}return g.isItalic()}});return d};HomePane.prototype.createToolBar=function(h,f,c){var e=document.getElementById("application-menu-toolbar");if(e!=null){this.startToolBarButtonGroup(e);this.addActionToToolBar("SHOW_APPLICATION_MENU",e);this.showApplicationMenuButton=e.children[e.children.length-1].lastChild}var d=document.getElementById("home-pane-toolbar");this.toolBarDefaultChildren=Array.prototype.slice.call(d.children);this.startToolBarButtonGroup(d);var g=false;if(d.classList.contains("new-home")){this.addActionToToolBar(HomeView.ActionType.NEW_HOME,d);g=true}if(d.classList.contains("open")){this.addActionToToolBar(HomeView.ActionType.OPEN,d);g=true}if(d.classList.contains("save")){this.addActionToToolBar(HomeView.ActionType.SAVE,d);g=true}if(d.classList.contains("save-as")){this.addActionToToolBar(HomeView.ActionType.SAVE_AS,d);g=true}if(g){this.addSeparator(d)}this.addToggleActionToToolBar(HomeView.ActionType.VIEW_FROM_TOP,d);this.addToggleActionToToolBar(HomeView.ActionType.VIEW_FROM_OBSERVER,d);this.addSeparator(d);this.addActionToToolBar(HomeView.ActionType.UNDO,d);this.addActionToToolBar(HomeView.ActionType.REDO,d);this.addSeparator(d);this.addActionToToolBar(HomeView.ActionType.DELETE_SELECTION,d);this.addActionToToolBar(HomeView.ActionType.CUT,d,"toolbar-optional");this.addActionToToolBar(HomeView.ActionType.COPY,d);this.addActionToToolBar(HomeView.ActionType.PASTE,d);this.addSeparator(d);this.addActionToToolBar(HomeView.ActionType.ADD_HOME_FURNITURE,d,"toolbar-optional");this.addSeparator(d);this.addToggleActionToToolBar(HomeView.ActionType.SELECT,d);this.addToggleActionToToolBar(HomeView.ActionType.PAN,d,"toolbar-optional");this.addToggleActionToToolBar(HomeView.ActionType.CREATE_WALLS,d);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_ROOMS,d);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_POLYLINES,d);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_DIMENSION_LINES,d);this.addToggleActionToToolBar(HomeView.ActionType.CREATE_LABELS,d);this.addSeparator(d);var b=this.createEnableDisableMagnetismButton(f);if(b!==null){this.addButtonToToolBar(d,b)}var a=this.createLockUnlockBasePlanButton(h);if(a!==null){this.addButtonToToolBar(d,a)}this.addActionToToolBar(HomeView.ActionType.FLIP_HORIZONTALLY,d);this.addActionToToolBar(HomeView.ActionType.FLIP_VERTICALLY,d);this.addSeparator(d);this.addActionToToolBar(HomeView.ActionType.INCREASE_TEXT_SIZE,d);this.addActionToToolBar(HomeView.ActionType.DECREASE_TEXT_SIZE,d);this.addToggleActionToToolBar(HomeView.ActionType.TOGGLE_BOLD_STYLE,d);this.addToggleActionToToolBar(HomeView.ActionType.TOGGLE_ITALIC_STYLE,d);this.addSeparator(d);this.addActionToToolBar(HomeView.ActionType.ZOOM_IN,d,"toolbar-optional");this.addActionToToolBar(HomeView.ActionType.ZOOM_OUT,d,"toolbar-optional");this.addSeparator(d);if(this.showApplicationMenuButton==null||!window.matchMedia("(hover: none), (pointer: coarse)").matches){this.addActionToToolBar(HomeView.ActionType.ABOUT,d);this.addSeparator(d)}this.addActionToToolBar(HomeView.ActionType.PREFERENCES,d);return d};HomePane.prototype.createPopupMenus=function(g,b){var a=HomeView.ActionType;var f=this;var d=this.controller;if(this.showApplicationMenuButton==null||!window.matchMedia("(hover: none), (pointer: coarse)").matches){var j=this.controller.getFurnitureCatalogController().getView();if(j!=null){this.furnitureCatalogPopupMenu=new JSPopupMenu(b,j.getHTMLElement(),function(k){f.addActionToMenu(a.ADD_HOME_FURNITURE,k);f.addActionToMenu(a.ADD_FURNITURE_TO_GROUP,k)})}var c=this.controller.getFurnitureController().getView();if(c!=null){this.furniturePopupMenu=new JSPopupMenu(b,c.getHTMLElement(),function(k){f.addActionToMenu(a.CUT,k);f.addActionToMenu(a.COPY,k);f.addActionToMenu(a.PASTE,k);f.addActionToMenu(a.PASTE_TO_GROUP,k);f.addActionToMenu(a.PASTE_STYLE,k);k.addSeparator();f.addActionToMenu(a.MODIFY_FURNITURE,k);f.addActionToMenu(a.GROUP_FURNITURE,k);f.addActionToMenu(a.UNGROUP_FURNITURE,k);f.createAlignOrDistributeMenu(k);f.addActionToMenu(a.RESET_FURNITURE_ELEVATION,k);k.addSeparator();f.createFurnitureSortMenu(g,k);f.createFurnitureDisplayPropertyMenu(g,k)})}var e=this.controller.getPlanController().getView();if(e!=null){this.planPopupMenu=new JSPopupMenu(b,e.getHTMLElement(),function(k){f.addActionToMenu(a.UNDO,k);f.addActionToMenu(a.REDO,k);k.addSeparator();f.addActionToMenu(a.DELETE_SELECTION,k);f.addActionToMenu(a.CUT,k);f.addActionToMenu(a.COPY,k);f.addActionToMenu(a.PASTE,k);f.addActionToMenu(a.PASTE_STYLE,k);k.addSeparator();f.addActionToMenu(a.SELECT_ALL,k);f.addActionToMenu(a.SELECT_ALL_AT_ALL_LEVELS,k);k.addSeparator();f.addActionToMenu(a.MODIFY_FURNITURE,k);f.addActionToMenu(a.GROUP_FURNITURE,k);f.addActionToMenu(a.UNGROUP_FURNITURE,k);f.addActionToMenu(a.RESET_FURNITURE_ELEVATION,k);k.addSeparator();f.addActionToMenu(a.MODIFY_COMPASS,k);f.addActionToMenu(a.MODIFY_WALL,k);f.addActionToMenu(a.JOIN_WALLS,k);f.addActionToMenu(a.REVERSE_WALL_DIRECTION,k);f.addActionToMenu(a.SPLIT_WALL,k);f.addActionToMenu(a.MODIFY_ROOM,k);f.addActionToMenu(a.MODIFY_POLYLINE,k);f.addActionToMenu(a.MODIFY_DIMENSION_LINE,k);f.addActionToMenu(a.MODIFY_LABEL,k);k.addSeparator();k.addSubMenu(f.getMenuAction(HomePane.MenuActionType.MODIFY_TEXT_STYLE),function(l){f.addActionToMenu(a.INCREASE_TEXT_SIZE,l);f.addActionToMenu(a.DECREASE_TEXT_SIZE,l);f.addActionToMenu(a.TOGGLE_BOLD_STYLE,l);f.addActionToMenu(a.TOGGLE_ITALIC_STYLE,l)});k.addSeparator();f.addActionToMenu(a.IMPORT_BACKGROUND_IMAGE,k);f.addActionToMenu(a.MODIFY_BACKGROUND_IMAGE,k);f.addActionToMenu(a.HIDE_BACKGROUND_IMAGE,k);f.addActionToMenu(a.SHOW_BACKGROUND_IMAGE,k);f.addActionToMenu(a.DELETE_BACKGROUND_IMAGE,k);k.addSeparator();f.addActionToMenu(a.ADD_LEVEL,k);f.addActionToMenu(a.ADD_LEVEL_AT_SAME_ELEVATION,k);f.addActionToMenu(a.MODIFY_LEVEL,k);f.addActionToMenu(a.DELETE_LEVEL,k)})}var h=this.controller.getHomeController3D().getView();if(h!=null){this.view3DPopupMenu=new JSPopupMenu(b,h.getHTMLElement(),function(k){f.addActionToMenu(a.VIEW_FROM_TOP,k);f.addActionToMenu(a.VIEW_FROM_OBSERVER,k);f.addActionToMenu(a.MODIFY_OBSERVER,k);f.addActionToMenu(a.STORE_POINT_OF_VIEW,k);var l=g.getStoredCameras();if(l.length>0){var m=f.getMenuAction(HomePane.MenuActionType.GO_TO_POINT_OF_VIEW);if(m.getValue(AbstractAction.NAME)!=null){k.addSubMenu(m,function(n){var p=function(r){n.addMenuItem(r.getName(),function(){d.getHomeController3D().goToCamera(r)})};var o=g.getStoredCameras();for(var q=0;q<o.length;q++){p(o[q])}})}f.addActionToMenu(a.DELETE_POINTS_OF_VIEW,k)}k.addSeparator();f.addActionToMenu(a.DISPLAY_ALL_LEVELS,k);f.addActionToMenu(a.DISPLAY_SELECTED_LEVEL,k);f.addActionToMenu(a.MODIFY_3D_ATTRIBUTES,k)})}}else{new JSPopupMenu(b,this.showApplicationMenuButton,function(l){f.addActionToMenu(a.DELETE_SELECTION,l);f.addActionToMenu(a.CUT,l);f.addActionToMenu(a.COPY,l);f.addActionToMenu(a.PASTE,l);f.addActionToMenu(a.PASTE_TO_GROUP,l);f.addActionToMenu(a.PASTE_STYLE,l);l.addSeparator();f.addActionToMenu(a.SELECT_ALL,l);f.addActionToMenu(a.SELECT_ALL_AT_ALL_LEVELS,l);l.addSeparator();f.addActionToMenu(a.ADD_HOME_FURNITURE,l);f.addActionToMenu(a.ADD_FURNITURE_TO_GROUP,l);l.addSeparator();f.addActionToMenu(a.MODIFY_FURNITURE,l);f.addActionToMenu(a.GROUP_FURNITURE,l);f.addActionToMenu(a.UNGROUP_FURNITURE,l);f.createAlignOrDistributeMenu(l);f.addActionToMenu(a.RESET_FURNITURE_ELEVATION,l);var k=d.getFurnitureController().getView();if(k!=null&&window.getComputedStyle(k.getHTMLElement())["display"]!="none"){f.createFurnitureSortMenu(g,l);f.createFurnitureDisplayPropertyMenu(g,l)}l.addSeparator();f.addActionToMenu(a.SELECT,l);f.addActionToMenu(a.CREATE_WALLS,l);f.addActionToMenu(a.CREATE_ROOMS,l);f.addActionToMenu(a.CREATE_POLYLINES,l);f.addActionToMenu(a.CREATE_DIMENSION_LINES,l);f.addActionToMenu(a.CREATE_LABELS,l);l.addSeparator();f.addActionToMenu(a.MODIFY_COMPASS,l);f.addActionToMenu(a.MODIFY_WALL,l);f.addActionToMenu(a.JOIN_WALLS,l);f.addActionToMenu(a.REVERSE_WALL_DIRECTION,l);f.addActionToMenu(a.SPLIT_WALL,l);f.addActionToMenu(a.MODIFY_ROOM,l);f.addActionToMenu(a.MODIFY_POLYLINE,l);f.addActionToMenu(a.MODIFY_DIMENSION_LINE,l);f.addActionToMenu(a.MODIFY_LABEL,l);l.addSeparator();f.addActionToMenu(a.IMPORT_BACKGROUND_IMAGE,l);f.addActionToMenu(a.MODIFY_BACKGROUND_IMAGE,l);f.addActionToMenu(a.HIDE_BACKGROUND_IMAGE,l);f.addActionToMenu(a.SHOW_BACKGROUND_IMAGE,l);f.addActionToMenu(a.DELETE_BACKGROUND_IMAGE,l);l.addSeparator();f.addActionToMenu(a.ADD_LEVEL,l);f.addActionToMenu(a.ADD_LEVEL_AT_SAME_ELEVATION,l);f.addActionToMenu(a.MODIFY_LEVEL,l);f.addActionToMenu(a.DELETE_LEVEL,l);l.addSeparator();f.addActionToMenu(a.MODIFY_OBSERVER,l);f.addActionToMenu(a.STORE_POINT_OF_VIEW,l);var m=g.getStoredCameras();if(m.length>0){var n=f.getMenuAction(HomePane.MenuActionType.GO_TO_POINT_OF_VIEW);if(n.getValue(AbstractAction.NAME)!=null){l.addSubMenu(n,function(o){var q=function(s){o.addMenuItem(s.getName(),function(){d.getHomeController3D().goToCamera(s)})};var p=g.getStoredCameras();for(var r=0;r<p.length;r++){q(p[r])}})}f.addActionToMenu(a.DELETE_POINTS_OF_VIEW,l)}l.addSeparator();f.addActionToMenu(a.DISPLAY_ALL_LEVELS,l);f.addActionToMenu(a.DISPLAY_SELECTED_LEVEL,l);f.addActionToMenu(a.MODIFY_3D_ATTRIBUTES,l);l.addSeparator();f.addActionToMenu(a.ABOUT,l)})}};HomePane.prototype.initSplitters=function(){var c=this.controller;var h=c.getFurnitureCatalogController().getView();var b=c.getFurnitureController().getView();var f=c.getPlanController().getView();var g=c.getHomeController3D().getView();var a=document.getElementById("furniture-plan-splitter");var d=document.getElementById("plan-3D-view-splitter");var j=document.getElementById("catalog-furniture-splitter");this.furniturePlanSplitter={element:a,homePropertyName:HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:document.getElementById("catalog-furniture-pane"),secondGroupElement:document.getElementById("plan-3D-view-pane"),isDisplayed:function(){return a&&a.clientWidth>0},resizeListener:function(k){f.revalidate();g.revalidate()}};this.plan3DViewSplitter={element:d,homePropertyName:HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:f.getHTMLElement(),secondGroupElement:g.getHTMLElement(),isDisplayed:function(){return d&&d.clientWidth>0&&f!=null&&g!=null},resizeListener:function(k){f.revalidate();g.revalidate()}};this.catalogFurnitureSplitter={element:j,homePropertyName:HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,firstGroupElement:h.getHTMLElement(),secondGroupElement:b.getHTMLElement(),isDisplayed:function(){return j&&j.clientWidth>0&&h!=null&&b!=null}};this.updateSplitters();var e=window.document.createEvent("UIEvents");e.initEvent("resize",true,true);window.dispatchEvent(e)};HomePane.prototype.updateSplitters=function(){var a=this.controller.getPlanController().getView();var c=this.controller.getHomeController3D().getView();var b=this.controller.getFurnitureCatalogController().getView();if(b!==null&&b.getHTMLElement().getBoundingClientRect().top>c.getHTMLElement().getBoundingClientRect().top+10){this.plan3DViewSplitter.firstGroupElement=c.getHTMLElement();this.plan3DViewSplitter.secondGroupElement=a.getHTMLElement()}else{this.plan3DViewSplitter.firstGroupElement=a.getHTMLElement();this.plan3DViewSplitter.secondGroupElement=c.getHTMLElement()}this.updateSplitter(this.plan3DViewSplitter);this.updateSplitter(this.furniturePlanSplitter);this.updateSplitter(this.catalogFurnitureSplitter)};HomePane.prototype.updateSplitter=function(c){c.element.style.display="";c.element.style.top="";c.element.style.left="";c.firstGroupElement.style.left="";c.firstGroupElement.style.top="";c.firstGroupElement.style.width="";c.firstGroupElement.style.height="";c.secondGroupElement.style.left="";c.secondGroupElement.style.top="";c.secondGroupElement.style.width="";c.secondGroupElement.style.height="";var g=c.isDisplayed();if(g){c.element.style.display="block"}else{c.element.style.display="none"}if(c.mouseListener!==undefined&&c.mouseListener.mousePressed){c.element.removeEventListener("mousedown",c.mouseListener.mousePressed,true);c.element.removeEventListener("touchstart",c.mouseListener.mousePressed,true);window.removeEventListener("resize",c.mouseListener.windowResized);delete c.mouseListener}c.element.classList.remove("horizontal");c.element.classList.remove("vertical");var d=c.element.clientWidth>c.element.clientHeight;if(d){c.element.classList.add("horizontal")}else{c.element.classList.add("vertical")}var h=this.home.getNumericProperty(c.homePropertyName);var a=d?"top":"left";var f=d?"height":"width";var m=d?"clientHeight":"clientWidth";var e=d?"clientY":"clientX";var b=c.firstGroupElement.offsetParent;var k=d?"offsetTop":"offsetLeft";var l=b==document.body?c.firstGroupElement[k]-b[k]:0;var j=this;var n={getSplitterPosition:function(p){var o=p.touches&&p.touches.length>0?p.touches[0]:p;return o[e]-b[k]},setSplitterPosition:function(o){if(o<l){o=l}if(o>b[m]-c.element[m]){o=b[m]-c.element[m]}c.firstGroupElement.style[f]=(o-l)+"px";c.element.style[a]=o+"px";c.secondGroupElement.style[a]=(o+c.element[m])+"px";c.secondGroupElement.style[f]="calc(100% - "+(o+c.element[m])+"px)"},mouseDragged:function(o){o.stopImmediatePropagation();n.currentPosition=n.getSplitterPosition(o);n.setSplitterPosition(n.currentPosition);if(c.resizeListener!==undefined){c.resizeListener(n.currentPosition)}},mousePressed:function(o){o.preventDefault();o.stopImmediatePropagation();n.currentPosition=n.getSplitterPosition(o);c.element.classList.add("moving");window.addEventListener("mousemove",n.mouseDragged,true);window.addEventListener("touchmove",n.mouseDragged,true);window.addEventListener("mouseup",n.windowMouseReleased,true);window.addEventListener("touchend",n.windowMouseReleased,true)},windowMouseReleased:function(o){o.stopImmediatePropagation();c.element.classList.remove("moving");window.removeEventListener("mousemove",n.mouseDragged,true);window.removeEventListener("touchmove",n.mouseDragged,true);window.removeEventListener("mouseup",n.windowMouseReleased,true);window.removeEventListener("touchend",n.windowMouseReleased,true);j.controller.setHomeProperty(c.homePropertyName,n.currentPosition==null?null:n.currentPosition.toString());if(c.resizeListener!==undefined){c.resizeListener(n.currentPosition)}},windowResized:function(p){var o=window.getComputedStyle(c.element)[a];if(o==null){o="0px"}o=o.substring(0,o.length-2);if(o>b[m]-c.element[m]){n.setSplitterPosition(b[m]-c.element[m])}}};if(h!=null){if(g){n.setSplitterPosition(h)}if(c.resizeListener!==undefined){c.resizeListener(h)}}c.element.addEventListener("mousedown",n.mousePressed,true);c.element.addEventListener("touchstart",n.mousePressed,true);window.addEventListener("resize",n.windowResized);c.mouseListener=n};HomePane.prototype.addOrientationChangeListener=function(){var b=this;var a=function(d){var c=b.controller.getPlanController().getView();var f=b.controller.getHomeController3D().getView();if(c!=null&&f!=null){var e=document.getElementById("plan-3D-view-splitter");e.removeAttribute("style");c.getHTMLElement().removeAttribute("style");f.getHTMLElement().removeAttribute("style");c.revalidate();f.revalidate()}setTimeout(function(){b.updateSplitters()},100)};this.resizeListener=function(c){if(window.matchMedia("(hover: none), (pointer: coarse)").matches){a(c)}};window.addEventListener("resize",this.resizeListener)};HomePane.prototype.startToolBarButtonGroup=function(b){var a=document.createElement("span");b.appendChild(a);a.classList.add("toolbar-button-group")};HomePane.prototype.addButtonToToolBar=function(a,b){if(a.children.length===0){this.startToolBarButtonGroup(a)}a.children[a.children.length-1].appendChild(b)};HomePane.prototype.addToggleActionToToolBar=function(c,b,a){var e=this.getAction(c);if(e.getValue(AbstractAction.NAME)!=null){var d=this.createToolBarButton(e,a);if(e.getValue(AbstractAction.SELECTED_KEY)){d.classList.add("selected")}e.addPropertyChangeListener(function(f){if(f.getPropertyName()==AbstractAction.SELECTED_KEY){if(f.getNewValue()){d.classList.add("selected")}else{d.classList.remove("selected")}}});d.addEventListener("click",function(){var f=e.getValue(ResourceAction.TOGGLE_BUTTON_GROUP);e.putValue(AbstractAction.SELECTED_KEY,f?true:!e.getValue(AbstractAction.SELECTED_KEY))});this.addButtonToToolBar(b,d)}};HomePane.prototype.addActionToToolBar=function(c,b,a){var d=this.getAction(c);if(d.getValue(AbstractAction.NAME)!=null){this.addButtonToToolBar(b,this.createToolBarButton(d,a))}};HomePane.prototype.createToolBarButton=function(d,a){var b=document.createElement("button");b.id="toolbar-button-"+d.getValue(ResourceAction.RESOURCE_PREFIX);b.disabled=!d.isEnabled();b.tabIndex=-1;b.setAction=function(g){b.action=g;var e=g.getURL(ResourceAction.TOOL_BAR_ICON);if(!e){e=g.getURL(AbstractAction.SMALL_ICON)}b.style.backgroundImage="url('"+e+"')";b.style.backgroundPosition="center";b.style.backgroundRepeat="no-repeat";var f=g.getValue(AbstractAction.SHORT_DESCRIPTION);if(f){b.title=f}};b.setAction(d);b.classList.add("toolbar-button");if(d.getValue(ResourceAction.TOGGLE_BUTTON_GROUP)){b.classList.add("toggle")}b.action=d;b.addEventListener("click",function(e){this.action.actionPerformed(e)});var c={propertyChange:function(e){if(e.getPropertyName()=="enabled"){b.disabled=!e.getNewValue()}else{if(e.getPropertyName()==AbstractAction.SHORT_DESCRIPTION){b.title=e.getNewValue()}}}};d.addPropertyChangeListener(c);if(a){b.classList.add(a)}return b};HomePane.prototype.addSeparator=function(a){this.startToolBarButtonGroup(a)};HomePane.prototype.setEnabled=function(b,a){var c=this.getAction(b);if(c!=null){c.setEnabled(a)}};HomePane.prototype.setActionEnabled=function(b,a){var c=this.getAction(b);if(c!=null){c.setEnabled(a)}};HomePane.prototype.setUndoRedoName=function(b,a){this.setNameAndShortDescription(HomeView.ActionType.UNDO,b!=null?b.replace(/^Undo/,this.preferences.getLocalizedString("AbstractUndoableEdit","undo.textAndMnemonic")):null);this.setNameAndShortDescription(HomeView.ActionType.REDO,a!=null?a.replace(/^Redo/,this.preferences.getLocalizedString("AbstractUndoableEdit","redo.textAndMnemonic")):null)};HomePane.prototype.setNameAndShortDescription=function(b,a){var c=this.getAction(b);if(c!=null){if(a==null){a=c.getValue(AbstractAction.DEFAULT)}c.putValue(AbstractAction.NAME,a);c.putValue(AbstractAction.SHORT_DESCRIPTION,a)}};HomePane.prototype.setTransferEnabled=function(a){var c=this.controller.getFurnitureCatalogController().getView();if(a&&!this.transferHandlerEnabled){if(c!=null){if(this.furnitureCatalogDragAndDropListener==null){this.furnitureCatalogDragAndDropListener=this.createFurnitureCatalogMouseListener()}var b=c.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){for(i=0;i<b.length;i++){b[i].addEventListener("pointerdown",this.furnitureCatalogDragAndDropListener.pointerPressed)}c.getHTMLElement().addEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.addEventListener("pointermove",this.furnitureCatalogDragAndDropListener.windowPointerMoved);window.addEventListener("pointerup",this.furnitureCatalogDragAndDropListener.windowPointerReleased)}else{for(i=0;i<b.length;i++){b[i].addEventListener("touchstart",this.furnitureCatalogDragAndDropListener.mousePressed)}window.addEventListener("touchmove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.addEventListener("touchend",this.furnitureCatalogDragAndDropListener.windowMouseReleased);c.getHTMLElement().addEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.addEventListener("mousemove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.addEventListener("mouseup",this.furnitureCatalogDragAndDropListener.windowMouseReleased)}c.getHTMLElement().addEventListener("contextmenu",this.furnitureCatalogDragAndDropListener.contextMenuDisplayed)}var d=this;this.furnitureCatalogListener=function(e){if(e.getType()===CollectionEvent.Type.ADD&&!d.furnitureCatalogListener.updater){d.furnitureCatalogListener.updater=function(){if(d.furnitureCatalogListener!==undefined){var f=c.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){for(i=0;i<f.length;i++){f[i].addEventListener("pointerdown",d.furnitureCatalogDragAndDropListener.pointerPressed)}}else{for(i=0;i<f.length;i++){f[i].addEventListener("touchstart",d.furnitureCatalogDragAndDropListener.mousePressed)}}delete d.furnitureCatalogListener.updater}};setTimeout(d.furnitureCatalogListener.updater,100)}};this.preferences.getFurnitureCatalog().addFurnitureListener(this.furnitureCatalogListener)}else{if(!a&&this.transferHandlerEnabled){if(c!=null){var b=c.getHTMLElement().querySelectorAll(".furniture");if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){for(i=0;i<b.length;i++){b[i].removeEventListener("pointerdown",this.furnitureCatalogDragAndDropListener.pointerPressed)}c.getHTMLElement().removeEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.removeEventListener("pointermove",this.furnitureCatalogDragAndDropListener.windowPointerMoved);window.removeEventListener("pointerup",this.furnitureCatalogDragAndDropListener.windowPointerReleased)}else{for(i=0;i<b.length;i++){b[i].removeEventListener("touchstart",this.furnitureCatalogDragAndDropListener.mousePressed)}window.removeEventListener("touchmove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.removeEventListener("touchend",this.furnitureCatalogDragAndDropListener.windowMouseReleased);c.getHTMLElement().removeEventListener("mousedown",this.furnitureCatalogDragAndDropListener.mousePressed);window.removeEventListener("mousemove",this.furnitureCatalogDragAndDropListener.mouseDragged);window.removeEventListener("mouseup",this.furnitureCatalogDragAndDropListener.windowMouseReleased)}c.getHTMLElement().removeEventListener("contextmenu",this.furnitureCatalogDragAndDropListener.contextMenuDisplayed)}this.preferences.getFurnitureCatalog().removeFurnitureListener(this.furnitureCatalogListener);delete this.furnitureCatalogListener}}this.transferHandlerEnabled=a};HomePane.prototype.createFurnitureCatalogMouseListener=function(){var c=this;var b={selectedPiece:null,previousCursor:null,previousView:null,escaped:false,draggedImage:null,pointerTouches:{},actionStartedInFurnitureCatalog:false,contextMenuEventType:false,mousePressed:function(e){if(!b.contextMenuEventType&&(e.button===0||e.targetTouches)){if(!e.target.classList.contains("selected")){return}e.preventDefault();e.stopPropagation();var d=c.controller.getFurnitureCatalogController().getSelectedFurniture();if(d.length>0){b.selectedPiece=d[0];b.previousCursor=null;b.previousView=null;b.escaped=false;c.inputMap.ESCAPE="EscapeDragFromFurnitureCatalog"}b.actionStartedInFurnitureCatalog=true}},mouseDragged:function(k){if(!b.contextMenuEventType&&b.actionStartedInFurnitureCatalog&&((k.buttons&1)==1||k.targetTouches)&&b.selectedPiece!=null){k.preventDefault();k.stopPropagation();if(!b.escaped){if(b.draggedImage==null){var f=document.createElement("img");var e=c.controller.getFurnitureCatalogController().getView().getHTMLElement().querySelector(".furniture.selected .furniture-icon");f.src=e.src;var d=window.getComputedStyle(e);f.style.width=d.width;f.style.height=d.height;f.style.position="absolute";f.style.opacity=0.6;f.style.zIndex=105;b.draggedImage=f;document.body.appendChild(f)}b.draggedImage.style.left=b.getCoordinates(k).clientX+"px";b.draggedImage.style.top=b.getCoordinates(k).clientY+"px"}var m=c.home.getSelectedLevel();if(m==null||m.isViewable()){var g=[c.controller.getFurnitureController().createHomePieceOfFurniture(b.selectedPiece)];var l;var h=b.getPointInPlanView(k,g);if(h!=null){l=c.controller.getPlanController().getView()}else{l=c.controller.getFurnitureController().getView();h=b.getPointInFurnitureView(k)}if(b.previousView!==l){if(b.previousView!=null){if(b.previousView===c.controller.getPlanController().getView()&&!b.escaped){c.controller.getPlanController().stopDraggedItems()}var j=b.previousView;if(j&&typeof j.setCursor==="function"){j.setCursor(b.previousCursor)}b.previousCursor=null;b.previousView=null}if(l!=null){var j=l;b.previousCursor="default";b.previousView=l;if(!b.escaped){if(typeof j.setCursor==="function"){j.setCursor("copy")}if(l===c.controller.getPlanController().getView()){c.controller.getPlanController().startDraggedItems(g,h[0],h[1])}}}}else{if(h!=null){c.controller.getPlanController().moveMouse(h[0],h[1])}}}}},getPointInPlanView:function(g,e){var d=c.controller.getPlanController().getView();if(d!=null){var f=d.getHTMLElement().getBoundingClientRect();var h=b.getCoordinates(g);if(h.clientX>=f.left&&h.clientX<f.left+f.width&&h.clientY>=f.top&&h.clientY<f.top+f.height){return[d.convertXPixelToModel(h.clientX-f.left),d.convertYPixelToModel(h.clientY-f.top)]}}return null},getPointInView3D:function(e){var g=c.controller.getHomeController3D().getView();if(g!=null){var d=g.getHTMLElement().getBoundingClientRect();var f=b.getCoordinates(e);if(f.clientX>=d.left&&f.clientX<d.left+d.width&&f.clientY>=d.top&&f.clientY<d.top+d.height){return[f.clientX-d.left,f.clientY-d.top]}}return null},getCoordinates:function(d){if(d.targetTouches){if(d.targetTouches.length===1){return{clientX:d.targetTouches[0].clientX,clientY:d.targetTouches[0].clientY}}else{if(d.targetTouches.length===0&&d.changedTouches.length===1){return{clientX:d.changedTouches[0].clientX,clientY:d.changedTouches[0].clientY}}}}return d},getPointInFurnitureView:function(f){var d=c.controller.getFurnitureController().getView();if(d!=null){var e=d.getHTMLElement().getBoundingClientRect();var g=b.getCoordinates(f);if(g.clientX>=e.left&&g.clientX<e.left+e.width&&g.clientY>=e.top&&g.clientY<e.top+e.height){return[0,0]}}return null},contextMenuDisplayed:function(d){b.contextMenuEventType=true},windowMouseReleased:function(g){if(b.actionStartedInFurnitureCatalog){if(b.draggedImage!=null){document.body.removeChild(b.draggedImage);b.draggedImage=null}if(!b.contextMenuEventType){if((g.button===0||g.targetTouches)&&b.selectedPiece!=null){g.preventDefault();if(!b.escaped){var h=c.home.getSelectedLevel();if(h==null||h.isViewable()){var e=[c.controller.getFurnitureController().createHomePieceOfFurniture(b.selectedPiece)];var d;var k=b.getPointInPlanView(g,e);if(k!=null){c.controller.getPlanController().stopDraggedItems();d=c.controller.getPlanController().getView();c.controller.drop(e,d,k[0],k[1]);var d=b.previousView;if(d&&typeof d.setCursor==="function"){d.setCursor(this.previousCursor)}}else{pointInView3D=b.getPointInView3D(g);if(pointInView3D!==null){d=c.controller.getHomeController3D().getView();var j=c.getDropModelLevel(d,pointInView3D);var f=c.getDropModelLocation(d,e,j,pointInView3D);c.controller.drop(e,d,j,f[0],f[1],f.length===3?f[2]:null)}}}}}}}b.selectedPiece=null;b.actionStartedInFurnitureCatalog=false;b.contextMenuEventType=false;delete c.inputMap.ESCAPE},pointerPressed:function(d){if(d.pointerType!="mouse"){b.copyPointerToTargetTouches(d);return}b.mousePressed(d)},windowPointerMoved:function(d){if(d.pointerType!="mouse"){b.copyPointerToTargetTouches(d);return}b.mouseDragged(d)},windowPointerReleased:function(d){if(d.pointerType!="mouse"){delete b.pointerTouches[d.pointerId];return}b.windowMouseReleased(d)},copyPointerToTargetTouches:function(e){b.pointerTouches[e.pointerId]={clientX:e.clientX,clientY:e.clientY};e.targetTouches=[];for(var d in b.pointerTouches){if(b.pointerTouches.hasOwnProperty(d)){e.targetTouches.push(b.pointerTouches[d])}}}};var a={actionPerformed:function(){if(!b.escaped){if(b.previousView!=null){if(b.previousView===c.controller.getPlanController().getView()){c.controller.getPlanController().stopDraggedItems()}if(b.previousCursor!=null&&typeof b.previousView.setCursor==="function"){b.previousView.setCursor(b.previousCursor)}}b.escaped=true;if(b.draggedImage!=null){document.body.removeChild(b.draggedImage);b.draggedImage=null}}}};this.getActionMap()["EscapeDragFromFurnitureCatalog"]=a;return b};HomePane.prototype.getDropModelLevel=function(a,c){if(a instanceof HomeComponent3D){var e=a;var b=e.getClosestSelectableItemAt(c[0],c[1]);var d=this.home.getSelectedLevel();if(b!=null&&typeof b.isAtLevel==="function"&&!b.isAtLevel(d)){return b.getLevel()}}return this.home.getSelectedLevel()};HomePane.prototype.getDropModelLocation=function(p,g,t,f){var e=[0,0,0];if(p instanceof HomeComponent3D){var d=p;var h=d.getClosestSelectableItemAt(f[0],f[1]);var m=0;if(t!=null){m=t.getElevation()}if(h instanceof HomePieceOfFurniture){e=[h.getX(),h.getY()];if(g.length===1&&g[0] instanceof HomePieceOfFurniture){var q=d.getVirtualWorldPointAt(f[0],f[1],m);var l=this.computeIntersection(q[0],q[1],this.home.getCamera().getX(),this.home.getCamera().getY(),e[0],e[1],e[0]+Math.cos(h.getAngle()),e[1]+Math.sin(h.getAngle()));if(java.awt.geom.Point2D.distance(l[0],l[1],h.getX(),h.getY())<h.getWidth()/2){e=l}var u=g[0];e[0]-=u.getWidth()/2;e[1]-=u.getDepth()/2;var o;if(h instanceof HomeShelfUnit){var r=this.home.getCamera();var j=java.awt.geom.Point2D.distance(q[0],q[1],r.getX(),r.getY());var c=java.awt.geom.Point2D.distance(q[0],q[1],e[0],e[1]);var o=(r.getZ()-(this.home.getSelectedLevel()!==null?this.home.getSelectedLevel().getElevation():0))/j*c}else{if(h.isHorizontallyRotated()){o=h.getElevation()+h.getHeightInPlan()}else{if(h.getDropOnTopElevation()>=0){o=h.getElevation()+h.getHeight()*h.getDropOnTopElevation()}else{o=0}}}e=[e[0],e[1],o]}}else{if(h instanceof Wall&&h.getArcExtent()===null&&g.length===1){var q=d.getVirtualWorldPointAt(f[0],f[1],m);var s=h;var a=s.getPoints();var b=this.computeIntersection(q[0],q[1],this.home.getCamera().getX(),this.home.getCamera().getY(),a[0][0],a[0][1],a[1][0],a[1][1]);var k=this.computeIntersection(q[0],q[1],this.home.getCamera().getX(),this.home.getCamera().getY(),a[3][0],a[3][1],a[2][0],a[2][1]);if(java.awt.geom.Point2D.distanceSq(this.home.getCamera().getX(),this.home.getCamera().getY(),b[0],b[1])<java.awt.geom.Point2D.distanceSq(this.home.getCamera().getX(),this.home.getCamera().getY(),k[0],k[1])){e=b}else{e=k}if(g[0] instanceof HomePieceOfFurniture){var u=g[0];var n=Math.atan((s.getYEnd()-s.getYStart())/(s.getXEnd()-s.getXStart()));e[0]-=u.getWidth()/2*Math.cos(n);e[1]-=u.getWidth()/2*Math.sin(n)}}else{if(!this.home.isEmpty()){e=d.getVirtualWorldPointAt(f[0],f[1],m);e=[e[0],e[1]];if(g.length===1&&g[0] instanceof HomePieceOfFurniture){var u=g[0];e[0]-=u.getWidth()/2;e[1]-=u.getDepth()/2}}}}}return e};HomePane.prototype.computeIntersection=function(p,g,o,f,m,e,k,d){var j=o;var h=f;var n=(f-g)/(o-p);var l=(d-e)/(k-m);if(n!==l){if(Math.abs(n)>4000){if(Math.abs(l)<4000){j=p;var b=d-l*k;h=l*j+b}}else{if(Math.abs(l)>4000){if(Math.abs(n)<4000){j=m;var c=f-n*o;h=n*j+c}}else{var a=n>0&&l>0||n<0&&l<0;if(Math.abs(n-l)>0.00001&&(!a||(Math.abs(n)>Math.abs(l)?n/l:l/n)>1.004)){var c=f-n*o;var b=d-l*k;j=(b-c)/(n-l);h=n*j+c}}}}return[j,h]};HomePane.prototype.detachView=function(a){};HomePane.prototype.attachView=function(a){};HomePane.prototype.showOpenDialog=function(){};HomePane.prototype.showNewHomeFromExampleDialog=function(){};HomePane.prototype.confirmOpenDamagedHome=function(a,c,b){return true};HomePane.prototype.showImportLanguageLibraryDialog=function(){};HomePane.prototype.confirmReplaceLanguageLibrary=function(a){return true};HomePane.prototype.showImportFurnitureLibraryDialog=function(){};HomePane.prototype.confirmReplaceFurnitureLibrary=function(a){return true};HomePane.prototype.showImportTexturesLibraryDialog=function(){};HomePane.prototype.confirmReplaceTexturesLibrary=function(a){return true};HomePane.prototype.confirmReplacePlugin=function(a){return true};HomePane.prototype.showSaveDialog=function(a){return null};HomePane.prototype.showError=function(a){alert(a.indexOf("<html>")<0?a:a.replace(/\<\/?\w+(\s+\w+\=[\"\'][^\"\']+[\"\'])*\>/g," ").replace(/\s+/g," "))};HomePane.prototype.showMessage=function(a){alert(a.indexOf("<html>")<0?a:a.replace(/\<\/?\w+(\s+\w+\=[\"\'][^\"\']+[\"\'])*\>/g," ").replace(/\s+/g," "))};HomePane.prototype.showActionTipMessage=function(a){return false};HomePane.prototype.confirmSave=function(c,b){var d;if(c!=null){d=this.preferences.getLocalizedString("HomePane","confirmSave.message",'"'+c+'"')}else{d=this.preferences.getLocalizedString("HomePane","confirmSave.message"," ")}var e=new JSDialog(this.preferences,this.preferences.getLocalizedString("HomePane","confirmSave.title"),d.replace(/\<br\>/," ")+"</font>",{size:"small",applier:function(){b(true)}});e.findElement(".dialog-ok-button").innerHTML=this.preferences.getLocalizedString("HomePane","confirmSave.save");var f=e.findElement(".dialog-cancel-button");f.innerHTML=this.preferences.getLocalizedString("HomePane","confirmSave.cancel");var a=document.createElement("button");a.innerHTML=this.preferences.getLocalizedString("HomePane","confirmSave.doNotSave");e.registerEventListener(a,"click",function(){e.close();b(false)});f.parentElement.insertBefore(a,f);e.displayView();return HomeView.SaveAnswer.CANCEL};HomePane.prototype.confirmSaveNewerHome=function(a){return true};HomePane.prototype.confirmExit=function(){return true};HomePane.prototype.showAboutDialog=function(){var b=this.preferences.getLocalizedString("HomePane","about.message",this.controller.getVersion());var a="<table><tr><td><img src='"+ZIPTools.getScriptFolder()+this.preferences.getLocalizedString("HomePane","about.icon")+"'></td><td>"+b+"</td></tr></table>";var c=new JSDialog(this.preferences,this.preferences.getLocalizedString("HomePane","about.title"),a,{size:"medium"});c.getHTMLElement().classList.add("about-dialog");c.displayView()};HomePane.prototype.showUpdatesMessage=function(b,a){return false};HomePane.prototype.showPrintDialog=function(){return null};HomePane.prototype.showPrintToPDFDialog=function(a){return null};HomePane.prototype.printToPDF=function(a){};HomePane.prototype.showExportToCSVDialog=function(a){return null};HomePane.prototype.exportToCSV=function(a){};HomePane.prototype.showExportToSVGDialog=function(a){return null};HomePane.prototype.exportToSVG=function(a){};HomePane.prototype.showExportToOBJDialog=function(a){return null};HomePane.prototype.exportToOBJ=function(b,a){};HomePane.prototype.confirmDeleteCatalogSelection=function(){return true};HomePane.prototype.showStoreCameraDialog=function(a){return prompt(this.preferences.getLocalizedString("HomePane","showStoreCameraDialog.message"),a)};HomePane.prototype.showDeletedCamerasDialog=function(){var g=this;var a=this.home.getStoredCameras();function f(){JSDialog.call(this,g.preferences,"@{HomePane.showDeletedCamerasDialog.title}","<div>@{HomePane.confirmDeleteCameras.message}</div>",{applier:function(l){g.controller.getHomeController3D().deleteCameras(l.selectedCameras)}});var h=this;var k=this.findElement(".dialog-cancel-button");this.registerEventListener(k,"click",function(l){h.cancel()});var j=this.findElements(".dialog-ok-button");this.registerEventListener(j,"click",function(l){h.validate()})}f.prototype=Object.create(JSDialog.prototype);f.prototype.constructor=f;f.prototype.appendButtons=function(h){h.innerHTML=JSComponent.substituteWithLocale(this.preferences,"<button class='dialog-cancel-button'>@{HomePane.confirmDeleteCameras.cancel}</button><button class='dialog-ok-button'>@{HomePane.confirmDeleteCameras.delete}</button>")};var d="<div>@{HomePane.showDeletedCamerasDialog.message}</div><br />";for(var c=0;c<a.length;c++){d+="<div><label><input type='checkbox' value='"+c+"' />"+a[c].getName()+"</label></div>"}function e(){JSDialog.call(this,g.preferences,"@{HomePane.showDeletedCamerasDialog.title}",d,{applier:function(k){var n=k.findElements("input[type='checkbox']:checked");var o=[];for(var j=0;j<n.length;j++){var h=parseInt(n[j].value);var l=a[h];o.push(l)}if(o.length>0){var m=new f();m.selectedCameras=o;m.displayView()}}})}e.prototype=Object.create(JSDialog.prototype);e.prototype.constructor=e;var b=new e();b.displayView();return null};HomePane.prototype.isClipboardEmpty=function(){return this.clipboardEmpty};HomePane.prototype.getClipboardItems=function(){return this.clipboard};HomePane.prototype.invokeLater=function(a){setTimeout(a)};HomePane.prototype.dispose=function(){this.setTransferEnabled(false);var k=this.controller.getFurnitureCatalogController().getView();var e=this.controller.getFurnitureController().getView();var f=this.controller.getPlanController().getView();var j=this.controller.getHomeController3D().getView();if(j!=null){j.dispose()}if(f!=null){f.dispose()}if(e!=null){e.dispose()}if(k!=null){k.dispose()}if(this.view3DPopupMenu!=null){document.body.removeChild(this.view3DPopupMenu.getHTMLElement())}if(this.planPopupMenu!=null){document.body.removeChild(this.planPopupMenu.getHTMLElement())}if(this.furniturePopupMenu!=null){document.body.removeChild(this.furniturePopupMenu.getHTMLElement())}if(this.furnitureCatalogPopupMenu!=null){document.body.removeChild(this.furnitureCatalogPopupMenu.getHTMLElement())}if(this.levelSelector){while(this.levelSelector.children.length>0){this.levelSelector.removeChild(this.levelSelector.children[0])}this.levelSelector.removeEventListener("change",this.levelSelectorChangeListener)}document.removeEventListener("keydown",this.keydownListener);window.removeEventListener("resize",this.resizeListener);var d=[this.catalogFurnitureSplitter,this.furniturePlanSplitter,this.plan3DViewSplitter];for(var c=0;c<d.length;c++){var a=d[c];a.element.removeEventListener("mousedown",a.mouseListener.mousePressed,true);a.element.removeEventListener("touchstart",a.mouseListener.mousePressed,true);window.removeEventListener("resize",a.mouseListener.windowResized)}var g=document.getElementById("application-menu-toolbar");if(g!=null){var b=g.children;for(var c=b.length-1;c>=0;c--){g.removeChild(b[c])}}var h=document.getElementById("home-pane-toolbar");b=h.children;for(var c=b.length-1;c>=0;c--){if(this.toolBarDefaultChildren.indexOf(b[c])<0){h.removeChild(b[c])}}this.getHTMLElement().removeEventListener("focusin",this.focusListener);this.preferences.removePropertyChangeListener("VALUE_ADDED_TAX_ENABLED",this.preferencesChangeListener);this.preferences.removePropertyChangeListener("CURRENCY",this.preferencesChangeListener);if(this.furnitureCatalogListener!=null){this.preferences.getFurnitureCatalog().removeFurnitureListener(this.furnitureCatalogListener)}};function ContentDigestManager(){this.contentDigestsCache={};this.permanentContents={}}ModelManager.instance=null;ContentDigestManager.getInstance=function(){if(ContentDigestManager.instance==null){ContentDigestManager.instance=new ContentDigestManager()}return ContentDigestManager.instance};ContentDigestManager.prototype.equals=function(b,a){var c=this.contentDigestsCache[b.getURL()];if(c==null){return false}else{return c===this.contentDigestsCache[a.getURL()]}};ContentDigestManager.prototype.setContentDigest=function(a,b){this.contentDigestsCache[a.getURL()]=b;this.permanentContents[b]=a};ContentDigestManager.prototype.getPermanentContentDigest=function(c){var b=this.contentDigestsCache[c.getURL()];if(b!==undefined){var a=this.permanentContents[b];if(a!==undefined){return a}}return null};ContentDigestManager.prototype.getContentDigest=function(d,c){var b=this.contentDigestsCache[d.getURL()];if(b===undefined){if(d.isJAREntry()){this.getZipContentDigest(d,c)}else{if(d instanceof LocalURLContent){var a=this;d.getBlob({blobReady:function(e){if(e.type==="application/zip"){a.getZipContentDigest(d,c)}else{a.getURLContentDigest(d,c)}},blobError:function(e,f){c.digestError(e,f)}})}else{this.getURLContentDigest(d,c)}}}else{c.digestReady(d,b)}};ContentDigestManager.prototype.getZipContentDigest=function(c,b){var a=this;ZIPTools.getZIP(c.isJAREntry()?c.getJAREntryURL():c.getURL(),false,{zipReady:function(e){try{var m=c.isJAREntry()?c.getJAREntryName():"";var f=c instanceof HomeURLContent?m.indexOf("/"):-1;var o=m.substring(0,f+1);var k=new Uint8Array(0);var j=f>0||!(c instanceof HomeURLContent)?e.file(new RegExp("^"+o+".*")).sort(function(q,p){return q.name===p.name?0:(q.name<p.name?1:-1)}):[e.file(m)];for(var h=j.length-1;h>=0;h--){var n=j[h];if(n.name!==o&&a.isSignificant(n.name)){var d=n.asUint8Array();var g=new Uint8Array(k.length+d.length);g.set(k);g.set(d,k.length);k=g}}a.computeContentDigest(k,function(p){a.contentDigestsCache[c.getURL()]=p;b.digestReady(c,p)})}catch(l){this.zipError(l)}},zipError:function(d){b.digestError(d,d.message)}})};ContentDigestManager.prototype.getURLContentDigest=function(c,b){var a=this;c.getStreamURL({urlReady:function(d){var e=new XMLHttpRequest();e.open("GET",d,true);e.responseType="arraybuffer";e.addEventListener("load",function(){a.computeContentDigest(e.response,function(f){a.contentDigestsCache[c.getURL()]=f;b.digestReady(c,f)})});e.send()},urlError:function(d,e){b.digestError(d,e)}})};ContentDigestManager.prototype.computeContentDigest=function(a,b){var d=window.msCrypto!==undefined?window.msCrypto:window.crypto;var e;try{e=d.subtle.digest("SHA-1",a)}catch(c){e=d.subtle.digest("SHA-256",a)}if(e.then!==undefined){e.then(function(f){b(btoa(String.fromCharCode.apply(null,new Uint8Array(f))))})}else{setTimeout(function(){b(btoa(String.fromCharCode.apply(null,new Uint8Array(e.result))))})}};ContentDigestManager.prototype.isSignificant=function(a){var b=a.toUpperCase();return b!=="LICENSE.TXT"&&b.indexOf("/LICENSE.TXT",b.length-"/LICENSE.TXT".length)===-1};function DefaultFurnitureCatalog(a,c,b){FurnitureCatalog.call(this);this.libraries=[];var g=[];if(c===undefined){this.readDefaultFurnitureCatalogs(a,g)}else{b=c;c=a;if(c!=null){for(var d=0;d<c.length;d++){var f=c[d];var e=CoreTools.loadResourceBundles(f.substring(0,f.lastIndexOf(".json")),Locale.getDefault());this.readFurniture(e,f,b,g)}}}}DefaultFurnitureCatalog.prototype=Object.create(FurnitureCatalog.prototype);DefaultFurnitureCatalog.prototype.constructor=DefaultFurnitureCatalog;DefaultFurnitureCatalog.__class="com.eteks.sweethome3d.io.DefaultFurnitureCatalog";DefaultFurnitureCatalog.furnitureAdditionalKeys={};DefaultFurnitureCatalog.prototype.getLibraries=function(){return this.libraries.slice(0)};DefaultFurnitureCatalog.prototype.readDefaultFurnitureCatalogs=function(a,b){this.readFurnitureCatalog("DefaultFurnitureCatalog",a,b)};DefaultFurnitureCatalog.prototype.readFurnitureCatalog=function(b,a,c){this.readFurniture(a.getResourceBundles(b),null,null,c)};DefaultFurnitureCatalog.prototype.readFurniture=function(c,h,e,d){var f=0;while(true){var b=0;try{b=CoreTools.getStringFromKey(c,this.getKey("ignored",++f))}catch(g){b=null}if(b==null||!this.parseBoolean(b)){var j=b==null?this.readPieceOfFurniture(c,f,h,e):null;if(j==null){break}else{if(j.getId()!=null){if(d.indexOf(j.getId())!==-1){continue}else{d.push(j.getId())}}var a=this.readFurnitureCategory(c,f);this.add(a,j)}}else{this.getContent(c,this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON,f),this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON_DIGEST,f),h,e,false,true);this.getContent(c,this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON,f),this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON_DIGEST,f),h,e,false,true);this.getContent(c,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL,f),this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_DIGEST,f),h,e,false,true)}}};DefaultFurnitureCatalog.prototype.getAdditionalProperties=function(e,b){var f=this.getCatalogAdditionalProperties(e)[b.toString()];if(f!=null){var a={};for(var c in f){var d=f[c];if(d.getType()!==ObjectProperty.Type.CONTENT){a[d.getName()]=CoreTools.getStringFromKey(e,c)}}return a}else{return{}}};DefaultFurnitureCatalog.prototype.getAdditionalContents=function(g,c,f,b){var h=this.getCatalogAdditionalProperties(g)[c.toString()];if(h!=null){var a={};for(var d in h){var e=h[d];if(e.getType()===ObjectProperty.Type.CONTENT){a[e.getName()]=this.getContent(g,d,null,f,b,false,true)}}return a}else{return{}}};DefaultFurnitureCatalog.prototype.getCatalogAdditionalProperties=function(a){var c=CoreTools.getFromMap(DefaultFurnitureCatalog.furnitureAdditionalKeys,a);if(c==null){c={};CoreTools.putToMap(DefaultFurnitureCatalog.furnitureAdditionalKeys,a,c);var m=CoreTools.getKeys(a);for(var e=0;e<m.length;e++){var l=m[e];var d=l.lastIndexOf("#");if(d!==-1&&d+1<l.length){var g=l.indexOf(":",d+1);var b=parseInt(l.substring(d+1,g!=-1?g:l.length).trim());if(!isNaN(b)){var f=l.substring(0,d);if(!this.isDefaultProperty(f)){var j=c[b.toString()];if(j==null){j={};c[b.toString()]=j}var h=null;if(g>0){var k=l.substring(g+1);if(k.length>0){h=ObjectProperty.Type[k];if(h===undefined){h=null}}}j[l]=new ObjectProperty(f,h)}}}}}return c};DefaultFurnitureCatalog.prototype.isDefaultProperty=function(b){try{DefaultFurnitureCatalog.PropertyKey.fromPrefix(b);return true}catch(a){return"ignored"==b}};DefaultFurnitureCatalog.prototype.readPieceOfFurniture=function(E,G,e,d){var u=null;try{u=CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.NAME,G))}catch(R){return null}var J=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.ID,G),null);var v=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DESCRIPTION,G),null);var Z=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.INFORMATION,G),null);var B=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.LICENSE,G),null);var C=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.TAGS,G),null);var D;if(C!=null){D=C.split(/\s*,\s*/)}else{D=[]}var o=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.CREATION_DATE,G),null);var M=null;if(o!=null){try{var r=o.split(/-/);M=new Date(r[0],r[1],r[2]).getTime()}catch(R){throw new IllegalArgumentException("Can't parse date "+o,R)}}var U=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.GRADE,G),null);var K=null;if(U!=null){K=parseFloat(U)}var q=this.getContent(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON,G),this.getKey(DefaultFurnitureCatalog.PropertyKey.ICON_DIGEST,G),e,d,false,false);var k=this.getContent(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON,G),this.getKey(DefaultFurnitureCatalog.PropertyKey.PLAN_ICON_DIGEST,G),e,d,false,true);var V=this.getOptionalBoolean(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.MULTI_PART_MODEL,G),false);var g=this.getContent(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL,G),this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_DIGEST,G),e,d,V,false);var a=parseFloat(CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.WIDTH,G)));var n=parseFloat(CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DEPTH,G)));var f=parseFloat(CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.HEIGHT,G)));var m=this.getOptionalFloat(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.ELEVATION,G),0);var h=this.getOptionalFloat(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DROP_ON_TOP_ELEVATION,G),f)/f;var z=this.parseBoolean(CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.MOVABLE,G)));var L=this.parseBoolean(CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW,G)));var P=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.STAIRCASE_CUT_OUT_SHAPE,G),null);var aa=this.getModelRotation(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_ROTATION,G));var ab=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_FLAGS,G),null);var Y=0;if(ab!=null){Y=parseInt(ab)}var X=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.MODEL_SIZE,G),null);var ad=null;if(X!=null){ad=parseInt(X)}var x=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.CREATOR,G),null);var N=this.getOptionalBoolean(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.RESIZABLE,G),true);var p=this.getOptionalBoolean(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DEFORMABLE,G),true);var l=this.getOptionalBoolean(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.TEXTURABLE,G),true);var t=this.getOptionalBoolean(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.HORIZONTALLY_ROTATABLE,G),true);var F=null;try{F=new Big(CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.PRICE,G)))}catch(R){}var j=null;try{j=new Big(CoreTools.getStringFromKey(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.VALUE_ADDED_TAX_PERCENTAGE,G)))}catch(R){}var W=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.CURRENCY,G),null);var b=this.getAdditionalProperties(E,G);var c=this.getAdditionalContents(E,G,e,d);if(L){var ac=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_CUT_OUT_SHAPE,G),null);var Q=this.getOptionalFloat(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_THICKNESS,G),n)/n;var s=this.getOptionalFloat(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_DISTANCE,G),0)/n;var w=this.getOptionalBoolean(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WALL_CUT_OUT_ON_BOTH_SIDES,G),true);var S=this.getOptionalBoolean(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_WIDTH_DEPTH_DEFORMABLE,G),true);var T=this.getDoorOrWindowSashes(E,G,a,n);return new CatalogDoorOrWindow(J,u,v,Z,B,D,M,K,q,k,g,a,n,f,m,h,z,ac,Q,s,w,S,T,aa,Y,ad,x,N,p,l,F,j,W,b,c)}else{var A=this.getLightSources(E,G,a,n,f);var H=this.getOptionalString(E,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_MATERIAL_NAME,G),null);var I=H!=null?H.split(/ +/):null;if(A!=null||I!=null){return new CatalogLight(J,u,v,Z,B,D,M,K,q,k,g,a,n,f,m,h,z,A,I,P,aa,Y,ad,x,N,p,l,t,F,j,W,b,c)}else{var O=this.getShelfElevations(E,G,f);var y=this.getShelfBoxes(E,G,a,n,f);if(O!=null||y!=null){return new CatalogShelfUnit(J,u,v,Z,B,D,M,K,q,k,g,a,n,f,m,h,O,y,z,P,aa,Y,ad,x,N,p,l,t,F,j,W,b,c)}else{return new CatalogPieceOfFurniture(J,u,v,Z,B,D,M,K,q,k,g,a,n,f,m,h,z,P,aa,Y,ad,x,N,p,l,t,F,j,W,b,c)}}}};DefaultFurnitureCatalog.prototype.readFurnitureCategory=function(c,a){var b=CoreTools.getStringFromKey(c,this.getKey(DefaultFurnitureCatalog.PropertyKey.CATEGORY,a));return new FurnitureCategory(b)};DefaultFurnitureCatalog.prototype.getContent=function(c,a,d,k,l,j,h){var e=h?this.getOptionalString(c,a,null):CoreTools.getStringFromKey(c,a);if(h&&e==null){return null}var b=null;if(l!=null){b=l+e}else{b=e}if(e.indexOf("!/")>=0&&e.indexOf("jar:")!==0){b="jar:"+b}var g=URLContent.fromURL(b);var f=this.getOptionalString(c,d,null);if(f!=null&&f.length>0){ContentDigestManager.getInstance().setContentDigest(g,f)}return g};DefaultFurnitureCatalog.prototype.getModelRotation=function(e,d){try{var a=CoreTools.getStringFromKey(e,d);var b=a.split(/ +/,9);if(b.length===9){return[[parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2])],[parseFloat(b[3]),parseFloat(b[4]),parseFloat(b[5])],[parseFloat(b[6]),parseFloat(b[7]),parseFloat(b[8])]]}else{return null}}catch(c){return null}};DefaultFurnitureCatalog.prototype.getDoorOrWindowSashes=function(d,k,a,f){var e;var l=this.getOptionalString(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_X_AXIS,k),null);if(l!=null){var b=l.split(/ +/);var m=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_Y_AXIS,k)).split(/ +/);if(m.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_Y_AXIS,k)+" key")}var j=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_WIDTH,k)).split(/ +/);if(j.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_WIDTH,k)+" key")}var c=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_START_ANGLE,k)).split(/ +/);if(c.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_START_ANGLE,k)+" key")}var h=CoreTools.getStringFromKey(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_END_ANGLE,k)).split(/ +/);if(h.length!==b.length){throw new IllegalArgumentException("Expected "+b.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.DOOR_OR_WINDOW_SASH_END_ANGLE,k)+" key")}e=new Array(b.length);for(var g=0;g<e.length;g++){e[g]=new Sash(parseFloat(b[g])/a,parseFloat(m[g])/f,parseFloat(j[g])/a,parseFloat(c[g])*Math.PI/180,parseFloat(h[g])*Math.PI/180)}}else{e=[]}return e};DefaultFurnitureCatalog.prototype.getLightSources=function(h,n,c,m,o){var b=null;var p=this.getOptionalString(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_X,n),null);if(p!=null){var g=p.split(/ +/);var f=CoreTools.getStringFromKey(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Y,n)).split(/ +/);if(f.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Y,n)+" key")}var d=CoreTools.getStringFromKey(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Z,n)).split(/ +/);if(d.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_Z,n)+" key")}var k=CoreTools.getStringFromKey(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_COLOR,n)).split(/ +/);if(k.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_COLOR,n)+" key")}var e=this.getOptionalString(h,this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_DIAMETER,n),null);var a=null;if(e!=null){a=e.split(/ +/);if(a.length!==g.length){throw new IllegalArgumentException("Expected "+g.length+" values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.LIGHT_SOURCE_DIAMETER,n)+" key")}}else{a=null}b=new Array(g.length);for(var l=0;l<b.length;l++){var j=k[l].indexOf("#")===0?parseInt(k[l].substring(1),16):parseInt(k[l]);b[l]=new LightSource(parseFloat(g[l])/c,parseFloat(f[l])/m,parseFloat(d[l])/o,j,a!=null?parseFloat(a[l])/c:null)}}return b};DefaultFurnitureCatalog.prototype.getShelfElevations=function(f,c,a){var e=null;var g=this.getOptionalString(f,this.getKey(DefaultFurnitureCatalog.PropertyKey.SHELF_ELEVATIONS,c),null);if(g!=null){var b=g.split(/ +/);e=new Array(b.length);for(var d=0;d<b.length;d++){e[d]=parseFloat(b[d])/a}}return e};DefaultFurnitureCatalog.prototype.getShelfBoxes=function(d,g,a,f,j){var c=null;var b=this.getOptionalString(d,this.getKey(DefaultFurnitureCatalog.PropertyKey.SHELF_BOXES,g),null);if(b!=null){var h=b.split(/ +/);if(h.length%6!=0){throw new IllegalArgumentException("Expected a multiple of 6 values in "+this.getKey(DefaultFurnitureCatalog.PropertyKey.SHELF_BOXES,g)+" key")}else{c=new Array(h.length/6);for(var e=0;e<c.length;e++){c[e]=new BoxBounds(parseFloat(h[e*6])/a,parseFloat(h[e*6+1])/f,parseFloat(h[e*6+2])/j,parseFloat(h[e*6+3])/a,parseFloat(h[e*6+4])/f,parseFloat(h[e*6+5])/j)}}}return c};DefaultFurnitureCatalog.prototype.getOptionalString=function(d,c,a){try{return CoreTools.getStringFromKey(d,c)}catch(b){return a}};DefaultFurnitureCatalog.prototype.getOptionalFloat=function(d,c,a){try{return parseFloat(CoreTools.getStringFromKey(d,c))}catch(b){return a}};DefaultFurnitureCatalog.prototype.getOptionalBoolean=function(d,c,a){try{return this.parseBoolean(CoreTools.getStringFromKey(d,c))}catch(b){return a}};DefaultFurnitureCatalog.prototype.parseBoolean=function(a){return"true"==a};DefaultFurnitureCatalog.prototype.getKey=function(b,a){return b+"#"+a};DefaultFurnitureCatalog.PropertyKey={ID:"id",NAME:"name",DESCRIPTION:"description",INFORMATION:"information",LICENSE:"license",TAGS:"tags",CREATION_DATE:"creationDate",GRADE:"grade",CATEGORY:"category",ICON:"icon",ICON_DIGEST:"iconDigest",PLAN_ICON:"planIcon",PLAN_ICON_DIGEST:"planIconDigest",MODEL:"model",MODEL_SIZE:"modelSize",MODEL_DIGEST:"modelDigest",MULTI_PART_MODEL:"multiPartModel",WIDTH:"width",DEPTH:"depth",HEIGHT:"height",MOVABLE:"movable",DOOR_OR_WINDOW:"doorOrWindow",DOOR_OR_WINDOW_CUT_OUT_SHAPE:"doorOrWindowCutOutShape",DOOR_OR_WINDOW_WALL_THICKNESS:"doorOrWindowWallThickness",DOOR_OR_WINDOW_WALL_DISTANCE:"doorOrWindowWallDistance",DOOR_OR_WINDOW_WALL_CUT_OUT_ON_BOTH_SIDES:"doorOrWindowWallCutOutOnBothSides",DOOR_OR_WINDOW_WIDTH_DEPTH_DEFORMABLE:"doorOrWindowWidthDepthDeformable",DOOR_OR_WINDOW_SASH_X_AXIS:"doorOrWindowSashXAxis",DOOR_OR_WINDOW_SASH_Y_AXIS:"doorOrWindowSashYAxis",DOOR_OR_WINDOW_SASH_WIDTH:"doorOrWindowSashWidth",DOOR_OR_WINDOW_SASH_START_ANGLE:"doorOrWindowSashStartAngle",DOOR_OR_WINDOW_SASH_END_ANGLE:"doorOrWindowSashEndAngle",LIGHT_SOURCE_X:"lightSourceX",LIGHT_SOURCE_Y:"lightSourceY",LIGHT_SOURCE_Z:"lightSourceZ",LIGHT_SOURCE_COLOR:"lightSourceColor",LIGHT_SOURCE_DIAMETER:"lightSourceDiameter",LIGHT_SOURCE_MATERIAL_NAME:"lightSourceMaterialName",STAIRCASE_CUT_OUT_SHAPE:"staircaseCutOutShape",ELEVATION:"elevation",DROP_ON_TOP_ELEVATION:"dropOnTopElevation",SHELF_ELEVATIONS:"shelfElevations",SHELF_BOXES:"shelfBoxes",MODEL_ROTATION:"modelRotation",CREATOR:"creator",RESIZABLE:"resizable",DEFORMABLE:"deformable",TEXTURABLE:"texturable",HORIZONTALLY_ROTATABLE:"horizontallyRotatable",PRICE:"price",VALUE_ADDED_TAX_PERCENTAGE:"valueAddedTaxPercentage",CURRENCY:"currency",getKey:function(b,a){return b+"#"+a},fromPrefix:function(b){for(var a in DefaultFurnitureCatalog.PropertyKey){if(DefaultFurnitureCatalog.PropertyKey[a]==b){return a}}throw new IllegalArgumentException("Unknow prefix "+b)}};function DefaultTexturesCatalog(a,g,f){TexturesCatalog.call(this);this.libraries=[];var e=[];if(g===undefined){this.readDefaultTexturesCatalogs(a,e)}else{f=g;g=a;if(g!=null){for(var c=0;c<g.length;c++){var b=g[c];var d=CoreTools.loadResourceBundles(b.substring(0,b.lastIndexOf(".json")),Locale.getDefault());this.readTextures(d,b,f,e)}}}}DefaultTexturesCatalog.prototype=Object.create(TexturesCatalog.prototype);DefaultTexturesCatalog.prototype.constructor=DefaultTexturesCatalog;DefaultTexturesCatalog.__class="com.eteks.sweethome3d.io.DefaultTexturesCatalog";DefaultTexturesCatalog.texturesAdditionalKeys={};DefaultTexturesCatalog.prototype.getLibraries=function(){return this.libraries.slice(0)};DefaultTexturesCatalog.prototype.readDefaultTexturesCatalogs=function(a,b){this.readTexturesCatalog("DefaultTexturesCatalog",a,b)};DefaultTexturesCatalog.prototype.readTexturesCatalog=function(b,a,c){this.readTextures(a.getResourceBundles(b),null,null,c)};DefaultTexturesCatalog.prototype.readTextures=function(c,j,h,a){var d=0;while(true){var b=0;try{b=CoreTools.getStringFromKey(c,this.getKey("ignored",++d))}catch(g){b=null}if(b==null||"true"!=b){var f=b==null?this.readTexture(c,d,j,h):null;if(f==null){break}else{if(f.getId()!=null){if(a.indexOf(f.getId())!==-1){continue}else{a.push(f.getId())}}var e=this.readTexturesCategory(c,d);this.add(e,f)}}else{this.getContent(c,this.getKey(DefaultTexturesCatalog.PropertyKey.IMAGE,d),this.getKey(DefaultTexturesCatalog.PropertyKey.ICON_DIGEST,d),j,h,true)}}};DefaultTexturesCatalog.prototype.readTexture=function(f,g,k,j){var a=null;try{a=CoreTools.getStringFromKey(f,this.getKey(DefaultTexturesCatalog.PropertyKey.NAME,g))}catch(h){return null}var e=this.getContent(f,this.getKey(DefaultTexturesCatalog.PropertyKey.IMAGE,g),this.getKey(DefaultTexturesCatalog.PropertyKey.IMAGE_DIGEST,g),k,j,false);var c=parseFloat(CoreTools.getStringFromKey(f,this.getKey(DefaultTexturesCatalog.PropertyKey.WIDTH,g)));var l=parseFloat(CoreTools.getStringFromKey(f,this.getKey(DefaultTexturesCatalog.PropertyKey.HEIGHT,g)));var d=this.getOptionalString(f,this.getKey(DefaultTexturesCatalog.PropertyKey.CREATOR,g),null);var b=this.getOptionalString(f,this.getKey(DefaultTexturesCatalog.PropertyKey.ID,g),null);return new CatalogTexture(b,a,e,c,l,d)};DefaultTexturesCatalog.prototype.readTexturesCategory=function(c,a){var b=CoreTools.getStringFromKey(c,this.getKey(DefaultTexturesCatalog.PropertyKey.CATEGORY,a));return new TexturesCategory(b)};DefaultTexturesCatalog.prototype.getContent=function(c,a,d,k,j,h){var e=h?this.getOptionalString(c,a,null):CoreTools.getStringFromKey(c,a);if(h&&e==null){return null}var b=null;if(j!=null){b=j+e}else{b=e}var g=URLContent.fromURL(b);var f=this.getOptionalString(c,d,null);if(f!=null&&f.length>0){ContentDigestManager.getInstance().setContentDigest(g,f)}return g};DefaultTexturesCatalog.prototype.getOptionalString=function(d,c,a){try{return CoreTools.getStringFromKey(d,c)}catch(b){return a}};DefaultTexturesCatalog.prototype.getKey=function(a,b){return a+"#"+b};DefaultTexturesCatalog.PropertyKey={ID:"id",NAME:"name",CATEGORY:"category",IMAGE:"image",IMAGE_DIGEST:"imageDigest",WIDTH:"width",HEIGHT:"height",CREATOR:"creator",getKey:function(a,b){return a+"#"+b}};function FurnitureCatalogListPanel(c,b,d,a){this.container=document.getElementById(c);this.controller=a;this.preferences=d;this.createComponents(b,d,a)}FurnitureCatalogListPanel.prototype.getHTMLElement=function(){return this.container};FurnitureCatalogListPanel.prototype.createComponents=function(g,e,f){var d=this;var k=this.container.getElementsByClassName("furniture-catalog-list")[0];this.catalog=g;this.toolTipDiv=document.createElement("div");this.toolTipDiv.classList.add("furniture-tooltip");this.toolTipDiv.style.display="none";this.toolTipDiv.style.position="absolute";document.body.appendChild(this.toolTipDiv);var a=document.createElement("div");a.id="furniture-filter";this.container.insertBefore(a,k);var b=document.createElement("select");this.categorySelector=b;var o=document.createElement("input");this.searchInput=o;var l=function(){var p=CoreTools.removeAccents(o.value.trim()).replace(/[.*+?^${}()|[\]\\]/g," ");d.filterCatalog(b.selectedIndex,function(q){if(p==""){return true}else{var r=q.getName()+"|"+q.getTags().join("|");if(q.getCreator()!==null){r+="|"+q.getCreator()}return RegExp(p,"i").test(CoreTools.removeAccents(r))}})};b.id="furniture-category-select";var j=document.createElement("option");var n=e.getLocalizedString("FurnitureCatalogListPanel","categoryFilterComboBox.noCategory");j.value=j.text=n;b.appendChild(j);for(var c=0;c<g.getCategories().length;c++){var h=document.createElement("option");h.value=h.text=g.getCategories()[c].getName();b.appendChild(h)}b.addEventListener("change",l);b.addEventListener("mousemove",function(p){d.hideTooltip();p.stopPropagation()});a.appendChild(b);o.setAttribute("type","text");o.id="furniture-search-field";o.placeholder=ResourceAction.getLocalizedLabelText(e,"FurnitureCatalogListPanel","searchLabel.text").replace(":","");o.addEventListener("input",l);o.addEventListener("mousemove",function(p){d.hideTooltip();p.stopPropagation()});k.addEventListener("click",function(q){var p=o.getBoundingClientRect();if(!(q.clientX>=p.left&&q.clientX<=p.right&&q.clientY>=p.top&&q.clientY<=p.bottom)){d.searchInput.blur()}});o.addEventListener("focusin",function(p){o.classList.remove("partly-expanded");if(!o.classList.contains("expanded")){o.classList.add("expanded");setTimeout(function(){if(o.value!=""){o.select()}if(document.body.scrollTop==0){window.scrollTo(0,d.container.getBoundingClientRect().top)}},100)}});o.addEventListener("focusout",function(p){if(o.classList.contains("expanded")){o.classList.remove("expanded");if(o.value.trim()!=""){o.classList.add("partly-expanded")}}});o.addEventListener("keydown",function(p){if(p.keyCode==27){o.value="";var p=document.createEvent("Event");p.initEvent("input",true,true);o.dispatchEvent(p)}p.stopPropagation()});a.appendChild(o);this.resetFurnitureCatalog(g);var m;window.addEventListener("mousemove",function(p){var r=d.container.getBoundingClientRect();var q=p;if((q.clientX>=r.left)&&(q.clientX<r.left+r.width)&&(q.clientY>=r.top)&&(q.clientY<r.top+r.height)){if(d.toolTipDiv.style.display=="none"){if(d.showTooltipTimeout){clearTimeout(d.showTooltipTimeout)}d.showTooltipTimeout=setTimeout(function(){if(d.currentFurnitureContainer!==undefined){m=d.currentFurnitureContainer;d.showTooltip(m,p);if(!d.hideTooltipTimeout){d.hideTooltipTimeout=setTimeout(function(){d.hideTooltip()},3000)}}},1000)}else{if(m!==d.currentFurnitureContainer){m=d.currentFurnitureContainer;d.showTooltip(m,p)}if(d.hideTooltipTimeout){clearTimeout(d.hideTooltipTimeout)}d.hideTooltipTimeout=setTimeout(function(){d.hideTooltip()},3000)}}else{d.currentFurnitureContainer=undefined;d.hideTooltip()}});k.addEventListener("mouseleave",function(p){d.hideTooltip()});this.languageChangeListener=function(q){var p=document.getElementById("furniture-search-field");p.placeholder=ResourceAction.getLocalizedLabelText(e,"FurnitureCatalogListPanel","searchLabel.text").replace(":","");var r=e.getLocalizedString("FurnitureCatalogListPanel","categoryFilterComboBox.noCategory");j.value=j.text=r};e.addPropertyChangeListener("LANGUAGE",this.languageChangeListener);g.addFurnitureListener(function(u){var t=u.getItem().getCategory();var q=g.getCategories();var s=b.childNodes;if(q.indexOf(t)===-1){for(var r=0;r<s.length;r++){if(s[r].value==t.getName()){b.removeChild(s[r]);break}}}else{if(u.getType()===CollectionEvent.Type.ADD){var p=s.length;for(var r=1;r<s.length;r++){if(s[r].value==t.getName()){p=-1;break}else{if(s[r].value>t.getName()){p=r;break}}}if(p>=0){h=document.createElement("option");h.value=h.text=t.getName();if(p===s.length){b.appendChild(h)}else{b.insertBefore(h,s[p])}}}}if(!d.furnitureCatalogUpdater){d.furnitureCatalogUpdater=function(){d.resetFurnitureCatalog(g);delete d.furnitureCatalogUpdater};setTimeout(d.furnitureCatalogUpdater,0)}})};FurnitureCatalogListPanel.prototype.findCategoryElements=function(c){var d=[];var a=this.container.getElementsByClassName("furniture-catalog-list")[0];for(var b=0;b<a.childNodes.length;b++){if(a.childNodes[b].category===c){d.push(a.childNodes[b])}}return d};FurnitureCatalogListPanel.prototype.filterCatalog=function(h,c){var b=this.container.getElementsByClassName("furniture-catalog-list")[0];for(var d=0;d<b.childNodes.length;d++){if(b.childNodes[d] instanceof HTMLElement&&b.childNodes[d].id!=="furniture-filter"){if(b.childNodes[d]._displayBackup===undefined){b.childNodes[d]._displayBackup=b.childNodes[d].style.display}b.childNodes[d].style.display="none"}}var a=h==null||h===0?this.catalog.getCategories():[this.catalog.getCategories()[h-1]];for(var d=0;d<a.length;d++){var e=a[d];var g=c==null?e.getFurniture():e.getFurniture().filter(c);if(g!=null&&g.length>0){var f=this.findCategoryElements(e);f.forEach(function(j){if(a.length>1&&(j.classList.contains("furniture-category-label")||j.classList.contains("furniture-category-separator"))){j.style.display=j._displayBackup}if(j.piece&&g.indexOf(j.piece)!==-1){j.style.display=j._displayBackup}})}}};FurnitureCatalogListPanel.prototype.clearFurnitureCatalog=function(a){var b=this.container.getElementsByClassName("furniture-catalog-list")[0];var d=b.getElementsByClassName("furniture-category-label");for(var c=d.length-1;c>=0;c--){b.removeChild(d[c])}d=b.getElementsByClassName("furniture");for(var c=d.length-1;c>=0;c--){b.removeChild(d[c])}d=b.getElementsByClassName("furniture-category-separator");for(var c=d.length-1;c>=0;c--){b.removeChild(d[c])}};FurnitureCatalogListPanel.prototype.resetFurnitureCatalog=function(f){this.clearFurnitureCatalog();var h=this.container.getElementsByClassName("furniture-catalog-list")[0];for(var e=0;e<f.getCategoriesCount();e++){var b=f.getCategories()[e];var a=document.createElement("div");a.className="furniture-category-label";a.innerHTML=b.getName();a.category=b;h.appendChild(a);for(var d=0;d<b.getFurnitureCount();d++){var k=b.getFurniture()[d];var g=document.createElement("div");g.pieceOfFurniture=k;g.className="furniture";g.innerHTML='<div class="furniture-label">'+k.getName()+"</div>";h.appendChild(g);this.createPieceOfFurniturePanel(g,k);g.category=b;g.piece=k}if(e<f.getCategoriesCount()-1){var c=document.createElement("div");c.className="furniture-category-separator";c.category=b;h.appendChild(c)}}};FurnitureCatalogListPanel.prototype.createPieceOfFurniturePanel=function(e,b){var d=this;e.addEventListener("mousemove",function(f){d.currentFurnitureContainer=e});e.addEventListener("mousedown",function(h){if(h.button===0){var g=d.container.querySelectorAll(".furniture");for(var f=0;f<g.length;f++){g[f].classList.remove("selected")}e.classList.add("selected");d.controller.setSelectedFurniture([b]);d.hideTooltip()}});var a=function(j){var f=e.getBoundingClientRect();if(j.touches.length===0&&j.changedTouches.length===1&&j.changedTouches[0].clientX>=f.left&&j.changedTouches[0].clientX<f.left+f.width&&j.changedTouches[0].clientY>=f.top&&j.changedTouches[0].clientY<f.top+f.height){var h=d.container.querySelectorAll(".furniture");for(var g=0;g<h.length;g++){h[g].classList.remove("selected")}e.classList.add("selected");d.container.focus();d.controller.setSelectedFurniture([b])}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){e.addEventListener("pointerup",function(f){if(f.pointerType!="mouse"){f.touches=[];f.changedTouches=[{clientX:f.clientX,clientY:f.clientY}];a(f);f.preventDefault()}});e.addEventListener("pointerdown",function(f){if(f.pointerType!="mouse"){f.preventDefault()}});var c=function(f){f.preventDefault()};e.addEventListener("mousedown",c)}else{e.addEventListener("touchend",a)}TextureManager.getInstance().loadTexture(b.icon,{textureUpdated:function(f){f.classList.add("furniture-icon");e.appendChild(f)},textureError:function(f){console.log("Image cannot be loaded",f)}})};FurnitureCatalogListPanel.prototype.showTooltip=function(e,c){var d=e.querySelector("img.furniture-icon");if(d!==null){this.toolTipDiv.style.left=(c.clientX+10)+"px";this.toolTipDiv.style.top=(c.clientY+10)+"px";this.toolTipDiv.style.display="block";this.toolTipDiv.innerHTML=this.createCatalogItemTooltipText(e.pieceOfFurniture);var b=this.toolTipDiv.querySelector("img");b.src=d.src;var a=this.toolTipDiv.getBoundingClientRect();if(a.x<0){this.toolTipDiv.style.left=(c.clientX+10-a.x)+"px"}if(a.y<0){this.toolTipDiv.style.left=(c.clientY+10-a.y)+"px"}if(a.x+Math.max(150,a.width)>window.innerWidth){this.toolTipDiv.style.left=(window.innerWidth-Math.max(150,a.width))+"px"}if(a.y+a.height>window.innerHeight){this.toolTipDiv.style.top=(window.innerHeight-a.height)+"px"}}else{this.hideTooltip()}};FurnitureCatalogListPanel.prototype.hideTooltip=function(){if(this.hideTooltipTimeout){clearTimeout(this.hideTooltipTimeout);this.hideTooltipTimeout=undefined}if(this.showTooltipTimeout){clearTimeout(this.showTooltipTimeout);this.showTooltipTimeout=undefined}if(this.toolTipDiv.style.display!="none"){this.toolTipDiv.style.display="none"}};FurnitureCatalogListPanel.prototype.createCatalogItemTooltipText=function(d){if(this.preferences!=null){var c=d.getCreator();var g=null;if(c!=null&&c.length>0){g=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipCreator",c)}var f=this.preferences.getLengthUnit().getFormatWithUnit();var b=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipPieceOfFurnitureDimensions",f.format(d.getWidth()),f.format(d.getDepth()),f.format(d.getHeight()));var e=null;if(d.getModelSize()!=null&&d.getModelSize()>0){e=this.preferences.getLocalizedString("CatalogItemToolTip","tooltipModelSize",Math.max(1,Math.round(d.getModelSize()/1000)))}}var a="<center>";a+="- <b>"+d.getCategory().getName()+"</b> -<br>";a+="<b>"+d.getName()+"</b>";if(b!=null){a+="<br>"+b}if(e!=null){a+="<br>"+e}if(g!=null){a+="<br>"+g}a+="<br/><img height='100px'/>";a+="</center>";return a};FurnitureCatalogListPanel.prototype.dispose=function(){this.preferences.removePropertyChangeListener("LANGUAGE",this.languageChangeListener);this.clearFurnitureCatalog();this.container.removeChild(document.getElementById("furniture-filter"));this.toolTipDiv.parentElement.removeChild(this.toolTipDiv)};function FurnitureTablePanel(b,d,c,a){this.container=document.getElementById(b);this.preferences=c;this.controller=a;this.defaultDecimalFormat=new DecimalFormat();this.integerFormat=new IntegerFormat();this.treeTable=new JSTreeTable(this.container,this.preferences,this.createTableModel(d));this.addHomeListeners(d);this.addUserPreferencesListeners(d);this.updateData(d)}FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY="com.eteks.sweethome3d.SweetHome3D.ExpandedGroups";FurnitureTablePanel.prototype.getHTMLElement=function(){return this.container};FurnitureTablePanel.prototype.addHomeListeners=function(k){var a=this;var d=this.treeTable;k.addSelectionListener({selectionChanged:function(j){d.setSelectedRowsByValue(k.getSelectedItems())}});var l=function(){d.setModel(a.createTableModel(k))};k.addPropertyChangeListener("FURNITURE_SORTED_PROPERTY",l);k.addPropertyChangeListener("FURNITURE_DESCENDING_SORTED",l);k.addPropertyChangeListener("FURNITURE_VISIBLE_PROPERTIES",l);var b=function(j){a.updatePieceOfFurnitureData(k,j.getSource(),j.getPropertyName())};var h=k.getFurniture();for(var f=0;f<h.length;f++){var n=h[f];n.addPropertyChangeListener(b);if(n instanceof HomeFurnitureGroup){var c=n.getAllFurniture();for(var e=0;e<c.length;e++){c[e].addPropertyChangeListener(b)}}}k.addFurnitureListener(function(r){a.updateData(k);var q=r.getItem();if(r.getType()==CollectionEvent.Type.ADD){q.addPropertyChangeListener(b);if(q instanceof HomeFurnitureGroup){var p=q.getAllFurniture();for(var o=0;o<p.length;o++){p[o].addPropertyChangeListener(b)}}}else{q.removePropertyChangeListener(b);if(q instanceof HomeFurnitureGroup){var p=q.getAllFurniture();for(var o=0;o<p.length;o++){p[o].removePropertyChangeListener(b)}}}});var g=function(){a.updateData(k)};var m=k.getLevels();for(var f=0;f<m.length;f++){m[f].addPropertyChangeListener(g)}k.addLevelsListener(function(j){if(j.getType()==CollectionEvent.Type.ADD){j.getItem().addPropertyChangeListener(g)}else{j.getItem().removePropertyChangeListener(g)}})};FurnitureTablePanel.prototype.addUserPreferencesListeners=function(b){var a=this;this.preferencesListener=function(c){if(c.getPropertyName()=="UNIT"||c.getPropertyName()=="LANGUAGE"){a.treeTable.setModel(a.createTableModel(b))}};this.preferences.addPropertyChangeListener(this.preferencesListener)};FurnitureTablePanel.prototype.createTableModel=function(h){var d={CATALOG_ID:{name:"CATALOG_ID",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","catalogIdColumn"),defaultWidth:"4rem"},NAME:{name:"NAME",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","nameColumn"),defaultWidth:"14rem"},DESCRIPTION:{name:"DESCRIPTION",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","descriptionColumn"),defaultWidth:"14rem"},WIDTH:{name:"WIDTH",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","widthColumn")},DEPTH:{name:"DEPTH",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","depthColumn")},HEIGHT:{name:"HEIGHT",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","heightColumn")},MOVABLE:{name:"MOVABLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","movableColumn")},DOOR_OR_WINDOW:{name:"DOOR_OR_WINDOW",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","doorOrWindowColumn")},COLOR:{name:"COLOR",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","colorColumn")},TEXTURE:{name:"TEXTURE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","textureColumn")},VISIBLE:{name:"VISIBLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","visibleColumn")},X:{name:"X",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","xColumn")},Y:{name:"Y",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","yColumn")},ELEVATION:{name:"ELEVATION",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","elevationColumn")},ANGLE:{name:"ANGLE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","angleColumn")},MODEL_SIZE:{name:"MODEL_SIZE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","modelSizeColumn")},CREATOR:{name:"CREATOR",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","creatorColumn")},LICENSE:{name:"LICENSE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","licenseColumn"),defaultWidth:"5rem"},PRICE:{name:"PRICE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","priceColumn")},VALUE_ADDED_TAX:{name:"VALUE_ADDED_TAX",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","valueAddedTaxColumn")},VALUE_ADDED_TAX_PERCENTAGE:{name:"VALUE_ADDED_TAX_PERCENTAGE",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","valueAddedTaxPercentageColumn")},PRICE_VALUE_ADDED_TAX_INCLUDED:{name:"PRICE_VALUE_ADDED_TAX_INCLUDED",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","priceValueAddedTaxIncludedColumn")},LEVEL:{name:"LEVEL",label:ResourceAction.getLocalizedLabelText(this.preferences,"FurnitureTable","levelColumn")}};var m=[];var e=h.getFurnitureVisibleProperties();for(var g=0;g<e.length;g++){for(var f in d){if(e[g]==d[f].name){m.push(d[f])}}}var l=[];if(h.getVersion()>=5000){var c=h.getProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY);if(c!=null){l=[];var b=c.split(",");for(var g=0;g<b.length;g++){var k=parseInt(b[g]);if(!isNaN(k)){l.push(k)}}}}var a=this;return{columns:m,renderCell:function(o,n,j){return a.renderCell(o,n,j)},getValueComparator:function(j){if(j.columnName!=null){var n=HomePieceOfFurniture.getFurnitureComparator(j.columnName);if(j.direction=="desc"){return function(p,o){return n(o,p)}}else{return n}}else{return null}},selectionChanged:function(j){if(a.controller!==null){a.controller.setSelectedFurniture(j,false)}},rowDoubleClicked:function(j){if(a.controller!==null){a.controller.modifySelectedFurniture(j)}},expandedRowsChanged:function(n,j){if(a.controller!==null){a.storeExpandedRows(j,h,a.controller)}},sortChanged:function(j){if(a.controller!==null){a.controller.sortFurniture(j.columnName)}},initialState:{visibleColumnNames:e,sort:{columnName:h.getFurnitureSortedProperty(),direction:h.isFurnitureDescendingSorted()?"desc":"asc"},expandedRowsIndices:l}}};FurnitureTablePanel.prototype.updateData=function(c){var a=[];var b=function(h,f){for(var e=0;e<h.length;e++){var g=h[e];var d={value:g};if(g instanceof HomeFurnitureGroup){d.children=[];b(g.getFurniture(),d.children)}f.push(d)}};b(c.getFurniture(),a);this.treeTable.setData(a)};FurnitureTablePanel.prototype.updatePieceOfFurnitureData=function(e,c,b){this.treeTable.updateRowData(c,b);var a=this;var d=function(j,f){for(var g=0;g<j.length;g++){if(j[g]===c){return true}else{if(j[g] instanceof HomeFurnitureGroup){var h=d(j[g].getFurniture(),f);if(h){a.treeTable.updateRowData(j[g],f)}return h}}}return false};if(b===undefined){d(e.getFurniture(),b)}if(b=="PRICE"||b=="VALUE_ADDED_TAX_PERCENTAGE"){d(e.getFurniture(),b);this.treeTable.updateRowData(c,"PRICE_VALUE_ADDED_TAX_INCLUDED");d(e.getFurniture(),"PRICE_VALUE_ADDED_TAX_INCLUDED")}if(b=="VALUE_ADDED_TAX_PERCENTAGE"){d(e.getFurniture(),b);this.treeTable.updateRowData(c,"VALUE_ADDED_TAX");d(e.getFurniture(),"VALUE_ADDED_TAX")}if(b=="CURRENCY"){this.treeTable.updateRowData(c,"PRICE");d(e.getFurniture(),"PRICE");this.treeTable.updateRowData(c,"PRICE_VALUE_ADDED_TAX_INCLUDED");d(e.getFurniture(),"PRICE_VALUE_ADDED_TAX_INCLUDED")}};FurnitureTablePanel.prototype.isRootPieceOfFurniture=function(c){var b=this.treeTable.getData();for(var a=0;a<b.length;a++){if(b[a].value==c){return true}}return false};FurnitureTablePanel.prototype.renderNumberCellValue=function(b,a,c){if(!c){c=this.defaultDecimalFormat}var d="";if(b!=null){d=c.format(b)}a.innerHTML=d;a.classList.add("number")};FurnitureTablePanel.prototype.renderSizeCellValue=function(b,a){this.renderNumberCellValue(b,a,this.preferences.getLengthUnit().getFormat())};FurnitureTablePanel.prototype.renderNameCell=function(f,a){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("main","name");var e=document.createElement("span");e.setAttribute("icon",true);var d=f instanceof HomeFurnitureGroup?new URLContent(ZIPTools.getScriptFolder()+"resources/groupIcon.png"):f.getIcon();if(d!=null){TextureManager.getInstance().loadTexture(d,0,false,{textureUpdated:function(g){e.appendChild(g.cloneNode())},textureError:function(g){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}})}else{var b=document.createElement("img");b.width=15;e.appendChild(b)}a.appendChild(e);var c=document.createElement("span");c.textContent=f.getName();a.appendChild(c)};FurnitureTablePanel.prototype.renderColorCell=function(c,a){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("color");if(c.getColor()!=null){var b=document.createElement("div");b.style.backgroundColor=ColorTools.integerToHexadecimalString(c.getColor());a.appendChild(b)}else{a.textContent="-"}};FurnitureTablePanel.prototype.renderTextureCell=function(b,a){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("texture");if(b.getTexture()!=null){var c=document.createElement("div");TextureManager.getInstance().loadTexture(b.getTexture().getImage(),0,false,{textureUpdated:function(d){c.style.backgroundImage="url('"+d.src+"')"},textureError:function(d){return this.textureUpdated(TextureManager.getInstance().getErrorImage())}});a.appendChild(c)}};FurnitureTablePanel.prototype.renderBooleanCell=function(e,a,c,b){while(a.firstChild){a.removeChild(a.firstChild)}a.classList.add("boolean");var d=document.createElement("input");d.type="checkbox";d.disabled=c!==true;d.checked=e===true;d.tabIndex=-1;if(b!==undefined){d.addEventListener("click",function(f){b(d.checked)},true)}a.appendChild(d)};FurnitureTablePanel.prototype.renderPriceCellValue=function(d,e,a){var b=d.getCurrency()==null?this.preferences.getCurrency():d.getCurrency();var c=NumberFormat.getCurrencyInstance();c.setCurrency(b);this.renderNumberCellValue(this.bigToNumber(e),a,c)};FurnitureTablePanel.prototype.bigToNumber=function(a){return a==null?null:parseFloat(a.valueOf())};FurnitureTablePanel.prototype.renderCreatorCell=function(k,h){var a=k.getCreator();if(a!=null){var e=k.getTexture();if(e!=null){var b=e.getCreator();if(b!=null&&a!=b){a+=", "+b}}else{var f=a;var j=k.getModelMaterials();if(j!=null){for(var c=0;c<j.length;c++){var d=j[c];if(d!=null){var g=d.getTexture();if(g!=null){var b=g.getCreator();if(b!=null&&f!=b&&a.indexOf(", "+b)==-1){a+=", "+b}}}}}}}h.textContent=a};FurnitureTablePanel.prototype.renderTextCell=function(b,a){a.textContent=b};FurnitureTablePanel.prototype.renderCell=function(d,c,a){switch(c){case"CATALOG_ID":return this.renderTextCell(d.getCatalogId(),a);case"NAME":return this.renderNameCell(d,a);case"DESCRIPTION":return this.renderTextCell(d.getDescription(),a);case"CREATOR":return this.renderCreatorCell(d,a);case"LICENSE":return this.renderTextCell(d.getLicense(),a);case"WIDTH":return this.renderSizeCellValue(d.getWidth(),a);case"DEPTH":return this.renderSizeCellValue(d.getDepth(),a);case"HEIGHT":return this.renderSizeCellValue(d.getHeight(),a);case"X":return this.renderSizeCellValue(d.getX(),a);case"Y":return this.renderSizeCellValue(d.getY(),a);case"ELEVATION":return this.renderSizeCellValue(d.getElevation(),a);case"ANGLE":var e=Math.round(Math.toDegrees(d.getAngle())+360)%360;return this.renderNumberCellValue(e,a,this.integerFormat);case"LEVEL":a.textContent=d!=null&&d.getLevel()!=null?d.getLevel().getName():"";break;case"MODEL_SIZE":var e=d!=null&&d.getModelSize()!=null&&d.getModelSize()>0?Math.max(1,Math.round(d.getModelSize()/1000)):null;return this.renderNumberCellValue(e,a,this.integerFormat);case"COLOR":return this.renderColorCell(d,a);case"TEXTURE":return this.renderTextureCell(d,a);case"MOVABLE":return this.renderBooleanCell(d.isMovable(),a);case"DOOR_OR_WINDOW":return this.renderBooleanCell(d.isDoorOrWindow(),a);case"VISIBLE":var b=this.controller;return this.renderBooleanCell(d.isVisible(),a,this.isRootPieceOfFurniture(d),function(f){if(b!==null){b.toggleSelectedFurnitureVisibility()}});case"PRICE":return this.renderPriceCellValue(d,d.getPrice(),a);case"VALUE_ADDED_TAX_PERCENTAGE":return this.renderNumberCellValue(d.getValueAddedTaxPercentage()!==null?this.bigToNumber(d.getValueAddedTaxPercentage())*100:null,a);case"VALUE_ADDED_TAX":return this.renderPriceCellValue(d,d.getValueAddedTax(),a);case"PRICE_VALUE_ADDED_TAX_INCLUDED":return this.renderPriceCellValue(d,d.getPriceValueAddedTaxIncluded(),a);default:a.textContent="-";break}};FurnitureTablePanel.prototype.storeExpandedRows=function(c,d,b){var a=c.join(",");if(d.getProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY)!=null||a.length>0){b.setHomeProperty(FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY,a)}};FurnitureTablePanel.prototype.dispose=function(){this.treeTable.dispose();this.preferences.removePropertyChangeListener(this.preferencesListener)};function JSComponent(a,c,d){this.preferences=a;if(c instanceof HTMLElement&&d===true){this.container=c}else{var b="";if(c!=null){b=typeof c=="string"?c:c.innerHTML}this.container=document.createElement("div");this.container.innerHTML=this.buildHtmlFromTemplate(b)}}JSComponent.prototype.getHTMLElement=function(){return this.container};JSComponent.prototype.getUserPreferences=function(){return this.preferences};JSComponent.isElementContained=function(b,c){if(b==null||c==null){return false}var a=b;do{if(a==c){return true}}while(a=a.parentElement);return false};JSComponent.substituteWithLocale=function(a,b){return b.replace(/\@\{([a-zA-Z0-9_.]+)\}/g,function(c,d){return ResourceAction.getLocalizedLabelText(a,d.substring(0,d.indexOf(".")),d.substring(d.indexOf(".")+1))})};JSComponent.prototype.buildHtmlFromTemplate=function(a){return JSComponent.substituteWithLocale(this.preferences,a)};JSComponent.prototype.getLocalizedLabelText=function(a,b,c){return ResourceAction.getLocalizedLabelText(this.preferences,a,b,c)};JSComponent.prototype.attachChildComponent=function(b,a){this.getElement(b).appendChild(a.getHTMLElement())};JSComponent.prototype.registerEventListener=function(e,a,d){if(e==null){return}if(e instanceof NodeList||e instanceof HTMLCollection){var f=new Array(e.length);for(var c=0;c<e.length;c++){f[c]=e[c]}e=f}if(!Array.isArray(e)){e=[e]}if(this.listeners==null){this.listeners=[]}for(var c=0;c<e.length;c++){var b=e[c];b.addEventListener(a,d,false)}this.listeners.push({listener:d,eventName:a,elements:e})};JSComponent.prototype.registerPropertyChangeListener=function(b,a,c){b.addPropertyChangeListener(a,c);this.listeners.push({listener:c,propertyName:a,object:b})};JSComponent.prototype.unregisterEventListeners=function(){if(Array.isArray(this.listeners)){for(var d=0;d<this.listeners.length;d++){var a=this.listeners[d];if(a.eventName!==undefined){for(var b=0;b<a.elements.length;b++){var c=a.elements[b];c.removeEventListener(a.eventName,a.listener)}}else{a.object.removePropertyChangeListener(a.propertyName,a.listener)}}}};JSComponent.prototype.getElement=function(a){var b=this.container.querySelector("[name='"+a+"']");if(b==null){b=this.container.querySelector("[data-name='"+a+"']")}return b};JSComponent.prototype.findElement=function(a){return this.container.querySelector(a)};JSComponent.prototype.findElements=function(a){return this.container.querySelectorAll(a)};JSComponent.prototype.dispose=function(){this.unregisterEventListeners()};JSComponent.createOptionElement=function(c,d,b){var a=document.createElement("option");a.value=c;a.textContent=d;if(b!==undefined){a.selected=b}return a};function JSDialog(a,e,c,d){JSComponent.call(this,a,c,d);var b=this;if(d!=null){this.applier=d.applier;this.disposer=d.disposer}this.getHTMLElement().classList.add("dialog-container");if(d.size){this.getHTMLElement().classList.add(d.size)}this.getHTMLElement()._dialogBoxInstance=this;document.body.appendChild(this.getHTMLElement());if(e!=null){this.setTitle(e)}this.registerEventListener(this.getCloseButton(),"click",function(){b.cancel()});this.registerEventListener(this.getHTMLElement(),"mousedown",function(f){f.stopPropagation()});this.buttonsPanel=this.findElement(".dialog-buttons");if(OperatingSystem.isMacOSX()){this.buttonsPanel.classList.add("mac")}this.appendButtons(this.buttonsPanel);this.getHTMLElement().classList.add("buttons-"+this.buttonsPanel.querySelectorAll("button").length)}JSDialog.prototype=Object.create(JSComponent.prototype);JSDialog.prototype.constructor=JSDialog;JSDialog.prototype.appendButtons=function(a){var c;if(this.applier){c="<button class='dialog-ok-button default-capable'>@{OptionPane.okButton.textAndMnemonic}</button><button class='dialog-cancel-button'>@{OptionPane.cancelButton.textAndMnemonic}</button>"}else{c="<button class='dialog-cancel-button default-capable'>@{InternalFrameTitlePane.closeButtonAccessibleName}</button>"}a.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),c);var b=this;var d=this.findElement(".dialog-cancel-button");if(d){this.registerEventListener(d,"click",function(f){b.cancel()})}var e=this.findElement(".dialog-ok-button");if(e){this.registerEventListener(e,"click",function(f){b.validate()})}};JSDialog.closeTopMostDialog=function(){var a=JSDialog.getTopMostDialog();if(a!=null){a.close()}};JSDialog.getTopMostDialog=function(){var d=document.querySelectorAll(".dialog-container.visible");var a=null;if(d.length>0){for(var b=0;b<d.length;b++){var c=d[b]._dialogBoxInstance;if(a==null||a.displayIndex<=c.displayIndex){a=c}}}return a};JSDialog.prototype.buildHtmlFromTemplate=function(a){return JSComponent.substituteWithLocale(this.getUserPreferences(),'<div class="dialog-content">  <div class="dialog-top">    <span class="title"></span>    <span class="dialog-close-button">&times;</span>  </div>  <div class="dialog-body">'+JSComponent.prototype.buildHtmlFromTemplate.call(this,a)+'  </div>  <div class="dialog-buttons">  </div></div>')};JSDialog.prototype.getInput=function(a){return this.getHTMLElement().querySelector("[name='"+a+"']")};JSDialog.prototype.getCloseButton=function(){return this.getHTMLElement().querySelector(".dialog-close-button")};JSDialog.prototype.validate=function(){if(this.applier!=null){this.applier(this)}this.close()};JSDialog.prototype.cancel=function(){this.close()};JSDialog.prototype.close=function(){this.getHTMLElement().classList.add("closing");var a=this;setTimeout(function(){a.getHTMLElement().classList.remove("visible");a.dispose();if(a.getHTMLElement()&&document.body.contains(a.getHTMLElement())){document.body.removeChild(a.getHTMLElement())}},500)};JSDialog.prototype.dispose=function(){JSComponent.prototype.dispose.call(this);if(typeof this.disposer=="function"){this.disposer(this)}};JSDialog.prototype.setTitle=function(b){var a=this.findElement(".dialog-top .title");a.textContent=JSComponent.substituteWithLocale(this.getUserPreferences(),b||"")};JSDialog.prototype.isDisplayed=function(){return this.getHTMLElement().classList.contains("visible")};JSDialog.prototype.displayView=function(b){var a=this;this.getHTMLElement().style.display="block";setTimeout(function(){a.getHTMLElement().classList.add("visible");a.displayIndex=JSDialog.shownDialogsCounter++;var c=a.findElements("input");for(var d=0;d<c.length;d++){var e=c[d];if(!e.classList.contains("not-focusable-at-opening")){e.focus();break}}},100)};JSDialog.shownDialogsCounter=0;function JSWizardDialog(b,a,e,d){JSDialog.call(this,b,e,'<div class="wizard">  <div stepIcon><div></div></div>  <div stepView></div></div>',d);this.getHTMLElement().classList.add("wizard-dialog");this.controller=a;this.stepIconPanel=this.findElement("[stepIcon]");this.stepViewPanel=this.findElement("[stepView]");var c=this;this.cancelButton=this.findElement(".wizard-cancel-button");this.backButton=this.findElement(".wizard-back-button");this.nextButton=this.findElement(".wizard-next-button");this.registerEventListener(this.cancelButton,"click",function(f){c.cancel()});this.backButton.disabled=!a.isBackStepEnabled();this.registerPropertyChangeListener(a,"BACK_STEP_ENABLED",function(f){c.backButton.disabled=!a.isBackStepEnabled()});this.nextButton.disabled=!a.isNextStepEnabled();this.registerPropertyChangeListener(a,"NEXT_STEP_ENABLED",function(f){c.nextButton.disabled=!a.isNextStepEnabled()});this.updateNextButtonText();this.registerPropertyChangeListener(a,"LAST_STEP",function(f){c.updateNextButtonText()});this.registerEventListener(this.backButton,"click",function(f){a.goBackToPreviousStep()});this.registerEventListener(this.nextButton,"click",function(f){if(a.isLastStep()){a.finish();if(c!=null){c.validate()}}else{a.goToNextStep()}});this.updateStepView();this.registerPropertyChangeListener(a,"STEP_VIEW",function(f){c.updateStepView()});this.updateStepIcon();this.registerPropertyChangeListener(a,"STEP_ICON",function(f){c.updateStepIcon()});this.registerPropertyChangeListener(a,"TITLE",function(f){c.setTitle(a.getTitle())})}JSWizardDialog.prototype=Object.create(JSDialog.prototype);JSWizardDialog.prototype.constructor=JSWizardDialog;JSWizardDialog.prototype.appendButtons=function(a){var e="<button class='wizard-cancel-button'>@{InternalFrameTitlePane.closeButtonAccessibleName}</button>";var b="<button class='wizard-back-button'>@{WizardPane.backOptionButton.text}</button>";var d="<button class='wizard-next-button default-capable'></button>";var c="<div class='dialog-buttons'>"+(OperatingSystem.isMacOSX()?d+b:b+d)+e+"</div>";a.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),c)};JSWizardDialog.prototype.updateNextButtonText=function(){this.nextButton.innerText=this.getLocalizedLabelText("WizardPane",this.controller.isLastStep()?"finishOptionButton.text":"nextOptionButton.text")};JSWizardDialog.prototype.updateStepView=function(){var a=this.controller.getStepView();this.stepViewPanel.innerHTML="";this.stepViewPanel.appendChild(a.getHTMLElement())};JSWizardDialog.prototype.updateStepIcon=function(){var e=this.stepIconPanel;var h=this.stepIconPanel.querySelector("div");h.innerHTML="";var f=this.controller.getStepIcon();if(f!=null){var b="rgb(163, 168, 226)";var a="rgb(80, 86, 158)";try{var k=this.getLocalizedLabelText("WizardPane","stepIconBackgroundColors").trim().split(" ");b=k[0];if(k.length==1){a=b}else{if(k.length==2){a=k[1]}}}catch(g){}var d=b;var c=a;e.style.background="linear-gradient(180deg, "+d+" 0%, "+c+" 100%)";e.style.border="solid 1px #333333";var j=new Image();j.crossOrigin="anonymous";h.appendChild(j);j.src=f.indexOf("://")===-1?ZIPTools.getScriptFolder()+f:f}};function JSImageResizingDialog(e,h,l,f,d,k,j,a){this.cancelButtonMessage=JSComponent.substituteWithLocale(e,f);this.keepUnchangedButtonMessage=JSComponent.substituteWithLocale(e,d);this.okButtonMessage=JSComponent.substituteWithLocale(e,k);JSDialog.call(this,e,JSComponent.substituteWithLocale(e,h),"<div>"+JSComponent.substituteWithLocale(e,l).replace("<br>"," ")+"</div>",{applier:function(m){if(m.resizeRequested){j()}else{a()}}});var g=this;var c=this.findElement(".dialog-cancel-button");this.registerEventListener(c,"click",function(m){g.cancel()});var b=this.findElements(".dialog-ok-button");this.registerEventListener(b,"click",function(m){g.resizeRequested=!m.target.classList.contains("keep-image-unchanged-button");g.validate()})}JSImageResizingDialog.prototype=Object.create(JSDialog.prototype);JSImageResizingDialog.prototype.constructor=JSImageResizingDialog;JSImageResizingDialog.prototype.appendButtons=function(a){a.innerHTML=JSComponent.substituteWithLocale(this.getUserPreferences(),"<button class='dialog-ok-button default-capable'>"+this.okButtonMessage+"</button><button class='keep-image-unchanged-button dialog-ok-button'>"+this.keepUnchangedButtonMessage+"</button><button class='dialog-cancel-button'>"+this.cancelButtonMessage+"</button>")};function JSPopupMenu(c,b,d){if(b==null||b.length===0){throw new Error("Cannot register a context menu on an empty list of elements")}JSComponent.call(this,c,"");this.sourceElements=b;if(!Array.isArray(b)){this.sourceElements=[b]}this.build=d;this.getHTMLElement().classList.add("popup-menu");document.body.appendChild(this.getHTMLElement());var a=this;this.registerEventListener(b,"contextmenu",function(e){e.preventDefault();if(JSPopupMenu.current!=null){JSPopupMenu.current.close()}a.showSourceElement(this,e)})}JSPopupMenu.prototype=Object.create(JSComponent.prototype);JSPopupMenu.prototype.constructor=JSPopupMenu;JSPopupMenu.closeOpenedMenu=function(){if(JSPopupMenu.current!=null){JSPopupMenu.current.close();return true}return false};JSPopupMenu.prototype.showSourceElement=function(d,e){this.menuItemListeners=[];var c=new JSPopupMenu.Builder();this.build(c,d);var b=c.items;if(b.length>0&&b[b.length-1]==JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM){b.pop()}var f=this.createMenuElement(b);this.getHTMLElement().appendChild(f);this.getHTMLElement().setAttribute("tabindex",1000);this.getHTMLElement().style.outline="none";this.getHTMLElement().style.outlineWidth="0";this.getHTMLElement().style.visibility="hidden";this.getHTMLElement().classList.add("visible");var a=e.clientX;if(f.clientWidth>window.innerWidth){a=0}else{if(a+f.clientWidth+20>window.innerWidth){a=Math.max(0,window.innerWidth-f.clientWidth-20)}}var g=e.clientY;if(f.clientHeight>window.innerHeight){g=0}else{if(g+f.clientHeight+10>window.innerHeight){g=window.innerHeight-f.clientHeight-10}}this.getHTMLElement().style.visibility="visible";this.getHTMLElement().style.left=a+"px";this.getHTMLElement().style.top=g+"px";this.getHTMLElement().focus();JSPopupMenu.current=this};JSPopupMenu.prototype.createMenuElement=function(b,g){if(g===undefined){g=1000}var f=document.createElement("ul");f.classList.add("items");f.style.zIndex=g;f.addEventListener("contextmenu",function(h){h.preventDefault()});var a=document.createElement("li");a.classList.add("item");a.classList.add("back");a.textContent="";this.registerEventListener(a,"click",function(j){var h=f.parentElement.tagName.toLowerCase()!="li";if(h){JSPopupMenu.closeOpenedMenu()}else{f.classList.remove("visible");j.stopPropagation()}});f.appendChild(a);for(var d=0;d<b.length;d++){var e=b[d];var c=document.createElement("li");if(e==JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM){c.classList.add("separator")}else{this.initMenuItemElement(c,e,g)}f.appendChild(c)}return f};JSPopupMenu.prototype.initMenuItemElement=function(d,f,h){var b=this;var a=document.createElement("img");if(f.iconPath!=null){a.src=f.iconPath;a.classList.add("visible")}if(f.mode!==undefined){d.classList.add("checkable");if(f.selected===true){d.classList.add("selected")}if(f.iconPath==null){a=document.createElement("span");a.innerHTML=f.selected===true?"":"&nbsp;";a.classList.add("visible")}}var e=document.createElement("span");e.textContent=JSComponent.substituteWithLocale(this.getUserPreferences(),f.label);d.classList.add("item");a.classList.add("icon");d.appendChild(a);d.appendChild(e);if(Array.isArray(f.subItems)){d.classList.add("sub-menu");var c=this.createMenuElement(f.subItems,h+1);this.registerEventListener(d,"click",function(j){c.classList.add("visible")});this.registerEventListener(d,"mouseover",function(k){var m=d.getBoundingClientRect();c.style.position="fixed";var j=m.left+d.clientWidth;if(c.clientWidth>window.innerWidth){j=0}else{if(j+c.clientWidth>window.innerWidth){j=window.innerWidth-c.clientWidth}}var l=m.top;if(c.clientHeight>window.innerHeight){l=0}else{if(l+c.clientHeight>window.innerHeight){l=window.innerHeight-c.clientHeight}}c.style.left=j;c.style.top=l});d.appendChild(c)}if(typeof f.itemSelectedListener=="function"){var g=function(){b.close();setTimeout(function(){f.itemSelectedListener()},50)};d.addEventListener("click",g);d.addEventListener("mouseup",g);this.menuItemListeners.push(function(){d.removeEventListener("click",g);d.removeEventListener("mouseup",g)})}};JSPopupMenu.prototype.close=function(){this.getHTMLElement().removeAttribute("tabindex");this.getHTMLElement().classList.remove("visible");JSPopupMenu.current=null;if(this.menuItemListeners){for(var a=0;a<this.menuItemListeners.length;a++){this.menuItemListeners[a]()}}this.menuItemListeners=null;this.getHTMLElement().innerHTML=""};JSPopupMenu.Builder=function(){this.items=[]};JSPopupMenu.Builder.prototype=Object.create(JSPopupMenu.Builder.prototype);JSPopupMenu.Builder.prototype.constructor=JSPopupMenu.Builder;JSPopupMenu.Builder.prototype.addCheckBoxItem=function(b,a,c){this.addNewMenuItem(b,undefined,a,c===true,"checkbox")};JSPopupMenu.Builder.prototype.addRadioButtonItem=function(b,a,c){this.addNewMenuItem(b,undefined,a,c===true,"radiobutton")};JSPopupMenu.Builder.prototype.addMenuItem=function(h,e,b){var a=null;var c=null;var b=null;var f=undefined;var d=undefined;if(h instanceof ResourceAction){var g=h;if(!g.isEnabled()||g.getValue(ResourceAction.VISIBLE)===false){return this}c=g.getURL(AbstractAction.SMALL_ICON);a=g.getValue(ResourceAction.POPUP)||g.getValue(AbstractAction.NAME);if(g.getValue(ResourceAction.TOGGLE_BUTTON_GROUP)){d=g.getValue(AbstractAction.SELECTED_KEY)}b=function(){g.actionPerformed()}}else{if(typeof b=="function"){c=h;a=e;b=b}else{a=h;b=e}}this.addNewMenuItem(a,c,b,d,d!==undefined?"radiobutton":undefined);return this};JSPopupMenu.Builder.prototype.addNewMenuItem=function(b,c,a,d,e){this.items.push({label:b,iconPath:c,itemSelectedListener:a,selected:d,mode:e})};JSPopupMenu.Builder.prototype.addSubMenu=function(f,e){if(f.isEnabled()){var c=f.getValue(ResourceAction.POPUP)||f.getValue(AbstractAction.NAME);var d=f.getURL(AbstractAction.SMALL_ICON);var b=new JSPopupMenu.Builder();e(b);var a=b.items;if(a.length>0){this.items.push({label:c,iconPath:d,subItems:a})}}return this};JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM={};JSPopupMenu.Builder.prototype.addSeparator=function(){if(this.items.length>0&&this.items[this.items.length-1]!=JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM){this.items.push(JSPopupMenu.CONTEXT_MENU_SEPARATOR_ITEM)}return this};if(!JSPopupMenu.globalCloserRegistered){var listener=function(a){if(JSPopupMenu.current!=null&&!JSComponent.isElementContained(a.target,JSPopupMenu.current.getHTMLElement())){if(JSPopupMenu.closeOpenedMenu()){a.stopPropagation();a.preventDefault()}}};window.addEventListener("click",listener);window.addEventListener("touchstart",listener);document.addEventListener("keydown",function(b){if(b.key=="Escape"||b.keyCode==27){if(!JSComboBox.closeOpenedSelectionPanel()){JSDialog.closeTopMostDialog();JSPopupMenu.closeOpenedMenu()}}else{if(b.keyCode==13&&JSDialog.getTopMostDialog()!=null){var a=JSDialog.getTopMostDialog().findElement(".default-capable");if(a!=null){a.click()}}}});JSPopupMenu.globalCloserRegistered=true}function JSSpinner(a,d,c){if(d.tagName.toUpperCase()!="SPAN"){throw new Error("JSSpinner: please provide a span for the spinner to work - "+d+" is not a span")}if(!c){c={}}this.checkMinimumMaximum(c.minimum,c.maximum);if(!isNaN(parseFloat(c.minimum))){this.minimum=c.minimum}if(!isNaN(parseFloat(c.maximum))){this.maximum=c.maximum}if(isNaN(parseFloat(c.stepSize))){this.stepSize=1}else{this.stepSize=c.stepSize}if(typeof c.nullable=="boolean"){this.nullable=c.nullable}else{this.nullable=false}if(c.format instanceof Format){this.format=c.format}else{this.format=new DecimalFormat()}var b=this;JSComponent.call(this,a,d,true);d.classList.add("spinner");this.textInput=document.createElement("input");this.textInput.type="text";d.appendChild(this.textInput);this.registerEventListener(this.textInput,"focus",function(e){b.updateUI()});this.registerEventListener(this.textInput,"focusout",function(e){b.updateUI()});this.registerEventListener(this.textInput,"input",function(f){if(b.isFocused()){var g=new ParsePosition(0);var e=b.parseValueFromInput(g);if(g.getIndex()!=b.textInput.value.length||e==null&&!b.nullable||(b.minimum!=null&&e<b.minimum)||(b.maximum!=null&&e>b.maximum)){b.textInput.style.color="red"}else{b.textInput.style.color=null;b.value=e}}});this.registerEventListener(this.textInput,"blur",function(g){var e=b.parseValueFromInput();if(e==null&&!b.nullable){var f=b.value;if(f==null){f=b.getDefaultValue()}e=f}b.textInput.style.color=null;b.setValue(e)});this.initIncrementDecrementButtons(d);Object.defineProperty(this,"width",{get:function(){return d.style.width},set:function(e){d.style.width=e}});Object.defineProperty(this,"parentElement",{get:function(){return d.parentElement}});Object.defineProperty(this,"previousElementSibling",{get:function(){return d.previousElementSibling}});Object.defineProperty(this,"style",{get:function(){return d.style}});this.setValue(c.value)}JSSpinner.prototype=Object.create(JSComponent.prototype);JSSpinner.prototype.constructor=JSSpinner;JSSpinner.prototype.getValue=function(){return this.value};JSSpinner.prototype.setValue=function(a){if(a instanceof Big){a=parseFloat(a)}if(a!=null&&typeof a!="number"){throw new Error("JSSpinner: Expected values of type number")}if(a==null&&!this.nullable){a=this.getDefaultValue()}if(a!=null&&this.minimum!=null&&a<this.minimum){a=this.minimum}if(a!=null&&this.maximum!=null&&a>this.maximum){a=this.maximum}if(a!=this.value){this.value=a;this.updateUI()}};JSSpinner.prototype.checkMinimumMaximum=function(a,b){if(a!=null&&b!=null&&a>b){throw new Error("JSSpinner: minimum is not below maximum - minimum = "+a+" maximum = "+b)}};JSSpinner.prototype.isNullable=function(){return this.nullable};JSSpinner.prototype.setNullable=function(b){var a=this.nullable&&this.value===null;this.nullable=b;if(!b&&a){this.value=this.getDefaultValue()}};JSSpinner.prototype.getFormat=function(){return this.format};JSSpinner.prototype.setFormat=function(a){this.format=a;this.updateUI()};JSSpinner.prototype.getMinimum=function(){return this.minimum};JSSpinner.prototype.setMinimum=function(a){this.checkMinimumMaximum(a,this.maximum);this.minimum=a};JSSpinner.prototype.getMinimum=function(){return this.minimum};JSSpinner.prototype.setMinimum=function(a){this.checkMinimumMaximum(a,this.maximum);this.minimum=a};JSSpinner.prototype.getMaximum=function(){return this.maximum};JSSpinner.prototype.setMaximum=function(a){this.checkMinimumMaximum(this.minimum,a);this.maximum=a};JSSpinner.prototype.getStepSize=function(){return this.stepSize};JSSpinner.prototype.setStepSize=function(a){this.stepSize=a};JSSpinner.prototype.getInputElement=function(){return this.textInput};JSSpinner.prototype.addEventListener=function(){return this.textInput.addEventListener.apply(this.textInput,arguments)};JSSpinner.prototype.removeEventListener=function(){return this.textInput.removeEventListener.apply(this.textInput,arguments)};JSSpinner.prototype.updateUI=function(){this.textInput.value=this.formatValueForUI(this.value)};JSSpinner.prototype.parseValueFromInput=function(a){if(!this.textInput.value||this.textInput.value.trim()==""){if(this.nullable){return null}else{return this.value}}return this.format.parse(this.textInput.value,a!=undefined?a:new ParsePosition(0))};JSSpinner.prototype.getDefaultValue=function(){var a=0;if(this.minimum!=null&&this.minimum>a){a=this.minimum}if(this.maximum!=null&&this.maximum<a){a=this.maximum}return a};JSSpinner.prototype.formatValueForUI=function(a){if(a==null){return""}if(!this.isFocused()){return this.format.format(a)}if(this.noGroupingFormat==null||this.lastFormat!==this.format){this.lastFormat=this.format;this.noGroupingFormat=this.lastFormat.clone();this.noGroupingFormat.setGroupingUsed(false)}return this.noGroupingFormat.format(a)};JSSpinner.prototype.isFocused=function(){return this.textInput===document.activeElement};JSSpinner.prototype.initIncrementDecrementButtons=function(e){var b=this;this.incrementButton=document.createElement("button");this.incrementButton.setAttribute("increment","");this.incrementButton.textContent="+";this.incrementButton.tabIndex=-1;e.appendChild(this.incrementButton);this.decrementButton=document.createElement("button");this.decrementButton.setAttribute("decrement","");this.decrementButton.textContent="-";this.decrementButton.tabIndex=-1;e.appendChild(this.decrementButton);var g=function(j){var h=b.value;if(h==null||isNaN(h)){h=b.getDefaultValue()}b.setValue(h+b.stepSize);b.fireInputEvent()};var d=function(j){var h=b.value;if(h==null||isNaN(h)){h=b.getDefaultValue()}b.setValue(h-b.stepSize);b.fireInputEvent()};var a=function(n,l,o){if(b.isFocused()){n.preventDefault()}var m=function(p){clearTimeout(k);l.removeEventListener("mouseleave",m);l.removeEventListener("mouseup",m)};var h=function(p){clearTimeout(k);l.removeEventListener("click",h);o()};l.addEventListener("click",h);var j=function(){o();k=setTimeout(j,80)};var k=setTimeout(function(){l.removeEventListener("click",h);l.addEventListener("mouseleave",m);l.addEventListener("mouseup",m);j()},400)};var f=function(h){a(h,b.incrementButton,g)};this.registerEventListener(b.incrementButton,"mousedown",f);var c=function(h){a(h,b.decrementButton,d)};this.registerEventListener(b.decrementButton,"mousedown",c);this.registerEventListener(b.textInput,"keydown",function(h){var j=KeyStroke.getKeyStrokeForEvent(h,"keydown");if(j.lastIndexOf(" UP")>0){h.stopImmediatePropagation();g()}else{if(j.lastIndexOf(" DOWN")>0){h.stopImmediatePropagation();d()}}});this.registerEventListener(this.textInput,"focus",function(h){b.updateUI()})};JSSpinner.prototype.fireInputEvent=function(){var a=document.createEvent("Event");a.initEvent("input",true,true);this.textInput.dispatchEvent(a)};JSSpinner.prototype.setEnabled=function(a){this.textInput.disabled=!a;this.incrementButton.disabled=!a;this.decrementButton.disabled=!a};function JSComboBox(a,d,c){JSComponent.call(this,a,d,true);if(!c){c={}}if(typeof c.nullable!="boolean"){c.nullable=false}if(!Array.isArray(c.availableValues)||c.availableValues.length<=0){throw new Error("JSComboBox: No available values provided")}if(typeof c.renderCell!="function"){c.renderCell=function(f,e){e.textContent=f==null?"":f.toString()}}if(c.value==null&&!c.nullable){c.value=c.availableValues[0]}this.options=c;d.classList.add("combo-box");this.button=document.createElement("button");d.appendChild(this.button);this.preview=document.createElement("div");this.preview.classList.add("preview");this.button.appendChild(this.preview);this.initSelectionPanel();var b=this;this.registerEventListener(this.button,"click",function(e){e.stopImmediatePropagation();b.openSelectionPanel(e.pageX,e.pageY)});this.setSelectedItem(c.value)}JSComboBox.prototype=Object.create(JSComponent.prototype);JSComboBox.prototype.constructor=JSComboBox;JSComboBox.prototype.initSelectionPanel=function(){var d=document.createElement("div");d.classList.add("selection-panel");for(var b=0;b<this.options.availableValues.length;b++){var c=document.createElement("div");c.value=this.options.availableValues[b];this.options.renderCell(c.value,c);d.appendChild(c)}this.getHTMLElement().appendChild(d);this.selectionPanel=d;var a=this;this.registerEventListener(d.children,"click",function(e){a.selectedItem=this.value;a.updateUI();if(typeof a.options.selectionChanged=="function"){a.options.selectionChanged(a.selectedItem)}});this.registerEventListener(this.selectionPanel,"focusout",function(e){comboBox.closeSelectionPanel()})};JSComboBox.prototype.getSelectedItem=function(){return this.selectedItem};JSComboBox.prototype.setSelectedItem=function(c){var a=false;for(var b=0;b<this.options.availableValues.length;b++){if(this.areValuesEqual(c,this.options.availableValues[b])){a=true;break}}if(!a){c=null}if(c==null&&!this.options.nullable){c=this.options.availableValues[0]}if(!this.areValuesEqual(c,this.selectedItem)){this.selectedItem=c;this.updateUI()}};JSComboBox.prototype.setEnabled=function(a){this.button.disabled=!a};JSComboBox.prototype.openSelectionPanel=function(b,a){if(JSComboBox.current!=null){JSComboBox.current.closeSelectionPanel()}var c=this;this.closeSelectionPanelListener=function(){c.closeSelectionPanel()};this.selectionPanel.style.display="block";this.selectionPanel.style.opacity=1;this.selectionPanel.style.left=(b+this.selectionPanel.clientWidth>window.width?window.width-this.selectionPanel.clientWidth:b)+"px";this.selectionPanel.style.top=(a+this.selectionPanel.clientHeight>window.innerHeight?window.innerHeight-this.selectionPanel.clientHeight:a)+"px";window.addEventListener("click",this.closeSelectionPanelListener);JSComboBox.current=this};JSComboBox.prototype.closeSelectionPanel=function(){window.removeEventListener("click",this.closeSelectionPanelListener);this.selectionPanel.style.opacity=0;this.selectionPanel.style.display="none";this.closeSelectionPanelListener=null;JSComboBox.current=null};JSComboBox.closeOpenedSelectionPanel=function(){if(JSComboBox.current!=null){JSComboBox.current.closeSelectionPanel();return true}return false};JSComboBox.prototype.updateUI=function(){this.preview.innerHTML="";this.options.renderCell(this.getSelectedItem(),this.preview)};JSComboBox.prototype.areValuesEqual=function(b,a){return JSON.stringify(b)==JSON.stringify(a)};function JSTreeTable(a,b,c,d){JSComponent.call(this,b,a,true);this.state={};this.selectedRowsValues=[];this.tableElement=document.createElement("div");this.tableElement.classList.add("tree-table");a.appendChild(this.tableElement);this.setModel(c);this.setData(d?d:[])}JSTreeTable.prototype=Object.create(JSComponent.prototype);JSTreeTable.prototype.constructor=JSTreeTable;JSTreeTable.prototype.setData=function(b){this.data=b;var a=this.getExpandedRowsValues();if(a!=null){this.updateState({expandedRowsValues:a})}if(this.isDisplayed()){this.generateTableRows();this.fireExpandedRowsChanged()}};JSTreeTable.prototype.updateRowData=function(e,a){if(this.isDisplayed()){if(!this.state.sort||this.state.sort.columnName==null||(a!==undefined&&this.state.sort.columnName!=a)){var g=this.getColumnNames();var c=a!==undefined?g.indexOf(a):0;if(c>=0){var d=this.bodyElement.children;for(i=0;i<d.length;i++){var f=d[i];if(f._model.value===e){if(a!==undefined){this.model.renderCell(e,a,f.children[c])}else{for(var b=0;b<g.length;b++){this.model.renderCell(e,g[b],f.children[b])}}break}}}}else{this.generateTableRows()}}};JSTreeTable.prototype.getData=function(){return this.data};JSTreeTable.prototype.setModel=function(a){this.model=a;this.updateState(a.initialState);this.columnsWidths=this.getColumnsWidthByName();if(this.isDisplayed()){this.generateTableHeaders();this.generateTableRows()}};JSTreeTable.prototype.isDisplayed=function(){return window.getComputedStyle(this.getHTMLElement()).display!="none"};JSTreeTable.prototype.setSelectedRowsByValue=function(a){this.selectedRowsValues=a.slice(0);if(this.isDisplayed()){this.expandGroupOfSelectedRows(a);var d=this.bodyElement.children;for(var b=0;b<d.length;b++){var e=d[b];e._model.selected=false;e.classList.remove("selected")}for(var c=0;c<a.length;c++){for(var b=0;b<d.length;b++){var e=d[b];if(e._model.value===a[c]){this.selectRowAt(b);break}}}this.scrollToSelectedRowsIfNotVisible()}};JSTreeTable.prototype.selectRowAt=function(a){var d=this.bodyElement.children;var e=d[a];e._model.selected=true;e.classList.add("selected");if(e._model.group&&e._model.collapsed===false){for(var b=a+1;b<d.length;b++){var c=d[b];if(c._model.parentGroup&&c._model.parentGroup.value===e._model.value){this.selectRowAt(b)}}}};JSTreeTable.prototype.expandGroupOfSelectedRows=function(b){if(this.isDisplayed()){var f=this.bodyElement.children;for(var d=0;d<b.length;d++){for(var c=0;c<f.length;c++){var g=f[c];if(g._model.value===b[d]){if(g._model.hidden){this.expandOrCollapseRow(g._model.parentGroup,true);for(var a=c-1;a>=0;a--){if(g._model.parentGroup.value===f[a]._model.value){f[a]._model.collapsed=false;f[a].classList.remove("collapsed");for(a++;a<f.length;a++){var e=f[a];if(e._model.parentGroup&&e._model.parentGroup.value===g._model.parentGroup.value){e._model.hidden=false;e.style.display="flex"}}if(g._model.parentGroup.parentGroup){this.expandGroupOfSelectedRows([g._model.parentGroup.value])}break}}}break}}}}};JSTreeTable.prototype.scrollToSelectedRowsIfNotVisible=function(){var e=this.bodyElement.querySelectorAll(".selected");if(e.length>0){for(var b=0;b<e.length;b++){var c=e[b];var a=c.offsetTop-this.bodyElement.offsetTop;var d=a+c.clientHeight;if(a>=this.bodyElement.scrollTop&&d<=(this.bodyElement.scrollTop+this.bodyElement.clientHeight)){return}}this.bodyElement.scrollTop=e[0].offsetTop-this.bodyElement.offsetTop}};JSTreeTable.prototype.getExpandedRowsValues=function(){if(this.state&&this.state.expandedRowsValues){return this.state.expandedRowsValues}return undefined};JSTreeTable.prototype.fireExpandedRowsChanged=function(){if(this.state.expandedRowsValues!=null){this.updateExpandedRowsIndices();this.model.expandedRowsChanged(this.state.expandedRowsValues,this.state.expandedRowsIndices)}};JSTreeTable.prototype.updateExpandedRowsIndices=function(){if(this.state.expandedRowsValues!=null&&this.data!=null&&this.data.sortedList!=null){this.state.expandedRowsIndices=[];for(var a=0;a<this.data.sortedList.length;a++){var b=this.data.sortedList[a].value;if(this.state.expandedRowsValues.indexOf(b)>-1){this.state.expandedRowsIndices.push(a)}}}};JSTreeTable.prototype.fireSortChanged=function(){if(this.state.sort!=null){this.model.sortChanged(this.state.sort)}};JSTreeTable.prototype.updateState=function(a){if(a){CoreTools.merge(this.state,a)}};JSTreeTable.prototype.getValueComparator=function(){return this.model.getValueComparator(this.state.sort)};JSTreeTable.prototype.generateTableHeaders=function(){var b=this;var e=this.tableElement.querySelector("[header]");if(!e){e=document.createElement("div");e.setAttribute("header","true");this.tableElement.appendChild(e);this.tableElement.appendChild(document.createElement("br"))}e.innerHTML="";var d=this.getColumns();for(var c=0;c<d.length;c++){var f=d[c];var a=document.createElement("div");e.appendChild(a);a.setAttribute("cell","true");a.textContent=f.label;a.dataset.name=f.name;if(this.state.sort&&this.state.sort.columnName==f.name){a.classList.add("sort");if(this.state.sort.direction=="desc"){a.classList.add("descending")}}a.style.width=b.getColumnWidth(f.name)}this.registerEventListener(e.children,"click",function(h){var g=this.dataset.name;var j=this.classList.contains("sort")&&!this.classList.contains("descending");b.sortTable(g,j)})};JSTreeTable.prototype.generateTableRows=function(){var a=this;var b=function(){var e=0;if(a.bodyElement){e=a.bodyElement.scrollTop;a.bodyElement.parentElement.removeChild(a.bodyElement)}a.bodyElement=document.createElement("div");a.bodyElement.setAttribute("body","true");var j=a.data.sortedList=[];var d=a.getValueComparator();var g=function(o,p,u){var t=p>0;var w=d!=null?o.sort(function(y,x){return d(y.value,x.value)}):o;var q=[];for(var s=0;s<w.length;s++){var n=w[s];var v=a.selectedRowsValues.indexOf(n.value)>-1;var r=(u&&u.selected)||v;var m={value:n.value,indentation:p,group:false,parentGroup:u,selected:r,hidden:t,collapsed:undefined,childrenItems:undefined,setCollapsed:function(){},isInCollapsedGroup:function(){var x=this;while((x=x.parentGroup)){if(x.collapsed===true){return true}}return false}};q.push(m);j.push(m);if(Array.isArray(n.children)&&n.children.length>0){m.group=true;m.collapsed=true;m.childrenItems=g(n.children,p+1,m);m.setCollapsed=(function(x){return function(z){x.collapsed=z;for(var y=0;y<x.childrenItems.length;y++){x.childrenItems[y].hidden=z}}})(m)}}return q};g(a.data.slice(0),0);a.updateExpandedRowsIndices();if(a.state.expandedRowsIndices&&a.state.expandedRowsIndices.length>0){var c=[];for(var f=0;f<a.state.expandedRowsIndices.length;f++){var k=j[a.state.expandedRowsIndices[f]];if(k){c.push(k.value);if(!k.isInCollapsedGroup()){k.setCollapsed(false)}}}if(c.length>0){a.state.expandedRowsValues=c}}var h=a.getColumnNames();for(var f=0;f<j.length;f++){var l=a.generateRowElement(h,f,j[f]);a.bodyElement.appendChild(l)}a.tableElement.appendChild(a.bodyElement);a.bodyElement.scrollTop=e;delete a.generatingTableRows};if(this.data){if(a.bodyElement){if(!this.generatingTableRows){this.generatingTableRows=true;setTimeout(b,0)}}else{b()}}};JSTreeTable.prototype.generateRowElement=function(e,f,d){var b=this;var k=document.createElement("div");k.setAttribute("row","true");var g=null;for(var c=0;c<e.length;c++){var a=e[c];var h=document.createElement("div");h.setAttribute("cell","true");this.model.renderCell(d.value,a,h);h.style.width=this.getColumnWidth(a);if(g==null||h.classList.contains("main")){g=h}k.appendChild(h)}if(g!=null){g.classList.add("main");g.style.paddingLeft=(15+d.indentation*10)+"px";if(d.group){this.registerEventListener(g,"click",function(m){if(m.clientX<16){m.stopImmediatePropagation();var j=g.parentElement.classList.contains("collapsed");b.expandOrCollapseRow(d,j);g.parentElement._model.collapsed=!j;if(j){g.parentElement.classList.remove("collapsed")}else{g.parentElement.classList.add("collapsed")}var n=b.bodyElement.children;for(var l=0;l<n.length;l++){var o=n[l];var p=n[l]._model.isInCollapsedGroup();if(j&&n[l]._model.hidden!==p){n[l].classList.add("selected")}n[l]._model.hidden=p;n[l].style.display=p?"none":"flex"}}return false});k.classList.add("group");if(d.collapsed){k.classList.add("collapsed")}}}if(d.hidden){k.style.display="none"}if(d.selected){k.classList.add("selected")}this.registerEventListener(k,"click",function(m){var n=this;var l=n._model.value;if(OperatingSystem.isMacOSX()?m.metaKey:m.ctrlKey){var j=b.selectedRowsValues.indexOf(l);if(j<0){n.classList.add("selected");b.selectedRowsValues.push(l)}else{n.classList.remove("selected");b.selectedRowsValues.splice(j,1)}}else{n.classList.add("selected");b.selectedRowsValues=[l]}if(typeof b.model.selectionChanged=="function"){b.model.selectionChanged(b.selectedRowsValues)}});this.registerEventListener(k,"dblclick",function(l){if(typeof b.model.rowDoubleClicked=="function"){var m=this;var j=m._model.value;b.model.rowDoubleClicked(j)}});k._model=d;return k};JSTreeTable.prototype.expandOrCollapseRow=function(d,c){var a=this;if(a.state.expandedRowsValues==null){a.state.expandedRowsValues=[]}var b=a.state.expandedRowsValues.indexOf(d.value);if(c){if(b<0){a.state.expandedRowsValues.push(d.value);this.fireExpandedRowsChanged()}}else{if(b>=0){a.state.expandedRowsValues.splice(b,1);this.fireExpandedRowsChanged()}}};JSTreeTable.prototype.sortTable=function(a,b){if(!this.state.sort){this.state.sort={}}this.state.sort.columnName=a;this.state.sort.direction=b?"desc":"asc";this.fireSortChanged(this.state.sort)};JSTreeTable.prototype.getColumnWidth=function(a){return this.columnsWidths[a]};JSTreeTable.prototype.getColumns=function(){return this.model.columns.slice(0)};JSTreeTable.prototype.getColumnNames=function(){var b=new Array(this.model.columns.length);for(var a=0;a<b.length;a++){b[a]=this.model.columns[a].name}return b};JSTreeTable.prototype.getColumnsWidthByName=function(){var b=this.model.columns;var e={};for(var a=0;a<b.length;a++){var d=b[a];var c=d.defaultWidth?d.defaultWidth:"6rem";e[d.name]=c}return e};JSTreeTable.prototype.dispose=function(){this.unregisterEventListeners();this.container.removeChild(this.tableElement)};function ColorButton(b,a){JSComponent.call(this,b,document.createElement("span"),true);if(a!==undefined){this.observer=a}this.getHTMLElement().innerHTML='<button class="color-button"><div class="color-preview" /></button>';this.button=this.findElement(".color-button");var c=this;this.registerEventListener(this.button,"click",function(d){c.openColorDialog(b)});this.colorOverview=this.findElement(".color-preview")}ColorButton.prototype=Object.create(JSComponent.prototype);ColorButton.prototype.constructor=ColorButton;ColorButton.prototype.getColor=function(){return this.color};ColorButton.prototype.setColor=function(a){this.color=a;this.colorOverview.style.backgroundColor=a!=null?ColorTools.integerToHexadecimalString(a):"transparent"};ColorButton.prototype.getColorDialogTitle=function(){return this.colorDialogTitle};ColorButton.prototype.setColorDialogTitle=function(a){this.colorDialogTitle=a};ColorButton.prototype.setEnabled=function(a){this.button.disabled=!a};ColorButton.prototype.openColorDialog=function(a){var c=this;var b=new JSColorChooserDialog(this.getUserPreferences(),this.colorDialogTitle,this.color,{applier:function(){var d=b.getSelectedColor();if(d!=null){d|=4278190080}c.setColor(d);var e=a.getRecentColors().slice(0);var f=e.indexOf(d);if(f!=0){if(f>0){e.splice(f,1)}else{e.length=Math.min(e.length,13)}e.splice(0,0,d);a.setRecentColors(e)}if(c.observer!==undefined&&typeof c.observer.colorChanged=="function"){c.observer.colorChanged(d)}}});b.displayView()};function JSColorChooser(a,c){var b="<div class='picker'></div><hr /><div class='custom-color-editor'>  <input class='not-focusable-at-opening' type='text' value='FFFFFF' />  <div class='custom-color-preview'></div><div class='current-color-preview'></div></div><div class='recent-colors'></div>";JSComponent.call(this,a,b);if(c!=null){c.appendChild(this.getHTMLElement())}this.getHTMLElement().classList.add("color-chooser");this.pickerElement=this.findElement(".picker");this.recentColorsContainerElement=this.findElement(".recent-colors");this.customColorEditorInput=this.findElement(".custom-color-editor input");this.customColorEditorPreview=this.findElement(".custom-color-preview");this.currentColorEditorPreview=this.findElement(".current-color-preview");this.createPickerColorTiles();this.initCustomColorEditor()}JSColorChooser.prototype=Object.create(JSComponent.prototype);JSColorChooser.prototype.constructor=JSColorChooser;JSColorChooser.prototype.createPickerColorTiles=function(){var b=["#BEBD7F","#C2B078","#C6A664","#E5BE01","#CDA434","#A98307","#E4A010","#DC9D00","#8A6642","#C7B446","#EAE6CA","#E1CC4F","#E6D690","#EDFF21","#F5D033","#F8F32B","#9E9764","#999950","#F3DA0B","#FAD201","#AEA04B","#FFFF00","#9D9101","#F4A900","#D6AE01","#F3A505","#EFA94A","#6A5D4D","#705335","#F39F18","#ED760E","#C93C20","#CB2821","#FF7514","#F44611","#FF2301","#FFA420","#F75E25","#F54021","#D84B20","#EC7C26","#E55137","#C35831","#AF2B1E","#A52019","#A2231D","#9B111E","#75151E","#5E2129","#412227","#642424","#781F19","#C1876B","#A12312","#D36E70","#EA899A","#B32821","#E63244","#D53032","#CC0605","#D95030","#F80000","#FE0000","#CB3234","#B32428","#721422","#B44C43","#6D3F5B","#922B3E","#DE4C8A","#641C34","#6C4675","#A03472","#4A192C","#924E7D","#A18594","#CF3476","#8673A1","#6C6874","#354D73","#1F3438","#20214F","#1D1E33","#18171C","#1E2460","#3E5F8A","#26252D","#025669","#0E294B","#231A24","#3B83BD","#1E213D","#606E8C","#2271B3","#063971","#3F888F","#1B5583","#1D334A","#256D7B","#252850","#49678D","#5D9B9B","#2A6478","#102C54","#316650","#287233","#2D572C","#424632","#1F3A3D","#2F4538","#3E3B32","#343B29","#39352A","#31372B","#35682D","#587246","#343E40","#6C7156","#47402E","#3B3C36","#1E5945","#4C9141","#57A639","#BDECB6","#2E3A23","#89AC76","#25221B","#308446","#3D642D","#015D52","#84C3BE","#2C5545","#20603D","#317F43","#497E76","#7FB5B5","#1C542D","#193737","#008F39","#00BB2D","#78858B","#8A9597","#7E7B52","#6C7059","#969992","#646B63","#6D6552","#6A5F31","#4D5645","#4C514A","#434B4D","#4E5754","#464531","#434750","#293133","#23282B","#332F2C","#686C5E","#474A51","#2F353B","#8B8C7A","#474B4E","#B8B799","#7D8471","#8F8B66","#D7D7D7","#7F7679","#7D7F7D","#B5B8B1","#6C6960","#9DA1AA","#8D948D","#4E5452","#CAC4B0","#909090","#82898F","#D0D0D0","#898176","#826C34","#955F20","#6C3B2A","#734222","#8E402A","#59351F","#6F4F28","#5B3A29","#592321","#382C1E","#633A34","#4C2F27","#45322E","#403A3A","#212121","#A65E2E","#79553D","#755C48","#4E3B31","#763C28","#FDF4E3","#E7EBDA","#F4F4F4","#282828","#0A0A0A","#A5A5A5","#8F8F8F","#FFFFFF","#1C1C1C","#F6F6F6","#1E1E1E","#D7D7D7","#9C9C9C","#828282"];this.colorTileElements=[this.currentColorEditorPreview];for(var e=0;e<b.length;e++){var a=b[e];var f=this.createColorTile(a);this.pickerElement.appendChild(f)}var d=this.getUserPreferences().getRecentColors();for(var e=0;e<d.length;e++){var a=ColorTools.integerToHexadecimalString(d[e]);var f=this.createColorTile(a);this.recentColorsContainerElement.appendChild(f)}var c=this;this.registerEventListener(this.colorTileElements,"click",function(g){c.selectColorTile(this)})};JSColorChooser.prototype.initCustomColorEditor=function(){var b=this;var c=null;if(!OperatingSystem.isInternetExplorerOrLegacyEdge()){c=document.createElement("input");c.type="color";c.classList.add("color-input");this.customColorEditorPreview.appendChild(c);var a=function(d){b.customColorEditorPreview.style.backgroundColor=c.value;b.customColorEditorInput.value=c.value.substring(1).toUpperCase();b.color=ColorTools.hexadecimalStringToInteger(c.value)};c.value="#010101";this.registerEventListener(c,"input",a)}this.registerEventListener(this.customColorEditorInput,"input",function(e){var d="#"+b.customColorEditorInput.value;if(d.match(/#[0-9a-fA-F]{3,6}/)){b.customColorEditorPreview.style.backgroundColor=d;b.color=ColorTools.hexadecimalStringToInteger(d);if(c!=null){c.value=d}}})};JSColorChooser.prototype.getColor=function(){return this.color};JSColorChooser.prototype.setColor=function(a){this.color=a;var b=a!=null?a:16777215;var c=this.findElement("[data-color='"+b+"']");if(c!=null){this.selectColorTile(c)}else{this.customColorEditorInput.value=ColorTools.integerToHexadecimalString(b).substring(1);this.customColorEditorPreview.style.backgroundColor=ColorTools.integerToHexadecimalString(b)}if(this.findElement(".color-input")!=null){this.findElement(".color-input").value=ColorTools.integerToHexadecimalString(b)}this.currentColorEditorPreview.style.backgroundColor=ColorTools.integerToHexadecimalString(b);this.currentColorEditorPreview.dataset.color=b};JSColorChooser.prototype.selectColorTile=function(d){for(var c=0;c<this.colorTileElements.length;c++){var b=this.colorTileElements[c];if(b==d){b.classList.add("selected")}else{b.classList.remove("selected")}}this.color=this.getTileColor(d);var a=ColorTools.integerToHexadecimalString(this.color);this.customColorEditorInput.value=a.substring(1);this.customColorEditorPreview.style.backgroundColor=a;if(this.findElement(".color-input")!=null){this.findElement(".color-input").value=a}};JSColorChooser.prototype.getTileColor=function(a){return parseInt(a.dataset.color)};JSColorChooser.prototype.createColorTile=function(a){var b=document.createElement("div");b.dataset.color=ColorTools.hexadecimalStringToInteger(a);b.style.backgroundColor=a;this.colorTileElements.push(b);return b};function JSColorChooserDialog(d,h,c,b){var f='<div>  <div data-name="color-chooser"></div></div>';JSDialog.call(this,d,h,f,{applier:b.applier});this.getHTMLElement().classList.add("color-chooser-dialog");this.getHTMLElement().classList.add("small");this.colorChooser=new JSColorChooser(d,this.getElement("color-chooser"));this.colorChooser.setColor(c);var e=this;this.registerEventListener(this.colorChooser.colorTileElements,"dblclick",function(j){e.validate()});if(!OperatingSystem.isInternetExplorerOrLegacyEdge()||!window.PointerEvent){var a=-1;var g=null;this.registerEventListener(this.colorChooser.colorTileElements,"touchstart",function(j){var k=Date.now();if(k-a<500&&g===j.target){j.preventDefault();e.validate()}else{a=k;g=j.target}})}}JSColorChooserDialog.prototype=Object.create(JSDialog.prototype);JSColorChooserDialog.prototype.constructor=JSColorChooserDialog;JSColorChooserDialog.prototype.getSelectedColor=function(){return this.colorChooser.getColor()};JSColorChooserDialog.prototype.dispose=function(){this.colorChooser.dispose();JSDialog.prototype.dispose.call(this)};function TextureChoiceComponent(b,a){JSComponent.call(this,b,document.createElement("span"),true);this.controller=a;this.getHTMLElement().innerHTML='<button class="texture-button"><div class="texture-preview" /></button>';this.button=this.findElement(".texture-button");var c=this;this.registerEventListener(this.button,"click",function(e){c.openTextureDialog()});this.preview=this.findElement(".texture-preview");var d=function(){c.updateTexture(a.getTexture())};this.registerPropertyChangeListener(a,"TEXTURE",d);this.updateTexture(a.getTexture())}TextureChoiceComponent.prototype=Object.create(JSComponent.prototype);TextureChoiceComponent.prototype.constructor=TextureChoiceComponent;TextureChoiceComponent.prototype.updateTexture=function(b){if(b==null){this.preview.style.backgroundImage="none"}else{var a=this;TextureManager.getInstance().loadTexture(b.getImage(),{textureUpdated:function(c){a.preview.style.backgroundImage="url('"+c.src+"')"},textureError:function(c){console.log("Image cannot be loaded",c)}})}};TextureChoiceComponent.prototype.setEnabled=function(a){this.button.disabled=!a};TextureChoiceComponent.prototype.openTextureDialog=function(){var a=new JSTextureDialog(this.getUserPreferences(),this.controller);if(this.controller.getTexture()!=null){a.setSelectedTexture(this.controller.getTexture())}a.displayView()};TextureChoiceComponent.prototype.confirmDeleteSelectedCatalogTexture=function(){var a=this.getLocalizedLabelText("TextureChoiceComponent","confirmDeleteSelectedCatalogTexture.message").replace(/\<[^\>]*\>/g," ").replace(/[ ]+/g," ").replace(/^\s*/,"");return confirm(a)};function JSTextureDialog(f,g){this.controller=g;this.selectedTextureModel={texture:null,xOffset:0,yOffset:0,angleInRadians:0,scale:1};var o=function(q){var p=q.getCategory();var j=document.createElement("div");j.classList.add("item");q.getImage().getStreamURL({urlReady:function(r){j.innerHTML='<img src="'+r+'" />'+p.getName()+" - "+q.getName()},urlError:function(r){j.innerHTML="<img/>"+p.getName()+" - "+q.getName()}});j._catalogTexture=q;return j};var e='<div class="columns-2">  <div class="column1">    <div class="texture-search"><input type="text" /></div>    <div class="texture-catalog-list"></div>    <div class="recent-textures"></div>  </div>  <div class="column2">    <div class="selected-texture-preview">      <div></div>    </div>    <div class="selected-texture-config label-input-grid">      <div>@{TextureChoiceComponent.xOffsetLabel.text}</div>      <div><span data-name="selected-texture-offset-x" /></div>      <div>@{TextureChoiceComponent.yOffsetLabel.text}</div>      <div><span data-name="selected-texture-offset-y" /></div>      <div>@{TextureChoiceComponent.angleLabel.text}</div>      <div><span data-name="selected-texture-angle" /></div>      <div>@{TextureChoiceComponent.scaleLabel.text}</div>      <div><span data-name="selected-texture-scale" /></div>    </div>    <hr />    <div class="imported-textures-panel">      <div><button import>@{TextureChoiceComponent.importTextureButton.text}</button></div>      <div><button disabled modify>@{TextureChoiceComponent.modifyTextureButton.text}</button></div>      <div><button disabled delete>@{TextureChoiceComponent.deleteTextureButton.text}</button></div>    </div>  </div></div>';JSDialog.call(this,f,g.getDialogTitle(),e,{applier:function(p){this.updateTextureTransform();var j=p.getSelectedTexture();g.setTexture(j);if(j!=null){g.addRecentTexture(j)}},disposer:function(j){f.getTexturesCatalog().removeTexturesListener(j.texturesCatalogListener)}});this.getHTMLElement().classList.add("texture-chooser-dialog");this.recentTexturesPanel=this.findElement(".recent-textures");this.catalogList=this.findElement(".texture-catalog-list");this.selectedTexturePreview=this.findElement(".selected-texture-preview > div");this.xOffsetInput=new JSSpinner(f,this.getElement("selected-texture-offset-x"),{value:0,minimum:0,maximum:100,stepSize:5});this.yOffsetInput=new JSSpinner(f,this.getElement("selected-texture-offset-y"),{value:0,minimum:0,maximum:100,stepSize:5});this.angleInput=new JSSpinner(f,this.getElement("selected-texture-angle"),{format:new IntegerFormat(),value:0,minimum:0,maximum:360,stepSize:15});this.scaleInput=new JSSpinner(f,this.getElement("selected-texture-scale"),{value:100,minimum:1,maximum:10000,stepSize:5});var l=this;this.registerEventListener([this.xOffsetInput,this.yOffsetInput,this.angleInput,this.scaleInput],"input",function(j){l.updateTextureTransform()});var n=f.getTexturesCatalog().getCategories();for(var c=0;c<n.length;c++){var k=n[c];for(var b=0;b<k.getTextures().length;b++){var m=k.getTextures()[b];l.catalogList.appendChild(o(m))}}this.texturesCatalogItems=this.catalogList.childNodes;var d=function(j){l.selectTexture(l.getCatalogTextureFromItem(this))};this.registerEventListener(this.texturesCatalogItems,"click",d);this.initCatalogTextureSearch(f);this.initRecentTextures();this.registerPropertyChangeListener(f,"RECENT_TEXTURES",function(j){l.initRecentTextures()});this.registerEventListener(this.findElements(".item"),"dblclick",function(j){l.validate()});if(!OperatingSystem.isInternetExplorerOrLegacyEdge()||!window.PointerEvent){var a=-1;var h=null;this.registerEventListener(this.findElements(".item"),"touchstart",function(j){var p=Date.now();if(p-a<500&&h===j.target){j.preventDefault();l.validate()}else{a=p;h=j.target}})}this.initImportTexturesPanel();this.texturesCatalogListener=function(q){var s=q.getItem&&q.getItem();switch(q.getType()){case CollectionEvent.Type.ADD:l.searchInput.value="";var p=o(s);l.catalogList.appendChild(p);l.registerEventListener(p,"click",d);l.selectTexture(s);break;case CollectionEvent.Type.DELETE:var j=l.getCatalogTextureItem(s);l.catalogList.removeChild(j);var r=l.catalogList.querySelector(".item");if(r){l.selectTexture(l.getCatalogTextureFromItem(r))}break}};f.getTexturesCatalog().addTexturesListener(this.texturesCatalogListener)}JSTextureDialog.prototype=Object.create(JSDialog.prototype);JSTextureDialog.prototype.constructor=JSTextureDialog;JSTextureDialog.prototype.getSelectedTexture=function(){if(this.selectedTextureModel.texture!=null){return new HomeTexture(this.selectedTextureModel.texture,this.selectedTextureModel.xOffset,this.selectedTextureModel.yOffset,this.selectedTextureModel.angleInRadians,this.selectedTextureModel.scale,this.controller.getTexture() instanceof HomeTexture?this.controller.getTexture().isFittingArea():false,true)}else{return null}};JSTextureDialog.prototype.setSelectedTexture=function(f){if(f!=null){this.selectedTextureModel.texture=f;this.selectedTextureModel.xOffset=f.getXOffset();this.selectedTextureModel.yOffset=f.getYOffset();this.selectedTextureModel.angleInRadians=f.getAngle();this.selectedTextureModel.scale=f.getScale();this.xOffsetInput.setValue(this.selectedTextureModel.xOffset*100);this.yOffsetInput.setValue(this.selectedTextureModel.yOffset*100);this.angleInput.setValue(Math.toDegrees(this.selectedTextureModel.angleInRadians));this.scaleInput.setValue(this.selectedTextureModel.scale*100);var c=f.getImage();var e=this.getUserPreferences().getTexturesCatalog().getCategories();var g=null;for(var d=0;d<e.length&&g===null;d++){var a=e[d].getTextures();for(var b=0;b<a.length;b++){if(c.equals(a[b].getImage())){g=a[b];break}}}if(g!==null){this.selectTexture(g)}else{this.selectTexture(f)}}else{this.selectedTexturePreview.style.backgroundImage="none"}this.updateTextureTransform()};JSTextureDialog.prototype.selectTexture=function(e){this.selectedTextureModel.texture=e;var f=false;if(e!=null){for(var c=0;c<this.texturesCatalogItems.length;c++){this.texturesCatalogItems[c].classList.remove("selected")}if(e instanceof CatalogTexture){var d=this.getCatalogTextureItem(e);d.classList.add("selected");var a=this.catalogList;setTimeout(function(){var g=d.offsetTop-a.offsetTop;var h=g+d.clientHeight;if(g<a.scrollTop||h>(a.scrollTop+a.clientHeight)){a.scrollTop=g-a.offsetTop}},10);this.selectedTexturePreview.style.backgroundImage="url('"+d.querySelector("img").src+"')";f=e!=null&&e.isModifiable()}else{var b=this;TextureManager.getInstance().loadTexture(e.getImage(),{textureUpdated:function(g){b.selectedTexturePreview.style.backgroundImage="url('"+g.src+"')"},textureError:function(g){b.selectedTexturePreview.style.backgroundImage="none"}})}}else{b.selectedTexturePreview.style.backgroundImage="none"}this.modifyTextureButton.disabled=!f;this.deleteTextureButton.disabled=!f};JSTextureDialog.prototype.updateTextureTransform=function(){this.selectedTextureModel.xOffset=this.xOffsetInput.getValue()/100;this.selectedTextureModel.yOffset=this.yOffsetInput.getValue()/100;this.selectedTextureModel.angleInRadians=Math.toRadians(this.angleInput.getValue());this.selectedTextureModel.scale=this.scaleInput.getValue()/100;this.selectedTexturePreview.style.transform=" rotate("+this.angleInput.getValue()+"deg)"};JSTextureDialog.prototype.getCatalogTextureItem=function(e){if(e!=null){var d=e.getImage();for(var a=0;a<this.texturesCatalogItems.length;a++){var b=this.texturesCatalogItems[a];var c=this.getCatalogTextureFromItem(b).getImage();if(d.equals(c)){return b}}}return null};JSTextureDialog.prototype.getCatalogTextureFromItem=function(a){return a._catalogTexture};JSTextureDialog.prototype.initCatalogTextureSearch=function(a){var b=this;this.searchInput=this.findElement(".texture-search input");this.searchInput.placeholder=ResourceAction.getLocalizedLabelText(a,"TextureChoiceComponent","searchLabel.text").replace(":","");this.registerEventListener(b.searchInput,"input",function(){var e=CoreTools.removeAccents(b.searchInput.value.trim());for(var d=0;d<b.texturesCatalogItems.length;d++){var f=b.texturesCatalogItems[d];var c=f._catalogTexture.getName()+"|"+f._catalogTexture.getCategory().getName();if(f._catalogTexture.getCreator()!==null){c+="|"+f._catalogTexture.getCreator()}if(RegExp(e,"i").test(CoreTools.removeAccents(c))){f.classList.remove("hidden")}else{f.classList.add("hidden")}}});this.searchInput.addEventListener("focusin",function(c){setTimeout(function(){if(b.searchInput.value!=""){b.searchInput.select()}},100)})};JSTextureDialog.prototype.initRecentTextures=function(){var c=this;this.recentTexturesPanel.innerHTML="";var e=this.getUserPreferences().getRecentTextures();for(var b=0;b<e.length;b++){var d=e[b];var a=document.createElement("div");a.classList.add("item");a._catalogTexture=d;this.recentTexturesPanel.appendChild(a);TextureManager.getInstance().loadTexture(d.getImage(),{textureUpdated:function(f){a.style.backgroundImage="url('"+f.src+"')"},textureError:function(f){c.recentTexturesPanel.removeChild(a)}})}var c=this;this.registerEventListener(this.recentTexturesPanel.childNodes,"click",function(f){c.selectTexture(c.getCatalogTextureFromItem(this))})};JSTextureDialog.prototype.initImportTexturesPanel=function(){this.importTextureButton=this.findElement(".imported-textures-panel [import]");this.modifyTextureButton=this.findElement(".imported-textures-panel [modify]");this.deleteTextureButton=this.findElement(".imported-textures-panel [delete]");var b=this;var a=this.controller;this.registerEventListener(this.importTextureButton,"click",function(c){a.importTexture()});this.registerEventListener(this.modifyTextureButton,"click",function(c){a.modifyTexture(b.selectedTextureModel.texture)});this.registerEventListener(this.deleteTextureButton,"click",function(c){a.deleteTexture(b.selectedTextureModel.texture)})};function ModelMaterialsComponent(b,a){JSComponent.call(this,b,document.createElement("span"),true);this.controller=a;this.getHTMLElement().innerHTML='<button class="model-materials-button">'+this.getLocalizedLabelText("ModelMaterialsComponent","modifyButton.text")+"</button>";this.button=this.findElement(".model-materials-button");this.button.disabled=true;var c=this;this.registerEventListener(this.button,"click",function(d){c.openModelMaterialsSelectorDialog()})}ModelMaterialsComponent.prototype=Object.create(JSComponent.prototype);ModelMaterialsComponent.prototype.constructor=ModelMaterialsComponent;ModelMaterialsComponent.prototype.setEnabled=function(a){this.button.disabled=!a};ModelMaterialsComponent.prototype.openModelMaterialsSelectorDialog=function(){var a=new JSModelMaterialsSelectorDialog(this.getUserPreferences(),this.controller);a.displayView()};ModelMaterialsComponent.prototype.dispose=function(){JSComponent.prototype.dispose.call(this)};function JSModelMaterialsSelectorDialog(c,b){this.controller=b;var e='<div data-name="preview-panel">  <span>@{ModelMaterialsComponent.previewLabel.text}</span><br/>  <canvas id="model-preview-canvas"></canvas></div><div data-name="edit-panel">  <div>    <span>@{ModelMaterialsComponent.materialsLabel.text}</span>    <div data-name="materials-list">    </div>  </div>  <div class="color-texture-shininess-panel">    <span>@{ModelMaterialsComponent.colorAndTextureLabel.text}</span><br/>    <div class="label-input-grid">      <label class="whole-line"><input type="radio" name="color-and-texture-checkbox" value="DEFAULT">@{ModelMaterialsComponent.defaultColorAndTextureRadioButton.text}</label>      <label class="whole-line"><input type="radio" name="color-and-texture-checkbox" value="INVISIBLE">@{ModelMaterialsComponent.invisibleRadioButton.text}</label>      <label><input type="radio" name="color-and-texture-checkbox" value="COLOR">@{ModelMaterialsComponent.colorRadioButton.text}</label>      <span data-name="color-button"></span>      <label><input type="radio" name="color-and-texture-checkbox" value="TEXTURE">@{ModelMaterialsComponent.textureRadioButton.text}</label>      <span data-name="texture-component"></span>    </div>    <br />    <span>@{ModelMaterialsComponent.shininessLabel.text}</span><br/>    <input type="range" name="shininess-slider" min="0" max="128" list="model-materials-shininess-list" />     <datalist id="model-materials-shininess-list"></datalist>     <div class="slider-labels"><div>@{ModelMaterialsComponent.mattLabel.text}</div><div>@{ModelMaterialsComponent.shinyLabel.text}</div></div>  </div></div>';JSDialog.call(this,c,"@{HomeFurnitureController.modelMaterialsTitle}",e,{size:"medium",applier:function(g){b.setMaterials(g.materialsList.getMaterials())},disposer:function(g){g.selectedMaterialBlinker.stop();g.colorButton.dispose();g.textureComponent.dispose()}});this.getHTMLElement().classList.add("model-materials-chooser-dialog");this.initMaterialsList();this.initPreviewPanel();this.initColorAndTexturePanel();this.initShininessPanel();var d=this;if(this.materialsList.size()>0){this.materialsList.addSelectionInterval(0,0)}else{var a=function(){if(d.materialsList.size()>0){d.materialsList.addSelectionInterval(0,0);d.materialsList.removeListDataListener(a)}};this.materialsList.addListDataListener(a)}this.enableComponents();var f={delay:500,animationTask:null,start:function(){var h=d.materialsList;var g=function(){if(h.size()>1){var t=h.getMaterials();if(f.delay!==100){f.delay=100;if(t==null){t=d.newArray(h.size())}else{t=t.slice(0)}var k=h.getSelectedIndices();for(var n=0;n<k.length;n++){var o=k[n];var s=h.getDefaultMaterialAt(o);var p=t[o]!=null?t[o]:s;var r=4280435967;if(p.getTexture()==null){var j=p.getColor();if(j==null){j=s.getColor();if(j==null){j=4278190080}}j&=16777215;var l=(j>>16)&255;var m=(j>>8)&255;var q=j&255;if(Math.max(l,Math.max(m,q))>119){r=4278190080|(l/2<<16)|(m/2<<8)|(q/2)}else{if((l+m+q)/3>15){r=4278190080|(Math.min(l*2,255)<<16)|(Math.min(m*2,255)<<8)|Math.min(q*2,255)}}}t[o]=new HomeMaterial(p.getName(),r,null,p.getShininess())}}else{f.delay=1000}d.previewComponent.setModelMaterials(t)}f.animationTask=setTimeout(g,f.delay)};f.animationTask=setTimeout(g,f.delay)},stop:function(){clearTimeout(f.animationTask)},restart:function(){f.stop();f.delay=101;f.start()}};f.start();this.materialsList.addListSelectionListener(function(g){f.restart()});this.selectedMaterialBlinker=f}JSModelMaterialsSelectorDialog.prototype=Object.create(JSDialog.prototype);JSModelMaterialsSelectorDialog.prototype.constructor=JSModelMaterialsSelectorDialog;JSModelMaterialsSelectorDialog.prototype.newArray=function(b){var c=new Array(b);for(var a=0;a<c.length;a++){c[a]=null}return c};JSModelMaterialsSelectorDialog.prototype.initMaterialsList=function(){var d=this;var b=this.controller;var f=this.getElement("materials-list");var e=[];var a=b.getMaterials();if(a!=null){a=a.slice(0)}ModelManager.getInstance().loadModel(b.getModel(),true,{modelUpdated:function(n){e=ModelManager.getInstance().getMaterials(n,(b.getModelFlags()&PieceOfFurniture.HIDE_EDGE_COLOR_MATERIAL)!=0,b.getModelCreator());if(a!=null){var g=d.newArray(e.length);var l=false;for(var k=0;k<e.length;k++){var m=e[k].getName();for(var h=0;h<a.length;h++){if(a[h]!=null&&a[h].getName()==m){g[k]=a[h];l=true;break}}}if(l){a=g}else{a=null}}}});var c=this.materialsList={element:f,materials:a,defaultMaterials:e,dataListeners:[],selectionListeners:[],size:function(){if(c.defaultMaterials!=null){return c.defaultMaterials.length}else{return 0}},getMaterials:function(){return c.materials},getDefaultMaterialAt:function(g){return c.defaultMaterials[g]},getElementAt:function(g){var h;if(c.materials!=null&&c.materials[g]!=null&&c.materials[g].getName()!=null&&c.materials[g].getName()==c.defaultMaterials[g].getName()){h=c.materials[g]}else{h=new HomeMaterial(c.defaultMaterials[g].getName(),null,null,null)}return h},setMaterialAt:function(j,g){if(j.getColor()==null&&j.getTexture()==null&&j.getShininess()==null){if(c.materials!=null){c.materials[g]=null;var k=true;for(var h=0;h<c.materials.length;h++){if(c.materials[h]!=null){k=false;break}}if(k){c.materials=null}}}else{if(c.materials==null||c.materials.length!=c.defaultMaterials.length){c.materials=d.newArray(c.defaultMaterials.length)}c.materials[g]=j}c.fireContentsChanged()},fireContentsChanged:function(){for(var g=0;g<c.dataListeners.length;g++){c.dataListeners[g]()}c.repaint()},createListItem:function(k,j,h){var n=k.getTexture();var m=k.getColor();if(n==null&&m==null){n=j.getTexture();if(n==null){m=j.getColor()}}var g=document.createElement("div");g.classList.add("icon");if(n!=null&&n.getImage()!=null){TextureManager.getInstance().loadTexture(n.getImage(),{textureUpdated:function(o){g.style.backgroundImage="url('"+o.src+"')"},textureError:function(o){g.style.backgroundImage="none"}})}else{if(m!=null&&(m&4278190080)!=0){g.style.backgroundColor=ColorTools.integerToHexadecimalString(m)}else{}}var l=document.createElement("div");l.textContent=k.getName();if(h){l.classList.add("selected")}l.appendChild(g);return l},repaint:function(){var n=c.defaultMaterials;var g=c.materials;var m=c.getSelectedIndices();c.element.innerHTML="";if(n!=null){c.element.innerHTML="";for(var h=0;h<n.length;h++){var l=c.getElementAt(h);var k=c.getDefaultMaterialAt(h);var j=m.indexOf(h)>-1;c.element.appendChild(c.createListItem(l,k,j))}d.registerEventListener(c.element.children,"click",function(r){var q=this;var s=OperatingSystem.isMacOSX()?r.metaKey:r.ctrlKey;if(s){if(q.classList.contains("selected")){q.classList.remove("selected");c.fireSelectionChanged()}else{c.selectItem(q)}}else{for(var p=0;p<c.element.children.length;p++){var o=c.element.children[p];if(o!=q){o.classList.remove("selected")}}c.selectItem(q)}});d.registerEventListener(c.element.children,"dblclick",function(o){c.selectItem(this);if(d.colorButton.getColor()!=null){d.colorButton.findElement("button").click()}else{if(b.getTextureController().getTexture()!=null&&d.textureComponent!=null){d.textureComponent.findElement("button").click()}}})}},addListDataListener:function(g){c.dataListeners.push(g)},removeListDataListener:function(g){c.dataListeners.splice(c.dataListeners.index(g),1)},addListSelectionListener:function(g){c.selectionListeners.push(g)},addSelectionInterval:function(j,h){for(var g=j;g<=h;g++){c.element.children[g].classList.add("selected")}c.fireSelectionChanged()},removeSelectionInterval:function(j,h){for(var g=j;g<=h;g++){c.element.children[g].classList.remove("selected")}c.fireSelectionChanged()},clearSelection:function(){c.removeSelectionInterval(0,c.size()-1)},selectItem:function(g){g.classList.add("selected");c.fireSelectionChanged()},fireSelectionChanged:function(){for(var g=0;g<c.selectionListeners.length;g++){c.selectionListeners[g]()}},isSelectionEmpty:function(){return c.element.querySelector(".selected")!=null},getSelectedIndices:function(){var j=[];var g=c.element.children;for(var h=0;h<g.length;h++){if(g[h].classList.contains("selected")){j.push(h)}}return j}};this.materialsList.repaint();this.materialsList.addListSelectionListener(function(){var l=d.materialsList.getSelectedIndices();if(l.length>0){var k=d.materialsList.getElementAt(l[0]);var m=k.getTexture();var g=k.getColor();var h=k.getShininess();var j=d.materialsList.getDefaultMaterialAt(l[0]);if(g==null&&m==null){d.defaultColorAndTextureRadioButton.checked=true;m=j.getTexture();if(m!=null){d.colorButton.setColor(null);b.getTextureController().setTexture(m)}else{g=j.getColor();if(g!=null){b.getTextureController().setTexture(null);d.colorButton.setColor(g)}}}else{if(m!=null){d.textureRadioButton.checked=true;d.colorButton.setColor(null);b.getTextureController().setTexture(m)}else{if((g&4278190080)==0){d.invisibleRadioButton.checked=true;m=j.getTexture();if(m!=null){d.colorButton.setColor(null);b.getTextureController().setTexture(m)}else{g=j.getColor();if(g!=null){b.getTextureController().setTexture(null);d.colorButton.setColor(g)}}}else{d.colorRadioButton.checked=true;b.getTextureController().setTexture(null);d.colorButton.setColor(g)}}}if(h!=null){d.shininessSlider.value=h*128}else{d.shininessSlider.value=j.getShininess()!=null?j.getShininess()*128:0}}d.enableComponents()})};JSModelMaterialsSelectorDialog.prototype.initPreviewPanel=function(){var c=this.controller;var d=this;var a=this.getElement("preview-panel");var b=this.findElement("#model-preview-canvas");b.width=250;b.height=250;var e=d.previewComponent=new ModelPreviewComponent(b,true);ModelManager.getInstance().loadModel(c.getModel(),false,{modelUpdated:function(h){var g=d.materialsList;e.setModel(c.getModel(),c.getModelFlags(),c.getModelRotation(),c.getModelWidth(),c.getModelDepth(),c.getModelHeight());e.setModelMaterials(g.getMaterials());e.setModelTransformations(c.getModelTransformations());g.addListDataListener(function(){e.setModelMaterials(g.getMaterials())})},modelError:function(){a.style.visibility="hidden"}});var f=function(k){var m=d.previewComponent.getPickedMaterial();if(m!=null){for(var g=0,o=d.materialsList.size();g<o;g++){var j=d.materialsList.getDefaultMaterialAt(g);if(j.getName()!==null&&j.getName()==m.getName()){var l=OperatingSystem.isMacOSX()?k.metaKey:k.ctrlKey;if(l){var h=d.materialsList.getSelectedIndices();if(h.indexOf(g)>=0){d.materialsList.removeSelectionInterval(g,g)}else{d.materialsList.addSelectionInterval(g,g)}}else{d.materialsList.clearSelection();d.materialsList.addSelectionInterval(g,g)}}}}};if(OperatingSystem.isInternetExplorerOrLegacyEdge()&&window.PointerEvent){d.previewComponent.getHTMLElement().addEventListener("pointerdown",f);d.previewComponent.getHTMLElement().addEventListener("mousedown",f)}else{d.previewComponent.getHTMLElement().addEventListener("touchstart",f);d.previewComponent.getHTMLElement().addEventListener("mousedown",f)}};JSModelMaterialsSelectorDialog.prototype.initColorAndTexturePanel=function(){var d=this;var a=this.controller;this.defaultColorAndTextureRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='DEFAULT']");this.invisibleRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='INVISIBLE']");this.colorRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='COLOR']");this.textureRadioButton=this.findElement("[name='color-and-texture-checkbox'][value='TEXTURE']");var c=function(k){var j=d.materialsList.getSelectedIndices();for(var g=0;g<j.length;g++){var f=j[g];var h=d.materialsList.getElementAt(f);d.materialsList.setMaterialAt(k(h,f),f)}};this.registerEventListener(this.defaultColorAndTextureRadioButton,"click",function(f){if(!this.disabled&&this.checked){c(function(g){return new HomeMaterial(g.getName(),null,null,g.getShininess())})}});this.registerEventListener(this.invisibleRadioButton,"click",function(f){if(!this.disabled&&this.checked){c(function(g){return new HomeMaterial(g.getName(),0,null,g.getShininess())})}});var e=function(){if(!d.colorRadioButton.disabled&&d.colorRadioButton.checked){c(function(j,g){var h=d.materialsList.getDefaultMaterialAt(g);var f=h.getColor()!=d.colorButton.getColor()||h.getTexture()!=null?d.colorButton.getColor():null;return new HomeMaterial(j.getName(),f,null,j.getShininess())})}};this.colorButton=new ColorButton(this.getUserPreferences(),{colorChanged:function(f){if(f!=null){d.colorRadioButton.checked=true;e()}}});this.colorButton.setColorDialogTitle(this.getUserPreferences().getLocalizedString("ModelMaterialsComponent","colorDialog.title"));this.registerEventListener(this.colorRadioButton,"click",function(f){if(d.colorRadioButton.checked){e()}});this.attachChildComponent("color-button",this.colorButton);var b=function(){if(!d.textureRadioButton.disabled&&d.textureRadioButton.checked){c(function(h,f){var g=d.materialsList.getDefaultMaterialAt(f).getTexture();var j=g!=a.getTextureController().getTexture()?a.getTextureController().getTexture():null;return new HomeMaterial(h.getName(),null,j,h.getShininess())})}};this.textureComponent=a.getTextureController().getView();this.textureComponent.textureChanged=function(f){if(f!=null){d.textureRadioButton.checked=true;b()}};this.registerEventListener(this.textureRadioButton,"click",function(f){if(d.textureRadioButton.checked){b()}});this.registerPropertyChangeListener(a.getTextureController(),"TEXTURE",function(f){if(f.getNewValue()!=null){if(!d.textureRadioButton.checked){d.textureRadioButton.checked=true}b()}});this.attachChildComponent("texture-component",this.textureComponent)};JSModelMaterialsSelectorDialog.prototype.initShininessPanel=function(){var b=this;this.shininessSlider=this.getElement("shininess-slider");var d=this.findElement("#model-materials-shininess-list");for(var a=0;a<=128;a+=16){var c=document.createElement("option");c.value=a;d.appendChild(c)}this.registerEventListener(this.shininessSlider,"input",function(k){var g=this.value;var j=b.materialsList.getSelectedIndices();for(var f=0;f<j.length;f++){var e=j[f];var h=b.materialsList.getElementAt(e);b.materialsList.setMaterialAt(new HomeMaterial(h.getName(),h.getColor(),h.getTexture(),g/128),e)}})};JSModelMaterialsSelectorDialog.prototype.enableComponents=function(){var a=!this.materialsList.isSelectionEmpty();this.defaultColorAndTextureRadioButton.disabled=a;this.invisibleRadioButton.disabled=a;this.textureRadioButton.disabled=a;this.textureComponent.setEnabled(!a);this.colorRadioButton.disabled=a;this.colorButton.setEnabled(!a);this.shininessSlider.disabled=a};function JSViewFactory(a){this.application=a}JSViewFactory.prototype=Object.create(JSViewFactory.prototype);JSViewFactory.prototype.constructor=JSViewFactory;JSViewFactory.__class="JSViewFactory";JSViewFactory.__interfaces=["com.eteks.sweethome3d.viewcontroller.ViewFactory"];JSViewFactory.dummyDialogView={displayView:function(a){}};JSViewFactory.prototype.createFurnitureCatalogView=function(a,b,c){return new FurnitureCatalogListPanel("furniture-catalog",a,b,c)};JSViewFactory.prototype.createFurnitureView=function(c,b,a){if(document.getElementById("furniture-view")!=null){return new FurnitureTablePanel("furniture-view",c,b,a)}else{return undefined}};JSViewFactory.prototype.createPlanView=function(c,a,b){return new PlanComponent("home-plan",c,a,b)};JSViewFactory.prototype.createView3D=function(c,a,b){return new HomeComponent3D("home-3D-view",c,a,null,b)};JSViewFactory.prototype.createHomeView=function(c,a,b){return new HomePane("home-pane",c,a,b)};JSViewFactory.prototype.createWizardView=function(b,a){return new JSWizardDialog(b,a,a.getTitle()||"@{WizardPane.wizard.title}",{})};JSViewFactory.prototype.createBackgroundImageWizardStepsView=function(f,b,a){var e=10000000;var d=8000000;var c=10;function g(){JSComponent.call(this,b,"<div choiceStep>  <div description>@{BackgroundImageWizardStepsPanel.imageChangeLabel.text}</div>  <div class='buttons'>    <button selectImage></button>    <input type='file' accept='image/*' style='display: none' />  </div>  <div preview>    <img />  </div></div><div scaleStep>  <div>@{BackgroundImageWizardStepsPanel.scaleLabel.text}</div>  <br />  <div>    <span data-name='scale-distance-label'></span>    <span data-name='scale-distance-input'></span>  </div>  <br />  <div class='preview-panel'>    <div preview>      <canvas />    </div>    <div class='preview-controls' style='z-index:5'>      <div previewZoomIn></div>      <br />      <div previewZoomOut></div>    </div>  </div></div><div originStep>  <div>@{BackgroundImageWizardStepsPanel.originLabel.text}</div>  <br />  <div>    <span data-name='x-origin-label'></span>    <span data-name='x-origin-input'></span>    <span data-name='y-origin-label'></span>    <span data-name='y-origin-input'></span>  </div>  <br />  <div class='preview-panel'>    <div preview>      <canvas />    </div>    <div class='preview-controls' style='z-index:5'>      <div previewZoomIn></div>      <br />      <div previewZoomOut></div>    </div>  </div></div>");this.controller=a;this.getHTMLElement().classList.add("background-image-wizard");this.initImageChoiceStep();this.initScaleStep();this.initOriginStep();var h=this;this.registerPropertyChangeListener(a,"STEP",function(j){h.updateStep();h.repaintOriginCanvas()});this.registerPropertyChangeListener(a,"IMAGE",function(j){h.updatePreviewComponentsImage()});this.updateImage(f)}g.prototype=Object.create(JSComponent.prototype);g.prototype.constructor=g;g.prototype.buildHtmlFromTemplate=function(h){return JSComponent.prototype.buildHtmlFromTemplate.call(this,h).replace(/\<br\>/g," ")};g.prototype.initImageChoiceStep=function(){var k=this;k.imageChoiceStep={panel:k.findElement("[choiceStep]"),imageChoiceOrChangeLabel:k.findElement("[choiceStep] [description]"),imageChoiceOrChangeButton:k.findElement("[choiceStep] [selectImage]"),imageChooser:k.findElement("[choiceStep] input[type='file']"),preview:k.findElement("[choiceStep] [preview] img")};var h=function(l){console.warn("Error loading image: "+l);k.controller.setImage(null);k.setImageChoiceTexts();k.updatePreviewComponentsImage();alert(ResourceAction.getLocalizedLabelText(b,"BackgroundImageWizardStepsPanel","imageChoiceErrorLabel.text"))};k.registerEventListener(k.imageChoiceStep.imageChoiceOrChangeButton,"click",function(l){k.imageChoiceStep.imageChooser.click()});var j=function(m){if(m){var l=new FileReader();l.onload=function(n){var o=new Image();o.addEventListener("load",function(p){k.updateController(o,m)});o.addEventListener("error",h);o.src=n.target.result};l.onerror=h;l.readAsDataURL(m)}};k.registerEventListener(k.imageChoiceStep.imageChooser,"input",function(l){j(this.files[0])});k.registerEventListener(k.imageChoiceStep.preview,"drop",function(l){l.preventDefault();j(l.dataTransfer.files[0])});k.registerEventListener(k.imageChoiceStep.preview,"dragover",function(l){l.preventDefault()})};g.prototype.initScaleStep=function(){var q=this;var h=b.getLengthUnit().getName();var o=b.getLengthUnit().getMaximumLength();q.scaleStep={panel:q.findElement("[scaleStep]"),preview:q.findElement("[scaleStep] [preview] canvas"),previewZoomIn:q.findElement("[scaleStep] [previewZoomIn]"),previewZoomOut:q.findElement("[scaleStep] [previewZoomOut]"),scaleDistanceLabel:q.getElement("scale-distance-label"),scaleDistanceInput:new JSSpinner(b,q.getElement("scale-distance-input"),{format:b.getLengthUnit().getFormat(),minimum:b.getLengthUnit().getMinimumLength(),maximum:o,stepSize:b.getLengthUnit().getStepSize()})};q.scaleStep.scaleDistanceLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","scaleDistanceLabel.text",h);q.registerEventListener(q.scaleStep.scaleDistanceInput,"input",function(s){a.setScaleDistance(q.scaleStep.scaleDistanceInput.getValue()!=null?parseFloat(q.scaleStep.scaleDistanceInput.getValue()):null)});var m=function(){var s=a.getScaleDistance();q.scaleStep.scaleDistanceInput.setNullable(s===null);q.scaleStep.scaleDistanceInput.setValue(s)};m();this.registerPropertyChangeListener(a,"SCALE_DISTANCE",m);var l=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_IN",true);var k=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_OUT",true);q.scaleStep.previewZoomIn.style.backgroundImage="url('"+l.getURL(AbstractAction.SMALL_ICON)+"')";q.registerEventListener(q.scaleStep.previewZoomIn,"click",function(s){q.scaleStep.preview.width*=2;q.repaintScaleCanvas()});q.scaleStep.previewZoomOut.style.backgroundImage="url('"+k.getURL(AbstractAction.SMALL_ICON)+"')";q.registerEventListener(q.scaleStep.previewZoomOut,"click",function(s){q.scaleStep.preview.width/=2;q.repaintScaleCanvas()});this.registerPropertyChangeListener(a,"SCALE_DISTANCE_POINTS",function(){q.repaintScaleCanvas()});q.repaintScaleCanvas();var j=this.scaleStep.preview;j.style.touchAction="none";var p=function(s){if(j.dragging){j.dragging=false;j.distanceStartPoint=j.distanceEndPoint=false}};var r=function(B){B.stopImmediatePropagation();var z=j.getBoundingClientRect();var v=B.touches&&B.touches.length>0?B.touches[0]:B;var D=v.clientX-z.left;var A=v.clientY-z.top;if(j.dragging){var u=j.width/q.selectedImage.width;var s=D/u;var F=A/u;var E=a.getScaleDistancePoints();var w;var C;if(j.distanceStartPoint){w=E[0];C=E[1]}else{w=E[1];C=E[0]}if(java.awt.geom.Point2D.distanceSq(C[0]*u,C[1]*u,s*u,F*u)>=4){if(B.shiftKey){var t=Math.abs(Math.atan2(C[1]-F,s-C[0]));if(t>Math.PI/4&&t<=3*Math.PI/4){s=C[0]}else{F=C[1]}}w[0]=s;w[1]=F;a.setScaleDistancePoints(E[0][0],E[0][1],E[1][0],E[1][1]);q.repaintScaleCanvas()}}else{j.distanceStartPoint=j.distanceEndPoint=false;var E=a.getScaleDistancePoints();var u=j.width/q.selectedImage.width;if(Math.abs(E[0][0]*u-D)<=c&&Math.abs(E[0][1]*u-A)<=c){j.distanceStartPoint=true}else{if(Math.abs(E[1][0]*u-D)<=c&&Math.abs(E[1][1]*u-A)<=c){j.distanceEndPoint=true}}if(j.distanceStartPoint||j.distanceEndPoint){j.style.cursor="crosshair"}else{j.style.cursor="default"}}};var n=function(s){s.stopImmediatePropagation();r(s);if(j.distanceStartPoint||j.distanceEndPoint){j.dragging=true}};this.registerEventListener(j,"mousedown",n,true);this.registerEventListener(j,"touchstart",n,true);this.registerEventListener(j,"mousemove",r,true);this.registerEventListener(j,"touchmove",r,true);this.registerEventListener(j,"mouseup",p,true);this.registerEventListener(j,"touchend",p,true)};g.prototype.repaintScaleCanvas=function(){var j=this.scaleStep.preview;var h=new Graphics2D(j);h.fillRect(0,0,j.width,j.height);var n=this.selectedImage;if(n){j.height=(n.height/n.width)*j.width;h.drawImageWithSize(n,0,0,j.width,j.height);h.setColor("blue");var o=h.getTransform();var l=j.width/n.width;h.scale(l,l);h.setStroke(new java.awt.BasicStroke(5/l,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));var q=this.controller.getScaleDistancePoints();h.draw(new java.awt.geom.Line2D.Float(q[0][0],q[0][1],q[1][0],q[1][1]));h.setStroke(new java.awt.BasicStroke(1/l,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));var m=Math.atan2(q[1][1]-q[0][1],q[1][0]-q[0][0]);var p=h.getTransform();h.translate(q[0][0],q[0][1]);h.rotate(m);var k=new java.awt.geom.Line2D.Double(0,5/l,0,-5/l);h.draw(k);h.setTransform(p);h.translate(q[1][0],q[1][1]);h.rotate(m);h.draw(k);h.setTransform(o)}};g.prototype.initOriginStep=function(){var p=this;var h=b.getLengthUnit().getName();var n=b.getLengthUnit().getMaximumLength();this.originStep={panel:this.findElement("[originStep]"),preview:this.findElement("[originStep] [preview] canvas"),previewZoomIn:this.findElement("[originStep] [previewZoomIn]"),previewZoomOut:this.findElement("[originStep] [previewZoomOut]"),xOriginLabel:this.getElement("x-origin-label"),xOriginInput:new JSSpinner(b,this.getElement("x-origin-input"),{format:b.getLengthUnit().getFormat(),value:a.getXOrigin(),minimum:-n,maximum:n,stepSize:b.getLengthUnit().getStepSize()}),yOriginLabel:this.getElement("y-origin-label"),yOriginInput:new JSSpinner(b,this.getElement("y-origin-input"),{format:b.getLengthUnit().getFormat(),value:a.getYOrigin(),minimum:-n,maximum:n,stepSize:b.getLengthUnit().getStepSize()})};this.originStep.xOriginLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","xOriginLabel.text",h);this.originStep.yOriginLabel.textContent=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","yOriginLabel.text",h);this.registerEventListener([this.originStep.xOriginInput,this.originStep.yOriginInput],"input",function(r){a.setOrigin(p.originStep.xOriginInput.getValue(),p.originStep.yOriginInput.getValue())});this.registerPropertyChangeListener(a,"X_ORIGIN",function(){p.originStep.xOriginInput.setValue(a.getXOrigin());p.repaintOriginCanvas()});this.registerPropertyChangeListener(a,"Y_ORIGIN",function(){p.originStep.yOriginInput.setValue(a.getYOrigin());p.repaintOriginCanvas()});var j=this.originStep.preview;var l=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_IN",true);var k=new ResourceAction(b,"BackgroundImageWizardStepsPanel","ZOOM_OUT",true);this.originStep.previewZoomIn.style.backgroundImage="url('"+l.getURL(AbstractAction.SMALL_ICON)+"')";this.registerEventListener(this.originStep.previewZoomIn,"click",function(r){p.originStep.preview.width*=2;p.repaintOriginCanvas()});this.originStep.previewZoomOut.style.backgroundImage="url('"+k.getURL(AbstractAction.SMALL_ICON)+"')";this.registerEventListener(this.originStep.previewZoomOut,"click",function(r){p.originStep.preview.width/=2;p.repaintOriginCanvas()});var o=function(r){p.isMovingOrigin=false;j.style.cursor="default"};var q=function(v){v.stopImmediatePropagation();if(p.isMovingOrigin){var t=j.getBoundingClientRect();var u=v.touches&&v.touches.length>0?v.touches[0]:v;var w=a.getScaleDistancePoints();var r=p.originStep.preview.width/p.selectedImage.width;r=r/BackgroundImage.getScale(a.getScaleDistance(),w[0][0],w[0][1],w[1][0],w[1][1]);var x=Math.round((u.clientX-t.left)/r*10)/10;var s=Math.round((u.clientY-t.top)/r*10)/10;a.setOrigin(x,s);p.repaintOriginCanvas()}};var m=function(r){p.isMovingOrigin=true;j.style.cursor="crosshair";q(r)};this.registerEventListener(j,"mousedown",m,true);this.registerEventListener(j,"touchstart",m,true);this.registerEventListener(j,"mousemove",q,true);this.registerEventListener(j,"touchmove",q,true);this.registerEventListener(j,"mouseup",o,true);this.registerEventListener(j,"touchend",o,true)};g.prototype.repaintOriginCanvas=function(){var h=this.originStep.preview;var j=new Graphics2D(h);j.fillRect(0,0,h.width,h.height);var l=this.selectedImage;if(l){h.height=(l.height/l.width)*h.width;j.drawImageWithSize(l,0,0,h.width,h.height);j.setColor("blue");var o=j.getTransform();var m=h.width/l.width;var k=this.controller.getScaleDistancePoints();m=m/BackgroundImage.getScale(this.controller.getScaleDistance(),k[0][0],k[0][1],k[1][0],k[1][1]);j.scale(m,m);j.translate(this.controller.getXOrigin(),this.controller.getYOrigin());var n=4/m;j.fill(new java.awt.geom.Ellipse2D.Float(-n,-n,n*2,n*2));j.setStroke(new java.awt.BasicStroke(1/m,java.awt.BasicStroke.CAP_BUTT,java.awt.BasicStroke.JOIN_BEVEL));j.draw(new java.awt.geom.Line2D.Double(8/m,0,-8/m,0));j.draw(new java.awt.geom.Line2D.Double(0,8/m,0,-8/m));j.setTransform(o)}};g.prototype.setImageChangeTexts=function(){this.imageChoiceStep.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChangeLabel.text").replace(/\<br\>/g," ");this.imageChoiceStep.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChangeButton.text")};g.prototype.setImageChoiceTexts=function(){this.imageChoiceStep.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChoiceLabel.text").replace(/\<br\>/g," ");this.imageChoiceStep.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("BackgroundImageWizardStepsPanel","imageChoiceButton.text")};g.prototype.updateImage=function(h){if(h==null){this.setImageChoiceTexts();this.updatePreviewComponentsImage()}else{this.setImageChangeTexts();setTimeout(function(){a.setImage(h.getImage());a.setScaleDistance(h.getScaleDistance());a.setScaleDistancePoints(h.getScaleDistanceXStart(),h.getScaleDistanceYStart(),h.getScaleDistanceXEnd(),h.getScaleDistanceYEnd());a.setOrigin(h.getXOrigin(),h.getYOrigin())},100)}};g.prototype.updateController=function(m,k){var j=this;var h=this.controller;var l=ImageTools.isImageWithAlpha(m)?"image/png":"image/jpeg";this.checkImageSize(m,l,function(o){var n=function(p){setTimeout(function(){h.setImage(p);j.setImageChangeTexts();var s=h.getReferenceBackgroundImage();if(s!=null&&s.getScaleDistanceXStart()<o.width&&s.getScaleDistanceXEnd()<o.width&&s.getScaleDistanceYStart()<o.height&&s.getScaleDistanceYEnd()<o.height){h.setScaleDistance(s.getScaleDistance());h.setScaleDistancePoints(s.getScaleDistanceXStart(),s.getScaleDistanceYStart(),s.getScaleDistanceXEnd(),s.getScaleDistanceYEnd());h.setOrigin(s.getXOrigin(),s.getYOrigin())}else{h.setScaleDistance(null);var q=o.width*0.1;var t=o.height/2;var r=o.width*0.9;h.setScaleDistancePoints(q,t,r,t);h.setOrigin(0,0)}},100)};if(m===o&&(k.type=="image/jpeg"||k.type=="image/png")){n(BlobURLContent.fromBlob(k))}else{BlobURLContent.fromImage(o,l,n)}})};g.prototype.checkImageSize=function(j,k,l){if(j.width*j.height<e){l(j)}else{var h=this;var m=Math.sqrt(d/(j.width*j.height));var q=Math.round(j.width*m);var p=Math.round(j.height*m);var o=function(){ImageTools.resize(j,q,p,l,k)};if(this.getUserPreferences().isImportedImageResizedWithoutPrompting()){o()}else{var n=new JSImageResizingDialog(b,"@{BackgroundImageWizardStepsPanel.reduceImageSize.title}",h.getLocalizedLabelText("BackgroundImageWizardStepsPanel","reduceImageSize.message",[j.width,j.height,q,p]),"@{BackgroundImageWizardStepsPanel.reduceImageSize.cancel}","@{BackgroundImageWizardStepsPanel.reduceImageSize.keepUnchanged}","@{BackgroundImageWizardStepsPanel.reduceImageSize.reduceSize}",o,function(){l(j)});n.displayView()}}};g.prototype.updatePreviewComponentsImage=function(){var h=this;var j=this.controller.getImage();delete this.imageChoiceStep.preview.src;this.imageChoiceStep.preview.width=0;delete this.scaleStep.preview.src;delete this.originStep.preview.src;if(j!=null){TextureManager.getInstance().loadTexture(j,{textureUpdated:function(k){h.imageChoiceStep.preview.src=k.src;h.imageChoiceStep.preview.width=k.width;h.selectedImage=k;if(k.width>400){h.scaleStep.preview.width=400;h.originStep.preview.width=400}h.repaintScaleCanvas();h.repaintOriginCanvas()},textureError:function(k){imageErrorListener(k)}})}};g.prototype.updateStep=function(){var h=this.controller.getStep();switch(h){case BackgroundImageWizardController.Step.CHOICE:this.imageChoiceStep.panel.style.display="flex";this.scaleStep.panel.style.display="none";this.originStep.panel.style.display="none";break;case BackgroundImageWizardController.Step.SCALE:this.imageChoiceStep.panel.style.display="none";this.scaleStep.panel.style.display="flex";delete this.scaleStep.panel.style.display;this.originStep.panel.style.display="none";break;case BackgroundImageWizardController.Step.ORIGIN:this.imageChoiceStep.panel.style.display="none";this.scaleStep.panel.style.display="none";this.originStep.panel.style.display="flex";break}};return new g()};JSViewFactory.prototype.createImportedFurnitureWizardStepsView=function(c,a,e,b,d){return null};JSViewFactory.prototype.createImportedTextureWizardStepsView=function(h,c,d,b){var g=640*640;var e=512;var f=e*e;function a(){JSComponent.call(this,d,"<div imageStep>  <div description>@{ImportedTextureWizardStepsPanel.imageChangeLabel.text}</div>  <div class='buttons'>    <button changeImage>@{ImportedTextureWizardStepsPanel.imageChangeButton.text}</button>    <button findImage>@{ImportedTextureWizardStepsPanel.findImagesButton.text}</button>    <input type='file' accept='image/*' style='display: none'/>  </div>  <div preview>    <img>  </div></div><div attributesStep>  <div description></div>  <div form>    <div preview>      <img />    </div>    <div>@{ImportedTextureWizardStepsPanel.nameLabel.text}</div>    <div>      <input type='text' name='name' />    </div>    <div>@{ImportedTextureWizardStepsPanel.categoryLabel.text}</div>    <div>      <select name='category'></select>    </div>    <div>@{ImportedTextureWizardStepsPanel.creatorLabel.text}</div>    <div>      <input type='text' name='creator' />    </div>    <div data-name='width-label' class='label-cell'></div>    <div>      <span data-name='width-input'></span>    </div>    <div data-name='height-label' class='label-cell'></div>    <div>      <span data-name='height-input'></span>    </div>  </div></div>");this.controller=b;this.userCategory=new TexturesCategory(ResourceAction.getLocalizedLabelText(d,"ImportedTextureWizardStepsPanel","userCategory"));this.getHTMLElement().classList.add("imported-texture-wizard");this.initComponents();var j=this;this.registerPropertyChangeListener(b,"STEP",function(k){j.updateStep()})}a.prototype=Object.create(JSComponent.prototype);a.prototype.constructor=a;a.prototype.initComponents=function(){this.imageStepPanel=this.findElement("[imageStep]");this.imageChoiceOrChangeLabel=this.findElement("[imageStep] [description]");this.imageChoiceOrChangeButton=this.findElement("button[changeImage]");this.imageFindImageButton=this.findElement("button[findImage]");this.imageChooserInput=this.findElement("input[type='file']");this.previewPanel=this.findElement("[preview]");if(h==null){this.setImageChoiceTexts()}this.attributesStepPanel=this.findElement("[attributesStep]");this.attributesStepPanelDescription=this.findElement("[attributesStep] [description]");this.attributesPreviewPanel=this.findElement("[attributesStep] [preview]");this.nameInput=this.findElement("input[name='name']");this.categorySelect=this.findElement("select[name='category']");this.creatorInput=this.findElement("input[name='creator']");var j=d.getLengthUnit().getName();var k=d.getLengthUnit().getMinimumLength();var q=d.getLengthUnit().getMaximumLength();this.widthLabel=this.getElement("width-label"),this.widthLabel.textContent=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","widthLabel.text",j);this.widthInput=new JSSpinner(d,this.getElement("width-input"),{format:d.getLengthUnit().getFormat(),minimum:k,maximum:q,stepSize:d.getLengthUnit().getStepSize()});this.heightLabel=this.getElement("height-label"),this.heightLabel.textContent=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","heightLabel.text",j);this.heightInput=new JSSpinner(d,this.getElement("height-input"),{format:d.getLengthUnit().getFormat(),minimum:k,maximum:q,stepSize:d.getLengthUnit().getStepSize()});var r=this;var n=function(s){console.warn("Error loading image: "+s);r.controller.setImage(null);r.setImageChoiceTexts();r.updatePreviewComponentsImage();alert(ResourceAction.getLocalizedLabelText(d,"ImportedTextureWizardStepsPanel","imageChoiceErrorLabel.text"))};this.registerEventListener(this.imageChoiceOrChangeButton,"click",function(s){r.imageChooserInput.click()});this.registerEventListener(this.imageFindImageButton,"click",function(t){try{var s=d.getLocalizedString("ImportedTextureWizardStepsPanel","findImagesButton.url");window.open(s,"_blank")}catch(u){this.imageFindImageButton.style.display="none"}});var l=function(t){if(t){var s=new FileReader();s.onload=function(u){var v=new Image();v.addEventListener("load",function(w){r.updateController(v,t)});v.addEventListener("error",n);v.src=u.target.result};s.onerror=n;s.readAsDataURL(t)}};this.registerEventListener(this.imageChooserInput,"input",function(s){l(this.files[0])});this.registerEventListener(this.previewPanel,"drop",function(s){s.preventDefault();l(s.dataTransfer.files[0])});this.registerEventListener(this.previewPanel,"dragover",function(s){s.preventDefault()});this.registerPropertyChangeListener(b,"IMAGE",function(s){r.updatePreviewComponentsImage()});this.registerPropertyChangeListener(b,"WIDTH",function(s){r.updatePreviewComponentsImage()});this.registerPropertyChangeListener(b,"HEIGHT",function(s){r.updatePreviewComponentsImage()});var p=d.getTexturesCatalog().getCategories();if(this.findUserCategory(p)==null){p=p.concat([this.userCategory])}for(var m=0;m<p.length;m++){var o=document.createElement("option");o.value=p[m].getName();o.textContent=p[m].getName();o._category=p[m];this.categorySelect.appendChild(o)}this.attributesStepPanelDescription.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","attributesLabel.text").replace(/\<br\>/g," ");this.registerPropertyChangeListener(b,"NAME",function(){if(r.nameInput.value.trim()!=b.getName()){r.nameInput.value=b.getName()}});this.registerEventListener(this.nameInput,"input",function(s){b.setName(r.nameInput.value.trim())});this.registerPropertyChangeListener(b,"CATEGORY",function(t){var s=b.getCategory();if(s!=null){r.categorySelect.value=s.getName()}});this.registerEventListener(this.categorySelect,"change",function(t){var s=r.categorySelect.item(r.categorySelect.selectedIndex)._category;b.setCategory(s)});this.registerPropertyChangeListener(b,"CREATOR",function(s){if(r.creatorInput.value.trim()!=b.getCreator()){r.creatorInput.value=b.getCreator()}});this.registerEventListener(r.creatorInput,"input",function(s){b.setCreator(r.creatorInput.value.trim())});this.registerPropertyChangeListener(b,"WIDTH",function(s){r.widthInput.setValue(b.getWidth())});this.registerEventListener(this.widthInput,"input",function(s){b.setWidth(parseFloat(r.widthInput.value))});this.registerPropertyChangeListener(b,"HEIGHT",function(s){r.heightInput.setValue(b.getHeight())});this.registerEventListener(this.heightInput,"input",function(s){b.setHeight(parseFloat(r.heightInput.value))});if(h!=null){TextureManager.getInstance().loadTexture(h.getImage(),{textureUpdated:function(s){r.updateController(s,h)},textureError:function(s){n(s)}})}};a.prototype.updateController=function(q,m){var l=this;var k=this.controller;this.setImageChangeTexts();if(m instanceof CatalogTexture){var p=m;setTimeout(function(){k.setImage(p.getImage());k.setName(p.getName());k.setCategory(p.getCategory());k.setCreator(p.getCreator());k.setWidth(p.getWidth());k.setHeight(p.getHeight())},100)}else{var j="Texture";if(m.name.lastIndexOf(".")>0){var o=m.name.split(/\/|\\|\./);if(o.length>1){j=o[o.length-2]}}var n=ImageTools.isImageWithAlpha(q)?"image/png":"image/jpeg";this.checkImageSize(q,n,function(s){var r=function(t){setTimeout(function(){k.setImage(t);k.setName(j);var u=l.preferences.getTexturesCatalog().getCategories();var v=l.findUserCategory(u)||l.userCategory;k.setCategory(v);k.setCreator(null);var w=l.preferences.getLengthUnit().isMetric()?20:LengthUnit.inchToCentimeter(8);k.setWidth(w);k.setHeight(w/s.width*s.height)},100)};if(q===s&&(m.type=="image/jpeg"||m.type=="image/png")){r(BlobURLContent.fromBlob(m))}else{BlobURLContent.fromImage(s,n,r)}})}};a.prototype.setImageChangeTexts=function(){this.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChangeLabel.text").replace(/\<br\>/g," ");this.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChangeButton.text")};a.prototype.setImageChoiceTexts=function(){this.imageChoiceOrChangeLabel.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChoiceLabel.text").replace(/\<br\>/g," ");this.imageChoiceOrChangeButton.innerHTML=this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","imageChoiceButton.text")};a.prototype.findUserCategory=function(j){var j=d.getTexturesCatalog().getCategories();for(var k=0;k<j.length;k++){if(j[k].equals(this.userCategory)){return j[k]}}return null};a.prototype.checkImageSize=function(j,k,l){if(j.width*j.height<g){l(j)}else{var n;var m=j.width/j.height;if(m<0.5||m>2){n=Math.sqrt(f/(j.width*j.height))}else{if(m<1){n=e/j.height}else{n=e/j.width}}var r=Math.round(j.width*n);var q=Math.round(j.height*n);var p=function(){ImageTools.resize(j,r,q,l,k)};if(this.getUserPreferences().isImportedImageResizedWithoutPrompting()){p()}else{var o=new JSImageResizingDialog(d,"@{ImportedTextureWizardStepsPanel.reduceImageSize.title}",this.getLocalizedLabelText("ImportedTextureWizardStepsPanel","reduceImageSize.message",[j.width,j.height,r,q]),"@{ImportedTextureWizardStepsPanel.reduceImageSize.cancel}","@{ImportedTextureWizardStepsPanel.reduceImageSize.keepUnchanged}","@{ImportedTextureWizardStepsPanel.reduceImageSize.reduceSize}",p,function(){l(j)});o.displayView()}}};a.prototype.updatePreviewComponentsImage=function(){this.previewPanel.innerHTML="";var m=new Image();if(this.controller.getImage()!==null){this.controller.getImage().getStreamURL({urlReady:function(n){m.src=n}})}this.previewPanel.appendChild(m);this.attributesPreviewPanel.innerHTML="";var l=document.createElement("div");l.style.backgroundImage="url('"+m.src+"')";l.style.backgroundRepeat="repeat";var k=this.controller.getWidth()/250;var j=this.controller.getHeight()/250;l.style.backgroundSize="calc(100% * "+k+") calc(100% * "+j+")";l.classList.add("image");this.attributesPreviewPanel.appendChild(l)};a.prototype.updateStep=function(){var j=this.controller.getStep();switch(j){case ImportedTextureWizardController.Step.IMAGE:this.imageStepPanel.style.display="block";this.attributesStepPanel.style.display="none";break;case ImportedTextureWizardController.Step.ATTRIBUTES:this.imageStepPanel.style.display="none";this.attributesStepPanel.style.display="block";break}};return new a()};JSViewFactory.prototype.createUserPreferencesView=function(r,u){var p=function(I){if(I instanceof JSComponent){I=I.getHTMLElement()}return window.getComputedStyle(I).display!=="none"};var z=function(J){J.parentElement.style.display="none";var I=J;while(I.parentElement!=null&&!I.parentElement.classList.contains("user-preferences-dialog")){I=I.parentElement}I.style.display="none";I.previousElementSibling.style.display="none"};var x=new JSDialog(r,"@{UserPreferencesPanel.preferences.title}",document.getElementById("user-preferences-dialog-template"),{applier:function(J){if(p(J.languageSelect)){var I=J.languageSelect.options[J.languageSelect.selectedIndex];u.setLanguage(I!=null?I.value:null)}if(p(J.furnitureCatalogViewTreeRadioButton)){u.setFurnitureCatalogViewedInTree(J.furnitureCatalogViewTreeRadioButton.checked)}if(p(J.navigationPanelCheckBox)){u.setNavigationPanelVisible(J.navigationPanelCheckBox.checked)}if(p(J.editingIn3DViewCheckBox)){u.setEditingIn3DViewEnabled(J.editingIn3DViewCheckBox.checked)}if(p(J.aerialViewCenteredOnSelectionCheckBox)){u.setAerialViewCenteredOnSelectionEnabled(J.aerialViewCenteredOnSelectionCheckBox.checked)}if(p(J.observerCameraSelectedAtChangeCheckBox)){u.setObserverCameraSelectedAtChange(J.observerCameraSelectedAtChangeCheckBox.checked)}if(p(J.magnetismCheckBox)){u.setMagnetismEnabled(J.magnetismCheckBox.checked)}if(p(J.rulersCheckBox)){u.setRulersVisible(J.rulersCheckBox.checked)}if(p(J.gridCheckBox)){u.setGridVisible(J.gridCheckBox.checked)}if(p(J.iconTopViewRadioButton)){u.setFurnitureViewedFromTop(J.iconTopViewRadioButton.checked)}if(p(J.iconSizeSelect)&&!J.iconSizeSelect.disabled){u.setFurnitureModelIconSize(parseInt(J.iconSizeSelect.value))}if(p(J.roomRenderingFloorColorOrTextureRadioButton)){u.setRoomFloorColoredOrTextured(J.roomRenderingFloorColorOrTextureRadioButton.checked)}if(p(J.newWallThicknessInput)){u.setNewWallThickness(parseFloat(J.newWallThicknessInput.getValue()))}if(p(J.newWallHeightInput)){u.setNewWallHeight(parseFloat(J.newWallHeightInput.getValue()))}if(p(J.newFloorThicknessInput)){u.setNewFloorThickness(parseFloat(J.newFloorThicknessInput.getValue()))}u.modifyUserPreferences()}});x.languageSelect=x.getElement("language-select");if(u.isPropertyEditable("LANGUAGE")){var j=r.getSupportedLanguages();for(var w=0;w<j.length;w++){var g=j[w].replace("_","-");var B=g;try{B=new Intl.DisplayNames([g,"en"],{type:"language"}).of(g);if(B==g){throw"No support for Intl.DisplayNames"}B=B.charAt(0).toUpperCase()+B.slice(1)}catch(C){B={bg:"",cs:"etina",de:"Deutsch",el:"",en:"English",es:"Espaol",fr:"Franais",it:"Italiano",ja:"",hu:"Magyar",nl:"Nederlands",pl:"Polski",pt:"Portugus","pt-BR":"Portugus (Brasil)",ru:"",sv:"Svenska",vi:"Ting Vit","zh-CN":"","zh-TW":""}[g];if(B===undefined){B=g;console.log("Unknown display name for "+g)}}var v=j[w]==u.getLanguage();var c=JSComponent.createOptionElement(j[w],B,v);x.languageSelect.appendChild(c)}}else{z(x.languageSelect)}x.unitSelect=x.getElement("unit-select");if(u.isPropertyEditable("UNIT")){x.unitSelect.appendChild(JSComponent.createOptionElement("MILLIMETER",r.getLocalizedString("UserPreferencesPanel","unitComboBox.millimeter.text"),u.getUnit()==LengthUnit.MILLIMETER));x.unitSelect.appendChild(JSComponent.createOptionElement("CENTIMETER",r.getLocalizedString("UserPreferencesPanel","unitComboBox.centimeter.text"),u.getUnit()==LengthUnit.CENTIMETER));x.unitSelect.appendChild(JSComponent.createOptionElement("METER",r.getLocalizedString("UserPreferencesPanel","unitComboBox.meter.text"),u.getUnit()==LengthUnit.METER));x.unitSelect.appendChild(JSComponent.createOptionElement("INCH",r.getLocalizedString("UserPreferencesPanel","unitComboBox.inch.text"),u.getUnit()==LengthUnit.INCH));x.unitSelect.appendChild(JSComponent.createOptionElement("INCH_FRACTION",r.getLocalizedString("UserPreferencesPanel","unitComboBox.inchFraction.text"),u.getUnit()==LengthUnit.INCH_FRACTION));x.unitSelect.appendChild(JSComponent.createOptionElement("INCH_DECIMALS",r.getLocalizedString("UserPreferencesPanel","unitComboBox.inchDecimals.text"),u.getUnit()==LengthUnit.INCH_DECIMALS));x.unitSelect.appendChild(JSComponent.createOptionElement("FOOT_DECIMALS",r.getLocalizedString("UserPreferencesPanel","unitComboBox.footDecimals.text"),u.getUnit()==LengthUnit.FOOT_DECIMALS));x.registerEventListener(x.unitSelect,"change",function(J){var I=x.unitSelect.options[x.unitSelect.selectedIndex];u.setUnit(I!=null?LengthUnit[I.value]:null)})}else{z(x.unitSelect)}x.currencySelect=x.getElement("currency-select");x.valueAddedTaxCheckBox=x.getElement("value-added-tax-checkbox");var l=x.getLocalizedLabelText("UserPreferencesPanel","currencyComboBox.noCurrency.text");if(u.isPropertyEditable("CURRENCY")){x.currencySelect.appendChild(JSComponent.createOptionElement("",l,!u.getCurrency()));var d={EUR:"EUR ",AED:"AED AED",AFN:"AFN ",ALL:"ALL Lek",AMD:"AMD ",ANG:"ANG NAf.",AOA:"AOA Kz",ARS:"ARS $",AUD:"AUD $",AWG:"AWG Afl.",AZN:"AZN ",BAM:"BAM KM",BBD:"BBD $",BDT:"BDT ",BGN:"BGN .",BHD:"BHD ..",BIF:"BIF FBu",BMD:"BMD $",BND:"BND $",BOB:"BOB Bs",BRL:"BRL R$",BSD:"BSD $",BTN:"BTN Nu.",BWP:"BWP P",BYN:"BYN Br",BZD:"BZD $",CAD:"CAD $",CDF:"CDF FC",CHF:"CHF CHF",CLP:"CLP $",CNY:"CNY ",COP:"COP $",CRC:"CRC ",CSD:"CSD CSD",CUP:"CUP $",CVE:"CVE ",CZK:"CZK K",DJF:"DJF Fdj",DKK:"DKK kr",DOP:"DOP RD$",DZD:"DZD DA",EGP:"EGP ..",ERN:"ERN Nfk",ETB:"ETB Br",EUR:"EUR ",FJD:"FJD $",FKP:"FKP ",GBP:"GBP ",GEL:"GEL ",GHS:"GHS GH",GIP:"GIP ",GMD:"GMD D",GNF:"GNF FG",GTQ:"GTQ Q",GYD:"GYD $",HKD:"HKD HK$",HNL:"HNL L",HRK:"HRK HRK",HTG:"HTG G",HUF:"HUF Ft",IDR:"IDR Rp",ILS:"ILS ",INR:"INR ",IQD:"IQD ..",IRR:"IRR IRR",ISK:"ISK ISK",JMD:"JMD $",JOD:"JOD ..",JPY:"JPY ",KES:"KES Ksh",KGS:"KGS ",KHR:"KHR ",KMF:"KMF CF",KPW:"KPW KPW",KRW:"KRW ",KWD:"KWD ..",KYD:"KYD $",KZT:"KZT ",LAK:"LAK ",LBP:"LBP ..",LKR:"LKR Rs.",LRD:"LRD $",LSL:"LSL LSL",LYD:"LYD ..",MAD:"MAD MAD",MDL:"MDL L",MGA:"MGA Ar",MKD:"MKD den",MMK:"MMK K",MNT:"MNT ",MOP:"MOP MOP$",MRU:"MRU UM",MUR:"MUR Rs",MWK:"MWK MK",MXN:"MXN $",MYR:"MYR RM",MZN:"MZN MTn",NAD:"NAD $",NGN:"NGN ",NIO:"NIO C$",NOK:"NOK kr",NPR:"NPR ",NZD:"NZD $",OMR:"OMR ..",PAB:"PAB B/.",PEN:"PEN S/",PGK:"PGK K",PHP:"PHP ",PKR:"PKR ",PLN:"PLN z",PYG:"PYG Gs.",QAR:"QAR ..",RON:"RON RON",RSD:"RSD RSD",RUB:"RUB ",RWF:"RWF RF",SAR:"SAR ..",SBD:"SBD $",SCR:"SCR SR",SDG:"SDG SDG",SEK:"SEK kr",SGD:"SGD $",SHP:"SHP ",SLL:"SLL Le",SOS:"SOS S",SRD:"SRD $",SSP:"SSP ",STN:"STN Db",SVC:"SVC C",SYP:"SYP LS",SZL:"SZL E",THB:"THB ",TJS:"TJS .",TMT:"TMT TMT",TND:"TND DT",TOP:"TOP T$",TRY:"TRY ",TTD:"TTD $",TWD:"TWD $",TZS:"TZS TSh",UAH:"UAH ",UGX:"UGX USh",USD:"USD $",UYU:"UYU $",UZS:"UZS ",VES:"VES Bs.S",VND:"VND ",VUV:"VUV VT",WST:"WST WS$",XAF:"XAF FCFA",XCD:"XCD $",XOF:"XOF CFA",XPF:"XPF FCFP",YER:"YER ..",ZAR:"ZAR R",ZMW:"ZMW K",ZWL:"ZWL ZWL"};var A=Object.keys(d);for(var w=0;w<A.length;w++){var o=A[w];var n=d[o];x.currencySelect.appendChild(JSComponent.createOptionElement(o,n,o==u.getCurrency()))}x.registerEventListener(x.currencySelect,"change",function(K){var I=x.currencySelect.selectedIndex;var J=x.currencySelect.options[I].value;u.setCurrency(J?J:null)});x.registerPropertyChangeListener(u,"CURRENCY",function(J){var I=x.currencySelect.querySelector("[value='"+(u.getCurrency()?u.getCurrency():"")+"']");I.selected=true;x.valueAddedTaxCheckBox.disabled=u.getCurrency()==null});var E=u.isPropertyEditable("VALUE_ADDED_TAX_ENABLED");x.valueAddedTaxCheckBox.parentElement.style.display=E?"initial":"none";x.valueAddedTaxCheckBox.disabled=u.getCurrency()==null;x.valueAddedTaxCheckBox.checked=u.isValueAddedTaxEnabled();x.registerEventListener(x.valueAddedTaxCheckBox,"change",function(I){u.setValueAddedTaxEnabled(x.valueAddedTaxCheckBox.checked)});x.registerPropertyChangeListener(u,"VALUE_ADDED_TAX_ENABLED",function(I){x.valueAddedTaxCheckBox.disabled=u.getCurrency()==null;x.valueAddedTaxCheckBox.checked=u.isValueAddedTaxEnabled()})}else{z(x.currencySelect)}x.furnitureCatalogViewTreeRadioButton=x.findElement("[name='furniture-catalog-view-radio'][value='tree']");if(u.isPropertyEditable("FURNITURE_CATALOG_VIEWED_IN_TREE")&&false){var b=u.isFurnitureCatalogViewedInTree()?"tree":"list";x.findElement("[name='furniture-catalog-view-radio'][value='"+b+"']").checked=true}else{z(x.furnitureCatalogViewTreeRadioButton)}x.navigationPanelCheckBox=x.getElement("navigation-panel-checkbox");if(u.isPropertyEditable("NAVIGATION_PANEL_VISIBLE")){x.navigationPanelCheckBox.checked=u.isNavigationPanelVisible()}else{z(x.navigationPanelCheckBox)}x.editingIn3DViewCheckBox=x.getElement("editing-in-3D-view-checkbox");if(u.isPropertyEditable("EDITING_IN_3D_VIEW_ENABLED")){x.editingIn3DViewCheckBox.checked=u.isEditingIn3DViewEnabled()}else{z(x.editingIn3DViewCheckBox)}x.aerialViewCenteredOnSelectionCheckBox=x.getElement("aerial-view-centered-on-selection-checkbox");if(u.isPropertyEditable("AERIAL_VIEW_CENTERED_ON_SELECTION_ENABLED")){x.aerialViewCenteredOnSelectionCheckBox.checked=u.isAerialViewCenteredOnSelectionEnabled()}else{z(x.aerialViewCenteredOnSelectionCheckBox)}x.observerCameraSelectedAtChangeCheckBox=x.getElement("observer-camera-selected-at-change-checkbox");if(u.isPropertyEditable("OBSERVER_CAMERA_SELECTED_AT_CHANGE")){x.observerCameraSelectedAtChangeCheckBox.checked=u.isObserverCameraSelectedAtChange()}else{z(x.observerCameraSelectedAtChangeCheckBox)}x.magnetismCheckBox=x.getElement("magnetism-checkbox");if(u.isPropertyEditable("MAGNETISM_ENABLED")){x.magnetismCheckBox.checked=u.isMagnetismEnabled()}else{z(x.magnetismCheckBox)}x.rulersCheckBox=x.getElement("rulers-checkbox");if(u.isPropertyEditable("RULERS_VISIBLE")&&false){x.rulersCheckBox.checked=u.isRulersVisible()}else{z(x.rulersCheckBox)}x.gridCheckBox=x.getElement("grid-checkbox");if(u.isPropertyEditable("GRID_VISIBLE")){x.gridCheckBox.checked=u.isGridVisible()}else{z(x.gridCheckBox)}x.defaultFontNameSelect=x.getElement("default-font-name-select");if(u.isPropertyEditable("DEFAULT_FONT_NAME")){var D="DEFAULT_SYSTEM_FONT_NAME";var a=function(){var I=u.getDefaultFontName()==null?D:u.getDefaultFontName();var J=x.defaultFontNameSelect.querySelector("[value='"+I+"']");if(J){J.selected=true}};CoreTools.loadAvailableFontNames(function(L){L=[D].concat(L);for(var K=0;K<L.length;K++){var I=L[K];var J=K==0?x.getLocalizedLabelText("FontNameComboBox","systemFontName"):I;x.defaultFontNameSelect.appendChild(JSComponent.createOptionElement(I,J))}a()});x.registerPropertyChangeListener(u,"DEFAULT_FONT_NAME",a);x.registerEventListener(x.defaultFontNameSelect,"change",function(J){var I=x.defaultFontNameSelect.querySelector("option:checked").value;u.setDefaultFontName(I==D?null:I)})}else{z(x.defaultFontNameSelect)}x.iconTopViewRadioButton=x.findElement("[name='furniture-icon-radio'][value='topView']");x.iconSizeSelect=x.getElement("icon-size-select");if(u.isPropertyEditable("FURNITURE_VIEWED_FROM_TOP")){var k=u.isFurnitureViewedFromTop()?"topView":"catalog";x.findElement("[name='furniture-icon-radio'][value='"+k+"']").checked=true;var q=[128,256,512,1024];for(var w=0;w<q.length;w++){var t=q[w];x.iconSizeSelect.appendChild(JSComponent.createOptionElement(t,t+""+t,u.getFurnitureModelIconSize()==t))}var F=function(I){I.iconSizeSelect.disabled=!I.iconTopViewRadioButton.checked};F(x);x.registerEventListener(x.findElements("[name='furniture-icon-radio']"),"change",function(I){F(x)})}else{z(x.iconTopViewRadioButton)}x.roomRenderingFloorColorOrTextureRadioButton=x.findElement("[name='room-rendering-radio'][value='floorColorOrTexture']");if(u.isPropertyEditable("ROOM_FLOOR_COLORED_OR_TEXTURED")){var s=u.isRoomFloorColoredOrTextured()?"floorColorOrTexture":"monochrome";x.findElement("[name='room-rendering-radio'][value='"+s+"']").checked=true}else{z(x.roomRenderingFloorColorOrTextureRadioButton)}var H=x.getElement("new-wall-pattern-select");if(u.isPropertyEditable("NEW_WALL_PATTERN")){var G={};var e=r.getPatternsCatalog().getPatterns();for(var w=0;w<e.length;w++){var m=e[w].getImage().getURL();G[m]=e[w]}H.classList.add("wall-pattern-combo-box");x.patternComboBox=new JSComboBox(r,H,{availableValues:Object.keys(G),renderCell:function(I,J){J.style.backgroundImage="url('"+I+"')"},selectionChanged:function(I){u.setNewWallPattern(G[I])}});var y=(u.getNewWallPattern()!=null?u.getNewWallPattern():u.getWallPattern()).getImage().getURL();x.patternComboBox.setSelectedItem(y);x.registerPropertyChangeListener(u,"NEW_WALL_PATTERN",function(){var I=u.getNewWallPattern().getImage().getURL();x.patternComboBox.setSelectedItem(I)})}else{z(x.newWallPatternSelect)}x.newWallThicknessInput=new JSSpinner(r,x.getElement("new-wall-thickness-input"),{value:1,minimum:0,maximum:100000});if(u.isPropertyEditable("NEW_WALL_THICKNESS")){x.newWallThicknessInput.setValue(u.getNewWallThickness())}else{z(x.newWallThicknessInput)}x.newWallHeightInput=new JSSpinner(r,x.getElement("new-wall-height-input"),{value:1,minimum:0,maximum:100000});if(u.isPropertyEditable("NEW_WALL_HEIGHT")){x.newWallHeightInput.setValue(u.getNewWallHeight())}else{z(x.newWallHeightInput)}x.newFloorThicknessInput=new JSSpinner(r,x.getElement("new-floor-thickness-input"),{value:1,minimum:0,maximum:100000});if(u.isPropertyEditable("NEW_FLOOR_THICKNESS")){x.newFloorThicknessInput.setValue(u.getNewFloorThickness())}else{z(x.newFloorThicknessInput)}var h=function(K,I,J){if(u.getUnit().isMetric()){K.setStepSize(I)}else{K.setStepSize(J)}K.setMinimum(u.getUnit().getMinimumLength());if(K.getMinimum()>K.getValue()){K.setValue(K.getMinimum())}K.setFormat(u.getUnit().getFormat())};var f=function(){h(x.newWallThicknessInput,LengthUnit.CENTIMETER.getStepSize(),LengthUnit.INCH.getStepSize());h(x.newWallHeightInput,LengthUnit.CENTIMETER.getStepSize()*20,LengthUnit.INCH.getStepSize()*16);h(x.newFloorThicknessInput,LengthUnit.CENTIMETER.getStepSize(),LengthUnit.INCH.getStepSize())};f();x.registerPropertyChangeListener(u,"UNIT",function(I){f()});return x};JSViewFactory.prototype.createLevelView=function(l,p){var t=new JSDialog(l,"@{LevelPanel.level.title}",document.getElementById("level-dialog-template"),{size:"medium",applier:function(){p.modifyLevels()}});var k=l.getLengthUnit().getName();var u=t.getElement("viewable-checkbox");var o=p.isPropertyEditable("VIEWABLE")?"initial":"none";u.parentElement.style.display=o;u.checked=p.getViewable();t.registerEventListener(u,"change",function(z){p.setViewable(u.checked)});t.registerPropertyChangeListener(p,"VIEWABLE",function(z){u.checked=p.getViewable()});var e=t.getElement("name-input");var j=p.isPropertyEditable("NAME")?"initial":"none";e.parentElement.style.display=j;e.parentElement.previousElementSibling.style.display=j;e.value=p.getName()!=null?p.getName():"";t.registerEventListener(e,"input",function(A){var z=e.value;if(z.trim().length==0){p.setName(null)}else{p.setName(z)}});t.registerPropertyChangeListener(p,"NAME",function(z){e.value=p.getName()!=null?p.getName():""});var x=l.getLengthUnit().getMinimumLength();var w=l.getLengthUnit().getMaximumLength();var g=function(){var A=p.getSelectedLevelIndex();if(A!=null){var z=p.getLevels();t.floorThicknessInput.setEnabled(z[A].getElevation()!=z[0].getElevation())}};var a=function(){var A=p.getSelectedLevelIndex();if(A!=null){var z=p.getLevels();t.increaseElevationButton.disabled=!(A<z.length-1&&z[A].getElevation()==z[A+1].getElevation());t.decreaseElevationButton.disabled=!(A>0&&z[A].getElevation()==z[A-1].getElevation())}else{t.increaseElevationButton.setEnabled(false);t.decreaseElevationButton.setEnabled(false)}};var c=p.isPropertyEditable("ELEVATION")?"initial":"none";t.getElement("elevation-label").textContent=t.getLocalizedLabelText("LevelPanel","elevationLabel.text",k);var d=new JSSpinner(l,t.getElement("elevation-input"),{nullable:p.getElevation()==null,format:l.getLengthUnit().getFormat(),value:p.getElevation(),minimum:-1000,maximum:l.getLengthUnit().getMaximumElevation(),stepSize:l.getLengthUnit().getStepSize()});d.parentElement.style.display=c;d.parentElement.previousElementSibling.style.display=c;t.registerEventListener(d,"input",function(z){p.setElevation(d.getValue());g();a()});t.registerPropertyChangeListener(p,"ELEVATION",function(z){d.setValue(z.getNewValue())});var h=p.isPropertyEditable("FLOOR_THICKNESS")?"initial":"none";t.getElement("floor-thickness-label").textContent=t.getLocalizedLabelText("LevelPanel","floorThicknessLabel.text",k);var m=new JSSpinner(l,t.getElement("floor-thickness-input"),{nullable:p.getFloorThickness()==null,format:l.getLengthUnit().getFormat(),value:p.getFloorThickness(),minimum:x,maximum:w/10,stepSize:l.getLengthUnit().getStepSize()});m.parentElement.style.display=h;m.parentElement.previousElementSibling.style.display=h;t.registerEventListener(m,"input",function(z){p.setFloorThickness(m.getValue())});t.registerPropertyChangeListener(p,"FLOOR_THICKNESS",function(z){m.setValue(z.getNewValue())});t.floorThicknessInput=m;g(p);var y=p.isPropertyEditable("HEIGHT")?"initial":"none";t.getElement("height-label").textContent=t.getLocalizedLabelText("LevelPanel","heightLabel.text",k);var n=new JSSpinner(l,t.getElement("height-input"),{nullable:p.getHeight()==null,format:l.getLengthUnit().getFormat(),value:p.getHeight(),minimum:x,maximum:w,stepSize:l.getLengthUnit().getStepSize()});n.parentElement.style.display=y;n.parentElement.previousElementSibling.style.display=y;t.registerEventListener(n,"input",function(z){p.setHeight(n.getValue())});t.registerPropertyChangeListener(p,"HEIGHT",function(z){n.setValue(z.getNewValue())});var s=p.isPropertyEditable("ELEVATION_INDEX")?"initial":"none";var b=new ResourceAction(l,"LevelPanel","INCREASE_ELEVATION_INDEX",true);var f=new ResourceAction(l,"LevelPanel","DECREASE_ELEVATION_INDEX",true);t.increaseElevationButton=t.getElement("increase-elevation-index-button");t.increaseElevationButton.style.backgroundImage="url('"+b.getURL(AbstractAction.SMALL_ICON)+"')";t.increaseElevationButton.style.display=s;t.registerEventListener(t.increaseElevationButton,"click",function(z){p.setElevationIndex(p.getElevationIndex()+1);a()});t.decreaseElevationButton=t.getElement("decrease-elevation-index-button");t.decreaseElevationButton.style.backgroundImage="url('"+f.getURL(AbstractAction.SMALL_ICON)+"')";t.decreaseElevationButton.style.display=s;t.registerEventListener(t.decreaseElevationButton,"click",function(z){p.setElevationIndex(p.getElevationIndex()-1);a()});a();var v=t.getElement("levels-table").querySelector("tbody");var r=function(){var B=p.getSelectedLevelIndex();var z=v.querySelector(".selected");if(z!=null){z.classList.remove("selected")}if(B!=null){var A=v.childElementCount-B-1;v.children[A].classList.add("selected")}};var q=function(){var D=p.getLevels();var B="";var z=l.getLengthUnit().getFormat();for(var C=D.length-1;C>=0;C--){var E=D[C];var A=E.isViewable()?"":"disabled";B+="<tr "+A+">  <td>"+E.getName()+"</td>  <td>"+z.format(E.getElevation())+"</td>  <td>"+(E.getElevation()==D[0].getElevation()?"":z.format(E.getFloorThickness()))+"</td>  <td>"+z.format(E.getHeight())+"</td></tr>"}v.innerHTML=B;r()};q();t.registerPropertyChangeListener(p,"SELECT_LEVEL_INDEX",r);t.registerPropertyChangeListener(p,"LEVELS",q);return t};JSViewFactory.prototype.createHomeFurnitureView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{HomeFurniturePanel.homeFurniture.title}",document.getElementById("home-furniture-dialog-template"),{applier:function(){a.modifyFurniture()},disposer:function(f){f.paintPanel.colorButton.dispose();f.paintPanel.textureComponent.dispose()}});this.initNameAndPricePanel();this.initLocationPanel();this.initPaintPanel();this.initOrientationPanel();this.initSizePanel();this.initShininessPanel();var e=this;if(this.controller.isPropertyEditable("VISIBLE")){var d=this.getElement("visible-checkbox");d.checked=this.controller.getVisible();this.registerPropertyChangeListener(this.controller,"VISIBLE",function(f){d.checked=f.getNewValue()});this.registerEventListener(d,"change",function(f){e.controller.setVisible(d.checked)})}if(this.controller.isPropertyEditable("PAINT")){this.updatePaintRadioButtons()}}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initNameAndPricePanel=function(){var n=this.getElement("name-and-price-title");n.textContent=this.getLocalizedLabelText("HomeFurniturePanel",a.isPropertyEditable("PRICE")?"nameAndPricePanel.title":"namePanel.title");var p=this.getElement("name-label");var q=this.getElement("name-input");var r=this.getElement("name-visible-checkbox");var e=this.getElement("description-label");var f=this.getElement("description-input");var m=this.getElement("price-label");var o=new JSSpinner(this.preferences,this.getElement("price-input"),{nullable:this.controller.getPrice()==null,value:0,minimum:0,maximum:1000000000});var g=new JSSpinner(this.preferences,this.getElement("value-added-tax-percentage-input"),{nullable:this.controller.getValueAddedTaxPercentage()==null,value:0,minimum:0,maximum:100,stepSize:0.5});var h=this.controller.isPropertyEditable("NAME")?"initial":"none";var l=this.controller.isPropertyEditable("NAME_VISIBLE")?"initial":"none";var k=this.controller.isPropertyEditable("DESCRIPTION")?"initial":"none";var j=this.controller.isPropertyEditable("PRICE")?"inline-block":"none";var d=this.controller.isPropertyEditable("VALUE_ADDED_TAX_PERCENTAGE")?"inline-block":"none";p.style.display=h;q.style.display=h;r.parentElement.style.display=l;e.style.display=k;f.style.display=k;e.parentElement.style.display=k;f.parentElement.style.display=k;m.style.display=j;o.style.display=j;m.parentElement.style.display=j;o.parentElement.style.display=j;g.getHTMLElement().previousElementSibling.style.display=d;g.style.display=d;q.value=a.getName()!=null?a.getName():"";r.checked=this.controller.getNameVisible();f.value=a.getDescription()!=null?a.getDescription():"";o.setValue(this.controller.getPrice());if(this.controller.getValueAddedTaxPercentage()){g.setValue(this.controller.getValueAddedTaxPercentage()*100)}this.registerPropertyChangeListener(this.controller,"NAME",function(s){q.value=a.getName()!=null?a.getName():""});this.registerPropertyChangeListener(this.controller,"NAME_VISIBLE",function(s){r.checked=a.getNameVisible()});this.registerPropertyChangeListener(this.controller,"DESCRIPTION",function(s){f.value=a.getDescription()!=null?a.getDescription():""});this.registerPropertyChangeListener(this.controller,"PRICE",function(s){o.setValue(a.getPrice())});this.registerPropertyChangeListener(this.controller,"VALUE_ADDED_TAX_PERCENTAGE",function(s){if(a.getValueAddedTaxPercentage()){g.setValue(a.getValueAddedTaxPercentage()*100)}else{g.setValue(null)}});this.registerEventListener(q,"input",function(t){var s=q.value;if(s.trim().length==0){a.setName(null)}else{a.setName(s)}});this.registerEventListener(r,"change",function(s){a.setNameVisible(r.checked)});this.registerEventListener(f,"input",function(t){var s=f.value;if(s.trim().length==0){a.setDescription(null)}else{a.setDescription(s)}});this.registerEventListener(o,"input",function(s){a.setPrice(o.getValue()!=null?new Big(o.getValue()):null)});this.registerEventListener(g,"input",function(t){var s=g.getValue();a.setValueAddedTaxPercentage(s!=null?new Big(s/100):null)})};c.prototype.initLocationPanel=function(){var h=this.getElement("x-label");var j=new JSSpinner(this.preferences,this.getElement("x-input"),{nullable:this.controller.getX()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var o=this.getElement("y-label");var n=new JSSpinner(this.preferences,this.getElement("y-input"),{nullable:this.controller.getY()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var r=this.getElement("elevation-label");var s=new JSSpinner(this.preferences,this.getElement("elevation-input"),{nullable:this.controller.getElevation()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var u=this.getElement("mirrored-model-checkbox");var q=this.getElement("base-plan-item-checkbox");var p=this.controller.isPropertyEditable("X")?"initial":"none";var m=this.controller.isPropertyEditable("Y")?"initial":"none";var t=this.controller.isPropertyEditable("ELEVATION")?"initial":"none";var g=this.controller.isPropertyEditable("MODEL_MIRRORED")?"initial":"none";var e=this.controller.isPropertyEditable("BASE_PLAN_ITEM")?"initial":"none";h.style.display=p;j.getHTMLElement().parentElement.style.display=p;o.style.display=m;n.getHTMLElement().parentElement.style.display=m;r.style.display=t;s.getHTMLElement().parentElement.style.display=t;u.parentElement.style.display=g;q.parentElement.style.display=e;j.setValue(this.controller.getX());n.setValue(this.controller.getY());s.setValue(this.controller.getElevation());u.checked=this.controller.getModelMirrored();q.checked=this.controller.getBasePlanItem();var f=this.preferences.getLengthUnit().getName();h.textContent=this.getLocalizedLabelText("HomeFurniturePanel","xLabel.text",f);o.textContent=this.getLocalizedLabelText("HomeFurniturePanel","yLabel.text",f);r.textContent=this.getLocalizedLabelText("HomeFurniturePanel","elevationLabel.text",f);var l=this.preferences.getLengthUnit().getMaximumLength();var d=this.preferences.getLengthUnit().getMaximumElevation();j.setMinimum(-l);n.setMinimum(-l);j.setMaximum(l);n.setMaximum(l);s.setMinimum(0);s.setMaximum(d);var k=this.controller;this.registerPropertyChangeListener(this.controller,"X",function(v){j.setValue(k.getX())});this.registerPropertyChangeListener(this.controller,"Y",function(v){n.setValue(k.getY())});this.registerPropertyChangeListener(this.controller,"ELEVATION",function(v){s.setValue(k.getElevation())});this.registerPropertyChangeListener(this.controller,"MODEL_MIRRORED",function(v){u.checked=k.getModelMirrored()});this.registerPropertyChangeListener(this.controller,"BASE_PLAN_ITEM",function(v){q.checked=k.getBasePlanItem()});this.registerEventListener(j,"input",function(v){k.setX(j.getValue())});this.registerEventListener(n,"input",function(v){k.setY(n.getValue())});this.registerEventListener(s,"input",function(v){k.setElevation(s.getValue())});this.registerEventListener(u,"change",function(v){k.setModelMirrored(u.checked)});this.registerEventListener(q,"change",function(v){k.setBasePlanItem(q.checked)});this.locationPanel={element:this.findElement(".location-panel"),elevationInput:s}};c.prototype.initOrientationPanel=function(){var p=this.controller;var f=this.getElement("angle-label");var e=new DecimalFormat("0.#");var j=new JSSpinner(this.preferences,this.getElement("angle-input"),{nullable:this.controller.getAngle()==null,format:e,minimum:0,maximum:360});var g=this.findElement("[name='horizontal-rotation-radio'][value='ROLL']");var q=this.findElement("[name='horizontal-rotation-radio'][value='PITCH']");var l=new JSSpinner(this.preferences,this.getElement("roll-input"),{nullable:this.controller.getRoll()==null,format:e,minimum:0,maximum:360});var t=new JSSpinner(this.preferences,this.getElement("pitch-input"),{nullable:this.controller.getPitch()==null,format:e,minimum:0,maximum:360});var s=this.getElement("vertical-rotation-label");var w=this.getElement("horizontal-rotation-label");var v=this.getElement("furniture-orientation-image");v.innerHTML="<img src='"+ZIPTools.getScriptFolder()+"resources/furnitureOrientation.png' />";var k=this.controller.isPropertyEditable("ANGLE_IN_DEGREES")||this.controller.isPropertyEditable("ANGLE")?"initial":"none";var u=this.controller.isPropertyEditable("ROLL")?"initial":"none";var r=this.controller.isPropertyEditable("PITCH")?"initial":"none";var n=this.controller.isPropertyEditable("ROLL")&&this.controller.isPropertyEditable("PITCH");var o=n?"initial":"none";var h=o;var m=this.controller.isTexturable()&&n?"initial":"none";f.style.display=k;j.getHTMLElement().parentElement.style.display=k;g.parentElement.style.display=u;l.getHTMLElement().parentElement.style.display=u;q.parentElement.style.display=r;t.getHTMLElement().parentElement.style.display=r;w.style.display=h;s.style.display=o;v.style.display=m;if(this.controller.getAngle()!=null){j.setValue(Math.toDegrees(this.controller.getAngle()))}else{j.setValue(null)}if(this.controller.getRoll()!=null){l.setValue(Math.toDegrees(this.controller.getRoll()))}else{l.setValue(null)}if(this.controller.getPitch()!=null){t.setValue(Math.toDegrees(this.controller.getPitch()))}else{t.setValue(null)}var d=function(){g.checked=p.getHorizontalAxis()==HomeFurnitureController.FurnitureHorizontalAxis.ROLL;q.checked=p.getHorizontalAxis()==HomeFurnitureController.FurnitureHorizontalAxis.PITCH};d();this.registerPropertyChangeListener(this.controller,"ANGLE",function(x){if(p.getAngle()!=null){j.setValue(Math.toDegrees(p.getAngle()))}else{j.setValue(null)}});this.registerPropertyChangeListener(this.controller,"ROLL",function(x){if(p.getRoll()!=null){l.setValue(Math.toDegrees(p.getRoll()))}else{l.setValue(null)}});this.registerPropertyChangeListener(this.controller,"PITCH",function(x){if(p.getPitch()!=null){t.setValue(Math.toDegrees(p.getPitch()))}else{t.setValue(null)}});this.registerPropertyChangeListener(this.controller,"HORIZONTAL_AXIS",function(x){d()});this.registerEventListener(j,"input",function(x){if(j.getValue()==null){p.setAngle(null)}else{p.setAngle(Math.toRadians(j.getValue()))}});this.registerEventListener(l,"input",function(x){if(l.getValue()==null){p.setRoll(null)}else{p.setRoll(Math.toRadians(l.getValue()));p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.ROLL)}});this.registerEventListener(t,"input",function(x){if(t.getValue()==null){p.setPitch(null)}else{p.setPitch(Math.toRadians(t.getValue()));p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.PITCH)}});this.registerEventListener([g,q],"change",function(x){if(g.checked){p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.ROLL)}else{p.setHorizontalAxis(HomeFurnitureController.FurnitureHorizontalAxis.PITCH)}});if(!n){this.findElement(".orientation-column").style.display="none";this.locationPanel.elevationInput.parentElement.insertAdjacentElement("afterend",f);f.insertAdjacentElement("afterend",j.parentElement)}};c.prototype.initPaintPanel=function(){var l=this;var h=this.controller;var g=this.preferences;var p=new ColorButton(g,{colorChanged:function(q){n[HomeFurnitureController.FurniturePaint.COLORED].checked=true;h.setPaint(HomeFurnitureController.FurniturePaint.COLORED);h.setColor(q)}});this.attachChildComponent("color-button",p);p.setColor(h.getColor());p.setColorDialogTitle(g.getLocalizedString("HomeFurniturePanel","colorDialog.title"));var o=h.getTextureController().getView();this.attachChildComponent("texture-component",o);var e=h.getPaint();var n=[];n[HomeFurnitureController.FurniturePaint.DEFAULT]=l.findElement("[name='paint-checkbox'][value='default']");n[HomeFurnitureController.FurniturePaint.COLORED]=l.findElement("[name='paint-checkbox'][value='color']");n[HomeFurnitureController.FurniturePaint.TEXTURED]=l.findElement("[name='paint-checkbox'][value='texture']");n[HomeFurnitureController.FurniturePaint.MODEL_MATERIALS]=l.findElement("[name='paint-checkbox'][value='MODEL_MATERIALS']");for(var f=0;f<n.length;f++){var d=n[f];d.checked=f==e||(f==HomeFurnitureController.FurniturePaint.DEFAULT&&!n[e])}var m=h.getModelMaterialsController().getView();this.attachChildComponent("material-component",m);var j=h.getModelMaterialsController().getModel()!=null;n[HomeFurnitureController.FurniturePaint.MODEL_MATERIALS].disabled=!j;m.setEnabled(j);this.paintPanel={colorAndTextureRadioButtons:n,colorButton:p,textureComponent:o};var k=h.isPropertyEditable("PAINT")?undefined:"none";this.getElement("paint-panel").style.display=k;this.getElement("paint-panel").previousElementSibling.style.display=k;this.registerPropertyChangeListener(h,"PAINT",function(q){l.updatePaintRadioButtons()});this.registerEventListener(n,"change",function(q){var r=n.indexOf(q.target);h.setPaint(r)})};c.prototype.updatePaintRadioButtons=function(){var h=this;var d=this.controller;var g=h.paintPanel.colorAndTextureRadioButtons;if(d.getPaint()==null){for(var f=0;f<g.length;f++){g[f].checked=false}}else{var e=g[d.getPaint()];if(e){e.checked=true}this.updateShininessRadioButtons(d)}};c.prototype.initSizePanel=function(){var p=this;var n=this.controller;var h=this.getElement("width-label");var m=new JSSpinner(this.preferences,this.getElement("width-input"),{nullable:n.getWidth()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var e=this.getElement("depth-label");var f=new JSSpinner(this.preferences,this.getElement("depth-input"),{nullable:n.getDepth()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var g=this.getElement("height-label");var l=this.getElement("height-input");var l=new JSSpinner(this.preferences,this.getElement("height-input"),{nullable:n.getHeight()==null,format:this.preferences.getLengthUnit().getFormat(),stepSize:this.preferences.getLengthUnit().getStepSize()});var u=this.getElement("keep-proportions-checkbox");var t=this.getElement("model-transformations-button");var v=this.controller.isPropertyEditable("WIDTH")?"initial":"none";var j=this.controller.isPropertyEditable("DEPTH")?"initial":"none";var s=this.controller.isPropertyEditable("HEIGHT")?"initial":"none";var o=this.controller.isPropertyEditable("PROPORTIONAL")?"initial":"none";h.style.display=v;m.parentElement.style.display=v;e.style.display=j;f.parentElement.style.display=j;g.style.display=s;l.parentElement.style.display=s;u.parentElement.style.display=o;t.parentElement.style.display="none";if(this.controller.isPropertyEditable("MODEL_TRANSFORMATIONS")&&t!=null){var d=n.getModelMaterialsController();if(d!==null&&d.getModel()!==null){ModelManager.getInstance().loadModel(d.getModel(),{modelUpdated:function(x){var w=ModelManager.getInstance();if(w.containsDeformableNode(x)){t.innerHTML=p.getLocalizedLabelText("HomeFurniturePanel",w.containsNode(x,ModelManager.MANNEQUIN_ABDOMEN_PREFIX)?"mannequinTransformationsButton.text":"modelTransformationsButton.text");t.parentElement.style.display="block";p.registerEventListener(t,"click",function(y){p.displayModelTransformationsView(p.getUserPreferences(),p.controller)})}},modelError:function(w){}})}}m.setValue(this.controller.getWidth());f.setValue(this.controller.getDepth());l.setValue(this.controller.getHeight());u.checked=this.controller.isProportional();var k=this.preferences.getLengthUnit().getName();h.textContent=this.getLocalizedLabelText("HomeFurniturePanel","widthLabel.text",k);e.textContent=this.getLocalizedLabelText("HomeFurniturePanel","depthLabel.text",k);g.textContent=this.getLocalizedLabelText("HomeFurniturePanel","heightLabel.text",k);var r=this.preferences.getLengthUnit().getMinimumLength();var q=this.preferences.getLengthUnit().getMaximumLength();m.setMinimum(r);m.setMaximum(q);f.setMinimum(r);f.setMaximum(q);l.setMinimum(r);l.setMaximum(q);var n=this.controller;this.registerPropertyChangeListener(this.controller,"WIDTH",function(w){m.setValue(n.getWidth())});this.registerPropertyChangeListener(this.controller,"DEPTH",function(w){f.setValue(n.getDepth())});this.registerPropertyChangeListener(this.controller,"HEIGHT",function(w){l.setValue(n.getHeight())});this.registerPropertyChangeListener(this.controller,"PROPORTIONAL",function(w){u.checked=n.isProportional()});this.registerEventListener(m,"input",function(w){n.setWidth(m.getValue())});this.registerEventListener(f,"input",function(w){n.setDepth(f.getValue())});this.registerEventListener(l,"input",function(w){n.setHeight(l.getValue())});this.registerEventListener(u,"change",function(w){n.setProportional(u.checked)});this.sizePanel={widthLabel:h,widthInput:m,depthLabel:e,depthInput:f,heightLabel:g,heightInput:l,keepProportionsCheckBox:u};this.updateSizeComponents();this.registerPropertyChangeListener(this.controller,"RESIZABLE",function(w){p.updateSizeComponents()});this.registerPropertyChangeListener(this.controller,"DEFORMABLE",function(w){p.updateSizeComponents()})};c.prototype.updateSizeComponents=function(){var d=this.controller.isResizable();this.sizePanel.widthLabel.disabled=!d;this.sizePanel.widthInput.disabled=!d;this.sizePanel.depthLabel.disabled=!d;this.sizePanel.depthInput.disabled=!d;this.sizePanel.heightLabel.disabled=!d;this.sizePanel.heightInput.disabled=!d;this.sizePanel.keepProportionsCheckBox.disabled=!d||!this.controller.isDeformable()};c.prototype.initShininessPanel=function(){var d=this.controller;var e=this;var j=this.findElement("[name='shininess-radio'][value='DEFAULT']");var g=this.findElement("[name='shininess-radio'][value='MATT']");var f=this.findElement("[name='shininess-radio'][value='SHINY']");this.shininessPanel={defaultShininessRadioButton:j,mattRadioButton:g,shinyRadioButton:f};var h=d.isPropertyEditable("SHININESS")?"initial":"none";j.parentElement.style.display=h;g.parentElement.style.display=h;f.parentElement.style.display=h;if(d.isPropertyEditable("SHININESS")){this.registerEventListener([j,g,f],"change",function(l){var k=e.findElement("[name='shininess-radio']:checked");d.setShininess(HomeFurnitureController.FurnitureShininess[k.value])});this.registerPropertyChangeListener(d,"SHININESS",function(k){e.updateShininessRadioButtons(d)});this.updateShininessRadioButtons(d)}};c.prototype.updateShininessRadioButtons=function(){var d=this.controller;if(d.isPropertyEditable("SHININESS")){if(d.getShininess()==HomeFurnitureController.FurnitureShininess.DEFAULT){this.shininessPanel.defaultShininessRadioButton.checked=true}else{if(d.getShininess()==HomeFurnitureController.FurnitureShininess.MATT){this.shininessPanel.mattRadioButton.checked=true}else{if(d.getShininess()==HomeFurnitureController.FurnitureShininess.SHINY){this.shininessPanel.shinyRadioButton.checked=true}else{this.shininessPanel.defaultShininessRadioButton.checked=false;this.shininessPanel.mattRadioButton.checked=false;this.shininessPanel.shinyRadioButton.checked=false}}}var e=d.getPaint()!=HomeFurnitureController.FurniturePaint.MODEL_MATERIALS;this.shininessPanel.defaultShininessRadioButton.disabled=!e;this.shininessPanel.mattRadioButton.disabled=!e;this.shininessPanel.shinyRadioButton.disabled=!e;if(!e){this.shininessPanel.defaultShininessRadioButton.checked=false;this.shininessPanel.mattRadioButton.checked=false;this.shininessPanel.shinyRadioButton.checked=false}}};c.prototype.displayModelTransformationsView=function(j,k){var h="<div data-name='label-panel'>  <span>@{ModelTransformationsPanel.transformationsLabel.text}</span><br/></div><div data-name='preview-panel'>  <canvas id='model-preview-canvas'></canvas></div><div data-name='edit-panel'>  <div>    <button name='reset-transformations-button'>@{ModelTransformationsPanel.resetTransformationsButton.text}</button>    <div name='presetTransformationsLabel'>@{ModelTransformationsPanel.presetTransformationsLabel.text}</div>     <div>      <select name='presetTransformations'></select>    </div>    <button name='view-from-front-button'>@{ModelTransformationsPanel.viewFromFrontButton.text}</button>    <button name='view-from-side-button'>@{ModelTransformationsPanel.viewFromSideButton.text}</button>    <button name='view-from-top-button'>@{ModelTransformationsPanel.viewFromTopButton.text}</button>  </div></div>";var m=new JSDialog(j,j.getLocalizedString("ModelTransformationsPanel","modelTransformations.title"),h,{size:"medium",applier:function(){var v=m.previewComponent.getModelX();var t=m.previewComponent.getModelY();var s=(k.getX()+v*Math.cos(k.getAngle())-t*Math.sin(k.getAngle()));var x=(k.getY()+v*Math.sin(k.getAngle())+t*Math.cos(k.getAngle()));var u=k.getElevation()+m.previewComponent.getModelElevation()+k.getHeight()/2;var w=m.previewComponent.getModelTransformations();k.setModelTransformations(w!==null?w:[],s,x,u,m.previewComponent.getModelWidth(),m.previewComponent.getModelDepth(),m.previewComponent.getModelHeight())},disposer:function(){}});m.getHTMLElement().classList.add("model-transformations-chooser-dialog");var l=m.findElement("#model-preview-canvas");l.width=350;l.height=350;var r=k.getModelMaterialsController();m.previewComponent=new ModelPreviewComponent(l,true,true);m.previewComponent.setModel(r.getModel(),r.getModelFlags(),r.getModelRotation(),r.getModelWidth(),r.getModelDepth(),r.getModelHeight());m.previewComponent.setModelMaterials(r.getMaterials());m.previewComponent.setModelTransformations(k.getModelTransformations());var o=m.getElement("reset-transformations-button");m.registerEventListener(o,"click",function(s){m.previewComponent.resetModelTransformations()});var e=m.getElement("presetTransformations");var q=k.getModelPresetTransformationsNames();if(q.length>0){var g=document.createElement("option");g.value=-1;g.textContent=j.getLocalizedString("ModelTransformationsPanel","presetTransformationsComboBox.chooseTransformations.text");e.appendChild(g);for(var f=0;f<q.length;f++){var g=document.createElement("option");g.value=f;g.textContent=q[f];e.appendChild(g)}m.registerEventListener(e,"change",function(s){if(e.value>=0){m.previewComponent.setPresetModelTransformations(k.getModelPresetTransformations(e.value))}})}else{m.getElement("presetTransformationsLabel").style.display="none";e.style.display="none"}var p=m.getElement("view-from-front-button");m.registerEventListener(p,"click",function(s){m.previewComponent.setViewYaw(0);m.previewComponent.setViewPitch(0)});var d=m.getElement("view-from-side-button");m.registerEventListener(d,"click",function(s){m.previewComponent.setViewYaw(Math.PI/2);m.previewComponent.setViewPitch(0)});var n=m.getElement("view-from-top-button");m.registerEventListener(n,"click",function(s){m.previewComponent.setViewYaw(0);m.previewComponent.setViewPitch(-Math.PI/2)});m.displayView()};return new c()};JSViewFactory.prototype.createWallView=function(c,d){var k=function(v){var u=c.getLengthUnit().getMaximumLength();var q=v.getElement("x-start-label");var l=v.getElement("y-start-label");var r=new JSSpinner(c,v.getElement("x-start-input"),{nullable:d.getXStart()==null,format:c.getLengthUnit().getFormat(),value:d.getXStart(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var m=new JSSpinner(c,v.getElement("y-start-input"),{nullable:d.getYStart()==null,format:c.getLengthUnit().getFormat(),value:d.getYStart(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var p=v.getElement("x-end-label");var x=v.getElement("y-end-label");var t=v.getElement("distance-to-end-point-label");var o=new JSSpinner(c,v.getElement("x-end-input"),{nullable:d.getXEnd()==null,format:c.getLengthUnit().getFormat(),value:d.getXEnd(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var w=new JSSpinner(c,v.getElement("y-end-input"),{nullable:d.getYEnd()==null,format:c.getLengthUnit().getFormat(),value:d.getYEnd(),minimum:-u,maximum:u,stepSize:c.getLengthUnit().getStepSize()});var s=new JSSpinner(c,v.getElement("distance-to-end-point-input"),{nullable:d.getDistanceToEndPoint()==null,format:c.getLengthUnit().getFormat(),value:d.getDistanceToEndPoint(),minimum:c.getLengthUnit().getMinimumLength(),maximum:2*u*Math.sqrt(2),stepSize:c.getLengthUnit().getStepSize()});var n=c.getLengthUnit().getName();q.textContent=v.getLocalizedLabelText("WallPanel","xLabel.text",n);p.textContent=v.getLocalizedLabelText("WallPanel","xLabel.text",n);l.textContent=v.getLocalizedLabelText("WallPanel","yLabel.text",n);x.textContent=v.getLocalizedLabelText("WallPanel","yLabel.text",n);t.textContent=v.getLocalizedLabelText("WallPanel","distanceToEndPointLabel.text",n);v.registerPropertyChangeListener(d,"X_START",function(y){r.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"Y_START",function(y){m.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"X_END",function(y){o.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"Y_END",function(y){w.setValue(y.getNewValue())});v.registerPropertyChangeListener(d,"DISTANCE_TO_END_POINT",function(y){s.setValue(y.getNewValue())});v.registerEventListener(r,"input",function(y){d.setXStart(r.getValue())});v.registerEventListener(m,"input",function(y){d.setYStart(m.getValue())});v.registerEventListener(o,"input",function(y){d.setXEnd(o.getValue())});v.registerEventListener(w,"input",function(y){d.setYEnd(w.getValue())});v.registerEventListener(s,"input",function(y){d.setDistanceToEndPoint(s.getValue())})};var b=function(l,p){var s=p.getView();var r=new JSDialog(c,l,"<div data-name='content'></div>",{size:"small",applier:function(){},disposer:function(){s.dispose()}});r.attachChildComponent("content",s);var m=p.getVisible();var n=p.getColor();var q=p.getTextureController().getTexture();var o=p.getPaint();var t=p.getThickness();var u=p.getHeight();r.cancel=function(){p.setVisible(m);p.setColor(n);p.getTextureController().setTexture(q);p.setPaint(o);p.setThickness(t);p.setHeight(u);r.close()};r.displayView()};var e=function(s){var l=s.findElement("[name='left-side-color-and-texture-choice'][value='COLORED']");var r=s.findElement("[name='left-side-color-and-texture-choice'][value='TEXTURED']");var q=s.findElement("[name='right-side-color-and-texture-choice'][value='COLORED']");var y=s.findElement("[name='right-side-color-and-texture-choice'][value='TEXTURED']");var B=function(){l.checked=d.getLeftSidePaint()==WallController.WallPaint.COLORED;r.checked=d.getLeftSidePaint()==WallController.WallPaint.TEXTURED};var u=function(){q.checked=d.getRightSidePaint()==WallController.WallPaint.COLORED;y.checked=d.getRightSidePaint()==WallController.WallPaint.TEXTURED};B();u();s.registerPropertyChangeListener(d,"LEFT_SIDE_PAINT",function(){B()});s.registerPropertyChangeListener(d,"RIGHT_SIDE_PAINT",function(){u()});s.leftSideColorButton=new ColorButton(c,{colorChanged:function(C){s.findElement("[name='left-side-color-and-texture-choice'][value='COLORED']").checked=true;d.setLeftSidePaint(WallController.WallPaint.COLORED);d.setLeftSideColor(C)}});s.rightSideColorButton=new ColorButton(c,{colorChanged:function(C){s.findElement("[name='right-side-color-and-texture-choice'][value='COLORED']").checked=true;d.setRightSidePaint(WallController.WallPaint.COLORED);d.setRightSideColor(C)}});s.attachChildComponent("left-side-color-button",s.leftSideColorButton);s.attachChildComponent("right-side-color-button",s.rightSideColorButton);s.leftSideColorButton.setColor(d.getLeftSideColor());s.leftSideColorButton.setColorDialogTitle(c.getLocalizedString("WallPanel","leftSideColorDialog.title"));s.rightSideColorButton.setColor(d.getRightSideColor());s.rightSideColorButton.setColorDialogTitle(c.getLocalizedString("WallPanel","rightSideColorDialog.title"));s.registerPropertyChangeListener(d,"LEFT_SIDE_COLOR",function(){s.leftSideColorButton.setColor(d.getLeftSideColor())});s.registerPropertyChangeListener(d,"RIGHT_SIDE_COLOR",function(){s.rightSideColorButton.setColor(d.getRightSideColor())});s.leftSideTextureComponent=d.getLeftSideTextureController().getView();s.attachChildComponent("left-side-texture-component",s.leftSideTextureComponent);s.rightSideTextureComponent=d.getRightSideTextureController().getView();s.attachChildComponent("right-side-texture-component",s.rightSideTextureComponent);var p=s.findElement("[name='left-side-shininess-choice'][value='0']");var m=s.findElement("[name='left-side-shininess-choice'][value='0.25']");var x=s.findElement("[name='right-side-shininess-choice'][value='0']");var w=s.findElement("[name='right-side-shininess-choice'][value='0.25']");var z=function(){p.checked=d.getLeftSideShininess()==0;m.checked=d.getLeftSideShininess()==0.25};var o=function(){x.checked=d.getRightSideShininess()==0;w.checked=d.getRightSideShininess()==0.25};z();o();s.registerPropertyChangeListener(d,"LEFT_SIDE_SHININESS",function(C){z()});s.registerPropertyChangeListener(d,"RIGHT_SIDE_SHININESS",function(C){o()});s.registerEventListener([p,m],"change",function(C){d.setLeftSideShininess(parseFloat(this.value))});s.registerEventListener([x,w],"change",function(C){d.setRightSideShininess(parseFloat(this.value))});var n=s.getElement("left-side-modify-baseboard-button");var v=s.getElement("right-side-modify-baseboard-button");var A=new ResourceAction(c,"WallPanel","MODIFY_LEFT_SIDE_BASEBOARD",true);var t=new ResourceAction(c,"WallPanel","MODIFY_RIGHT_SIDE_BASEBOARD",true);n.textContent=A.getValue(AbstractAction.NAME);v.textContent=t.getValue(AbstractAction.NAME);s.registerEventListener(n,"click",function(C){b(s.getLocalizedLabelText("WallPanel","leftSideBaseboardDialog.title"),d.getLeftSideBaseboardController())});s.registerEventListener(v,"click",function(C){b(s.getLocalizedLabelText("WallPanel","rightSideBaseboardDialog.title"),d.getRightSideBaseboardController())})};var g=function(r){var t={};var n=c.getPatternsCatalog().getPatterns();for(var o=0;o<n.length;o++){var l=n[o].getImage().getURL();t[l]=n[o]}var p=r.getElement("pattern-select");p.classList.add("wall-pattern-combo-box");var s=new JSComboBox(this.preferences,p,{nullable:d.getPattern()!=null,availableValues:Object.keys(t),renderCell:function(x,y){y.style.backgroundImage="url('"+x+"')"},selectionChanged:function(x){d.setPattern(t[x])}});var u=function(){var x=d.getPattern();s.setSelectedItem(d.getPattern()!=null?x.getImage().getURL():null)};u();r.registerPropertyChangeListener(d,"PATTERN",function(x){u()});var q=r.findElement("[name='top-color-choice'][value='DEFAULT']");var v=r.findElement("[name='top-color-choice'][value='COLORED']");var m=[q,v];var w=function(){q.checked=d.getTopPaint()==WallController.WallPaint.DEFAULT;v.checked=d.getTopPaint()==WallController.WallPaint.COLORED};r.registerEventListener(m,"click",function(x){d.setTopPaint(WallController.WallPaint[this.value])});w();r.registerPropertyChangeListener(d,"TOP_PAINT",function(x){w()});r.topColorButton=new ColorButton(c,{colorChanged:function(x){v.checked=true;d.setTopPaint(WallController.WallPaint.COLORED);d.setTopColor(x)}});r.attachChildComponent("top-color-button",r.topColorButton);r.topColorButton.setColor(d.getTopColor());r.topColorButton.setColorDialogTitle(c.getLocalizedString("WallPanel","topColorDialog.title"));r.registerPropertyChangeListener(d,"TOP_COLOR",function(){r.topColorButton.setColor(d.getTopColor())})};var a=function(u){var m=c.getLengthUnit().getName();u.getElement("rectangular-wall-height-label").textContent=u.getLocalizedLabelText("WallPanel","rectangularWallHeightLabel.text",m);var v=u.findElement("[name='wall-shape-choice'][value='RECTANGULAR_WALL']");var z=u.findElement("[name='wall-shape-choice'][value='SLOPING_WALL']");u.registerEventListener([v,z],"change",function(A){d.setShape(WallController.WallShape[this.value])});var s=function(){v.checked=d.getShape()==WallController.WallShape.RECTANGULAR_WALL;z.checked=d.getShape()==WallController.WallShape.SLOPING_WALL};s();u.registerPropertyChangeListener(d,"SHAPE",function(A){s()});var p=c.getLengthUnit().getMinimumLength();var t=c.getLengthUnit().getMaximumLength();var o=new JSSpinner(c,u.getElement("rectangular-wall-height-input"),{nullable:d.getRectangularWallHeight()==null,format:c.getLengthUnit().getFormat(),value:d.getRectangularWallHeight(),minimum:p,maximum:t,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"RECTANGULAR_WALL_HEIGHT",function(A){o.setValue(A.getNewValue())});u.registerEventListener(o,"input",function(A){d.setRectangularWallHeight(o.getValue())});var y=d.getSlopingWallHeightAtStart()!=null&&d.getSlopingWallHeightAtEnd()!=null?0:p;var x=new JSSpinner(c,u.getElement("sloping-wall-height-at-start-input"),{nullable:d.getSlopingWallHeightAtStart()==null,format:c.getLengthUnit().getFormat(),value:d.getSlopingWallHeightAtStart(),minimum:y,maximum:t,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"SLOPING_WALL_HEIGHT_AT_START",function(A){x.setValue(A.getNewValue())});u.registerEventListener(x,"input",function(A){d.setSlopingWallHeightAtStart(x.getValue());if(y==0&&d.getSlopingWallHeightAtStart()==0&&d.getSlopingWallHeightAtEnd()==0){d.setSlopingWallHeightAtEnd(p)}});var w=new JSSpinner(c,u.getElement("sloping-wall-height-at-end-input"),{nullable:d.getSlopingWallHeightAtEnd()==null,format:c.getLengthUnit().getFormat(),value:d.getSlopingWallHeightAtEnd(),minimum:y,maximum:t,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"SLOPING_WALL_HEIGHT_AT_END",function(A){w.setValue(A.getNewValue())});u.registerEventListener(w,"input",function(A){d.setSlopingWallHeightAtEnd(w.getValue());if(y==0&&d.getSlopingWallHeightAtStart()==0&&d.getSlopingWallHeightAtEnd()==0){d.setSlopingWallHeightAtStart(p)}});u.getElement("thickness-label").textContent=u.getLocalizedLabelText("WallPanel","thicknessLabel.text",m);var r=new JSSpinner(c,u.getElement("thickness-input"),{nullable:d.getThickness()==null,format:c.getLengthUnit().getFormat(),value:d.getThickness(),minimum:p,maximum:t/10,stepSize:c.getLengthUnit().getStepSize()});u.registerPropertyChangeListener(d,"THICKNESS",function(A){r.setValue(A.getNewValue())});u.registerEventListener(r,"input",function(A){d.setThickness(r.getValue())});u.getElement("arc-extent-label").textContent=u.getLocalizedLabelText("WallPanel","arcExtentLabel.text",m);var q=new DecimalFormat("0.#");var n=new JSSpinner(this.preferences,u.getElement("arc-extent-input"),{nullable:d.getArcExtentInDegrees()==null,format:q,value:0,minimum:-270,maximum:270,stepSize:5});var l=function(){n.setValue(d.getArcExtentInDegrees())};l();u.registerPropertyChangeListener(d,"ARC_EXTENT_IN_DEGREES",function(A){l()});u.registerEventListener(n,"input",function(A){d.setArcExtentInDegrees(n.getValue())})};var f=new JSDialog(c,"@{WallPanel.wall.title}",document.getElementById("wall-dialog-template"),{applier:function(l){d.modifyWalls()},disposer:function(l){l.leftSideColorButton.dispose();l.rightSideColorButton.dispose();l.leftSideTextureComponent.dispose();l.rightSideTextureComponent.dispose();l.topColorButton.dispose()},size:"medium"});k(f);e(f);g(f);a(f);f.getElement("wall-orientation-label").innerHTML=f.getLocalizedLabelText("WallPanel","wallOrientationLabel.text",ZIPTools.getScriptFolder()+"resources/wallOrientation.png");var j=function(l,n,m){if(l!=null){if(m){l=l.parentElement}l.style.display=n?"":"none";l.previousElementSibling.style.display=n?"":"none";if(m){l.nextElementSibling.style.display=n?"":"none"}}};var h=function(){j(f.getElement("x-start-input"),d.isEditablePoints(),true);j(f.getElement("x-end-input"),d.isEditablePoints(),true);j(f.getElement("distance-to-end-point-input"),d.isEditablePoints());j(f.getElement("arc-extent-input"),d.isEditablePoints())};f.registerPropertyChangeListener(d,"EDITABLE_POINTS",h);h(d.isEditablePoints());return f};JSViewFactory.prototype.createRoomView=function(f,g){var h=function(q){var m=g.isPropertyEditable("FLOOR_VISIBLE")?"initial":"none";q.floorVisibleCheckBox=q.getElement("floor-visible-checkbox");q.floorVisibleCheckBox.checked=g.getFloorVisible();q.floorVisibleCheckBox.parentElement.style.display=m;q.registerEventListener(q.floorVisibleCheckBox,"change",function(u){g.setFloorVisible(q.floorVisibleCheckBox.checked)});q.registerPropertyChangeListener(g,"FLOOR_VISIBLE",function(u){q.floorVisibleCheckBox.checked=g.getFloorVisible(u)});var s=q.findElement("[name='floor-color-and-texture-choice'][value='COLORED']");q.floorColorButton=new ColorButton(f,{colorChanged:function(u){s.checked=true;g.setFloorPaint(RoomController.RoomPaint.COLORED);g.setFloorColor(u)}});q.attachChildComponent("floor-color-button",q.floorColorButton);q.floorColorButton.setColor(g.getFloorColor());q.floorColorButton.setColorDialogTitle(f.getLocalizedString("RoomPanel","floorColorDialog.title"));var r=q.findElement("[name='floor-color-and-texture-choice'][value='TEXTURED']");q.floorTextureComponent=g.getFloorTextureController().getView();q.attachChildComponent("floor-texture-component",q.floorTextureComponent);q.registerEventListener([s,r],"change",function(u){g.setFloorPaint(RoomController.RoomPaint[this.value])});var n=function(){s.checked=g.getFloorPaint()==RoomController.RoomPaint.COLORED;r.checked=g.getFloorPaint()==RoomController.RoomPaint.TEXTURED};q.registerPropertyChangeListener(g,"FLOOR_PAINT",n);var p=g.isPropertyEditable("FLOOR_PAINT")?"initial":"none";s.parentElement.parentElement.style.display=p;r.parentElement.parentElement.style.display=p;q.getElement("floor-color-button").style.display=p;q.getElement("floor-texture-component").style.display=p;n();var l=q.findElements("[name='floor-shininess-choice']");q.registerEventListener(l,"change",function(){g.setFloorShininess(parseFloat(this.value))});var t=function(){for(var u=0;u<l.length;u++){l[u].checked=g.getFloorShininess()==parseFloat(l[u].value)}};t();q.registerPropertyChangeListener(g,"FLOOR_SHININESS",t);var o=g.isPropertyEditable("FLOOR_SHININESS")?"initial":"none";l[0].parentElement.parentElement=o};var d=function(p){var n=g.isPropertyEditable("CEILING_VISIBLE")?"initial":"none";p.ceilingVisibleCheckBox=p.getElement("ceiling-visible-checkbox");p.ceilingVisibleCheckBox.checked=g.getCeilingVisible();p.ceilingVisibleCheckBox.parentElement.style.display=n;p.registerEventListener(p.ceilingVisibleCheckBox,"change",function(u){g.setCeilingVisible(p.ceilingVisibleCheckBox.checked)});p.registerPropertyChangeListener(g,"CEILING_VISIBLE",function(u){p.ceilingVisibleCheckBox.checked=g.getCeilingVisible()});var o=p.findElement("[name='ceiling-color-and-texture-choice'][value='COLORED']");p.ceilingColorButton=new ColorButton(f,{colorChanged:function(u){o.checked=true;g.setCeilingPaint(RoomController.RoomPaint.COLORED);g.setCeilingColor(u)}});p.attachChildComponent("ceiling-color-button",p.ceilingColorButton);p.ceilingColorButton.setColor(g.getCeilingColor());p.ceilingColorButton.setColorDialogTitle(f.getLocalizedString("RoomPanel","ceilingColorDialog.title"));var q=p.findElement("[name='ceiling-color-and-texture-choice'][value='TEXTURED']");p.ceilingTextureComponent=g.getCeilingTextureController().getView();p.attachChildComponent("ceiling-texture-component",p.ceilingTextureComponent);p.registerEventListener([o,q],"change",function(u){g.setCeilingPaint(RoomController.RoomPaint[this.value])});var m=function(){o.checked=g.getCeilingPaint()==RoomController.RoomPaint.COLORED;q.checked=g.getCeilingPaint()==RoomController.RoomPaint.TEXTURED};m();p.registerPropertyChangeListener(g,"CEILING_PAINT",m);var r=g.isPropertyEditable("CEILING_PAINT")?"initial":"none";o.parentElement.parentElement.style.display=r;q.parentElement.parentElement.style.display=r;p.getElement("ceiling-color-button").style.display=r;p.getElement("ceiling-texture-component").style.display=r;var l=p.findElements("[name='ceiling-shininess-choice']");p.registerEventListener(l,"change",function(){g.setCeilingShininess(parseFloat(this.value))});var s=function(){for(var u=0;u<l.length;u++){l[u].checked=g.getCeilingShininess()==parseFloat(l[u].value)}};s();p.registerPropertyChangeListener(g,"CEILING_SHININESS",s);var t=g.isPropertyEditable("CEILING_SHININESS")?"initial":"none";l[0].parentElement.parentElement=t;p.ceilingFlatCheckBox=p.getElement("ceiling-flat-checkbox");p.ceilingFlatCheckBox.checked=g.getCeilingFlat();p.ceilingFlatCheckBox.parentElement.style.display=g.isPropertyEditable("CEILING_FLAT")?"initial":"none";p.registerEventListener(p.ceilingFlatCheckBox,"change",function(u){g.setCeilingFlat(p.ceilingFlatCheckBox.checked)});p.registerPropertyChangeListener(g,"CEILING_FLAT",function(u){p.ceilingFlatCheckBox.checked=g.getCeilingFlat(u)})};var b=function(l){if(l.firstWallChange&&l.splitSurroundingWallsCheckBox!=null&&!l.splitSurroundingWallsCheckBox.disabled){l.splitSurroundingWallsCheckBox.checked=true;var m=document.createEvent("Event");m.initEvent("change",true,true);l.splitSurroundingWallsCheckBox.dispatchEvent(m);l.firstWallChange=false}};var k=function(p){var r=function(){p.splitSurroundingWallsCheckBox.disabled=!g.isSplitSurroundingWallsNeeded();p.splitSurroundingWallsCheckBox.checked=g.isSplitSurroundingWalls()};var q=g.isPropertyEditable("SPLIT_SURROUNDING_WALLS")?"initial":"none";p.splitSurroundingWallsCheckBox=p.getElement("split-surrounding-walls-checkbox");p.splitSurroundingWallsCheckBox.parentElement.style.display=q;p.registerEventListener(p.splitSurroundingWallsCheckBox,"change",function(v){g.setSplitSurroundingWalls(p.splitSurroundingWallsCheckBox.checked);p.firstWallChange=false});r();p.registerPropertyChangeListener(g,"SPLIT_SURROUNDING_WALLS",function(v){r()});var o=p.findElement("[name='wall-sides-color-and-texture-choice'][value='COLORED']");p.wallSidesColorButton=new ColorButton(f,{colorChanged:function(v){o.checked=true;g.setWallSidesPaint(RoomController.RoomPaint.COLORED);g.setWallSidesColor(v);b(p)}});p.attachChildComponent("wall-sides-color-button",p.wallSidesColorButton);p.wallSidesColorButton.setColor(g.getWallSidesColor());p.wallSidesColorButton.setColorDialogTitle(f.getLocalizedString("RoomPanel","wallSidesColorDialog.title"));var u=p.findElement("[name='wall-sides-color-and-texture-choice'][value='TEXTURED']");p.wallSidesTextureComponent=g.getWallSidesTextureController().getView();p.registerPropertyChangeListener(g.getWallSidesTextureController(),"TEXTURE",function(v){b(p)});p.attachChildComponent("wall-sides-texture-component",p.wallSidesTextureComponent);p.registerEventListener([o,u],"change",function(v){g.setWallSidesPaint(RoomController.RoomPaint[this.value])});var n=function(){o.checked=g.getWallSidesPaint()==RoomController.RoomPaint.COLORED;u.checked=g.getWallSidesPaint()==RoomController.RoomPaint.TEXTURED};n();p.registerPropertyChangeListener(g,"WALL_SIDES_PAINT",n);var m=g.isPropertyEditable("WALL_SIDES_PAINT")?"initial":"none";o.parentElement.parentElement.style.display=m;u.parentElement.parentElement.style.display=m;p.getElement("wall-sides-color-button").style.display=m;p.getElement("wall-sides-texture-component").style.display=m;var l=p.findElements("[name='wall-sides-shininess-choice']");p.registerEventListener(l,"change",function(v){g.setWallSidesShininess(parseFloat(this.value))});var s=function(){for(var v=0;v<l.length;v++){l[v].checked=g.getWallSidesShininess()==parseFloat(l[v].value)}};s();p.registerPropertyChangeListener(g,"WALL_SIDES_SHININESS",s);var t=g.isPropertyEditable("WALL_SIDES_SHININESS")?"initial":"none";l[0].parentElement.parentElement.style.display=t;if(m=="none"&&t=="none"){p.getElement("wall-sides-panel").parentElement.style.display="none"}};var e=function(m){if(!g.isPropertyEditable("WALL_SIDES_BASEBOARD")){m.getElement("wall-sides-baseboard-panel").parentElement.style.display="none";return}var l=g.getWallSidesBaseboardController().getView();m.attachChildComponent("wall-sides-baseboard-panel",l);m.registerPropertyChangeListener(g.getWallSidesBaseboardController(),"VISIBLE",function(){b(m)})};var j=new JSDialog(f,"@{RoomPanel.room.title}",document.getElementById("room-dialog-template"),{applier:function(l){g.modifyRooms()},disposer:function(l){l.floorColorButton.dispose();l.floorTextureComponent.dispose();l.ceilingColorButton.dispose();l.ceilingTextureComponent.dispose();g.getWallSidesBaseboardController().getView().dispose()}});var c=g.isPropertyEditable("NAME")?"initial":"none";j.nameInput=j.getElement("name-input");j.nameInput.value=g.getName()!=null?g.getName():"";j.nameInput.parentElement.style.display=c;j.registerEventListener(j.nameInput,"input",function(l){g.setName(j.nameInput.value.trim())});j.registerPropertyChangeListener(g,"NAME",function(l){j.nameInput.value=g.getName()!=null?g.getName():""});var a=g.isPropertyEditable("AREA_VISIBLE")?"initial":"none";j.areaVisibleCheckBox=j.getElement("area-visible-checkbox");j.areaVisibleCheckBox.checked=g.getAreaVisible();j.areaVisibleCheckBox.parentElement.style.display=a;j.registerEventListener(j.areaVisibleCheckBox,"change",function(l){g.setAreaVisible(j.areaVisibleCheckBox.checked)});j.registerPropertyChangeListener(g,"AREA_VISIBLE",function(l){j.areaVisibleCheckBox.checked=g.getAreaVisible()});h(j);d(j);k(j);e(j);j.firstWallChange=true;return j};JSViewFactory.prototype.createPolylineView=function(c,b){var e=function(s){var v=[];var k=Object.keys(Polyline.ArrowStyle);for(var p=0;p<k.length;p++){var o=parseInt(k[p]);if(!isNaN(o)){v.push(o)}}var q=[];for(var p=0;p<v.length;p++){for(var n=0;n<v.length;n++){q.push({startStyle:v[p],endStyle:v[n]})}}var g=new java.awt.geom.GeneralPath();g.moveTo(15,4);g.lineTo(5,8);g.lineTo(15,12);var l=new java.awt.geom.GeneralPath();l.moveTo(3,8);l.lineTo(15,3);l.lineTo(15,13);l.closePath();var r=64;var t=new java.awt.geom.GeneralPath();t.moveTo(r-14,4);t.lineTo(r-4,8);t.lineTo(r-14,12);var h=new java.awt.geom.GeneralPath();h.moveTo(r-2,8);h.lineTo(r-14,3);h.lineTo(r-14,13);h.closePath();var u=new JSComboBox(this.preferences,s.getElement("arrows-style-select"),{nullable:b.getCapStyle()==null,availableValues:q,renderCell:function(j,y){y.style.border="none";y.style.maxWidth="6em";y.style.margin="auto";y.style.textAlign="center";var w=document.createElement("canvas");w.width=200;w.height=50;w.style.maxWidth="100%";w.style.height="1em";if(j!=null){var x=new Graphics2D(w);x.scale(w.width/r,w.width/r);x.setStroke(new java.awt.BasicStroke(2));x.draw(new java.awt.geom.Line2D.Float(6,8,r-6,8));switch(j.startStyle){case Polyline.ArrowStyle.DISC:x.fill(new java.awt.geom.Ellipse2D.Float(4,4,9,9));break;case Polyline.ArrowStyle.OPEN:x.draw(g);break;case Polyline.ArrowStyle.DELTA:x.fill(l);break}switch(j.endStyle){case Polyline.ArrowStyle.DISC:x.fill(new java.awt.geom.Ellipse2D.Float(r-12,4,9,9));break;case Polyline.ArrowStyle.OPEN:x.draw(t);break;case Polyline.ArrowStyle.DELTA:x.fill(h);break}y.appendChild(w)}},selectionChanged:function(j){b.setStartArrowStyle(j.startStyle);b.setEndArrowStyle(j.endStyle)}});var m=function(){var w=b.getStartArrowStyle();var j=b.getEndArrowStyle();u.setEnabled(b.isArrowsStyleEditable());u.setSelectedItem({startStyle:w,endStyle:j})};m();s.registerPropertyChangeListener(b,"START_ARROW_STYLE",m);s.registerPropertyChangeListener(b,"END_ARROW_STYLE",m)};var a=function(n){var l=[];var o=Object.keys(Polyline.JoinStyle);for(var k=0;k<o.length;k++){var j=parseInt(o[k]);if(!isNaN(j)){l.push(j)}}var h=new java.awt.geom.GeneralPath();h.moveTo(10,10);h.lineTo(80,10);h.lineTo(50,35);var m=new java.awt.geom.Arc2D.Float(10,20,80,20,0,180,java.awt.geom.Arc2D.OPEN);var p=new JSComboBox(this.preferences,n.getElement("join-style-select"),{nullable:b.getJoinStyle()==null,availableValues:l,renderCell:function(t,s){s.style.border="none";s.style.textAlign="center";var q=document.createElement("canvas");q.width=100;q.height=40;q.style.maxWidth="100%";q.style.height="1em";if(t!=null){var r=new Graphics2D(q);r.setStroke(ShapeTools.getStroke(8,Polyline.CapStyle.BUTT,t,null,0));if(t==Polyline.JoinStyle.CURVED){r.draw(m)}else{r.draw(h)}}s.appendChild(q)},selectionChanged:function(q){b.setJoinStyle(q)}});var g=function(){p.setEnabled(b.isJoinStyleEditable());p.setSelectedItem(b.getJoinStyle())};g();n.registerPropertyChangeListener(b,"JOIN_STYLE",g)};var f=function(k){var m=[];var l=Object.keys(Polyline.DashStyle);for(var j=0;j<l.length;j++){var o=parseInt(l[j]);if(!isNaN(o)&&(o!=Polyline.DashStyle.CUSTOMIZED||b.getDashStyle()==Polyline.DashStyle.CUSTOMIZED)){m.push(o)}}var n=new JSComboBox(this.preferences,k.getElement("dash-style-select"),{nullable:b.getDashStyle()==null,availableValues:m,renderCell:function(t,s){s.style.border="none";s.style.textAlign="center";s.style.maxHeight="2em";s.style.minWidth="4em";var q=document.createElement("canvas");q.width=500;q.height=100;q.style.maxWidth="100%";q.style.height="1em";var p=t!=null&&t!=Polyline.DashStyle.CUSTOMIZED?Polyline.DashStyle._$wrappers[t].getDashPattern():b.getDashPattern();if(p!=null){var r=new Graphics2D(q);var u=b.getDashOffset()!=null?b.getDashOffset():0;r.setStroke(ShapeTools.getStroke(12,Polyline.CapStyle.BUTT,Polyline.JoinStyle.MITER,p,u));r.draw(new java.awt.geom.Line2D.Float(20,q.height/2,q.width-60,q.height/2))}s.appendChild(q)},selectionChanged:function(p){b.setDashStyle(p)}});var g=new JSSpinner(c,k.getElement("dash-offset-input"),{nullable:b.getDashOffset()==null,value:b.getDashOffset()==null?null:b.getDashOffset()*100,minimum:0,maximum:100,stepSize:5});k.registerEventListener(g,"input",function(p){b.setDashOffset(g.getValue()!=null?g.getValue()/100:null)});k.registerPropertyChangeListener(b,"DASH_OFFSET",function(){g.setValue(b.getDashOffset()==null?null:b.getDashOffset()*100);n.updateUI()});var h=function(){g.setEnabled(b.getDashStyle()!=Polyline.DashStyle.SOLID);n.setSelectedItem(b.getDashStyle())};h();k.registerPropertyChangeListener(b,"DASH_STYLE",h)};var d=new JSDialog(c,"@{PolylinePanel.polyline.title}",document.getElementById("polyline-dialog-template"),{size:"small",applier:function(g){b.modifyPolylines()},disposer:function(g){g.colorButton.dispose()}});d.colorButton=new ColorButton(c,{colorChanged:function(g){b.setColor(g)}});d.attachChildComponent("color-button",d.colorButton);d.colorButton.setColor(b.getColor());d.colorButton.setColorDialogTitle(c.getLocalizedString("PolylinePanel","colorDialog.title"));d.thicknessLabelElement=d.getElement("thickness-label");d.thicknessLabelElement.textContent=d.getLocalizedLabelText("PolylinePanel","thicknessLabel.text",d.preferences.getLengthUnit().getName());d.thicknessInput=new JSSpinner(c,d.getElement("thickness-input"),{nullable:b.getThickness()==null,format:c.getLengthUnit().getFormat(),value:b.getThickness(),minimum:c.getLengthUnit().getMinimumLength(),maximum:50,stepSize:c.getLengthUnit().getStepSize()});d.registerPropertyChangeListener(b,"THICKNESS",function(g){d.thicknessInput.setValue(b.getThickness())});d.registerEventListener(d.thicknessInput,"input",function(g){b.setThickness(d.thicknessInput.getValue())});e(d);a(d);f(d);d.visibleIn3DCheckBox=d.getElement("visible-in-3D-checkbox");d.visibleIn3DCheckBox.checked=b.isElevationEnabled()&&b.getElevation()!=null;d.registerEventListener(d.visibleIn3DCheckBox,"change",function(g){if(d.visibleIn3DCheckBox.checked){b.setElevation(0)}else{b.setElevation(null)}});return d};JSViewFactory.prototype.createDimensionLineView=function(h,d,e){var g=new JSDialog(d,h?"@{DimensionLinePanel.dimensionLineModification.title}":"@{DimensionLinePanel.dimensionLineCreation.title}",document.getElementById("dimension-line-dialog-template"),{applier:function(k){if(h){e.modifyDimensionLines()}else{e.createDimensionLine()}},disposer:function(k){k.colorButton.dispose()},size:"small"});var f=d.getLengthUnit().getMaximumLength();var a=d.getLengthUnit().getName();g.xStartLabel=g.getElement("x-start-label");g.xStartLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","xLabel.text",a);g.xStartInput=new JSSpinner(d,g.getElement("x-start-input"),{nullable:e.getXStart()==null,format:d.getLengthUnit().getFormat(),value:e.getXStart(),minimum:-f,maximum:f,stepSize:d.getLengthUnit().getStepSize()});g.registerPropertyChangeListener(e,"X_START",function(k){g.xStartInput.setValue(k.getNewValue())});g.registerEventListener(g.xStartInput,"input",function(k){e.setXStart(g.xStartInput.getValue())});g.yStartLabel=g.getElement("y-start-label");g.yStartLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","yLabel.text",a);g.yStartInput=new JSSpinner(d,g.getElement("y-start-input"),{nullable:e.getYStart()==null,format:d.getLengthUnit().getFormat(),value:e.getYStart(),minimum:-f,maximum:f,stepSize:d.getLengthUnit().getStepSize()});g.registerPropertyChangeListener(e,"Y_START",function(k){g.yStartInput.setValue(k.getNewValue())});g.registerEventListener(g.yStartInput,"input",function(k){e.setYStart(g.yStartInput.getValue())});g.elevationStartLabel=g.getElement("elevation-start-label");g.elevationStartLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","elevationLabel.text",a);g.elevationStartInput=new JSSpinner(d,g.getElement("elevation-start-input"),{nullable:e.getElevationStart()==null,format:d.getLengthUnit().getFormat(),value:e.getElevationStart(),minimum:0,maximum:f,stepSize:d.getLengthUnit().getStepSize()});g.registerPropertyChangeListener(e,"ELEVATION_START",function(k){g.elevationStartInput.setValue(k.getNewValue())});g.registerEventListener(g.elevationStartInput,"input",function(k){e.setElevationStart(g.elevationStartInput.getValue())});g.xEndLabel=g.getElement("x-end-label");g.xEndLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","xLabel.text",a);g.xEndInput=new JSSpinner(d,g.getElement("x-end-input"),{nullable:e.getXEnd()==null,format:d.getLengthUnit().getFormat(),value:e.getXEnd(),minimum:-f,maximum:f,stepSize:d.getLengthUnit().getStepSize()});g.registerPropertyChangeListener(e,"X_END",function(k){g.xEndInput.setValue(k.getNewValue())});g.registerEventListener(g.xEndInput,"input",function(k){e.setXEnd(g.xEndInput.getValue())});g.yEndLabel=g.getElement("y-end-label");g.yEndLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","yLabel.text",a);g.yEndInput=new JSSpinner(d,g.getElement("y-end-input"),{nullable:e.getYEnd()==null,format:d.getLengthUnit().getFormat(),value:e.getYEnd(),minimum:-f,maximum:f,stepSize:d.getLengthUnit().getStepSize()});g.registerPropertyChangeListener(e,"Y_END",function(k){g.yEndInput.setValue(k.getNewValue())});g.registerEventListener(g.yEndInput,"input",function(k){e.setYEnd(g.yEndInput.getValue())});g.distanceToEndPointLabel=g.getElement("distance-to-end-point-label");g.distanceToEndPointLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","distanceToEndPointLabel.text",a);g.distanceToEndPointInput=new JSSpinner(d,g.getElement("distance-to-end-point-input"),{nullable:e.getDistanceToEndPoint()==null,format:d.getLengthUnit().getFormat(),value:e.getDistanceToEndPoint(),minimum:d.getLengthUnit().getMinimumLength(),maximum:2*f*Math.sqrt(2),stepSize:d.getLengthUnit().getStepSize()});g.registerPropertyChangeListener(e,"DISTANCE_TO_END_POINT",function(k){g.distanceToEndPointInput.setValue(k.getNewValue())});g.registerEventListener(g.distanceToEndPointInput,"input",function(k){e.setDistanceToEndPoint(g.distanceToEndPointInput.getValue())});g.offsetLabel=g.getElement("offset-label");g.offsetLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","offsetLabel.text",a);g.offsetInput=new JSSpinner(d,g.getElement("offset-input"),{nullable:e.getOffset()==null,format:d.getLengthUnit().getFormat(),value:e.getOffset(),minimum:-10000,maximum:10000,stepSize:d.getLengthUnit().getStepSize()});g.registerPropertyChangeListener(e,"OFFSET",function(k){g.offsetInput.setValue(k.getNewValue())});g.registerEventListener(g.offsetInput,"input",function(k){e.setOffset(g.offsetInput.getValue())});g.planDimensionLineRadioButton=g.findElement("[name='orientation-choice'][value='PLAN']");g.registerEventListener(g.planDimensionLineRadioButton,"change",function(k){if(g.planDimensionLineRadioButton.checked){e.setOrientation(DimensionLineController.DimensionLineOrientation.PLAN)}});g.elevationDimensionLineRadioButton=g.findElement("[name='orientation-choice'][value='ELEVATION']");g.registerEventListener(g.elevationDimensionLineRadioButton,"change",function(k){if(g.elevationDimensionLineRadioButton.checked){e.setOrientation(DimensionLineController.DimensionLineOrientation.ELEVATION)}});g.registerPropertyChangeListener(e,"ORIENTATION",function(k){b()});g.lengthFontSizeLabel=g.getElement("length-font-size-label");g.lengthFontSizeLabel.textContent=g.getLocalizedLabelText("DimensionLinePanel","lengthFontSizeLabel.text",g.preferences.getLengthUnit().getName());g.lengthFontSizeInput=new JSSpinner(d,g.getElement("length-font-size-input"),{format:d.getLengthUnit().getFormat(),value:e.getLengthFontSize(),minimum:5,maximum:999,stepSize:d.getLengthUnit().getStepSize()});var c=function(){var k=e.getLengthFontSize();g.lengthFontSizeInput.setNullable(k==null);g.lengthFontSizeInput.setValue(k)};c();g.registerPropertyChangeListener(e,"LENGTH_FONT_SIZE",c);g.registerEventListener(g.lengthFontSizeInput,"input",function(k){e.setLengthFontSize(g.lengthFontSizeInput.getValue())});g.colorButton=new ColorButton(d,{colorChanged:function(k){e.setColor(g.colorButton.getColor())}});g.attachChildComponent("color-button",g.colorButton);g.colorButton.setColor(e.getColor());g.colorButton.setColorDialogTitle(d.getLocalizedString("DimensionLinePanel","colorDialog.title"));g.registerPropertyChangeListener(e,"COLOR",function(){g.colorButton.setColor(e.getColor())});var b=function(){if(e.getOrientation()==DimensionLineController.DimensionLineOrientation.PLAN){g.planDimensionLineRadioButton.checked=true}else{if(e.getOrientation()==DimensionLineController.DimensionLineOrientation.ELEVATION){g.elevationDimensionLineRadioButton.checked=true}}orientable=e.isEditableDistance();g.planDimensionLineRadioButton.disabled=!orientable;g.elevationDimensionLineRadioButton.disabled=!orientable;if(e.getPitch()!=null&&e.getOrientation()!=DimensionLineController.DimensionLineOrientation.ELEVATION){if(e.getPitch()===0){g.pitch0DegreeRadioButton.checked=true}else{if(Math.abs(e.getPitch())===Math.PI/2){g.pitch90DegreeRadioButton.checked=true}}}var l=e.getOrientation()==DimensionLineController.DimensionLineOrientation.PLAN;var k=e.isVisibleIn3D()===true;g.pitch0DegreeRadioButton.disabled=!(k&&l);g.pitch90DegreeRadioButton.disabled=!(k&&l);g.elevationStartInput.setEnabled(k||e.getOrientation()==DimensionLineController.DimensionLineOrientation.ELEVATION);g.xEndInput.setEnabled(l);g.yEndInput.setEnabled(l)};g.visibleIn3DViewCheckBox=g.getElement("visible-in-3D-checkbox");g.visibleIn3DViewCheckBox.checked=e.isVisibleIn3D();g.registerPropertyChangeListener(e,"VISIBLE_IN_3D",function(k){g.visibleIn3DViewCheckBox.checked=e.isVisibleIn3D()});g.registerEventListener(g.visibleIn3DViewCheckBox,"change",function(k){e.setVisibleIn3D(g.visibleIn3DViewCheckBox.checked);b()});g.pitch0DegreeRadioButton=g.findElement("[name='label-pitch-radio'][value='0']");g.pitch90DegreeRadioButton=g.findElement("[name='label-pitch-radio'][value='90']");var j=function(){if(g.pitch0DegreeRadioButton.checked){e.setPitch(0)}else{if(g.pitch90DegreeRadioButton.checked){e.setPitch(-Math.PI/2)}}};g.registerEventListener([g.pitch0DegreeRadioButton,g.pitch90DegreeRadioButton],"change",j);g.registerPropertyChangeListener(e,"PITCH",b);b();return g};JSViewFactory.prototype.createLabelView=function(j,e,f){var h=new JSDialog(e,j?"@{LabelPanel.labelModification.title}":"@{LabelPanel.labelCreation.title}",document.getElementById("label-dialog-template"),{applier:function(m){if(j){f.modifyLabels()}else{f.createLabel()}},disposer:function(m){m.colorButton.dispose()},size:"small"});h.textInput=h.getElement("text");h.textInput.value=f.getText()!=null?f.getText():"";h.registerEventListener(h.textInput,"input",function(m){f.setText(h.textInput.value)});h.registerPropertyChangeListener(f,"TEXT",function(m){h.textInput.value=f.getText()!=null?f.getText():""});h.alignmentRadioButtons=h.getHTMLElement().querySelectorAll("[name='label-alignment-radio']");h.registerEventListener(h.alignmentRadioButtons,"change",function(n){for(var m=0;m<h.alignmentRadioButtons.length;m++){if(h.alignmentRadioButtons[m].checked){f.setAlignment(TextStyle.Alignment[h.alignmentRadioButtons[m].value])}}});var d=function(){var m=h.findElement("[name='label-alignment-radio'][value='"+TextStyle.Alignment[f.getAlignment()]+"']");if(m!=null){m.checked=true}};h.registerPropertyChangeListener(f,"ALIGNMENT",d);d();h.fontSelect=h.getElement("font-select");var a="DEFAULT_SYSTEM_FONT_NAME";h.registerEventListener(h.fontSelect,"change",function(n){var m=h.fontSelect.querySelector("option:checked").value;f.setFontName(m==a?null:m)});var g=function(){if(f.isFontNameSet()){var m=f.getFontName()==null?a:f.getFontName();var n=h.fontSelect.querySelector("[value='"+m+"']");if(n){n.selected=true}}else{h.fontSelect.selectedIndex=undefined}};h.registerPropertyChangeListener(f,"FONT_NAME",g);CoreTools.loadAvailableFontNames(function(p){p=[a].concat(p);for(var o=0;o<p.length;o++){var m=p[o];var n=o==0?h.getLocalizedLabelText("FontNameComboBox","systemFontName"):m;h.fontSelect.appendChild(JSComponent.createOptionElement(m,n))}g()});h.fontSizeLabel=h.getElement("font-size-label");h.fontSizeLabel.textContent=h.getLocalizedLabelText("LabelPanel","fontSizeLabel.text",h.preferences.getLengthUnit().getName());h.fontSizeInput=new JSSpinner(e,h.getElement("font-size-input"),{format:e.getLengthUnit().getFormat(),value:f.getFontSize(),minimum:5,maximum:999,stepSize:e.getLengthUnit().getStepSize()});var c=function(){var m=f.getFontSize();h.fontSizeInput.setNullable(m==null);h.fontSizeInput.setValue(m)};c();h.registerPropertyChangeListener(f,"FONT_SIZE",c);h.registerEventListener(h.fontSizeInput,"input",function(m){f.setFontSize(h.fontSizeInput.getValue())});h.colorButton=new ColorButton(e,{colorChanged:function(m){f.setColor(h.colorButton.getColor())}});h.attachChildComponent("color-button",h.colorButton);h.colorButton.setColor(f.getColor());h.colorButton.setColorDialogTitle(e.getLocalizedString("LabelPanel","colorDialog.title"));h.registerPropertyChangeListener(f,"COLOR",function(){h.colorButton.setColor(f.getColor())});var b=function(){var m=f.isPitchEnabled()===true;h.pitch0DegreeRadioButton.disabled=!m;h.pitch90DegreeRadioButton.disabled=!m;h.elevationInput.setEnabled(m);if(f.getPitch()!==null){if(f.getPitch()===0){h.pitch0DegreeRadioButton.checked=true}else{if(f.getPitch()===Math.PI/2){h.pitch90DegreeRadioButton.checked=true}}}};h.registerPropertyChangeListener(f,"PITCH",b);h.visibleIn3DCheckBox=h.getElement("visible-in-3D-checkbox");h.visibleIn3DCheckBox.checked=f.isPitchEnabled()!==null&&f.getPitch()!==null;h.registerEventListener(h.visibleIn3DCheckBox,"change",function(m){if(!h.visibleIn3DCheckBox.checked){f.setPitch(null)}else{if(h.pitch90DegreeRadioButton.checked){f.setPitch(Math.PI/2)}else{f.setPitch(0)}}b()});h.pitch0DegreeRadioButton=h.findElement("[name='label-pitch-radio'][value='0']");h.pitch90DegreeRadioButton=h.findElement("[name='label-pitch-radio'][value='90']");var k=function(){if(h.pitch0DegreeRadioButton.checked){f.setPitch(0)}else{if(h.pitch90DegreeRadioButton.checked){f.setPitch(Math.PI/2)}}};h.registerEventListener([h.pitch0DegreeRadioButton,h.pitch90DegreeRadioButton],"change",k);h.elevationLabel=h.getElement("elevation-label");h.elevationLabel.textContent=h.getLocalizedLabelText("LabelPanel","elevationLabel.text",h.preferences.getLengthUnit().getName());h.elevationInput=new JSSpinner(e,h.getElement("elevation-input"),{nullable:f.getElevation()==null,format:e.getLengthUnit().getFormat(),value:f.getElevation(),minimum:0,maximum:e.getLengthUnit().getMaximumElevation(),stepSize:e.getLengthUnit().getStepSize()});var l=function(m){h.elevationInput.setNullable(m.getNewValue()===null);h.elevationInput.setValue(m.getNewValue())};h.registerPropertyChangeListener(f,"ELEVATION",l);h.registerEventListener(h.elevationInput,"input",function(m){f.setElevation(h.elevationInput.getValue())});b();return h};JSViewFactory.prototype.createCompassView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{CompassPanel.compass.title}",document.getElementById("compass-dialog-template"),{size:"medium",applier:function(d){d.controller.modifyCompass()}});this.initRosePanel();this.initGeographicLocationPanel()}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initRosePanel=function(){var h=this.preferences;var j=this.controller;var k=h.getLengthUnit().getMaximumLength();var e=this.getElement("x-label");var f=new JSSpinner(this.preferences,this.getElement("x-input"),{format:h.getLengthUnit().getFormat(),minimum:-k,maximum:k,stepSize:h.getLengthUnit().getStepSize()});var m=this.getElement("y-label");var l=new JSSpinner(this.preferences,this.getElement("y-input"),{format:h.getLengthUnit().getFormat(),minimum:-k,maximum:k,stepSize:h.getLengthUnit().getStepSize()});var o=this.getElement("diameter-label");var n=new JSSpinner(this.preferences,this.getElement("diameter-input"),{format:h.getLengthUnit().getFormat(),minimum:h.getLengthUnit().getMinimumLength(),maximum:h.getLengthUnit().getMaximumLength()/10,stepSize:h.getLengthUnit().getStepSize()});f.setValue(j.getX());l.setValue(j.getY());n.setValue(j.getDiameter());var d=this.preferences.getLengthUnit().getName();e.textContent=this.getLocalizedLabelText("CompassPanel","xLabel.text",d);m.textContent=this.getLocalizedLabelText("CompassPanel","yLabel.text",d);o.textContent=this.getLocalizedLabelText("CompassPanel","diameterLabel.text",d);var j=this.controller;this.registerPropertyChangeListener(this.controller,"X",function(p){f.setValue(j.getX())});this.registerPropertyChangeListener(this.controller,"Y",function(p){l.setValue(j.getY())});this.registerPropertyChangeListener(this.controller,"DIAMETER",function(p){n.setValue(j.getDiameter())});this.registerEventListener(f,"input",function(p){j.setX(f.getValue())});this.registerEventListener(l,"input",function(p){j.setY(l.getValue())});this.registerEventListener(n,"input",function(p){j.setDiameter(n.getValue())});var g=this.getElement("visible-checkbox");g.checked=j.isVisible();this.registerEventListener(g,"change",function(p){j.setVisible(g.checked)});this.registerPropertyChangeListener(j,"VISIBLE",function(p){g.checked=j.isVisible()})};c.prototype.initGeographicLocationPanel=function(){var g=this.preferences;var h=this.controller;var f=new JSSpinner(this.preferences,this.getElement("latitude-input"),{format:new DecimalFormat("N ##0.000;S ##0.000"),minimum:-90,maximum:90,stepSize:5});var j=new JSSpinner(this.preferences,this.getElement("longitude-input"),{format:new DecimalFormat("E ##0.000;W ##0.000"),minimum:-180,maximum:180,stepSize:5});var k=new JSSpinner(this.preferences,this.getElement("north-direction-input"),{format:new IntegerFormat(),minimum:0,maximum:360,stepSize:5});k.getHTMLElement().style.width="3em";k.style.verticalAlign="super";f.setValue(h.getLatitudeInDegrees());j.setValue(h.getLongitudeInDegrees());k.setValue(h.getNorthDirectionInDegrees());this.registerPropertyChangeListener(h,"LATITUDE_IN_DEGREES",function(n){f.setValue(h.getLatitudeInDegrees())});this.registerPropertyChangeListener(h,"LONGITUDE_IN_DEGREES",function(n){j.setValue(h.getLongitudeInDegrees())});this.registerPropertyChangeListener(h,"NORTH_DIRECTION_IN_DEGREES",function(n){k.setValue(h.getNorthDirectionInDegrees())});this.registerEventListener(f,"input",function(n){h.setLatitudeInDegrees(f.getValue())});this.registerEventListener(j,"input",function(n){h.setLongitudeInDegrees(j.getValue())});this.registerEventListener(k,"input",function(n){h.setNorthDirectionInDegrees(k.getValue());d()});var m=this.getElement("compass-preview");m.width=140;m.height=140;m.style.verticalAlign="middle";m.style.width="35px";var e=m.getContext("2d");var l=new Graphics2D(m);var d=function(){l.clear();var n=l.getTransform();l.translate(70,70);l.scale(100,100);l.setColor("#000000");l.fill(PlanComponent.COMPASS);l.setTransform(n);if(h.getNorthDirectionInDegrees()==0||h.getNorthDirectionInDegrees()==null){m.style.transform=""}else{m.style.transform="rotate("+h.getNorthDirectionInDegrees()+"deg)"}};d()};return new c()};JSViewFactory.prototype.createObserverCameraView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{ObserverCameraPanel.observerCamera.title}",document.getElementById("observer-camera-dialog-template"),{applier:function(f){f.controller.modifyObserverCamera()}});this.initLocationPanel();this.initAnglesPanel();var e=this.getElement("adjust-observer-camera-elevation-checkbox");e.checked=a.isElevationAdjusted();var d=a.isObserverCameraElevationAdjustedEditable()?"initial":"none";e.parentElement.style.display=d;this.registerEventListener(e,"change",function(f){a.setElevationAdjusted(e.checked)});this.registerPropertyChangeListener(a,"OBSERVER_CAMERA_ELEVATION_ADJUSTED",function(f){e.checked=a.isElevationAdjusted()})}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initLocationPanel=function(){var h=500000;var e=this.getElement("x-label");var f=new JSSpinner(this.preferences,this.getElement("x-input"),{nullable:this.controller.getX()==null,format:this.preferences.getLengthUnit().getFormat(),minimum:-h,maximum:h,stepSize:this.preferences.getLengthUnit().getStepSize()});var k=this.getElement("y-label");var j=new JSSpinner(this.preferences,this.getElement("y-input"),{nullable:this.controller.getY()==null,format:this.preferences.getLengthUnit().getFormat(),minimum:-h,maximum:h,stepSize:this.preferences.getLengthUnit().getStepSize()});var l=this.getElement("elevation-label");var m=new JSSpinner(this.preferences,this.getElement("elevation-input"),{nullable:this.controller.getElevation()==null,format:this.preferences.getLengthUnit().getFormat(),minimum:this.controller.getMinimumElevation(),maximum:this.preferences.getLengthUnit().getMaximumElevation(),stepSize:this.preferences.getLengthUnit().getStepSize()});f.setValue(this.controller.getX());j.setValue(this.controller.getY());m.setValue(this.controller.getElevation());var d=this.preferences.getLengthUnit().getName();e.textContent=this.getLocalizedLabelText("HomeFurniturePanel","xLabel.text",d);k.textContent=this.getLocalizedLabelText("HomeFurniturePanel","yLabel.text",d);l.textContent=this.getLocalizedLabelText("ObserverCameraPanel","elevationLabel.text",d);var g=this.controller;this.registerPropertyChangeListener(this.controller,"X",function(n){f.setValue(g.getX())});this.registerPropertyChangeListener(this.controller,"Y",function(n){j.setValue(g.getY())});this.registerPropertyChangeListener(this.controller,"ELEVATION",function(n){m.setValue(g.getElevation())});this.registerEventListener(f,"input",function(n){g.setX(f.getValue())});this.registerEventListener(j,"input",function(n){g.setY(j.getValue())});this.registerEventListener(m,"input",function(n){g.setElevation(m.getValue())})};c.prototype.initAnglesPanel=function(){var h=new DecimalFormat("0.#");var g=new JSSpinner(this.preferences,this.getElement("yaw-input"),{format:h,value:Math.toDegrees(this.controller.getYaw()),minimum:-10000,maximum:10000,stepSize:5});var e=new JSSpinner(this.preferences,this.getElement("pitch-input"),{format:h,value:Math.toDegrees(this.controller.getPitch()),minimum:-90,maximum:90,stepSize:5});var f=new JSSpinner(this.preferences,this.getElement("field-of-view-input"),{nullable:this.controller.getFieldOfView()==null,format:h,value:Math.toDegrees(this.controller.getFieldOfView()),minimum:2,maximum:120,stepSize:1});var d=this.controller;this.registerPropertyChangeListener(this.controller,"YAW",function(j){g.setValue(Math.toDegrees(this.controller.getYaw()))});this.registerPropertyChangeListener(this.controller,"PITCH",function(j){e.setValue(Math.toDegrees(this.controller.getPitch()))});this.registerPropertyChangeListener(this.controller,"FIELD_OF_VIEW",function(j){f.setValue(Math.toDegrees(this.controller.getFieldOfView()))});this.registerEventListener(g,"input",function(j){d.setYaw(g.getValue()!=null?Math.toRadians(g.getValue()):null)});this.registerEventListener(e,"input",function(j){d.setPitch(e.getValue()!=null?Math.toRadians(e.getValue()):null)});this.registerEventListener(f,"input",function(j){d.setFieldOfView(f.getValue()!=null?Math.toRadians(f.getValue()):null)})};return new c()};JSViewFactory.prototype.createHome3DAttributesView=function(b,a){function c(){this.controller=a;JSDialog.call(this,b,"@{Home3DAttributesPanel.home3DAttributes.title}",document.getElementById("home-3Dattributes-dialog-template"),{size:"small",applier:function(d){d.controller.modify3DAttributes()},disposer:function(d){d.groundPanel.colorButton.dispose();d.groundPanel.textureComponent.dispose();d.skyPanel.colorButton.dispose();d.skyPanel.textureComponent.dispose()}});this.initGroundPanel();this.initSkyPanel();this.initRenderingPanel()}c.prototype=Object.create(JSDialog.prototype);c.prototype.constructor=c;c.prototype.initGroundPanel=function(){var h=this.controller;var k=this;var j=k.findElement("[name='ground-color-and-texture-choice'][value='COLORED']");var l=new ColorButton(b,{colorChanged:function(n){j.checked=true;h.setGroundPaint(Home3DAttributesController.EnvironmentPaint.COLORED);h.setGroundColor(n)}});k.attachChildComponent("ground-color-button",l);l.setColor(h.getGroundColor());l.setColorDialogTitle(b.getLocalizedString("Home3DAttributesPanel","groundColorDialog.title"));var d=k.findElement("[name='ground-color-and-texture-choice'][value='TEXTURED']");var m=h.getGroundTextureController().getView();k.attachChildComponent("ground-texture-component",m);var g=[j,d];k.registerEventListener(g,"change",function(n){if(n.target.checked){h.setGroundPaint(Home3DAttributesController.EnvironmentPaint[n.target.value])}});var f=function(){j.checked=h.getGroundPaint()==Home3DAttributesController.EnvironmentPaint.COLORED;d.checked=h.getGroundPaint()==Home3DAttributesController.EnvironmentPaint.TEXTURED};f();this.registerPropertyChangeListener(h,"GROUND_PAINT",f);this.registerPropertyChangeListener(h,"GROUND_COLOR",function(n){l.setColor(h.getGroundColor())});var e=this.getElement("background-image-visible-on-ground-3D-checkbox");e.checked=h.isBackgroundImageVisibleOnGround3D();this.registerEventListener(e,"change",function(n){h.setBackgroundImageVisibleOnGround3D(e.checked)});this.registerPropertyChangeListener(h,"BACKGROUND_IMAGE_VISIBLE_ON_GROUND_3D",function(n){e.checked=h.isBackgroundImageVisibleOnGround3D()});this.groundPanel={colorButton:l,textureComponent:m}};c.prototype.initSkyPanel=function(){var e=this.controller;var h=this;var d=h.findElement("[name='sky-color-and-texture-choice'][value='COLORED']");var g=new ColorButton(b,{colorChanged:function(m){d.checked=true;e.setSkyPaint(Home3DAttributesController.EnvironmentPaint.COLORED);e.setSkyColor(m)}});h.attachChildComponent("sky-color-button",g);g.setColor(e.getSkyColor());g.setColorDialogTitle(b.getLocalizedString("Home3DAttributesPanel","skyColorDialog.title"));var k=h.findElement("[name='sky-color-and-texture-choice'][value='TEXTURED']");var f=e.getSkyTextureController().getView();h.attachChildComponent("sky-texture-component",f);var j=[d,k];h.registerEventListener(j,"change",function(m){if(m.target.checked){e.setSkyPaint(Home3DAttributesController.EnvironmentPaint[m.target.value])}});var l=function(){d.checked=e.getSkyPaint()==Home3DAttributesController.EnvironmentPaint.COLORED;k.checked=e.getSkyPaint()==Home3DAttributesController.EnvironmentPaint.TEXTURED};l();this.registerPropertyChangeListener(e,"SKY_PAINT",l);this.registerPropertyChangeListener(e,"SKY_COLOR",function(){g.setColor(e.getSkyColor())});this.skyPanel={colorButton:g,textureComponent:f}};c.prototype.initRenderingPanel=function(){var e=this.controller;var d=this.getElement("brightness-slider");var h=this.findElement("#home-3Dattributes-brightness-list");var k=this.getElement("walls-transparency-slider");var j=this.findElement("#home-3Dattributes-walls-transparency-list");for(var f=0;f<=255;f+=17){var g=document.createElement("option");g.value=f;h.appendChild(g);j.appendChild(g.cloneNode())}d.value=e.getLightColor()&255;k.value=e.getWallsAlpha()*255;this.registerEventListener(d,"input",function(l){var m=l.target.value;e.setLightColor((m<<16)|(m<<8)|m)});this.registerEventListener(k,"input",function(l){e.setWallsAlpha(this.value/255)});this.registerPropertyChangeListener(e,"LIGHT_COLOR",function(l){d.value=e.getLightColor()&255});this.registerPropertyChangeListener(e,"WALLS_ALPHA",function(l){k.value=e.getWallsAlpha()*255})};return new c()};JSViewFactory.prototype.createTextureChoiceView=function(b,a){return new TextureChoiceComponent(b,a)};JSViewFactory.prototype.createBaseboardChoiceView=function(b,a){function c(){JSComponent.call(this,b,"  <div class='whole-line'>    <label>      <input name='baseboard-visible-checkbox' type='checkbox'/>      @{BaseboardChoiceComponent.visibleCheckBox.text}    </label>  </div>  <div class='whole-line'>    <label>      <input type='radio' name='baseboard-color-and-texture-choice' value='sameColorAsWall'/>      @{BaseboardChoiceComponent.sameColorAsWallRadioButton.text}    </label>  </div>  <div>    <label>      <input type='radio' name='baseboard-color-and-texture-choice' value='COLORED'>        @{BaseboardChoiceComponent.colorRadioButton.text}    </label>  </div>  <div data-name='baseboard-color-button'></div>  <div>    <label>      <input type='radio' name='baseboard-color-and-texture-choice' value='TEXTURED'>        @{BaseboardChoiceComponent.textureRadioButton.text}    </label>  </div>  <div data-name='baseboard-texture-component'></div>  <div class='whole-line'>    <hr/>  </div>  <div data-name='height-label' class='label-cell'></div>  <div><span data-name='height-input'></span></div>  <div data-name='thickness-label' class='label-cell'></div>  <div><span data-name='thickness-input'></span></div>");this.initComponents(a)}c.prototype=Object.create(JSComponent.prototype);c.prototype.constructor=c;c.prototype.dispose=function(){this.colorButton.dispose();this.textureComponent.dispose();JSComponent.prototype.dispose.call(this)};c.prototype.initComponents=function(h){var k=this;this.getHTMLElement().dataset.name="baseboard-panel";this.getHTMLElement().classList.add("label-input-grid");this.visibleCheckBox=this.getElement("baseboard-visible-checkbox");this.visibleCheckBox.checked=h.getVisible();this.registerEventListener(this.visibleCheckBox,"change",function(n){h.setVisible(k.visibleCheckBox.checked)});var m=function(){var p=h.getVisible();k.visibleCheckBox.checked=p;var o=p!==false;for(var n=0;n<k.colorAndTextureRadioButtons.length;n++){k.colorAndTextureRadioButtons[n].disabled=!o}k.colorButton.setEnabled(o);k.textureComponent.setEnabled(o);k.heightInput.setEnabled(o);k.thicknessInput.setEnabled(o)};this.registerPropertyChangeListener(h,"VISIBLE",function(n){m()});var l=this.findElement("[name='baseboard-color-and-texture-choice'][value='sameColorAsWall']");var d=this.findElement("[name='baseboard-color-and-texture-choice'][value='COLORED']");this.colorButton=new ColorButton(b,{colorChanged:function(n){d.checked=true;h.setPaint(BaseboardChoiceController.BaseboardPaint.COLORED);h.setColor(n)}});this.attachChildComponent("baseboard-color-button",this.colorButton);this.colorButton.setColor(h.getColor());this.colorButton.setColorDialogTitle(b.getLocalizedString("BaseboardChoiceComponent","colorDialog.title"));var j=this.findElement("[name='baseboard-color-and-texture-choice'][value='TEXTURED']");this.textureComponent=h.getTextureController().getView();this.attachChildComponent("baseboard-texture-component",this.textureComponent);this.colorAndTextureRadioButtons=[l,d,j];this.registerEventListener(this.colorAndTextureRadioButtons,"change",function(o){if(o.target.checked){var n=o.target.value=="sameColorAsWall"?BaseboardChoiceController.BaseboardPaint.DEFAULT:BaseboardChoiceController.BaseboardPaint[o.target.value];h.setPaint(n)}});var g=function(){l.checked=h.getPaint()==BaseboardChoiceController.BaseboardPaint.DEFAULT;d.checked=h.getPaint()==BaseboardChoiceController.BaseboardPaint.COLORED;j.checked=h.getPaint()==BaseboardChoiceController.BaseboardPaint.TEXTURED};g();this.registerPropertyChangeListener(h,"PAINT",g);var e=b.getLengthUnit().getName();this.getElement("height-label").textContent=this.getLocalizedLabelText("BaseboardChoiceComponent","heightLabel.text",e);this.getElement("thickness-label").textContent=this.getLocalizedLabelText("BaseboardChoiceComponent","thicknessLabel.text",e);var f=b.getLengthUnit().getMinimumLength();this.heightInput=new JSSpinner(b,this.getElement("height-input"),{nullable:h.getHeight()==null,format:b.getLengthUnit().getFormat(),value:h.getHeight()!=null&&h.getMaxHeight()!=null?Math.min(h.getHeight(),h.getMaxHeight()):h.getHeight(),minimum:f,maximum:h.getMaxHeight()==null?b.getLengthUnit().getMaximumLength()/10:h.getMaxHeight(),stepSize:b.getLengthUnit().getStepSize()});this.thicknessInput=new JSSpinner(b,this.getElement("thickness-input"),{nullable:h.getThickness()==null,format:b.getLengthUnit().getFormat(),value:h.getThickness(),minimum:f,maximum:2,stepSize:b.getLengthUnit().getStepSize()});this.registerPropertyChangeListener(h,"HEIGHT",function(n){k.heightInput.setValue(n.getNewValue())});this.registerPropertyChangeListener(h,"MAX_HEIGHT",function(n){if(n.getOldValue()==null||h.getMaxHeight()!=null&&k.heightInput.max<h.getMaxHeight()){k.heightInput.max=h.getMaxHeight()}});this.registerPropertyChangeListener(h,"THICKNESS",function(n){k.thicknessInput.setValue(n.getNewValue())});this.registerEventListener(this.heightInput,"input",function(n){h.setHeight(k.heightInput.getValue())});this.registerEventListener(this.thicknessInput,"input",function(n){h.setThickness(k.thicknessInput.getValue())});m()};return new c()};JSViewFactory.prototype.createModelMaterialsView=function(b,a){return new ModelMaterialsComponent(b,a)};JSViewFactory.prototype.createPageSetupView=function(a,b){return this.dummyDialogView};JSViewFactory.prototype.createPrintPreviewView=function(d,a,c,b){return this.dummyDialogView};JSViewFactory.prototype.createPhotoView=function(c,a,b){return this.dummyDialogView};JSViewFactory.prototype.createPhotosView=function(c,a,b){return this.dummyDialogView};JSViewFactory.prototype.createVideoView=function(c,b,a){return this.dummyDialogView};function DirectHomeRecorder(a){HomeRecorder.call(this,a)}DirectHomeRecorder.prototype=Object.create(HomeRecorder.prototype);DirectHomeRecorder.prototype.constructor=DirectHomeRecorder;DirectHomeRecorder.prototype.readHome=function(c,b){if(this.configuration.readHomeURL!==undefined){var a=CoreTools.format(this.configuration.readHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(c));var d=a.indexOf("?")!=-1?"&":"?";a+=d+"editionId="+HomeObject.createId("home");c=a}HomeRecorder.prototype.readHome.call(this,c,b)};DirectHomeRecorder.prototype.writeHome=function(g,d,b){var f=[];this.searchContents(g,[],f,function(h){return h instanceof LocalURLContent||(h.isJAREntry()&&URLContent.fromURL(h.getJAREntryURL()) instanceof LocalURLContent)});var c=[];var a=this;var e={contentsSaved:function(l){var j=[];a.searchContents(g,[],j,function(o){return o instanceof HomeURLContent||o instanceof SimpleURLContent});var h=0;for(var k=0;k<j.length;k++){var n=j[k];if(n instanceof HomeURLContent){var m=n.getJAREntryName();if(m.indexOf("/")<0){l[n.getURL()]=(++h).toString()}else{l[n.getURL()]=(++h)+m.substring(m.indexOf("/"))}}else{if(n instanceof SimpleURLContent&&n.isJAREntry()&&URLContent.fromURL(n.getJAREntryURL()) instanceof LocalURLContent){l[n.getURL()]=(++h).toString()}}}c.push(a.writeHomeToZip(g,d,j,l,"blob",{homeSaved:function(r,q){var p=new BlobURLContent(q);var o={abort:function(){URL.revokeObjectURL(p.getURL())}};c.push(p.writeBlob(a.configuration.writeHomeURL,d,{blobSaved:function(t,s){o.abort();if(b!=null&&b.homeSaved!=null){b.homeSaved(r)}},blobError:function(s,t){o.abort();if(b!=null&&b.homeError!=null){b.homeError(s,t)}}}));c.push(o)},homeError:function(o,p){if(b!=null&&b.homeError!=null){b.homeError(o,p)}}}))},contentsError:function(h,j){if(b!=null&&b.homeError!=null){b.homeError(h,j)}}};if(this.configuration.writeResourceURL!==undefined&&this.configuration.readResourceURL!==undefined){c.push(this.saveContents(f,e))}else{e.contentsSaved({})}return{abort:function(){for(var h=0;h<c.length;h++){c[h].abort()}}}};DirectHomeRecorder.prototype.saveContents=function(j,c){var g={};var f={};var b={};var e="/Recovery";if(this.configuration.autoRecoveryObjectstore!==undefined){e="/"+this.configuration.autoRecoveryObjectstore}var k=this;j=j.slice(0);for(var d=j.length-1;d>=0;d--){var l=j[d];var a=l.isJAREntry()?URLContent.fromURL(l.getJAREntryURL()):l;if((!(a instanceof LocalStorageURLContent)||this.configuration.writeResourceURL.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0)&&(!(a instanceof IndexedDBURLContent)||this.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0)||(a instanceof IndexedDBURLContent&&(this.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||this.configuration.writeResourceURL.indexOf(e)<0)&&a.getURL().indexOf(e)>0)){if(a.getSavedContent()==null||a.getSavedContent().getURL().indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)===0&&this.configuration.writeResourceURL.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0||a.getSavedContent().getURL().indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)===0&&(this.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||this.configuration.writeResourceURL.indexOf(e)<0&&a.getSavedContent().getURL().indexOf(e)>0)){var h=f[a.getURL()];if(h!=null){a.setSavedContent(h);j.splice(d,1)}else{a.setSavedContent(null);a.getBlob({localContent:l,blobReady:function(o){var p="dat";if(o.type=="image/png"){p="png"}else{if(o.type=="image/jpeg"){p="jpg"}}var m=UUID.randomUUID()+"."+p;var n={handledContent:this.localContent,blobSaved:function(r,q){if(r.getSavedContent()==null||r.getSavedContent().getURL().indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)===0&&(k.configuration.writeResourceURL.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0||k.configuration.writeResourceURL.indexOf(e)<0&&r.getSavedContent().getURL().indexOf(e)>0)){var s=URLContent.fromURL(CoreTools.format(k.configuration.readResourceURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(q)));r.setSavedContent(s);f[r.getURL()]=s}b[this.handledContent.getURL()]=this.handledContent.isJAREntry()?"jar:"+r.getSavedContent().getURL()+"!/"+this.handledContent.getJAREntryName():r.getSavedContent().getURL();delete g[q];j.splice(j.lastIndexOf(this.handledContent),1);if(j.length===0){c.contentsSaved(b)}},blobError:function(q,r){c.contentsError(q,r)}};g[m]=a.writeBlob(k.configuration.writeResourceURL,m,n)},blobError:function(m,n){c.contentsError(m,n)}})}}else{b[l.getURL()]=l.isJAREntry()?"jar:"+a.getSavedContent().getURL()+"!/"+l.getJAREntryName():a.getSavedContent().getURL();j.splice(d,1)}}else{j.splice(d,1)}}if(j.length===0){c.contentsSaved(b)}return{abort:function(){for(var m in g){g[m].abort()}}}};DirectHomeRecorder.prototype.getAvailableHomes=function(o){if(this.configuration.listHomesURL!==undefined){var e=this.configuration.listHomesURL;if(e.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)===0){var m=e.substring(e.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)+LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length);var g=new RegExp(m.indexOf("?")>0?m.substring(0,m.indexOf("?")):m);var p=Object.getOwnPropertyNames(localStorage);var w=[];for(var r=0;r<p.length;r++){var l=p[r].match(g);if(l){w.push(l.length>1?l[1]:l[0])}}o.availableHomes(w);return{abort:function(){}}}else{if(e.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)===0){var v=e.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)+IndexedDBURLContent.INDEXED_DB_PREFIX.length;var n=e.indexOf("/",v);var t=e.indexOf("?",n+1);var b=e.indexOf("=",t+1);var h=e.indexOf("&",b+1);var u=e.substring(v,n);var d=e.substring(n+1,t);var j=e.substring(t+1,b);var g=new RegExp(e.substring(b+1,h>0?h:e.length));var q=function(x){var y=x.target.result;if(!y.objectStoreNames.contains(d)){y.createObjectStore(d,{keyPath:j})}};var s=function(x){if(o.homesError!==undefined){o.homesError(x.target.errorCode,"Can't connect to database "+u)}};var a=function(z){var D=z.target.result;try{if(!D.objectStoreNames.contains(d)){D.close();var C=indexedDB.open(u,D.version+1);C.addEventListener("upgradeneeded",q);C.addEventListener("error",s);C.addEventListener("success",a)}else{var E=D.transaction(d,"readonly");var x=E.objectStore(d);var B;if(IDBObjectStore.prototype.getAllKeys!==undefined){B=x.getAllKeys();B.addEventListener("success",function(H){var I=[];for(var G=0;G<H.target.result.length;G++){var F=H.target.result[G].match(g);if(F){I.push(F.length>1?F[1]:F[0])}}o.availableHomes(I)})}else{B=x.openCursor();var A=[];B.addEventListener("success",function(G){var H=G.target.result;if(H!=null){var F=H.primaryKey.match(g);if(F){A.push(F.length>1?F[1]:F[0])}H["continue"]()}else{o.availableHomes(A)}})}B.addEventListener("error",function(F){if(o.homesError!==undefined){o.homesError(F.target.errorCode,"Can't query in "+d)}});E.addEventListener("complete",function(F){D.close()})}}catch(y){if(o.homesError!==undefined){o.homesError(y,y.message)}}};if(indexedDB!=null){var c=indexedDB.open(u);c.addEventListener("upgradeneeded",q);c.addEventListener("error",s);c.addEventListener("success",a)}else{if(o.homesError!==undefined){o.homesError(new Error("indexedDB"),"indexedDB unavailable")}}return{abort:function(){}}}else{var c=new XMLHttpRequest();var k=e.indexOf("?")!=-1?"&":"?";c.open("GET",e+k+"requestId="+UUID.randomUUID(),true);c.addEventListener("load",function(x){if(c.readyState===XMLHttpRequest.DONE&&c.status===200){o.availableHomes(JSON.parse(c.responseText))}else{if(o.homesError!==undefined){o.homesError(c.status,c.responseText)}}});if(o.homesError!==undefined){var f=function(x){o.homesError(0,x)};c.addEventListener("error",f);c.addEventListener("timeout",f)}c.send();return c}}}else{return null}};DirectHomeRecorder.prototype.deleteHome=function(m,n){if(this.configuration.deleteHomeURL!==undefined){var e=CoreTools.format(this.configuration.deleteHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(m));if(e.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)===0){var j=e.substring(e.indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)+LocalStorageURLContent.LOCAL_STORAGE_PREFIX.length);var k=decodeURIComponent(j.indexOf("?")>0?j.substring(0,j.indexOf("?")):j);localStorage.removeItem(k);n.homeDeleted(m);return{abort:function(){}}}else{if(e.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)===0){var s=e.indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)+IndexedDBURLContent.INDEXED_DB_PREFIX.length;var l=e.indexOf("/",s);var q=e.indexOf("?",l+1);var b=e.indexOf("=",q+1);var g=e.indexOf("&",b+1);var r=e.substring(s,l);var d=e.substring(l+1,q);var h=e.substring(q+1,b);var t=decodeURIComponent(e.substring(b+1,g>0?g:e.length));var o=function(u){var v=u.target.result;if(!v.objectStoreNames.contains(d)){v.createObjectStore(d,{keyPath:h})}};var p=function(u){if(n.homeError!==undefined){n.homeError(u.target.errorCode,"Can't connect to database "+r)}};var a=function(w){var z=w.target.result;try{if(!z.objectStoreNames.contains(d)){z.close();var y=indexedDB.open(r,z.version+1);y.addEventListener("upgradeneeded",o);y.addEventListener("error",p);y.addEventListener("success",a)}else{var A=z.transaction(d,"readwrite");var u=A.objectStore(d);var x=u["delete"](t);x.addEventListener("error",function(B){if(n.homeError!==undefined){n.homeError(B.target.errorCode,"Can't delete in "+d)}});x.addEventListener("success",function(B){n.homeDeleted(m)});A.addEventListener("complete",function(B){z.close()})}}catch(v){if(n.homeError!==undefined){n.homeError(v,v.message)}}};if(indexedDB!=null){var c=indexedDB.open(r);c.addEventListener("upgradeneeded",o);c.addEventListener("error",p);c.addEventListener("success",a)}else{if(n.homeError!==undefined){n.homeError(new Error("indexedDB"),"indexedDB unavailable")}}return{abort:function(){}}}else{if(e.indexOf("?")>0){e+="&requestId="+UUID.randomUUID()}var c=new XMLHttpRequest();c.open("GET",e,true);c.addEventListener("load",function(u){if(c.readyState===XMLHttpRequest.DONE&&c.status===200){n.homeDeleted(m)}else{if(n.homeError!==undefined){n.homeError(c.status,c.responseText)}}});if(n.homeError!==undefined){var f=function(u){n.homeError(0,u)};c.addEventListener("error",f);c.addEventListener("timeout",f)}c.send();return c}}}else{return null}};function IncrementalHomeRecorder(c,d){HomeRecorder.call(this,d);this.application=c;this.homeData={};this.online=true;var b=10000;if(this.configuration.pingURL!==undefined){var a=this;setTimeout(function(){a.checkServer(b)},b)}}IncrementalHomeRecorder.prototype=Object.create(HomeRecorder.prototype);IncrementalHomeRecorder.prototype.constructor=IncrementalHomeRecorder;IncrementalHomeRecorder.DEFAULT_TRACKED_HOME_PROPERTIES=[FurnitureTablePanel.EXPANDED_ROWS_VISUAL_PROPERTY,HomePane.PLAN_VIEWPORT_X_VISUAL_PROPERTY,HomePane.PLAN_VIEWPORT_Y_VISUAL_PROPERTY,HomePane.MAIN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,HomePane.PLAN_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,HomePane.CATALOG_PANE_DIVIDER_LOCATION_VISUAL_PROPERTY,PlanController.SCALE_VISUAL_PROPERTY,"CAMERA","STORED_CAMERAS","SELECTED_LEVEL","FURNITURE_SORTED_PROPERTY","FURNITURE_DESCENDING_SORTED","FURNITURE_VISIBLE_PROPERTIES","OBSERVER_CAMERA_ELEVATION_ADJUSTED","ALL_LEVELS_VISIBLE"];IncrementalHomeRecorder.prototype.getTrackedHomeProperties=function(){if(this.configuration&&this.configuration.trackedHomeProperties){return this.configuration.trackedHomeProperties}else{return IncrementalHomeRecorder.DEFAULT_TRACKED_HOME_PROPERTIES}};IncrementalHomeRecorder.prototype.configure=function(a){this.configuration=a};IncrementalHomeRecorder.prototype.checkServer=function(c){var b=this;var d=new XMLHttpRequest();var a=this.configuration.pingURL;d.open("GET",a,true);d.addEventListener("load",function(e){if(d.readyState===XMLHttpRequest.DONE&&d.status===200){if(!b.online){if(b.configuration&&b.configuration.writingObserver&&b.configuration.writingObserver.connectionFound){b.configuration.writingObserver.connectionFound(b)}}b.online=true;setTimeout(function(){b.checkServer(c)},c)}else{if(b.online){if(b.configuration&&b.configuration.writingObserver&&b.configuration.writingObserver.connectionLost){b.configuration.writingObserver.connectionLost(d.status,d.statusText)}}b.online=false;setTimeout(function(){b.checkServer(c)},c)}});d.addEventListener("error",function(e){if(b.online){if(b.configuration&&b.configuration.writingObserver&&b.configuration.writingObserver.connectionLost){b.configuration.writingObserver.connectionLost(0,"Can't post "+a)}}b.online=false;setTimeout(function(){b.checkServer(c)},c)});d.send()};IncrementalHomeRecorder.prototype.readHome=function(d,c){if(this.configuration.readHomeURL!==undefined){var a=CoreTools.format(this.configuration.readHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(d));if(a.indexOf("?")>0){var b=HomeObject.createId("home");a+="&editionId="+b;var e=c;var c={homeLoaded:function(f){f.editionId=b;e.homeLoaded(f)},homeError:function(f){e.homeError(f)},progression:function(g,h,f){e.progression(g,h,f)}}}d=a}HomeRecorder.prototype.readHome.call(this,d,c)};IncrementalHomeRecorder.prototype.checkPoint=function(b){var a=this;a.homeData[b.editionId].existingHomeObjects={};b.getHomeObjects().forEach(function(c){a.homeData[b.editionId].existingHomeObjects[c.id]=c.id})};IncrementalHomeRecorder.prototype.addHome=function(g,d){if(this.configuration.writeHomeEditsURL!==undefined){if(d===undefined&&this.application.getHomeController!==undefined){d=this.application.getHomeController(g)}if(g.editionId===undefined){g.editionId=HomeObject.createId("home")}this.homeData[g.editionId]={};this.checkPoint(g);this.homeData[g.editionId].undoableEditSupport=d.getUndoableEditSupport();var j=this;var a={undoableEditHappened:function(l){j.storeEdit(g,l.getEdit());j.scheduleWrite(g)},source:j};this.homeData[g.editionId].undoableEditSupport.addUndoableEditListener(a);var k=d.undoManager;var h=k.undo;var e=k.redo;k.undo=function(){var l=k.editToBeUndone();h.call(k);j.storeEdit(g,l,true);j.scheduleWrite(g)};k.redo=function(){var l=k.editToBeRedone();e.call(k);j.storeEdit(g,l);j.scheduleWrite(g)};var b=function(l){var m=undefined;if(l.source===g.getObserverCamera()){m="observerCamera"}if(l.source===g.getTopCamera()){m="topCamera"}if(l.source===g||l.source===g.getEnvironment()){if(j.getTrackedHomeProperties().indexOf(l.getPropertyName())!==-1){m=l.getPropertyName()}}if(m!==undefined){if(j.homeData[g.editionId].trackedStateChanges===undefined){j.homeData[g.editionId].trackedStateChanges={}}j.homeData[g.editionId].trackedStateChanges[m]=true}};g.getObserverCamera().addPropertyChangeListener(b);g.getTopCamera().addPropertyChangeListener(b);var f=this.getTrackedHomeProperties();for(var c=0;c<f.length;c++){if(f[c]=="OBSERVER_CAMERA_ELEVATION_ADJUSTED"||f[c]=="ALL_LEVELS_VISIBLE"){g.getEnvironment().addPropertyChangeListener(f[c],b)}else{g.addPropertyChangeListener(f[c],b)}}if(j.getAutoWriteDelay()>0){j.scheduleWrite(g)}}};IncrementalHomeRecorder.prototype.getAutoWriteDelay=function(){if(this.configuration===undefined||this.configuration.autoWriteDelay===undefined){return -1}else{return this.configuration.autoWriteDelay}};IncrementalHomeRecorder.prototype.removeHome=function(e){if(this.configuration.closeHomeURL!==undefined){var d=CoreTools.format(this.configuration.closeHomeURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(e.name));if(navigator.sendBeacon){navigator.sendBeacon(d)}else{try{var c=new XMLHttpRequest();c.open("GET",d,true);c.send()}catch(b){console.log(b)}}}if(this.configuration.writeHomeEditsURL!==undefined){var f=this.homeData[e.editionId].undoableEditSupport.getUndoableEditListeners();for(var a=0;a<f.length;a++){if(f[a].source===this){this.homeData[e.editionId].undoableEditSupport.removeUndoableEditListener(f[a]);break}}delete this.homeData[e.editionId]}};IncrementalHomeRecorder.prototype.saveBlobs=function(b,l){if(b){if(b.blob instanceof Blob&&b.resourceFileName){var c=this.configuration.writeResourceURL;var h=CoreTools.format(c.replace(/(%[^s])/g,"%$1"),encodeURIComponent(b.resourceFileName));var e=new XMLHttpRequest();e.open("POST",h,true);e.addEventListener("load",function(j){if(e.readyState===XMLHttpRequest.DONE){if(e.status===200){delete b.blob;delete b.resourceFileName}else{l(e.status,e.statusText)}}});var k=function(j){l(0,"Can't post "+h)};e.addEventListener("error",k);e.addEventListener("timeout",k);e.send(b.blob)}else{var a=Object.getOwnPropertyNames(b);for(var f=0;f<a.length;f++){var g=a[f];if(g!="_type"){var d=b[g];if(typeof d=="object"){this.saveBlobs(d,l)}}}}}};IncrementalHomeRecorder.prototype.sendUndoableEdits=function(e){if(!this.hasEdits(e)){return}this.addTrackedStateChange(e);var b=this;var g=this.beginUpdate(e);if(g!==null){var a=function(h,j){b.rollbackUpdate(e,g,h,j);b.scheduleWrite(e,10000)};if(this.configuration.writeResourceURL&&this.configuration.readResourceURL){for(var c=0;c<g.edits.length;c++){this.saveBlobs(g.edits[c],a)}}request=new XMLHttpRequest();var d=this.configuration.writeHomeEditsURL;request.open("POST",d,true);request.withCredentials=true;request.addEventListener("load",function(j){if(request.readyState===XMLHttpRequest.DONE){if(request.status===200){var h=JSON.parse(request.responseText);if(h&&h.result===g.edits.length){b.commitUpdate(e,g)}else{console.log(request.responseText);a(request.status,request.responseText)}}else{a(request.status,request.statusText)}}});var f=function(h){a(0,"Can't post "+d)};request.addEventListener("error",f);request.addEventListener("timeout",f);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send("home="+encodeURIComponent(e.name)+"&editionId="+e.editionId+"&version="+this.application.getVersion()+"&edits="+encodeURIComponent(JSON.stringify(g.edits)))}};IncrementalHomeRecorder.prototype.hasEdits=function(a){return(this.queue!==undefined&&this.queue.length>0)||(this.configuration&&this.configuration.autoWriteTrackedStateChange&&this.homeData[a.editionId].trackedStateChanges!==undefined)};IncrementalHomeRecorder.prototype.addTrackedStateChange=function(f,e){if(this.homeData[f.editionId].trackedStateChanges!==undefined&&(e||(this.configuration&&this.configuration.autoWriteTrackedStateChange))){var b={_type:"com.eteks.sweethome3d.io.TrackedStateChangeUndoableEdit"};var a=this.getTrackedHomeProperties();for(var c=0;c<a.length;c++){var d=a[c];if(this.homeData[f.editionId].trackedStateChanges[d]){switch(d){case"CAMERA":b.camera=f.getCamera();break;case"STORED_CAMERAS":b.storedCameras=f.getStoredCameras();break;case"SELECTED_LEVEL":b.selectedLevel=f.getSelectedLevel();break;case"FURNITURE_SORTED_PROPERTY":b.furnitureSortedProperty=f.getFurnitureSortedProperty();break;case"FURNITURE_DESCENDING_SORTED":b.furnitureDescendingSorted=f.isFurnitureDescendingSorted();break;case"FURNITURE_VISIBLE_PROPERTIES":b.furnitureVisibleProperties=f.getFurnitureVisibleProperties();break;case"OBSERVER_CAMERA_ELEVATION_ADJUSTED":b.observerCameraElevationAdjusted=f.getEnvironment().isObserverCameraElevationAdjusted();break;case"ALL_LEVELS_VISIBLE":b.allLevelsVisible=f.getEnvironment().isAllLevelsVisible();break;default:if(b.homeProperties===undefined){b.homeProperties={}}b.homeProperties[d]=f.getProperty(d)}}}if(this.homeData[f.editionId].trackedStateChanges.topCamera){b.topCamera=f.getTopCamera().duplicate()}if(this.homeData[f.editionId].trackedStateChanges.observerCamera){b.observerCamera=f.getObserverCamera().duplicate()}this.homeData[f.editionId].trackedStateChanges=undefined;this.storeEdit(f,b)}};IncrementalHomeRecorder.prototype.scheduleWrite=function(c,b){if(b===undefined){b=this.getAutoWriteDelay()}if(b>=0){if(this.homeData[c.editionId].scheduledWrite!==undefined){clearTimeout(this.homeData[c.editionId].scheduledWrite);this.homeData[c.editionId].scheduledWrite=undefined}var a=this;this.homeData[c.editionId].scheduledWrite=setTimeout(function(){a.homeData[c.editionId].scheduledWrite=undefined;if(a.online&&a.hasEdits(c)){a.sendUndoableEdits(c)}if(a.getAutoWriteDelay()>0){a.scheduleWrite(c)}},b)}};IncrementalHomeRecorder.prototype.storeEdit=function(e,d,c){var b={};var f=[];var a=this.substituteIdentifiableObjects(e,d,null,b,f,["object3D","hasBeenDone","alive","presentationNameKey","__parent"],[UserPreferences,PlanController,Home],[Boolean,String,Number]);if(f.length>0){a._newObjects=f}if(c){a._action="undo"}a._undoableEditId=UUID.randomUUID();if(!this.queue){this.queue=[]}this.queue.push(a);if(d._type!="com.eteks.sweethome3d.io.TrackedStateChangeUndoableEdit"){this.checkPoint(e)}};IncrementalHomeRecorder.prototype.beginUpdate=function(a){if(this.homeData[a.editionId].ongoingUpdate!==undefined){this.homeData[a.editionId].rejectedUpdate=true;return null}this.homeData[a.editionId].ongoingUpdate={home:a,edits:this.queue.slice(0)};if(this.configuration.writingObserver&&this.configuration.writingObserver.writeStarted){this.configuration.writingObserver.writeStarted(this.homeData[a.editionId].ongoingUpdate)}return this.homeData[a.editionId].ongoingUpdate};IncrementalHomeRecorder.prototype.commitUpdate=function(b,c){for(var a=0;a<c.edits.length;a++){if(this.queue[0]===c.edits[a]){this.queue.shift()}else{throw new Error("Unexpected error while saving")}}if(this.configuration.writingObserver&&this.configuration.writingObserver.writeSucceeded){this.configuration.writingObserver.writeSucceeded(c)}this.homeData[b.editionId].ongoingUpdate=undefined;if(this.homeData[b.editionId].rejectedUpdate){this.homeData[b.editionId].rejectedUpdate=undefined;this.scheduleWrite(b,0)}};IncrementalHomeRecorder.prototype.rollbackUpdate=function(c,d,a,b){if(this.configuration.writingObserver&&this.configuration.writingObserver.writeFailed){this.configuration.writingObserver.writeFailed(d,a,b)}this.homeData[c.editionId].ongoingUpdate=undefined;this.homeData[c.editionId].rejectedUpdate=undefined};IncrementalHomeRecorder.prototype.substituteIdentifiableObjects=function(s,u,g,b,r,e,h,d){if(Array.isArray(u)){var m=u.slice(0);for(var q=0;q<u.length;q++){m[q]=this.substituteIdentifiableObjects(s,u[q],u,b,r,e,h,d)}return m}else{if(u instanceof Big){return{value:u.toString(),_type:"java.math.BigDecimal"}}else{if(u instanceof LocalURLContent||u instanceof URLContent&&u.isJAREntry()&&URLContent.fromURL(u.getJAREntryURL()) instanceof LocalURLContent){var n=u.isJAREntry()?URLContent.fromURL(u.getJAREntryURL()):u;if(n.getSavedContent()!=null&&n.getSavedContent().getURL().indexOf(LocalStorageURLContent.LOCAL_STORAGE_PREFIX)<0&&n.getSavedContent().getURL().indexOf(IndexedDBURLContent.INDEXED_DB_PREFIX)<0){return this.substituteIdentifiableObjects(s,u.isJAREntry()?URLContent.fromURL("jar:"+n.getSavedContent().getURL()+"!/"+u.getJAREntryName()):n.getSavedContent(),g,b,r,e,h,d)}else{var a=n.getBlob();var f="dat";if(a.type=="image/png"){f="png"}else{if(a.type=="image/jpeg"){f="jpg"}}var l=UUID.randomUUID()+"."+f;var c=URLContent.fromURL(CoreTools.format(this.configuration.readResourceURL.replace(/(%[^s])/g,"%$1"),encodeURIComponent(l)));n.setSavedContent(c);var m=this.substituteIdentifiableObjects(s,u.isJAREntry()?URLContent.fromURL("jar:"+n.getSavedContent().getURL()+"!/"+u.getJAREntryName()):n.getSavedContent(),g,b,r,e,h,d);m.resourceFileName=l;m.blob=a;return m}}else{if(u==null||u!==Object(u)||d.some(function(j){return u instanceof j})){return u}else{if(u.id!==undefined&&(this.homeData[s.editionId].existingHomeObjects[u.id]!==undefined||b[u.id]!==undefined||u instanceof Home)){return u.id}else{var m={};if(u.id!==undefined){b[u.id]=m;r.push(m)}if(u.constructor&&u.constructor.__class&&(u.constructor.__class!="com.eteks.sweethome3d.tools.URLContent"||g===undefined||g.constructor===Object)){m._type=u.constructor.__class}var p=Object.getOwnPropertyNames(u);for(var o=0;o<p.length;o++){var k=p[o];if(u.constructor&&u.constructor.__transients&&u.constructor.__transients.indexOf(k)!=-1){continue}if(e.indexOf(k)===-1){var t=u[k];if(typeof t!=="function"&&!h.some(function(j){return t instanceof j})){m[k]=this.substituteIdentifiableObjects(s,t,u,b,r,e,h,d)}}}if(u.id!==undefined){return u.id}else{return m}}}}}}};function LocalFileHomeController(c,b,a){HomeController.call(this,c,b,a)}LocalFileHomeController.prototype=Object.create(HomeController.prototype);LocalFileHomeController.prototype.constructor=LocalFileHomeController;LocalFileHomeController.prototype.newHome=function(){var a=this;var b=function(){a.close();a.application.addHome(a.application.createHome())};if(this.home.isModified()||this.home.isRecovered()){this.getView().confirmSave(this.application.configuration===undefined||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,function(c){if(c){a.save(b)}else{b()}})}else{b()}};LocalFileHomeController.prototype.open=function(){var a=this;var b=function(e){var d=this.application.getUserPreferences();var c=new JSDialog(d,d.getLocalizedString("ThreadedTaskPanel","threadedTask.title"),d.getLocalizedString("HomeController","openMessage"),{size:"small"});c.findElement(".dialog-cancel-button").style="display: none";var f=document.createElement("input");f.setAttribute("style","display: none");f.setAttribute("type","file");document.body.appendChild(f);f.addEventListener("input",function(h){document.body.removeChild(f);if(this.files[0]){c.displayView();var g=this.files[0];setTimeout(function(){var j=g.name.substring(g.name.indexOf("/")+1);a.application.getHomeRecorder().readHome(URL.createObjectURL(g),{homeLoaded:function(k){a.close();c.close();a.application.addHome(k)},homeError:function(k){c.close();var l=d.getLocalizedString("HomeController","openError",j)+"\n"+k;console.log(k);alert(l)}})},100)}});f.click()};if(this.home.isModified()||this.home.isRecovered()){this.getView().confirmSave(this.application.configuration===undefined||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,function(c){if(c){a.save(b)}else{b()}})}else{b()}};LocalFileHomeController.prototype.save=function(e){if(this.home.getName()==null||(this.application.configuration!==undefined&&this.home.getName()===this.application.configuration.defaultHomeName)){this.saveAs(e)}else{var b=this.application.getUserPreferences();var d=new JSDialog(b,b.getLocalizedString("ThreadedTaskPanel","threadedTask.title"),b.getLocalizedString("HomeController","saveMessage"),{size:"small",disposer:function(h){if(h.writingOperation!==undefined){h.writingOperation.abort()}}});if(this.application.getHomeRecorder().configuration&&this.application.getHomeRecorder().configuration.writeHomeWithWorker){d.findElement(".dialog-cancel-button").innerHTML=ResourceAction.getLocalizedLabelText(b,"ThreadedTaskPanel","cancelButton.text")}else{d.findElement(".dialog-cancel-button").style="display: none"}d.displayView();var a=this;var f=application.getUserPreferences().getLocalizedString("FileContentManager","homeExtension");var g=application.getUserPreferences().getLocalizedString("FileContentManager","homeExtension2");var c=a.home.getName().replace(f,g);setTimeout(function(){d.writingOperation=a.application.getHomeRecorder().writeHome(a.home,c,{homeSaved:function(k,j){delete d.writingOperation;d.close();if(navigator.msSaveOrOpenBlob!==undefined){navigator.msSaveOrOpenBlob(j,c)}else{var h=document.createElement("a");h.setAttribute("style","display: none");h.setAttribute("href",URL.createObjectURL(j));h.setAttribute("download",c);document.body.appendChild(h);h.click();setTimeout(function(){document.body.removeChild(h);URL.revokeObjectURL(h.getAttribute("href"))},500)}k.setModified(false);k.setRecovered(false);if(e!==undefined){e()}},homeError:function(h,j){d.close();console.log(h+" "+j);new JSDialog(b,b.getLocalizedString("HomePane","error.title"),b.getLocalizedString("HomeController","saveError",c,h+"<br>"+j),{size:"small"}).displayView()}})},200)}};LocalFileHomeController.prototype.saveAs=function(c){var a=this.application.getUserPreferences();var d=a.getLocalizedString("AppletContentManager","showSaveDialog.message");var b=prompt(d);if(b!=null&&b.length>0){var e=application.getUserPreferences().getLocalizedString("FileContentManager","homeExtension2");this.home.setName(b+(b.indexOf(".")<0?e:""));this.save(c)}};LocalFileHomeController.prototype.close=function(){this.home.setRecovered(false);this.application.deleteHome(this.home);this.getView().dispose()};function DirectRecordingHomeController(c,b,a){HomeController.call(this,c,b,a)}DirectRecordingHomeController.prototype=Object.create(HomeController.prototype);DirectRecordingHomeController.prototype.constructor=DirectRecordingHomeController;DirectRecordingHomeController.prototype.newHome=function(){var a=this;var b=function(){a.close();a.application.addHome(a.application.createHome())};if(this.home.isModified()||this.home.isRecovered()){this.getView().confirmSave(this.application.configuration===undefined||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,function(c){if(c){a.save(b)}else{b()}})}else{b()}};DirectRecordingHomeController.prototype.open=function(){var a=this;var b=a.application.getUserPreferences();var d=function(e){if(e!=null&&e.length>0){a.application.getHomeRecorder().readHome(e,{homeLoaded:function(f){f.setName(e);a.close();a.application.addHome(f)},homeError:function(f){var g=b.getLocalizedString("HomeController","openError",e)+"\n"+f;console.log(f);alert(g)},progression:function(g,h,f){}})}};var c=function(){var f=a.application.getHomeRecorder().getAvailableHomes({availableHomes:function(m){if(m.length==0){var r=b.getLocalizedString("AppletContentManager","showOpenDialog.noAvailableHomes");alert(r)}else{var l='  <div class="column1">    <div>@{AppletContentManager.showOpenDialog.message}</div>    <div class="home-list"></div>  </div>';var k=new JSDialog(b,"@{FileContentManager.openDialog.title}",l,{size:"small",applier:function(s){var t=k.findElement(".selected");if(t!=null){d(t.innerText)}}});k.getHTMLElement().classList.add("open-dialog");var p=k.findElement(".dialog-ok-button");p.innerHTML=b.getLocalizedString("AppletContentManager","showOpenDialog.open");p.disabled=true;var h=k.findElement(".dialog-cancel-button");h.innerHTML=b.getLocalizedString("AppletContentManager","showOpenDialog.cancel");var o=document.createElement("button");o.innerHTML=b.getLocalizedString("AppletContentManager","showOpenDialog.delete");o.disabled=true;h.parentElement.insertBefore(o,h);var g=k.findElement(".home-list");for(var j=0;j<m.length;j++){var q=document.createElement("div");q.classList.add("item");q.innerHTML=m[j];g.appendChild(q)}var n=g.childNodes;k.registerEventListener(n,"click",function(t){for(var s=0;s<n.length;s++){if(t.target==n[s]){n[s].classList.add("selected");p.disabled=false;o.disabled=t.target.innerHTML==a.home.getName()}else{n[s].classList.remove("selected")}}});k.registerEventListener(n,"dblclick",function(){k.validate()});k.registerEventListener(o,"click",function(t){var s=k.findElement(".selected");a.confirmDeleteHome(s.innerText,function(){a.application.getHomeRecorder().deleteHome(s.innerText,{homeDeleted:function(){s.remove();p.disabled=true;o.disabled=true},homeError:function(u,v){var w=b.getLocalizedString("AppletContentManager","confirmDeleteHome.errorMessage",s.innerText);console.log(w+" : "+v);alert(w)}})})});k.displayView()}},homesError:function(g,h){var j=b.getLocalizedString("AppletContentManager","showOpenDialog.availableHomesError");console.log(j+" : "+h);alert(j)}});if(f==null){var e=b.getLocalizedString("AppletContentManager","showOpenDialog.message");d(prompt(e))}};if(this.home.isModified()||this.home.isRecovered()){this.getView().confirmSave(this.application.configuration===undefined||this.home.getName()!==this.application.configuration.defaultHomeName?this.home.getName():null,function(e){if(e){a.save(c)}else{c()}})}else{c()}};DirectRecordingHomeController.prototype.save=function(d){if(this.home.getName()==null||(this.application.configuration!==undefined&&this.home.getName()===this.application.configuration.defaultHomeName)){this.saveAs(d)}else{var b=this.application.getUserPreferences();var c=new JSDialog(b,b.getLocalizedString("ThreadedTaskPanel","threadedTask.title"),b.getLocalizedString("HomeController","saveMessage"),{size:"small",disposer:function(e){if(e.writingOperation!==undefined){e.writingOperation.abort()}}});c.findElement(".dialog-cancel-button").innerHTML=ResourceAction.getLocalizedLabelText(b,"ThreadedTaskPanel","cancelButton.text");c.displayView();var a=this;c.writingOperation=this.application.getHomeRecorder().writeHome(this.home,this.home.getName(),{homeSaved:function(e){delete c.writingOperation;c.close();e.setModified(false);e.setRecovered(false);if(d!==undefined){d()}},homeError:function(e,f){c.close();new JSDialog(b,b.getLocalizedString("HomePane","error.title"),b.getLocalizedString("HomeController","saveError",[a.home.getName(),f]),{size:"small"}).displayView()}})}};DirectRecordingHomeController.prototype.saveAs=function(d){var b=this.application.getUserPreferences();var f=b.getLocalizedString("AppletContentManager","showSaveDialog.message");var c=prompt(f,this.home.getName()!=null&&(this.application.configuration===undefined||this.home.getName()!==this.application.configuration.defaultHomeName)?this.home.getName():undefined);if(c!=null&&c.length>0){var a=this;var e=a.application.getHomeRecorder().getAvailableHomes({availableHomes:function(m){var j=false;for(var h=0;h<m.length;h++){if(c==m[h]){j=true}}if(!j){a.home.setName(c);a.save(d)}else{var k=b.getLocalizedString("FileContentManager","confirmOverwrite.message",c).replace(/\<br\>/g," ");var g=new JSDialog(b,b.getLocalizedString("FileContentManager","confirmOverwrite.title"),k+"</font>",{size:"small",applier:function(){a.home.setName(c);a.save(d)}});g.findElement(".dialog-ok-button").innerHTML=b.getLocalizedString("FileContentManager","confirmOverwrite.overwrite");var l=g.findElement(".dialog-cancel-button");l.innerHTML=b.getLocalizedString("FileContentManager","confirmOverwrite.cancel");g.displayView()}},homesError:function(g,h){var j=b.getLocalizedString("AppletContentManager","showSaveDialog.checkHomeError");console.log(j+" : "+h);alert(j)}});if(e==null){this.home.setName(c);this.save(d)}}};DirectRecordingHomeController.prototype.close=function(){this.home.setRecovered(false);this.application.deleteHome(this.home);this.getView().dispose()};DirectRecordingHomeController.prototype.confirmDeleteHome=function(c,b){var a=this.application.getUserPreferences();var d=a.getLocalizedString("AppletContentManager","confirmDeleteHome.message",c).replace(/\<br\>/g," ");var e=new JSDialog(a,a.getLocalizedString("AppletContentManager","confirmDeleteHome.title"),d+"</font>",{size:"small",applier:function(){b()}});e.findElement(".dialog-ok-button").innerHTML=a.getLocalizedString("AppletContentManager","confirmDeleteHome.delete");var f=e.findElement(".dialog-cancel-button");f.innerHTML=a.getLocalizedString("AppletContentManager","confirmDeleteHome.cancel");e.displayView()};function SweetHome3DJSApplication(b){HomeApplication.call(this);this.homeControllers=[];this.configuration=b;var a=this;this.addHomesListener(function(d){if(d.getType()==CollectionEvent.Type.ADD){var c=a.createHomeController(d.getItem());a.homeControllers.push(c);if(a.getHomeRecorder() instanceof IncrementalHomeRecorder){a.getHomeRecorder().addHome(d.getItem(),c)}c.getView()}else{if(d.getType()==CollectionEvent.Type.DELETE){a.homeControllers.splice(d.getIndex(),1);if(a.getHomeRecorder() instanceof IncrementalHomeRecorder){a.getHomeRecorder().removeHome(d.getItem())}}}});if(this.configuration!==undefined&&this.configuration.autoRecovery&&this.configuration.writeHomeEditsURL===undefined){setTimeout(function(){a.autoRecoveryManager=new AutoRecoveryManager(a)})}}SweetHome3DJSApplication.prototype=Object.create(HomeApplication.prototype);SweetHome3DJSApplication.prototype.constructor=SweetHome3DJSApplication;SweetHome3DJSApplication.prototype.getVersion=function(){return"7.2"};SweetHome3DJSApplication.prototype.getHomeRecorder=function(){if(!this.homeRecorder){this.homeRecorder=this.configuration===undefined||this.configuration.readHomeURL===undefined?new HomeRecorder(this.configuration):(this.configuration.writeHomeEditsURL!==undefined?new IncrementalHomeRecorder(this,this.configuration):new DirectHomeRecorder(this.configuration))}return this.homeRecorder};SweetHome3DJSApplication.prototype.getUserPreferences=function(){if(this.preferences==null){if(this.configuration===undefined){this.preferences=new DefaultUserPreferences()}else{this.preferences=new RecordedUserPreferences(this.configuration)}}return this.preferences};SweetHome3DJSApplication.prototype.createHome=function(){var a=HomeApplication.prototype.createHome.call(this);if(this.configuration!==undefined&&this.configuration.defaultHomeName!==undefined){a.setName(this.configuration.defaultHomeName)}return a};SweetHome3DJSApplication.prototype.getViewFactory=function(){if(this.viewFactory==null){this.viewFactory=new JSViewFactory(this)}return this.viewFactory};SweetHome3DJSApplication.prototype.createHomeController=function(a){return this.configuration===undefined||this.configuration.readHomeURL===undefined?new LocalFileHomeController(a,this,this.getViewFactory()):(this.configuration.writeHomeEditsURL!==undefined?new HomeController(a,this,this.getViewFactory()):new DirectRecordingHomeController(a,this,this.getViewFactory()))};SweetHome3DJSApplication.prototype.getHomeController=function(a){return this.homeControllers[this.getHomes().indexOf(a)]};function AutoRecoveryManager(j){this.application=j;var h="SweetHome3DJS";var d="Recovery";if(j.configuration.autoRecoveryDatabase!==undefined){h=j.configuration.autoRecoveryDatabase}if(j.configuration.autoRecoveryObjectstore!==undefined){d=j.configuration.autoRecoveryObjectstore}var c=this;this.autoRecoveryDatabaseUrlBase="indexeddb://"+h+"/"+d;function e(){HomeRecorder.call(this,{readHomeURL:c.autoRecoveryDatabaseUrlBase+"/content?name=%s.recovered",writeHomeURL:c.autoRecoveryDatabaseUrlBase+"?keyPathField=name&contentField=content&dateField=date&name=%s.recovered",readResourceURL:c.autoRecoveryDatabaseUrlBase+"/content?name=%s",writeResourceURL:c.autoRecoveryDatabaseUrlBase+"?keyPathField=name&contentField=content&dateField=date&name=%s",listHomesURL:c.autoRecoveryDatabaseUrlBase+"?name=(.*).recovered",deleteHomeURL:c.autoRecoveryDatabaseUrlBase+"?name=%s.recovered",writeHomeWithWorker:true})}e.prototype=Object.create(DirectHomeRecorder.prototype);e.prototype.constructor=DirectHomeRecorder;e.prototype.getHomeXMLHandler=function(){return j.getHomeRecorder().getHomeXMLHandler()};e.prototype.getHomeXMLExporter=function(){return j.getHomeRecorder().getHomeXMLExporter()};this.autoSaveRecorder=new e();this.recoveredHomeNames=[];var g=j.getUserPreferences().getLocalizedString("FileContentManager","homeExtension");var f=j.getUserPreferences().getLocalizedString("FileContentManager","homeExtension2");var b=function(l){var m=l.getSource();if(!m.isModified()){m.removePropertyChangeListener("MODIFIED",b);setTimeout(function(){if(!m.isModified()){c.deleteRecoveredHome(m.getName())}m.addPropertyChangeListener("MODIFIED",b)},1000)}};var a=function(l){c.recoveredHomeNames.splice(c.recoveredHomeNames.indexOf(l.getOldValue()),1);if(!l.getSource().isRecovered()){c.deleteRecoveredHome(l.getOldValue())}c.recoveredHomeNames.push(l.getNewValue())};var k=function(l){var m=l.getItem();if(l.getType()==CollectionEvent.Type.ADD){c.autoSaveRecorder.getAvailableHomes({availableHomes:function(p){if(m.getName()!=null){c.recoveredHomeNames.push(m.getName())}var n=false;for(var o=0;o<p.length;o++){if(m.getName()!=null&&this.homeNamesEqual(m.getName(),p[o])){if(j.configuration.silentAutoRecovery||confirm(j.getUserPreferences().getLocalizedString("SweetHome3DJSApplication","confirmRecoverHome"))){n=true;c.autoSaveRecorder.readHome(p[o],{homeLoaded:function(r){j.removeHomesListener(k);j.getHomeController(m).close();var q=r.getName();r.setRecovered(true);r.addPropertyChangeListener("RECOVERED",function(s){if(!r.isRecovered()){c.recoveredHomeNames.splice(c.recoveredHomeNames.indexOf(r.getName()),1);c.deleteRecoveredHome(q);r.addPropertyChangeListener("MODIFIED",b)}});r.addPropertyChangeListener("NAME",a);j.addHome(r);j.addHomesListener(k)},homeError:function(q){var r=j.getUserPreferences().getLocalizedString("HomeController","openError",m.getName())+"\n"+q;console.log(r);alert(r)}})}else{c.recoveredHomeNames.splice(c.recoveredHomeNames.indexOf(m.getName()),1);c.deleteRecoveredHome(p[o])}break}}if(!n){m.addPropertyChangeListener("MODIFIED",b);m.addPropertyChangeListener("NAME",a);if(m.isModified()){c.saveRecoveredHomes();c.restartTimer()}}},homesError:function(n,o){console.log("Couldn't retrieve homes from database : "+n+" "+o)},homeNamesEqual:function(u,t){var q=u.indexOf(g,u.length-g.length);var p=u.indexOf(f,u.length-f.length);var o=t.indexOf(g,t.length-g.length);var n=t.indexOf(f,t.length-f.length);if((q>0||p>0)&&(o>0||n>0)){var s=q>0?u.substring(0,q):u.substring(0,p);var r=o>0?t.substring(0,o):t.substring(0,n);return s===r}else{return u===t}}})}else{if(l.getType()==CollectionEvent.Type.DELETE&&m.getName()!=null){if(c.recoveredHomeNames.indexOf(m.getName())>=0){c.recoveredHomeNames.splice(c.recoveredHomeNames.indexOf(m.getName()),1);c.deleteRecoveredHome(m.getName())}m.removePropertyChangeListener("MODIFIED",b)}}};j.addHomesListener(k);this.lastAutoSaveTime=Date.now();j.getUserPreferences().addPropertyChangeListener("AUTO_SAVE_DELAY_FOR_RECOVERY",function(l){c.restartTimer()});this.restartTimer()}AutoRecoveryManager.prototype.saveRecoveredHomes=function(){var b=this.application.getHomes();for(var a=0;a<b.length;a++){var c=b[a];if(c.getName()!=null){if(c.isModified()){this.autoSaveRecorder.writeHome(c,c.getName(),{homeSaved:function(d){},homeError:function(d,e){console.log("Couldn't save home for recovery : "+d+" "+e)}})}else{if(this.recoveredHomeNames.indexOf(c.getName())<0){this.deleteRecoveredHome(c.getName())}}}}this.lastAutoSaveTime=Math.max(this.lastAutoSaveTime,Date.now())};AutoRecoveryManager.prototype.restartTimer=function(){var a=this;this.stopTimer();var b=application.getUserPreferences().getAutoSaveDelayForRecovery();if(b>0){var c=function(){if(Date.now()-a.lastAutoSaveTime>5000){a.saveRecoveredHomes()}};this.timerIntervalId=setInterval(c,b)}};AutoRecoveryManager.prototype.stopTimer=function(){if(this.timerIntervalId){window.clearInterval(this.timerIntervalId);delete this.timerIntervalId}};AutoRecoveryManager.prototype.deleteRecoveredHome=function(a){var b=this;this.autoSaveRecorder.deleteHome(a,{homeDeleted:function(){if(b.recoveredHomeNames.length==0){b.autoSaveRecorder.getAvailableHomes({availableHomes:function(d){if(d.length===0){var c=new DirectHomeRecorder({listHomesURL:b.autoRecoveryDatabaseUrlBase+"?name=.*",deleteHomeURL:b.autoRecoveryDatabaseUrlBase+"?name=%s"});c.getAvailableHomes({availableHomes:function(f){for(var e=0;e<f.length;e++){c.deleteHome(f[e],{homeDeleted:function(){}})}}})}}})}}})};